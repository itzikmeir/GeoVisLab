(function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))f(p);new MutationObserver(p=>{for(const b of p)if(b.type==="childList")for(const _ of b.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&f(_)}).observe(document,{childList:!0,subtree:!0});function l(p){const b={};return p.integrity&&(b.integrity=p.integrity),p.referrerPolicy&&(b.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?b.credentials="include":p.crossOrigin==="anonymous"?b.credentials="omit":b.credentials="same-origin",b}function f(p){if(p.ep)return;p.ep=!0;const b=l(p);fetch(p.href,b)}})();var xd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Fx(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var iy={exports:{}},lg={};var G1;function Xw(){if(G1)return lg;G1=1;var r=Symbol.for("react.transitional.element"),u=Symbol.for("react.fragment");function l(f,p,b){var _=null;if(b!==void 0&&(_=""+b),p.key!==void 0&&(_=""+p.key),"key"in p){b={};for(var s in p)s!=="key"&&(b[s]=p[s])}else b=p;return p=b.ref,{$$typeof:r,type:f,key:_,ref:p!==void 0?p:null,props:b}}return lg.Fragment=u,lg.jsx=l,lg.jsxs=l,lg}var H1;function Yw(){return H1||(H1=1,iy.exports=Xw()),iy.exports}var J=Yw(),sy={exports:{}},An={};var q1;function Kw(){if(q1)return An;q1=1;var r=Symbol.for("react.transitional.element"),u=Symbol.for("react.portal"),l=Symbol.for("react.fragment"),f=Symbol.for("react.strict_mode"),p=Symbol.for("react.profiler"),b=Symbol.for("react.consumer"),_=Symbol.for("react.context"),s=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),M=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),B=Symbol.for("react.activity"),U=Symbol.iterator;function j(me){return me===null||typeof me!="object"?null:(me=U&&me[U]||me["@@iterator"],typeof me=="function"?me:null)}var H={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},z=Object.assign,N={};function Z(me,re,Ve){this.props=me,this.context=re,this.refs=N,this.updater=Ve||H}Z.prototype.isReactComponent={},Z.prototype.setState=function(me,re){if(typeof me!="object"&&typeof me!="function"&&me!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,me,re,"setState")},Z.prototype.forceUpdate=function(me){this.updater.enqueueForceUpdate(this,me,"forceUpdate")};function Y(){}Y.prototype=Z.prototype;function W(me,re,Ve){this.props=me,this.context=re,this.refs=N,this.updater=Ve||H}var de=W.prototype=new Y;de.constructor=W,z(de,Z.prototype),de.isPureReactComponent=!0;var ge=Array.isArray;function ve(){}var ie={H:null,A:null,T:null,S:null},Me=Object.prototype.hasOwnProperty;function we(me,re,Ve){var Pe=Ve.ref;return{$$typeof:r,type:me,key:re,ref:Pe!==void 0?Pe:null,props:Ve}}function Ge(me,re){return we(me.type,re,me.props)}function et(me){return typeof me=="object"&&me!==null&&me.$$typeof===r}function pe(me){var re={"=":"=0",":":"=2"};return"$"+me.replace(/[=:]/g,function(Ve){return re[Ve]})}var Je=/\/+/g;function le(me,re){return typeof me=="object"&&me!==null&&me.key!=null?pe(""+me.key):re.toString(36)}function ut(me){switch(me.status){case"fulfilled":return me.value;case"rejected":throw me.reason;default:switch(typeof me.status=="string"?me.then(ve,ve):(me.status="pending",me.then(function(re){me.status==="pending"&&(me.status="fulfilled",me.value=re)},function(re){me.status==="pending"&&(me.status="rejected",me.reason=re)})),me.status){case"fulfilled":return me.value;case"rejected":throw me.reason}}throw me}function tt(me,re,Ve,Pe,De){var bt=typeof me;(bt==="undefined"||bt==="boolean")&&(me=null);var Vt=!1;if(me===null)Vt=!0;else switch(bt){case"bigint":case"string":case"number":Vt=!0;break;case"object":switch(me.$$typeof){case r:case u:Vt=!0;break;case D:return Vt=me._init,tt(Vt(me._payload),re,Ve,Pe,De)}}if(Vt)return De=De(me),Vt=Pe===""?"."+le(me,0):Pe,ge(De)?(Ve="",Vt!=null&&(Ve=Vt.replace(Je,"$&/")+"/"),tt(De,re,Ve,"",function(Yt){return Yt})):De!=null&&(et(De)&&(De=Ge(De,Ve+(De.key==null||me&&me.key===De.key?"":(""+De.key).replace(Je,"$&/")+"/")+Vt)),re.push(De)),1;Vt=0;var Zt=Pe===""?".":Pe+":";if(ge(me))for(var jt=0;jt<me.length;jt++)Pe=me[jt],bt=Zt+le(Pe,jt),Vt+=tt(Pe,re,Ve,bt,De);else if(jt=j(me),typeof jt=="function")for(me=jt.call(me),jt=0;!(Pe=me.next()).done;)Pe=Pe.value,bt=Zt+le(Pe,jt++),Vt+=tt(Pe,re,Ve,bt,De);else if(bt==="object"){if(typeof me.then=="function")return tt(ut(me),re,Ve,Pe,De);throw re=String(me),Error("Objects are not valid as a React child (found: "+(re==="[object Object]"?"object with keys {"+Object.keys(me).join(", ")+"}":re)+"). If you meant to render a collection of children, use an array instead.")}return Vt}function We(me,re,Ve){if(me==null)return me;var Pe=[],De=0;return tt(me,Pe,"","",function(bt){return re.call(Ve,bt,De++)}),Pe}function $t(me){if(me._status===-1){var re=me._result;re=re(),re.then(function(Ve){(me._status===0||me._status===-1)&&(me._status=1,me._result=Ve)},function(Ve){(me._status===0||me._status===-1)&&(me._status=2,me._result=Ve)}),me._status===-1&&(me._status=0,me._result=re)}if(me._status===1)return me._result.default;throw me._result}var Be=typeof reportError=="function"?reportError:function(me){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var re=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof me=="object"&&me!==null&&typeof me.message=="string"?String(me.message):String(me),error:me});if(!window.dispatchEvent(re))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",me);return}console.error(me)},Mt={map:We,forEach:function(me,re,Ve){We(me,function(){re.apply(this,arguments)},Ve)},count:function(me){var re=0;return We(me,function(){re++}),re},toArray:function(me){return We(me,function(re){return re})||[]},only:function(me){if(!et(me))throw Error("React.Children.only expected to receive a single React element child.");return me}};return An.Activity=B,An.Children=Mt,An.Component=Z,An.Fragment=l,An.Profiler=p,An.PureComponent=W,An.StrictMode=f,An.Suspense=C,An.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=ie,An.__COMPILER_RUNTIME={__proto__:null,c:function(me){return ie.H.useMemoCache(me)}},An.cache=function(me){return function(){return me.apply(null,arguments)}},An.cacheSignal=function(){return null},An.cloneElement=function(me,re,Ve){if(me==null)throw Error("The argument must be a React element, but you passed "+me+".");var Pe=z({},me.props),De=me.key;if(re!=null)for(bt in re.key!==void 0&&(De=""+re.key),re)!Me.call(re,bt)||bt==="key"||bt==="__self"||bt==="__source"||bt==="ref"&&re.ref===void 0||(Pe[bt]=re[bt]);var bt=arguments.length-2;if(bt===1)Pe.children=Ve;else if(1<bt){for(var Vt=Array(bt),Zt=0;Zt<bt;Zt++)Vt[Zt]=arguments[Zt+2];Pe.children=Vt}return we(me.type,De,Pe)},An.createContext=function(me){return me={$$typeof:_,_currentValue:me,_currentValue2:me,_threadCount:0,Provider:null,Consumer:null},me.Provider=me,me.Consumer={$$typeof:b,_context:me},me},An.createElement=function(me,re,Ve){var Pe,De={},bt=null;if(re!=null)for(Pe in re.key!==void 0&&(bt=""+re.key),re)Me.call(re,Pe)&&Pe!=="key"&&Pe!=="__self"&&Pe!=="__source"&&(De[Pe]=re[Pe]);var Vt=arguments.length-2;if(Vt===1)De.children=Ve;else if(1<Vt){for(var Zt=Array(Vt),jt=0;jt<Vt;jt++)Zt[jt]=arguments[jt+2];De.children=Zt}if(me&&me.defaultProps)for(Pe in Vt=me.defaultProps,Vt)De[Pe]===void 0&&(De[Pe]=Vt[Pe]);return we(me,bt,De)},An.createRef=function(){return{current:null}},An.forwardRef=function(me){return{$$typeof:s,render:me}},An.isValidElement=et,An.lazy=function(me){return{$$typeof:D,_payload:{_status:-1,_result:me},_init:$t}},An.memo=function(me,re){return{$$typeof:M,type:me,compare:re===void 0?null:re}},An.startTransition=function(me){var re=ie.T,Ve={};ie.T=Ve;try{var Pe=me(),De=ie.S;De!==null&&De(Ve,Pe),typeof Pe=="object"&&Pe!==null&&typeof Pe.then=="function"&&Pe.then(ve,Be)}catch(bt){Be(bt)}finally{re!==null&&Ve.types!==null&&(re.types=Ve.types),ie.T=re}},An.unstable_useCacheRefresh=function(){return ie.H.useCacheRefresh()},An.use=function(me){return ie.H.use(me)},An.useActionState=function(me,re,Ve){return ie.H.useActionState(me,re,Ve)},An.useCallback=function(me,re){return ie.H.useCallback(me,re)},An.useContext=function(me){return ie.H.useContext(me)},An.useDebugValue=function(){},An.useDeferredValue=function(me,re){return ie.H.useDeferredValue(me,re)},An.useEffect=function(me,re){return ie.H.useEffect(me,re)},An.useEffectEvent=function(me){return ie.H.useEffectEvent(me)},An.useId=function(){return ie.H.useId()},An.useImperativeHandle=function(me,re,Ve){return ie.H.useImperativeHandle(me,re,Ve)},An.useInsertionEffect=function(me,re){return ie.H.useInsertionEffect(me,re)},An.useLayoutEffect=function(me,re){return ie.H.useLayoutEffect(me,re)},An.useMemo=function(me,re){return ie.H.useMemo(me,re)},An.useOptimistic=function(me,re){return ie.H.useOptimistic(me,re)},An.useReducer=function(me,re,Ve){return ie.H.useReducer(me,re,Ve)},An.useRef=function(me){return ie.H.useRef(me)},An.useState=function(me){return ie.H.useState(me)},An.useSyncExternalStore=function(me,re,Ve){return ie.H.useSyncExternalStore(me,re,Ve)},An.useTransition=function(){return ie.H.useTransition()},An.version="19.2.3",An}var Z1;function Xy(){return Z1||(Z1=1,sy.exports=Kw()),sy.exports}var ke=Xy();const Jw=Fx(ke);var oy={exports:{}},cg={},ly={exports:{}},cy={};var W1;function Qw(){return W1||(W1=1,(function(r){function u(tt,We){var $t=tt.length;tt.push(We);e:for(;0<$t;){var Be=$t-1>>>1,Mt=tt[Be];if(0<p(Mt,We))tt[Be]=We,tt[$t]=Mt,$t=Be;else break e}}function l(tt){return tt.length===0?null:tt[0]}function f(tt){if(tt.length===0)return null;var We=tt[0],$t=tt.pop();if($t!==We){tt[0]=$t;e:for(var Be=0,Mt=tt.length,me=Mt>>>1;Be<me;){var re=2*(Be+1)-1,Ve=tt[re],Pe=re+1,De=tt[Pe];if(0>p(Ve,$t))Pe<Mt&&0>p(De,Ve)?(tt[Be]=De,tt[Pe]=$t,Be=Pe):(tt[Be]=Ve,tt[re]=$t,Be=re);else if(Pe<Mt&&0>p(De,$t))tt[Be]=De,tt[Pe]=$t,Be=Pe;else break e}}return We}function p(tt,We){var $t=tt.sortIndex-We.sortIndex;return $t!==0?$t:tt.id-We.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var b=performance;r.unstable_now=function(){return b.now()}}else{var _=Date,s=_.now();r.unstable_now=function(){return _.now()-s}}var C=[],M=[],D=1,B=null,U=3,j=!1,H=!1,z=!1,N=!1,Z=typeof setTimeout=="function"?setTimeout:null,Y=typeof clearTimeout=="function"?clearTimeout:null,W=typeof setImmediate<"u"?setImmediate:null;function de(tt){for(var We=l(M);We!==null;){if(We.callback===null)f(M);else if(We.startTime<=tt)f(M),We.sortIndex=We.expirationTime,u(C,We);else break;We=l(M)}}function ge(tt){if(z=!1,de(tt),!H)if(l(C)!==null)H=!0,ve||(ve=!0,pe());else{var We=l(M);We!==null&&ut(ge,We.startTime-tt)}}var ve=!1,ie=-1,Me=5,we=-1;function Ge(){return N?!0:!(r.unstable_now()-we<Me)}function et(){if(N=!1,ve){var tt=r.unstable_now();we=tt;var We=!0;try{e:{H=!1,z&&(z=!1,Y(ie),ie=-1),j=!0;var $t=U;try{t:{for(de(tt),B=l(C);B!==null&&!(B.expirationTime>tt&&Ge());){var Be=B.callback;if(typeof Be=="function"){B.callback=null,U=B.priorityLevel;var Mt=Be(B.expirationTime<=tt);if(tt=r.unstable_now(),typeof Mt=="function"){B.callback=Mt,de(tt),We=!0;break t}B===l(C)&&f(C),de(tt)}else f(C);B=l(C)}if(B!==null)We=!0;else{var me=l(M);me!==null&&ut(ge,me.startTime-tt),We=!1}}break e}finally{B=null,U=$t,j=!1}We=void 0}}finally{We?pe():ve=!1}}}var pe;if(typeof W=="function")pe=function(){W(et)};else if(typeof MessageChannel<"u"){var Je=new MessageChannel,le=Je.port2;Je.port1.onmessage=et,pe=function(){le.postMessage(null)}}else pe=function(){Z(et,0)};function ut(tt,We){ie=Z(function(){tt(r.unstable_now())},We)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(tt){tt.callback=null},r.unstable_forceFrameRate=function(tt){0>tt||125<tt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Me=0<tt?Math.floor(1e3/tt):5},r.unstable_getCurrentPriorityLevel=function(){return U},r.unstable_next=function(tt){switch(U){case 1:case 2:case 3:var We=3;break;default:We=U}var $t=U;U=We;try{return tt()}finally{U=$t}},r.unstable_requestPaint=function(){N=!0},r.unstable_runWithPriority=function(tt,We){switch(tt){case 1:case 2:case 3:case 4:case 5:break;default:tt=3}var $t=U;U=tt;try{return We()}finally{U=$t}},r.unstable_scheduleCallback=function(tt,We,$t){var Be=r.unstable_now();switch(typeof $t=="object"&&$t!==null?($t=$t.delay,$t=typeof $t=="number"&&0<$t?Be+$t:Be):$t=Be,tt){case 1:var Mt=-1;break;case 2:Mt=250;break;case 5:Mt=1073741823;break;case 4:Mt=1e4;break;default:Mt=5e3}return Mt=$t+Mt,tt={id:D++,callback:We,priorityLevel:tt,startTime:$t,expirationTime:Mt,sortIndex:-1},$t>Be?(tt.sortIndex=$t,u(M,tt),l(C)===null&&tt===l(M)&&(z?(Y(ie),ie=-1):z=!0,ut(ge,$t-Be))):(tt.sortIndex=Mt,u(C,tt),H||j||(H=!0,ve||(ve=!0,pe()))),tt},r.unstable_shouldYield=Ge,r.unstable_wrapCallback=function(tt){var We=U;return function(){var $t=U;U=We;try{return tt.apply(this,arguments)}finally{U=$t}}}})(cy)),cy}var $1;function eT(){return $1||($1=1,ly.exports=Qw()),ly.exports}var uy={exports:{}},No={};var X1;function tT(){if(X1)return No;X1=1;var r=Xy();function u(C){var M="https://react.dev/errors/"+C;if(1<arguments.length){M+="?args[]="+encodeURIComponent(arguments[1]);for(var D=2;D<arguments.length;D++)M+="&args[]="+encodeURIComponent(arguments[D])}return"Minified React error #"+C+"; visit "+M+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(){}var f={d:{f:l,r:function(){throw Error(u(522))},D:l,C:l,L:l,m:l,X:l,S:l,M:l},p:0,findDOMNode:null},p=Symbol.for("react.portal");function b(C,M,D){var B=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:p,key:B==null?null:""+B,children:C,containerInfo:M,implementation:D}}var _=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function s(C,M){if(C==="font")return"";if(typeof M=="string")return M==="use-credentials"?M:""}return No.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=f,No.createPortal=function(C,M){var D=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!M||M.nodeType!==1&&M.nodeType!==9&&M.nodeType!==11)throw Error(u(299));return b(C,M,null,D)},No.flushSync=function(C){var M=_.T,D=f.p;try{if(_.T=null,f.p=2,C)return C()}finally{_.T=M,f.p=D,f.d.f()}},No.preconnect=function(C,M){typeof C=="string"&&(M?(M=M.crossOrigin,M=typeof M=="string"?M==="use-credentials"?M:"":void 0):M=null,f.d.C(C,M))},No.prefetchDNS=function(C){typeof C=="string"&&f.d.D(C)},No.preinit=function(C,M){if(typeof C=="string"&&M&&typeof M.as=="string"){var D=M.as,B=s(D,M.crossOrigin),U=typeof M.integrity=="string"?M.integrity:void 0,j=typeof M.fetchPriority=="string"?M.fetchPriority:void 0;D==="style"?f.d.S(C,typeof M.precedence=="string"?M.precedence:void 0,{crossOrigin:B,integrity:U,fetchPriority:j}):D==="script"&&f.d.X(C,{crossOrigin:B,integrity:U,fetchPriority:j,nonce:typeof M.nonce=="string"?M.nonce:void 0})}},No.preinitModule=function(C,M){if(typeof C=="string")if(typeof M=="object"&&M!==null){if(M.as==null||M.as==="script"){var D=s(M.as,M.crossOrigin);f.d.M(C,{crossOrigin:D,integrity:typeof M.integrity=="string"?M.integrity:void 0,nonce:typeof M.nonce=="string"?M.nonce:void 0})}}else M==null&&f.d.M(C)},No.preload=function(C,M){if(typeof C=="string"&&typeof M=="object"&&M!==null&&typeof M.as=="string"){var D=M.as,B=s(D,M.crossOrigin);f.d.L(C,D,{crossOrigin:B,integrity:typeof M.integrity=="string"?M.integrity:void 0,nonce:typeof M.nonce=="string"?M.nonce:void 0,type:typeof M.type=="string"?M.type:void 0,fetchPriority:typeof M.fetchPriority=="string"?M.fetchPriority:void 0,referrerPolicy:typeof M.referrerPolicy=="string"?M.referrerPolicy:void 0,imageSrcSet:typeof M.imageSrcSet=="string"?M.imageSrcSet:void 0,imageSizes:typeof M.imageSizes=="string"?M.imageSizes:void 0,media:typeof M.media=="string"?M.media:void 0})}},No.preloadModule=function(C,M){if(typeof C=="string")if(M){var D=s(M.as,M.crossOrigin);f.d.m(C,{as:typeof M.as=="string"&&M.as!=="script"?M.as:void 0,crossOrigin:D,integrity:typeof M.integrity=="string"?M.integrity:void 0})}else f.d.m(C)},No.requestFormReset=function(C){f.d.r(C)},No.unstable_batchedUpdates=function(C,M){return C(M)},No.useFormState=function(C,M,D){return _.H.useFormState(C,M,D)},No.useFormStatus=function(){return _.H.useHostTransitionStatus()},No.version="19.2.3",No}var Y1;function rT(){if(Y1)return uy.exports;Y1=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(u){console.error(u)}}return r(),uy.exports=tT(),uy.exports}var K1;function nT(){if(K1)return cg;K1=1;var r=eT(),u=Xy(),l=rT();function f(i){var c="https://react.dev/errors/"+i;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)c+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+i+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function p(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function b(i){var c=i,g=i;if(i.alternate)for(;c.return;)c=c.return;else{i=c;do c=i,(c.flags&4098)!==0&&(g=c.return),i=c.return;while(i)}return c.tag===3?g:null}function _(i){if(i.tag===13){var c=i.memoizedState;if(c===null&&(i=i.alternate,i!==null&&(c=i.memoizedState)),c!==null)return c.dehydrated}return null}function s(i){if(i.tag===31){var c=i.memoizedState;if(c===null&&(i=i.alternate,i!==null&&(c=i.memoizedState)),c!==null)return c.dehydrated}return null}function C(i){if(b(i)!==i)throw Error(f(188))}function M(i){var c=i.alternate;if(!c){if(c=b(i),c===null)throw Error(f(188));return c!==i?null:i}for(var g=i,T=c;;){var I=g.return;if(I===null)break;var L=I.alternate;if(L===null){if(T=I.return,T!==null){g=T;continue}break}if(I.child===L.child){for(L=I.child;L;){if(L===g)return C(I),i;if(L===T)return C(I),c;L=L.sibling}throw Error(f(188))}if(g.return!==T.return)g=I,T=L;else{for(var ne=!1,Ae=I.child;Ae;){if(Ae===g){ne=!0,g=I,T=L;break}if(Ae===T){ne=!0,T=I,g=L;break}Ae=Ae.sibling}if(!ne){for(Ae=L.child;Ae;){if(Ae===g){ne=!0,g=L,T=I;break}if(Ae===T){ne=!0,T=L,g=I;break}Ae=Ae.sibling}if(!ne)throw Error(f(189))}}if(g.alternate!==T)throw Error(f(190))}if(g.tag!==3)throw Error(f(188));return g.stateNode.current===g?i:c}function D(i){var c=i.tag;if(c===5||c===26||c===27||c===6)return i;for(i=i.child;i!==null;){if(c=D(i),c!==null)return c;i=i.sibling}return null}var B=Object.assign,U=Symbol.for("react.element"),j=Symbol.for("react.transitional.element"),H=Symbol.for("react.portal"),z=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),Z=Symbol.for("react.profiler"),Y=Symbol.for("react.consumer"),W=Symbol.for("react.context"),de=Symbol.for("react.forward_ref"),ge=Symbol.for("react.suspense"),ve=Symbol.for("react.suspense_list"),ie=Symbol.for("react.memo"),Me=Symbol.for("react.lazy"),we=Symbol.for("react.activity"),Ge=Symbol.for("react.memo_cache_sentinel"),et=Symbol.iterator;function pe(i){return i===null||typeof i!="object"?null:(i=et&&i[et]||i["@@iterator"],typeof i=="function"?i:null)}var Je=Symbol.for("react.client.reference");function le(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===Je?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case z:return"Fragment";case Z:return"Profiler";case N:return"StrictMode";case ge:return"Suspense";case ve:return"SuspenseList";case we:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case H:return"Portal";case W:return i.displayName||"Context";case Y:return(i._context.displayName||"Context")+".Consumer";case de:var c=i.render;return i=i.displayName,i||(i=c.displayName||c.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case ie:return c=i.displayName||null,c!==null?c:le(i.type)||"Memo";case Me:c=i._payload,i=i._init;try{return le(i(c))}catch{}}return null}var ut=Array.isArray,tt=u.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,We=l.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$t={pending:!1,data:null,method:null,action:null},Be=[],Mt=-1;function me(i){return{current:i}}function re(i){0>Mt||(i.current=Be[Mt],Be[Mt]=null,Mt--)}function Ve(i,c){Mt++,Be[Mt]=i.current,i.current=c}var Pe=me(null),De=me(null),bt=me(null),Vt=me(null);function Zt(i,c){switch(Ve(bt,c),Ve(De,i),Ve(Pe,null),c.nodeType){case 9:case 11:i=(i=c.documentElement)&&(i=i.namespaceURI)?Mh(i):0;break;default:if(i=c.tagName,c=c.namespaceURI)c=Mh(c),i=Bm(c,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}re(Pe),Ve(Pe,i)}function jt(){re(Pe),re(De),re(bt)}function Yt(i){i.memoizedState!==null&&Ve(Vt,i);var c=Pe.current,g=Bm(c,i.type);c!==g&&(Ve(De,i),Ve(Pe,g))}function jr(i){De.current===i&&(re(Pe),re(De)),Vt.current===i&&(re(Vt),cd._currentValue=$t)}var Qe,_n;function se(i){if(Qe===void 0)try{throw Error()}catch(g){var c=g.stack.trim().match(/\n( *(at )?)/);Qe=c&&c[1]||"",_n=-1<g.stack.indexOf(`
    at`)?" (<anonymous>)":-1<g.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Qe+i+_n}var Rt=!1;function yt(i,c){if(!i||Rt)return"";Rt=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var T={DetermineComponentFrameRoot:function(){try{if(c){var or=function(){throw Error()};if(Object.defineProperty(or.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(or,[])}catch(Gt){var Ot=Gt}Reflect.construct(i,[],or)}else{try{or.call()}catch(Gt){Ot=Gt}i.call(or.prototype)}}else{try{throw Error()}catch(Gt){Ot=Gt}(or=i())&&typeof or.catch=="function"&&or.catch(function(){})}}catch(Gt){if(Gt&&Ot&&typeof Gt.stack=="string")return[Gt.stack,Ot.stack]}return[null,null]}};T.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var I=Object.getOwnPropertyDescriptor(T.DetermineComponentFrameRoot,"name");I&&I.configurable&&Object.defineProperty(T.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var L=T.DetermineComponentFrameRoot(),ne=L[0],Ae=L[1];if(ne&&Ae){var ct=ne.split(`
`),zt=Ae.split(`
`);for(I=T=0;T<ct.length&&!ct[T].includes("DetermineComponentFrameRoot");)T++;for(;I<zt.length&&!zt[I].includes("DetermineComponentFrameRoot");)I++;if(T===ct.length||I===zt.length)for(T=ct.length-1,I=zt.length-1;1<=T&&0<=I&&ct[T]!==zt[I];)I--;for(;1<=T&&0<=I;T--,I--)if(ct[T]!==zt[I]){if(T!==1||I!==1)do if(T--,I--,0>I||ct[T]!==zt[I]){var Qt=`
`+ct[T].replace(" at new "," at ");return i.displayName&&Qt.includes("<anonymous>")&&(Qt=Qt.replace("<anonymous>",i.displayName)),Qt}while(1<=T&&0<=I);break}}}finally{Rt=!1,Error.prepareStackTrace=g}return(g=i?i.displayName||i.name:"")?se(g):""}function Ee(i,c){switch(i.tag){case 26:case 27:case 5:return se(i.type);case 16:return se("Lazy");case 13:return i.child!==c&&c!==null?se("Suspense Fallback"):se("Suspense");case 19:return se("SuspenseList");case 0:case 15:return yt(i.type,!1);case 11:return yt(i.type.render,!1);case 1:return yt(i.type,!0);case 31:return se("Activity");default:return""}}function Ne(i){try{var c="",g=null;do c+=Ee(i,g),g=i,i=i.return;while(i);return c}catch(T){return`
Error generating stack: `+T.message+`
`+T.stack}}var dt=Object.prototype.hasOwnProperty,Kt=r.unstable_scheduleCallback,Jt=r.unstable_cancelCallback,kt=r.unstable_shouldYield,lr=r.unstable_requestPaint,pr=r.unstable_now,sr=r.unstable_getCurrentPriorityLevel,st=r.unstable_ImmediatePriority,fe=r.unstable_UserBlockingPriority,ue=r.unstable_NormalPriority,ye=r.unstable_LowPriority,je=r.unstable_IdlePriority,$e=r.log,_t=r.unstable_setDisableYieldValue,lt=null,at=null;function vt(i){if(typeof $e=="function"&&_t(i),at&&typeof at.setStrictMode=="function")try{at.setStrictMode(lt,i)}catch{}}var Bt=Math.clz32?Math.clz32:hr,Ht=Math.log,Tr=Math.LN2;function hr(i){return i>>>=0,i===0?32:31-(Ht(i)/Tr|0)|0}var Gr=256,xn=262144,an=4194304;function xt(i){var c=i&42;if(c!==0)return c;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Ln(i,c,g){var T=i.pendingLanes;if(T===0)return 0;var I=0,L=i.suspendedLanes,ne=i.pingedLanes;i=i.warmLanes;var Ae=T&134217727;return Ae!==0?(T=Ae&~L,T!==0?I=xt(T):(ne&=Ae,ne!==0?I=xt(ne):g||(g=Ae&~i,g!==0&&(I=xt(g))))):(Ae=T&~L,Ae!==0?I=xt(Ae):ne!==0?I=xt(ne):g||(g=T&~i,g!==0&&(I=xt(g)))),I===0?0:c!==0&&c!==I&&(c&L)===0&&(L=I&-I,g=c&-c,L>=g||L===32&&(g&4194048)!==0)?c:I}function ya(i,c){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&c)===0}function Mr(i,c){switch(i){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Fn(){var i=an;return an<<=1,(an&62914560)===0&&(an=4194304),i}function Ga(i){for(var c=[],g=0;31>g;g++)c.push(i);return c}function Vn(i,c){i.pendingLanes|=c,c!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function va(i,c,g,T,I,L){var ne=i.pendingLanes;i.pendingLanes=g,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=g,i.entangledLanes&=g,i.errorRecoveryDisabledLanes&=g,i.shellSuspendCounter=0;var Ae=i.entanglements,ct=i.expirationTimes,zt=i.hiddenUpdates;for(g=ne&~g;0<g;){var Qt=31-Bt(g),or=1<<Qt;Ae[Qt]=0,ct[Qt]=-1;var Ot=zt[Qt];if(Ot!==null)for(zt[Qt]=null,Qt=0;Qt<Ot.length;Qt++){var Gt=Ot[Qt];Gt!==null&&(Gt.lane&=-536870913)}g&=~or}T!==0&&gn(i,T,0),L!==0&&I===0&&i.tag!==0&&(i.suspendedLanes|=L&~(ne&~c))}function gn(i,c,g){i.pendingLanes|=c,i.suspendedLanes&=~c;var T=31-Bt(c);i.entangledLanes|=c,i.entanglements[T]=i.entanglements[T]|1073741824|g&261930}function ga(i,c){var g=i.entangledLanes|=c;for(i=i.entanglements;g;){var T=31-Bt(g),I=1<<T;I&c|i[T]&c&&(i[T]|=c),g&=~I}}function Yi(i,c){var g=c&-c;return g=(g&42)!==0?1:xo(g),(g&(i.suspendedLanes|c))!==0?0:g}function xo(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Xt(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function xe(){var i=We.p;return i!==0?i:(i=window.event,i===void 0?32:bf(i.type))}function Ue(i,c){var g=We.p;try{return We.p=i,c()}finally{We.p=g}}var Fe=Math.random().toString(36).slice(2),Re="__reactFiber$"+Fe,Te="__reactProps$"+Fe,ze="__reactContainer$"+Fe,mt="__reactEvents$"+Fe,Ut="__reactListeners$"+Fe,It="__reactHandles$"+Fe,Tt="__reactResources$"+Fe,gt="__reactMarker$"+Fe;function ir(i){delete i[Re],delete i[Te],delete i[mt],delete i[Ut],delete i[It]}function vr(i){var c=i[Re];if(c)return c;for(var g=i.parentNode;g;){if(c=g[ze]||g[Re]){if(g=c.alternate,c.child!==null||g!==null&&g.child!==null)for(i=tp(i);i!==null;){if(g=i[Re])return g;i=tp(i)}return c}i=g,g=i.parentNode}return null}function Sr(i){if(i=i[Re]||i[ze]){var c=i.tag;if(c===5||c===6||c===13||c===31||c===26||c===27||c===3)return i}return null}function dr(i){var c=i.tag;if(c===5||c===26||c===27||c===6)return i.stateNode;throw Error(f(33))}function xr(i){var c=i[Tt];return c||(c=i[Tt]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function Nr(i){i[gt]=!0}var Wn=new Set,mn={};function tn(i,c){oi(i,c),oi(i+"Capture",c)}function oi(i,c){for(mn[i]=c,i=0;i<c.length;i++)Wn.add(c[i])}var xs=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),li={},wi={};function za(i){return dt.call(wi,i)?!0:dt.call(li,i)?!1:xs.test(i)?wi[i]=!0:(li[i]=!0,!1)}function Ti(i,c,g){if(za(c))if(g===null)i.removeAttribute(c);else{switch(typeof g){case"undefined":case"function":case"symbol":i.removeAttribute(c);return;case"boolean":var T=c.toLowerCase().slice(0,5);if(T!=="data-"&&T!=="aria-"){i.removeAttribute(c);return}}i.setAttribute(c,""+g)}}function ss(i,c,g){if(g===null)i.removeAttribute(c);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(c);return}i.setAttribute(c,""+g)}}function os(i,c,g,T){if(T===null)i.removeAttribute(g);else{switch(typeof T){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(g);return}i.setAttributeNS(c,g,""+T)}}function Dn(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Zh(i){var c=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function hu(i,c,g){var T=Object.getOwnPropertyDescriptor(i.constructor.prototype,c);if(!i.hasOwnProperty(c)&&typeof T<"u"&&typeof T.get=="function"&&typeof T.set=="function"){var I=T.get,L=T.set;return Object.defineProperty(i,c,{configurable:!0,get:function(){return I.call(this)},set:function(ne){g=""+ne,L.call(this,ne)}}),Object.defineProperty(i,c,{enumerable:T.enumerable}),{getValue:function(){return g},setValue:function(ne){g=""+ne},stopTracking:function(){i._valueTracker=null,delete i[c]}}}}function Ki(i){if(!i._valueTracker){var c=Zh(i)?"checked":"value";i._valueTracker=hu(i,c,""+i[c])}}function ih(i){if(!i)return!1;var c=i._valueTracker;if(!c)return!0;var g=c.getValue(),T="";return i&&(T=Zh(i)?i.checked?"true":"false":i.value),i=T,i!==g?(c.setValue(i),!0):!1}function Wo(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var Pf=/[\n"\\]/g;function gi(i){return i.replace(Pf,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function fu(i,c,g,T,I,L,ne,Ae){i.name="",ne!=null&&typeof ne!="function"&&typeof ne!="symbol"&&typeof ne!="boolean"?i.type=ne:i.removeAttribute("type"),c!=null?ne==="number"?(c===0&&i.value===""||i.value!=c)&&(i.value=""+Dn(c)):i.value!==""+Dn(c)&&(i.value=""+Dn(c)):ne!=="submit"&&ne!=="reset"||i.removeAttribute("value"),c!=null?du(i,ne,Dn(c)):g!=null?du(i,ne,Dn(g)):T!=null&&i.removeAttribute("value"),I==null&&L!=null&&(i.defaultChecked=!!L),I!=null&&(i.checked=I&&typeof I!="function"&&typeof I!="symbol"),Ae!=null&&typeof Ae!="function"&&typeof Ae!="symbol"&&typeof Ae!="boolean"?i.name=""+Dn(Ae):i.removeAttribute("name")}function Sl(i,c,g,T,I,L,ne,Ae){if(L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"&&(i.type=L),c!=null||g!=null){if(!(L!=="submit"&&L!=="reset"||c!=null)){Ki(i);return}g=g!=null?""+Dn(g):"",c=c!=null?""+Dn(c):g,Ae||c===i.value||(i.value=c),i.defaultValue=c}T=T??I,T=typeof T!="function"&&typeof T!="symbol"&&!!T,i.checked=Ae?i.checked:!!T,i.defaultChecked=!!T,ne!=null&&typeof ne!="function"&&typeof ne!="symbol"&&typeof ne!="boolean"&&(i.name=ne),Ki(i)}function du(i,c,g){c==="number"&&Wo(i.ownerDocument)===i||i.defaultValue===""+g||(i.defaultValue=""+g)}function Ms(i,c,g,T){if(i=i.options,c){c={};for(var I=0;I<g.length;I++)c["$"+g[I]]=!0;for(g=0;g<i.length;g++)I=c.hasOwnProperty("$"+i[g].value),i[g].selected!==I&&(i[g].selected=I),I&&T&&(i[g].defaultSelected=!0)}else{for(g=""+Dn(g),c=null,I=0;I<i.length;I++){if(i[I].value===g){i[I].selected=!0,T&&(i[I].defaultSelected=!0);return}c!==null||i[I].disabled||(c=i[I])}c!==null&&(c.selected=!0)}}function Wh(i,c,g){if(c!=null&&(c=""+Dn(c),c!==i.value&&(i.value=c),g==null)){i.defaultValue!==c&&(i.defaultValue=c);return}i.defaultValue=g!=null?""+Dn(g):""}function Jl(i,c,g,T){if(c==null){if(T!=null){if(g!=null)throw Error(f(92));if(ut(T)){if(1<T.length)throw Error(f(93));T=T[0]}g=T}g==null&&(g=""),c=g}g=Dn(c),i.defaultValue=g,T=i.textContent,T===g&&T!==""&&T!==null&&(i.value=T),Ki(i)}function Ks(i,c){if(c){var g=i.firstChild;if(g&&g===i.lastChild&&g.nodeType===3){g.nodeValue=c;return}}i.textContent=c}var sh=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function $o(i,c,g){var T=c.indexOf("--")===0;g==null||typeof g=="boolean"||g===""?T?i.setProperty(c,""):c==="float"?i.cssFloat="":i[c]="":T?i.setProperty(c,g):typeof g!="number"||g===0||sh.has(c)?c==="float"?i.cssFloat=g:i[c]=(""+g).trim():i[c]=g+"px"}function Pc(i,c,g){if(c!=null&&typeof c!="object")throw Error(f(62));if(i=i.style,g!=null){for(var T in g)!g.hasOwnProperty(T)||c!=null&&c.hasOwnProperty(T)||(T.indexOf("--")===0?i.setProperty(T,""):T==="float"?i.cssFloat="":i[T]="");for(var I in c)T=c[I],c.hasOwnProperty(I)&&g[I]!==T&&$o(i,I,T)}else for(var L in c)c.hasOwnProperty(L)&&$o(i,L,c[L])}function yo(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Js=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ql=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function fn(i){return Ql.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function Ds(){}var ec=null;function pu(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var ba=null,Ha=null;function wa(i){var c=Sr(i);if(c&&(i=c.stateNode)){var g=i[Te]||null;e:switch(i=c.stateNode,c.type){case"input":if(fu(i,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name),c=g.name,g.type==="radio"&&c!=null){for(g=i;g.parentNode;)g=g.parentNode;for(g=g.querySelectorAll('input[name="'+gi(""+c)+'"][type="radio"]'),c=0;c<g.length;c++){var T=g[c];if(T!==i&&T.form===i.form){var I=T[Te]||null;if(!I)throw Error(f(90));fu(T,I.value,I.defaultValue,I.defaultValue,I.checked,I.defaultChecked,I.type,I.name)}}for(c=0;c<g.length;c++)T=g[c],T.form===i.form&&ih(T)}break e;case"textarea":Wh(i,g.value,g.defaultValue);break e;case"select":c=g.value,c!=null&&Ms(i,!!g.multiple,c,!1)}}}var Qr=!1;function Yn(i,c,g){if(Qr)return i(c,g);Qr=!0;try{var T=i(c);return T}finally{if(Qr=!1,(ba!==null||Ha!==null)&&(Wd(),ba&&(c=ba,i=Ha,Ha=ba=null,wa(c),i)))for(c=0;c<i.length;c++)wa(i[c])}}function ys(i,c){var g=i.stateNode;if(g===null)return null;var T=g[Te]||null;if(T===null)return null;g=T[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(T=!T.disabled)||(i=i.type,T=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!T;break e;default:i=!1}if(i)return null;if(g&&typeof g!="function")throw Error(f(231,c,typeof g));return g}var zn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Oa=!1;if(zn)try{var la={};Object.defineProperty(la,"passive",{get:function(){Oa=!0}}),window.addEventListener("test",la,la),window.removeEventListener("test",la,la)}catch{Oa=!1}var _a=null,vo=null,Rn=null;function Si(){if(Rn)return Rn;var i,c=vo,g=c.length,T,I="value"in _a?_a.value:_a.textContent,L=I.length;for(i=0;i<g&&c[i]===I[i];i++);var ne=g-i;for(T=1;T<=ne&&c[g-T]===I[L-T];T++);return Rn=I.slice(i,1<T?1-T:void 0)}function ri(i){var c=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&c===13&&(i=13)):i=c,i===10&&(i=13),32<=i||i===13?i:0}function Qs(){return!0}function Ri(){return!1}function qa(i){function c(g,T,I,L,ne){this._reactName=g,this._targetInst=I,this.type=T,this.nativeEvent=L,this.target=ne,this.currentTarget=null;for(var Ae in i)i.hasOwnProperty(Ae)&&(g=i[Ae],this[Ae]=g?g(L):L[Ae]);return this.isDefaultPrevented=(L.defaultPrevented!=null?L.defaultPrevented:L.returnValue===!1)?Qs:Ri,this.isPropagationStopped=Ri,this}return B(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():typeof g.returnValue!="unknown"&&(g.returnValue=!1),this.isDefaultPrevented=Qs)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():typeof g.cancelBubble!="unknown"&&(g.cancelBubble=!0),this.isPropagationStopped=Qs)},persist:function(){},isPersistent:Qs}),c}var Da={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},El=qa(Da),Al=B({},Da,{view:0,detail:0}),ls=qa(Al),Zn,Xo,cn,sn=B({},Al,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ko,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==cn&&(cn&&i.type==="mousemove"?(Zn=i.screenX-cn.screenX,Xo=i.screenY-cn.screenY):Xo=Zn=0,cn=i),Zn)},movementY:function(i){return"movementY"in i?i.movementY:Xo}}),bo=qa(sn),bn=B({},sn,{dataTransfer:0}),Fc=qa(bn),_i=B({},Al,{relatedTarget:0}),Rs=qa(_i),Ji=B({},Da,{animationName:0,elapsedTime:0,pseudoElement:0}),oh=qa(Ji),vs=B({},Da,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),tc=qa(vs),Lc=B({},Da,{data:0}),mu=qa(Lc),Ii={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ci={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ca={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Yo(i){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(i):(i=ca[i])?!!c[i]:!1}function Ko(){return Yo}var gu=B({},Al,{key:function(i){if(i.key){var c=Ii[i.key]||i.key;if(c!=="Unidentified")return c}return i.type==="keypress"?(i=ri(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?ci[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ko,charCode:function(i){return i.type==="keypress"?ri(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?ri(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Ta=qa(gu),$h=B({},sn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Gn=qa($h),_u=B({},Al,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ko}),Kn=qa(_u),wo=B({},Da,{propertyName:0,elapsedTime:0,pseudoElement:0}),kl=qa(wo),Cl=B({},sn,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Ml=qa(Cl),rc=B({},Da,{newState:0,oldState:0}),Jo=qa(rc),nc=[9,13,27,32],Ra=zn&&"CompositionEvent"in window,To=null;zn&&"documentMode"in document&&(To=document.documentMode);var ac=zn&&"TextEvent"in window&&!To,So=zn&&(!Ra||To&&8<To&&11>=To),eo=" ",lh=!1;function Dl(i,c){switch(i){case"keyup":return nc.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xh(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Is=!1;function xu(i,c){switch(i){case"compositionend":return Xh(c);case"keypress":return c.which!==32?null:(lh=!0,eo);case"textInput":return i=c.data,i===eo&&lh?null:i;default:return null}}function Za(i,c){if(Is)return i==="compositionend"||!Ra&&Dl(i,c)?(i=Si(),Rn=vo=_a=null,Is=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return So&&c.locale!=="ko"?null:c.data;default:return null}}var Qo={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Aa(i){var c=i&&i.nodeName&&i.nodeName.toLowerCase();return c==="input"?!!Qo[i.type]:c==="textarea"}function bs(i,c,g,T){ba?Ha?Ha.push(T):Ha=[T]:ba=T,c=Kd(c,"onChange"),0<c.length&&(g=new El("onChange","change",null,g,T),i.push({event:g,listeners:c}))}var Ps=null,Rl=null;function zc(i){C_(i,0)}function Qi(i){var c=dr(i);if(ih(c))return i}function el(i,c){if(i==="change")return c}var Il=!1;if(zn){var ic;if(zn){var tl="oninput"in document;if(!tl){var to=document.createElement("div");to.setAttribute("oninput","return;"),tl=typeof to.oninput=="function"}ic=tl}else ic=!1;Il=ic&&(!document.documentMode||9<document.documentMode)}function Oc(){Ps&&(Ps.detachEvent("onpropertychange",Bc),Rl=Ps=null)}function Bc(i){if(i.propertyName==="value"&&Qi(Rl)){var c=[];bs(c,Rl,i,pu(i)),Yn(zc,c)}}function Pl(i,c,g){i==="focusin"?(Oc(),Ps=c,Rl=g,Ps.attachEvent("onpropertychange",Bc)):i==="focusout"&&Oc()}function ch(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Qi(Rl)}function Fs(i,c){if(i==="click")return Qi(c)}function ro(i,c){if(i==="input"||i==="change")return Qi(c)}function Nc(i,c){return i===c&&(i!==0||1/i===1/c)||i!==i&&c!==c}var es=typeof Object.is=="function"?Object.is:Nc;function Fl(i,c){if(es(i,c))return!0;if(typeof i!="object"||i===null||typeof c!="object"||c===null)return!1;var g=Object.keys(i),T=Object.keys(c);if(g.length!==T.length)return!1;for(T=0;T<g.length;T++){var I=g[T];if(!dt.call(c,I)||!es(i[I],c[I]))return!1}return!0}function Ls(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function yu(i,c){var g=Ls(i);i=0;for(var T;g;){if(g.nodeType===3){if(T=i+g.textContent.length,i<=c&&T>=c)return{node:g,offset:c-i};i=T}e:{for(;g;){if(g.nextSibling){g=g.nextSibling;break e}g=g.parentNode}g=void 0}g=Ls(g)}}function uh(i,c){return i&&c?i===c?!0:i&&i.nodeType===3?!1:c&&c.nodeType===3?uh(i,c.parentNode):"contains"in i?i.contains(c):i.compareDocumentPosition?!!(i.compareDocumentPosition(c)&16):!1:!1}function vu(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var c=Wo(i.document);c instanceof i.HTMLIFrameElement;){try{var g=typeof c.contentWindow.location.href=="string"}catch{g=!1}if(g)i=c.contentWindow;else break;c=Wo(i.document)}return c}function Ll(i){var c=i&&i.nodeName&&i.nodeName.toLowerCase();return c&&(c==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||c==="textarea"||i.contentEditable==="true")}var jc=zn&&"documentMode"in document&&11>=document.documentMode,ws=null,sc=null,oc=null,bu=!1;function wu(i,c,g){var T=g.window===g?g.document:g.nodeType===9?g:g.ownerDocument;bu||ws==null||ws!==Wo(T)||(T=ws,"selectionStart"in T&&Ll(T)?T={start:T.selectionStart,end:T.selectionEnd}:(T=(T.ownerDocument&&T.ownerDocument.defaultView||window).getSelection(),T={anchorNode:T.anchorNode,anchorOffset:T.anchorOffset,focusNode:T.focusNode,focusOffset:T.focusOffset}),oc&&Fl(oc,T)||(oc=T,T=Kd(sc,"onSelect"),0<T.length&&(c=new El("onSelect","select",null,c,g),i.push({event:c,listeners:T}),c.target=ws)))}function lc(i,c){var g={};return g[i.toLowerCase()]=c.toLowerCase(),g["Webkit"+i]="webkit"+c,g["Moz"+i]="moz"+c,g}var zl={animationend:lc("Animation","AnimationEnd"),animationiteration:lc("Animation","AnimationIteration"),animationstart:lc("Animation","AnimationStart"),transitionrun:lc("Transition","TransitionRun"),transitionstart:lc("Transition","TransitionStart"),transitioncancel:lc("Transition","TransitionCancel"),transitionend:lc("Transition","TransitionEnd")},Uc={},En={};zn&&(En=document.createElement("div").style,"AnimationEvent"in window||(delete zl.animationend.animation,delete zl.animationiteration.animation,delete zl.animationstart.animation),"TransitionEvent"in window||delete zl.transitionend.transition);function Eo(i){if(Uc[i])return Uc[i];if(!zl[i])return i;var c=zl[i],g;for(g in c)if(c.hasOwnProperty(g)&&g in En)return Uc[i]=c[g];return i}var Tu=Eo("animationend"),Su=Eo("animationiteration"),hh=Eo("animationstart"),cc=Eo("transitionrun"),Ao=Eo("transitionstart"),uc=Eo("transitioncancel"),Pi=Eo("transitionend"),fh=new Map,rl="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");rl.push("scrollEnd");function cs(i,c){fh.set(i,c),tn(c,[i])}var zs=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},Ei=[],no=0,hc=0;function fc(){for(var i=no,c=hc=no=0;c<i;){var g=Ei[c];Ei[c++]=null;var T=Ei[c];Ei[c++]=null;var I=Ei[c];Ei[c++]=null;var L=Ei[c];if(Ei[c++]=null,T!==null&&I!==null){var ne=T.pending;ne===null?I.next=I:(I.next=ne.next,ne.next=I),T.pending=I}L!==0&&dh(g,I,L)}}function Vc(i,c,g,T){Ei[no++]=i,Ei[no++]=c,Ei[no++]=g,Ei[no++]=T,hc|=T,i.lanes|=T,i=i.alternate,i!==null&&(i.lanes|=T)}function ao(i,c,g,T){return Vc(i,c,g,T),Gc(i)}function Os(i,c){return Vc(i,null,null,c),Gc(i)}function dh(i,c,g){i.lanes|=g;var T=i.alternate;T!==null&&(T.lanes|=g);for(var I=!1,L=i.return;L!==null;)L.childLanes|=g,T=L.alternate,T!==null&&(T.childLanes|=g),L.tag===22&&(i=L.stateNode,i===null||i._visibility&1||(I=!0)),i=L,L=L.return;return i.tag===3?(L=i.stateNode,I&&c!==null&&(I=31-Bt(g),i=L.hiddenUpdates,T=i[I],T===null?i[I]=[c]:T.push(c),c.lane=g|536870912),L):null}function Gc(i){if(50<Zd)throw Zd=0,wm=null,Error(f(185));for(var c=i.return;c!==null;)i=c,c=i.return;return i.tag===3?i.stateNode:null}var dn={};function ph(i,c,g,T){this.tag=i,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=T,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ts(i,c,g,T){return new ph(i,c,g,T)}function ee(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Ke(i,c){var g=i.alternate;return g===null?(g=Ts(i.tag,c,i.key,i.mode),g.elementType=i.elementType,g.type=i.type,g.stateNode=i.stateNode,g.alternate=i,i.alternate=g):(g.pendingProps=c,g.type=i.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=i.flags&65011712,g.childLanes=i.childLanes,g.lanes=i.lanes,g.child=i.child,g.memoizedProps=i.memoizedProps,g.memoizedState=i.memoizedState,g.updateQueue=i.updateQueue,c=i.dependencies,g.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},g.sibling=i.sibling,g.index=i.index,g.ref=i.ref,g.refCleanup=i.refCleanup,g}function ht(i,c){i.flags&=65011714;var g=i.alternate;return g===null?(i.childLanes=0,i.lanes=c,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=g.childLanes,i.lanes=g.lanes,i.child=g.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=g.memoizedProps,i.memoizedState=g.memoizedState,i.updateQueue=g.updateQueue,i.type=g.type,c=g.dependencies,i.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),i}function er(i,c,g,T,I,L){var ne=0;if(T=i,typeof i=="function")ee(i)&&(ne=1);else if(typeof i=="string")ne=E0(i,g,Pe.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case we:return i=Ts(31,g,c,I),i.elementType=we,i.lanes=L,i;case z:return St(g.children,I,L,c);case N:ne=8,I|=24;break;case Z:return i=Ts(12,g,c,I|2),i.elementType=Z,i.lanes=L,i;case ge:return i=Ts(13,g,c,I),i.elementType=ge,i.lanes=L,i;case ve:return i=Ts(19,g,c,I),i.elementType=ve,i.lanes=L,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case W:ne=10;break e;case Y:ne=9;break e;case de:ne=11;break e;case ie:ne=14;break e;case Me:ne=16,T=null;break e}ne=29,g=Error(f(130,i===null?"null":typeof i,"")),T=null}return c=Ts(ne,g,c,I),c.elementType=i,c.type=T,c.lanes=L,c}function St(i,c,g,T){return i=Ts(7,i,T,c),i.lanes=g,i}function _r(i,c,g){return i=Ts(6,i,null,c),i.lanes=g,i}function Kr(i){var c=Ts(18,null,null,0);return c.stateNode=i,c}function un(i,c,g){return c=Ts(4,i.children!==null?i.children:[],i.key,c),c.lanes=g,c.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},c}var Jr=new WeakMap;function Or(i,c){if(typeof i=="object"&&i!==null){var g=Jr.get(i);return g!==void 0?g:(c={value:i,source:c,stack:Ne(c)},Jr.set(i,c),c)}return{value:i,source:c,stack:Ne(c)}}var Lr=[],Ur=0,mr=null,Dr=0,Ar=[],yr=0,Ir=null,pn=1,gr="";function Fr(i,c){Lr[Ur++]=Dr,Lr[Ur++]=mr,mr=i,Dr=c}function yn(i,c,g){Ar[yr++]=pn,Ar[yr++]=gr,Ar[yr++]=Ir,Ir=i;var T=pn;i=gr;var I=32-Bt(T)-1;T&=~(1<<I),g+=1;var L=32-Bt(c)+I;if(30<L){var ne=I-I%5;L=(T&(1<<ne)-1).toString(32),T>>=ne,I-=ne,pn=1<<32-Bt(c)+I|g<<I|T,gr=L+i}else pn=1<<L|g<<I|T,gr=i}function Wr(i){i.return!==null&&(Fr(i,1),yn(i,1,0))}function ln(i){for(;i===mr;)mr=Lr[--Ur],Lr[Ur]=null,Dr=Lr[--Ur],Lr[Ur]=null;for(;i===Ir;)Ir=Ar[--yr],Ar[yr]=null,gr=Ar[--yr],Ar[yr]=null,pn=Ar[--yr],Ar[yr]=null}function Vr(i,c){Ar[yr++]=pn,Ar[yr++]=gr,Ar[yr++]=Ir,pn=c.id,gr=c.overflow,Ir=i}var en=null,$r=null,Yr=!1,Xr=null,On=!1,Cn=Error(f(519));function Wa(i){var c=Error(f(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw io(Or(c,i)),Cn}function $a(i){var c=i.stateNode,g=i.type,T=i.memoizedProps;switch(c[Re]=i,c[Te]=T,g){case"dialog":Un("cancel",c),Un("close",c);break;case"iframe":case"object":case"embed":Un("load",c);break;case"video":case"audio":for(g=0;g<Ch.length;g++)Un(Ch[g],c);break;case"source":Un("error",c);break;case"img":case"image":case"link":Un("error",c),Un("load",c);break;case"details":Un("toggle",c);break;case"input":Un("invalid",c),Sl(c,T.value,T.defaultValue,T.checked,T.defaultChecked,T.type,T.name,!0);break;case"select":Un("invalid",c);break;case"textarea":Un("invalid",c),Jl(c,T.value,T.defaultValue,T.children)}g=T.children,typeof g!="string"&&typeof g!="number"&&typeof g!="bigint"||c.textContent===""+g||T.suppressHydrationWarning===!0||zm(c.textContent,g)?(T.popover!=null&&(Un("beforetoggle",c),Un("toggle",c)),T.onScroll!=null&&Un("scroll",c),T.onScrollEnd!=null&&Un("scrollend",c),T.onClick!=null&&(c.onclick=Ds),c=!0):c=!1,c||Wa(i,!0)}function nl(i){for(en=i.return;en;)switch(en.tag){case 5:case 31:case 13:On=!1;return;case 27:case 3:On=!0;return;default:en=en.return}}function Fi(i){if(i!==en)return!1;if(!Yr)return nl(i),Yr=!0,!1;var c=i.tag,g;if((g=c!==3&&c!==27)&&((g=c===5)&&(g=i.type,g=!(g!=="form"&&g!=="button")||x0(i.type,i.memoizedProps)),g=!g),g&&$r&&Wa(i),nl(i),c===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(f(317));$r=qi(i)}else if(c===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(f(317));$r=qi(i)}else c===27?(c=$r,Rh(i.type)?(i=fo,fo=null,$r=i):$r=c):$r=en?gl(i.stateNode.nextSibling):null;return!0}function Li(){$r=en=null,Yr=!1}function Bs(){var i=Xr;return i!==null&&(Lo===null?Lo=i:Lo.push.apply(Lo,i),Xr=null),i}function io(i){Xr===null?Xr=[i]:Xr.push(i)}var so=me(null),Ba=null,Ai=null;function zi(i,c,g){Ve(so,c._currentValue),c._currentValue=g}function ui(i){i._currentValue=so.current,re(so)}function Ol(i,c,g){for(;i!==null;){var T=i.alternate;if((i.childLanes&c)!==c?(i.childLanes|=c,T!==null&&(T.childLanes|=c)):T!==null&&(T.childLanes&c)!==c&&(T.childLanes|=c),i===g)break;i=i.return}}function mh(i,c,g,T){var I=i.child;for(I!==null&&(I.return=i);I!==null;){var L=I.dependencies;if(L!==null){var ne=I.child;L=L.firstContext;e:for(;L!==null;){var Ae=L;L=I;for(var ct=0;ct<c.length;ct++)if(Ae.context===c[ct]){L.lanes|=g,Ae=L.alternate,Ae!==null&&(Ae.lanes|=g),Ol(L.return,g,i),T||(ne=null);break e}L=Ae.next}}else if(I.tag===18){if(ne=I.return,ne===null)throw Error(f(341));ne.lanes|=g,L=ne.alternate,L!==null&&(L.lanes|=g),Ol(ne,g,i),ne=null}else ne=I.child;if(ne!==null)ne.return=I;else for(ne=I;ne!==null;){if(ne===i){ne=null;break}if(I=ne.sibling,I!==null){I.return=ne.return,ne=I;break}ne=ne.return}I=ne}}function us(i,c,g,T){i=null;for(var I=c,L=!1;I!==null;){if(!L){if((I.flags&524288)!==0)L=!0;else if((I.flags&262144)!==0)break}if(I.tag===10){var ne=I.alternate;if(ne===null)throw Error(f(387));if(ne=ne.memoizedProps,ne!==null){var Ae=I.type;es(I.pendingProps.value,ne.value)||(i!==null?i.push(Ae):i=[Ae])}}else if(I===Vt.current){if(ne=I.alternate,ne===null)throw Error(f(387));ne.memoizedState.memoizedState!==I.memoizedState.memoizedState&&(i!==null?i.push(cd):i=[cd])}I=I.return}i!==null&&mh(c,i,g,T),c.flags|=262144}function dc(i){for(i=i.firstContext;i!==null;){if(!es(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function al(i){Ba=i,Ai=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Xa(i){return gh(Ba,i)}function Eu(i,c){return Ba===null&&al(i),gh(i,c)}function gh(i,c){var g=c._currentValue;if(c={context:c,memoizedValue:g,next:null},Ai===null){if(i===null)throw Error(f(308));Ai=c,i.dependencies={lanes:0,firstContext:c},i.flags|=524288}else Ai=Ai.next=c;return g}var Hc=typeof AbortController<"u"?AbortController:function(){var i=[],c=this.signal={aborted:!1,addEventListener:function(g,T){i.push(T)}};this.abort=function(){c.aborted=!0,i.forEach(function(g){return g()})}},Yh=r.unstable_scheduleCallback,Kh=r.unstable_NormalPriority,Na={$$typeof:W,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ns(){return{controller:new Hc,data:new Map,refCount:0}}function pc(i){i.refCount--,i.refCount===0&&Yh(Kh,function(){i.controller.abort()})}var Oi=null,Ss=0,Bl=0,ki=null;function Ff(i,c){if(Oi===null){var g=Oi=[];Ss=0,Bl=Rm(),ki={status:"pending",value:void 0,then:function(T){g.push(T)}}}return Ss++,c.then(qc,qc),c}function qc(){if(--Ss===0&&Oi!==null){ki!==null&&(ki.status="fulfilled");var i=Oi;Oi=null,Bl=0,ki=null;for(var c=0;c<i.length;c++)(0,i[c])()}}function Au(i,c){var g=[],T={status:"pending",value:null,reason:null,then:function(I){g.push(I)}};return i.then(function(){T.status="fulfilled",T.value=c;for(var I=0;I<g.length;I++)(0,g[I])(c)},function(I){for(T.status="rejected",T.reason=I,I=0;I<g.length;I++)(0,g[I])(void 0)}),T}var Ci=tt.S;tt.S=function(i,c){h_=pr(),typeof c=="object"&&c!==null&&typeof c.then=="function"&&Ff(i,c),Ci!==null&&Ci(i,c)};var il=me(null);function Lf(){var i=il.current;return i!==null?i:Fa.pooledCache}function zf(i,c){c===null?Ve(il,il.current):Ve(il,c.pool)}function Fp(){var i=Lf();return i===null?null:{parent:Na._currentValue,pool:i}}var sl=Error(f(460)),Zc=Error(f(474)),js=Error(f(542)),kr={then:function(){}};function Jh(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Of(i,c,g){switch(g=i[g],g===void 0?i.push(c):g!==c&&(c.then(Ds,Ds),c=g),c.status){case"fulfilled":return c.value;case"rejected":throw i=c.reason,Bf(i),i;default:if(typeof c.status=="string")c.then(Ds,Ds);else{if(i=Fa,i!==null&&100<i.shellSuspendCounter)throw Error(f(482));i=c,i.status="pending",i.then(function(T){if(c.status==="pending"){var I=c;I.status="fulfilled",I.value=T}},function(T){if(c.status==="pending"){var I=c;I.status="rejected",I.reason=T}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw i=c.reason,Bf(i),i}throw ol=c,sl}}function ko(i){try{var c=i._init;return c(i._payload)}catch(g){throw g!==null&&typeof g=="object"&&typeof g.then=="function"?(ol=g,sl):g}}var ol=null;function _h(){if(ol===null)throw Error(f(459));var i=ol;return ol=null,i}function Bf(i){if(i===sl||i===js)throw Error(f(483))}var Nl=null,ku=0;function Qh(i){var c=ku;return ku+=1,Nl===null&&(Nl=[]),Of(Nl,i,c)}function jl(i,c){c=c.props.ref,i.ref=c!==void 0?c:null}function Nf(i,c){throw c.$$typeof===U?Error(f(525)):(i=Object.prototype.toString.call(c),Error(f(31,i==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":i)))}function ef(i){function c(wt,pt){if(i){var Ft=wt.deletions;Ft===null?(wt.deletions=[pt],wt.flags|=16):Ft.push(pt)}}function g(wt,pt){if(!i)return null;for(;pt!==null;)c(wt,pt),pt=pt.sibling;return null}function T(wt){for(var pt=new Map;wt!==null;)wt.key!==null?pt.set(wt.key,wt):pt.set(wt.index,wt),wt=wt.sibling;return pt}function I(wt,pt){return wt=Ke(wt,pt),wt.index=0,wt.sibling=null,wt}function L(wt,pt,Ft){return wt.index=Ft,i?(Ft=wt.alternate,Ft!==null?(Ft=Ft.index,Ft<pt?(wt.flags|=67108866,pt):Ft):(wt.flags|=67108866,pt)):(wt.flags|=1048576,pt)}function ne(wt){return i&&wt.alternate===null&&(wt.flags|=67108866),wt}function Ae(wt,pt,Ft,nr){return pt===null||pt.tag!==6?(pt=_r(Ft,wt.mode,nr),pt.return=wt,pt):(pt=I(pt,Ft),pt.return=wt,pt)}function ct(wt,pt,Ft,nr){var nn=Ft.type;return nn===z?Qt(wt,pt,Ft.props.children,nr,Ft.key):pt!==null&&(pt.elementType===nn||typeof nn=="object"&&nn!==null&&nn.$$typeof===Me&&ko(nn)===pt.type)?(pt=I(pt,Ft.props),jl(pt,Ft),pt.return=wt,pt):(pt=er(Ft.type,Ft.key,Ft.props,null,wt.mode,nr),jl(pt,Ft),pt.return=wt,pt)}function zt(wt,pt,Ft,nr){return pt===null||pt.tag!==4||pt.stateNode.containerInfo!==Ft.containerInfo||pt.stateNode.implementation!==Ft.implementation?(pt=un(Ft,wt.mode,nr),pt.return=wt,pt):(pt=I(pt,Ft.children||[]),pt.return=wt,pt)}function Qt(wt,pt,Ft,nr,nn){return pt===null||pt.tag!==7?(pt=St(Ft,wt.mode,nr,nn),pt.return=wt,pt):(pt=I(pt,Ft),pt.return=wt,pt)}function or(wt,pt,Ft){if(typeof pt=="string"&&pt!==""||typeof pt=="number"||typeof pt=="bigint")return pt=_r(""+pt,wt.mode,Ft),pt.return=wt,pt;if(typeof pt=="object"&&pt!==null){switch(pt.$$typeof){case j:return Ft=er(pt.type,pt.key,pt.props,null,wt.mode,Ft),jl(Ft,pt),Ft.return=wt,Ft;case H:return pt=un(pt,wt.mode,Ft),pt.return=wt,pt;case Me:return pt=ko(pt),or(wt,pt,Ft)}if(ut(pt)||pe(pt))return pt=St(pt,wt.mode,Ft,null),pt.return=wt,pt;if(typeof pt.then=="function")return or(wt,Qh(pt),Ft);if(pt.$$typeof===W)return or(wt,Eu(wt,pt),Ft);Nf(wt,pt)}return null}function Ot(wt,pt,Ft,nr){var nn=pt!==null?pt.key:null;if(typeof Ft=="string"&&Ft!==""||typeof Ft=="number"||typeof Ft=="bigint")return nn!==null?null:Ae(wt,pt,""+Ft,nr);if(typeof Ft=="object"&&Ft!==null){switch(Ft.$$typeof){case j:return Ft.key===nn?ct(wt,pt,Ft,nr):null;case H:return Ft.key===nn?zt(wt,pt,Ft,nr):null;case Me:return Ft=ko(Ft),Ot(wt,pt,Ft,nr)}if(ut(Ft)||pe(Ft))return nn!==null?null:Qt(wt,pt,Ft,nr,null);if(typeof Ft.then=="function")return Ot(wt,pt,Qh(Ft),nr);if(Ft.$$typeof===W)return Ot(wt,pt,Eu(wt,Ft),nr);Nf(wt,Ft)}return null}function Gt(wt,pt,Ft,nr,nn){if(typeof nr=="string"&&nr!==""||typeof nr=="number"||typeof nr=="bigint")return wt=wt.get(Ft)||null,Ae(pt,wt,""+nr,nn);if(typeof nr=="object"&&nr!==null){switch(nr.$$typeof){case j:return wt=wt.get(nr.key===null?Ft:nr.key)||null,ct(pt,wt,nr,nn);case H:return wt=wt.get(nr.key===null?Ft:nr.key)||null,zt(pt,wt,nr,nn);case Me:return nr=ko(nr),Gt(wt,pt,Ft,nr,nn)}if(ut(nr)||pe(nr))return wt=wt.get(Ft)||null,Qt(pt,wt,nr,nn,null);if(typeof nr.then=="function")return Gt(wt,pt,Ft,Qh(nr),nn);if(nr.$$typeof===W)return Gt(wt,pt,Ft,Eu(pt,nr),nn);Nf(pt,nr)}return null}function Hr(wt,pt,Ft,nr){for(var nn=null,aa=null,qr=pt,rn=pt=0,Bn=null;qr!==null&&rn<Ft.length;rn++){qr.index>rn?(Bn=qr,qr=null):Bn=qr.sibling;var ea=Ot(wt,qr,Ft[rn],nr);if(ea===null){qr===null&&(qr=Bn);break}i&&qr&&ea.alternate===null&&c(wt,qr),pt=L(ea,pt,rn),aa===null?nn=ea:aa.sibling=ea,aa=ea,qr=Bn}if(rn===Ft.length)return g(wt,qr),Yr&&Fr(wt,rn),nn;if(qr===null){for(;rn<Ft.length;rn++)qr=or(wt,Ft[rn],nr),qr!==null&&(pt=L(qr,pt,rn),aa===null?nn=qr:aa.sibling=qr,aa=qr);return Yr&&Fr(wt,rn),nn}for(qr=T(qr);rn<Ft.length;rn++)Bn=Gt(qr,wt,rn,Ft[rn],nr),Bn!==null&&(i&&Bn.alternate!==null&&qr.delete(Bn.key===null?rn:Bn.key),pt=L(Bn,pt,rn),aa===null?nn=Bn:aa.sibling=Bn,aa=Bn);return i&&qr.forEach(function($u){return c(wt,$u)}),Yr&&Fr(wt,rn),nn}function on(wt,pt,Ft,nr){if(Ft==null)throw Error(f(151));for(var nn=null,aa=null,qr=pt,rn=pt=0,Bn=null,ea=Ft.next();qr!==null&&!ea.done;rn++,ea=Ft.next()){qr.index>rn?(Bn=qr,qr=null):Bn=qr.sibling;var $u=Ot(wt,qr,ea.value,nr);if($u===null){qr===null&&(qr=Bn);break}i&&qr&&$u.alternate===null&&c(wt,qr),pt=L($u,pt,rn),aa===null?nn=$u:aa.sibling=$u,aa=$u,qr=Bn}if(ea.done)return g(wt,qr),Yr&&Fr(wt,rn),nn;if(qr===null){for(;!ea.done;rn++,ea=Ft.next())ea=or(wt,ea.value,nr),ea!==null&&(pt=L(ea,pt,rn),aa===null?nn=ea:aa.sibling=ea,aa=ea);return Yr&&Fr(wt,rn),nn}for(qr=T(qr);!ea.done;rn++,ea=Ft.next())ea=Gt(qr,wt,rn,ea.value,nr),ea!==null&&(i&&ea.alternate!==null&&qr.delete(ea.key===null?rn:ea.key),pt=L(ea,pt,rn),aa===null?nn=ea:aa.sibling=ea,aa=ea);return i&&qr.forEach(function(ag){return c(wt,ag)}),Yr&&Fr(wt,rn),nn}function Ea(wt,pt,Ft,nr){if(typeof Ft=="object"&&Ft!==null&&Ft.type===z&&Ft.key===null&&(Ft=Ft.props.children),typeof Ft=="object"&&Ft!==null){switch(Ft.$$typeof){case j:e:{for(var nn=Ft.key;pt!==null;){if(pt.key===nn){if(nn=Ft.type,nn===z){if(pt.tag===7){g(wt,pt.sibling),nr=I(pt,Ft.props.children),nr.return=wt,wt=nr;break e}}else if(pt.elementType===nn||typeof nn=="object"&&nn!==null&&nn.$$typeof===Me&&ko(nn)===pt.type){g(wt,pt.sibling),nr=I(pt,Ft.props),jl(nr,Ft),nr.return=wt,wt=nr;break e}g(wt,pt);break}else c(wt,pt);pt=pt.sibling}Ft.type===z?(nr=St(Ft.props.children,wt.mode,nr,Ft.key),nr.return=wt,wt=nr):(nr=er(Ft.type,Ft.key,Ft.props,null,wt.mode,nr),jl(nr,Ft),nr.return=wt,wt=nr)}return ne(wt);case H:e:{for(nn=Ft.key;pt!==null;){if(pt.key===nn)if(pt.tag===4&&pt.stateNode.containerInfo===Ft.containerInfo&&pt.stateNode.implementation===Ft.implementation){g(wt,pt.sibling),nr=I(pt,Ft.children||[]),nr.return=wt,wt=nr;break e}else{g(wt,pt);break}else c(wt,pt);pt=pt.sibling}nr=un(Ft,wt.mode,nr),nr.return=wt,wt=nr}return ne(wt);case Me:return Ft=ko(Ft),Ea(wt,pt,Ft,nr)}if(ut(Ft))return Hr(wt,pt,Ft,nr);if(pe(Ft)){if(nn=pe(Ft),typeof nn!="function")throw Error(f(150));return Ft=nn.call(Ft),on(wt,pt,Ft,nr)}if(typeof Ft.then=="function")return Ea(wt,pt,Qh(Ft),nr);if(Ft.$$typeof===W)return Ea(wt,pt,Eu(wt,Ft),nr);Nf(wt,Ft)}return typeof Ft=="string"&&Ft!==""||typeof Ft=="number"||typeof Ft=="bigint"?(Ft=""+Ft,pt!==null&&pt.tag===6?(g(wt,pt.sibling),nr=I(pt,Ft),nr.return=wt,wt=nr):(g(wt,pt),nr=_r(Ft,wt.mode,nr),nr.return=wt,wt=nr),ne(wt)):g(wt,pt)}return function(wt,pt,Ft,nr){try{ku=0;var nn=Ea(wt,pt,Ft,nr);return Nl=null,nn}catch(qr){if(qr===sl||qr===js)throw qr;var aa=Ts(29,qr,null,wt.mode);return aa.lanes=nr,aa.return=wt,aa}}}var Ul=ef(!0),Ad=ef(!1),Vl=!1;function jf(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function tf(i,c){i=i.updateQueue,c.updateQueue===i&&(c.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Gl(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function mc(i,c,g){var T=i.updateQueue;if(T===null)return null;if(T=T.shared,(fa&2)!==0){var I=T.pending;return I===null?c.next=c:(c.next=I.next,I.next=c),T.pending=c,c=Gc(i),dh(i,null,g),c}return Vc(i,T,c,g),Gc(i)}function Co(i,c,g){if(c=c.updateQueue,c!==null&&(c=c.shared,(g&4194048)!==0)){var T=c.lanes;T&=i.pendingLanes,g|=T,c.lanes=g,ga(i,g)}}function Jn(i,c){var g=i.updateQueue,T=i.alternate;if(T!==null&&(T=T.updateQueue,g===T)){var I=null,L=null;if(g=g.firstBaseUpdate,g!==null){do{var ne={lane:g.lane,tag:g.tag,payload:g.payload,callback:null,next:null};L===null?I=L=ne:L=L.next=ne,g=g.next}while(g!==null);L===null?I=L=c:L=L.next=c}else I=L=c;g={baseState:T.baseState,firstBaseUpdate:I,lastBaseUpdate:L,shared:T.shared,callbacks:T.callbacks},i.updateQueue=g;return}i=g.lastBaseUpdate,i===null?g.firstBaseUpdate=c:i.next=c,g.lastBaseUpdate=c}var kd=!1;function gc(){if(kd){var i=ki;if(i!==null)throw i}}function Wc(i,c,g,T){kd=!1;var I=i.updateQueue;Vl=!1;var L=I.firstBaseUpdate,ne=I.lastBaseUpdate,Ae=I.shared.pending;if(Ae!==null){I.shared.pending=null;var ct=Ae,zt=ct.next;ct.next=null,ne===null?L=zt:ne.next=zt,ne=ct;var Qt=i.alternate;Qt!==null&&(Qt=Qt.updateQueue,Ae=Qt.lastBaseUpdate,Ae!==ne&&(Ae===null?Qt.firstBaseUpdate=zt:Ae.next=zt,Qt.lastBaseUpdate=ct))}if(L!==null){var or=I.baseState;ne=0,Qt=zt=ct=null,Ae=L;do{var Ot=Ae.lane&-536870913,Gt=Ot!==Ae.lane;if(Gt?(jn&Ot)===Ot:(T&Ot)===Ot){Ot!==0&&Ot===Bl&&(kd=!0),Qt!==null&&(Qt=Qt.next={lane:0,tag:Ae.tag,payload:Ae.payload,callback:null,next:null});e:{var Hr=i,on=Ae;Ot=c;var Ea=g;switch(on.tag){case 1:if(Hr=on.payload,typeof Hr=="function"){or=Hr.call(Ea,or,Ot);break e}or=Hr;break e;case 3:Hr.flags=Hr.flags&-65537|128;case 0:if(Hr=on.payload,Ot=typeof Hr=="function"?Hr.call(Ea,or,Ot):Hr,Ot==null)break e;or=B({},or,Ot);break e;case 2:Vl=!0}}Ot=Ae.callback,Ot!==null&&(i.flags|=64,Gt&&(i.flags|=8192),Gt=I.callbacks,Gt===null?I.callbacks=[Ot]:Gt.push(Ot))}else Gt={lane:Ot,tag:Ae.tag,payload:Ae.payload,callback:Ae.callback,next:null},Qt===null?(zt=Qt=Gt,ct=or):Qt=Qt.next=Gt,ne|=Ot;if(Ae=Ae.next,Ae===null){if(Ae=I.shared.pending,Ae===null)break;Gt=Ae,Ae=Gt.next,Gt.next=null,I.lastBaseUpdate=Gt,I.shared.pending=null}}while(!0);Qt===null&&(ct=or),I.baseState=ct,I.firstBaseUpdate=zt,I.lastBaseUpdate=Qt,L===null&&(I.shared.lanes=0),Uu|=ne,i.lanes=ne,i.memoizedState=or}}function rf(i,c){if(typeof i!="function")throw Error(f(191,i));i.call(c)}function Uf(i,c){var g=i.callbacks;if(g!==null)for(i.callbacks=null,i=0;i<g.length;i++)rf(g[i],c)}var Cu=me(null),nf=me(0);function Cd(i,c){i=ju,Ve(nf,i),Ve(Cu,c),ju=i|c.baseLanes}function oo(){Ve(nf,ju),Ve(Cu,Cu.current)}function Mu(){ju=nf.current,re(Cu),re(nf)}var Rr=me(null),Br=null;function Mo(i){var c=i.alternate;Ve(Ya,Ya.current&1),Ve(Rr,i),Br===null&&(c===null||Cu.current!==null||c.memoizedState!==null)&&(Br=i)}function xh(i){Ve(Ya,Ya.current),Ve(Rr,i),Br===null&&(Br=i)}function af(i){i.tag===22?(Ve(Ya,Ya.current),Ve(Rr,i),Br===null&&(Br=i)):ni()}function ni(){Ve(Ya,Ya.current),Ve(Rr,Rr.current)}function ja(i){re(Rr),Br===i&&(Br=null),re(Ya)}var Ya=me(0);function sf(i){for(var c=i;c!==null;){if(c.tag===13){var g=c.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||Hs(g)||yi(g)))return c}else if(c.tag===19&&(c.memoizedProps.revealOrder==="forwards"||c.memoizedProps.revealOrder==="backwards"||c.memoizedProps.revealOrder==="unstable_legacy-backwards"||c.memoizedProps.revealOrder==="together")){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var _c=0,Tn=null,$n=null,wn=null,Ia=!1,Do=!1,ll=!1,Du=0,Ru=0,xc=null,Md=0;function ka(){throw Error(f(321))}function cl(i,c){if(c===null)return!1;for(var g=0;g<c.length&&g<i.length;g++)if(!es(i[g],c[g]))return!1;return!0}function yh(i,c,g,T,I,L){return _c=L,Tn=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,tt.H=i===null||i.memoizedState===null?ha:hi,ll=!1,L=g(T,I),ll=!1,Do&&(L=of(c,g,T,I)),vh(i),L}function vh(i){tt.H=Qn;var c=$n!==null&&$n.next!==null;if(_c=0,wn=$n=Tn=null,Ia=!1,Ru=0,xc=null,c)throw Error(f(300));i===null||ji||(i=i.dependencies,i!==null&&dc(i)&&(ji=!0))}function of(i,c,g,T){Tn=i;var I=0;do{if(Do&&(xc=null),Ru=0,Do=!1,25<=I)throw Error(f(301));if(I+=1,wn=$n=null,i.updateQueue!=null){var L=i.updateQueue;L.lastEffect=null,L.events=null,L.stores=null,L.memoCache!=null&&(L.memoCache.index=0)}tt.H=xi,L=c(g,T)}while(Do);return L}function lf(){var i=tt.H,c=i.useState()[0];return c=typeof c.then=="function"?Iu(c):c,i=i.useState()[0],($n!==null?$n.memoizedState:null)!==i&&(Tn.flags|=1024),c}function cf(){var i=Du!==0;return Du=0,i}function $c(i,c,g){c.updateQueue=i.updateQueue,c.flags&=-2053,i.lanes&=~g}function yc(i){if(Ia){for(i=i.memoizedState;i!==null;){var c=i.queue;c!==null&&(c.pending=null),i=i.next}Ia=!1}_c=0,wn=$n=Tn=null,Do=!1,Ru=Du=0,xc=null}function ts(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wn===null?Tn.memoizedState=wn=i:wn=wn.next=i,wn}function Pa(){if($n===null){var i=Tn.alternate;i=i!==null?i.memoizedState:null}else i=$n.next;var c=wn===null?Tn.memoizedState:wn.next;if(c!==null)wn=c,$n=i;else{if(i===null)throw Tn.alternate===null?Error(f(467)):Error(f(310));$n=i,i={memoizedState:$n.memoizedState,baseState:$n.baseState,baseQueue:$n.baseQueue,queue:$n.queue,next:null},wn===null?Tn.memoizedState=wn=i:wn=wn.next=i}return wn}function Hl(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Iu(i){var c=Ru;return Ru+=1,xc===null&&(xc=[]),i=Of(xc,i,c),c=Tn,(wn===null?c.memoizedState:wn.next)===null&&(c=c.alternate,tt.H=c===null||c.memoizedState===null?ha:hi),i}function Pu(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Iu(i);if(i.$$typeof===W)return Xa(i)}throw Error(f(438,String(i)))}function bh(i){var c=null,g=Tn.updateQueue;if(g!==null&&(c=g.memoCache),c==null){var T=Tn.alternate;T!==null&&(T=T.updateQueue,T!==null&&(T=T.memoCache,T!=null&&(c={data:T.data.map(function(I){return I.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),g===null&&(g=Hl(),Tn.updateQueue=g),g.memoCache=c,g=c.data[c.index],g===void 0)for(g=c.data[c.index]=Array(i),T=0;T<i;T++)g[T]=Ge;return c.index++,g}function ul(i,c){return typeof c=="function"?c(i):c}function w(i){var c=Pa();return t(c,$n,i)}function t(i,c,g){var T=i.queue;if(T===null)throw Error(f(311));T.lastRenderedReducer=g;var I=i.baseQueue,L=T.pending;if(L!==null){if(I!==null){var ne=I.next;I.next=L.next,L.next=ne}c.baseQueue=I=L,T.pending=null}if(L=i.baseState,I===null)i.memoizedState=L;else{c=I.next;var Ae=ne=null,ct=null,zt=c,Qt=!1;do{var or=zt.lane&-536870913;if(or!==zt.lane?(jn&or)===or:(_c&or)===or){var Ot=zt.revertLane;if(Ot===0)ct!==null&&(ct=ct.next={lane:0,revertLane:0,gesture:null,action:zt.action,hasEagerState:zt.hasEagerState,eagerState:zt.eagerState,next:null}),or===Bl&&(Qt=!0);else if((_c&Ot)===Ot){zt=zt.next,Ot===Bl&&(Qt=!0);continue}else or={lane:0,revertLane:zt.revertLane,gesture:null,action:zt.action,hasEagerState:zt.hasEagerState,eagerState:zt.eagerState,next:null},ct===null?(Ae=ct=or,ne=L):ct=ct.next=or,Tn.lanes|=Ot,Uu|=Ot;or=zt.action,ll&&g(L,or),L=zt.hasEagerState?zt.eagerState:g(L,or)}else Ot={lane:or,revertLane:zt.revertLane,gesture:zt.gesture,action:zt.action,hasEagerState:zt.hasEagerState,eagerState:zt.eagerState,next:null},ct===null?(Ae=ct=Ot,ne=L):ct=ct.next=Ot,Tn.lanes|=or,Uu|=or;zt=zt.next}while(zt!==null&&zt!==c);if(ct===null?ne=L:ct.next=Ae,!es(L,i.memoizedState)&&(ji=!0,Qt&&(g=ki,g!==null)))throw g;i.memoizedState=L,i.baseState=ne,i.baseQueue=ct,T.lastRenderedState=L}return I===null&&(T.lanes=0),[i.memoizedState,T.dispatch]}function o(i){var c=Pa(),g=c.queue;if(g===null)throw Error(f(311));g.lastRenderedReducer=i;var T=g.dispatch,I=g.pending,L=c.memoizedState;if(I!==null){g.pending=null;var ne=I=I.next;do L=i(L,ne.action),ne=ne.next;while(ne!==I);es(L,c.memoizedState)||(ji=!0),c.memoizedState=L,c.baseQueue===null&&(c.baseState=L),g.lastRenderedState=L}return[L,T]}function d(i,c,g){var T=Tn,I=Pa(),L=Yr;if(L){if(g===void 0)throw Error(f(407));g=g()}else g=c();var ne=!es(($n||I).memoizedState,g);if(ne&&(I.memoizedState=g,ji=!0),I=I.queue,Dt(A.bind(null,T,I,i),[i]),I.getSnapshot!==c||ne||wn!==null&&wn.memoizedState.tag&1){if(T.flags|=2048,Xe(9,{destroy:void 0},S.bind(null,T,I,g,c),null),Fa===null)throw Error(f(349));L||(_c&127)!==0||x(T,c,g)}return g}function x(i,c,g){i.flags|=16384,i={getSnapshot:c,value:g},c=Tn.updateQueue,c===null?(c=Hl(),Tn.updateQueue=c,c.stores=[i]):(g=c.stores,g===null?c.stores=[i]:g.push(i))}function S(i,c,g,T){c.value=g,c.getSnapshot=T,R(c)&&F(i)}function A(i,c,g){return g(function(){R(c)&&F(i)})}function R(i){var c=i.getSnapshot;i=i.value;try{var g=c();return!es(i,g)}catch{return!0}}function F(i){var c=Os(i,2);c!==null&&Oo(c,i,2)}function V(i){var c=ts();if(typeof i=="function"){var g=i;if(i=g(),ll){vt(!0);try{g()}finally{vt(!1)}}}return c.memoizedState=c.baseState=i,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ul,lastRenderedState:i},c}function q(i,c,g,T){return i.baseState=g,t(i,$n,typeof T=="function"?T:ul)}function te(i,c,g,T,I){if(lo(i))throw Error(f(485));if(i=c.action,i!==null){var L={payload:I,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(ne){L.listeners.push(ne)}};tt.T!==null?g(!0):L.isTransition=!1,T(L),g=c.pending,g===null?(L.next=c.pending=L,Q(c,L)):(L.next=g.next,c.pending=g.next=L)}}function Q(i,c){var g=c.action,T=c.payload,I=i.state;if(c.isTransition){var L=tt.T,ne={};tt.T=ne;try{var Ae=g(I,T),ct=tt.S;ct!==null&&ct(ne,Ae),ce(i,c,Ae)}catch(zt){Ie(i,c,zt)}finally{L!==null&&ne.types!==null&&(L.types=ne.types),tt.T=L}}else try{L=g(I,T),ce(i,c,L)}catch(zt){Ie(i,c,zt)}}function ce(i,c,g){g!==null&&typeof g=="object"&&typeof g.then=="function"?g.then(function(T){_e(i,c,T)},function(T){return Ie(i,c,T)}):_e(i,c,g)}function _e(i,c,g){c.status="fulfilled",c.value=g,Oe(c),i.state=g,c=i.pending,c!==null&&(g=c.next,g===c?i.pending=null:(g=g.next,c.next=g,Q(i,g)))}function Ie(i,c,g){var T=i.pending;if(i.pending=null,T!==null){T=T.next;do c.status="rejected",c.reason=g,Oe(c),c=c.next;while(c!==T)}i.action=null}function Oe(i){i=i.listeners;for(var c=0;c<i.length;c++)(0,i[c])()}function Le(i,c){return c}function qe(i,c){if(Yr){var g=Fa.formState;if(g!==null){e:{var T=Tn;if(Yr){if($r){t:{for(var I=$r,L=On;I.nodeType!==8;){if(!L){I=null;break t}if(I=gl(I.nextSibling),I===null){I=null;break t}}L=I.data,I=L==="F!"||L==="F"?I:null}if(I){$r=gl(I.nextSibling),T=I.data==="F!";break e}}Wa(T)}T=!1}T&&(c=g[0])}}return g=ts(),g.memoizedState=g.baseState=c,T={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Le,lastRenderedState:c},g.queue=T,g=wh.bind(null,Tn,T),T.dispatch=g,T=V(!1),L=Vs.bind(null,Tn,!1,T.queue),T=ts(),I={state:c,dispatch:null,action:i,pending:null},T.queue=I,g=te.bind(null,Tn,I,L,g),I.dispatch=g,T.memoizedState=i,[c,g,!1]}function nt(i){var c=Pa();return He(c,$n,i)}function He(i,c,g){if(c=t(i,c,Le)[0],i=w(ul)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var T=Iu(c)}catch(ne){throw ne===sl?js:ne}else T=c;c=Pa();var I=c.queue,L=I.dispatch;return g!==c.memoizedState&&(Tn.flags|=2048,Xe(9,{destroy:void 0},rt.bind(null,I,g),null)),[T,L,i]}function rt(i,c){i.action=c}function ot(i){var c=Pa(),g=$n;if(g!==null)return He(c,g,i);Pa(),c=c.memoizedState,g=Pa();var T=g.queue.dispatch;return g.memoizedState=i,[c,T,!1]}function Xe(i,c,g,T){return i={tag:i,create:g,deps:T,inst:c,next:null},c=Tn.updateQueue,c===null&&(c=Hl(),Tn.updateQueue=c),g=c.lastEffect,g===null?c.lastEffect=i.next=i:(T=g.next,g.next=i,i.next=T,c.lastEffect=i),i}function ft(){return Pa().memoizedState}function Pt(i,c,g,T){var I=ts();Tn.flags|=i,I.memoizedState=Xe(1|c,{destroy:void 0},g,T===void 0?null:T)}function Et(i,c,g,T){var I=Pa();T=T===void 0?null:T;var L=I.memoizedState.inst;$n!==null&&T!==null&&cl(T,$n.memoizedState.deps)?I.memoizedState=Xe(c,L,g,T):(Tn.flags|=i,I.memoizedState=Xe(1|c,L,g,T))}function Ct(i,c){Pt(8390656,8,i,c)}function Dt(i,c){Et(2048,8,i,c)}function ur(i){Tn.flags|=4;var c=Tn.updateQueue;if(c===null)c=Hl(),Tn.updateQueue=c,c.events=[i];else{var g=c.events;g===null?c.events=[i]:g.push(i)}}function fr(i){var c=Pa().memoizedState;return ur({ref:c,nextImpl:i}),function(){if((fa&2)!==0)throw Error(f(440));return c.impl.apply(void 0,arguments)}}function tr(i,c){return Et(4,2,i,c)}function br(i,c){return Et(4,4,i,c)}function hn(i,c){if(typeof c=="function"){i=i();var g=c(i);return function(){typeof g=="function"?g():c(null)}}if(c!=null)return i=i(),c.current=i,function(){c.current=null}}function Xn(i,c,g){g=g!=null?g.concat([i]):null,Et(4,4,hn.bind(null,c,i),g)}function xa(){}function ua(i,c){var g=Pa();c=c===void 0?null:c;var T=g.memoizedState;return c!==null&&cl(c,T[1])?T[0]:(g.memoizedState=[i,c],i)}function Ca(i,c){var g=Pa();c=c===void 0?null:c;var T=g.memoizedState;if(c!==null&&cl(c,T[1]))return T[0];if(T=i(),ll){vt(!0);try{i()}finally{vt(!1)}}return g.memoizedState=[T,c],T}function ra(i,c,g){return g===void 0||(_c&1073741824)!==0&&(jn&261930)===0?i.memoizedState=c:(i.memoizedState=g,i=d_(),Tn.lanes|=i,Uu|=i,g)}function Ua(i,c,g,T){return es(g,c)?g:Cu.current!==null?(i=ra(i,g,T),es(i,c)||(ji=!0),i):(_c&42)===0||(_c&1073741824)!==0&&(jn&261930)===0?(ji=!0,i.memoizedState=g):(i=d_(),Tn.lanes|=i,Uu|=i,c)}function Ma(i,c,g,T,I){var L=We.p;We.p=L!==0&&8>L?L:8;var ne=tt.T,Ae={};tt.T=Ae,Vs(i,!1,c,g);try{var ct=I(),zt=tt.S;if(zt!==null&&zt(Ae,ct),ct!==null&&typeof ct=="object"&&typeof ct.then=="function"){var Qt=Au(ct,T);fl(i,c,Qt,zo(i))}else fl(i,c,T,zo(i))}catch(or){fl(i,c,{then:function(){},status:"rejected",reason:or},zo())}finally{We.p=L,ne!==null&&Ae.types!==null&&(ne.types=Ae.types),tt.T=ne}}function Bi(){}function Ka(i,c,g,T){if(i.tag!==5)throw Error(f(476));var I=Ja(i).queue;Ma(i,I,c,$t,g===null?Bi:function(){return Ni(i),g(T)})}function Ja(i){var c=i.memoizedState;if(c!==null)return c;c={memoizedState:$t,baseState:$t,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ul,lastRenderedState:$t},next:null};var g={};return c.next={memoizedState:g,baseState:g,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ul,lastRenderedState:g},next:null},i.memoizedState=c,i=i.alternate,i!==null&&(i.memoizedState=c),c}function Ni(i){var c=Ja(i);c.next===null&&(c=i.alternate.memoizedState),fl(i,c.next.queue,{},zo())}function ql(){return Xa(cd)}function Zl(){return Pa().memoizedState}function hl(){return Pa().memoizedState}function Us(i){for(var c=i.return;c!==null;){switch(c.tag){case 24:case 3:var g=zo();i=Gl(g);var T=mc(c,i,g);T!==null&&(Oo(T,c,g),Co(T,c,g)),c={cache:Ns()},i.payload=c;return}c=c.return}}function Fu(i,c,g){var T=zo();g={lane:T,revertLane:0,gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},lo(i)?Ro(c,g):(g=ao(i,c,g,T),g!==null&&(Oo(g,i,T),Io(g,c,T)))}function wh(i,c,g){var T=zo();fl(i,c,g,T)}function fl(i,c,g,T){var I={lane:T,revertLane:0,gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null};if(lo(i))Ro(c,I);else{var L=i.alternate;if(i.lanes===0&&(L===null||L.lanes===0)&&(L=c.lastRenderedReducer,L!==null))try{var ne=c.lastRenderedState,Ae=L(ne,g);if(I.hasEagerState=!0,I.eagerState=Ae,es(Ae,ne))return Vc(i,c,I,0),Fa===null&&fc(),!1}catch{}if(g=ao(i,c,I,T),g!==null)return Oo(g,i,T),Io(g,c,T),!0}return!1}function Vs(i,c,g,T){if(T={lane:2,revertLane:Rm(),gesture:null,action:T,hasEagerState:!1,eagerState:null,next:null},lo(i)){if(c)throw Error(f(479))}else c=ao(i,g,T,2),c!==null&&Oo(c,i,2)}function lo(i){var c=i.alternate;return i===Tn||c!==null&&c===Tn}function Ro(i,c){Do=Ia=!0;var g=i.pending;g===null?c.next=c:(c.next=g.next,g.next=c),i.pending=c}function Io(i,c,g){if((g&4194048)!==0){var T=c.lanes;T&=i.pendingLanes,g|=T,c.lanes=g,ga(i,g)}}var Qn={readContext:Xa,use:Pu,useCallback:ka,useContext:ka,useEffect:ka,useImperativeHandle:ka,useLayoutEffect:ka,useInsertionEffect:ka,useMemo:ka,useReducer:ka,useRef:ka,useState:ka,useDebugValue:ka,useDeferredValue:ka,useTransition:ka,useSyncExternalStore:ka,useId:ka,useHostTransitionStatus:ka,useFormState:ka,useActionState:ka,useOptimistic:ka,useMemoCache:ka,useCacheRefresh:ka};Qn.useEffectEvent=ka;var ha={readContext:Xa,use:Pu,useCallback:function(i,c){return ts().memoizedState=[i,c===void 0?null:c],i},useContext:Xa,useEffect:Ct,useImperativeHandle:function(i,c,g){g=g!=null?g.concat([i]):null,Pt(4194308,4,hn.bind(null,c,i),g)},useLayoutEffect:function(i,c){return Pt(4194308,4,i,c)},useInsertionEffect:function(i,c){Pt(4,2,i,c)},useMemo:function(i,c){var g=ts();c=c===void 0?null:c;var T=i();if(ll){vt(!0);try{i()}finally{vt(!1)}}return g.memoizedState=[T,c],T},useReducer:function(i,c,g){var T=ts();if(g!==void 0){var I=g(c);if(ll){vt(!0);try{g(c)}finally{vt(!1)}}}else I=c;return T.memoizedState=T.baseState=I,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:I},T.queue=i,i=i.dispatch=Fu.bind(null,Tn,i),[T.memoizedState,i]},useRef:function(i){var c=ts();return i={current:i},c.memoizedState=i},useState:function(i){i=V(i);var c=i.queue,g=wh.bind(null,Tn,c);return c.dispatch=g,[i.memoizedState,g]},useDebugValue:xa,useDeferredValue:function(i,c){var g=ts();return ra(g,i,c)},useTransition:function(){var i=V(!1);return i=Ma.bind(null,Tn,i.queue,!0,!1),ts().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,c,g){var T=Tn,I=ts();if(Yr){if(g===void 0)throw Error(f(407));g=g()}else{if(g=c(),Fa===null)throw Error(f(349));(jn&127)!==0||x(T,c,g)}I.memoizedState=g;var L={value:g,getSnapshot:c};return I.queue=L,Ct(A.bind(null,T,L,i),[i]),T.flags|=2048,Xe(9,{destroy:void 0},S.bind(null,T,L,g,c),null),g},useId:function(){var i=ts(),c=Fa.identifierPrefix;if(Yr){var g=gr,T=pn;g=(T&~(1<<32-Bt(T)-1)).toString(32)+g,c="_"+c+"R_"+g,g=Du++,0<g&&(c+="H"+g.toString(32)),c+="_"}else g=Md++,c="_"+c+"r_"+g.toString(32)+"_";return i.memoizedState=c},useHostTransitionStatus:ql,useFormState:qe,useActionState:qe,useOptimistic:function(i){var c=ts();c.memoizedState=c.baseState=i;var g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=g,c=Vs.bind(null,Tn,!0,g),g.dispatch=c,[i,c]},useMemoCache:bh,useCacheRefresh:function(){return ts().memoizedState=Us.bind(null,Tn)},useEffectEvent:function(i){var c=ts(),g={impl:i};return c.memoizedState=g,function(){if((fa&2)!==0)throw Error(f(440));return g.impl.apply(void 0,arguments)}}},hi={readContext:Xa,use:Pu,useCallback:ua,useContext:Xa,useEffect:Dt,useImperativeHandle:Xn,useInsertionEffect:tr,useLayoutEffect:br,useMemo:Ca,useReducer:w,useRef:ft,useState:function(){return w(ul)},useDebugValue:xa,useDeferredValue:function(i,c){var g=Pa();return Ua(g,$n.memoizedState,i,c)},useTransition:function(){var i=w(ul)[0],c=Pa().memoizedState;return[typeof i=="boolean"?i:Iu(i),c]},useSyncExternalStore:d,useId:Zl,useHostTransitionStatus:ql,useFormState:nt,useActionState:nt,useOptimistic:function(i,c){var g=Pa();return q(g,$n,i,c)},useMemoCache:bh,useCacheRefresh:hl};hi.useEffectEvent=fr;var xi={readContext:Xa,use:Pu,useCallback:ua,useContext:Xa,useEffect:Dt,useImperativeHandle:Xn,useInsertionEffect:tr,useLayoutEffect:br,useMemo:Ca,useReducer:o,useRef:ft,useState:function(){return o(ul)},useDebugValue:xa,useDeferredValue:function(i,c){var g=Pa();return $n===null?ra(g,i,c):Ua(g,$n.memoizedState,i,c)},useTransition:function(){var i=o(ul)[0],c=Pa().memoizedState;return[typeof i=="boolean"?i:Iu(i),c]},useSyncExternalStore:d,useId:Zl,useHostTransitionStatus:ql,useFormState:ot,useActionState:ot,useOptimistic:function(i,c){var g=Pa();return $n!==null?q(g,$n,i,c):(g.baseState=i,[i,g.queue.dispatch])},useMemoCache:bh,useCacheRefresh:hl};xi.useEffectEvent=fr;function Vf(i,c,g,T){c=i.memoizedState,g=g(T,c),g=g==null?c:B({},c,g),i.memoizedState=g,i.lanes===0&&(i.updateQueue.baseState=g)}var Gf={enqueueSetState:function(i,c,g){i=i._reactInternals;var T=zo(),I=Gl(T);I.payload=c,g!=null&&(I.callback=g),c=mc(i,I,T),c!==null&&(Oo(c,i,T),Co(c,i,T))},enqueueReplaceState:function(i,c,g){i=i._reactInternals;var T=zo(),I=Gl(T);I.tag=1,I.payload=c,g!=null&&(I.callback=g),c=mc(i,I,T),c!==null&&(Oo(c,i,T),Co(c,i,T))},enqueueForceUpdate:function(i,c){i=i._reactInternals;var g=zo(),T=Gl(g);T.tag=2,c!=null&&(T.callback=c),c=mc(i,T,g),c!==null&&(Oo(c,i,g),Co(c,i,g))}};function Xc(i,c,g,T,I,L,ne){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(T,L,ne):c.prototype&&c.prototype.isPureReactComponent?!Fl(g,T)||!Fl(I,L):!0}function Lp(i,c,g,T){i=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(g,T),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(g,T),c.state!==i&&Gf.enqueueReplaceState(c,c.state,null)}function Yc(i,c){var g=c;if("ref"in c){g={};for(var T in c)T!=="ref"&&(g[T]=c[T])}if(i=i.defaultProps){g===c&&(g=B({},g));for(var I in i)g[I]===void 0&&(g[I]=i[I])}return g}function Hf(i){zs(i)}function vc(i){console.error(i)}function bc(i){zs(i)}function dl(i,c){try{var g=i.onUncaughtError;g(c.value,{componentStack:c.stack})}catch(T){setTimeout(function(){throw T})}}function qf(i,c,g){try{var T=i.onCaughtError;T(g.value,{componentStack:g.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(I){setTimeout(function(){throw I})}}function uf(i,c,g){return g=Gl(g),g.tag=3,g.payload={element:null},g.callback=function(){dl(i,c)},g}function hf(i){return i=Gl(i),i.tag=3,i}function ff(i,c,g,T){var I=g.type.getDerivedStateFromError;if(typeof I=="function"){var L=T.value;i.payload=function(){return I(L)},i.callback=function(){qf(c,g,T)}}var ne=g.stateNode;ne!==null&&typeof ne.componentDidCatch=="function"&&(i.callback=function(){qf(c,g,T),typeof I!="function"&&(Vu===null?Vu=new Set([this]):Vu.add(this));var Ae=T.stack;this.componentDidCatch(T.value,{componentStack:Ae!==null?Ae:""})})}function zp(i,c,g,T,I){if(g.flags|=32768,T!==null&&typeof T=="object"&&typeof T.then=="function"){if(c=g.alternate,c!==null&&us(c,g,I,!0),g=Rr.current,g!==null){switch(g.tag){case 31:case 13:return Br===null?$d():g.alternate===null&&fi===0&&(fi=3),g.flags&=-257,g.flags|=65536,g.lanes=I,T===kr?g.flags|=16384:(c=g.updateQueue,c===null?g.updateQueue=new Set([T]):c.add(T),o0(i,T,I)),!1;case 22:return g.flags|=65536,T===kr?g.flags|=16384:(c=g.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([T])},g.updateQueue=c):(g=c.retryQueue,g===null?c.retryQueue=new Set([T]):g.add(T)),o0(i,T,I)),!1}throw Error(f(435,g.tag))}return o0(i,T,I),$d(),!1}if(Yr)return c=Rr.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=I,T!==Cn&&(i=Error(f(422),{cause:T}),io(Or(i,g)))):(T!==Cn&&(c=Error(f(423),{cause:T}),io(Or(c,g))),i=i.current.alternate,i.flags|=65536,I&=-I,i.lanes|=I,T=Or(T,g),I=uf(i.stateNode,T,I),Jn(i,I),fi!==4&&(fi=2)),!1;var L=Error(f(520),{cause:T});if(L=Or(L,g),Hd===null?Hd=[L]:Hd.push(L),fi!==4&&(fi=2),c===null)return!0;T=Or(T,g),g=c;do{switch(g.tag){case 3:return g.flags|=65536,i=I&-I,g.lanes|=i,i=uf(g.stateNode,T,i),Jn(g,i),!1;case 1:if(c=g.type,L=g.stateNode,(g.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||L!==null&&typeof L.componentDidCatch=="function"&&(Vu===null||!Vu.has(L))))return g.flags|=65536,I&=-I,g.lanes|=I,I=hf(I),ff(I,i,g,T),Jn(g,I),!1}g=g.return}while(g!==null);return!1}var Op=Error(f(461)),ji=!1;function rs(i,c,g,T){c.child=i===null?Ad(c,null,g,T):Ul(c,i.child,g,T)}function Yg(i,c,g,T,I){g=g.render;var L=c.ref;if("ref"in T){var ne={};for(var Ae in T)Ae!=="ref"&&(ne[Ae]=T[Ae])}else ne=T;return al(c),T=yh(i,c,g,ne,L,I),Ae=cf(),i!==null&&!ji?($c(i,c,I),Jc(i,c,I)):(Yr&&Ae&&Wr(c),c.flags|=1,rs(i,c,T,I),c.child)}function Bp(i,c,g,T,I){if(i===null){var L=g.type;return typeof L=="function"&&!ee(L)&&L.defaultProps===void 0&&g.compare===null?(c.tag=15,c.type=L,sm(i,c,L,T,I)):(i=er(g.type,null,T,c,c.mode,I),i.ref=c.ref,i.return=c,c.child=i)}if(L=i.child,!Id(i,I)){var ne=L.memoizedProps;if(g=g.compare,g=g!==null?g:Fl,g(ne,T)&&i.ref===c.ref)return Jc(i,c,I)}return c.flags|=1,i=Ke(L,T),i.ref=c.ref,i.return=c,c.child=i}function sm(i,c,g,T,I){if(i!==null){var L=i.memoizedProps;if(Fl(L,T)&&i.ref===c.ref)if(ji=!1,c.pendingProps=T=L,Id(i,I))(i.flags&131072)!==0&&(ji=!0);else return c.lanes=i.lanes,Jc(i,c,I)}return lm(i,c,g,T,I)}function om(i,c,g,T){var I=T.children,L=i!==null?i.memoizedState:null;if(i===null&&c.stateNode===null&&(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),T.mode==="hidden"){if((c.flags&128)!==0){if(L=L!==null?L.baseLanes|g:g,i!==null){for(T=c.child=i.child,I=0;T!==null;)I=I|T.lanes|T.childLanes,T=T.sibling;T=I&~L}else T=0,c.child=null;return Kg(i,c,L,g,T)}if((g&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},i!==null&&zf(c,L!==null?L.cachePool:null),L!==null?Cd(c,L):oo(),af(c);else return T=c.lanes=536870912,Kg(i,c,L!==null?L.baseLanes|g:g,g,T)}else L!==null?(zf(c,L.cachePool),Cd(c,L),ni(),c.memoizedState=null):(i!==null&&zf(c,null),oo(),ni());return rs(i,c,I,g),c.child}function Kc(i,c){return i!==null&&i.tag===22||c.stateNode!==null||(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.sibling}function Kg(i,c,g,T,I){var L=Lf();return L=L===null?null:{parent:Na._currentValue,pool:L},c.memoizedState={baseLanes:g,cachePool:L},i!==null&&zf(c,null),oo(),af(c),i!==null&&us(i,c,T,!0),c.childLanes=I,null}function Lu(i,c){return c=Gp({mode:c.mode,children:c.children},i.mode),c.ref=i.ref,i.child=c,c.return=i,c}function Dd(i,c,g){return Ul(c,i.child,null,g),i=Lu(c,c.pendingProps),i.flags|=2,ja(c),c.memoizedState=null,i}function Np(i,c,g){var T=c.pendingProps,I=(c.flags&128)!==0;if(c.flags&=-129,i===null){if(Yr){if(T.mode==="hidden")return i=Lu(c,T),c.lanes=536870912,Kc(null,i);if(xh(c),(i=$r)?(i=Ih(i,On),i=i!==null&&i.data==="&"?i:null,i!==null&&(c.memoizedState={dehydrated:i,treeContext:Ir!==null?{id:pn,overflow:gr}:null,retryLane:536870912,hydrationErrors:null},g=Kr(i),g.return=c,c.child=g,en=c,$r=null)):i=null,i===null)throw Wa(c);return c.lanes=536870912,null}return Lu(c,T)}var L=i.memoizedState;if(L!==null){var ne=L.dehydrated;if(xh(c),I)if(c.flags&256)c.flags&=-257,c=Dd(i,c,g);else if(c.memoizedState!==null)c.child=i.child,c.flags|=128,c=null;else throw Error(f(558));else if(ji||us(i,c,g,!1),I=(g&i.childLanes)!==0,ji||I){if(T=Fa,T!==null&&(ne=Yi(T,g),ne!==0&&ne!==L.retryLane))throw L.retryLane=ne,Os(i,ne),Oo(T,i,ne),Op;$d(),c=Dd(i,c,g)}else i=L.treeContext,$r=gl(ne.nextSibling),en=c,Yr=!0,Xr=null,On=!1,i!==null&&Vr(c,i),c=Lu(c,T),c.flags|=4096;return c}return i=Ke(i.child,{mode:T.mode,children:T.children}),i.ref=c.ref,c.child=i,i.return=c,i}function jp(i,c){var g=c.ref;if(g===null)i!==null&&i.ref!==null&&(c.flags|=4194816);else{if(typeof g!="function"&&typeof g!="object")throw Error(f(284));(i===null||i.ref!==g)&&(c.flags|=4194816)}}function lm(i,c,g,T,I){return al(c),g=yh(i,c,g,T,void 0,I),T=cf(),i!==null&&!ji?($c(i,c,I),Jc(i,c,I)):(Yr&&T&&Wr(c),c.flags|=1,rs(i,c,g,I),c.child)}function Jg(i,c,g,T,I,L){return al(c),c.updateQueue=null,g=of(c,T,g,I),vh(i),T=cf(),i!==null&&!ji?($c(i,c,L),Jc(i,c,L)):(Yr&&T&&Wr(c),c.flags|=1,rs(i,c,g,L),c.child)}function Qg(i,c,g,T,I){if(al(c),c.stateNode===null){var L=dn,ne=g.contextType;typeof ne=="object"&&ne!==null&&(L=Xa(ne)),L=new g(T,L),c.memoizedState=L.state!==null&&L.state!==void 0?L.state:null,L.updater=Gf,c.stateNode=L,L._reactInternals=c,L=c.stateNode,L.props=T,L.state=c.memoizedState,L.refs={},jf(c),ne=g.contextType,L.context=typeof ne=="object"&&ne!==null?Xa(ne):dn,L.state=c.memoizedState,ne=g.getDerivedStateFromProps,typeof ne=="function"&&(Vf(c,g,ne,T),L.state=c.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof L.getSnapshotBeforeUpdate=="function"||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(ne=L.state,typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount(),ne!==L.state&&Gf.enqueueReplaceState(L,L.state,null),Wc(c,T,L,I),gc(),L.state=c.memoizedState),typeof L.componentDidMount=="function"&&(c.flags|=4194308),T=!0}else if(i===null){L=c.stateNode;var Ae=c.memoizedProps,ct=Yc(g,Ae);L.props=ct;var zt=L.context,Qt=g.contextType;ne=dn,typeof Qt=="object"&&Qt!==null&&(ne=Xa(Qt));var or=g.getDerivedStateFromProps;Qt=typeof or=="function"||typeof L.getSnapshotBeforeUpdate=="function",Ae=c.pendingProps!==Ae,Qt||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(Ae||zt!==ne)&&Lp(c,L,T,ne),Vl=!1;var Ot=c.memoizedState;L.state=Ot,Wc(c,T,L,I),gc(),zt=c.memoizedState,Ae||Ot!==zt||Vl?(typeof or=="function"&&(Vf(c,g,or,T),zt=c.memoizedState),(ct=Vl||Xc(c,g,ct,T,Ot,zt,ne))?(Qt||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount()),typeof L.componentDidMount=="function"&&(c.flags|=4194308)):(typeof L.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=T,c.memoizedState=zt),L.props=T,L.state=zt,L.context=ne,T=ct):(typeof L.componentDidMount=="function"&&(c.flags|=4194308),T=!1)}else{L=c.stateNode,tf(i,c),ne=c.memoizedProps,Qt=Yc(g,ne),L.props=Qt,or=c.pendingProps,Ot=L.context,zt=g.contextType,ct=dn,typeof zt=="object"&&zt!==null&&(ct=Xa(zt)),Ae=g.getDerivedStateFromProps,(zt=typeof Ae=="function"||typeof L.getSnapshotBeforeUpdate=="function")||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(ne!==or||Ot!==ct)&&Lp(c,L,T,ct),Vl=!1,Ot=c.memoizedState,L.state=Ot,Wc(c,T,L,I),gc();var Gt=c.memoizedState;ne!==or||Ot!==Gt||Vl||i!==null&&i.dependencies!==null&&dc(i.dependencies)?(typeof Ae=="function"&&(Vf(c,g,Ae,T),Gt=c.memoizedState),(Qt=Vl||Xc(c,g,Qt,T,Ot,Gt,ct)||i!==null&&i.dependencies!==null&&dc(i.dependencies))?(zt||typeof L.UNSAFE_componentWillUpdate!="function"&&typeof L.componentWillUpdate!="function"||(typeof L.componentWillUpdate=="function"&&L.componentWillUpdate(T,Gt,ct),typeof L.UNSAFE_componentWillUpdate=="function"&&L.UNSAFE_componentWillUpdate(T,Gt,ct)),typeof L.componentDidUpdate=="function"&&(c.flags|=4),typeof L.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof L.componentDidUpdate!="function"||ne===i.memoizedProps&&Ot===i.memoizedState||(c.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||ne===i.memoizedProps&&Ot===i.memoizedState||(c.flags|=1024),c.memoizedProps=T,c.memoizedState=Gt),L.props=T,L.state=Gt,L.context=ct,T=Qt):(typeof L.componentDidUpdate!="function"||ne===i.memoizedProps&&Ot===i.memoizedState||(c.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||ne===i.memoizedProps&&Ot===i.memoizedState||(c.flags|=1024),T=!1)}return L=T,jp(i,c),T=(c.flags&128)!==0,L||T?(L=c.stateNode,g=T&&typeof g.getDerivedStateFromError!="function"?null:L.render(),c.flags|=1,i!==null&&T?(c.child=Ul(c,i.child,null,I),c.child=Ul(c,null,g,I)):rs(i,c,g,I),c.memoizedState=L.state,i=c.child):i=Jc(i,c,I),i}function e_(i,c,g,T){return Li(),c.flags|=256,rs(i,c,g,T),c.child}var Up={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Rd(i){return{baseLanes:i,cachePool:Fp()}}function Vp(i,c,g){return i=i!==null?i.childLanes&~g:0,c&&(i|=Es),i}function cm(i,c,g){var T=c.pendingProps,I=!1,L=(c.flags&128)!==0,ne;if((ne=L)||(ne=i!==null&&i.memoizedState===null?!1:(Ya.current&2)!==0),ne&&(I=!0,c.flags&=-129),ne=(c.flags&32)!==0,c.flags&=-33,i===null){if(Yr){if(I?Mo(c):ni(),(i=$r)?(i=Ih(i,On),i=i!==null&&i.data!=="&"?i:null,i!==null&&(c.memoizedState={dehydrated:i,treeContext:Ir!==null?{id:pn,overflow:gr}:null,retryLane:536870912,hydrationErrors:null},g=Kr(i),g.return=c,c.child=g,en=c,$r=null)):i=null,i===null)throw Wa(c);return yi(i)?c.lanes=32:c.lanes=536870912,null}var Ae=T.children;return T=T.fallback,I?(ni(),I=c.mode,Ae=Gp({mode:"hidden",children:Ae},I),T=St(T,I,g,null),Ae.return=c,T.return=c,Ae.sibling=T,c.child=Ae,T=c.child,T.memoizedState=Rd(g),T.childLanes=Vp(i,ne,g),c.memoizedState=Up,Kc(null,T)):(Mo(c),um(c,Ae))}var ct=i.memoizedState;if(ct!==null&&(Ae=ct.dehydrated,Ae!==null)){if(L)c.flags&256?(Mo(c),c.flags&=-257,c=Hp(i,c,g)):c.memoizedState!==null?(ni(),c.child=i.child,c.flags|=128,c=null):(ni(),Ae=T.fallback,I=c.mode,T=Gp({mode:"visible",children:T.children},I),Ae=St(Ae,I,g,null),Ae.flags|=2,T.return=c,Ae.return=c,T.sibling=Ae,c.child=T,Ul(c,i.child,null,g),T=c.child,T.memoizedState=Rd(g),T.childLanes=Vp(i,ne,g),c.memoizedState=Up,c=Kc(null,T));else if(Mo(c),yi(Ae)){if(ne=Ae.nextSibling&&Ae.nextSibling.dataset,ne)var zt=ne.dgst;ne=zt,T=Error(f(419)),T.stack="",T.digest=ne,io({value:T,source:null,stack:null}),c=Hp(i,c,g)}else if(ji||us(i,c,g,!1),ne=(g&i.childLanes)!==0,ji||ne){if(ne=Fa,ne!==null&&(T=Yi(ne,g),T!==0&&T!==ct.retryLane))throw ct.retryLane=T,Os(i,T),Oo(ne,i,T),Op;Hs(Ae)||$d(),c=Hp(i,c,g)}else Hs(Ae)?(c.flags|=192,c.child=i.child,c=null):(i=ct.treeContext,$r=gl(Ae.nextSibling),en=c,Yr=!0,Xr=null,On=!1,i!==null&&Vr(c,i),c=um(c,T.children),c.flags|=4096);return c}return I?(ni(),Ae=T.fallback,I=c.mode,ct=i.child,zt=ct.sibling,T=Ke(ct,{mode:"hidden",children:T.children}),T.subtreeFlags=ct.subtreeFlags&65011712,zt!==null?Ae=Ke(zt,Ae):(Ae=St(Ae,I,g,null),Ae.flags|=2),Ae.return=c,T.return=c,T.sibling=Ae,c.child=T,Kc(null,T),T=c.child,Ae=i.child.memoizedState,Ae===null?Ae=Rd(g):(I=Ae.cachePool,I!==null?(ct=Na._currentValue,I=I.parent!==ct?{parent:ct,pool:ct}:I):I=Fp(),Ae={baseLanes:Ae.baseLanes|g,cachePool:I}),T.memoizedState=Ae,T.childLanes=Vp(i,ne,g),c.memoizedState=Up,Kc(i.child,T)):(Mo(c),g=i.child,i=g.sibling,g=Ke(g,{mode:"visible",children:T.children}),g.return=c,g.sibling=null,i!==null&&(ne=c.deletions,ne===null?(c.deletions=[i],c.flags|=16):ne.push(i)),c.child=g,c.memoizedState=null,g)}function um(i,c){return c=Gp({mode:"visible",children:c},i.mode),c.return=i,i.child=c}function Gp(i,c){return i=Ts(22,i,null,c),i.lanes=0,i}function Hp(i,c,g){return Ul(c,i.child,null,g),i=um(c,c.pendingProps.children),i.flags|=2,c.memoizedState=null,i}function hm(i,c,g){i.lanes|=c;var T=i.alternate;T!==null&&(T.lanes|=c),Ol(i.return,c,g)}function fm(i,c,g,T,I,L){var ne=i.memoizedState;ne===null?i.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:T,tail:g,tailMode:I,treeForkCount:L}:(ne.isBackwards=c,ne.rendering=null,ne.renderingStartTime=0,ne.last=T,ne.tail=g,ne.tailMode=I,ne.treeForkCount=L)}function qp(i,c,g){var T=c.pendingProps,I=T.revealOrder,L=T.tail;T=T.children;var ne=Ya.current,Ae=(ne&2)!==0;if(Ae?(ne=ne&1|2,c.flags|=128):ne&=1,Ve(Ya,ne),rs(i,c,T,g),T=Yr?Dr:0,!Ae&&i!==null&&(i.flags&128)!==0)e:for(i=c.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&hm(i,g,c);else if(i.tag===19)hm(i,g,c);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===c)break e;for(;i.sibling===null;){if(i.return===null||i.return===c)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(I){case"forwards":for(g=c.child,I=null;g!==null;)i=g.alternate,i!==null&&sf(i)===null&&(I=g),g=g.sibling;g=I,g===null?(I=c.child,c.child=null):(I=g.sibling,g.sibling=null),fm(c,!1,I,g,L,T);break;case"backwards":case"unstable_legacy-backwards":for(g=null,I=c.child,c.child=null;I!==null;){if(i=I.alternate,i!==null&&sf(i)===null){c.child=I;break}i=I.sibling,I.sibling=g,g=I,I=i}fm(c,!0,g,null,L,T);break;case"together":fm(c,!1,null,null,void 0,T);break;default:c.memoizedState=null}return c.child}function Jc(i,c,g){if(i!==null&&(c.dependencies=i.dependencies),Uu|=c.lanes,(g&c.childLanes)===0)if(i!==null){if(us(i,c,g,!1),(g&c.childLanes)===0)return null}else return null;if(i!==null&&c.child!==i.child)throw Error(f(153));if(c.child!==null){for(i=c.child,g=Ke(i,i.pendingProps),c.child=g,g.return=c;i.sibling!==null;)i=i.sibling,g=g.sibling=Ke(i,i.pendingProps),g.return=c;g.sibling=null}return c.child}function Id(i,c){return(i.lanes&c)!==0?!0:(i=i.dependencies,!!(i!==null&&dc(i)))}function Pd(i,c,g){switch(c.tag){case 3:Zt(c,c.stateNode.containerInfo),zi(c,Na,i.memoizedState.cache),Li();break;case 27:case 5:Yt(c);break;case 4:Zt(c,c.stateNode.containerInfo);break;case 10:zi(c,c.type,c.memoizedProps.value);break;case 31:if(c.memoizedState!==null)return c.flags|=128,xh(c),null;break;case 13:var T=c.memoizedState;if(T!==null)return T.dehydrated!==null?(Mo(c),c.flags|=128,null):(g&c.child.childLanes)!==0?cm(i,c,g):(Mo(c),i=Jc(i,c,g),i!==null?i.sibling:null);Mo(c);break;case 19:var I=(i.flags&128)!==0;if(T=(g&c.childLanes)!==0,T||(us(i,c,g,!1),T=(g&c.childLanes)!==0),I){if(T)return qp(i,c,g);c.flags|=128}if(I=c.memoizedState,I!==null&&(I.rendering=null,I.tail=null,I.lastEffect=null),Ve(Ya,Ya.current),T)break;return null;case 22:return c.lanes=0,om(i,c,g,c.pendingProps);case 24:zi(c,Na,i.memoizedState.cache)}return Jc(i,c,g)}function Gs(i,c,g){if(i!==null)if(i.memoizedProps!==c.pendingProps)ji=!0;else{if(!Id(i,g)&&(c.flags&128)===0)return ji=!1,Pd(i,c,g);ji=(i.flags&131072)!==0}else ji=!1,Yr&&(c.flags&1048576)!==0&&yn(c,Dr,c.index);switch(c.lanes=0,c.tag){case 16:e:{var T=c.pendingProps;if(i=ko(c.elementType),c.type=i,typeof i=="function")ee(i)?(T=Yc(i,T),c.tag=1,c=Qg(null,c,i,T,g)):(c.tag=0,c=lm(null,c,i,T,g));else{if(i!=null){var I=i.$$typeof;if(I===de){c.tag=11,c=Yg(null,c,i,T,g);break e}else if(I===ie){c.tag=14,c=Bp(null,c,i,T,g);break e}}throw c=le(i)||i,Error(f(306,c,""))}}return c;case 0:return lm(i,c,c.type,c.pendingProps,g);case 1:return T=c.type,I=Yc(T,c.pendingProps),Qg(i,c,T,I,g);case 3:e:{if(Zt(c,c.stateNode.containerInfo),i===null)throw Error(f(387));T=c.pendingProps;var L=c.memoizedState;I=L.element,tf(i,c),Wc(c,T,null,g);var ne=c.memoizedState;if(T=ne.cache,zi(c,Na,T),T!==L.cache&&mh(c,[Na],g,!0),gc(),T=ne.element,L.isDehydrated)if(L={element:T,isDehydrated:!1,cache:ne.cache},c.updateQueue.baseState=L,c.memoizedState=L,c.flags&256){c=e_(i,c,T,g);break e}else if(T!==I){I=Or(Error(f(424)),c),io(I),c=e_(i,c,T,g);break e}else for(i=c.stateNode.containerInfo,i.nodeType===9?i=i.body:i=i.nodeName==="HTML"?i.ownerDocument.body:i,$r=gl(i.firstChild),en=c,Yr=!0,Xr=null,On=!0,g=Ad(c,null,T,g),c.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling;else{if(Li(),T===I){c=Jc(i,c,g);break e}rs(i,c,T,g)}c=c.child}return c;case 26:return jp(i,c),i===null?(g=Zm(c.type,null,c.pendingProps,null))?c.memoizedState=g:Yr||(g=c.type,i=c.pendingProps,T=ep(bt.current).createElement(g),T[Re]=c,T[Te]=i,as(T,g,i),Nr(T),c.stateNode=T):c.memoizedState=Zm(c.type,i.memoizedProps,c.pendingProps,i.memoizedState),null;case 27:return Yt(c),i===null&&Yr&&(T=c.stateNode=F_(c.type,c.pendingProps,bt.current),en=c,On=!0,I=$r,Rh(c.type)?(fo=I,$r=gl(T.firstChild)):$r=I),rs(i,c,c.pendingProps.children,g),jp(i,c),i===null&&(c.flags|=4194304),c.child;case 5:return i===null&&Yr&&((I=T=$r)&&(T=hs(T,c.type,c.pendingProps,On),T!==null?(c.stateNode=T,en=c,$r=gl(T.firstChild),On=!1,I=!0):I=!1),I||Wa(c)),Yt(c),I=c.type,L=c.pendingProps,ne=i!==null?i.memoizedProps:null,T=L.children,x0(I,L)?T=null:ne!==null&&x0(I,ne)&&(c.flags|=32),c.memoizedState!==null&&(I=yh(i,c,lf,null,null,g),cd._currentValue=I),jp(i,c),rs(i,c,T,g),c.child;case 6:return i===null&&Yr&&((i=g=$r)&&(g=Ac(g,c.pendingProps,On),g!==null?(c.stateNode=g,en=c,$r=null,i=!0):i=!1),i||Wa(c)),null;case 13:return cm(i,c,g);case 4:return Zt(c,c.stateNode.containerInfo),T=c.pendingProps,i===null?c.child=Ul(c,null,T,g):rs(i,c,T,g),c.child;case 11:return Yg(i,c,c.type,c.pendingProps,g);case 7:return rs(i,c,c.pendingProps,g),c.child;case 8:return rs(i,c,c.pendingProps.children,g),c.child;case 12:return rs(i,c,c.pendingProps.children,g),c.child;case 10:return T=c.pendingProps,zi(c,c.type,T.value),rs(i,c,T.children,g),c.child;case 9:return I=c.type._context,T=c.pendingProps.children,al(c),I=Xa(I),T=T(I),c.flags|=1,rs(i,c,T,g),c.child;case 14:return Bp(i,c,c.type,c.pendingProps,g);case 15:return sm(i,c,c.type,c.pendingProps,g);case 19:return qp(i,c,g);case 31:return Np(i,c,g);case 22:return om(i,c,g,c.pendingProps);case 24:return al(c),T=Xa(Na),i===null?(I=Lf(),I===null&&(I=Fa,L=Ns(),I.pooledCache=L,L.refCount++,L!==null&&(I.pooledCacheLanes|=g),I=L),c.memoizedState={parent:T,cache:I},jf(c),zi(c,Na,I)):((i.lanes&g)!==0&&(tf(i,c),Wc(c,null,null,g),gc()),I=i.memoizedState,L=c.memoizedState,I.parent!==T?(I={parent:T,cache:T},c.memoizedState=I,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=I),zi(c,Na,T)):(T=L.cache,zi(c,Na,T),T!==I.cache&&mh(c,[Na],g,!0))),rs(i,c,c.pendingProps.children,g),c.child;case 29:throw c.pendingProps}throw Error(f(156,c.tag))}function Qc(i){i.flags|=4}function Fd(i,c,g,T,I){if((c=(i.mode&32)!==0)&&(c=!1),c){if(i.flags|=16777216,(I&335544128)===I)if(i.stateNode.complete)i.flags|=8192;else if(Sm())i.flags|=8192;else throw ol=kr,Zc}else i.flags&=-16777217}function t_(i,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!ap(c))if(Sm())i.flags|=8192;else throw ol=kr,Zc}function Ld(i,c){c!==null&&(i.flags|=4),i.flags&16384&&(c=i.tag!==22?Fn():536870912,i.lanes|=c,_f|=c)}function zd(i,c){if(!Yr)switch(i.tailMode){case"hidden":c=i.tail;for(var g=null;c!==null;)c.alternate!==null&&(g=c),c=c.sibling;g===null?i.tail=null:g.sibling=null;break;case"collapsed":g=i.tail;for(var T=null;g!==null;)g.alternate!==null&&(T=g),g=g.sibling;T===null?c||i.tail===null?i.tail=null:i.tail.sibling=null:T.sibling=null}}function Qa(i){var c=i.alternate!==null&&i.alternate.child===i.child,g=0,T=0;if(c)for(var I=i.child;I!==null;)g|=I.lanes|I.childLanes,T|=I.subtreeFlags&65011712,T|=I.flags&65011712,I.return=i,I=I.sibling;else for(I=i.child;I!==null;)g|=I.lanes|I.childLanes,T|=I.subtreeFlags,T|=I.flags,I.return=i,I=I.sibling;return i.subtreeFlags|=T,i.childLanes=g,c}function r_(i,c,g){var T=c.pendingProps;switch(ln(c),c.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qa(c),null;case 1:return Qa(c),null;case 3:return g=c.stateNode,T=null,i!==null&&(T=i.memoizedState.cache),c.memoizedState.cache!==T&&(c.flags|=2048),ui(Na),jt(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(i===null||i.child===null)&&(Fi(c)?Qc(c):i===null||i.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Bs())),Qa(c),null;case 26:var I=c.type,L=c.memoizedState;return i===null?(Qc(c),L!==null?(Qa(c),t_(c,L)):(Qa(c),Fd(c,I,null,T,g))):L?L!==i.memoizedState?(Qc(c),Qa(c),t_(c,L)):(Qa(c),c.flags&=-16777217):(i=i.memoizedProps,i!==T&&Qc(c),Qa(c),Fd(c,I,i,T,g)),null;case 27:if(jr(c),g=bt.current,I=c.type,i!==null&&c.stateNode!=null)i.memoizedProps!==T&&Qc(c);else{if(!T){if(c.stateNode===null)throw Error(f(166));return Qa(c),null}i=Pe.current,Fi(c)?$a(c):(i=F_(I,T,g),c.stateNode=i,Qc(c))}return Qa(c),null;case 5:if(jr(c),I=c.type,i!==null&&c.stateNode!=null)i.memoizedProps!==T&&Qc(c);else{if(!T){if(c.stateNode===null)throw Error(f(166));return Qa(c),null}if(L=Pe.current,Fi(c))$a(c);else{var ne=ep(bt.current);switch(L){case 1:L=ne.createElementNS("http://www.w3.org/2000/svg",I);break;case 2:L=ne.createElementNS("http://www.w3.org/1998/Math/MathML",I);break;default:switch(I){case"svg":L=ne.createElementNS("http://www.w3.org/2000/svg",I);break;case"math":L=ne.createElementNS("http://www.w3.org/1998/Math/MathML",I);break;case"script":L=ne.createElement("div"),L.innerHTML="<script><\/script>",L=L.removeChild(L.firstChild);break;case"select":L=typeof T.is=="string"?ne.createElement("select",{is:T.is}):ne.createElement("select"),T.multiple?L.multiple=!0:T.size&&(L.size=T.size);break;default:L=typeof T.is=="string"?ne.createElement(I,{is:T.is}):ne.createElement(I)}}L[Re]=c,L[Te]=T;e:for(ne=c.child;ne!==null;){if(ne.tag===5||ne.tag===6)L.appendChild(ne.stateNode);else if(ne.tag!==4&&ne.tag!==27&&ne.child!==null){ne.child.return=ne,ne=ne.child;continue}if(ne===c)break e;for(;ne.sibling===null;){if(ne.return===null||ne.return===c)break e;ne=ne.return}ne.sibling.return=ne.return,ne=ne.sibling}c.stateNode=L;e:switch(as(L,I,T),I){case"button":case"input":case"select":case"textarea":T=!!T.autoFocus;break e;case"img":T=!0;break e;default:T=!1}T&&Qc(c)}}return Qa(c),Fd(c,c.type,i===null?null:i.memoizedProps,c.pendingProps,g),null;case 6:if(i&&c.stateNode!=null)i.memoizedProps!==T&&Qc(c);else{if(typeof T!="string"&&c.stateNode===null)throw Error(f(166));if(i=bt.current,Fi(c)){if(i=c.stateNode,g=c.memoizedProps,T=null,I=en,I!==null)switch(I.tag){case 27:case 5:T=I.memoizedProps}i[Re]=c,i=!!(i.nodeValue===g||T!==null&&T.suppressHydrationWarning===!0||zm(i.nodeValue,g)),i||Wa(c,!0)}else i=ep(i).createTextNode(T),i[Re]=c,c.stateNode=i}return Qa(c),null;case 31:if(g=c.memoizedState,i===null||i.memoizedState!==null){if(T=Fi(c),g!==null){if(i===null){if(!T)throw Error(f(318));if(i=c.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(f(557));i[Re]=c}else Li(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Qa(c),i=!1}else g=Bs(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=g),i=!0;if(!i)return c.flags&256?(ja(c),c):(ja(c),null);if((c.flags&128)!==0)throw Error(f(558))}return Qa(c),null;case 13:if(T=c.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(I=Fi(c),T!==null&&T.dehydrated!==null){if(i===null){if(!I)throw Error(f(318));if(I=c.memoizedState,I=I!==null?I.dehydrated:null,!I)throw Error(f(317));I[Re]=c}else Li(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Qa(c),I=!1}else I=Bs(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=I),I=!0;if(!I)return c.flags&256?(ja(c),c):(ja(c),null)}return ja(c),(c.flags&128)!==0?(c.lanes=g,c):(g=T!==null,i=i!==null&&i.memoizedState!==null,g&&(T=c.child,I=null,T.alternate!==null&&T.alternate.memoizedState!==null&&T.alternate.memoizedState.cachePool!==null&&(I=T.alternate.memoizedState.cachePool.pool),L=null,T.memoizedState!==null&&T.memoizedState.cachePool!==null&&(L=T.memoizedState.cachePool.pool),L!==I&&(T.flags|=2048)),g!==i&&g&&(c.child.flags|=8192),Ld(c,c.updateQueue),Qa(c),null);case 4:return jt(),i===null&&Fm(c.stateNode.containerInfo),Qa(c),null;case 10:return ui(c.type),Qa(c),null;case 19:if(re(Ya),T=c.memoizedState,T===null)return Qa(c),null;if(I=(c.flags&128)!==0,L=T.rendering,L===null)if(I)zd(T,!1);else{if(fi!==0||i!==null&&(i.flags&128)!==0)for(i=c.child;i!==null;){if(L=sf(i),L!==null){for(c.flags|=128,zd(T,!1),i=L.updateQueue,c.updateQueue=i,Ld(c,i),c.subtreeFlags=0,i=g,g=c.child;g!==null;)ht(g,i),g=g.sibling;return Ve(Ya,Ya.current&1|2),Yr&&Fr(c,T.treeForkCount),c.child}i=i.sibling}T.tail!==null&&pr()>qd&&(c.flags|=128,I=!0,zd(T,!1),c.lanes=4194304)}else{if(!I)if(i=sf(L),i!==null){if(c.flags|=128,I=!0,i=i.updateQueue,c.updateQueue=i,Ld(c,i),zd(T,!0),T.tail===null&&T.tailMode==="hidden"&&!L.alternate&&!Yr)return Qa(c),null}else 2*pr()-T.renderingStartTime>qd&&g!==536870912&&(c.flags|=128,I=!0,zd(T,!1),c.lanes=4194304);T.isBackwards?(L.sibling=c.child,c.child=L):(i=T.last,i!==null?i.sibling=L:c.child=L,T.last=L)}return T.tail!==null?(i=T.tail,T.rendering=i,T.tail=i.sibling,T.renderingStartTime=pr(),i.sibling=null,g=Ya.current,Ve(Ya,I?g&1|2:g&1),Yr&&Fr(c,T.treeForkCount),i):(Qa(c),null);case 22:case 23:return ja(c),Mu(),T=c.memoizedState!==null,i!==null?i.memoizedState!==null!==T&&(c.flags|=8192):T&&(c.flags|=8192),T?(g&536870912)!==0&&(c.flags&128)===0&&(Qa(c),c.subtreeFlags&6&&(c.flags|=8192)):Qa(c),g=c.updateQueue,g!==null&&Ld(c,g.retryQueue),g=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(g=i.memoizedState.cachePool.pool),T=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(T=c.memoizedState.cachePool.pool),T!==g&&(c.flags|=2048),i!==null&&re(il),null;case 24:return g=null,i!==null&&(g=i.memoizedState.cache),c.memoizedState.cache!==g&&(c.flags|=2048),ui(Na),Qa(c),null;case 25:return null;case 30:return null}throw Error(f(156,c.tag))}function Vx(i,c){switch(ln(c),c.tag){case 1:return i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 3:return ui(Na),jt(),i=c.flags,(i&65536)!==0&&(i&128)===0?(c.flags=i&-65537|128,c):null;case 26:case 27:case 5:return jr(c),null;case 31:if(c.memoizedState!==null){if(ja(c),c.alternate===null)throw Error(f(340));Li()}return i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 13:if(ja(c),i=c.memoizedState,i!==null&&i.dehydrated!==null){if(c.alternate===null)throw Error(f(340));Li()}return i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 19:return re(Ya),null;case 4:return jt(),null;case 10:return ui(c.type),null;case 22:case 23:return ja(c),Mu(),i!==null&&re(il),i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 24:return ui(Na),null;case 25:return null;default:return null}}function Zp(i,c){switch(ln(c),c.tag){case 3:ui(Na),jt();break;case 26:case 27:case 5:jr(c);break;case 4:jt();break;case 31:c.memoizedState!==null&&ja(c);break;case 13:ja(c);break;case 19:re(Ya);break;case 10:ui(c.type);break;case 22:case 23:ja(c),Mu(),i!==null&&re(il);break;case 24:ui(Na)}}function Zf(i,c){try{var g=c.updateQueue,T=g!==null?g.lastEffect:null;if(T!==null){var I=T.next;g=I;do{if((g.tag&i)===i){T=void 0;var L=g.create,ne=g.inst;T=L(),ne.destroy=T}g=g.next}while(g!==I)}}catch(Ae){da(c,c.return,Ae)}}function zu(i,c,g){try{var T=c.updateQueue,I=T!==null?T.lastEffect:null;if(I!==null){var L=I.next;T=L;do{if((T.tag&i)===i){var ne=T.inst,Ae=ne.destroy;if(Ae!==void 0){ne.destroy=void 0,I=c;var ct=g,zt=Ae;try{zt()}catch(Qt){da(I,ct,Qt)}}}T=T.next}while(T!==L)}}catch(Qt){da(c,c.return,Qt)}}function n_(i){var c=i.updateQueue;if(c!==null){var g=i.stateNode;try{Uf(c,g)}catch(T){da(i,i.return,T)}}}function a_(i,c,g){g.props=Yc(i.type,i.memoizedProps),g.state=i.memoizedState;try{g.componentWillUnmount()}catch(T){da(i,c,T)}}function Od(i,c){try{var g=i.ref;if(g!==null){switch(i.tag){case 26:case 27:case 5:var T=i.stateNode;break;case 30:T=i.stateNode;break;default:T=i.stateNode}typeof g=="function"?i.refCleanup=g(T):g.current=T}}catch(I){da(i,c,I)}}function pl(i,c){var g=i.ref,T=i.refCleanup;if(g!==null)if(typeof T=="function")try{T()}catch(I){da(i,c,I)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof g=="function")try{g(null)}catch(I){da(i,c,I)}else g.current=null}function Wp(i){var c=i.type,g=i.memoizedProps,T=i.stateNode;try{e:switch(c){case"button":case"input":case"select":case"textarea":g.autoFocus&&T.focus();break e;case"img":g.src?T.src=g.src:g.srcSet&&(T.srcset=g.srcSet)}}catch(I){da(i,i.return,I)}}function $p(i,c,g){try{var T=i.stateNode;I_(T,i.type,g,c),T[Te]=c}catch(I){da(i,i.return,I)}}function Th(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Rh(i.type)||i.tag===4}function df(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Th(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Rh(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function dm(i,c,g){var T=i.tag;if(T===5||T===6)i=i.stateNode,c?(g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g).insertBefore(i,c):(c=g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g,c.appendChild(i),g=g._reactRootContainer,g!=null||c.onclick!==null||(c.onclick=Ds));else if(T!==4&&(T===27&&Rh(i.type)&&(g=i.stateNode,c=null),i=i.child,i!==null))for(dm(i,c,g),i=i.sibling;i!==null;)dm(i,c,g),i=i.sibling}function Xp(i,c,g){var T=i.tag;if(T===5||T===6)i=i.stateNode,c?g.insertBefore(i,c):g.appendChild(i);else if(T!==4&&(T===27&&Rh(i.type)&&(g=i.stateNode),i=i.child,i!==null))for(Xp(i,c,g),i=i.sibling;i!==null;)Xp(i,c,g),i=i.sibling}function i_(i){var c=i.stateNode,g=i.memoizedProps;try{for(var T=i.type,I=c.attributes;I.length;)c.removeAttributeNode(I[0]);as(c,T,g),c[Re]=i,c[Te]=g}catch(L){da(i,i.return,L)}}var Ou=!1,Ui=!1,pm=!1,s_=typeof WeakSet=="function"?WeakSet:Set,Vi=null;function Gx(i,c){if(i=i.containerInfo,Qd=cp,i=vu(i),Ll(i)){if("selectionStart"in i)var g={start:i.selectionStart,end:i.selectionEnd};else e:{g=(g=i.ownerDocument)&&g.defaultView||window;var T=g.getSelection&&g.getSelection();if(T&&T.rangeCount!==0){g=T.anchorNode;var I=T.anchorOffset,L=T.focusNode;T=T.focusOffset;try{g.nodeType,L.nodeType}catch{g=null;break e}var ne=0,Ae=-1,ct=-1,zt=0,Qt=0,or=i,Ot=null;t:for(;;){for(var Gt;or!==g||I!==0&&or.nodeType!==3||(Ae=ne+I),or!==L||T!==0&&or.nodeType!==3||(ct=ne+T),or.nodeType===3&&(ne+=or.nodeValue.length),(Gt=or.firstChild)!==null;)Ot=or,or=Gt;for(;;){if(or===i)break t;if(Ot===g&&++zt===I&&(Ae=ne),Ot===L&&++Qt===T&&(ct=ne),(Gt=or.nextSibling)!==null)break;or=Ot,Ot=or.parentNode}or=Gt}g=Ae===-1||ct===-1?null:{start:Ae,end:ct}}else g=null}g=g||{start:0,end:0}}else g=null;for(Om={focusedElem:i,selectionRange:g},cp=!1,Vi=c;Vi!==null;)if(c=Vi,i=c.child,(c.subtreeFlags&1028)!==0&&i!==null)i.return=c,Vi=i;else for(;Vi!==null;){switch(c=Vi,L=c.alternate,i=c.flags,c.tag){case 0:if((i&4)!==0&&(i=c.updateQueue,i=i!==null?i.events:null,i!==null))for(g=0;g<i.length;g++)I=i[g],I.ref.impl=I.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&L!==null){i=void 0,g=c,I=L.memoizedProps,L=L.memoizedState,T=g.stateNode;try{var Hr=Yc(g.type,I);i=T.getSnapshotBeforeUpdate(Hr,L),T.__reactInternalSnapshotBeforeUpdate=i}catch(on){da(g,g.return,on)}}break;case 3:if((i&1024)!==0){if(i=c.stateNode.containerInfo,g=i.nodeType,g===9)Ec(i);else if(g===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Ec(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(f(163))}if(i=c.sibling,i!==null){i.return=c.return,Vi=i;break}Vi=c.return}}function mm(i,c,g){var T=g.flags;switch(g.tag){case 0:case 11:case 15:Fo(i,g),T&4&&Zf(5,g);break;case 1:if(Fo(i,g),T&4)if(i=g.stateNode,c===null)try{i.componentDidMount()}catch(ne){da(g,g.return,ne)}else{var I=Yc(g.type,c.memoizedProps);c=c.memoizedState;try{i.componentDidUpdate(I,c,i.__reactInternalSnapshotBeforeUpdate)}catch(ne){da(g,g.return,ne)}}T&64&&n_(g),T&512&&Od(g,g.return);break;case 3:if(Fo(i,g),T&64&&(i=g.updateQueue,i!==null)){if(c=null,g.child!==null)switch(g.child.tag){case 27:case 5:c=g.child.stateNode;break;case 1:c=g.child.stateNode}try{Uf(i,c)}catch(ne){da(g,g.return,ne)}}break;case 27:c===null&&T&4&&i_(g);case 26:case 5:Fo(i,g),c===null&&T&4&&Wp(g),T&512&&Od(g,g.return);break;case 12:Fo(i,g);break;case 31:Fo(i,g),T&4&&Bd(i,g);break;case 13:Fo(i,g),T&4&&Nd(i,g),T&64&&(i=g.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(g=Am.bind(null,g),Hi(i,g))));break;case 22:if(T=g.memoizedState!==null||Ou,!T){c=c!==null&&c.memoizedState!==null||Ui,I=Ou;var L=Ui;Ou=T,(Ui=c)&&!L?Bu(i,g,(g.subtreeFlags&8772)!==0):Fo(i,g),Ou=I,Ui=L}break;case 30:break;default:Fo(i,g)}}function Wf(i){var c=i.alternate;c!==null&&(i.alternate=null,Wf(c)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(c=i.stateNode,c!==null&&ir(c)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var ai=null,Hn=!1;function Po(i,c,g){for(g=g.child;g!==null;)gm(i,c,g),g=g.sibling}function gm(i,c,g){if(at&&typeof at.onCommitFiberUnmount=="function")try{at.onCommitFiberUnmount(lt,g)}catch{}switch(g.tag){case 26:Ui||pl(g,c),Po(i,c,g),g.memoizedState?g.memoizedState.count--:g.stateNode&&(g=g.stateNode,g.parentNode.removeChild(g));break;case 27:Ui||pl(g,c);var T=ai,I=Hn;Rh(g.type)&&(ai=g.stateNode,Hn=!1),Po(i,c,g),sd(g.stateNode),ai=T,Hn=I;break;case 5:Ui||pl(g,c);case 6:if(T=ai,I=Hn,ai=null,Po(i,c,g),ai=T,Hn=I,ai!==null)if(Hn)try{(ai.nodeType===9?ai.body:ai.nodeName==="HTML"?ai.ownerDocument.body:ai).removeChild(g.stateNode)}catch(L){da(g,c,L)}else try{ai.removeChild(g.stateNode)}catch(L){da(g,c,L)}break;case 18:ai!==null&&(Hn?(i=ai,P_(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,g.stateNode),Oh(i)):P_(ai,g.stateNode));break;case 4:T=ai,I=Hn,ai=g.stateNode.containerInfo,Hn=!0,Po(i,c,g),ai=T,Hn=I;break;case 0:case 11:case 14:case 15:zu(2,g,c),Ui||zu(4,g,c),Po(i,c,g);break;case 1:Ui||(pl(g,c),T=g.stateNode,typeof T.componentWillUnmount=="function"&&a_(g,c,T)),Po(i,c,g);break;case 21:Po(i,c,g);break;case 22:Ui=(T=Ui)||g.memoizedState!==null,Po(i,c,g),Ui=T;break;default:Po(i,c,g)}}function Bd(i,c){if(c.memoizedState===null&&(i=c.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{Oh(i)}catch(g){da(c,c.return,g)}}}function Nd(i,c){if(c.memoizedState===null&&(i=c.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Oh(i)}catch(g){da(c,c.return,g)}}function jd(i){switch(i.tag){case 31:case 13:case 19:var c=i.stateNode;return c===null&&(c=i.stateNode=new s_),c;case 22:return i=i.stateNode,c=i._retryCache,c===null&&(c=i._retryCache=new s_),c;default:throw Error(f(435,i.tag))}}function Ud(i,c){var g=jd(i);c.forEach(function(T){if(!g.has(T)){g.add(T);var I=Zx.bind(null,i,T);T.then(I,I)}})}function co(i,c){var g=c.deletions;if(g!==null)for(var T=0;T<g.length;T++){var I=g[T],L=i,ne=c,Ae=ne;e:for(;Ae!==null;){switch(Ae.tag){case 27:if(Rh(Ae.type)){ai=Ae.stateNode,Hn=!1;break e}break;case 5:ai=Ae.stateNode,Hn=!1;break e;case 3:case 4:ai=Ae.stateNode.containerInfo,Hn=!0;break e}Ae=Ae.return}if(ai===null)throw Error(f(160));gm(L,ne,I),ai=null,Hn=!1,L=I.alternate,L!==null&&(L.return=null),I.return=null}if(c.subtreeFlags&13886)for(c=c.child;c!==null;)Yp(c,i),c=c.sibling}var uo=null;function Yp(i,c){var g=i.alternate,T=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:co(c,i),ns(i),T&4&&(zu(3,i,i.return),Zf(3,i),zu(5,i,i.return));break;case 1:co(c,i),ns(i),T&512&&(Ui||g===null||pl(g,g.return)),T&64&&Ou&&(i=i.updateQueue,i!==null&&(T=i.callbacks,T!==null&&(g=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=g===null?T:g.concat(T))));break;case 26:var I=uo;if(co(c,i),ns(i),T&512&&(Ui||g===null||pl(g,g.return)),T&4){var L=g!==null?g.memoizedState:null;if(T=i.memoizedState,g===null)if(T===null)if(i.stateNode===null){e:{T=i.type,g=i.memoizedProps,I=I.ownerDocument||I;t:switch(T){case"title":L=I.getElementsByTagName("title")[0],(!L||L[gt]||L[Re]||L.namespaceURI==="http://www.w3.org/2000/svg"||L.hasAttribute("itemprop"))&&(L=I.createElement(T),I.head.insertBefore(L,I.querySelector("head > title"))),as(L,T,g),L[Re]=i,Nr(L),T=L;break e;case"link":var ne=Ym("link","href",I).get(T+(g.href||""));if(ne){for(var Ae=0;Ae<ne.length;Ae++)if(L=ne[Ae],L.getAttribute("href")===(g.href==null||g.href===""?null:g.href)&&L.getAttribute("rel")===(g.rel==null?null:g.rel)&&L.getAttribute("title")===(g.title==null?null:g.title)&&L.getAttribute("crossorigin")===(g.crossOrigin==null?null:g.crossOrigin)){ne.splice(Ae,1);break t}}L=I.createElement(T),as(L,T,g),I.head.appendChild(L);break;case"meta":if(ne=Ym("meta","content",I).get(T+(g.content||""))){for(Ae=0;Ae<ne.length;Ae++)if(L=ne[Ae],L.getAttribute("content")===(g.content==null?null:""+g.content)&&L.getAttribute("name")===(g.name==null?null:g.name)&&L.getAttribute("property")===(g.property==null?null:g.property)&&L.getAttribute("http-equiv")===(g.httpEquiv==null?null:g.httpEquiv)&&L.getAttribute("charset")===(g.charSet==null?null:g.charSet)){ne.splice(Ae,1);break t}}L=I.createElement(T),as(L,T,g),I.head.appendChild(L);break;default:throw Error(f(468,T))}L[Re]=i,Nr(L),T=L}i.stateNode=T}else np(I,i.type,i.stateNode);else i.stateNode=Xm(I,T,i.memoizedProps);else L!==T?(L===null?g.stateNode!==null&&(g=g.stateNode,g.parentNode.removeChild(g)):L.count--,T===null?np(I,i.type,i.stateNode):Xm(I,T,i.memoizedProps)):T===null&&i.stateNode!==null&&$p(i,i.memoizedProps,g.memoizedProps)}break;case 27:co(c,i),ns(i),T&512&&(Ui||g===null||pl(g,g.return)),g!==null&&T&4&&$p(i,i.memoizedProps,g.memoizedProps);break;case 5:if(co(c,i),ns(i),T&512&&(Ui||g===null||pl(g,g.return)),i.flags&32){I=i.stateNode;try{Ks(I,"")}catch(Hr){da(i,i.return,Hr)}}T&4&&i.stateNode!=null&&(I=i.memoizedProps,$p(i,I,g!==null?g.memoizedProps:I)),T&1024&&(pm=!0);break;case 6:if(co(c,i),ns(i),T&4){if(i.stateNode===null)throw Error(f(162));T=i.memoizedProps,g=i.stateNode;try{g.nodeValue=T}catch(Hr){da(i,i.return,Hr)}}break;case 3:if(S0=null,I=uo,uo=b0(c.containerInfo),co(c,i),uo=I,ns(i),T&4&&g!==null&&g.memoizedState.isDehydrated)try{Oh(c.containerInfo)}catch(Hr){da(i,i.return,Hr)}pm&&(pm=!1,Vd(i));break;case 4:T=uo,uo=b0(i.stateNode.containerInfo),co(c,i),ns(i),uo=T;break;case 12:co(c,i),ns(i);break;case 31:co(c,i),ns(i),T&4&&(T=i.updateQueue,T!==null&&(i.updateQueue=null,Ud(i,T)));break;case 13:co(c,i),ns(i),i.child.flags&8192&&i.memoizedState!==null!=(g!==null&&g.memoizedState!==null)&&(Qp=pr()),T&4&&(T=i.updateQueue,T!==null&&(i.updateQueue=null,Ud(i,T)));break;case 22:I=i.memoizedState!==null;var ct=g!==null&&g.memoizedState!==null,zt=Ou,Qt=Ui;if(Ou=zt||I,Ui=Qt||ct,co(c,i),Ui=Qt,Ou=zt,ns(i),T&8192)e:for(c=i.stateNode,c._visibility=I?c._visibility&-2:c._visibility|1,I&&(g===null||ct||Ou||Ui||wc(i)),g=null,c=i;;){if(c.tag===5||c.tag===26){if(g===null){ct=g=c;try{if(L=ct.stateNode,I)ne=L.style,typeof ne.setProperty=="function"?ne.setProperty("display","none","important"):ne.display="none";else{Ae=ct.stateNode;var or=ct.memoizedProps.style,Ot=or!=null&&or.hasOwnProperty("display")?or.display:null;Ae.style.display=Ot==null||typeof Ot=="boolean"?"":(""+Ot).trim()}}catch(Hr){da(ct,ct.return,Hr)}}}else if(c.tag===6){if(g===null){ct=c;try{ct.stateNode.nodeValue=I?"":ct.memoizedProps}catch(Hr){da(ct,ct.return,Hr)}}}else if(c.tag===18){if(g===null){ct=c;try{var Gt=ct.stateNode;I?Sn(Gt,!0):Sn(ct.stateNode,!1)}catch(Hr){da(ct,ct.return,Hr)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===i)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===i)break e;for(;c.sibling===null;){if(c.return===null||c.return===i)break e;g===c&&(g=null),c=c.return}g===c&&(g=null),c.sibling.return=c.return,c=c.sibling}T&4&&(T=i.updateQueue,T!==null&&(g=T.retryQueue,g!==null&&(T.retryQueue=null,Ud(i,g))));break;case 19:co(c,i),ns(i),T&4&&(T=i.updateQueue,T!==null&&(i.updateQueue=null,Ud(i,T)));break;case 30:break;case 21:break;default:co(c,i),ns(i)}}function ns(i){var c=i.flags;if(c&2){try{for(var g,T=i.return;T!==null;){if(Th(T)){g=T;break}T=T.return}if(g==null)throw Error(f(160));switch(g.tag){case 27:var I=g.stateNode,L=df(i);Xp(i,L,I);break;case 5:var ne=g.stateNode;g.flags&32&&(Ks(ne,""),g.flags&=-33);var Ae=df(i);Xp(i,Ae,ne);break;case 3:case 4:var ct=g.stateNode.containerInfo,zt=df(i);dm(i,zt,ct);break;default:throw Error(f(161))}}catch(Qt){da(i,i.return,Qt)}i.flags&=-3}c&4096&&(i.flags&=-4097)}function Vd(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var c=i;Vd(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),i=i.sibling}}function Fo(i,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)mm(i,c.alternate,c),c=c.sibling}function wc(i){for(i=i.child;i!==null;){var c=i;switch(c.tag){case 0:case 11:case 14:case 15:zu(4,c,c.return),wc(c);break;case 1:pl(c,c.return);var g=c.stateNode;typeof g.componentWillUnmount=="function"&&a_(c,c.return,g),wc(c);break;case 27:sd(c.stateNode);case 26:case 5:pl(c,c.return),wc(c);break;case 22:c.memoizedState===null&&wc(c);break;case 30:wc(c);break;default:wc(c)}i=i.sibling}}function Bu(i,c,g){for(g=g&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var T=c.alternate,I=i,L=c,ne=L.flags;switch(L.tag){case 0:case 11:case 15:Bu(I,L,g),Zf(4,L);break;case 1:if(Bu(I,L,g),T=L,I=T.stateNode,typeof I.componentDidMount=="function")try{I.componentDidMount()}catch(zt){da(T,T.return,zt)}if(T=L,I=T.updateQueue,I!==null){var Ae=T.stateNode;try{var ct=I.shared.hiddenCallbacks;if(ct!==null)for(I.shared.hiddenCallbacks=null,I=0;I<ct.length;I++)rf(ct[I],Ae)}catch(zt){da(T,T.return,zt)}}g&&ne&64&&n_(L),Od(L,L.return);break;case 27:i_(L);case 26:case 5:Bu(I,L,g),g&&T===null&&ne&4&&Wp(L),Od(L,L.return);break;case 12:Bu(I,L,g);break;case 31:Bu(I,L,g),g&&ne&4&&Bd(I,L);break;case 13:Bu(I,L,g),g&&ne&4&&Nd(I,L);break;case 22:L.memoizedState===null&&Bu(I,L,g),Od(L,L.return);break;case 30:break;default:Bu(I,L,g)}c=c.sibling}}function Kp(i,c){var g=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(g=i.memoizedState.cachePool.pool),i=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(i=c.memoizedState.cachePool.pool),i!==g&&(i!=null&&i.refCount++,g!=null&&pc(g))}function Nu(i,c){i=null,c.alternate!==null&&(i=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==i&&(c.refCount++,i!=null&&pc(i))}function Tc(i,c,g,T){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)_m(i,c,g,T),c=c.sibling}function _m(i,c,g,T){var I=c.flags;switch(c.tag){case 0:case 11:case 15:Tc(i,c,g,T),I&2048&&Zf(9,c);break;case 1:Tc(i,c,g,T);break;case 3:Tc(i,c,g,T),I&2048&&(i=null,c.alternate!==null&&(i=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==i&&(c.refCount++,i!=null&&pc(i)));break;case 12:if(I&2048){Tc(i,c,g,T),i=c.stateNode;try{var L=c.memoizedProps,ne=L.id,Ae=L.onPostCommit;typeof Ae=="function"&&Ae(ne,c.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(ct){da(c,c.return,ct)}}else Tc(i,c,g,T);break;case 31:Tc(i,c,g,T);break;case 13:Tc(i,c,g,T);break;case 23:break;case 22:L=c.stateNode,ne=c.alternate,c.memoizedState!==null?L._visibility&2?Tc(i,c,g,T):pf(i,c):L._visibility&2?Tc(i,c,g,T):(L._visibility|=2,eu(i,c,g,T,(c.subtreeFlags&10256)!==0||!1)),I&2048&&Kp(ne,c);break;case 24:Tc(i,c,g,T),I&2048&&Nu(c.alternate,c);break;default:Tc(i,c,g,T)}}function eu(i,c,g,T,I){for(I=I&&((c.subtreeFlags&10256)!==0||!1),c=c.child;c!==null;){var L=i,ne=c,Ae=g,ct=T,zt=ne.flags;switch(ne.tag){case 0:case 11:case 15:eu(L,ne,Ae,ct,I),Zf(8,ne);break;case 23:break;case 22:var Qt=ne.stateNode;ne.memoizedState!==null?Qt._visibility&2?eu(L,ne,Ae,ct,I):pf(L,ne):(Qt._visibility|=2,eu(L,ne,Ae,ct,I)),I&&zt&2048&&Kp(ne.alternate,ne);break;case 24:eu(L,ne,Ae,ct,I),I&&zt&2048&&Nu(ne.alternate,ne);break;default:eu(L,ne,Ae,ct,I)}c=c.sibling}}function pf(i,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var g=i,T=c,I=T.flags;switch(T.tag){case 22:pf(g,T),I&2048&&Kp(T.alternate,T);break;case 24:pf(g,T),I&2048&&Nu(T.alternate,T);break;default:pf(g,T)}c=c.sibling}}var $f=8192;function mf(i,c,g){if(i.subtreeFlags&$f)for(i=i.child;i!==null;)o_(i,c,g),i=i.sibling}function o_(i,c,g){switch(i.tag){case 26:mf(i,c,g),i.flags&$f&&i.memoizedState!==null&&Km(g,uo,i.memoizedState,i.memoizedProps);break;case 5:mf(i,c,g);break;case 3:case 4:var T=uo;uo=b0(i.stateNode.containerInfo),mf(i,c,g),uo=T;break;case 22:i.memoizedState===null&&(T=i.alternate,T!==null&&T.memoizedState!==null?(T=$f,$f=16777216,mf(i,c,g),$f=T):mf(i,c,g));break;default:mf(i,c,g)}}function l_(i){var c=i.alternate;if(c!==null&&(i=c.child,i!==null)){c.child=null;do c=i.sibling,i.sibling=null,i=c;while(i!==null)}}function Gd(i){var c=i.deletions;if((i.flags&16)!==0){if(c!==null)for(var g=0;g<c.length;g++){var T=c[g];Vi=T,Xf(T,i)}l_(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)c_(i),i=i.sibling}function c_(i){switch(i.tag){case 0:case 11:case 15:Gd(i),i.flags&2048&&zu(9,i,i.return);break;case 3:Gd(i);break;case 12:Gd(i);break;case 22:var c=i.stateNode;i.memoizedState!==null&&c._visibility&2&&(i.return===null||i.return.tag!==13)?(c._visibility&=-3,Jp(i)):Gd(i);break;default:Gd(i)}}function Jp(i){var c=i.deletions;if((i.flags&16)!==0){if(c!==null)for(var g=0;g<c.length;g++){var T=c[g];Vi=T,Xf(T,i)}l_(i)}for(i=i.child;i!==null;){switch(c=i,c.tag){case 0:case 11:case 15:zu(8,c,c.return),Jp(c);break;case 22:g=c.stateNode,g._visibility&2&&(g._visibility&=-3,Jp(c));break;default:Jp(c)}i=i.sibling}}function Xf(i,c){for(;Vi!==null;){var g=Vi;switch(g.tag){case 0:case 11:case 15:zu(8,g,c);break;case 23:case 22:if(g.memoizedState!==null&&g.memoizedState.cachePool!==null){var T=g.memoizedState.cachePool.pool;T!=null&&T.refCount++}break;case 24:pc(g.memoizedState.cache)}if(T=g.child,T!==null)T.return=g,Vi=T;else e:for(g=i;Vi!==null;){T=Vi;var I=T.sibling,L=T.return;if(Wf(T),T===g){Vi=null;break e}if(I!==null){I.return=L,Vi=I;break e}Vi=L}}}var Hx={getCacheForType:function(i){var c=Xa(Na),g=c.data.get(i);return g===void 0&&(g=i(),c.data.set(i,g)),g},cacheSignal:function(){return Xa(Na).controller.signal}},u_=typeof WeakMap=="function"?WeakMap:Map,fa=0,Fa=null,Nn=null,jn=0,Sa=0,ho=null,Wl=!1,Sh=!1,xm=!1,ju=0,fi=0,Uu=0,gf=0,ym=0,Es=0,_f=0,Hd=null,Lo=null,vm=!1,Qp=0,h_=0,qd=1/0,Yf=null,Vu=null,Gi=0,Gu=null,Kf=null,$l=0,bm=0,e0=null,f_=null,Zd=0,wm=null;function zo(){return(fa&2)!==0&&jn!==0?jn&-jn:tt.T!==null?Rm():xe()}function d_(){if(Es===0)if((jn&536870912)===0||Yr){var i=xn;xn<<=1,(xn&3932160)===0&&(xn=262144),Es=i}else Es=536870912;return i=Rr.current,i!==null&&(i.flags|=32),Es}function Oo(i,c,g){(i===Fa&&(Sa===2||Sa===9)||i.cancelPendingCommit!==null)&&(Qf(i,0),Eh(i,jn,Es,!1)),Vn(i,g),((fa&2)===0||i!==Fa)&&(i===Fa&&((fa&2)===0&&(gf|=g),fi===4&&Eh(i,jn,Es,!1)),Sc(i))}function Mi(i,c,g){if((fa&6)!==0)throw Error(f(327));var T=!g&&(c&127)===0&&(c&i.expiredLanes)===0||ya(i,c),I=T?ed(i,c):n0(i,c,!0),L=T;do{if(I===0){Sh&&!T&&Eh(i,c,0,!1);break}else{if(g=i.current.alternate,L&&!qx(g)){I=n0(i,c,!1),L=!1;continue}if(I===2){if(L=c,i.errorRecoveryDisabledLanes&L)var ne=0;else ne=i.pendingLanes&-536870913,ne=ne!==0?ne:ne&536870912?536870912:0;if(ne!==0){c=ne;e:{var Ae=i;I=Hd;var ct=Ae.current.memoizedState.isDehydrated;if(ct&&(Qf(Ae,ne).flags|=256),ne=n0(Ae,ne,!1),ne!==2){if(xm&&!ct){Ae.errorRecoveryDisabledLanes|=L,gf|=L,I=4;break e}L=Lo,Lo=I,L!==null&&(Lo===null?Lo=L:Lo.push.apply(Lo,L))}I=ne}if(L=!1,I!==2)continue}}if(I===1){Qf(i,0),Eh(i,c,0,!0);break}e:{switch(T=i,L=I,L){case 0:case 1:throw Error(f(345));case 4:if((c&4194048)!==c)break;case 6:Eh(T,c,Es,!Wl);break e;case 2:Lo=null;break;case 3:case 5:break;default:throw Error(f(329))}if((c&62914560)===c&&(I=Qp+300-pr(),10<I)){if(Eh(T,c,Es,!Wl),Ln(T,0,!0)!==0)break e;$l=c,T.timeoutHandle=v0(Jf.bind(null,T,g,Lo,Yf,vm,c,Es,gf,_f,Wl,L,"Throttled",-0,0),I);break e}Jf(T,g,Lo,Yf,vm,c,Es,gf,_f,Wl,L,null,-0,0)}}break}while(!0);Sc(i)}function Jf(i,c,g,T,I,L,ne,Ae,ct,zt,Qt,or,Ot,Gt){if(i.timeoutHandle=-1,or=c.subtreeFlags,or&8192||(or&16785408)===16785408){or={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ds},o_(c,L,or);var Hr=(L&62914560)===L?Qp-pr():(L&4194048)===L?h_-pr():0;if(Hr=Jm(or,Hr),Hr!==null){$l=L,i.cancelPendingCommit=Hr(x_.bind(null,i,c,L,g,T,I,ne,Ae,ct,Qt,or,null,Ot,Gt)),Eh(i,L,ne,!zt);return}}x_(i,c,L,g,T,I,ne,Ae,ct)}function qx(i){for(var c=i;;){var g=c.tag;if((g===0||g===11||g===15)&&c.flags&16384&&(g=c.updateQueue,g!==null&&(g=g.stores,g!==null)))for(var T=0;T<g.length;T++){var I=g[T],L=I.getSnapshot;I=I.value;try{if(!es(L(),I))return!1}catch{return!1}}if(g=c.child,c.subtreeFlags&16384&&g!==null)g.return=c,c=g;else{if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Eh(i,c,g,T){c&=~ym,c&=~gf,i.suspendedLanes|=c,i.pingedLanes&=~c,T&&(i.warmLanes|=c),T=i.expirationTimes;for(var I=c;0<I;){var L=31-Bt(I),ne=1<<L;T[L]=-1,I&=~ne}g!==0&&gn(i,g,c)}function Wd(){return(fa&6)===0?(ml(0),!1):!0}function t0(){if(Nn!==null){if(Sa===0)var i=Nn.return;else i=Nn,Ai=Ba=null,yc(i),Nl=null,ku=0,i=Nn;for(;i!==null;)Zp(i.alternate,i),i=i.return;Nn=null}}function Qf(i,c){var g=i.timeoutHandle;g!==-1&&(i.timeoutHandle=-1,Nm(g)),g=i.cancelPendingCommit,g!==null&&(i.cancelPendingCommit=null,g()),$l=0,t0(),Fa=i,Nn=g=Ke(i.current,null),jn=c,Sa=0,ho=null,Wl=!1,Sh=ya(i,c),xm=!1,_f=Es=ym=gf=Uu=fi=0,Lo=Hd=null,vm=!1,(c&8)!==0&&(c|=c&32);var T=i.entangledLanes;if(T!==0)for(i=i.entanglements,T&=c;0<T;){var I=31-Bt(T),L=1<<I;c|=i[I],T&=~L}return ju=c,fc(),g}function Tm(i,c){Tn=null,tt.H=Qn,c===sl||c===js?(c=_h(),Sa=3):c===Zc?(c=_h(),Sa=4):Sa=c===Op?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,ho=c,Nn===null&&(fi=1,dl(i,Or(c,i.current)))}function Sm(){var i=Rr.current;return i===null?!0:(jn&4194048)===jn?Br===null:(jn&62914560)===jn||(jn&536870912)!==0?i===Br:!1}function xf(){var i=tt.H;return tt.H=Qn,i===null?Qn:i}function r0(){var i=tt.A;return tt.A=Hx,i}function $d(){fi=4,Wl||(jn&4194048)!==jn&&Rr.current!==null||(Sh=!0),(Uu&134217727)===0&&(gf&134217727)===0||Fa===null||Eh(Fa,jn,Es,!1)}function n0(i,c,g){var T=fa;fa|=2;var I=xf(),L=r0();(Fa!==i||jn!==c)&&(Yf=null,Qf(i,c)),c=!1;var ne=fi;e:do try{if(Sa!==0&&Nn!==null){var Ae=Nn,ct=ho;switch(Sa){case 8:t0(),ne=6;break e;case 3:case 2:case 9:case 6:Rr.current===null&&(c=!0);var zt=Sa;if(Sa=0,ho=null,td(i,Ae,ct,zt),g&&Sh){ne=0;break e}break;default:zt=Sa,Sa=0,ho=null,td(i,Ae,ct,zt)}}a0(),ne=fi;break}catch(Qt){Tm(i,Qt)}while(!0);return c&&i.shellSuspendCounter++,Ai=Ba=null,fa=T,tt.H=I,tt.A=L,Nn===null&&(Fa=null,jn=0,fc()),ne}function a0(){for(;Nn!==null;)m_(Nn)}function ed(i,c){var g=fa;fa|=2;var T=xf(),I=r0();Fa!==i||jn!==c?(Yf=null,qd=pr()+500,Qf(i,c)):Sh=ya(i,c);e:do try{if(Sa!==0&&Nn!==null){c=Nn;var L=ho;t:switch(Sa){case 1:Sa=0,ho=null,td(i,c,L,1);break;case 2:case 9:if(Jh(L)){Sa=0,ho=null,g_(c);break}c=function(){Sa!==2&&Sa!==9||Fa!==i||(Sa=7),Sc(i)},L.then(c,c);break e;case 3:Sa=7;break e;case 4:Sa=5;break e;case 7:Jh(L)?(Sa=0,ho=null,g_(c)):(Sa=0,ho=null,td(i,c,L,7));break;case 5:var ne=null;switch(Nn.tag){case 26:ne=Nn.memoizedState;case 5:case 27:var Ae=Nn;if(ne?ap(ne):Ae.stateNode.complete){Sa=0,ho=null;var ct=Ae.sibling;if(ct!==null)Nn=ct;else{var zt=Ae.return;zt!==null?(Nn=zt,i0(zt)):Nn=null}break t}}Sa=0,ho=null,td(i,c,L,5);break;case 6:Sa=0,ho=null,td(i,c,L,6);break;case 8:t0(),fi=6;break e;default:throw Error(f(462))}}p_();break}catch(Qt){Tm(i,Qt)}while(!0);return Ai=Ba=null,tt.H=T,tt.A=I,fa=g,Nn!==null?0:(Fa=null,jn=0,fc(),fi)}function p_(){for(;Nn!==null&&!kt();)m_(Nn)}function m_(i){var c=Gs(i.alternate,i,ju);i.memoizedProps=i.pendingProps,c===null?i0(i):Nn=c}function g_(i){var c=i,g=c.alternate;switch(c.tag){case 15:case 0:c=Jg(g,c,c.pendingProps,c.type,void 0,jn);break;case 11:c=Jg(g,c,c.pendingProps,c.type.render,c.ref,jn);break;case 5:yc(c);default:Zp(g,c),c=Nn=ht(c,ju),c=Gs(g,c,ju)}i.memoizedProps=i.pendingProps,c===null?i0(i):Nn=c}function td(i,c,g,T){Ai=Ba=null,yc(c),Nl=null,ku=0;var I=c.return;try{if(zp(i,I,c,g,jn)){fi=1,dl(i,Or(g,i.current)),Nn=null;return}}catch(L){if(I!==null)throw Nn=I,L;fi=1,dl(i,Or(g,i.current)),Nn=null;return}c.flags&32768?(Yr||T===1?i=!0:Sh||(jn&536870912)!==0?i=!1:(Wl=i=!0,(T===2||T===9||T===3||T===6)&&(T=Rr.current,T!==null&&T.tag===13&&(T.flags|=16384))),__(c,i)):i0(c)}function i0(i){var c=i;do{if((c.flags&32768)!==0){__(c,Wl);return}i=c.return;var g=r_(c.alternate,c,ju);if(g!==null){Nn=g;return}if(c=c.sibling,c!==null){Nn=c;return}Nn=c=i}while(c!==null);fi===0&&(fi=5)}function __(i,c){do{var g=Vx(i.alternate,i);if(g!==null){g.flags&=32767,Nn=g;return}if(g=i.return,g!==null&&(g.flags|=32768,g.subtreeFlags=0,g.deletions=null),!c&&(i=i.sibling,i!==null)){Nn=i;return}Nn=i=g}while(i!==null);fi=6,Nn=null}function x_(i,c,g,T,I,L,ne,Ae,ct){i.cancelPendingCommit=null;do s0();while(Gi!==0);if((fa&6)!==0)throw Error(f(327));if(c!==null){if(c===i.current)throw Error(f(177));if(L=c.lanes|c.childLanes,L|=hc,va(i,g,L,ne,Ae,ct),i===Fa&&(Nn=Fa=null,jn=0),Kf=c,Gu=i,$l=g,bm=L,e0=I,f_=T,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,S_(ue,function(){return T_(),null})):(i.callbackNode=null,i.callbackPriority=0),T=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||T){T=tt.T,tt.T=null,I=We.p,We.p=2,ne=fa,fa|=4;try{Gx(i,c,g)}finally{fa=ne,We.p=I,tt.T=T}}Gi=1,y_(),v_(),b_()}}function y_(){if(Gi===1){Gi=0;var i=Gu,c=Kf,g=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||g){g=tt.T,tt.T=null;var T=We.p;We.p=2;var I=fa;fa|=4;try{Yp(c,i);var L=Om,ne=vu(i.containerInfo),Ae=L.focusedElem,ct=L.selectionRange;if(ne!==Ae&&Ae&&Ae.ownerDocument&&uh(Ae.ownerDocument.documentElement,Ae)){if(ct!==null&&Ll(Ae)){var zt=ct.start,Qt=ct.end;if(Qt===void 0&&(Qt=zt),"selectionStart"in Ae)Ae.selectionStart=zt,Ae.selectionEnd=Math.min(Qt,Ae.value.length);else{var or=Ae.ownerDocument||document,Ot=or&&or.defaultView||window;if(Ot.getSelection){var Gt=Ot.getSelection(),Hr=Ae.textContent.length,on=Math.min(ct.start,Hr),Ea=ct.end===void 0?on:Math.min(ct.end,Hr);!Gt.extend&&on>Ea&&(ne=Ea,Ea=on,on=ne);var wt=yu(Ae,on),pt=yu(Ae,Ea);if(wt&&pt&&(Gt.rangeCount!==1||Gt.anchorNode!==wt.node||Gt.anchorOffset!==wt.offset||Gt.focusNode!==pt.node||Gt.focusOffset!==pt.offset)){var Ft=or.createRange();Ft.setStart(wt.node,wt.offset),Gt.removeAllRanges(),on>Ea?(Gt.addRange(Ft),Gt.extend(pt.node,pt.offset)):(Ft.setEnd(pt.node,pt.offset),Gt.addRange(Ft))}}}}for(or=[],Gt=Ae;Gt=Gt.parentNode;)Gt.nodeType===1&&or.push({element:Gt,left:Gt.scrollLeft,top:Gt.scrollTop});for(typeof Ae.focus=="function"&&Ae.focus(),Ae=0;Ae<or.length;Ae++){var nr=or[Ae];nr.element.scrollLeft=nr.left,nr.element.scrollTop=nr.top}}cp=!!Qd,Om=Qd=null}finally{fa=I,We.p=T,tt.T=g}}i.current=c,Gi=2}}function v_(){if(Gi===2){Gi=0;var i=Gu,c=Kf,g=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||g){g=tt.T,tt.T=null;var T=We.p;We.p=2;var I=fa;fa|=4;try{mm(i,c.alternate,c)}finally{fa=I,We.p=T,tt.T=g}}Gi=3}}function b_(){if(Gi===4||Gi===3){Gi=0,lr();var i=Gu,c=Kf,g=$l,T=f_;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?Gi=5:(Gi=0,Kf=Gu=null,w_(i,i.pendingLanes));var I=i.pendingLanes;if(I===0&&(Vu=null),Xt(g),c=c.stateNode,at&&typeof at.onCommitFiberRoot=="function")try{at.onCommitFiberRoot(lt,c,void 0,(c.current.flags&128)===128)}catch{}if(T!==null){c=tt.T,I=We.p,We.p=2,tt.T=null;try{for(var L=i.onRecoverableError,ne=0;ne<T.length;ne++){var Ae=T[ne];L(Ae.value,{componentStack:Ae.stack})}}finally{tt.T=c,We.p=I}}($l&3)!==0&&s0(),Sc(i),I=i.pendingLanes,(g&261930)!==0&&(I&42)!==0?i===wm?Zd++:(Zd=0,wm=i):Zd=0,ml(0)}}function w_(i,c){(i.pooledCacheLanes&=c)===0&&(c=i.pooledCache,c!=null&&(i.pooledCache=null,pc(c)))}function s0(){return y_(),v_(),b_(),T_()}function T_(){if(Gi!==5)return!1;var i=Gu,c=bm;bm=0;var g=Xt($l),T=tt.T,I=We.p;try{We.p=32>g?32:g,tt.T=null,g=e0,e0=null;var L=Gu,ne=$l;if(Gi=0,Kf=Gu=null,$l=0,(fa&6)!==0)throw Error(f(331));var Ae=fa;if(fa|=4,c_(L.current),_m(L,L.current,ne,g),fa=Ae,ml(0,!1),at&&typeof at.onPostCommitFiberRoot=="function")try{at.onPostCommitFiberRoot(lt,L)}catch{}return!0}finally{We.p=I,tt.T=T,w_(i,c)}}function Em(i,c,g){c=Or(g,c),c=uf(i.stateNode,c,2),i=mc(i,c,2),i!==null&&(Vn(i,2),Sc(i))}function da(i,c,g){if(i.tag===3)Em(i,i,g);else for(;c!==null;){if(c.tag===3){Em(c,i,g);break}else if(c.tag===1){var T=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof T.componentDidCatch=="function"&&(Vu===null||!Vu.has(T))){i=Or(g,i),g=hf(2),T=mc(c,g,2),T!==null&&(ff(g,T,c,i),Vn(T,2),Sc(T));break}}c=c.return}}function o0(i,c,g){var T=i.pingCache;if(T===null){T=i.pingCache=new u_;var I=new Set;T.set(c,I)}else I=T.get(c),I===void 0&&(I=new Set,T.set(c,I));I.has(g)||(xm=!0,I.add(g),i=Ah.bind(null,i,c,g),c.then(i,i))}function Ah(i,c,g){var T=i.pingCache;T!==null&&T.delete(c),i.pingedLanes|=i.suspendedLanes&g,i.warmLanes&=~g,Fa===i&&(jn&g)===g&&(fi===4||fi===3&&(jn&62914560)===jn&&300>pr()-Qp?(fa&2)===0&&Qf(i,0):ym|=g,_f===jn&&(_f=0)),Sc(i)}function Xd(i,c){c===0&&(c=Fn()),i=Os(i,c),i!==null&&(Vn(i,c),Sc(i))}function Am(i){var c=i.memoizedState,g=0;c!==null&&(g=c.retryLane),Xd(i,g)}function Zx(i,c){var g=0;switch(i.tag){case 31:case 13:var T=i.stateNode,I=i.memoizedState;I!==null&&(g=I.retryLane);break;case 19:T=i.stateNode;break;case 22:T=i.stateNode._retryCache;break;default:throw Error(f(314))}T!==null&&T.delete(c),Xd(i,g)}function S_(i,c){return Kt(i,c)}var l0=null,rd=null,km=!1,c0=!1,Cm=!1,Hu=0;function Sc(i){i!==rd&&i.next===null&&(rd===null?l0=rd=i:rd=rd.next=i),c0=!0,km||(km=!0,Dm())}function ml(i,c){if(!Cm&&c0){Cm=!0;do for(var g=!1,T=l0;T!==null;){if(i!==0){var I=T.pendingLanes;if(I===0)var L=0;else{var ne=T.suspendedLanes,Ae=T.pingedLanes;L=(1<<31-Bt(42|i)+1)-1,L&=I&~(ne&~Ae),L=L&201326741?L&201326741|1:L?L|2:0}L!==0&&(g=!0,Yd(T,L))}else L=jn,L=Ln(T,T===Fa?L:0,T.cancelPendingCommit!==null||T.timeoutHandle!==-1),(L&3)===0||ya(T,L)||(g=!0,Yd(T,L));T=T.next}while(g);Cm=!1}}function kh(){Mm()}function Mm(){c0=km=!1;var i=0;Hu!==0&&y0()&&(i=Hu);for(var c=pr(),g=null,T=l0;T!==null;){var I=T.next,L=u0(T,c);L===0?(T.next=null,g===null?l0=I:g.next=I,I===null&&(rd=g)):(g=T,(i!==0||(L&3)!==0)&&(c0=!0)),T=I}Gi!==0&&Gi!==5||ml(i),Hu!==0&&(Hu=0)}function u0(i,c){for(var g=i.suspendedLanes,T=i.pingedLanes,I=i.expirationTimes,L=i.pendingLanes&-62914561;0<L;){var ne=31-Bt(L),Ae=1<<ne,ct=I[ne];ct===-1?((Ae&g)===0||(Ae&T)!==0)&&(I[ne]=Mr(Ae,c)):ct<=c&&(i.expiredLanes|=Ae),L&=~Ae}if(c=Fa,g=jn,g=Ln(i,i===c?g:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),T=i.callbackNode,g===0||i===c&&(Sa===2||Sa===9)||i.cancelPendingCommit!==null)return T!==null&&T!==null&&Jt(T),i.callbackNode=null,i.callbackPriority=0;if((g&3)===0||ya(i,g)){if(c=g&-g,c===i.callbackPriority)return c;switch(T!==null&&Jt(T),Xt(g)){case 2:case 8:g=fe;break;case 32:g=ue;break;case 268435456:g=je;break;default:g=ue}return T=E_.bind(null,i),g=Kt(g,T),i.callbackPriority=c,i.callbackNode=g,c}return T!==null&&T!==null&&Jt(T),i.callbackPriority=2,i.callbackNode=null,2}function E_(i,c){if(Gi!==0&&Gi!==5)return i.callbackNode=null,i.callbackPriority=0,null;var g=i.callbackNode;if(s0()&&i.callbackNode!==g)return null;var T=jn;return T=Ln(i,i===Fa?T:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),T===0?null:(Mi(i,T,c),u0(i,pr()),i.callbackNode!=null&&i.callbackNode===g?E_.bind(null,i):null)}function Yd(i,c){if(s0())return null;Mi(i,c,!0)}function Dm(){Um(function(){(fa&6)!==0?Kt(st,kh):Mm()})}function Rm(){if(Hu===0){var i=Bl;i===0&&(i=Gr,Gr<<=1,(Gr&261888)===0&&(Gr=256)),Hu=i}return Hu}function h0(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:fn(""+i)}function f0(i,c){var g=c.ownerDocument.createElement("input");return g.name=c.name,g.value=c.value,i.id&&g.setAttribute("form",i.id),c.parentNode.insertBefore(g,c),i=new FormData(i),g.parentNode.removeChild(g),i}function nd(i,c,g,T,I){if(c==="submit"&&g&&g.stateNode===I){var L=h0((I[Te]||null).action),ne=T.submitter;ne&&(c=(c=ne[Te]||null)?h0(c.formAction):ne.getAttribute("formAction"),c!==null&&(L=c,ne=null));var Ae=new El("action","action",null,T,I);i.push({event:Ae,listeners:[{instance:null,listener:function(){if(T.defaultPrevented){if(Hu!==0){var ct=ne?f0(I,ne):new FormData(I);Ka(g,{pending:!0,data:ct,method:I.method,action:L},null,ct)}}else typeof L=="function"&&(Ae.preventDefault(),ct=ne?f0(I,ne):new FormData(I),Ka(g,{pending:!0,data:ct,method:I.method,action:L},L,ct))},currentTarget:I}]})}}for(var d0=0;d0<rl.length;d0++){var p0=rl[d0],Im=p0.toLowerCase(),A_=p0[0].toUpperCase()+p0.slice(1);cs(Im,"on"+A_)}cs(Tu,"onAnimationEnd"),cs(Su,"onAnimationIteration"),cs(hh,"onAnimationStart"),cs("dblclick","onDoubleClick"),cs("focusin","onFocus"),cs("focusout","onBlur"),cs(cc,"onTransitionRun"),cs(Ao,"onTransitionStart"),cs(uc,"onTransitionCancel"),cs(Pi,"onTransitionEnd"),oi("onMouseEnter",["mouseout","mouseover"]),oi("onMouseLeave",["mouseout","mouseover"]),oi("onPointerEnter",["pointerout","pointerover"]),oi("onPointerLeave",["pointerout","pointerover"]),tn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),tn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),tn("onBeforeInput",["compositionend","keypress","textInput","paste"]),tn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),tn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),tn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ch="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),k_=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ch));function C_(i,c){c=(c&4)!==0;for(var g=0;g<i.length;g++){var T=i[g],I=T.event;T=T.listeners;e:{var L=void 0;if(c)for(var ne=T.length-1;0<=ne;ne--){var Ae=T[ne],ct=Ae.instance,zt=Ae.currentTarget;if(Ae=Ae.listener,ct!==L&&I.isPropagationStopped())break e;L=Ae,I.currentTarget=zt;try{L(I)}catch(Qt){zs(Qt)}I.currentTarget=null,L=ct}else for(ne=0;ne<T.length;ne++){if(Ae=T[ne],ct=Ae.instance,zt=Ae.currentTarget,Ae=Ae.listener,ct!==L&&I.isPropagationStopped())break e;L=Ae,I.currentTarget=zt;try{L(I)}catch(Qt){zs(Qt)}I.currentTarget=null,L=ct}}}}function Un(i,c){var g=c[mt];g===void 0&&(g=c[mt]=new Set);var T=i+"__bubble";g.has(T)||(g0(c,i,2,!1),g.add(T))}function Pm(i,c,g){var T=0;c&&(T|=4),g0(g,i,T,c)}var m0="_reactListening"+Math.random().toString(36).slice(2);function Fm(i){if(!i[m0]){i[m0]=!0,Wn.forEach(function(g){g!=="selectionchange"&&(k_.has(g)||Pm(g,!1,i),Pm(g,!0,i))});var c=i.nodeType===9?i:i.ownerDocument;c===null||c[m0]||(c[m0]=!0,Pm("selectionchange",!1,c))}}function g0(i,c,g,T){switch(bf(c)){case 2:var I=up;break;case 8:I=V_;break;default:I=eg}g=I.bind(null,c,g,i),I=void 0,!Oa||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(I=!0),T?I!==void 0?i.addEventListener(c,g,{capture:!0,passive:I}):i.addEventListener(c,g,!0):I!==void 0?i.addEventListener(c,g,{passive:I}):i.addEventListener(c,g,!1)}function tu(i,c,g,T,I){var L=T;if((c&1)===0&&(c&2)===0&&T!==null)e:for(;;){if(T===null)return;var ne=T.tag;if(ne===3||ne===4){var Ae=T.stateNode.containerInfo;if(Ae===I)break;if(ne===4)for(ne=T.return;ne!==null;){var ct=ne.tag;if((ct===3||ct===4)&&ne.stateNode.containerInfo===I)return;ne=ne.return}for(;Ae!==null;){if(ne=vr(Ae),ne===null)return;if(ct=ne.tag,ct===5||ct===6||ct===26||ct===27){T=L=ne;continue e}Ae=Ae.parentNode}}T=T.return}Yn(function(){var zt=L,Qt=pu(g),or=[];e:{var Ot=fh.get(i);if(Ot!==void 0){var Gt=El,Hr=i;switch(i){case"keypress":if(ri(g)===0)break e;case"keydown":case"keyup":Gt=Ta;break;case"focusin":Hr="focus",Gt=Rs;break;case"focusout":Hr="blur",Gt=Rs;break;case"beforeblur":case"afterblur":Gt=Rs;break;case"click":if(g.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Gt=bo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Gt=Fc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Gt=Kn;break;case Tu:case Su:case hh:Gt=oh;break;case Pi:Gt=kl;break;case"scroll":case"scrollend":Gt=ls;break;case"wheel":Gt=Ml;break;case"copy":case"cut":case"paste":Gt=tc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Gt=Gn;break;case"toggle":case"beforetoggle":Gt=Jo}var on=(c&4)!==0,Ea=!on&&(i==="scroll"||i==="scrollend"),wt=on?Ot!==null?Ot+"Capture":null:Ot;on=[];for(var pt=zt,Ft;pt!==null;){var nr=pt;if(Ft=nr.stateNode,nr=nr.tag,nr!==5&&nr!==26&&nr!==27||Ft===null||wt===null||(nr=ys(pt,wt),nr!=null&&on.push(ad(pt,nr,Ft))),Ea)break;pt=pt.return}0<on.length&&(Ot=new Gt(Ot,Hr,null,g,Qt),or.push({event:Ot,listeners:on}))}}if((c&7)===0){e:{if(Ot=i==="mouseover"||i==="pointerover",Gt=i==="mouseout"||i==="pointerout",Ot&&g!==ec&&(Hr=g.relatedTarget||g.fromElement)&&(vr(Hr)||Hr[ze]))break e;if((Gt||Ot)&&(Ot=Qt.window===Qt?Qt:(Ot=Qt.ownerDocument)?Ot.defaultView||Ot.parentWindow:window,Gt?(Hr=g.relatedTarget||g.toElement,Gt=zt,Hr=Hr?vr(Hr):null,Hr!==null&&(Ea=b(Hr),on=Hr.tag,Hr!==Ea||on!==5&&on!==27&&on!==6)&&(Hr=null)):(Gt=null,Hr=zt),Gt!==Hr)){if(on=bo,nr="onMouseLeave",wt="onMouseEnter",pt="mouse",(i==="pointerout"||i==="pointerover")&&(on=Gn,nr="onPointerLeave",wt="onPointerEnter",pt="pointer"),Ea=Gt==null?Ot:dr(Gt),Ft=Hr==null?Ot:dr(Hr),Ot=new on(nr,pt+"leave",Gt,g,Qt),Ot.target=Ea,Ot.relatedTarget=Ft,nr=null,vr(Qt)===zt&&(on=new on(wt,pt+"enter",Hr,g,Qt),on.target=Ft,on.relatedTarget=Ea,nr=on),Ea=nr,Gt&&Hr)t:{for(on=M_,wt=Gt,pt=Hr,Ft=0,nr=wt;nr;nr=on(nr))Ft++;nr=0;for(var nn=pt;nn;nn=on(nn))nr++;for(;0<Ft-nr;)wt=on(wt),Ft--;for(;0<nr-Ft;)pt=on(pt),nr--;for(;Ft--;){if(wt===pt||pt!==null&&wt===pt.alternate){on=wt;break t}wt=on(wt),pt=on(pt)}on=null}else on=null;Gt!==null&&Lm(or,Ot,Gt,on,!1),Hr!==null&&Ea!==null&&Lm(or,Ea,Hr,on,!0)}}e:{if(Ot=zt?dr(zt):window,Gt=Ot.nodeName&&Ot.nodeName.toLowerCase(),Gt==="select"||Gt==="input"&&Ot.type==="file")var aa=el;else if(Aa(Ot))if(Il)aa=ro;else{aa=ch;var qr=Pl}else Gt=Ot.nodeName,!Gt||Gt.toLowerCase()!=="input"||Ot.type!=="checkbox"&&Ot.type!=="radio"?zt&&yo(zt.elementType)&&(aa=el):aa=Fs;if(aa&&(aa=aa(i,zt))){bs(or,aa,g,Qt);break e}qr&&qr(i,Ot,zt),i==="focusout"&&zt&&Ot.type==="number"&&zt.memoizedProps.value!=null&&du(Ot,"number",Ot.value)}switch(qr=zt?dr(zt):window,i){case"focusin":(Aa(qr)||qr.contentEditable==="true")&&(ws=qr,sc=zt,oc=null);break;case"focusout":oc=sc=ws=null;break;case"mousedown":bu=!0;break;case"contextmenu":case"mouseup":case"dragend":bu=!1,wu(or,g,Qt);break;case"selectionchange":if(jc)break;case"keydown":case"keyup":wu(or,g,Qt)}var rn;if(Ra)e:{switch(i){case"compositionstart":var Bn="onCompositionStart";break e;case"compositionend":Bn="onCompositionEnd";break e;case"compositionupdate":Bn="onCompositionUpdate";break e}Bn=void 0}else Is?Dl(i,g)&&(Bn="onCompositionEnd"):i==="keydown"&&g.keyCode===229&&(Bn="onCompositionStart");Bn&&(So&&g.locale!=="ko"&&(Is||Bn!=="onCompositionStart"?Bn==="onCompositionEnd"&&Is&&(rn=Si()):(_a=Qt,vo="value"in _a?_a.value:_a.textContent,Is=!0)),qr=Kd(zt,Bn),0<qr.length&&(Bn=new mu(Bn,i,null,g,Qt),or.push({event:Bn,listeners:qr}),rn?Bn.data=rn:(rn=Xh(g),rn!==null&&(Bn.data=rn)))),(rn=ac?xu(i,g):Za(i,g))&&(Bn=Kd(zt,"onBeforeInput"),0<Bn.length&&(qr=new mu("onBeforeInput","beforeinput",null,g,Qt),or.push({event:qr,listeners:Bn}),qr.data=rn)),nd(or,i,zt,g,Qt)}C_(or,c)})}function ad(i,c,g){return{instance:i,listener:c,currentTarget:g}}function Kd(i,c){for(var g=c+"Capture",T=[];i!==null;){var I=i,L=I.stateNode;if(I=I.tag,I!==5&&I!==26&&I!==27||L===null||(I=ys(i,g),I!=null&&T.unshift(ad(i,I,L)),I=ys(i,c),I!=null&&T.push(ad(i,I,L))),i.tag===3)return T;i=i.return}return[]}function M_(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function Lm(i,c,g,T,I){for(var L=c._reactName,ne=[];g!==null&&g!==T;){var Ae=g,ct=Ae.alternate,zt=Ae.stateNode;if(Ae=Ae.tag,ct!==null&&ct===T)break;Ae!==5&&Ae!==26&&Ae!==27||zt===null||(ct=zt,I?(zt=ys(g,L),zt!=null&&ne.unshift(ad(g,zt,ct))):I||(zt=ys(g,L),zt!=null&&ne.push(ad(g,zt,ct)))),g=g.return}ne.length!==0&&i.push({event:c,listeners:ne})}var D_=/\r\n?/g,R_=/\u0000|\uFFFD/g;function Jd(i){return(typeof i=="string"?i:""+i).replace(D_,`
`).replace(R_,"")}function zm(i,c){return c=Jd(c),Jd(i)===c}function na(i,c,g,T,I,L){switch(g){case"children":typeof T=="string"?c==="body"||c==="textarea"&&T===""||Ks(i,T):(typeof T=="number"||typeof T=="bigint")&&c!=="body"&&Ks(i,""+T);break;case"className":ss(i,"class",T);break;case"tabIndex":ss(i,"tabindex",T);break;case"dir":case"role":case"viewBox":case"width":case"height":ss(i,g,T);break;case"style":Pc(i,T,L);break;case"data":if(c!=="object"){ss(i,"data",T);break}case"src":case"href":if(T===""&&(c!=="a"||g!=="href")){i.removeAttribute(g);break}if(T==null||typeof T=="function"||typeof T=="symbol"||typeof T=="boolean"){i.removeAttribute(g);break}T=fn(""+T),i.setAttribute(g,T);break;case"action":case"formAction":if(typeof T=="function"){i.setAttribute(g,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof L=="function"&&(g==="formAction"?(c!=="input"&&na(i,c,"name",I.name,I,null),na(i,c,"formEncType",I.formEncType,I,null),na(i,c,"formMethod",I.formMethod,I,null),na(i,c,"formTarget",I.formTarget,I,null)):(na(i,c,"encType",I.encType,I,null),na(i,c,"method",I.method,I,null),na(i,c,"target",I.target,I,null)));if(T==null||typeof T=="symbol"||typeof T=="boolean"){i.removeAttribute(g);break}T=fn(""+T),i.setAttribute(g,T);break;case"onClick":T!=null&&(i.onclick=Ds);break;case"onScroll":T!=null&&Un("scroll",i);break;case"onScrollEnd":T!=null&&Un("scrollend",i);break;case"dangerouslySetInnerHTML":if(T!=null){if(typeof T!="object"||!("__html"in T))throw Error(f(61));if(g=T.__html,g!=null){if(I.children!=null)throw Error(f(60));i.innerHTML=g}}break;case"multiple":i.multiple=T&&typeof T!="function"&&typeof T!="symbol";break;case"muted":i.muted=T&&typeof T!="function"&&typeof T!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(T==null||typeof T=="function"||typeof T=="boolean"||typeof T=="symbol"){i.removeAttribute("xlink:href");break}g=fn(""+T),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",g);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":T!=null&&typeof T!="function"&&typeof T!="symbol"?i.setAttribute(g,""+T):i.removeAttribute(g);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":T&&typeof T!="function"&&typeof T!="symbol"?i.setAttribute(g,""):i.removeAttribute(g);break;case"capture":case"download":T===!0?i.setAttribute(g,""):T!==!1&&T!=null&&typeof T!="function"&&typeof T!="symbol"?i.setAttribute(g,T):i.removeAttribute(g);break;case"cols":case"rows":case"size":case"span":T!=null&&typeof T!="function"&&typeof T!="symbol"&&!isNaN(T)&&1<=T?i.setAttribute(g,T):i.removeAttribute(g);break;case"rowSpan":case"start":T==null||typeof T=="function"||typeof T=="symbol"||isNaN(T)?i.removeAttribute(g):i.setAttribute(g,T);break;case"popover":Un("beforetoggle",i),Un("toggle",i),Ti(i,"popover",T);break;case"xlinkActuate":os(i,"http://www.w3.org/1999/xlink","xlink:actuate",T);break;case"xlinkArcrole":os(i,"http://www.w3.org/1999/xlink","xlink:arcrole",T);break;case"xlinkRole":os(i,"http://www.w3.org/1999/xlink","xlink:role",T);break;case"xlinkShow":os(i,"http://www.w3.org/1999/xlink","xlink:show",T);break;case"xlinkTitle":os(i,"http://www.w3.org/1999/xlink","xlink:title",T);break;case"xlinkType":os(i,"http://www.w3.org/1999/xlink","xlink:type",T);break;case"xmlBase":os(i,"http://www.w3.org/XML/1998/namespace","xml:base",T);break;case"xmlLang":os(i,"http://www.w3.org/XML/1998/namespace","xml:lang",T);break;case"xmlSpace":os(i,"http://www.w3.org/XML/1998/namespace","xml:space",T);break;case"is":Ti(i,"is",T);break;case"innerText":case"textContent":break;default:(!(2<g.length)||g[0]!=="o"&&g[0]!=="O"||g[1]!=="n"&&g[1]!=="N")&&(g=Js.get(g)||g,Ti(i,g,T))}}function _0(i,c,g,T,I,L){switch(g){case"style":Pc(i,T,L);break;case"dangerouslySetInnerHTML":if(T!=null){if(typeof T!="object"||!("__html"in T))throw Error(f(61));if(g=T.__html,g!=null){if(I.children!=null)throw Error(f(60));i.innerHTML=g}}break;case"children":typeof T=="string"?Ks(i,T):(typeof T=="number"||typeof T=="bigint")&&Ks(i,""+T);break;case"onScroll":T!=null&&Un("scroll",i);break;case"onScrollEnd":T!=null&&Un("scrollend",i);break;case"onClick":T!=null&&(i.onclick=Ds);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!mn.hasOwnProperty(g))e:{if(g[0]==="o"&&g[1]==="n"&&(I=g.endsWith("Capture"),c=g.slice(2,I?g.length-7:void 0),L=i[Te]||null,L=L!=null?L[g]:null,typeof L=="function"&&i.removeEventListener(c,L,I),typeof T=="function")){typeof L!="function"&&L!==null&&(g in i?i[g]=null:i.hasAttribute(g)&&i.removeAttribute(g)),i.addEventListener(c,T,I);break e}g in i?i[g]=T:T===!0?i.setAttribute(g,""):Ti(i,g,T)}}}function as(i,c,g){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Un("error",i),Un("load",i);var T=!1,I=!1,L;for(L in g)if(g.hasOwnProperty(L)){var ne=g[L];if(ne!=null)switch(L){case"src":T=!0;break;case"srcSet":I=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(f(137,c));default:na(i,c,L,ne,g,null)}}I&&na(i,c,"srcSet",g.srcSet,g,null),T&&na(i,c,"src",g.src,g,null);return;case"input":Un("invalid",i);var Ae=L=ne=I=null,ct=null,zt=null;for(T in g)if(g.hasOwnProperty(T)){var Qt=g[T];if(Qt!=null)switch(T){case"name":I=Qt;break;case"type":ne=Qt;break;case"checked":ct=Qt;break;case"defaultChecked":zt=Qt;break;case"value":L=Qt;break;case"defaultValue":Ae=Qt;break;case"children":case"dangerouslySetInnerHTML":if(Qt!=null)throw Error(f(137,c));break;default:na(i,c,T,Qt,g,null)}}Sl(i,L,Ae,ct,zt,ne,I,!1);return;case"select":Un("invalid",i),T=ne=L=null;for(I in g)if(g.hasOwnProperty(I)&&(Ae=g[I],Ae!=null))switch(I){case"value":L=Ae;break;case"defaultValue":ne=Ae;break;case"multiple":T=Ae;default:na(i,c,I,Ae,g,null)}c=L,g=ne,i.multiple=!!T,c!=null?Ms(i,!!T,c,!1):g!=null&&Ms(i,!!T,g,!0);return;case"textarea":Un("invalid",i),L=I=T=null;for(ne in g)if(g.hasOwnProperty(ne)&&(Ae=g[ne],Ae!=null))switch(ne){case"value":T=Ae;break;case"defaultValue":I=Ae;break;case"children":L=Ae;break;case"dangerouslySetInnerHTML":if(Ae!=null)throw Error(f(91));break;default:na(i,c,ne,Ae,g,null)}Jl(i,T,I,L);return;case"option":for(ct in g)g.hasOwnProperty(ct)&&(T=g[ct],T!=null)&&(ct==="selected"?i.selected=T&&typeof T!="function"&&typeof T!="symbol":na(i,c,ct,T,g,null));return;case"dialog":Un("beforetoggle",i),Un("toggle",i),Un("cancel",i),Un("close",i);break;case"iframe":case"object":Un("load",i);break;case"video":case"audio":for(T=0;T<Ch.length;T++)Un(Ch[T],i);break;case"image":Un("error",i),Un("load",i);break;case"details":Un("toggle",i);break;case"embed":case"source":case"link":Un("error",i),Un("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(zt in g)if(g.hasOwnProperty(zt)&&(T=g[zt],T!=null))switch(zt){case"children":case"dangerouslySetInnerHTML":throw Error(f(137,c));default:na(i,c,zt,T,g,null)}return;default:if(yo(c)){for(Qt in g)g.hasOwnProperty(Qt)&&(T=g[Qt],T!==void 0&&_0(i,c,Qt,T,g,void 0));return}}for(Ae in g)g.hasOwnProperty(Ae)&&(T=g[Ae],T!=null&&na(i,c,Ae,T,g,null))}function I_(i,c,g,T){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var I=null,L=null,ne=null,Ae=null,ct=null,zt=null,Qt=null;for(Gt in g){var or=g[Gt];if(g.hasOwnProperty(Gt)&&or!=null)switch(Gt){case"checked":break;case"value":break;case"defaultValue":ct=or;default:T.hasOwnProperty(Gt)||na(i,c,Gt,null,T,or)}}for(var Ot in T){var Gt=T[Ot];if(or=g[Ot],T.hasOwnProperty(Ot)&&(Gt!=null||or!=null))switch(Ot){case"type":L=Gt;break;case"name":I=Gt;break;case"checked":zt=Gt;break;case"defaultChecked":Qt=Gt;break;case"value":ne=Gt;break;case"defaultValue":Ae=Gt;break;case"children":case"dangerouslySetInnerHTML":if(Gt!=null)throw Error(f(137,c));break;default:Gt!==or&&na(i,c,Ot,Gt,T,or)}}fu(i,ne,Ae,ct,zt,Qt,L,I);return;case"select":Gt=ne=Ae=Ot=null;for(L in g)if(ct=g[L],g.hasOwnProperty(L)&&ct!=null)switch(L){case"value":break;case"multiple":Gt=ct;default:T.hasOwnProperty(L)||na(i,c,L,null,T,ct)}for(I in T)if(L=T[I],ct=g[I],T.hasOwnProperty(I)&&(L!=null||ct!=null))switch(I){case"value":Ot=L;break;case"defaultValue":Ae=L;break;case"multiple":ne=L;default:L!==ct&&na(i,c,I,L,T,ct)}c=Ae,g=ne,T=Gt,Ot!=null?Ms(i,!!g,Ot,!1):!!T!=!!g&&(c!=null?Ms(i,!!g,c,!0):Ms(i,!!g,g?[]:"",!1));return;case"textarea":Gt=Ot=null;for(Ae in g)if(I=g[Ae],g.hasOwnProperty(Ae)&&I!=null&&!T.hasOwnProperty(Ae))switch(Ae){case"value":break;case"children":break;default:na(i,c,Ae,null,T,I)}for(ne in T)if(I=T[ne],L=g[ne],T.hasOwnProperty(ne)&&(I!=null||L!=null))switch(ne){case"value":Ot=I;break;case"defaultValue":Gt=I;break;case"children":break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(f(91));break;default:I!==L&&na(i,c,ne,I,T,L)}Wh(i,Ot,Gt);return;case"option":for(var Hr in g)Ot=g[Hr],g.hasOwnProperty(Hr)&&Ot!=null&&!T.hasOwnProperty(Hr)&&(Hr==="selected"?i.selected=!1:na(i,c,Hr,null,T,Ot));for(ct in T)Ot=T[ct],Gt=g[ct],T.hasOwnProperty(ct)&&Ot!==Gt&&(Ot!=null||Gt!=null)&&(ct==="selected"?i.selected=Ot&&typeof Ot!="function"&&typeof Ot!="symbol":na(i,c,ct,Ot,T,Gt));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var on in g)Ot=g[on],g.hasOwnProperty(on)&&Ot!=null&&!T.hasOwnProperty(on)&&na(i,c,on,null,T,Ot);for(zt in T)if(Ot=T[zt],Gt=g[zt],T.hasOwnProperty(zt)&&Ot!==Gt&&(Ot!=null||Gt!=null))switch(zt){case"children":case"dangerouslySetInnerHTML":if(Ot!=null)throw Error(f(137,c));break;default:na(i,c,zt,Ot,T,Gt)}return;default:if(yo(c)){for(var Ea in g)Ot=g[Ea],g.hasOwnProperty(Ea)&&Ot!==void 0&&!T.hasOwnProperty(Ea)&&_0(i,c,Ea,void 0,T,Ot);for(Qt in T)Ot=T[Qt],Gt=g[Qt],!T.hasOwnProperty(Qt)||Ot===Gt||Ot===void 0&&Gt===void 0||_0(i,c,Qt,Ot,T,Gt);return}}for(var wt in g)Ot=g[wt],g.hasOwnProperty(wt)&&Ot!=null&&!T.hasOwnProperty(wt)&&na(i,c,wt,null,T,Ot);for(or in T)Ot=T[or],Gt=g[or],!T.hasOwnProperty(or)||Ot===Gt||Ot==null&&Gt==null||na(i,c,or,Ot,T,Gt)}function Bo(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function id(){if(typeof performance.getEntriesByType=="function"){for(var i=0,c=0,g=performance.getEntriesByType("resource"),T=0;T<g.length;T++){var I=g[T],L=I.transferSize,ne=I.initiatorType,Ae=I.duration;if(L&&Ae&&Bo(ne)){for(ne=0,Ae=I.responseEnd,T+=1;T<g.length;T++){var ct=g[T],zt=ct.startTime;if(zt>Ae)break;var Qt=ct.transferSize,or=ct.initiatorType;Qt&&Bo(or)&&(ct=ct.responseEnd,ne+=Qt*(ct<Ae?1:(Ae-zt)/(ct-zt)))}if(--T,c+=8*(L+ne)/(I.duration/1e3),i++,10<i)break}}if(0<i)return c/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var Qd=null,Om=null;function ep(i){return i.nodeType===9?i:i.ownerDocument}function Mh(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Bm(i,c){if(i===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&c==="foreignObject"?0:i}function x0(i,c){return i==="textarea"||i==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var Dh=null;function y0(){var i=window.event;return i&&i.type==="popstate"?i===Dh?!1:(Dh=i,!0):(Dh=null,!1)}var v0=typeof setTimeout=="function"?setTimeout:void 0,Nm=typeof clearTimeout=="function"?clearTimeout:void 0,jm=typeof Promise=="function"?Promise:void 0,Um=typeof queueMicrotask=="function"?queueMicrotask:typeof jm<"u"?function(i){return jm.resolve(null).then(i).catch(Vm)}:v0;function Vm(i){setTimeout(function(){throw i})}function Rh(i){return i==="head"}function P_(i,c){var g=c,T=0;do{var I=g.nextSibling;if(i.removeChild(g),I&&I.nodeType===8)if(g=I.data,g==="/$"||g==="/&"){if(T===0){i.removeChild(I),Oh(c);return}T--}else if(g==="$"||g==="$?"||g==="$~"||g==="$!"||g==="&")T++;else if(g==="html")sd(i.ownerDocument.documentElement);else if(g==="head"){g=i.ownerDocument.head,sd(g);for(var L=g.firstChild;L;){var ne=L.nextSibling,Ae=L.nodeName;L[gt]||Ae==="SCRIPT"||Ae==="STYLE"||Ae==="LINK"&&L.rel.toLowerCase()==="stylesheet"||g.removeChild(L),L=ne}}else g==="body"&&sd(i.ownerDocument.body);g=I}while(g);Oh(c)}function Sn(i,c){var g=i;i=0;do{var T=g.nextSibling;if(g.nodeType===1?c?(g._stashedDisplay=g.style.display,g.style.display="none"):(g.style.display=g._stashedDisplay||"",g.getAttribute("style")===""&&g.removeAttribute("style")):g.nodeType===3&&(c?(g._stashedText=g.nodeValue,g.nodeValue=""):g.nodeValue=g._stashedText||""),T&&T.nodeType===8)if(g=T.data,g==="/$"){if(i===0)break;i--}else g!=="$"&&g!=="$?"&&g!=="$~"&&g!=="$!"||i++;g=T}while(g)}function Ec(i){var c=i.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var g=c;switch(c=c.nextSibling,g.nodeName){case"HTML":case"HEAD":case"BODY":Ec(g),ir(g);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(g.rel.toLowerCase()==="stylesheet")continue}i.removeChild(g)}}function hs(i,c,g,T){for(;i.nodeType===1;){var I=g;if(i.nodeName.toLowerCase()!==c.toLowerCase()){if(!T&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(T){if(!i[gt])switch(c){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(L=i.getAttribute("rel"),L==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(L!==I.rel||i.getAttribute("href")!==(I.href==null||I.href===""?null:I.href)||i.getAttribute("crossorigin")!==(I.crossOrigin==null?null:I.crossOrigin)||i.getAttribute("title")!==(I.title==null?null:I.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(L=i.getAttribute("src"),(L!==(I.src==null?null:I.src)||i.getAttribute("type")!==(I.type==null?null:I.type)||i.getAttribute("crossorigin")!==(I.crossOrigin==null?null:I.crossOrigin))&&L&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(c==="input"&&i.type==="hidden"){var L=I.name==null?null:""+I.name;if(I.type==="hidden"&&i.getAttribute("name")===L)return i}else return i;if(i=gl(i.nextSibling),i===null)break}return null}function Ac(i,c,g){if(c==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!g||(i=gl(i.nextSibling),i===null))return null;return i}function Ih(i,c){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!c||(i=gl(i.nextSibling),i===null))return null;return i}function Hs(i){return i.data==="$?"||i.data==="$~"}function yi(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function Hi(i,c){var g=i.ownerDocument;if(i.data==="$~")i._reactRetry=c;else if(i.data!=="$?"||g.readyState!=="loading")c();else{var T=function(){c(),g.removeEventListener("DOMContentLoaded",T)};g.addEventListener("DOMContentLoaded",T),i._reactRetry=T}}function gl(i){for(;i!=null;i=i.nextSibling){var c=i.nodeType;if(c===1||c===3)break;if(c===8){if(c=i.data,c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"||c==="F!"||c==="F")break;if(c==="/$"||c==="/&")return null}}return i}var fo=null;function qi(i){i=i.nextSibling;for(var c=0;i;){if(i.nodeType===8){var g=i.data;if(g==="/$"||g==="/&"){if(c===0)return gl(i.nextSibling);c--}else g!=="$"&&g!=="$!"&&g!=="$?"&&g!=="$~"&&g!=="&"||c++}i=i.nextSibling}return null}function tp(i){i=i.previousSibling;for(var c=0;i;){if(i.nodeType===8){var g=i.data;if(g==="$"||g==="$!"||g==="$?"||g==="$~"||g==="&"){if(c===0)return i;c--}else g!=="/$"&&g!=="/&"||c++}i=i.previousSibling}return null}function F_(i,c,g){switch(c=ep(g),i){case"html":if(i=c.documentElement,!i)throw Error(f(452));return i;case"head":if(i=c.head,!i)throw Error(f(453));return i;case"body":if(i=c.body,!i)throw Error(f(454));return i;default:throw Error(f(451))}}function sd(i){for(var c=i.attributes;c.length;)i.removeAttributeNode(c[0]);ir(i)}var fs=new Map,yf=new Set;function b0(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var ru=We.d;We.d={f:L_,r:z_,D:Hm,C:qs,L:kc,m:Zs,X:w0,S:Fh,M:qm};function L_(){var i=ru.f(),c=Wd();return i||c}function z_(i){var c=Sr(i);c!==null&&c.tag===5&&c.type==="form"?Ni(c):ru.r(i)}var Ph=typeof document>"u"?null:document;function Gm(i,c,g){var T=Ph;if(T&&typeof c=="string"&&c){var I=gi(c);I='link[rel="'+i+'"][href="'+I+'"]',typeof g=="string"&&(I+='[crossorigin="'+g+'"]'),yf.has(I)||(yf.add(I),i={rel:i,crossOrigin:g,href:c},T.querySelector(I)===null&&(c=T.createElement("link"),as(c,"link",i),Nr(c),T.head.appendChild(c)))}}function Hm(i){ru.D(i),Gm("dns-prefetch",i,null)}function qs(i,c){ru.C(i,c),Gm("preconnect",i,c)}function kc(i,c,g){ru.L(i,c,g);var T=Ph;if(T&&i&&c){var I='link[rel="preload"][as="'+gi(c)+'"]';c==="image"&&g&&g.imageSrcSet?(I+='[imagesrcset="'+gi(g.imageSrcSet)+'"]',typeof g.imageSizes=="string"&&(I+='[imagesizes="'+gi(g.imageSizes)+'"]')):I+='[href="'+gi(i)+'"]';var L=I;switch(c){case"style":L=vf(i);break;case"script":L=qu(i)}fs.has(L)||(i=B({rel:"preload",href:c==="image"&&g&&g.imageSrcSet?void 0:i,as:c},g),fs.set(L,i),T.querySelector(I)!==null||c==="style"&&T.querySelector(od(L))||c==="script"&&T.querySelector(ld(L))||(c=T.createElement("link"),as(c,"link",i),Nr(c),T.head.appendChild(c)))}}function Zs(i,c){ru.m(i,c);var g=Ph;if(g&&i){var T=c&&typeof c.as=="string"?c.as:"script",I='link[rel="modulepreload"][as="'+gi(T)+'"][href="'+gi(i)+'"]',L=I;switch(T){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":L=qu(i)}if(!fs.has(L)&&(i=B({rel:"modulepreload",href:i},c),fs.set(L,i),g.querySelector(I)===null)){switch(T){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(g.querySelector(ld(L)))return}T=g.createElement("link"),as(T,"link",i),Nr(T),g.head.appendChild(T)}}}function Fh(i,c,g){ru.S(i,c,g);var T=Ph;if(T&&i){var I=xr(T).hoistableStyles,L=vf(i);c=c||"default";var ne=I.get(L);if(!ne){var Ae={loading:0,preload:null};if(ne=T.querySelector(od(L)))Ae.loading=5;else{i=B({rel:"stylesheet",href:i,"data-precedence":c},g),(g=fs.get(L))&&rp(i,g);var ct=ne=T.createElement("link");Nr(ct),as(ct,"link",i),ct._p=new Promise(function(zt,Qt){ct.onload=zt,ct.onerror=Qt}),ct.addEventListener("load",function(){Ae.loading|=1}),ct.addEventListener("error",function(){Ae.loading|=2}),Ae.loading|=4,Zu(ne,c,T)}ne={type:"stylesheet",instance:ne,count:1,state:Ae},I.set(L,ne)}}}function w0(i,c){ru.X(i,c);var g=Ph;if(g&&i){var T=xr(g).hoistableScripts,I=qu(i),L=T.get(I);L||(L=g.querySelector(ld(I)),L||(i=B({src:i,async:!0},c),(c=fs.get(I))&&T0(i,c),L=g.createElement("script"),Nr(L),as(L,"link",i),g.head.appendChild(L)),L={type:"script",instance:L,count:1,state:null},T.set(I,L))}}function qm(i,c){ru.M(i,c);var g=Ph;if(g&&i){var T=xr(g).hoistableScripts,I=qu(i),L=T.get(I);L||(L=g.querySelector(ld(I)),L||(i=B({src:i,async:!0,type:"module"},c),(c=fs.get(I))&&T0(i,c),L=g.createElement("script"),Nr(L),as(L,"link",i),g.head.appendChild(L)),L={type:"script",instance:L,count:1,state:null},T.set(I,L))}}function Zm(i,c,g,T){var I=(I=bt.current)?b0(I):null;if(!I)throw Error(f(446));switch(i){case"meta":case"title":return null;case"style":return typeof g.precedence=="string"&&typeof g.href=="string"?(c=vf(g.href),g=xr(I).hoistableStyles,T=g.get(c),T||(T={type:"style",instance:null,count:0,state:null},g.set(c,T)),T):{type:"void",instance:null,count:0,state:null};case"link":if(g.rel==="stylesheet"&&typeof g.href=="string"&&typeof g.precedence=="string"){i=vf(g.href);var L=xr(I).hoistableStyles,ne=L.get(i);if(ne||(I=I.ownerDocument||I,ne={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},L.set(i,ne),(L=I.querySelector(od(i)))&&!L._p&&(ne.instance=L,ne.state.loading=5),fs.has(i)||(g={rel:"preload",as:"style",href:g.href,crossOrigin:g.crossOrigin,integrity:g.integrity,media:g.media,hrefLang:g.hrefLang,referrerPolicy:g.referrerPolicy},fs.set(i,g),L||$m(I,i,g,ne.state))),c&&T===null)throw Error(f(528,""));return ne}if(c&&T!==null)throw Error(f(529,""));return null;case"script":return c=g.async,g=g.src,typeof g=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=qu(g),g=xr(I).hoistableScripts,T=g.get(c),T||(T={type:"script",instance:null,count:0,state:null},g.set(c,T)),T):{type:"void",instance:null,count:0,state:null};default:throw Error(f(444,i))}}function vf(i){return'href="'+gi(i)+'"'}function od(i){return'link[rel="stylesheet"]['+i+"]"}function Wm(i){return B({},i,{"data-precedence":i.precedence,precedence:null})}function $m(i,c,g,T){i.querySelector('link[rel="preload"][as="style"]['+c+"]")?T.loading=1:(c=i.createElement("link"),T.preload=c,c.addEventListener("load",function(){return T.loading|=1}),c.addEventListener("error",function(){return T.loading|=2}),as(c,"link",g),Nr(c),i.head.appendChild(c))}function qu(i){return'[src="'+gi(i)+'"]'}function ld(i){return"script[async]"+i}function Xm(i,c,g){if(c.count++,c.instance===null)switch(c.type){case"style":var T=i.querySelector('style[data-href~="'+gi(g.href)+'"]');if(T)return c.instance=T,Nr(T),T;var I=B({},g,{"data-href":g.href,"data-precedence":g.precedence,href:null,precedence:null});return T=(i.ownerDocument||i).createElement("style"),Nr(T),as(T,"style",I),Zu(T,g.precedence,i),c.instance=T;case"stylesheet":I=vf(g.href);var L=i.querySelector(od(I));if(L)return c.state.loading|=4,c.instance=L,Nr(L),L;T=Wm(g),(I=fs.get(I))&&rp(T,I),L=(i.ownerDocument||i).createElement("link"),Nr(L);var ne=L;return ne._p=new Promise(function(Ae,ct){ne.onload=Ae,ne.onerror=ct}),as(L,"link",T),c.state.loading|=4,Zu(L,g.precedence,i),c.instance=L;case"script":return L=qu(g.src),(I=i.querySelector(ld(L)))?(c.instance=I,Nr(I),I):(T=g,(I=fs.get(L))&&(T=B({},g),T0(T,I)),i=i.ownerDocument||i,I=i.createElement("script"),Nr(I),as(I,"link",T),i.head.appendChild(I),c.instance=I);case"void":return null;default:throw Error(f(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(T=c.instance,c.state.loading|=4,Zu(T,g.precedence,i));return c.instance}function Zu(i,c,g){for(var T=g.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),I=T.length?T[T.length-1]:null,L=I,ne=0;ne<T.length;ne++){var Ae=T[ne];if(Ae.dataset.precedence===c)L=Ae;else if(L!==I)break}L?L.parentNode.insertBefore(i,L.nextSibling):(c=g.nodeType===9?g.head:g,c.insertBefore(i,c.firstChild))}function rp(i,c){i.crossOrigin==null&&(i.crossOrigin=c.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=c.referrerPolicy),i.title==null&&(i.title=c.title)}function T0(i,c){i.crossOrigin==null&&(i.crossOrigin=c.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=c.referrerPolicy),i.integrity==null&&(i.integrity=c.integrity)}var S0=null;function Ym(i,c,g){if(S0===null){var T=new Map,I=S0=new Map;I.set(g,T)}else I=S0,T=I.get(g),T||(T=new Map,I.set(g,T));if(T.has(i))return T;for(T.set(i,null),g=g.getElementsByTagName(i),I=0;I<g.length;I++){var L=g[I];if(!(L[gt]||L[Re]||i==="link"&&L.getAttribute("rel")==="stylesheet")&&L.namespaceURI!=="http://www.w3.org/2000/svg"){var ne=L.getAttribute(c)||"";ne=i+ne;var Ae=T.get(ne);Ae?Ae.push(L):T.set(ne,[L])}}return T}function np(i,c,g){i=i.ownerDocument||i,i.head.insertBefore(g,c==="title"?i.querySelector("head > title"):null)}function E0(i,c,g){if(g===1||c.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;return c.rel==="stylesheet"?(i=c.disabled,typeof c.precedence=="string"&&i==null):!0;case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function ap(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function Km(i,c,g,T){if(g.type==="stylesheet"&&(typeof T.media!="string"||matchMedia(T.media).matches!==!1)&&(g.state.loading&4)===0){if(g.instance===null){var I=vf(T.href),L=c.querySelector(od(I));if(L){c=L._p,c!==null&&typeof c=="object"&&typeof c.then=="function"&&(i.count++,i=sp.bind(i),c.then(i,i)),g.state.loading|=4,g.instance=L,Nr(L);return}L=c.ownerDocument||c,T=Wm(T),(I=fs.get(I))&&rp(T,I),L=L.createElement("link"),Nr(L);var ne=L;ne._p=new Promise(function(Ae,ct){ne.onload=Ae,ne.onerror=ct}),as(L,"link",T),g.instance=L}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(g,c),(c=g.state.preload)&&(g.state.loading&3)===0&&(i.count++,g=sp.bind(i),c.addEventListener("load",g),c.addEventListener("error",g))}}var ip=0;function Jm(i,c){return i.stylesheets&&i.count===0&&lp(i,i.stylesheets),0<i.count||0<i.imgCount?function(g){var T=setTimeout(function(){if(i.stylesheets&&lp(i,i.stylesheets),i.unsuspend){var L=i.unsuspend;i.unsuspend=null,L()}},6e4+c);0<i.imgBytes&&ip===0&&(ip=62500*id());var I=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&lp(i,i.stylesheets),i.unsuspend)){var L=i.unsuspend;i.unsuspend=null,L()}},(i.imgBytes>ip?50:800)+c);return i.unsuspend=g,function(){i.unsuspend=null,clearTimeout(T),clearTimeout(I)}}:null}function sp(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)lp(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var op=null;function lp(i,c){i.stylesheets=null,i.unsuspend!==null&&(i.count++,op=new Map,c.forEach(O_,i),op=null,sp.call(i))}function O_(i,c){if(!(c.state.loading&4)){var g=op.get(i);if(g)var T=g.get(null);else{g=new Map,op.set(i,g);for(var I=i.querySelectorAll("link[data-precedence],style[data-precedence]"),L=0;L<I.length;L++){var ne=I[L];(ne.nodeName==="LINK"||ne.getAttribute("media")!=="not all")&&(g.set(ne.dataset.precedence,ne),T=ne)}T&&g.set(null,T)}I=c.instance,ne=I.getAttribute("data-precedence"),L=g.get(ne)||T,L===T&&g.set(null,I),g.set(ne,I),this.count++,T=sp.bind(this),I.addEventListener("load",T),I.addEventListener("error",T),L?L.parentNode.insertBefore(I,L.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(I,i.firstChild)),c.state.loading|=4}}var cd={$$typeof:W,Provider:null,Consumer:null,_currentValue:$t,_currentValue2:$t,_threadCount:0};function Wx(i,c,g,T,I,L,ne,Ae,ct){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ga(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ga(0),this.hiddenUpdates=Ga(null),this.identifierPrefix=T,this.onUncaughtError=I,this.onCaughtError=L,this.onRecoverableError=ne,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ct,this.incompleteTransitions=new Map}function Qm(i,c,g,T,I,L,ne,Ae,ct,zt,Qt,or){return i=new Wx(i,c,g,ne,ct,zt,Qt,or,Ae),c=1,L===!0&&(c|=24),L=Ts(3,null,null,c),i.current=L,L.stateNode=i,c=Ns(),c.refCount++,i.pooledCache=c,c.refCount++,L.memoizedState={element:T,isDehydrated:g,cache:c},jf(L),i}function B_(i){return i?(i=dn,i):dn}function N_(i,c,g,T,I,L){I=B_(I),T.context===null?T.context=I:T.pendingContext=I,T=Gl(c),T.payload={element:g},L=L===void 0?null:L,L!==null&&(T.callback=L),g=mc(i,T,c),g!==null&&(Oo(g,i,c),Co(g,i,c))}function A0(i,c){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var g=i.retryLane;i.retryLane=g!==0&&g<c?g:c}}function k0(i,c){A0(i,c),(i=i.alternate)&&A0(i,c)}function j_(i){if(i.tag===13||i.tag===31){var c=Os(i,67108864);c!==null&&Oo(c,i,67108864),k0(i,67108864)}}function U_(i){if(i.tag===13||i.tag===31){var c=zo();c=xo(c);var g=Os(i,c);g!==null&&Oo(g,i,c),k0(i,c)}}var cp=!0;function up(i,c,g,T){var I=tt.T;tt.T=null;var L=We.p;try{We.p=2,eg(i,c,g,T)}finally{We.p=L,tt.T=I}}function V_(i,c,g,T){var I=tt.T;tt.T=null;var L=We.p;try{We.p=8,eg(i,c,g,T)}finally{We.p=L,tt.T=I}}function eg(i,c,g,T){if(cp){var I=hp(T);if(I===null)tu(i,c,T,ud,g),G_(i,T);else if(Xx(I,i,c,g,T))T.stopPropagation();else if(G_(i,T),c&4&&-1<$x.indexOf(i)){for(;I!==null;){var L=Sr(I);if(L!==null)switch(L.tag){case 3:if(L=L.stateNode,L.current.memoizedState.isDehydrated){var ne=xt(L.pendingLanes);if(ne!==0){var Ae=L;for(Ae.pendingLanes|=2,Ae.entangledLanes|=2;ne;){var ct=1<<31-Bt(ne);Ae.entanglements[1]|=ct,ne&=~ct}Sc(L),(fa&6)===0&&(qd=pr()+500,ml(0))}}break;case 31:case 13:Ae=Os(L,2),Ae!==null&&Oo(Ae,L,2),Wd(),k0(L,2)}if(L=hp(T),L===null&&tu(i,c,T,ud,g),L===I)break;I=L}I!==null&&T.stopPropagation()}else tu(i,c,T,null,g)}}function hp(i){return i=pu(i),C0(i)}var ud=null;function C0(i){if(ud=null,i=vr(i),i!==null){var c=b(i);if(c===null)i=null;else{var g=c.tag;if(g===13){if(i=_(c),i!==null)return i;i=null}else if(g===31){if(i=s(c),i!==null)return i;i=null}else if(g===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;i=null}else c!==i&&(i=null)}}return ud=i,null}function bf(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(sr()){case st:return 2;case fe:return 8;case ue:case ye:return 32;case je:return 268435456;default:return 32}default:return 32}}var M0=!1,Lh=null,Xl=null,zh=null,fp=new Map,hd=new Map,Wu=[],$x="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function G_(i,c){switch(i){case"focusin":case"focusout":Lh=null;break;case"dragenter":case"dragleave":Xl=null;break;case"mouseover":case"mouseout":zh=null;break;case"pointerover":case"pointerout":fp.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":hd.delete(c.pointerId)}}function dp(i,c,g,T,I,L){return i===null||i.nativeEvent!==L?(i={blockedOn:c,domEventName:g,eventSystemFlags:T,nativeEvent:L,targetContainers:[I]},c!==null&&(c=Sr(c),c!==null&&j_(c)),i):(i.eventSystemFlags|=T,c=i.targetContainers,I!==null&&c.indexOf(I)===-1&&c.push(I),i)}function Xx(i,c,g,T,I){switch(c){case"focusin":return Lh=dp(Lh,i,c,g,T,I),!0;case"dragenter":return Xl=dp(Xl,i,c,g,T,I),!0;case"mouseover":return zh=dp(zh,i,c,g,T,I),!0;case"pointerover":var L=I.pointerId;return fp.set(L,dp(fp.get(L)||null,i,c,g,T,I)),!0;case"gotpointercapture":return L=I.pointerId,hd.set(L,dp(hd.get(L)||null,i,c,g,T,I)),!0}return!1}function H_(i){var c=vr(i.target);if(c!==null){var g=b(c);if(g!==null){if(c=g.tag,c===13){if(c=_(g),c!==null){i.blockedOn=c,Ue(i.priority,function(){U_(g)});return}}else if(c===31){if(c=s(g),c!==null){i.blockedOn=c,Ue(i.priority,function(){U_(g)});return}}else if(c===3&&g.stateNode.current.memoizedState.isDehydrated){i.blockedOn=g.tag===3?g.stateNode.containerInfo:null;return}}}i.blockedOn=null}function pp(i){if(i.blockedOn!==null)return!1;for(var c=i.targetContainers;0<c.length;){var g=hp(i.nativeEvent);if(g===null){g=i.nativeEvent;var T=new g.constructor(g.type,g);ec=T,g.target.dispatchEvent(T),ec=null}else return c=Sr(g),c!==null&&j_(c),i.blockedOn=g,!1;c.shift()}return!0}function q_(i,c,g){pp(i)&&g.delete(c)}function mp(){M0=!1,Lh!==null&&pp(Lh)&&(Lh=null),Xl!==null&&pp(Xl)&&(Xl=null),zh!==null&&pp(zh)&&(zh=null),fp.forEach(q_),hd.forEach(q_)}function D0(i,c){i.blockedOn===c&&(i.blockedOn=null,M0||(M0=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,mp)))}var R0=null;function Z_(i){R0!==i&&(R0=i,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){R0===i&&(R0=null);for(var c=0;c<i.length;c+=3){var g=i[c],T=i[c+1],I=i[c+2];if(typeof T!="function"){if(C0(T||g)===null)continue;break}var L=Sr(g);L!==null&&(i.splice(c,3),c-=3,Ka(L,{pending:!0,data:I,method:g.method,action:T},T,I))}}))}function Oh(i){function c(ct){return D0(ct,i)}Lh!==null&&D0(Lh,i),Xl!==null&&D0(Xl,i),zh!==null&&D0(zh,i),fp.forEach(c),hd.forEach(c);for(var g=0;g<Wu.length;g++){var T=Wu[g];T.blockedOn===i&&(T.blockedOn=null)}for(;0<Wu.length&&(g=Wu[0],g.blockedOn===null);)H_(g),g.blockedOn===null&&Wu.shift();if(g=(i.ownerDocument||i).$$reactFormReplay,g!=null)for(T=0;T<g.length;T+=3){var I=g[T],L=g[T+1],ne=I[Te]||null;if(typeof L=="function")ne||Z_(g);else if(ne){var Ae=null;if(L&&L.hasAttribute("formAction")){if(I=L,ne=L[Te]||null)Ae=ne.formAction;else if(C0(I)!==null)continue}else Ae=ne.action;typeof Ae=="function"?g[T+1]=Ae:(g.splice(T,3),T-=3),Z_(g)}}}function tg(){function i(L){L.canIntercept&&L.info==="react-transition"&&L.intercept({handler:function(){return new Promise(function(ne){return I=ne})},focusReset:"manual",scroll:"manual"})}function c(){I!==null&&(I(),I=null),T||setTimeout(g,20)}function g(){if(!T&&!navigation.transition){var L=navigation.currentEntry;L&&L.url!=null&&navigation.navigate(L.url,{state:L.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var T=!1,I=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",c),navigation.addEventListener("navigateerror",c),setTimeout(g,100),function(){T=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",c),navigation.removeEventListener("navigateerror",c),I!==null&&(I(),I=null)}}}function rg(i){this._internalRoot=i}I0.prototype.render=rg.prototype.render=function(i){var c=this._internalRoot;if(c===null)throw Error(f(409));var g=c.current,T=zo();N_(g,T,i,c,null,null)},I0.prototype.unmount=rg.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var c=i.containerInfo;N_(i.current,2,null,i,null,null),Wd(),c[ze]=null}};function I0(i){this._internalRoot=i}I0.prototype.unstable_scheduleHydration=function(i){if(i){var c=xe();i={blockedOn:null,target:i,priority:c};for(var g=0;g<Wu.length&&c!==0&&c<Wu[g].priority;g++);Wu.splice(g,0,i),g===0&&H_(i)}};var ng=u.version;if(ng!=="19.2.3")throw Error(f(527,ng,"19.2.3"));We.findDOMNode=function(i){var c=i._reactInternals;if(c===void 0)throw typeof i.render=="function"?Error(f(188)):(i=Object.keys(i).join(","),Error(f(268,i)));return i=M(c),i=i!==null?D(i):null,i=i===null?null:i.stateNode,i};var W_={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:tt,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var P0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!P0.isDisabled&&P0.supportsFiber)try{lt=P0.inject(W_),at=P0}catch{}}return cg.createRoot=function(i,c){if(!p(i))throw Error(f(299));var g=!1,T="",I=Hf,L=vc,ne=bc;return c!=null&&(c.unstable_strictMode===!0&&(g=!0),c.identifierPrefix!==void 0&&(T=c.identifierPrefix),c.onUncaughtError!==void 0&&(I=c.onUncaughtError),c.onCaughtError!==void 0&&(L=c.onCaughtError),c.onRecoverableError!==void 0&&(ne=c.onRecoverableError)),c=Qm(i,1,!1,null,null,g,T,null,I,L,ne,tg),i[ze]=c.current,Fm(i),new rg(c)},cg.hydrateRoot=function(i,c,g){if(!p(i))throw Error(f(299));var T=!1,I="",L=Hf,ne=vc,Ae=bc,ct=null;return g!=null&&(g.unstable_strictMode===!0&&(T=!0),g.identifierPrefix!==void 0&&(I=g.identifierPrefix),g.onUncaughtError!==void 0&&(L=g.onUncaughtError),g.onCaughtError!==void 0&&(ne=g.onCaughtError),g.onRecoverableError!==void 0&&(Ae=g.onRecoverableError),g.formState!==void 0&&(ct=g.formState)),c=Qm(i,1,!0,c,g??null,T,I,ct,L,ne,Ae,tg),c.context=B_(null),g=c.current,T=zo(),T=xo(T),I=Gl(T),I.callback=null,mc(g,I,T),g=T,c.current.lanes=g,Vn(c,g),Sc(c),i[ze]=c.current,Fm(i),new I0(c)},cg.version="19.2.3",cg}var J1;function aT(){if(J1)return oy.exports;J1=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(u){console.error(u)}}return r(),oy.exports=nT(),oy.exports}var iT=aT();const sT=Fx(iT);var Q1="popstate";function oT(r={}){function u(f,p){let{pathname:b,search:_,hash:s}=f.location;return Iy("",{pathname:b,search:_,hash:s},p.state&&p.state.usr||null,p.state&&p.state.key||"default")}function l(f,p){return typeof p=="string"?p:Dg(p)}return cT(u,l,null,r)}function Di(r,u){if(r===!1||r===null||typeof r>"u")throw new Error(u)}function Vh(r,u){if(!r){typeof console<"u"&&console.warn(u);try{throw new Error(u)}catch{}}}function lT(){return Math.random().toString(36).substring(2,10)}function ev(r,u){return{usr:r.state,key:r.key,idx:u}}function Iy(r,u,l=null,f){return{pathname:typeof r=="string"?r:r.pathname,search:"",hash:"",...typeof u=="string"?Q0(u):u,state:l,key:u&&u.key||f||lT()}}function Dg({pathname:r="/",search:u="",hash:l=""}){return u&&u!=="?"&&(r+=u.charAt(0)==="?"?u:"?"+u),l&&l!=="#"&&(r+=l.charAt(0)==="#"?l:"#"+l),r}function Q0(r){let u={};if(r){let l=r.indexOf("#");l>=0&&(u.hash=r.substring(l),r=r.substring(0,l));let f=r.indexOf("?");f>=0&&(u.search=r.substring(f),r=r.substring(0,f)),r&&(u.pathname=r)}return u}function cT(r,u,l,f={}){let{window:p=document.defaultView,v5Compat:b=!1}=f,_=p.history,s="POP",C=null,M=D();M==null&&(M=0,_.replaceState({..._.state,idx:M},""));function D(){return(_.state||{idx:null}).idx}function B(){s="POP";let N=D(),Z=N==null?null:N-M;M=N,C&&C({action:s,location:z.location,delta:Z})}function U(N,Z){s="PUSH";let Y=Iy(z.location,N,Z);M=D()+1;let W=ev(Y,M),de=z.createHref(Y);try{_.pushState(W,"",de)}catch(ge){if(ge instanceof DOMException&&ge.name==="DataCloneError")throw ge;p.location.assign(de)}b&&C&&C({action:s,location:z.location,delta:1})}function j(N,Z){s="REPLACE";let Y=Iy(z.location,N,Z);M=D();let W=ev(Y,M),de=z.createHref(Y);_.replaceState(W,"",de),b&&C&&C({action:s,location:z.location,delta:0})}function H(N){return uT(N)}let z={get action(){return s},get location(){return r(p,_)},listen(N){if(C)throw new Error("A history only accepts one active listener");return p.addEventListener(Q1,B),C=N,()=>{p.removeEventListener(Q1,B),C=null}},createHref(N){return u(p,N)},createURL:H,encodeLocation(N){let Z=H(N);return{pathname:Z.pathname,search:Z.search,hash:Z.hash}},push:U,replace:j,go(N){return _.go(N)}};return z}function uT(r,u=!1){let l="http://localhost";typeof window<"u"&&(l=window.location.origin!=="null"?window.location.origin:window.location.href),Di(l,"No window.location.(origin|href) available to create URL");let f=typeof r=="string"?r:Dg(r);return f=f.replace(/ $/,"%20"),!u&&f.startsWith("//")&&(f=l+f),new URL(f,l)}function Sb(r,u,l="/"){return hT(r,u,l,!1)}function hT(r,u,l,f){let p=typeof u=="string"?Q0(u):u,b=Mf(p.pathname||"/",l);if(b==null)return null;let _=Eb(r);fT(_);let s=null;for(let C=0;s==null&&C<_.length;++C){let M=TT(b);s=bT(_[C],M,f)}return s}function Eb(r,u=[],l=[],f="",p=!1){let b=(_,s,C=p,M)=>{let D={relativePath:M===void 0?_.path||"":M,caseSensitive:_.caseSensitive===!0,childrenIndex:s,route:_};if(D.relativePath.startsWith("/")){if(!D.relativePath.startsWith(f)&&C)return;Di(D.relativePath.startsWith(f),`Absolute route path "${D.relativePath}" nested under path "${f}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),D.relativePath=D.relativePath.slice(f.length)}let B=Af([f,D.relativePath]),U=l.concat(D);_.children&&_.children.length>0&&(Di(_.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${B}".`),Eb(_.children,u,U,B,C)),!(_.path==null&&!_.index)&&u.push({path:B,score:yT(B,_.index),routesMeta:U})};return r.forEach((_,s)=>{if(_.path===""||!_.path?.includes("?"))b(_,s);else for(let C of Ab(_.path))b(_,s,!0,C)}),u}function Ab(r){let u=r.split("/");if(u.length===0)return[];let[l,...f]=u,p=l.endsWith("?"),b=l.replace(/\?$/,"");if(f.length===0)return p?[b,""]:[b];let _=Ab(f.join("/")),s=[];return s.push(..._.map(C=>C===""?b:[b,C].join("/"))),p&&s.push(..._),s.map(C=>r.startsWith("/")&&C===""?"/":C)}function fT(r){r.sort((u,l)=>u.score!==l.score?l.score-u.score:vT(u.routesMeta.map(f=>f.childrenIndex),l.routesMeta.map(f=>f.childrenIndex)))}var dT=/^:[\w-]+$/,pT=3,mT=2,gT=1,_T=10,xT=-2,tv=r=>r==="*";function yT(r,u){let l=r.split("/"),f=l.length;return l.some(tv)&&(f+=xT),u&&(f+=mT),l.filter(p=>!tv(p)).reduce((p,b)=>p+(dT.test(b)?pT:b===""?gT:_T),f)}function vT(r,u){return r.length===u.length&&r.slice(0,-1).every((f,p)=>f===u[p])?r[r.length-1]-u[u.length-1]:0}function bT(r,u,l=!1){let{routesMeta:f}=r,p={},b="/",_=[];for(let s=0;s<f.length;++s){let C=f[s],M=s===f.length-1,D=b==="/"?u:u.slice(b.length)||"/",B=yx({path:C.relativePath,caseSensitive:C.caseSensitive,end:M},D),U=C.route;if(!B&&M&&l&&!f[f.length-1].route.index&&(B=yx({path:C.relativePath,caseSensitive:C.caseSensitive,end:!1},D)),!B)return null;Object.assign(p,B.params),_.push({params:p,pathname:Af([b,B.pathname]),pathnameBase:kT(Af([b,B.pathnameBase])),route:U}),B.pathnameBase!=="/"&&(b=Af([b,B.pathnameBase]))}return _}function yx(r,u){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[l,f]=wT(r.path,r.caseSensitive,r.end),p=u.match(l);if(!p)return null;let b=p[0],_=b.replace(/(.)\/+$/,"$1"),s=p.slice(1);return{params:f.reduce((M,{paramName:D,isOptional:B},U)=>{if(D==="*"){let H=s[U]||"";_=b.slice(0,b.length-H.length).replace(/(.)\/+$/,"$1")}const j=s[U];return B&&!j?M[D]=void 0:M[D]=(j||"").replace(/%2F/g,"/"),M},{}),pathname:b,pathnameBase:_,pattern:r}}function wT(r,u=!1,l=!0){Vh(r==="*"||!r.endsWith("*")||r.endsWith("/*"),`Route path "${r}" will be treated as if it were "${r.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${r.replace(/\*$/,"/*")}".`);let f=[],p="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(_,s,C)=>(f.push({paramName:s,isOptional:C!=null}),C?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return r.endsWith("*")?(f.push({paramName:"*"}),p+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):l?p+="\\/*$":r!==""&&r!=="/"&&(p+="(?:(?=\\/|$))"),[new RegExp(p,u?void 0:"i"),f]}function TT(r){try{return r.split("/").map(u=>decodeURIComponent(u).replace(/\//g,"%2F")).join("/")}catch(u){return Vh(!1,`The URL path "${r}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${u}).`),r}}function Mf(r,u){if(u==="/")return r;if(!r.toLowerCase().startsWith(u.toLowerCase()))return null;let l=u.endsWith("/")?u.length-1:u.length,f=r.charAt(l);return f&&f!=="/"?null:r.slice(l)||"/"}var ST=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function ET(r,u="/"){let{pathname:l,search:f="",hash:p=""}=typeof r=="string"?Q0(r):r,b;return l?(l=l.replace(/\/\/+/g,"/"),l.startsWith("/")?b=rv(l.substring(1),"/"):b=rv(l,u)):b=u,{pathname:b,search:CT(f),hash:MT(p)}}function rv(r,u){let l=u.replace(/\/+$/,"").split("/");return r.split("/").forEach(p=>{p===".."?l.length>1&&l.pop():p!=="."&&l.push(p)}),l.length>1?l.join("/"):"/"}function hy(r,u,l,f){return`Cannot include a '${r}' character in a manually specified \`to.${u}\` field [${JSON.stringify(f)}].  Please separate it out to the \`to.${l}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function AT(r){return r.filter((u,l)=>l===0||u.route.path&&u.route.path.length>0)}function kb(r){let u=AT(r);return u.map((l,f)=>f===u.length-1?l.pathname:l.pathnameBase)}function Cb(r,u,l,f=!1){let p;typeof r=="string"?p=Q0(r):(p={...r},Di(!p.pathname||!p.pathname.includes("?"),hy("?","pathname","search",p)),Di(!p.pathname||!p.pathname.includes("#"),hy("#","pathname","hash",p)),Di(!p.search||!p.search.includes("#"),hy("#","search","hash",p)));let b=r===""||p.pathname==="",_=b?"/":p.pathname,s;if(_==null)s=l;else{let B=u.length-1;if(!f&&_.startsWith("..")){let U=_.split("/");for(;U[0]==="..";)U.shift(),B-=1;p.pathname=U.join("/")}s=B>=0?u[B]:"/"}let C=ET(p,s),M=_&&_!=="/"&&_.endsWith("/"),D=(b||_===".")&&l.endsWith("/");return!C.pathname.endsWith("/")&&(M||D)&&(C.pathname+="/"),C}var Af=r=>r.join("/").replace(/\/\/+/g,"/"),kT=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),CT=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,MT=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r,DT=class{constructor(r,u,l,f=!1){this.status=r,this.statusText=u||"",this.internal=f,l instanceof Error?(this.data=l.toString(),this.error=l):this.data=l}};function RT(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}function IT(r){return r.map(u=>u.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var Mb=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Db(r,u){let l=r;if(typeof l!="string"||!ST.test(l))return{absoluteURL:void 0,isExternal:!1,to:l};let f=l,p=!1;if(Mb)try{let b=new URL(window.location.href),_=l.startsWith("//")?new URL(b.protocol+l):new URL(l),s=Mf(_.pathname,u);_.origin===b.origin&&s!=null?l=s+_.search+_.hash:p=!0}catch{Vh(!1,`<Link to="${l}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:f,isExternal:p,to:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Rb=["POST","PUT","PATCH","DELETE"];new Set(Rb);var PT=["GET",...Rb];new Set(PT);var em=ke.createContext(null);em.displayName="DataRouter";var Lx=ke.createContext(null);Lx.displayName="DataRouterState";var FT=ke.createContext(!1),Ib=ke.createContext({isTransitioning:!1});Ib.displayName="ViewTransition";var LT=ke.createContext(new Map);LT.displayName="Fetchers";var zT=ke.createContext(null);zT.displayName="Await";var cu=ke.createContext(null);cu.displayName="Navigation";var jg=ke.createContext(null);jg.displayName="Location";var Rf=ke.createContext({outlet:null,matches:[],isDataRoute:!1});Rf.displayName="Route";var Yy=ke.createContext(null);Yy.displayName="RouteError";var Pb="REACT_ROUTER_ERROR",OT="REDIRECT",BT="ROUTE_ERROR_RESPONSE";function NT(r){if(r.startsWith(`${Pb}:${OT}:{`))try{let u=JSON.parse(r.slice(28));if(typeof u=="object"&&u&&typeof u.status=="number"&&typeof u.statusText=="string"&&typeof u.location=="string"&&typeof u.reloadDocument=="boolean"&&typeof u.replace=="boolean")return u}catch{}}function jT(r){if(r.startsWith(`${Pb}:${BT}:{`))try{let u=JSON.parse(r.slice(40));if(typeof u=="object"&&u&&typeof u.status=="number"&&typeof u.statusText=="string")return new DT(u.status,u.statusText,u.data)}catch{}}function UT(r,{relative:u}={}){Di(Ug(),"useHref() may be used only in the context of a <Router> component.");let{basename:l,navigator:f}=ke.useContext(cu),{hash:p,pathname:b,search:_}=Vg(r,{relative:u}),s=b;return l!=="/"&&(s=b==="/"?l:Af([l,b])),f.createHref({pathname:s,search:_,hash:p})}function Ug(){return ke.useContext(jg)!=null}function kp(){return Di(Ug(),"useLocation() may be used only in the context of a <Router> component."),ke.useContext(jg).location}var Fb="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Lb(r){ke.useContext(cu).static||ke.useLayoutEffect(r)}function VT(){let{isDataRoute:r}=ke.useContext(Rf);return r?tS():GT()}function GT(){Di(Ug(),"useNavigate() may be used only in the context of a <Router> component.");let r=ke.useContext(em),{basename:u,navigator:l}=ke.useContext(cu),{matches:f}=ke.useContext(Rf),{pathname:p}=kp(),b=JSON.stringify(kb(f)),_=ke.useRef(!1);return Lb(()=>{_.current=!0}),ke.useCallback((C,M={})=>{if(Vh(_.current,Fb),!_.current)return;if(typeof C=="number"){l.go(C);return}let D=Cb(C,JSON.parse(b),p,M.relative==="path");r==null&&u!=="/"&&(D.pathname=D.pathname==="/"?u:Af([u,D.pathname])),(M.replace?l.replace:l.push)(D,M.state,M)},[u,l,b,p,r])}ke.createContext(null);function Vg(r,{relative:u}={}){let{matches:l}=ke.useContext(Rf),{pathname:f}=kp(),p=JSON.stringify(kb(l));return ke.useMemo(()=>Cb(r,JSON.parse(p),f,u==="path"),[r,p,f,u])}function HT(r,u){return zb(r,u)}function zb(r,u,l,f,p){Di(Ug(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:b}=ke.useContext(cu),{matches:_}=ke.useContext(Rf),s=_[_.length-1],C=s?s.params:{},M=s?s.pathname:"/",D=s?s.pathnameBase:"/",B=s&&s.route;{let Y=B&&B.path||"";Bb(M,!B||Y.endsWith("*")||Y.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${M}" (under <Route path="${Y}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${Y}"> to <Route path="${Y==="/"?"*":`${Y}/*`}">.`)}let U=kp(),j;if(u){let Y=typeof u=="string"?Q0(u):u;Di(D==="/"||Y.pathname?.startsWith(D),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${D}" but pathname "${Y.pathname}" was given in the \`location\` prop.`),j=Y}else j=U;let H=j.pathname||"/",z=H;if(D!=="/"){let Y=D.replace(/^\//,"").split("/");z="/"+H.replace(/^\//,"").split("/").slice(Y.length).join("/")}let N=Sb(r,{pathname:z});Vh(B||N!=null,`No routes matched location "${j.pathname}${j.search}${j.hash}" `),Vh(N==null||N[N.length-1].route.element!==void 0||N[N.length-1].route.Component!==void 0||N[N.length-1].route.lazy!==void 0,`Matched leaf route at location "${j.pathname}${j.search}${j.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let Z=XT(N&&N.map(Y=>Object.assign({},Y,{params:Object.assign({},C,Y.params),pathname:Af([D,b.encodeLocation?b.encodeLocation(Y.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Y.pathname]),pathnameBase:Y.pathnameBase==="/"?D:Af([D,b.encodeLocation?b.encodeLocation(Y.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Y.pathnameBase])})),_,l,f,p);return u&&Z?ke.createElement(jg.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...j},navigationType:"POP"}},Z):Z}function qT(){let r=eS(),u=RT(r)?`${r.status} ${r.statusText}`:r instanceof Error?r.message:JSON.stringify(r),l=r instanceof Error?r.stack:null,f="rgba(200,200,200, 0.5)",p={padding:"0.5rem",backgroundColor:f},b={padding:"2px 4px",backgroundColor:f},_=null;return console.error("Error handled by React Router default ErrorBoundary:",r),_=ke.createElement(ke.Fragment,null,ke.createElement("p",null," Hey developer "),ke.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",ke.createElement("code",{style:b},"ErrorBoundary")," or"," ",ke.createElement("code",{style:b},"errorElement")," prop on your route.")),ke.createElement(ke.Fragment,null,ke.createElement("h2",null,"Unexpected Application Error!"),ke.createElement("h3",{style:{fontStyle:"italic"}},u),l?ke.createElement("pre",{style:p},l):null,_)}var ZT=ke.createElement(qT,null),Ob=class extends ke.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,u){return u.location!==r.location||u.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:u.error,location:u.location,revalidation:r.revalidation||u.revalidation}}componentDidCatch(r,u){this.props.onError?this.props.onError(r,u):console.error("React Router caught the following error during render",r)}render(){let r=this.state.error;if(this.context&&typeof r=="object"&&r&&"digest"in r&&typeof r.digest=="string"){const l=jT(r.digest);l&&(r=l)}let u=r!==void 0?ke.createElement(Rf.Provider,{value:this.props.routeContext},ke.createElement(Yy.Provider,{value:r,children:this.props.component})):this.props.children;return this.context?ke.createElement(WT,{error:r},u):u}};Ob.contextType=FT;var fy=new WeakMap;function WT({children:r,error:u}){let{basename:l}=ke.useContext(cu);if(typeof u=="object"&&u&&"digest"in u&&typeof u.digest=="string"){let f=NT(u.digest);if(f){let p=fy.get(u);if(p)throw p;let b=Db(f.location,l);if(Mb&&!fy.get(u))if(b.isExternal||f.reloadDocument)window.location.href=b.absoluteURL||b.to;else{const _=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(b.to,{replace:f.replace}));throw fy.set(u,_),_}return ke.createElement("meta",{httpEquiv:"refresh",content:`0;url=${b.absoluteURL||b.to}`})}}return r}function $T({routeContext:r,match:u,children:l}){let f=ke.useContext(em);return f&&f.static&&f.staticContext&&(u.route.errorElement||u.route.ErrorBoundary)&&(f.staticContext._deepestRenderedBoundaryId=u.route.id),ke.createElement(Rf.Provider,{value:r},l)}function XT(r,u=[],l=null,f=null,p=null){if(r==null){if(!l)return null;if(l.errors)r=l.matches;else if(u.length===0&&!l.initialized&&l.matches.length>0)r=l.matches;else return null}let b=r,_=l?.errors;if(_!=null){let D=b.findIndex(B=>B.route.id&&_?.[B.route.id]!==void 0);Di(D>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(_).join(",")}`),b=b.slice(0,Math.min(b.length,D+1))}let s=!1,C=-1;if(l)for(let D=0;D<b.length;D++){let B=b[D];if((B.route.HydrateFallback||B.route.hydrateFallbackElement)&&(C=D),B.route.id){let{loaderData:U,errors:j}=l,H=B.route.loader&&!U.hasOwnProperty(B.route.id)&&(!j||j[B.route.id]===void 0);if(B.route.lazy||H){s=!0,C>=0?b=b.slice(0,C+1):b=[b[0]];break}}}let M=l&&f?(D,B)=>{f(D,{location:l.location,params:l.matches?.[0]?.params??{},unstable_pattern:IT(l.matches),errorInfo:B})}:void 0;return b.reduceRight((D,B,U)=>{let j,H=!1,z=null,N=null;l&&(j=_&&B.route.id?_[B.route.id]:void 0,z=B.route.errorElement||ZT,s&&(C<0&&U===0?(Bb("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),H=!0,N=null):C===U&&(H=!0,N=B.route.hydrateFallbackElement||null)));let Z=u.concat(b.slice(0,U+1)),Y=()=>{let W;return j?W=z:H?W=N:B.route.Component?W=ke.createElement(B.route.Component,null):B.route.element?W=B.route.element:W=D,ke.createElement($T,{match:B,routeContext:{outlet:D,matches:Z,isDataRoute:l!=null},children:W})};return l&&(B.route.ErrorBoundary||B.route.errorElement||U===0)?ke.createElement(Ob,{location:l.location,revalidation:l.revalidation,component:z,error:j,children:Y(),routeContext:{outlet:null,matches:Z,isDataRoute:!0},onError:M}):Y()},null)}function Ky(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function YT(r){let u=ke.useContext(em);return Di(u,Ky(r)),u}function KT(r){let u=ke.useContext(Lx);return Di(u,Ky(r)),u}function JT(r){let u=ke.useContext(Rf);return Di(u,Ky(r)),u}function Jy(r){let u=JT(r),l=u.matches[u.matches.length-1];return Di(l.route.id,`${r} can only be used on routes that contain a unique "id"`),l.route.id}function QT(){return Jy("useRouteId")}function eS(){let r=ke.useContext(Yy),u=KT("useRouteError"),l=Jy("useRouteError");return r!==void 0?r:u.errors?.[l]}function tS(){let{router:r}=YT("useNavigate"),u=Jy("useNavigate"),l=ke.useRef(!1);return Lb(()=>{l.current=!0}),ke.useCallback(async(p,b={})=>{Vh(l.current,Fb),l.current&&(typeof p=="number"?await r.navigate(p):await r.navigate(p,{fromRouteId:u,...b}))},[r,u])}var nv={};function Bb(r,u,l){!u&&!nv[r]&&(nv[r]=!0,Vh(!1,l))}ke.memo(rS);function rS({routes:r,future:u,state:l,onError:f}){return zb(r,void 0,l,f,u)}function fx(r){Di(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function nS({basename:r="/",children:u=null,location:l,navigationType:f="POP",navigator:p,static:b=!1,unstable_useTransitions:_}){Di(!Ug(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let s=r.replace(/^\/*/,"/"),C=ke.useMemo(()=>({basename:s,navigator:p,static:b,unstable_useTransitions:_,future:{}}),[s,p,b,_]);typeof l=="string"&&(l=Q0(l));let{pathname:M="/",search:D="",hash:B="",state:U=null,key:j="default"}=l,H=ke.useMemo(()=>{let z=Mf(M,s);return z==null?null:{location:{pathname:z,search:D,hash:B,state:U,key:j},navigationType:f}},[s,M,D,B,U,j,f]);return Vh(H!=null,`<Router basename="${s}"> is not able to match the URL "${M}${D}${B}" because it does not start with the basename, so the <Router> won't render anything.`),H==null?null:ke.createElement(cu.Provider,{value:C},ke.createElement(jg.Provider,{children:u,value:H}))}function aS({children:r,location:u}){return HT(Py(r),u)}function Py(r,u=[]){let l=[];return ke.Children.forEach(r,(f,p)=>{if(!ke.isValidElement(f))return;let b=[...u,p];if(f.type===ke.Fragment){l.push.apply(l,Py(f.props.children,b));return}Di(f.type===fx,`[${typeof f.type=="string"?f.type:f.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Di(!f.props.index||!f.props.children,"An index route cannot have child routes.");let _={id:f.props.id||b.join("-"),caseSensitive:f.props.caseSensitive,element:f.props.element,Component:f.props.Component,index:f.props.index,path:f.props.path,middleware:f.props.middleware,loader:f.props.loader,action:f.props.action,hydrateFallbackElement:f.props.hydrateFallbackElement,HydrateFallback:f.props.HydrateFallback,errorElement:f.props.errorElement,ErrorBoundary:f.props.ErrorBoundary,hasErrorBoundary:f.props.hasErrorBoundary===!0||f.props.ErrorBoundary!=null||f.props.errorElement!=null,shouldRevalidate:f.props.shouldRevalidate,handle:f.props.handle,lazy:f.props.lazy};f.props.children&&(_.children=Py(f.props.children,b)),l.push(_)}),l}var dx="get",px="application/x-www-form-urlencoded";function zx(r){return typeof HTMLElement<"u"&&r instanceof HTMLElement}function iS(r){return zx(r)&&r.tagName.toLowerCase()==="button"}function sS(r){return zx(r)&&r.tagName.toLowerCase()==="form"}function oS(r){return zx(r)&&r.tagName.toLowerCase()==="input"}function lS(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function cS(r,u){return r.button===0&&(!u||u==="_self")&&!lS(r)}var Y_=null;function uS(){if(Y_===null)try{new FormData(document.createElement("form"),0),Y_=!1}catch{Y_=!0}return Y_}var hS=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function dy(r){return r!=null&&!hS.has(r)?(Vh(!1,`"${r}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${px}"`),null):r}function fS(r,u){let l,f,p,b,_;if(sS(r)){let s=r.getAttribute("action");f=s?Mf(s,u):null,l=r.getAttribute("method")||dx,p=dy(r.getAttribute("enctype"))||px,b=new FormData(r)}else if(iS(r)||oS(r)&&(r.type==="submit"||r.type==="image")){let s=r.form;if(s==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let C=r.getAttribute("formaction")||s.getAttribute("action");if(f=C?Mf(C,u):null,l=r.getAttribute("formmethod")||s.getAttribute("method")||dx,p=dy(r.getAttribute("formenctype"))||dy(s.getAttribute("enctype"))||px,b=new FormData(s,r),!uS()){let{name:M,type:D,value:B}=r;if(D==="image"){let U=M?`${M}.`:"";b.append(`${U}x`,"0"),b.append(`${U}y`,"0")}else M&&b.append(M,B)}}else{if(zx(r))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');l=dx,f=null,p=px,_=r}return b&&p==="text/plain"&&(_=b,b=void 0),{action:f,method:l.toLowerCase(),encType:p,formData:b,body:_}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Qy(r,u){if(r===!1||r===null||typeof r>"u")throw new Error(u)}function dS(r,u,l,f){let p=typeof r=="string"?new URL(r,typeof window>"u"?"server://singlefetch/":window.location.origin):r;return l?p.pathname.endsWith("/")?p.pathname=`${p.pathname}_.${f}`:p.pathname=`${p.pathname}.${f}`:p.pathname==="/"?p.pathname=`_root.${f}`:u&&Mf(p.pathname,u)==="/"?p.pathname=`${u.replace(/\/$/,"")}/_root.${f}`:p.pathname=`${p.pathname.replace(/\/$/,"")}.${f}`,p}async function pS(r,u){if(r.id in u)return u[r.id];try{let l=await import(r.module);return u[r.id]=l,l}catch(l){return console.error(`Error loading route module \`${r.module}\`, reloading page...`),console.error(l),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function mS(r){return r==null?!1:r.href==null?r.rel==="preload"&&typeof r.imageSrcSet=="string"&&typeof r.imageSizes=="string":typeof r.rel=="string"&&typeof r.href=="string"}async function gS(r,u,l){let f=await Promise.all(r.map(async p=>{let b=u.routes[p.route.id];if(b){let _=await pS(b,l);return _.links?_.links():[]}return[]}));return vS(f.flat(1).filter(mS).filter(p=>p.rel==="stylesheet"||p.rel==="preload").map(p=>p.rel==="stylesheet"?{...p,rel:"prefetch",as:"style"}:{...p,rel:"prefetch"}))}function av(r,u,l,f,p,b){let _=(C,M)=>l[M]?C.route.id!==l[M].route.id:!0,s=(C,M)=>l[M].pathname!==C.pathname||l[M].route.path?.endsWith("*")&&l[M].params["*"]!==C.params["*"];return b==="assets"?u.filter((C,M)=>_(C,M)||s(C,M)):b==="data"?u.filter((C,M)=>{let D=f.routes[C.route.id];if(!D||!D.hasLoader)return!1;if(_(C,M)||s(C,M))return!0;if(C.route.shouldRevalidate){let B=C.route.shouldRevalidate({currentUrl:new URL(p.pathname+p.search+p.hash,window.origin),currentParams:l[0]?.params||{},nextUrl:new URL(r,window.origin),nextParams:C.params,defaultShouldRevalidate:!0});if(typeof B=="boolean")return B}return!0}):[]}function _S(r,u,{includeHydrateFallback:l}={}){return xS(r.map(f=>{let p=u.routes[f.route.id];if(!p)return[];let b=[p.module];return p.clientActionModule&&(b=b.concat(p.clientActionModule)),p.clientLoaderModule&&(b=b.concat(p.clientLoaderModule)),l&&p.hydrateFallbackModule&&(b=b.concat(p.hydrateFallbackModule)),p.imports&&(b=b.concat(p.imports)),b}).flat(1))}function xS(r){return[...new Set(r)]}function yS(r){let u={},l=Object.keys(r).sort();for(let f of l)u[f]=r[f];return u}function vS(r,u){let l=new Set;return new Set(u),r.reduce((f,p)=>{let b=JSON.stringify(yS(p));return l.has(b)||(l.add(b),f.push({key:b,link:p})),f},[])}function Nb(){let r=ke.useContext(em);return Qy(r,"You must render this element inside a <DataRouterContext.Provider> element"),r}function bS(){let r=ke.useContext(Lx);return Qy(r,"You must render this element inside a <DataRouterStateContext.Provider> element"),r}var e1=ke.createContext(void 0);e1.displayName="FrameworkContext";function jb(){let r=ke.useContext(e1);return Qy(r,"You must render this element inside a <HydratedRouter> element"),r}function wS(r,u){let l=ke.useContext(e1),[f,p]=ke.useState(!1),[b,_]=ke.useState(!1),{onFocus:s,onBlur:C,onMouseEnter:M,onMouseLeave:D,onTouchStart:B}=u,U=ke.useRef(null);ke.useEffect(()=>{if(r==="render"&&_(!0),r==="viewport"){let z=Z=>{Z.forEach(Y=>{_(Y.isIntersecting)})},N=new IntersectionObserver(z,{threshold:.5});return U.current&&N.observe(U.current),()=>{N.disconnect()}}},[r]),ke.useEffect(()=>{if(f){let z=setTimeout(()=>{_(!0)},100);return()=>{clearTimeout(z)}}},[f]);let j=()=>{p(!0)},H=()=>{p(!1),_(!1)};return l?r!=="intent"?[b,U,{}]:[b,U,{onFocus:ug(s,j),onBlur:ug(C,H),onMouseEnter:ug(M,j),onMouseLeave:ug(D,H),onTouchStart:ug(B,j)}]:[!1,U,{}]}function ug(r,u){return l=>{r&&r(l),l.defaultPrevented||u(l)}}function TS({page:r,...u}){let{router:l}=Nb(),f=ke.useMemo(()=>Sb(l.routes,r,l.basename),[l.routes,r,l.basename]);return f?ke.createElement(ES,{page:r,matches:f,...u}):null}function SS(r){let{manifest:u,routeModules:l}=jb(),[f,p]=ke.useState([]);return ke.useEffect(()=>{let b=!1;return gS(r,u,l).then(_=>{b||p(_)}),()=>{b=!0}},[r,u,l]),f}function ES({page:r,matches:u,...l}){let f=kp(),{future:p,manifest:b,routeModules:_}=jb(),{basename:s}=Nb(),{loaderData:C,matches:M}=bS(),D=ke.useMemo(()=>av(r,u,M,b,f,"data"),[r,u,M,b,f]),B=ke.useMemo(()=>av(r,u,M,b,f,"assets"),[r,u,M,b,f]),U=ke.useMemo(()=>{if(r===f.pathname+f.search+f.hash)return[];let z=new Set,N=!1;if(u.forEach(Y=>{let W=b.routes[Y.route.id];!W||!W.hasLoader||(!D.some(de=>de.route.id===Y.route.id)&&Y.route.id in C&&_[Y.route.id]?.shouldRevalidate||W.hasClientLoader?N=!0:z.add(Y.route.id))}),z.size===0)return[];let Z=dS(r,s,p.unstable_trailingSlashAwareDataRequests,"data");return N&&z.size>0&&Z.searchParams.set("_routes",u.filter(Y=>z.has(Y.route.id)).map(Y=>Y.route.id).join(",")),[Z.pathname+Z.search]},[s,p.unstable_trailingSlashAwareDataRequests,C,f,b,D,u,r,_]),j=ke.useMemo(()=>_S(B,b),[B,b]),H=SS(B);return ke.createElement(ke.Fragment,null,U.map(z=>ke.createElement("link",{key:z,rel:"prefetch",as:"fetch",href:z,...l})),j.map(z=>ke.createElement("link",{key:z,rel:"modulepreload",href:z,...l})),H.map(({key:z,link:N})=>ke.createElement("link",{key:z,nonce:l.nonce,...N,crossOrigin:N.crossOrigin??l.crossOrigin})))}function AS(...r){return u=>{r.forEach(l=>{typeof l=="function"?l(u):l!=null&&(l.current=u)})}}var kS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{kS&&(window.__reactRouterVersion="7.13.0")}catch{}function CS({basename:r,children:u,unstable_useTransitions:l,window:f}){let p=ke.useRef();p.current==null&&(p.current=oT({window:f,v5Compat:!0}));let b=p.current,[_,s]=ke.useState({action:b.action,location:b.location}),C=ke.useCallback(M=>{l===!1?s(M):ke.startTransition(()=>s(M))},[l]);return ke.useLayoutEffect(()=>b.listen(C),[b,C]),ke.createElement(nS,{basename:r,children:u,location:_.location,navigationType:_.action,navigator:b,unstable_useTransitions:l})}var Ub=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,V0=ke.forwardRef(function({onClick:u,discover:l="render",prefetch:f="none",relative:p,reloadDocument:b,replace:_,state:s,target:C,to:M,preventScrollReset:D,viewTransition:B,unstable_defaultShouldRevalidate:U,...j},H){let{basename:z,unstable_useTransitions:N}=ke.useContext(cu),Z=typeof M=="string"&&Ub.test(M),Y=Db(M,z);M=Y.to;let W=UT(M,{relative:p}),[de,ge,ve]=wS(f,j),ie=IS(M,{replace:_,state:s,target:C,preventScrollReset:D,relative:p,viewTransition:B,unstable_defaultShouldRevalidate:U,unstable_useTransitions:N});function Me(Ge){u&&u(Ge),Ge.defaultPrevented||ie(Ge)}let we=ke.createElement("a",{...j,...ve,href:Y.absoluteURL||W,onClick:Y.isExternal||b?u:Me,ref:AS(H,ge),target:C,"data-discover":!Z&&l==="render"?"true":void 0});return de&&!Z?ke.createElement(ke.Fragment,null,we,ke.createElement(TS,{page:W})):we});V0.displayName="Link";var MS=ke.forwardRef(function({"aria-current":u="page",caseSensitive:l=!1,className:f="",end:p=!1,style:b,to:_,viewTransition:s,children:C,...M},D){let B=Vg(_,{relative:M.relative}),U=kp(),j=ke.useContext(Lx),{navigator:H,basename:z}=ke.useContext(cu),N=j!=null&&OS(B)&&s===!0,Z=H.encodeLocation?H.encodeLocation(B).pathname:B.pathname,Y=U.pathname,W=j&&j.navigation&&j.navigation.location?j.navigation.location.pathname:null;l||(Y=Y.toLowerCase(),W=W?W.toLowerCase():null,Z=Z.toLowerCase()),W&&z&&(W=Mf(W,z)||W);const de=Z!=="/"&&Z.endsWith("/")?Z.length-1:Z.length;let ge=Y===Z||!p&&Y.startsWith(Z)&&Y.charAt(de)==="/",ve=W!=null&&(W===Z||!p&&W.startsWith(Z)&&W.charAt(Z.length)==="/"),ie={isActive:ge,isPending:ve,isTransitioning:N},Me=ge?u:void 0,we;typeof f=="function"?we=f(ie):we=[f,ge?"active":null,ve?"pending":null,N?"transitioning":null].filter(Boolean).join(" ");let Ge=typeof b=="function"?b(ie):b;return ke.createElement(V0,{...M,"aria-current":Me,className:we,ref:D,style:Ge,to:_,viewTransition:s},typeof C=="function"?C(ie):C)});MS.displayName="NavLink";var DS=ke.forwardRef(({discover:r="render",fetcherKey:u,navigate:l,reloadDocument:f,replace:p,state:b,method:_=dx,action:s,onSubmit:C,relative:M,preventScrollReset:D,viewTransition:B,unstable_defaultShouldRevalidate:U,...j},H)=>{let{unstable_useTransitions:z}=ke.useContext(cu),N=LS(),Z=zS(s,{relative:M}),Y=_.toLowerCase()==="get"?"get":"post",W=typeof s=="string"&&Ub.test(s),de=ge=>{if(C&&C(ge),ge.defaultPrevented)return;ge.preventDefault();let ve=ge.nativeEvent.submitter,ie=ve?.getAttribute("formmethod")||_,Me=()=>N(ve||ge.currentTarget,{fetcherKey:u,method:ie,navigate:l,replace:p,state:b,relative:M,preventScrollReset:D,viewTransition:B,unstable_defaultShouldRevalidate:U});z&&l!==!1?ke.startTransition(()=>Me()):Me()};return ke.createElement("form",{ref:H,method:Y,action:Z,onSubmit:f?C:de,...j,"data-discover":!W&&r==="render"?"true":void 0})});DS.displayName="Form";function RS(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Vb(r){let u=ke.useContext(em);return Di(u,RS(r)),u}function IS(r,{target:u,replace:l,state:f,preventScrollReset:p,relative:b,viewTransition:_,unstable_defaultShouldRevalidate:s,unstable_useTransitions:C}={}){let M=VT(),D=kp(),B=Vg(r,{relative:b});return ke.useCallback(U=>{if(cS(U,u)){U.preventDefault();let j=l!==void 0?l:Dg(D)===Dg(B),H=()=>M(r,{replace:j,state:f,preventScrollReset:p,relative:b,viewTransition:_,unstable_defaultShouldRevalidate:s});C?ke.startTransition(()=>H()):H()}},[D,M,B,l,f,u,r,p,b,_,s,C])}var PS=0,FS=()=>`__${String(++PS)}__`;function LS(){let{router:r}=Vb("useSubmit"),{basename:u}=ke.useContext(cu),l=QT(),f=r.fetch,p=r.navigate;return ke.useCallback(async(b,_={})=>{let{action:s,method:C,encType:M,formData:D,body:B}=fS(b,u);if(_.navigate===!1){let U=_.fetcherKey||FS();await f(U,l,_.action||s,{unstable_defaultShouldRevalidate:_.unstable_defaultShouldRevalidate,preventScrollReset:_.preventScrollReset,formData:D,body:B,formMethod:_.method||C,formEncType:_.encType||M,flushSync:_.flushSync})}else await p(_.action||s,{unstable_defaultShouldRevalidate:_.unstable_defaultShouldRevalidate,preventScrollReset:_.preventScrollReset,formData:D,body:B,formMethod:_.method||C,formEncType:_.encType||M,replace:_.replace,state:_.state,fromRouteId:l,flushSync:_.flushSync,viewTransition:_.viewTransition})},[f,p,u,l])}function zS(r,{relative:u}={}){let{basename:l}=ke.useContext(cu),f=ke.useContext(Rf);Di(f,"useFormAction must be used inside a RouteContext");let[p]=f.matches.slice(-1),b={...Vg(r||".",{relative:u})},_=kp();if(r==null){b.search=_.search;let s=new URLSearchParams(b.search),C=s.getAll("index");if(C.some(D=>D==="")){s.delete("index"),C.filter(B=>B).forEach(B=>s.append("index",B));let D=s.toString();b.search=D?`?${D}`:""}}return(!r||r===".")&&p.route.index&&(b.search=b.search?b.search.replace(/^\?/,"?index&"):"?index"),l!=="/"&&(b.pathname=b.pathname==="/"?l:Af([l,b.pathname])),Dg(b)}function OS(r,{relative:u}={}){let l=ke.useContext(Ib);Di(l!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:f}=Vb("useViewTransitionState"),p=Vg(r,{relative:u});if(!l.isTransitioning)return!1;let b=Mf(l.currentLocation.pathname,f)||l.currentLocation.pathname,_=Mf(l.nextLocation.pathname,f)||l.nextLocation.pathname;return yx(p.pathname,_)!=null||yx(p.pathname,b)!=null}var Gb=1252,BS=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],t1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},r1=function(r){BS.indexOf(r)!=-1&&(Gb=t1[0]=r)};function NS(){r1(1252)}var rh=function(r){r1(r)};function Hb(){rh(1200),NS()}function iv(r){for(var u=[],l=0,f=r.length;l<f;++l)u[l]=r.charCodeAt(l);return u}function jS(r){for(var u=[],l=0;l<r.length>>1;++l)u[l]=String.fromCharCode(r.charCodeAt(2*l)+(r.charCodeAt(2*l+1)<<8));return u.join("")}function qb(r){for(var u=[],l=0;l<r.length>>1;++l)u[l]=String.fromCharCode(r.charCodeAt(2*l+1)+(r.charCodeAt(2*l)<<8));return u.join("")}var pg=function(r){var u=r.charCodeAt(0),l=r.charCodeAt(1);return u==255&&l==254?jS(r.slice(2)):u==254&&l==255?qb(r.slice(2)):u==65279?r.slice(1):r},K_=function(u){return String.fromCharCode(u)},sv=function(u){return String.fromCharCode(u)},Rg,yd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ov(r){for(var u="",l=0,f=0,p=0,b=0,_=0,s=0,C=0,M=0;M<r.length;)l=r.charCodeAt(M++),b=l>>2,f=r.charCodeAt(M++),_=(l&3)<<4|f>>4,p=r.charCodeAt(M++),s=(f&15)<<2|p>>6,C=p&63,isNaN(f)?s=C=64:isNaN(p)&&(C=64),u+=yd.charAt(b)+yd.charAt(_)+yd.charAt(s)+yd.charAt(C);return u}function Ic(r){var u="",l=0,f=0,p=0,b=0,_=0,s=0,C=0;r=r.replace(/[^\w\+\/\=]/g,"");for(var M=0;M<r.length;)b=yd.indexOf(r.charAt(M++)),_=yd.indexOf(r.charAt(M++)),l=b<<2|_>>4,u+=String.fromCharCode(l),s=yd.indexOf(r.charAt(M++)),f=(_&15)<<4|s>>2,s!==64&&(u+=String.fromCharCode(f)),C=yd.indexOf(r.charAt(M++)),p=(s&3)<<6|C,C!==64&&(u+=String.fromCharCode(p));return u}var ta=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Cp=(function(){if(typeof Buffer<"u"){var r=!Buffer.from;if(!r)try{Buffer.from("foo","utf8")}catch{r=!0}return r?function(u,l){return l?new Buffer(u,l):new Buffer(u)}:Buffer.from.bind(Buffer)}return function(){}})();function Td(r){return ta?Buffer.alloc?Buffer.alloc(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}function lv(r){return ta?Buffer.allocUnsafe?Buffer.allocUnsafe(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}var eh=function(u){return ta?Cp(u,"binary"):u.split("").map(function(l){return l.charCodeAt(0)&255})};function Mp(r){if(Array.isArray(r))return r.map(function(f){return String.fromCharCode(f)}).join("");for(var u=[],l=0;l<r.length;++l)u[l]=String.fromCharCode(r[l]);return u.join("")}function n1(r){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(r instanceof ArrayBuffer)return n1(new Uint8Array(r));for(var u=new Array(r.length),l=0;l<r.length;++l)u[l]=r[l];return u}var gd=ta?function(r){return Buffer.concat(r.map(function(u){return Buffer.isBuffer(u)?u:Cp(u)}))}:function(r){if(typeof Uint8Array<"u"){var u=0,l=0;for(u=0;u<r.length;++u)l+=r[u].length;var f=new Uint8Array(l),p=0;for(u=0,l=0;u<r.length;l+=p,++u)if(p=r[u].length,r[u]instanceof Uint8Array)f.set(r[u],l);else{if(typeof r[u]=="string")throw"wtf";f.set(new Uint8Array(r[u]),l)}return f}return[].concat.apply([],r.map(function(b){return Array.isArray(b)?b:[].slice.call(b)}))};function US(r){for(var u=[],l=0,f=r.length+250,p=Td(r.length+255),b=0;b<r.length;++b){var _=r.charCodeAt(b);if(_<128)p[l++]=_;else if(_<2048)p[l++]=192|_>>6&31,p[l++]=128|_&63;else if(_>=55296&&_<57344){_=(_&1023)+64;var s=r.charCodeAt(++b)&1023;p[l++]=240|_>>8&7,p[l++]=128|_>>2&63,p[l++]=128|s>>6&15|(_&3)<<4,p[l++]=128|s&63}else p[l++]=224|_>>12&15,p[l++]=128|_>>6&63,p[l++]=128|_&63;l>f&&(u.push(p.slice(0,l)),l=0,p=Td(65535),f=65530)}return u.push(p.slice(0,l)),gd(u)}var wl=/\u0000/g,mg=/[\u0001-\u0006]/g;function q0(r){for(var u="",l=r.length-1;l>=0;)u+=r.charAt(l--);return u}function nh(r,u){var l=""+r;return l.length>=u?l:$i("0",u-l.length)+l}function a1(r,u){var l=""+r;return l.length>=u?l:$i(" ",u-l.length)+l}function vx(r,u){var l=""+r;return l.length>=u?l:l+$i(" ",u-l.length)}function VS(r,u){var l=""+Math.round(r);return l.length>=u?l:$i("0",u-l.length)+l}function GS(r,u){var l=""+r;return l.length>=u?l:$i("0",u-l.length)+l}var cv=Math.pow(2,32);function O0(r,u){if(r>cv||r<-cv)return VS(r,u);var l=Math.round(r);return GS(l,u)}function bx(r,u){return u=u||0,r.length>=7+u&&(r.charCodeAt(u)|32)===103&&(r.charCodeAt(u+1)|32)===101&&(r.charCodeAt(u+2)|32)===110&&(r.charCodeAt(u+3)|32)===101&&(r.charCodeAt(u+4)|32)===114&&(r.charCodeAt(u+5)|32)===97&&(r.charCodeAt(u+6)|32)===108}var uv=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],py=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function HS(r){return r||(r={}),r[0]="General",r[1]="0",r[2]="0.00",r[3]="#,##0",r[4]="#,##0.00",r[9]="0%",r[10]="0.00%",r[11]="0.00E+00",r[12]="# ?/?",r[13]="# ??/??",r[14]="m/d/yy",r[15]="d-mmm-yy",r[16]="d-mmm",r[17]="mmm-yy",r[18]="h:mm AM/PM",r[19]="h:mm:ss AM/PM",r[20]="h:mm",r[21]="h:mm:ss",r[22]="m/d/yy h:mm",r[37]="#,##0 ;(#,##0)",r[38]="#,##0 ;[Red](#,##0)",r[39]="#,##0.00;(#,##0.00)",r[40]="#,##0.00;[Red](#,##0.00)",r[45]="mm:ss",r[46]="[h]:mm:ss",r[47]="mmss.0",r[48]="##0.0E+0",r[49]="@",r[56]='"/ "hh""mm""ss" "',r}var Pn={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},hv={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},qS={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function wx(r,u,l){for(var f=r<0?-1:1,p=r*f,b=0,_=1,s=0,C=1,M=0,D=0,B=Math.floor(p);M<u&&(B=Math.floor(p),s=B*_+b,D=B*M+C,!(p-B<5e-8));)p=1/(p-B),b=_,_=s,C=M,M=D;if(D>u&&(M>u?(D=C,s=b):(D=M,s=_)),!l)return[0,f*s,D];var U=Math.floor(f*s/D);return[U,f*s-U*D,D]}function bp(r,u,l){if(r>2958465||r<0)return null;var f=r|0,p=Math.floor(86400*(r-f)),b=0,_=[],s={D:f,T:p,u:86400*(r-f)-p,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(s.u)<1e-6&&(s.u=0),u&&u.date1904&&(f+=1462),s.u>.9999&&(s.u=0,++p==86400&&(s.T=p=0,++f,++s.D)),f===60)_=l?[1317,10,29]:[1900,2,29],b=3;else if(f===0)_=l?[1317,8,29]:[1900,1,0],b=6;else{f>60&&--f;var C=new Date(1900,0,1);C.setDate(C.getDate()+f-1),_=[C.getFullYear(),C.getMonth()+1,C.getDate()],b=C.getDay(),f<60&&(b=(b+6)%7),l&&(b=KS(C,_))}return s.y=_[0],s.m=_[1],s.d=_[2],s.S=p%60,p=Math.floor(p/60),s.M=p%60,p=Math.floor(p/60),s.H=p,s.q=b,s}var Zb=new Date(1899,11,31,0,0,0),ZS=Zb.getTime(),WS=new Date(1900,2,1,0,0,0);function Wb(r,u){var l=r.getTime();return u?l-=1461*24*60*60*1e3:r>=WS&&(l+=1440*60*1e3),(l-(ZS+(r.getTimezoneOffset()-Zb.getTimezoneOffset())*6e4))/(1440*60*1e3)}function i1(r){return r.indexOf(".")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function $S(r){return r.indexOf("E")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function XS(r){var u=r<0?12:11,l=i1(r.toFixed(12));return l.length<=u||(l=r.toPrecision(10),l.length<=u)?l:r.toExponential(5)}function YS(r){var u=i1(r.toFixed(11));return u.length>(r<0?12:11)||u==="0"||u==="-0"?r.toPrecision(6):u}function Ig(r){var u=Math.floor(Math.log(Math.abs(r))*Math.LOG10E),l;return u>=-4&&u<=-1?l=r.toPrecision(10+u):Math.abs(u)<=9?l=XS(r):u===10?l=r.toFixed(10).substr(0,12):l=YS(r),i1($S(l.toUpperCase()))}function Sp(r,u){switch(typeof r){case"string":return r;case"boolean":return r?"TRUE":"FALSE";case"number":return(r|0)===r?r.toString(10):Ig(r);case"undefined":return"";case"object":if(r==null)return"";if(r instanceof Date)return lu(14,Wb(r,u&&u.date1904),u)}throw new Error("unsupported value in General format: "+r)}function KS(r,u){u[0]-=581;var l=r.getDay();return r<60&&(l=(l+6)%7),l}function JS(r,u,l,f){var p="",b=0,_=0,s=l.y,C,M=0;switch(r){case 98:s=l.y+543;case 121:switch(u.length){case 1:case 2:C=s%100,M=2;break;default:C=s%1e4,M=4;break}break;case 109:switch(u.length){case 1:case 2:C=l.m,M=u.length;break;case 3:return py[l.m-1][1];case 5:return py[l.m-1][0];default:return py[l.m-1][2]}break;case 100:switch(u.length){case 1:case 2:C=l.d,M=u.length;break;case 3:return uv[l.q][0];default:return uv[l.q][1]}break;case 104:switch(u.length){case 1:case 2:C=1+(l.H+11)%12,M=u.length;break;default:throw"bad hour format: "+u}break;case 72:switch(u.length){case 1:case 2:C=l.H,M=u.length;break;default:throw"bad hour format: "+u}break;case 77:switch(u.length){case 1:case 2:C=l.M,M=u.length;break;default:throw"bad minute format: "+u}break;case 115:if(u!="s"&&u!="ss"&&u!=".0"&&u!=".00"&&u!=".000")throw"bad second format: "+u;return l.u===0&&(u=="s"||u=="ss")?nh(l.S,u.length):(f>=2?_=f===3?1e3:100:_=f===1?10:1,b=Math.round(_*(l.S+l.u)),b>=60*_&&(b=0),u==="s"?b===0?"0":""+b/_:(p=nh(b,2+f),u==="ss"?p.substr(0,2):"."+p.substr(2,u.length-1)));case 90:switch(u){case"[h]":case"[hh]":C=l.D*24+l.H;break;case"[m]":case"[mm]":C=(l.D*24+l.H)*60+l.M;break;case"[s]":case"[ss]":C=((l.D*24+l.H)*60+l.M)*60+Math.round(l.S+l.u);break;default:throw"bad abstime format: "+u}M=u.length===3?1:2;break;case 101:C=s,M=1;break}var D=M>0?nh(C,M):"";return D}function vd(r){var u=3;if(r.length<=u)return r;for(var l=r.length%u,f=r.substr(0,l);l!=r.length;l+=u)f+=(f.length>0?",":"")+r.substr(l,u);return f}var $b=/%/g;function QS(r,u,l){var f=u.replace($b,""),p=u.length-f.length;return kf(r,f,l*Math.pow(10,2*p))+$i("%",p)}function eE(r,u,l){for(var f=u.length-1;u.charCodeAt(f-1)===44;)--f;return kf(r,u.substr(0,f),l/Math.pow(10,3*(u.length-f)))}function Xb(r,u){var l,f=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(u==0)return"0.0E+0";if(u<0)return"-"+Xb(r,-u);var p=r.indexOf(".");p===-1&&(p=r.indexOf("E"));var b=Math.floor(Math.log(u)*Math.LOG10E)%p;if(b<0&&(b+=p),l=(u/Math.pow(10,b)).toPrecision(f+1+(p+b)%p),l.indexOf("e")===-1){var _=Math.floor(Math.log(u)*Math.LOG10E);for(l.indexOf(".")===-1?l=l.charAt(0)+"."+l.substr(1)+"E+"+(_-l.length+b):l+="E+"+(_-b);l.substr(0,2)==="0.";)l=l.charAt(0)+l.substr(2,p)+"."+l.substr(2+p),l=l.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");l=l.replace(/\+-/,"-")}l=l.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(s,C,M,D){return C+M+D.substr(0,(p+b)%p)+"."+D.substr(b)+"E"})}else l=u.toExponential(f);return r.match(/E\+00$/)&&l.match(/e[+-]\d$/)&&(l=l.substr(0,l.length-1)+"0"+l.charAt(l.length-1)),r.match(/E\-/)&&l.match(/e\+/)&&(l=l.replace(/e\+/,"e")),l.replace("e","E")}var Yb=/# (\?+)( ?)\/( ?)(\d+)/;function tE(r,u,l){var f=parseInt(r[4],10),p=Math.round(u*f),b=Math.floor(p/f),_=p-b*f,s=f;return l+(b===0?"":""+b)+" "+(_===0?$i(" ",r[1].length+1+r[4].length):a1(_,r[1].length)+r[2]+"/"+r[3]+nh(s,r[4].length))}function rE(r,u,l){return l+(u===0?"":""+u)+$i(" ",r[1].length+2+r[4].length)}var Kb=/^#*0*\.([0#]+)/,Jb=/\).*[0#]/,Qb=/\(###\) ###\\?-####/;function yl(r){for(var u="",l,f=0;f!=r.length;++f)switch(l=r.charCodeAt(f)){case 35:break;case 63:u+=" ";break;case 48:u+="0";break;default:u+=String.fromCharCode(l)}return u}function fv(r,u){var l=Math.pow(10,u);return""+Math.round(r*l)/l}function dv(r,u){var l=r-Math.floor(r),f=Math.pow(10,u);return u<(""+Math.round(l*f)).length?0:Math.round(l*f)}function nE(r,u){return u<(""+Math.round((r-Math.floor(r))*Math.pow(10,u))).length?1:0}function aE(r){return r<2147483647&&r>-2147483648?""+(r>=0?r|0:r-1|0):""+Math.floor(r)}function iu(r,u,l){if(r.charCodeAt(0)===40&&!u.match(Jb)){var f=u.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return l>=0?iu("n",f,l):"("+iu("n",f,-l)+")"}if(u.charCodeAt(u.length-1)===44)return eE(r,u,l);if(u.indexOf("%")!==-1)return QS(r,u,l);if(u.indexOf("E")!==-1)return Xb(u,l);if(u.charCodeAt(0)===36)return"$"+iu(r,u.substr(u.charAt(1)==" "?2:1),l);var p,b,_,s,C=Math.abs(l),M=l<0?"-":"";if(u.match(/^00+$/))return M+O0(C,u.length);if(u.match(/^[#?]+$/))return p=O0(l,0),p==="0"&&(p=""),p.length>u.length?p:yl(u.substr(0,u.length-p.length))+p;if(b=u.match(Yb))return tE(b,C,M);if(u.match(/^#+0+$/))return M+O0(C,u.length-u.indexOf("0"));if(b=u.match(Kb))return p=fv(l,b[1].length).replace(/^([^\.]+)$/,"$1."+yl(b[1])).replace(/\.$/,"."+yl(b[1])).replace(/\.(\d*)$/,function(H,z){return"."+z+$i("0",yl(b[1]).length-z.length)}),u.indexOf("0.")!==-1?p:p.replace(/^0\./,".");if(u=u.replace(/^#+([0.])/,"$1"),b=u.match(/^(0*)\.(#*)$/))return M+fv(C,b[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,b[1].length?"0.":".");if(b=u.match(/^#{1,3},##0(\.?)$/))return M+vd(O0(C,0));if(b=u.match(/^#,##0\.([#0]*0)$/))return l<0?"-"+iu(r,u,-l):vd(""+(Math.floor(l)+nE(l,b[1].length)))+"."+nh(dv(l,b[1].length),b[1].length);if(b=u.match(/^#,#*,#0/))return iu(r,u.replace(/^#,#*,/,""),l);if(b=u.match(/^([0#]+)(\\?-([0#]+))+$/))return p=q0(iu(r,u.replace(/[\\-]/g,""),l)),_=0,q0(q0(u.replace(/\\/g,"")).replace(/[0#]/g,function(H){return _<p.length?p.charAt(_++):H==="0"?"0":""}));if(u.match(Qb))return p=iu(r,"##########",l),"("+p.substr(0,3)+") "+p.substr(3,3)+"-"+p.substr(6);var D="";if(b=u.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return _=Math.min(b[4].length,7),s=wx(C,Math.pow(10,_)-1,!1),p=""+M,D=kf("n",b[1],s[1]),D.charAt(D.length-1)==" "&&(D=D.substr(0,D.length-1)+"0"),p+=D+b[2]+"/"+b[3],D=vx(s[2],_),D.length<b[4].length&&(D=yl(b[4].substr(b[4].length-D.length))+D),p+=D,p;if(b=u.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return _=Math.min(Math.max(b[1].length,b[4].length),7),s=wx(C,Math.pow(10,_)-1,!0),M+(s[0]||(s[1]?"":"0"))+" "+(s[1]?a1(s[1],_)+b[2]+"/"+b[3]+vx(s[2],_):$i(" ",2*_+1+b[2].length+b[3].length));if(b=u.match(/^[#0?]+$/))return p=O0(l,0),u.length<=p.length?p:yl(u.substr(0,u.length-p.length))+p;if(b=u.match(/^([#0?]+)\.([#0]+)$/)){p=""+l.toFixed(Math.min(b[2].length,10)).replace(/([^0])0+$/,"$1"),_=p.indexOf(".");var B=u.indexOf(".")-_,U=u.length-p.length-B;return yl(u.substr(0,B)+p+u.substr(u.length-U))}if(b=u.match(/^00,000\.([#0]*0)$/))return _=dv(l,b[1].length),l<0?"-"+iu(r,u,-l):vd(aE(l)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(H){return"00,"+(H.length<3?nh(0,3-H.length):"")+H})+"."+nh(_,b[1].length);switch(u){case"###,##0.00":return iu(r,"#,##0.00",l);case"###,###":case"##,###":case"#,###":var j=vd(O0(C,0));return j!=="0"?M+j:"";case"###,###.00":return iu(r,"###,##0.00",l).replace(/^0\./,".");case"#,###.00":return iu(r,"#,##0.00",l).replace(/^0\./,".")}throw new Error("unsupported format |"+u+"|")}function iE(r,u,l){for(var f=u.length-1;u.charCodeAt(f-1)===44;)--f;return kf(r,u.substr(0,f),l/Math.pow(10,3*(u.length-f)))}function sE(r,u,l){var f=u.replace($b,""),p=u.length-f.length;return kf(r,f,l*Math.pow(10,2*p))+$i("%",p)}function e2(r,u){var l,f=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(u==0)return"0.0E+0";if(u<0)return"-"+e2(r,-u);var p=r.indexOf(".");p===-1&&(p=r.indexOf("E"));var b=Math.floor(Math.log(u)*Math.LOG10E)%p;if(b<0&&(b+=p),l=(u/Math.pow(10,b)).toPrecision(f+1+(p+b)%p),!l.match(/[Ee]/)){var _=Math.floor(Math.log(u)*Math.LOG10E);l.indexOf(".")===-1?l=l.charAt(0)+"."+l.substr(1)+"E+"+(_-l.length+b):l+="E+"+(_-b),l=l.replace(/\+-/,"-")}l=l.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(s,C,M,D){return C+M+D.substr(0,(p+b)%p)+"."+D.substr(b)+"E"})}else l=u.toExponential(f);return r.match(/E\+00$/)&&l.match(/e[+-]\d$/)&&(l=l.substr(0,l.length-1)+"0"+l.charAt(l.length-1)),r.match(/E\-/)&&l.match(/e\+/)&&(l=l.replace(/e\+/,"e")),l.replace("e","E")}function jh(r,u,l){if(r.charCodeAt(0)===40&&!u.match(Jb)){var f=u.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return l>=0?jh("n",f,l):"("+jh("n",f,-l)+")"}if(u.charCodeAt(u.length-1)===44)return iE(r,u,l);if(u.indexOf("%")!==-1)return sE(r,u,l);if(u.indexOf("E")!==-1)return e2(u,l);if(u.charCodeAt(0)===36)return"$"+jh(r,u.substr(u.charAt(1)==" "?2:1),l);var p,b,_,s,C=Math.abs(l),M=l<0?"-":"";if(u.match(/^00+$/))return M+nh(C,u.length);if(u.match(/^[#?]+$/))return p=""+l,l===0&&(p=""),p.length>u.length?p:yl(u.substr(0,u.length-p.length))+p;if(b=u.match(Yb))return rE(b,C,M);if(u.match(/^#+0+$/))return M+nh(C,u.length-u.indexOf("0"));if(b=u.match(Kb))return p=(""+l).replace(/^([^\.]+)$/,"$1."+yl(b[1])).replace(/\.$/,"."+yl(b[1])),p=p.replace(/\.(\d*)$/,function(H,z){return"."+z+$i("0",yl(b[1]).length-z.length)}),u.indexOf("0.")!==-1?p:p.replace(/^0\./,".");if(u=u.replace(/^#+([0.])/,"$1"),b=u.match(/^(0*)\.(#*)$/))return M+(""+C).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,b[1].length?"0.":".");if(b=u.match(/^#{1,3},##0(\.?)$/))return M+vd(""+C);if(b=u.match(/^#,##0\.([#0]*0)$/))return l<0?"-"+jh(r,u,-l):vd(""+l)+"."+$i("0",b[1].length);if(b=u.match(/^#,#*,#0/))return jh(r,u.replace(/^#,#*,/,""),l);if(b=u.match(/^([0#]+)(\\?-([0#]+))+$/))return p=q0(jh(r,u.replace(/[\\-]/g,""),l)),_=0,q0(q0(u.replace(/\\/g,"")).replace(/[0#]/g,function(H){return _<p.length?p.charAt(_++):H==="0"?"0":""}));if(u.match(Qb))return p=jh(r,"##########",l),"("+p.substr(0,3)+") "+p.substr(3,3)+"-"+p.substr(6);var D="";if(b=u.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return _=Math.min(b[4].length,7),s=wx(C,Math.pow(10,_)-1,!1),p=""+M,D=kf("n",b[1],s[1]),D.charAt(D.length-1)==" "&&(D=D.substr(0,D.length-1)+"0"),p+=D+b[2]+"/"+b[3],D=vx(s[2],_),D.length<b[4].length&&(D=yl(b[4].substr(b[4].length-D.length))+D),p+=D,p;if(b=u.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return _=Math.min(Math.max(b[1].length,b[4].length),7),s=wx(C,Math.pow(10,_)-1,!0),M+(s[0]||(s[1]?"":"0"))+" "+(s[1]?a1(s[1],_)+b[2]+"/"+b[3]+vx(s[2],_):$i(" ",2*_+1+b[2].length+b[3].length));if(b=u.match(/^[#0?]+$/))return p=""+l,u.length<=p.length?p:yl(u.substr(0,u.length-p.length))+p;if(b=u.match(/^([#0]+)\.([#0]+)$/)){p=""+l.toFixed(Math.min(b[2].length,10)).replace(/([^0])0+$/,"$1"),_=p.indexOf(".");var B=u.indexOf(".")-_,U=u.length-p.length-B;return yl(u.substr(0,B)+p+u.substr(u.length-U))}if(b=u.match(/^00,000\.([#0]*0)$/))return l<0?"-"+jh(r,u,-l):vd(""+l).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(H){return"00,"+(H.length<3?nh(0,3-H.length):"")+H})+"."+nh(0,b[1].length);switch(u){case"###,###":case"##,###":case"#,###":var j=vd(""+C);return j!=="0"?M+j:"";default:if(u.match(/\.[0#?]*$/))return jh(r,u.slice(0,u.lastIndexOf(".")),l)+yl(u.slice(u.lastIndexOf(".")))}throw new Error("unsupported format |"+u+"|")}function kf(r,u,l){return(l|0)===l?jh(r,u,l):iu(r,u,l)}function oE(r){for(var u=[],l=!1,f=0,p=0;f<r.length;++f)switch(r.charCodeAt(f)){case 34:l=!l;break;case 95:case 42:case 92:++f;break;case 59:u[u.length]=r.substr(p,f-p),p=f+1}if(u[u.length]=r.substr(p),l===!0)throw new Error("Format |"+r+"| unterminated string ");return u}var t2=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function tm(r){for(var u=0,l="",f="";u<r.length;)switch(l=r.charAt(u)){case"G":bx(r,u)&&(u+=6),u++;break;case'"':for(;r.charCodeAt(++u)!==34&&u<r.length;);++u;break;case"\\":u+=2;break;case"_":u+=2;break;case"@":++u;break;case"B":case"b":if(r.charAt(u+1)==="1"||r.charAt(u+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(r.substr(u,3).toUpperCase()==="A/P"||r.substr(u,5).toUpperCase()==="AM/PM"||r.substr(u,5).toUpperCase()==="/")return!0;++u;break;case"[":for(f=l;r.charAt(u++)!=="]"&&u<r.length;)f+=r.charAt(u);if(f.match(t2))return!0;break;case".":case"0":case"#":for(;u<r.length&&("0#?.,E+-%".indexOf(l=r.charAt(++u))>-1||l=="\\"&&r.charAt(u+1)=="-"&&"0#".indexOf(r.charAt(u+2))>-1););break;case"?":for(;r.charAt(++u)===l;);break;case"*":++u,(r.charAt(u)==" "||r.charAt(u)=="*")&&++u;break;case"(":case")":++u;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;u<r.length&&"0123456789".indexOf(r.charAt(++u))>-1;);break;case" ":++u;break;default:++u;break}return!1}function lE(r,u,l,f){for(var p=[],b="",_=0,s="",C="t",M,D,B,U="H";_<r.length;)switch(s=r.charAt(_)){case"G":if(!bx(r,_))throw new Error("unrecognized character "+s+" in "+r);p[p.length]={t:"G",v:"General"},_+=7;break;case'"':for(b="";(B=r.charCodeAt(++_))!==34&&_<r.length;)b+=String.fromCharCode(B);p[p.length]={t:"t",v:b},++_;break;case"\\":var j=r.charAt(++_),H=j==="("||j===")"?j:"t";p[p.length]={t:H,v:j},++_;break;case"_":p[p.length]={t:"t",v:" "},_+=2;break;case"@":p[p.length]={t:"T",v:u},++_;break;case"B":case"b":if(r.charAt(_+1)==="1"||r.charAt(_+1)==="2"){if(M==null&&(M=bp(u,l,r.charAt(_+1)==="2"),M==null))return"";p[p.length]={t:"X",v:r.substr(_,2)},C=s,_+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":s=s.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(u<0||M==null&&(M=bp(u,l),M==null))return"";for(b=s;++_<r.length&&r.charAt(_).toLowerCase()===s;)b+=s;s==="m"&&C.toLowerCase()==="h"&&(s="M"),s==="h"&&(s=U),p[p.length]={t:s,v:b},C=s;break;case"A":case"a":case"":var z={t:s,v:s};if(M==null&&(M=bp(u,l)),r.substr(_,3).toUpperCase()==="A/P"?(M!=null&&(z.v=M.H>=12?"P":"A"),z.t="T",U="h",_+=3):r.substr(_,5).toUpperCase()==="AM/PM"?(M!=null&&(z.v=M.H>=12?"PM":"AM"),z.t="T",_+=5,U="h"):r.substr(_,5).toUpperCase()==="/"?(M!=null&&(z.v=M.H>=12?"":""),z.t="T",_+=5,U="h"):(z.t="t",++_),M==null&&z.t==="T")return"";p[p.length]=z,C=s;break;case"[":for(b=s;r.charAt(_++)!=="]"&&_<r.length;)b+=r.charAt(_);if(b.slice(-1)!=="]")throw'unterminated "[" block: |'+b+"|";if(b.match(t2)){if(M==null&&(M=bp(u,l),M==null))return"";p[p.length]={t:"Z",v:b.toLowerCase()},C=b.charAt(1)}else b.indexOf("$")>-1&&(b=(b.match(/\$([^-\[\]]*)/)||[])[1]||"$",tm(r)||(p[p.length]={t:"t",v:b}));break;case".":if(M!=null){for(b=s;++_<r.length&&(s=r.charAt(_))==="0";)b+=s;p[p.length]={t:"s",v:b};break}case"0":case"#":for(b=s;++_<r.length&&"0#?.,E+-%".indexOf(s=r.charAt(_))>-1;)b+=s;p[p.length]={t:"n",v:b};break;case"?":for(b=s;r.charAt(++_)===s;)b+=s;p[p.length]={t:s,v:b},C=s;break;case"*":++_,(r.charAt(_)==" "||r.charAt(_)=="*")&&++_;break;case"(":case")":p[p.length]={t:f===1?"t":s,v:s},++_;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(b=s;_<r.length&&"0123456789".indexOf(r.charAt(++_))>-1;)b+=r.charAt(_);p[p.length]={t:"D",v:b};break;case" ":p[p.length]={t:s,v:s},++_;break;case"$":p[p.length]={t:"t",v:"$"},++_;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(s)===-1)throw new Error("unrecognized character "+s+" in "+r);p[p.length]={t:"t",v:s},++_;break}var N=0,Z=0,Y;for(_=p.length-1,C="t";_>=0;--_)switch(p[_].t){case"h":case"H":p[_].t=U,C="h",N<1&&(N=1);break;case"s":(Y=p[_].v.match(/\.0+$/))&&(Z=Math.max(Z,Y[0].length-1)),N<3&&(N=3);case"d":case"y":case"M":case"e":C=p[_].t;break;case"m":C==="s"&&(p[_].t="M",N<2&&(N=2));break;case"X":break;case"Z":N<1&&p[_].v.match(/[Hh]/)&&(N=1),N<2&&p[_].v.match(/[Mm]/)&&(N=2),N<3&&p[_].v.match(/[Ss]/)&&(N=3)}switch(N){case 0:break;case 1:M.u>=.5&&(M.u=0,++M.S),M.S>=60&&(M.S=0,++M.M),M.M>=60&&(M.M=0,++M.H);break;case 2:M.u>=.5&&(M.u=0,++M.S),M.S>=60&&(M.S=0,++M.M);break}var W="",de;for(_=0;_<p.length;++_)switch(p[_].t){case"t":case"T":case" ":case"D":break;case"X":p[_].v="",p[_].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":p[_].v=JS(p[_].t.charCodeAt(0),p[_].v,M,Z),p[_].t="t";break;case"n":case"?":for(de=_+1;p[de]!=null&&((s=p[de].t)==="?"||s==="D"||(s===" "||s==="t")&&p[de+1]!=null&&(p[de+1].t==="?"||p[de+1].t==="t"&&p[de+1].v==="/")||p[_].t==="("&&(s===" "||s==="n"||s===")")||s==="t"&&(p[de].v==="/"||p[de].v===" "&&p[de+1]!=null&&p[de+1].t=="?"));)p[_].v+=p[de].v,p[de]={v:"",t:";"},++de;W+=p[_].v,_=de-1;break;case"G":p[_].t="t",p[_].v=Sp(u,l);break}var ge="",ve,ie;if(W.length>0){W.charCodeAt(0)==40?(ve=u<0&&W.charCodeAt(0)===45?-u:u,ie=kf("n",W,ve)):(ve=u<0&&f>1?-u:u,ie=kf("n",W,ve),ve<0&&p[0]&&p[0].t=="t"&&(ie=ie.substr(1),p[0].v="-"+p[0].v)),de=ie.length-1;var Me=p.length;for(_=0;_<p.length;++_)if(p[_]!=null&&p[_].t!="t"&&p[_].v.indexOf(".")>-1){Me=_;break}var we=p.length;if(Me===p.length&&ie.indexOf("E")===-1){for(_=p.length-1;_>=0;--_)p[_]==null||"n?".indexOf(p[_].t)===-1||(de>=p[_].v.length-1?(de-=p[_].v.length,p[_].v=ie.substr(de+1,p[_].v.length)):de<0?p[_].v="":(p[_].v=ie.substr(0,de+1),de=-1),p[_].t="t",we=_);de>=0&&we<p.length&&(p[we].v=ie.substr(0,de+1)+p[we].v)}else if(Me!==p.length&&ie.indexOf("E")===-1){for(de=ie.indexOf(".")-1,_=Me;_>=0;--_)if(!(p[_]==null||"n?".indexOf(p[_].t)===-1)){for(D=p[_].v.indexOf(".")>-1&&_===Me?p[_].v.indexOf(".")-1:p[_].v.length-1,ge=p[_].v.substr(D+1);D>=0;--D)de>=0&&(p[_].v.charAt(D)==="0"||p[_].v.charAt(D)==="#")&&(ge=ie.charAt(de--)+ge);p[_].v=ge,p[_].t="t",we=_}for(de>=0&&we<p.length&&(p[we].v=ie.substr(0,de+1)+p[we].v),de=ie.indexOf(".")+1,_=Me;_<p.length;++_)if(!(p[_]==null||"n?(".indexOf(p[_].t)===-1&&_!==Me)){for(D=p[_].v.indexOf(".")>-1&&_===Me?p[_].v.indexOf(".")+1:0,ge=p[_].v.substr(0,D);D<p[_].v.length;++D)de<ie.length&&(ge+=ie.charAt(de++));p[_].v=ge,p[_].t="t",we=_}}}for(_=0;_<p.length;++_)p[_]!=null&&"n?".indexOf(p[_].t)>-1&&(ve=f>1&&u<0&&_>0&&p[_-1].v==="-"?-u:u,p[_].v=kf(p[_].t,p[_].v,ve),p[_].t="t");var Ge="";for(_=0;_!==p.length;++_)p[_]!=null&&(Ge+=p[_].v);return Ge}var pv=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function mv(r,u){if(u==null)return!1;var l=parseFloat(u[2]);switch(u[1]){case"=":if(r==l)return!0;break;case">":if(r>l)return!0;break;case"<":if(r<l)return!0;break;case"<>":if(r!=l)return!0;break;case">=":if(r>=l)return!0;break;case"<=":if(r<=l)return!0;break}return!1}function cE(r,u){var l=oE(r),f=l.length,p=l[f-1].indexOf("@");if(f<4&&p>-1&&--f,l.length>4)throw new Error("cannot find right format for |"+l.join("|")+"|");if(typeof u!="number")return[4,l.length===4||p>-1?l[l.length-1]:"@"];switch(l.length){case 1:l=p>-1?["General","General","General",l[0]]:[l[0],l[0],l[0],"@"];break;case 2:l=p>-1?[l[0],l[0],l[0],l[1]]:[l[0],l[1],l[0],"@"];break;case 3:l=p>-1?[l[0],l[1],l[0],l[2]]:[l[0],l[1],l[2],"@"];break}var b=u>0?l[0]:u<0?l[1]:l[2];if(l[0].indexOf("[")===-1&&l[1].indexOf("[")===-1)return[f,b];if(l[0].match(/\[[=<>]/)!=null||l[1].match(/\[[=<>]/)!=null){var _=l[0].match(pv),s=l[1].match(pv);return mv(u,_)?[f,l[0]]:mv(u,s)?[f,l[1]]:[f,l[_!=null&&s!=null?2:1]]}return[f,b]}function lu(r,u,l){l==null&&(l={});var f="";switch(typeof r){case"string":r=="m/d/yy"&&l.dateNF?f=l.dateNF:f=r;break;case"number":r==14&&l.dateNF?f=l.dateNF:f=(l.table!=null?l.table:Pn)[r],f==null&&(f=l.table&&l.table[hv[r]]||Pn[hv[r]]),f==null&&(f=qS[r]||"General");break}if(bx(f,0))return Sp(u,l);u instanceof Date&&(u=Wb(u,l.date1904));var p=cE(f,u);if(bx(p[1]))return Sp(u,l);if(u===!0)u="TRUE";else if(u===!1)u="FALSE";else if(u===""||u==null)return"";return lE(p[1],u,l,p[0])}function wp(r,u){if(typeof u!="number"){u=+u||-1;for(var l=0;l<392;++l){if(Pn[l]==null){u<0&&(u=l);continue}if(Pn[l]==r){u=l;break}}u<0&&(u=391)}return Pn[u]=r,u}function r2(){Pn=HS()}var uE={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},n2=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function hE(r){var u=typeof r=="number"?Pn[r]:r;return u=u.replace(n2,"(\\d+)"),new RegExp("^"+u+"$")}function fE(r,u,l){var f=-1,p=-1,b=-1,_=-1,s=-1,C=-1;(u.match(n2)||[]).forEach(function(B,U){var j=parseInt(l[U+1],10);switch(B.toLowerCase().charAt(0)){case"y":f=j;break;case"d":b=j;break;case"h":_=j;break;case"s":C=j;break;case"m":_>=0?s=j:p=j;break}}),C>=0&&s==-1&&p>=0&&(s=p,p=-1);var M=(""+(f>=0?f:new Date().getFullYear())).slice(-4)+"-"+("00"+(p>=1?p:1)).slice(-2)+"-"+("00"+(b>=1?b:1)).slice(-2);M.length==7&&(M="0"+M),M.length==8&&(M="20"+M);var D=("00"+(_>=0?_:0)).slice(-2)+":"+("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(C>=0?C:0)).slice(-2);return _==-1&&s==-1&&C==-1?M:f==-1&&p==-1&&b==-1?D:M+"T"+D}var dE=(function(){var r={};r.version="1.2.0";function u(){for(var ie=0,Me=new Array(256),we=0;we!=256;++we)ie=we,ie=ie&1?-306674912^ie>>>1:ie>>>1,ie=ie&1?-306674912^ie>>>1:ie>>>1,ie=ie&1?-306674912^ie>>>1:ie>>>1,ie=ie&1?-306674912^ie>>>1:ie>>>1,ie=ie&1?-306674912^ie>>>1:ie>>>1,ie=ie&1?-306674912^ie>>>1:ie>>>1,ie=ie&1?-306674912^ie>>>1:ie>>>1,ie=ie&1?-306674912^ie>>>1:ie>>>1,Me[we]=ie;return typeof Int32Array<"u"?new Int32Array(Me):Me}var l=u();function f(ie){var Me=0,we=0,Ge=0,et=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Ge=0;Ge!=256;++Ge)et[Ge]=ie[Ge];for(Ge=0;Ge!=256;++Ge)for(we=ie[Ge],Me=256+Ge;Me<4096;Me+=256)we=et[Me]=we>>>8^ie[we&255];var pe=[];for(Ge=1;Ge!=16;++Ge)pe[Ge-1]=typeof Int32Array<"u"?et.subarray(Ge*256,Ge*256+256):et.slice(Ge*256,Ge*256+256);return pe}var p=f(l),b=p[0],_=p[1],s=p[2],C=p[3],M=p[4],D=p[5],B=p[6],U=p[7],j=p[8],H=p[9],z=p[10],N=p[11],Z=p[12],Y=p[13],W=p[14];function de(ie,Me){for(var we=Me^-1,Ge=0,et=ie.length;Ge<et;)we=we>>>8^l[(we^ie.charCodeAt(Ge++))&255];return~we}function ge(ie,Me){for(var we=Me^-1,Ge=ie.length-15,et=0;et<Ge;)we=W[ie[et++]^we&255]^Y[ie[et++]^we>>8&255]^Z[ie[et++]^we>>16&255]^N[ie[et++]^we>>>24]^z[ie[et++]]^H[ie[et++]]^j[ie[et++]]^U[ie[et++]]^B[ie[et++]]^D[ie[et++]]^M[ie[et++]]^C[ie[et++]]^s[ie[et++]]^_[ie[et++]]^b[ie[et++]]^l[ie[et++]];for(Ge+=15;et<Ge;)we=we>>>8^l[(we^ie[et++])&255];return~we}function ve(ie,Me){for(var we=Me^-1,Ge=0,et=ie.length,pe=0,Je=0;Ge<et;)pe=ie.charCodeAt(Ge++),pe<128?we=we>>>8^l[(we^pe)&255]:pe<2048?(we=we>>>8^l[(we^(192|pe>>6&31))&255],we=we>>>8^l[(we^(128|pe&63))&255]):pe>=55296&&pe<57344?(pe=(pe&1023)+64,Je=ie.charCodeAt(Ge++)&1023,we=we>>>8^l[(we^(240|pe>>8&7))&255],we=we>>>8^l[(we^(128|pe>>2&63))&255],we=we>>>8^l[(we^(128|Je>>6&15|(pe&3)<<4))&255],we=we>>>8^l[(we^(128|Je&63))&255]):(we=we>>>8^l[(we^(224|pe>>12&15))&255],we=we>>>8^l[(we^(128|pe>>6&63))&255],we=we>>>8^l[(we^(128|pe&63))&255]);return~we}return r.table=l,r.bstr=de,r.buf=ge,r.str=ve,r})(),sa=(function(){var u={};u.version="1.2.1";function l(xe,Ue){for(var Fe=xe.split("/"),Re=Ue.split("/"),Te=0,ze=0,mt=Math.min(Fe.length,Re.length);Te<mt;++Te){if(ze=Fe[Te].length-Re[Te].length)return ze;if(Fe[Te]!=Re[Te])return Fe[Te]<Re[Te]?-1:1}return Fe.length-Re.length}function f(xe){if(xe.charAt(xe.length-1)=="/")return xe.slice(0,-1).indexOf("/")===-1?xe:f(xe.slice(0,-1));var Ue=xe.lastIndexOf("/");return Ue===-1?xe:xe.slice(0,Ue+1)}function p(xe){if(xe.charAt(xe.length-1)=="/")return p(xe.slice(0,-1));var Ue=xe.lastIndexOf("/");return Ue===-1?xe:xe.slice(Ue+1)}function b(xe,Ue){typeof Ue=="string"&&(Ue=new Date(Ue));var Fe=Ue.getHours();Fe=Fe<<6|Ue.getMinutes(),Fe=Fe<<5|Ue.getSeconds()>>>1,xe.write_shift(2,Fe);var Re=Ue.getFullYear()-1980;Re=Re<<4|Ue.getMonth()+1,Re=Re<<5|Ue.getDate(),xe.write_shift(2,Re)}function _(xe){var Ue=xe.read_shift(2)&65535,Fe=xe.read_shift(2)&65535,Re=new Date,Te=Fe&31;Fe>>>=5;var ze=Fe&15;Fe>>>=4,Re.setMilliseconds(0),Re.setFullYear(Fe+1980),Re.setMonth(ze-1),Re.setDate(Te);var mt=Ue&31;Ue>>>=5;var Ut=Ue&63;return Ue>>>=6,Re.setHours(Ue),Re.setMinutes(Ut),Re.setSeconds(mt<<1),Re}function s(xe){mo(xe,0);for(var Ue={},Fe=0;xe.l<=xe.length-4;){var Re=xe.read_shift(2),Te=xe.read_shift(2),ze=xe.l+Te,mt={};Re===21589&&(Fe=xe.read_shift(1),Fe&1&&(mt.mtime=xe.read_shift(4)),Te>5&&(Fe&2&&(mt.atime=xe.read_shift(4)),Fe&4&&(mt.ctime=xe.read_shift(4))),mt.mtime&&(mt.mt=new Date(mt.mtime*1e3))),xe.l=ze,Ue[Re]=mt}return Ue}var C;function M(){return C||(C={})}function D(xe,Ue){if(xe[0]==80&&xe[1]==75)return Gr(xe,Ue);if((xe[0]|32)==109&&(xe[1]|32)==105)return Vn(xe,Ue);if(xe.length<512)throw new Error("CFB file size "+xe.length+" < 512");var Fe=3,Re=512,Te=0,ze=0,mt=0,Ut=0,It=0,Tt=[],gt=xe.slice(0,512);mo(gt,0);var ir=B(gt);switch(Fe=ir[0],Fe){case 3:Re=512;break;case 4:Re=4096;break;case 0:if(ir[1]==0)return Gr(xe,Ue);default:throw new Error("Major Version: Expected 3 or 4 saw "+Fe)}Re!==512&&(gt=xe.slice(0,Re),mo(gt,28));var vr=xe.slice(0,Re);U(gt,Fe);var Sr=gt.read_shift(4,"i");if(Fe===3&&Sr!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Sr);gt.l+=4,mt=gt.read_shift(4,"i"),gt.l+=4,gt.chk("00100000","Mini Stream Cutoff Size: "),Ut=gt.read_shift(4,"i"),Te=gt.read_shift(4,"i"),It=gt.read_shift(4,"i"),ze=gt.read_shift(4,"i");for(var dr=-1,xr=0;xr<109&&(dr=gt.read_shift(4,"i"),!(dr<0));++xr)Tt[xr]=dr;var Nr=j(xe,Re);N(It,ze,Nr,Re,Tt);var Wn=Y(Nr,mt,Tt,Re);Wn[mt].name="!Directory",Te>0&&Ut!==Je&&(Wn[Ut].name="!MiniFAT"),Wn[Tt[0]].name="!FAT",Wn.fat_addrs=Tt,Wn.ssz=Re;var mn={},tn=[],oi=[],xs=[];W(mt,Wn,Nr,tn,Te,mn,oi,Ut),H(oi,xs,tn),tn.shift();var li={FileIndex:oi,FullPaths:xs};return Ue&&Ue.raw&&(li.raw={header:vr,sectors:Nr}),li}function B(xe){if(xe[xe.l]==80&&xe[xe.l+1]==75)return[0,0];xe.chk(le,"Header Signature: "),xe.l+=16;var Ue=xe.read_shift(2,"u");return[xe.read_shift(2,"u"),Ue]}function U(xe,Ue){var Fe=9;switch(xe.l+=2,Fe=xe.read_shift(2)){case 9:if(Ue!=3)throw new Error("Sector Shift: Expected 9 saw "+Fe);break;case 12:if(Ue!=4)throw new Error("Sector Shift: Expected 12 saw "+Fe);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Fe)}xe.chk("0600","Mini Sector Shift: "),xe.chk("000000000000","Reserved: ")}function j(xe,Ue){for(var Fe=Math.ceil(xe.length/Ue)-1,Re=[],Te=1;Te<Fe;++Te)Re[Te-1]=xe.slice(Te*Ue,(Te+1)*Ue);return Re[Fe-1]=xe.slice(Fe*Ue),Re}function H(xe,Ue,Fe){for(var Re=0,Te=0,ze=0,mt=0,Ut=0,It=Fe.length,Tt=[],gt=[];Re<It;++Re)Tt[Re]=gt[Re]=Re,Ue[Re]=Fe[Re];for(;Ut<gt.length;++Ut)Re=gt[Ut],Te=xe[Re].L,ze=xe[Re].R,mt=xe[Re].C,Tt[Re]===Re&&(Te!==-1&&Tt[Te]!==Te&&(Tt[Re]=Tt[Te]),ze!==-1&&Tt[ze]!==ze&&(Tt[Re]=Tt[ze])),mt!==-1&&(Tt[mt]=Re),Te!==-1&&Re!=Tt[Re]&&(Tt[Te]=Tt[Re],gt.lastIndexOf(Te)<Ut&&gt.push(Te)),ze!==-1&&Re!=Tt[Re]&&(Tt[ze]=Tt[Re],gt.lastIndexOf(ze)<Ut&&gt.push(ze));for(Re=1;Re<It;++Re)Tt[Re]===Re&&(ze!==-1&&Tt[ze]!==ze?Tt[Re]=Tt[ze]:Te!==-1&&Tt[Te]!==Te&&(Tt[Re]=Tt[Te]));for(Re=1;Re<It;++Re)if(xe[Re].type!==0){if(Ut=Re,Ut!=Tt[Ut])do Ut=Tt[Ut],Ue[Re]=Ue[Ut]+"/"+Ue[Re];while(Ut!==0&&Tt[Ut]!==-1&&Ut!=Tt[Ut]);Tt[Re]=-1}for(Ue[0]+="/",Re=1;Re<It;++Re)xe[Re].type!==2&&(Ue[Re]+="/")}function z(xe,Ue,Fe){for(var Re=xe.start,Te=xe.size,ze=[],mt=Re;Fe&&Te>0&&mt>=0;)ze.push(Ue.slice(mt*pe,mt*pe+pe)),Te-=pe,mt=vp(Fe,mt*4);return ze.length===0?As(0):gd(ze).slice(0,xe.size)}function N(xe,Ue,Fe,Re,Te){var ze=Je;if(xe===Je){if(Ue!==0)throw new Error("DIFAT chain shorter than expected")}else if(xe!==-1){var mt=Fe[xe],Ut=(Re>>>2)-1;if(!mt)return;for(var It=0;It<Ut&&(ze=vp(mt,It*4))!==Je;++It)Te.push(ze);N(vp(mt,Re-4),Ue-1,Fe,Re,Te)}}function Z(xe,Ue,Fe,Re,Te){var ze=[],mt=[];Te||(Te=[]);var Ut=Re-1,It=0,Tt=0;for(It=Ue;It>=0;){Te[It]=!0,ze[ze.length]=It,mt.push(xe[It]);var gt=Fe[Math.floor(It*4/Re)];if(Tt=It*4&Ut,Re<4+Tt)throw new Error("FAT boundary crossed: "+It+" 4 "+Re);if(!xe[gt])break;It=vp(xe[gt],Tt)}return{nodes:ze,data:Ev([mt])}}function Y(xe,Ue,Fe,Re){var Te=xe.length,ze=[],mt=[],Ut=[],It=[],Tt=Re-1,gt=0,ir=0,vr=0,Sr=0;for(gt=0;gt<Te;++gt)if(Ut=[],vr=gt+Ue,vr>=Te&&(vr-=Te),!mt[vr]){It=[];var dr=[];for(ir=vr;ir>=0;){dr[ir]=!0,mt[ir]=!0,Ut[Ut.length]=ir,It.push(xe[ir]);var xr=Fe[Math.floor(ir*4/Re)];if(Sr=ir*4&Tt,Re<4+Sr)throw new Error("FAT boundary crossed: "+ir+" 4 "+Re);if(!xe[xr]||(ir=vp(xe[xr],Sr),dr[ir]))break}ze[vr]={nodes:Ut,data:Ev([It])}}return ze}function W(xe,Ue,Fe,Re,Te,ze,mt,Ut){for(var It=0,Tt=Re.length?2:0,gt=Ue[xe].data,ir=0,vr=0,Sr;ir<gt.length;ir+=128){var dr=gt.slice(ir,ir+128);mo(dr,64),vr=dr.read_shift(2),Sr=u1(dr,0,vr-Tt),Re.push(Sr);var xr={name:Sr,type:dr.read_shift(1),color:dr.read_shift(1),L:dr.read_shift(4,"i"),R:dr.read_shift(4,"i"),C:dr.read_shift(4,"i"),clsid:dr.read_shift(16),state:dr.read_shift(4,"i"),start:0,size:0},Nr=dr.read_shift(2)+dr.read_shift(2)+dr.read_shift(2)+dr.read_shift(2);Nr!==0&&(xr.ct=de(dr,dr.l-8));var Wn=dr.read_shift(2)+dr.read_shift(2)+dr.read_shift(2)+dr.read_shift(2);Wn!==0&&(xr.mt=de(dr,dr.l-8)),xr.start=dr.read_shift(4,"i"),xr.size=dr.read_shift(4,"i"),xr.size<0&&xr.start<0&&(xr.size=xr.type=0,xr.start=Je,xr.name=""),xr.type===5?(It=xr.start,Te>0&&It!==Je&&(Ue[It].name="!StreamData")):xr.size>=4096?(xr.storage="fat",Ue[xr.start]===void 0&&(Ue[xr.start]=Z(Fe,xr.start,Ue.fat_addrs,Ue.ssz)),Ue[xr.start].name=xr.name,xr.content=Ue[xr.start].data.slice(0,xr.size)):(xr.storage="minifat",xr.size<0?xr.size=0:It!==Je&&xr.start!==Je&&Ue[It]&&(xr.content=z(xr,Ue[It].data,(Ue[Ut]||{}).data))),xr.content&&mo(xr.content,0),ze[Sr]=xr,mt.push(xr)}}function de(xe,Ue){return new Date((Dc(xe,Ue+4)/1e7*Math.pow(2,32)+Dc(xe,Ue)/1e7-11644473600)*1e3)}function ge(xe,Ue){return M(),D(C.readFileSync(xe),Ue)}function ve(xe,Ue){var Fe=Ue&&Ue.type;switch(Fe||ta&&Buffer.isBuffer(xe)&&(Fe="buffer"),Fe||"base64"){case"file":return ge(xe,Ue);case"base64":return D(eh(Ic(xe)),Ue);case"binary":return D(eh(xe),Ue)}return D(xe,Ue)}function ie(xe,Ue){var Fe=Ue||{},Re=Fe.root||"Root Entry";if(xe.FullPaths||(xe.FullPaths=[]),xe.FileIndex||(xe.FileIndex=[]),xe.FullPaths.length!==xe.FileIndex.length)throw new Error("inconsistent CFB structure");xe.FullPaths.length===0&&(xe.FullPaths[0]=Re+"/",xe.FileIndex[0]={name:Re,type:5}),Fe.CLSID&&(xe.FileIndex[0].clsid=Fe.CLSID),Me(xe)}function Me(xe){var Ue="Sh33tJ5";if(!sa.find(xe,"/"+Ue)){var Fe=As(4);Fe[0]=55,Fe[1]=Fe[3]=50,Fe[2]=54,xe.FileIndex.push({name:Ue,type:2,content:Fe,size:4,L:69,R:69,C:69}),xe.FullPaths.push(xe.FullPaths[0]+Ue),we(xe)}}function we(xe,Ue){ie(xe);for(var Fe=!1,Re=!1,Te=xe.FullPaths.length-1;Te>=0;--Te){var ze=xe.FileIndex[Te];switch(ze.type){case 0:Re?Fe=!0:(xe.FileIndex.pop(),xe.FullPaths.pop());break;case 1:case 2:case 5:Re=!0,isNaN(ze.R*ze.L*ze.C)&&(Fe=!0),ze.R>-1&&ze.L>-1&&ze.R==ze.L&&(Fe=!0);break;default:Fe=!0;break}}if(!(!Fe&&!Ue)){var mt=new Date(1987,1,19),Ut=0,It=Object.create?Object.create(null):{},Tt=[];for(Te=0;Te<xe.FullPaths.length;++Te)It[xe.FullPaths[Te]]=!0,xe.FileIndex[Te].type!==0&&Tt.push([xe.FullPaths[Te],xe.FileIndex[Te]]);for(Te=0;Te<Tt.length;++Te){var gt=f(Tt[Te][0]);Re=It[gt],Re||(Tt.push([gt,{name:p(gt).replace("/",""),type:1,clsid:tt,ct:mt,mt,content:null}]),It[gt]=!0)}for(Tt.sort(function(Sr,dr){return l(Sr[0],dr[0])}),xe.FullPaths=[],xe.FileIndex=[],Te=0;Te<Tt.length;++Te)xe.FullPaths[Te]=Tt[Te][0],xe.FileIndex[Te]=Tt[Te][1];for(Te=0;Te<Tt.length;++Te){var ir=xe.FileIndex[Te],vr=xe.FullPaths[Te];if(ir.name=p(vr).replace("/",""),ir.L=ir.R=ir.C=-(ir.color=1),ir.size=ir.content?ir.content.length:0,ir.start=0,ir.clsid=ir.clsid||tt,Te===0)ir.C=Tt.length>1?1:-1,ir.size=0,ir.type=5;else if(vr.slice(-1)=="/"){for(Ut=Te+1;Ut<Tt.length&&f(xe.FullPaths[Ut])!=vr;++Ut);for(ir.C=Ut>=Tt.length?-1:Ut,Ut=Te+1;Ut<Tt.length&&f(xe.FullPaths[Ut])!=f(vr);++Ut);ir.R=Ut>=Tt.length?-1:Ut,ir.type=1}else f(xe.FullPaths[Te+1]||"")==f(vr)&&(ir.R=Te+1),ir.type=2}}}function Ge(xe,Ue){var Fe=Ue||{};if(Fe.fileType=="mad")return va(xe,Fe);if(we(xe),Fe.fileType==="zip")return an(xe,Fe);var Re=(function(Sr){for(var dr=0,xr=0,Nr=0;Nr<Sr.FileIndex.length;++Nr){var Wn=Sr.FileIndex[Nr];if(Wn.content){var mn=Wn.content.length;mn>0&&(mn<4096?dr+=mn+63>>6:xr+=mn+511>>9)}}for(var tn=Sr.FullPaths.length+3>>2,oi=dr+7>>3,xs=dr+127>>7,li=oi+xr+tn+xs,wi=li+127>>7,za=wi<=109?0:Math.ceil((wi-109)/127);li+wi+za+127>>7>wi;)za=++wi<=109?0:Math.ceil((wi-109)/127);var Ti=[1,za,wi,xs,tn,xr,dr,0];return Sr.FileIndex[0].size=dr<<6,Ti[7]=(Sr.FileIndex[0].start=Ti[0]+Ti[1]+Ti[2]+Ti[3]+Ti[4]+Ti[5])+(Ti[6]+7>>3),Ti})(xe),Te=As(Re[7]<<9),ze=0,mt=0;{for(ze=0;ze<8;++ze)Te.write_shift(1,ut[ze]);for(ze=0;ze<8;++ze)Te.write_shift(2,0);for(Te.write_shift(2,62),Te.write_shift(2,3),Te.write_shift(2,65534),Te.write_shift(2,9),Te.write_shift(2,6),ze=0;ze<3;++ze)Te.write_shift(2,0);for(Te.write_shift(4,0),Te.write_shift(4,Re[2]),Te.write_shift(4,Re[0]+Re[1]+Re[2]+Re[3]-1),Te.write_shift(4,0),Te.write_shift(4,4096),Te.write_shift(4,Re[3]?Re[0]+Re[1]+Re[2]-1:Je),Te.write_shift(4,Re[3]),Te.write_shift(-4,Re[1]?Re[0]-1:Je),Te.write_shift(4,Re[1]),ze=0;ze<109;++ze)Te.write_shift(-4,ze<Re[2]?Re[1]+ze:-1)}if(Re[1])for(mt=0;mt<Re[1];++mt){for(;ze<236+mt*127;++ze)Te.write_shift(-4,ze<Re[2]?Re[1]+ze:-1);Te.write_shift(-4,mt===Re[1]-1?Je:mt+1)}var Ut=function(Sr){for(mt+=Sr;ze<mt-1;++ze)Te.write_shift(-4,ze+1);Sr&&(++ze,Te.write_shift(-4,Je))};for(mt=ze=0,mt+=Re[1];ze<mt;++ze)Te.write_shift(-4,We.DIFSECT);for(mt+=Re[2];ze<mt;++ze)Te.write_shift(-4,We.FATSECT);Ut(Re[3]),Ut(Re[4]);for(var It=0,Tt=0,gt=xe.FileIndex[0];It<xe.FileIndex.length;++It)gt=xe.FileIndex[It],gt.content&&(Tt=gt.content.length,!(Tt<4096)&&(gt.start=mt,Ut(Tt+511>>9)));for(Ut(Re[6]+7>>3);Te.l&511;)Te.write_shift(-4,We.ENDOFCHAIN);for(mt=ze=0,It=0;It<xe.FileIndex.length;++It)gt=xe.FileIndex[It],gt.content&&(Tt=gt.content.length,!(!Tt||Tt>=4096)&&(gt.start=mt,Ut(Tt+63>>6)));for(;Te.l&511;)Te.write_shift(-4,We.ENDOFCHAIN);for(ze=0;ze<Re[4]<<2;++ze){var ir=xe.FullPaths[ze];if(!ir||ir.length===0){for(It=0;It<17;++It)Te.write_shift(4,0);for(It=0;It<3;++It)Te.write_shift(4,-1);for(It=0;It<12;++It)Te.write_shift(4,0);continue}gt=xe.FileIndex[ze],ze===0&&(gt.start=gt.size?gt.start-1:Je);var vr=ze===0&&Fe.root||gt.name;if(Tt=2*(vr.length+1),Te.write_shift(64,vr,"utf16le"),Te.write_shift(2,Tt),Te.write_shift(1,gt.type),Te.write_shift(1,gt.color),Te.write_shift(-4,gt.L),Te.write_shift(-4,gt.R),Te.write_shift(-4,gt.C),gt.clsid)Te.write_shift(16,gt.clsid,"hex");else for(It=0;It<4;++It)Te.write_shift(4,0);Te.write_shift(4,gt.state||0),Te.write_shift(4,0),Te.write_shift(4,0),Te.write_shift(4,0),Te.write_shift(4,0),Te.write_shift(4,gt.start),Te.write_shift(4,gt.size),Te.write_shift(4,0)}for(ze=1;ze<xe.FileIndex.length;++ze)if(gt=xe.FileIndex[ze],gt.size>=4096)if(Te.l=gt.start+1<<9,ta&&Buffer.isBuffer(gt.content))gt.content.copy(Te,Te.l,0,gt.size),Te.l+=gt.size+511&-512;else{for(It=0;It<gt.size;++It)Te.write_shift(1,gt.content[It]);for(;It&511;++It)Te.write_shift(1,0)}for(ze=1;ze<xe.FileIndex.length;++ze)if(gt=xe.FileIndex[ze],gt.size>0&&gt.size<4096)if(ta&&Buffer.isBuffer(gt.content))gt.content.copy(Te,Te.l,0,gt.size),Te.l+=gt.size+63&-64;else{for(It=0;It<gt.size;++It)Te.write_shift(1,gt.content[It]);for(;It&63;++It)Te.write_shift(1,0)}if(ta)Te.l=Te.length;else for(;Te.l<Te.length;)Te.write_shift(1,0);return Te}function et(xe,Ue){var Fe=xe.FullPaths.map(function(It){return It.toUpperCase()}),Re=Fe.map(function(It){var Tt=It.split("/");return Tt[Tt.length-(It.slice(-1)=="/"?2:1)]}),Te=!1;Ue.charCodeAt(0)===47?(Te=!0,Ue=Fe[0].slice(0,-1)+Ue):Te=Ue.indexOf("/")!==-1;var ze=Ue.toUpperCase(),mt=Te===!0?Fe.indexOf(ze):Re.indexOf(ze);if(mt!==-1)return xe.FileIndex[mt];var Ut=!ze.match(mg);for(ze=ze.replace(wl,""),Ut&&(ze=ze.replace(mg,"!")),mt=0;mt<Fe.length;++mt)if((Ut?Fe[mt].replace(mg,"!"):Fe[mt]).replace(wl,"")==ze||(Ut?Re[mt].replace(mg,"!"):Re[mt]).replace(wl,"")==ze)return xe.FileIndex[mt];return null}var pe=64,Je=-2,le="d0cf11e0a1b11ae1",ut=[208,207,17,224,161,177,26,225],tt="00000000000000000000000000000000",We={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Je,FREESECT:-1,HEADER_SIGNATURE:le,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:tt,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function $t(xe,Ue,Fe){M();var Re=Ge(xe,Fe);C.writeFileSync(Ue,Re)}function Be(xe){for(var Ue=new Array(xe.length),Fe=0;Fe<xe.length;++Fe)Ue[Fe]=String.fromCharCode(xe[Fe]);return Ue.join("")}function Mt(xe,Ue){var Fe=Ge(xe,Ue);switch(Ue&&Ue.type||"buffer"){case"file":return M(),C.writeFileSync(Ue.filename,Fe),Fe;case"binary":return typeof Fe=="string"?Fe:Be(Fe);case"base64":return ov(typeof Fe=="string"?Fe:Be(Fe));case"buffer":if(ta)return Buffer.isBuffer(Fe)?Fe:Cp(Fe);case"array":return typeof Fe=="string"?eh(Fe):Fe}return Fe}var me;function re(xe){try{var Ue=xe.InflateRaw,Fe=new Ue;if(Fe._processChunk(new Uint8Array([3,0]),Fe._finishFlushFlag),Fe.bytesRead)me=xe;else throw new Error("zlib does not expose bytesRead")}catch(Re){console.error("cannot use native zlib: "+(Re.message||Re))}}function Ve(xe,Ue){if(!me)return Tr(xe,Ue);var Fe=me.InflateRaw,Re=new Fe,Te=Re._processChunk(xe.slice(xe.l),Re._finishFlushFlag);return xe.l+=Re.bytesRead,Te}function Pe(xe){return me?me.deflateRawSync(xe):je(xe)}var De=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],bt=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Vt=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Zt(xe){var Ue=(xe<<1|xe<<11)&139536|(xe<<5|xe<<15)&558144;return(Ue>>16|Ue>>8|Ue)&255}for(var jt=typeof Uint8Array<"u",Yt=jt?new Uint8Array(256):[],jr=0;jr<256;++jr)Yt[jr]=Zt(jr);function Qe(xe,Ue){var Fe=Yt[xe&255];return Ue<=8?Fe>>>8-Ue:(Fe=Fe<<8|Yt[xe>>8&255],Ue<=16?Fe>>>16-Ue:(Fe=Fe<<8|Yt[xe>>16&255],Fe>>>24-Ue))}function _n(xe,Ue){var Fe=Ue&7,Re=Ue>>>3;return(xe[Re]|(Fe<=6?0:xe[Re+1]<<8))>>>Fe&3}function se(xe,Ue){var Fe=Ue&7,Re=Ue>>>3;return(xe[Re]|(Fe<=5?0:xe[Re+1]<<8))>>>Fe&7}function Rt(xe,Ue){var Fe=Ue&7,Re=Ue>>>3;return(xe[Re]|(Fe<=4?0:xe[Re+1]<<8))>>>Fe&15}function yt(xe,Ue){var Fe=Ue&7,Re=Ue>>>3;return(xe[Re]|(Fe<=3?0:xe[Re+1]<<8))>>>Fe&31}function Ee(xe,Ue){var Fe=Ue&7,Re=Ue>>>3;return(xe[Re]|(Fe<=1?0:xe[Re+1]<<8))>>>Fe&127}function Ne(xe,Ue,Fe){var Re=Ue&7,Te=Ue>>>3,ze=(1<<Fe)-1,mt=xe[Te]>>>Re;return Fe<8-Re||(mt|=xe[Te+1]<<8-Re,Fe<16-Re)||(mt|=xe[Te+2]<<16-Re,Fe<24-Re)||(mt|=xe[Te+3]<<24-Re),mt&ze}function dt(xe,Ue,Fe){var Re=Ue&7,Te=Ue>>>3;return Re<=5?xe[Te]|=(Fe&7)<<Re:(xe[Te]|=Fe<<Re&255,xe[Te+1]=(Fe&7)>>8-Re),Ue+3}function Kt(xe,Ue,Fe){var Re=Ue&7,Te=Ue>>>3;return Fe=(Fe&1)<<Re,xe[Te]|=Fe,Ue+1}function Jt(xe,Ue,Fe){var Re=Ue&7,Te=Ue>>>3;return Fe<<=Re,xe[Te]|=Fe&255,Fe>>>=8,xe[Te+1]=Fe,Ue+8}function kt(xe,Ue,Fe){var Re=Ue&7,Te=Ue>>>3;return Fe<<=Re,xe[Te]|=Fe&255,Fe>>>=8,xe[Te+1]=Fe&255,xe[Te+2]=Fe>>>8,Ue+16}function lr(xe,Ue){var Fe=xe.length,Re=2*Fe>Ue?2*Fe:Ue+5,Te=0;if(Fe>=Ue)return xe;if(ta){var ze=lv(Re);if(xe.copy)xe.copy(ze);else for(;Te<xe.length;++Te)ze[Te]=xe[Te];return ze}else if(jt){var mt=new Uint8Array(Re);if(mt.set)mt.set(xe);else for(;Te<Fe;++Te)mt[Te]=xe[Te];return mt}return xe.length=Re,xe}function pr(xe){for(var Ue=new Array(xe),Fe=0;Fe<xe;++Fe)Ue[Fe]=0;return Ue}function sr(xe,Ue,Fe){var Re=1,Te=0,ze=0,mt=0,Ut=0,It=xe.length,Tt=jt?new Uint16Array(32):pr(32);for(ze=0;ze<32;++ze)Tt[ze]=0;for(ze=It;ze<Fe;++ze)xe[ze]=0;It=xe.length;var gt=jt?new Uint16Array(It):pr(It);for(ze=0;ze<It;++ze)Tt[Te=xe[ze]]++,Re<Te&&(Re=Te),gt[ze]=0;for(Tt[0]=0,ze=1;ze<=Re;++ze)Tt[ze+16]=Ut=Ut+Tt[ze-1]<<1;for(ze=0;ze<It;++ze)Ut=xe[ze],Ut!=0&&(gt[ze]=Tt[Ut+16]++);var ir=0;for(ze=0;ze<It;++ze)if(ir=xe[ze],ir!=0)for(Ut=Qe(gt[ze],Re)>>Re-ir,mt=(1<<Re+4-ir)-1;mt>=0;--mt)Ue[Ut|mt<<ir]=ir&15|ze<<4;return Re}var st=jt?new Uint16Array(512):pr(512),fe=jt?new Uint16Array(32):pr(32);if(!jt){for(var ue=0;ue<512;++ue)st[ue]=0;for(ue=0;ue<32;++ue)fe[ue]=0}(function(){for(var xe=[],Ue=0;Ue<32;Ue++)xe.push(5);sr(xe,fe,32);var Fe=[];for(Ue=0;Ue<=143;Ue++)Fe.push(8);for(;Ue<=255;Ue++)Fe.push(9);for(;Ue<=279;Ue++)Fe.push(7);for(;Ue<=287;Ue++)Fe.push(8);sr(Fe,st,288)})();var ye=(function(){for(var Ue=jt?new Uint8Array(32768):[],Fe=0,Re=0;Fe<Vt.length-1;++Fe)for(;Re<Vt[Fe+1];++Re)Ue[Re]=Fe;for(;Re<32768;++Re)Ue[Re]=29;var Te=jt?new Uint8Array(259):[];for(Fe=0,Re=0;Fe<bt.length-1;++Fe)for(;Re<bt[Fe+1];++Re)Te[Re]=Fe;function ze(Ut,It){for(var Tt=0;Tt<Ut.length;){var gt=Math.min(65535,Ut.length-Tt),ir=Tt+gt==Ut.length;for(It.write_shift(1,+ir),It.write_shift(2,gt),It.write_shift(2,~gt&65535);gt-- >0;)It[It.l++]=Ut[Tt++]}return It.l}function mt(Ut,It){for(var Tt=0,gt=0,ir=jt?new Uint16Array(32768):[];gt<Ut.length;){var vr=Math.min(65535,Ut.length-gt);if(vr<10){for(Tt=dt(It,Tt,+(gt+vr==Ut.length)),Tt&7&&(Tt+=8-(Tt&7)),It.l=Tt/8|0,It.write_shift(2,vr),It.write_shift(2,~vr&65535);vr-- >0;)It[It.l++]=Ut[gt++];Tt=It.l*8;continue}Tt=dt(It,Tt,+(gt+vr==Ut.length)+2);for(var Sr=0;vr-- >0;){var dr=Ut[gt];Sr=(Sr<<5^dr)&32767;var xr=-1,Nr=0;if((xr=ir[Sr])&&(xr|=gt&-32768,xr>gt&&(xr-=32768),xr<gt))for(;Ut[xr+Nr]==Ut[gt+Nr]&&Nr<250;)++Nr;if(Nr>2){dr=Te[Nr],dr<=22?Tt=Jt(It,Tt,Yt[dr+1]>>1)-1:(Jt(It,Tt,3),Tt+=5,Jt(It,Tt,Yt[dr-23]>>5),Tt+=3);var Wn=dr<8?0:dr-4>>2;Wn>0&&(kt(It,Tt,Nr-bt[dr]),Tt+=Wn),dr=Ue[gt-xr],Tt=Jt(It,Tt,Yt[dr]>>3),Tt-=3;var mn=dr<4?0:dr-2>>1;mn>0&&(kt(It,Tt,gt-xr-Vt[dr]),Tt+=mn);for(var tn=0;tn<Nr;++tn)ir[Sr]=gt&32767,Sr=(Sr<<5^Ut[gt])&32767,++gt;vr-=Nr-1}else dr<=143?dr=dr+48:Tt=Kt(It,Tt,1),Tt=Jt(It,Tt,Yt[dr]),ir[Sr]=gt&32767,++gt}Tt=Jt(It,Tt,0)-1}return It.l=(Tt+7)/8|0,It.l}return function(It,Tt){return It.length<8?ze(It,Tt):mt(It,Tt)}})();function je(xe){var Ue=As(50+Math.floor(xe.length*1.1)),Fe=ye(xe,Ue);return Ue.slice(0,Fe)}var $e=jt?new Uint16Array(32768):pr(32768),_t=jt?new Uint16Array(32768):pr(32768),lt=jt?new Uint16Array(128):pr(128),at=1,vt=1;function Bt(xe,Ue){var Fe=yt(xe,Ue)+257;Ue+=5;var Re=yt(xe,Ue)+1;Ue+=5;var Te=Rt(xe,Ue)+4;Ue+=4;for(var ze=0,mt=jt?new Uint8Array(19):pr(19),Ut=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],It=1,Tt=jt?new Uint8Array(8):pr(8),gt=jt?new Uint8Array(8):pr(8),ir=mt.length,vr=0;vr<Te;++vr)mt[De[vr]]=ze=se(xe,Ue),It<ze&&(It=ze),Tt[ze]++,Ue+=3;var Sr=0;for(Tt[0]=0,vr=1;vr<=It;++vr)gt[vr]=Sr=Sr+Tt[vr-1]<<1;for(vr=0;vr<ir;++vr)(Sr=mt[vr])!=0&&(Ut[vr]=gt[Sr]++);var dr=0;for(vr=0;vr<ir;++vr)if(dr=mt[vr],dr!=0){Sr=Yt[Ut[vr]]>>8-dr;for(var xr=(1<<7-dr)-1;xr>=0;--xr)lt[Sr|xr<<dr]=dr&7|vr<<3}var Nr=[];for(It=1;Nr.length<Fe+Re;)switch(Sr=lt[Ee(xe,Ue)],Ue+=Sr&7,Sr>>>=3){case 16:for(ze=3+_n(xe,Ue),Ue+=2,Sr=Nr[Nr.length-1];ze-- >0;)Nr.push(Sr);break;case 17:for(ze=3+se(xe,Ue),Ue+=3;ze-- >0;)Nr.push(0);break;case 18:for(ze=11+Ee(xe,Ue),Ue+=7;ze-- >0;)Nr.push(0);break;default:Nr.push(Sr),It<Sr&&(It=Sr);break}var Wn=Nr.slice(0,Fe),mn=Nr.slice(Fe);for(vr=Fe;vr<286;++vr)Wn[vr]=0;for(vr=Re;vr<30;++vr)mn[vr]=0;return at=sr(Wn,$e,286),vt=sr(mn,_t,30),Ue}function Ht(xe,Ue){if(xe[0]==3&&!(xe[1]&3))return[Td(Ue),2];for(var Fe=0,Re=0,Te=lv(Ue||1<<18),ze=0,mt=Te.length>>>0,Ut=0,It=0;(Re&1)==0;){if(Re=se(xe,Fe),Fe+=3,Re>>>1)Re>>1==1?(Ut=9,It=5):(Fe=Bt(xe,Fe),Ut=at,It=vt);else{Fe&7&&(Fe+=8-(Fe&7));var Tt=xe[Fe>>>3]|xe[(Fe>>>3)+1]<<8;if(Fe+=32,Tt>0)for(!Ue&&mt<ze+Tt&&(Te=lr(Te,ze+Tt),mt=Te.length);Tt-- >0;)Te[ze++]=xe[Fe>>>3],Fe+=8;continue}for(;;){!Ue&&mt<ze+32767&&(Te=lr(Te,ze+32767),mt=Te.length);var gt=Ne(xe,Fe,Ut),ir=Re>>>1==1?st[gt]:$e[gt];if(Fe+=ir&15,ir>>>=4,(ir>>>8&255)===0)Te[ze++]=ir;else{if(ir==256)break;ir-=257;var vr=ir<8?0:ir-4>>2;vr>5&&(vr=0);var Sr=ze+bt[ir];vr>0&&(Sr+=Ne(xe,Fe,vr),Fe+=vr),gt=Ne(xe,Fe,It),ir=Re>>>1==1?fe[gt]:_t[gt],Fe+=ir&15,ir>>>=4;var dr=ir<4?0:ir-2>>1,xr=Vt[ir];for(dr>0&&(xr+=Ne(xe,Fe,dr),Fe+=dr),!Ue&&mt<Sr&&(Te=lr(Te,Sr+100),mt=Te.length);ze<Sr;)Te[ze]=Te[ze-xr],++ze}}}return Ue?[Te,Fe+7>>>3]:[Te.slice(0,ze),Fe+7>>>3]}function Tr(xe,Ue){var Fe=xe.slice(xe.l||0),Re=Ht(Fe,Ue);return xe.l+=Re[1],Re[0]}function hr(xe,Ue){if(xe)typeof console<"u"&&console.error(Ue);else throw new Error(Ue)}function Gr(xe,Ue){var Fe=xe;mo(Fe,0);var Re=[],Te=[],ze={FileIndex:Re,FullPaths:Te};ie(ze,{root:Ue.root});for(var mt=Fe.length-4;(Fe[mt]!=80||Fe[mt+1]!=75||Fe[mt+2]!=5||Fe[mt+3]!=6)&&mt>=0;)--mt;Fe.l=mt+4,Fe.l+=4;var Ut=Fe.read_shift(2);Fe.l+=6;var It=Fe.read_shift(4);for(Fe.l=It,mt=0;mt<Ut;++mt){Fe.l+=20;var Tt=Fe.read_shift(4),gt=Fe.read_shift(4),ir=Fe.read_shift(2),vr=Fe.read_shift(2),Sr=Fe.read_shift(2);Fe.l+=8;var dr=Fe.read_shift(4),xr=s(Fe.slice(Fe.l+ir,Fe.l+ir+vr));Fe.l+=ir+vr+Sr;var Nr=Fe.l;Fe.l=dr+4,xn(Fe,Tt,gt,ze,xr),Fe.l=Nr}return ze}function xn(xe,Ue,Fe,Re,Te){xe.l+=2;var ze=xe.read_shift(2),mt=xe.read_shift(2),Ut=_(xe);if(ze&8257)throw new Error("Unsupported ZIP encryption");for(var It=xe.read_shift(4),Tt=xe.read_shift(4),gt=xe.read_shift(4),ir=xe.read_shift(2),vr=xe.read_shift(2),Sr="",dr=0;dr<ir;++dr)Sr+=String.fromCharCode(xe[xe.l++]);if(vr){var xr=s(xe.slice(xe.l,xe.l+vr));(xr[21589]||{}).mt&&(Ut=xr[21589].mt),((Te||{})[21589]||{}).mt&&(Ut=Te[21589].mt)}xe.l+=vr;var Nr=xe.slice(xe.l,xe.l+Tt);switch(mt){case 8:Nr=Ve(xe,gt);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+mt)}var Wn=!1;ze&8&&(It=xe.read_shift(4),It==134695760&&(It=xe.read_shift(4),Wn=!0),Tt=xe.read_shift(4),gt=xe.read_shift(4)),Tt!=Ue&&hr(Wn,"Bad compressed size: "+Ue+" != "+Tt),gt!=Fe&&hr(Wn,"Bad uncompressed size: "+Fe+" != "+gt),ga(Re,Sr,Nr,{unsafe:!0,mt:Ut})}function an(xe,Ue){var Fe=Ue||{},Re=[],Te=[],ze=As(1),mt=Fe.compression?8:0,Ut=0,It=0,Tt=0,gt=0,ir=0,vr=xe.FullPaths[0],Sr=vr,dr=xe.FileIndex[0],xr=[],Nr=0;for(It=1;It<xe.FullPaths.length;++It)if(Sr=xe.FullPaths[It].slice(vr.length),dr=xe.FileIndex[It],!(!dr.size||!dr.content||Sr=="Sh33tJ5")){var Wn=gt,mn=As(Sr.length);for(Tt=0;Tt<Sr.length;++Tt)mn.write_shift(1,Sr.charCodeAt(Tt)&127);mn=mn.slice(0,mn.l),xr[ir]=dE.buf(dr.content,0);var tn=dr.content;mt==8&&(tn=Pe(tn)),ze=As(30),ze.write_shift(4,67324752),ze.write_shift(2,20),ze.write_shift(2,Ut),ze.write_shift(2,mt),dr.mt?b(ze,dr.mt):ze.write_shift(4,0),ze.write_shift(-4,xr[ir]),ze.write_shift(4,tn.length),ze.write_shift(4,dr.content.length),ze.write_shift(2,mn.length),ze.write_shift(2,0),gt+=ze.length,Re.push(ze),gt+=mn.length,Re.push(mn),gt+=tn.length,Re.push(tn),ze=As(46),ze.write_shift(4,33639248),ze.write_shift(2,0),ze.write_shift(2,20),ze.write_shift(2,Ut),ze.write_shift(2,mt),ze.write_shift(4,0),ze.write_shift(-4,xr[ir]),ze.write_shift(4,tn.length),ze.write_shift(4,dr.content.length),ze.write_shift(2,mn.length),ze.write_shift(2,0),ze.write_shift(2,0),ze.write_shift(2,0),ze.write_shift(2,0),ze.write_shift(4,0),ze.write_shift(4,Wn),Nr+=ze.l,Te.push(ze),Nr+=mn.length,Te.push(mn),++ir}return ze=As(22),ze.write_shift(4,101010256),ze.write_shift(2,0),ze.write_shift(2,0),ze.write_shift(2,ir),ze.write_shift(2,ir),ze.write_shift(4,Nr),ze.write_shift(4,gt),ze.write_shift(2,0),gd([gd(Re),gd(Te),ze])}var xt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ln(xe,Ue){if(xe.ctype)return xe.ctype;var Fe=xe.name||"",Re=Fe.match(/\.([^\.]+)$/);return Re&&xt[Re[1]]||Ue&&(Re=(Fe=Ue).match(/[\.\\]([^\.\\])+$/),Re&&xt[Re[1]])?xt[Re[1]]:"application/octet-stream"}function ya(xe){for(var Ue=ov(xe),Fe=[],Re=0;Re<Ue.length;Re+=76)Fe.push(Ue.slice(Re,Re+76));return Fe.join(`\r
`)+`\r
`}function Mr(xe){var Ue=xe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Tt){var gt=Tt.charCodeAt(0).toString(16).toUpperCase();return"="+(gt.length==1?"0"+gt:gt)});Ue=Ue.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Ue.charAt(0)==`
`&&(Ue="=0D"+Ue.slice(1)),Ue=Ue.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Fe=[],Re=Ue.split(`\r
`),Te=0;Te<Re.length;++Te){var ze=Re[Te];if(ze.length==0){Fe.push("");continue}for(var mt=0;mt<ze.length;){var Ut=76,It=ze.slice(mt,mt+Ut);It.charAt(Ut-1)=="="?Ut--:It.charAt(Ut-2)=="="?Ut-=2:It.charAt(Ut-3)=="="&&(Ut-=3),It=ze.slice(mt,mt+Ut),mt+=Ut,mt<ze.length&&(It+="="),Fe.push(It)}}return Fe.join(`\r
`)}function Fn(xe){for(var Ue=[],Fe=0;Fe<xe.length;++Fe){for(var Re=xe[Fe];Fe<=xe.length&&Re.charAt(Re.length-1)=="=";)Re=Re.slice(0,Re.length-1)+xe[++Fe];Ue.push(Re)}for(var Te=0;Te<Ue.length;++Te)Ue[Te]=Ue[Te].replace(/[=][0-9A-Fa-f]{2}/g,function(ze){return String.fromCharCode(parseInt(ze.slice(1),16))});return eh(Ue.join(`\r
`))}function Ga(xe,Ue,Fe){for(var Re="",Te="",ze="",mt,Ut=0;Ut<10;++Ut){var It=Ue[Ut];if(!It||It.match(/^\s*$/))break;var Tt=It.match(/^(.*?):\s*([^\s].*)$/);if(Tt)switch(Tt[1].toLowerCase()){case"content-location":Re=Tt[2].trim();break;case"content-type":ze=Tt[2].trim();break;case"content-transfer-encoding":Te=Tt[2].trim();break}}switch(++Ut,Te.toLowerCase()){case"base64":mt=eh(Ic(Ue.slice(Ut).join("")));break;case"quoted-printable":mt=Fn(Ue.slice(Ut));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Te)}var gt=ga(xe,Re.slice(Fe.length),mt,{unsafe:!0});ze&&(gt.ctype=ze)}function Vn(xe,Ue){if(Be(xe.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Fe=Ue&&Ue.root||"",Re=(ta&&Buffer.isBuffer(xe)?xe.toString("binary"):Be(xe)).split(`\r
`),Te=0,ze="";for(Te=0;Te<Re.length;++Te)if(ze=Re[Te],!!/^Content-Location:/i.test(ze)&&(ze=ze.slice(ze.indexOf("file")),Fe||(Fe=ze.slice(0,ze.lastIndexOf("/")+1)),ze.slice(0,Fe.length)!=Fe))for(;Fe.length>0&&(Fe=Fe.slice(0,Fe.length-1),Fe=Fe.slice(0,Fe.lastIndexOf("/")+1),ze.slice(0,Fe.length)!=Fe););var mt=(Re[1]||"").match(/boundary="(.*?)"/);if(!mt)throw new Error("MAD cannot find boundary");var Ut="--"+(mt[1]||""),It=[],Tt=[],gt={FileIndex:It,FullPaths:Tt};ie(gt);var ir,vr=0;for(Te=0;Te<Re.length;++Te){var Sr=Re[Te];Sr!==Ut&&Sr!==Ut+"--"||(vr++&&Ga(gt,Re.slice(ir,Te),Fe),ir=Te)}return gt}function va(xe,Ue){var Fe=Ue||{},Re=Fe.boundary||"SheetJS";Re="------="+Re;for(var Te=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Re.slice(2)+'"',"","",""],ze=xe.FullPaths[0],mt=ze,Ut=xe.FileIndex[0],It=1;It<xe.FullPaths.length;++It)if(mt=xe.FullPaths[It].slice(ze.length),Ut=xe.FileIndex[It],!(!Ut.size||!Ut.content||mt=="Sh33tJ5")){mt=mt.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Nr){return"_x"+Nr.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Nr){return"_u"+Nr.charCodeAt(0).toString(16)+"_"});for(var Tt=Ut.content,gt=ta&&Buffer.isBuffer(Tt)?Tt.toString("binary"):Be(Tt),ir=0,vr=Math.min(1024,gt.length),Sr=0,dr=0;dr<=vr;++dr)(Sr=gt.charCodeAt(dr))>=32&&Sr<128&&++ir;var xr=ir>=vr*4/5;Te.push(Re),Te.push("Content-Location: "+(Fe.root||"file:///C:/SheetJS/")+mt),Te.push("Content-Transfer-Encoding: "+(xr?"quoted-printable":"base64")),Te.push("Content-Type: "+Ln(Ut,mt)),Te.push(""),Te.push(xr?Mr(gt):ya(gt))}return Te.push(Re+`--\r
`),Te.join(`\r
`)}function gn(xe){var Ue={};return ie(Ue,xe),Ue}function ga(xe,Ue,Fe,Re){var Te=Re&&Re.unsafe;Te||ie(xe);var ze=!Te&&sa.find(xe,Ue);if(!ze){var mt=xe.FullPaths[0];Ue.slice(0,mt.length)==mt?mt=Ue:(mt.slice(-1)!="/"&&(mt+="/"),mt=(mt+Ue).replace("//","/")),ze={name:p(Ue),type:2},xe.FileIndex.push(ze),xe.FullPaths.push(mt),Te||sa.utils.cfb_gc(xe)}return ze.content=Fe,ze.size=Fe?Fe.length:0,Re&&(Re.CLSID&&(ze.clsid=Re.CLSID),Re.mt&&(ze.mt=Re.mt),Re.ct&&(ze.ct=Re.ct)),ze}function Yi(xe,Ue){ie(xe);var Fe=sa.find(xe,Ue);if(Fe){for(var Re=0;Re<xe.FileIndex.length;++Re)if(xe.FileIndex[Re]==Fe)return xe.FileIndex.splice(Re,1),xe.FullPaths.splice(Re,1),!0}return!1}function xo(xe,Ue,Fe){ie(xe);var Re=sa.find(xe,Ue);if(Re){for(var Te=0;Te<xe.FileIndex.length;++Te)if(xe.FileIndex[Te]==Re)return xe.FileIndex[Te].name=p(Fe),xe.FullPaths[Te]=Fe,!0}return!1}function Xt(xe){we(xe,!0)}return u.find=et,u.read=ve,u.parse=D,u.write=Mt,u.writeFile=$t,u.utils={cfb_new:gn,cfb_add:ga,cfb_del:Yi,cfb_mov:xo,cfb_gc:Xt,ReadShift:bg,CheckField:E2,prep_blob:mo,bconcat:gd,use_zlib:re,_deflateRaw:je,_inflateRaw:Tr,consts:We},u})();function pE(r){if(typeof Deno<"u")return Deno.readFileSync(r);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(r);u.open("r"),u.encoding="binary";var l=u.read();return u.close(),l}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("Cannot access file "+r)}function Gh(r){for(var u=Object.keys(r),l=[],f=0;f<u.length;++f)Object.prototype.hasOwnProperty.call(r,u[f])&&l.push(u[f]);return l}function s1(r){for(var u=[],l=Gh(r),f=0;f!==l.length;++f)u[r[l[f]]]=l[f];return u}var Tx=new Date(1899,11,30,0,0,0);function Tl(r,u){var l=r.getTime(),f=Tx.getTime()+(r.getTimezoneOffset()-Tx.getTimezoneOffset())*6e4;return(l-f)/(1440*60*1e3)}var a2=new Date,mE=Tx.getTime()+(a2.getTimezoneOffset()-Tx.getTimezoneOffset())*6e4,gv=a2.getTimezoneOffset();function Ox(r){var u=new Date;return u.setTime(r*24*60*60*1e3+mE),u.getTimezoneOffset()!==gv&&u.setTime(u.getTime()+(u.getTimezoneOffset()-gv)*6e4),u}function gE(r){var u=0,l=0,f=!1,p=r.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!p)throw new Error("|"+r+"| is not an ISO8601 Duration");for(var b=1;b!=p.length;++b)if(p[b]){switch(l=1,b>3&&(f=!0),p[b].slice(p[b].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+p[b].slice(p[b].length-1));case"D":l*=24;case"H":l*=60;case"M":if(f)l*=60;else throw new Error("Unsupported ISO Duration Field: M")}u+=l*parseInt(p[b],10)}return u}var _v=new Date("2017-02-19T19:06:09.000Z"),i2=isNaN(_v.getFullYear())?new Date("2/19/17"):_v,_E=i2.getFullYear()==2017;function Ys(r,u){var l=new Date(r);if(_E)return u>0?l.setTime(l.getTime()+l.getTimezoneOffset()*60*1e3):u<0&&l.setTime(l.getTime()-l.getTimezoneOffset()*60*1e3),l;if(r instanceof Date)return r;if(i2.getFullYear()==1917&&!isNaN(l.getFullYear())){var f=l.getFullYear();return r.indexOf(""+f)>-1||l.setFullYear(l.getFullYear()+100),l}var p=r.match(/\d+/g)||["2017","2","19","0","0","0"],b=new Date(+p[0],+p[1]-1,+p[2],+p[3]||0,+p[4]||0,+p[5]||0);return r.indexOf("Z")>-1&&(b=new Date(b.getTime()-b.getTimezoneOffset()*60*1e3)),b}function Ep(r,u){if(ta&&Buffer.isBuffer(r)){if(u){if(r[0]==255&&r[1]==254)return _g(r.slice(2).toString("utf16le"));if(r[1]==254&&r[2]==255)return _g(qb(r.slice(2).toString("binary")))}return r.toString("binary")}if(typeof TextDecoder<"u")try{if(u){if(r[0]==255&&r[1]==254)return _g(new TextDecoder("utf-16le").decode(r.slice(2)));if(r[0]==254&&r[1]==255)return _g(new TextDecoder("utf-16be").decode(r.slice(2)))}var l={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(r)&&(r=new Uint8Array(r)),new TextDecoder("latin1").decode(r).replace(/[]/g,function(b){return l[b]||b})}catch{}for(var f=[],p=0;p!=r.length;++p)f.push(String.fromCharCode(r[p]));return f.join("")}function go(r){if(typeof JSON<"u"&&!Array.isArray(r))return JSON.parse(JSON.stringify(r));if(typeof r!="object"||r==null)return r;if(r instanceof Date)return new Date(r.getTime());var u={};for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(u[l]=go(r[l]));return u}function $i(r,u){for(var l="";l.length<u;)l+=r;return l}function ah(r){var u=Number(r);if(!isNaN(u))return isFinite(u)?u:NaN;if(!/\d/.test(r))return u;var l=1,f=r.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return l*=100,""});return!isNaN(u=Number(f))||(f=f.replace(/[(](.*)[)]/,function(p,b){return l=-l,b}),!isNaN(u=Number(f)))?u/l:u}var xE=["january","february","march","april","may","june","july","august","september","october","november","december"];function X0(r){var u=new Date(r),l=new Date(NaN),f=u.getYear(),p=u.getMonth(),b=u.getDate();if(isNaN(b))return l;var _=r.toLowerCase();if(_.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(_=_.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),_.length>3&&xE.indexOf(_)==-1)return l}else if(_.match(/[a-z]/))return l;return f<0||f>8099?l:(p>0||b>1)&&f!=101?u:r.match(/[^-0-9:,\/\\]/)?l:u}var yE=(function(){var r="abacaba".split(/(:?b)/i).length==5;return function(l,f,p){if(r||typeof f=="string")return l.split(f);for(var b=l.split(f),_=[b[0]],s=1;s<b.length;++s)_.push(p),_.push(b[s]);return _}})();function s2(r){return r?r.content&&r.type?Ep(r.content,!0):r.data?pg(r.data):r.asNodeBuffer&&ta?pg(r.asNodeBuffer().toString("binary")):r.asBinary?pg(r.asBinary()):r._data&&r._data.getContent?pg(Ep(Array.prototype.slice.call(r._data.getContent(),0))):null:null}function o2(r){if(!r)return null;if(r.data)return iv(r.data);if(r.asNodeBuffer&&ta)return r.asNodeBuffer();if(r._data&&r._data.getContent){var u=r._data.getContent();return typeof u=="string"?iv(u):Array.prototype.slice.call(u)}return r.content&&r.type?r.content:null}function vE(r){return r&&r.name.slice(-4)===".bin"?o2(r):s2(r)}function su(r,u){for(var l=r.FullPaths||Gh(r.files),f=u.toLowerCase().replace(/[\/]/g,"\\"),p=f.replace(/\\/g,"/"),b=0;b<l.length;++b){var _=l[b].replace(/^Root Entry[\/]/,"").toLowerCase();if(f==_||p==_)return r.files?r.files[l[b]]:r.FileIndex[b]}return null}function o1(r,u){var l=su(r,u);if(l==null)throw new Error("Cannot find file "+u+" in zip");return l}function gs(r,u,l){if(!l)return vE(o1(r,u));if(!u)return null;try{return gs(r,u)}catch{return null}}function Rc(r,u,l){if(!l)return s2(o1(r,u));if(!u)return null;try{return Rc(r,u)}catch{return null}}function bE(r,u,l){return o2(o1(r,u))}function xv(r){for(var u=r.FullPaths||Gh(r.files),l=[],f=0;f<u.length;++f)u[f].slice(-1)!="/"&&l.push(u[f].replace(/^Root Entry[\/]/,""));return l.sort()}function wE(r,u,l){if(r.FullPaths){if(typeof l=="string"){var f;return ta?f=Cp(l):f=US(l),sa.utils.cfb_add(r,u,f)}sa.utils.cfb_add(r,u,l)}else r.file(u,l)}function l2(r,u){switch(u.type){case"base64":return sa.read(r,{type:"base64"});case"binary":return sa.read(r,{type:"binary"});case"buffer":case"array":return sa.read(r,{type:"buffer"})}throw new Error("Unrecognized type "+u.type)}function gg(r,u){if(r.charAt(0)=="/")return r.slice(1);var l=u.split("/");u.slice(-1)!="/"&&l.pop();for(var f=r.split("/");f.length!==0;){var p=f.shift();p===".."?l.pop():p!=="."&&l.push(p)}return l.join("/")}var c2=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,TE=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,yv=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,SE=/<[^>]*>/g,Zo=c2.match(yv)?yv:SE,EE=/<\w*:/,AE=/<(\/?)\w+:/;function vn(r,u,l){for(var f={},p=0,b=0;p!==r.length&&!((b=r.charCodeAt(p))===32||b===10||b===13);++p);if(u||(f[0]=r.slice(0,p)),p===r.length)return f;var _=r.match(TE),s=0,C="",M=0,D="",B="",U=1;if(_)for(M=0;M!=_.length;++M){for(B=_[M],b=0;b!=B.length&&B.charCodeAt(b)!==61;++b);for(D=B.slice(0,b).trim();B.charCodeAt(b+1)==32;)++b;for(U=(p=B.charCodeAt(b+1))==34||p==39?1:0,C=B.slice(b+1+U,B.length-U),s=0;s!=D.length&&D.charCodeAt(s)!==58;++s);if(s===D.length)D.indexOf("_")>0&&(D=D.slice(0,D.indexOf("_"))),f[D]=C,f[D.toLowerCase()]=C;else{var j=(s===5&&D.slice(0,5)==="xmlns"?"xmlns":"")+D.slice(s+1);if(f[j]&&D.slice(s-3,s)=="ext")continue;f[j]=C,f[j.toLowerCase()]=C}}return f}function Hh(r){return r.replace(AE,"<$1")}var u2={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},kE=s1(u2),ma=(function(){var r=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,u=/_x([\da-fA-F]{4})_/ig;return function l(f){var p=f+"",b=p.indexOf("<![CDATA[");if(b==-1)return p.replace(r,function(s,C){return u2[s]||String.fromCharCode(parseInt(C,s.indexOf("x")>-1?16:10))||s}).replace(u,function(s,C){return String.fromCharCode(parseInt(C,16))});var _=p.indexOf("]]>");return l(p.slice(0,b))+p.slice(b+9,_)+l(p.slice(_+3))}})(),CE=/[&<>'"]/g,ME=/[\u0000-\u001f]/g;function l1(r){var u=r+"";return u.replace(CE,function(l){return kE[l]}).replace(/\n/g,"<br/>").replace(ME,function(l){return"&#x"+("000"+l.charCodeAt(0).toString(16)).slice(-4)+";"})}var vv=(function(){var r=/&#(\d+);/g;function u(l,f){return String.fromCharCode(parseInt(f,10))}return function(f){return f.replace(r,u)}})();function bi(r){switch(r){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function my(r){for(var u="",l=0,f=0,p=0,b=0,_=0,s=0;l<r.length;){if(f=r.charCodeAt(l++),f<128){u+=String.fromCharCode(f);continue}if(p=r.charCodeAt(l++),f>191&&f<224){_=(f&31)<<6,_|=p&63,u+=String.fromCharCode(_);continue}if(b=r.charCodeAt(l++),f<240){u+=String.fromCharCode((f&15)<<12|(p&63)<<6|b&63);continue}_=r.charCodeAt(l++),s=((f&7)<<18|(p&63)<<12|(b&63)<<6|_&63)-65536,u+=String.fromCharCode(55296+(s>>>10&1023)),u+=String.fromCharCode(56320+(s&1023))}return u}function bv(r){var u=Td(2*r.length),l,f,p=1,b=0,_=0,s;for(f=0;f<r.length;f+=p)p=1,(s=r.charCodeAt(f))<128?l=s:s<224?(l=(s&31)*64+(r.charCodeAt(f+1)&63),p=2):s<240?(l=(s&15)*4096+(r.charCodeAt(f+1)&63)*64+(r.charCodeAt(f+2)&63),p=3):(p=4,l=(s&7)*262144+(r.charCodeAt(f+1)&63)*4096+(r.charCodeAt(f+2)&63)*64+(r.charCodeAt(f+3)&63),l-=65536,_=55296+(l>>>10&1023),l=56320+(l&1023)),_!==0&&(u[b++]=_&255,u[b++]=_>>>8,_=0),u[b++]=l%256,u[b++]=l>>>8;return u.slice(0,b).toString("ucs2")}function wv(r){return Cp(r,"binary").toString("utf8")}var J_="foo bar baz",si=ta&&(wv(J_)==my(J_)&&wv||bv(J_)==my(J_)&&bv)||my,_g=ta?function(r){return Cp(r,"utf8").toString("binary")}:function(r){for(var u=[],l=0,f=0,p=0;l<r.length;)switch(f=r.charCodeAt(l++),!0){case f<128:u.push(String.fromCharCode(f));break;case f<2048:u.push(String.fromCharCode(192+(f>>6))),u.push(String.fromCharCode(128+(f&63)));break;case(f>=55296&&f<57344):f-=55296,p=r.charCodeAt(l++)-56320+(f<<10),u.push(String.fromCharCode(240+(p>>18&7))),u.push(String.fromCharCode(144+(p>>12&63))),u.push(String.fromCharCode(128+(p>>6&63))),u.push(String.fromCharCode(128+(p&63)));break;default:u.push(String.fromCharCode(224+(f>>12))),u.push(String.fromCharCode(128+(f>>6&63))),u.push(String.fromCharCode(128+(f&63)))}return u.join("")},Pg=(function(){var r={};return function(l,f){var p=l+"|"+(f||"");return r[p]?r[p]:r[p]=new RegExp("<(?:\\w+:)?"+l+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+l+">",f||"")}})(),h2=(function(){var r=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(u){return[new RegExp("&"+u[0]+";","ig"),u[1]]});return function(l){for(var f=l.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),p=0;p<r.length;++p)f=f.replace(r[p][0],r[p][1]);return f}})(),DE=(function(){var r={};return function(l){return r[l]!==void 0?r[l]:r[l]=new RegExp("<(?:vt:)?"+l+">([\\s\\S]*?)</(?:vt:)?"+l+">","g")}})(),RE=/<\/?(?:vt:)?variant>/g,IE=/<(?:vt:)([^>]*)>([\s\S]*)</;function Tv(r,u){var l=vn(r),f=r.match(DE(l.baseType))||[],p=[];if(f.length!=l.size){if(u.WTF)throw new Error("unexpected vector length "+f.length+" != "+l.size);return p}return f.forEach(function(b){var _=b.replace(RE,"").match(IE);_&&p.push({v:si(_[2]),t:_[1]})}),p}var PE=/(^\s|\s$|\n)/;function FE(r){return Gh(r).map(function(u){return" "+u+'="'+r[u]+'"'}).join("")}function LE(r,u,l){return"<"+r+(l!=null?FE(l):"")+(u!=null?(u.match(PE)?' xml:space="preserve"':"")+">"+u+"</"+r:"/")+">"}function c1(r){if(ta&&Buffer.isBuffer(r))return r.toString("utf8");if(typeof r=="string")return r;if(typeof Uint8Array<"u"&&r instanceof Uint8Array)return si(Mp(n1(r)));throw new Error("Bad input format: expected Buffer or string")}var Fg=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,zE={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},OE=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function BE(r,u){for(var l=1-2*(r[u+7]>>>7),f=((r[u+7]&127)<<4)+(r[u+6]>>>4&15),p=r[u+6]&15,b=5;b>=0;--b)p=p*256+r[u+b];return f==2047?p==0?l*(1/0):NaN:(f==0?f=-1022:(f-=1023,p+=Math.pow(2,52)),l*Math.pow(2,f-52)*p)}function NE(r,u,l){var f=(u<0||1/u==-1/0?1:0)<<7,p=0,b=0,_=f?-u:u;isFinite(_)?_==0?p=b=0:(p=Math.floor(Math.log(_)/Math.LN2),b=_*Math.pow(2,52-p),p<=-1023&&(!isFinite(b)||b<Math.pow(2,52))?p=-1022:(b-=Math.pow(2,52),p+=1023)):(p=2047,b=isNaN(u)?26985:0);for(var s=0;s<=5;++s,b/=256)r[l+s]=b&255;r[l+6]=(p&15)<<4|b&15,r[l+7]=p>>4|f}var Sv=function(r){for(var u=[],l=10240,f=0;f<r[0].length;++f)if(r[0][f])for(var p=0,b=r[0][f].length;p<b;p+=l)u.push.apply(u,r[0][f].slice(p,p+l));return u},Ev=ta?function(r){return r[0].length>0&&Buffer.isBuffer(r[0][0])?Buffer.concat(r[0].map(function(u){return Buffer.isBuffer(u)?u:Cp(u)})):Sv(r)}:Sv,Av=function(r,u,l){for(var f=[],p=u;p<l;p+=2)f.push(String.fromCharCode(Ef(r,p)));return f.join("").replace(wl,"")},u1=ta?function(r,u,l){return Buffer.isBuffer(r)?r.toString("utf16le",u,l).replace(wl,""):Av(r,u,l)}:Av,kv=function(r,u,l){for(var f=[],p=u;p<u+l;++p)f.push(("0"+r[p].toString(16)).slice(-2));return f.join("")},f2=ta?function(r,u,l){return Buffer.isBuffer(r)?r.toString("hex",u,u+l):kv(r,u,l)}:kv,Cv=function(r,u,l){for(var f=[],p=u;p<l;p++)f.push(String.fromCharCode(U0(r,p)));return f.join("")},Gg=ta?function(u,l,f){return Buffer.isBuffer(u)?u.toString("utf8",l,f):Cv(u,l,f)}:Cv,d2=function(r,u){var l=Dc(r,u);return l>0?Gg(r,u+4,u+4+l-1):""},p2=d2,m2=function(r,u){var l=Dc(r,u);return l>0?Gg(r,u+4,u+4+l-1):""},g2=m2,_2=function(r,u){var l=2*Dc(r,u);return l>0?Gg(r,u+4,u+4+l-1):""},x2=_2,y2=function(u,l){var f=Dc(u,l);return f>0?u1(u,l+4,l+4+f):""},v2=y2,b2=function(r,u){var l=Dc(r,u);return l>0?Gg(r,u+4,u+4+l):""},w2=b2,T2=function(r,u){return BE(r,u)},Sx=T2,S2=function(u){return Array.isArray(u)||typeof Uint8Array<"u"&&u instanceof Uint8Array};ta&&(p2=function(u,l){if(!Buffer.isBuffer(u))return d2(u,l);var f=u.readUInt32LE(l);return f>0?u.toString("utf8",l+4,l+4+f-1):""},g2=function(u,l){if(!Buffer.isBuffer(u))return m2(u,l);var f=u.readUInt32LE(l);return f>0?u.toString("utf8",l+4,l+4+f-1):""},x2=function(u,l){if(!Buffer.isBuffer(u))return _2(u,l);var f=2*u.readUInt32LE(l);return u.toString("utf16le",l+4,l+4+f-1)},v2=function(u,l){if(!Buffer.isBuffer(u))return y2(u,l);var f=u.readUInt32LE(l);return u.toString("utf16le",l+4,l+4+f)},w2=function(u,l){if(!Buffer.isBuffer(u))return b2(u,l);var f=u.readUInt32LE(l);return u.toString("utf8",l+4,l+4+f)},Sx=function(u,l){return Buffer.isBuffer(u)?u.readDoubleLE(l):T2(u,l)},S2=function(u){return Buffer.isBuffer(u)||Array.isArray(u)||typeof Uint8Array<"u"&&u instanceof Uint8Array});var U0=function(r,u){return r[u]},Ef=function(r,u){return r[u+1]*256+r[u]},jE=function(r,u){var l=r[u+1]*256+r[u];return l<32768?l:(65535-l+1)*-1},Dc=function(r,u){return r[u+3]*(1<<24)+(r[u+2]<<16)+(r[u+1]<<8)+r[u]},vp=function(r,u){return r[u+3]<<24|r[u+2]<<16|r[u+1]<<8|r[u]},UE=function(r,u){return r[u]<<24|r[u+1]<<16|r[u+2]<<8|r[u+3]};function bg(r,u){var l="",f,p,b=[],_,s,C,M;switch(u){case"dbcs":if(M=this.l,ta&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*r).toString("utf16le");else for(C=0;C<r;++C)l+=String.fromCharCode(Ef(this,M)),M+=2;r*=2;break;case"utf8":l=Gg(this,this.l,this.l+r);break;case"utf16le":r*=2,l=u1(this,this.l,this.l+r);break;case"wstr":return bg.call(this,r,"dbcs");case"lpstr-ansi":l=p2(this,this.l),r=4+Dc(this,this.l);break;case"lpstr-cp":l=g2(this,this.l),r=4+Dc(this,this.l);break;case"lpwstr":l=x2(this,this.l),r=4+2*Dc(this,this.l);break;case"lpp4":r=4+Dc(this,this.l),l=v2(this,this.l),r&2&&(r+=2);break;case"8lpp4":r=4+Dc(this,this.l),l=w2(this,this.l),r&3&&(r+=4-(r&3));break;case"cstr":for(r=0,l="";(_=U0(this,this.l+r++))!==0;)b.push(K_(_));l=b.join("");break;case"_wstr":for(r=0,l="";(_=Ef(this,this.l+r))!==0;)b.push(K_(_)),r+=2;r+=2,l=b.join("");break;case"dbcs-cont":for(l="",M=this.l,C=0;C<r;++C){if(this.lens&&this.lens.indexOf(M)!==-1)return _=U0(this,M),this.l=M+1,s=bg.call(this,r-C,_?"dbcs-cont":"sbcs-cont"),b.join("")+s;b.push(K_(Ef(this,M))),M+=2}l=b.join(""),r*=2;break;case"cpstr":case"sbcs-cont":for(l="",M=this.l,C=0;C!=r;++C){if(this.lens&&this.lens.indexOf(M)!==-1)return _=U0(this,M),this.l=M+1,s=bg.call(this,r-C,_?"dbcs-cont":"sbcs-cont"),b.join("")+s;b.push(K_(U0(this,M))),M+=1}l=b.join("");break;default:switch(r){case 1:return f=U0(this,this.l),this.l++,f;case 2:return f=(u==="i"?jE:Ef)(this,this.l),this.l+=2,f;case 4:case-4:return u==="i"||(this[this.l+3]&128)===0?(f=(r>0?vp:UE)(this,this.l),this.l+=4,f):(p=Dc(this,this.l),this.l+=4,p);case 8:case-8:if(u==="f")return r==8?p=Sx(this,this.l):p=Sx([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,p;r=8;case 16:l=f2(this,this.l,r);break}}return this.l+=r,l}var VE=function(r,u,l){r[l]=u&255,r[l+1]=u>>>8&255,r[l+2]=u>>>16&255,r[l+3]=u>>>24&255},GE=function(r,u,l){r[l]=u&255,r[l+1]=u>>8&255,r[l+2]=u>>16&255,r[l+3]=u>>24&255},HE=function(r,u,l){r[l]=u&255,r[l+1]=u>>>8&255};function qE(r,u,l){var f=0,p=0;if(l==="dbcs"){for(p=0;p!=u.length;++p)HE(this,u.charCodeAt(p),this.l+2*p);f=2*u.length}else if(l==="sbcs"){for(u=u.replace(/[^\x00-\x7F]/g,"_"),p=0;p!=u.length;++p)this[this.l+p]=u.charCodeAt(p)&255;f=u.length}else if(l==="hex"){for(;p<r;++p)this[this.l++]=parseInt(u.slice(2*p,2*p+2),16)||0;return this}else if(l==="utf16le"){var b=Math.min(this.l+r,this.length);for(p=0;p<Math.min(u.length,r);++p){var _=u.charCodeAt(p);this[this.l++]=_&255,this[this.l++]=_>>8}for(;this.l<b;)this[this.l++]=0;return this}else switch(r){case 1:f=1,this[this.l]=u&255;break;case 2:f=2,this[this.l]=u&255,u>>>=8,this[this.l+1]=u&255;break;case 3:f=3,this[this.l]=u&255,u>>>=8,this[this.l+1]=u&255,u>>>=8,this[this.l+2]=u&255;break;case 4:f=4,VE(this,u,this.l);break;case 8:if(f=8,l==="f"){NE(this,u,this.l);break}case 16:break;case-4:f=4,GE(this,u,this.l);break}return this.l+=f,this}function E2(r,u){var l=f2(this,this.l,r.length>>1);if(l!==r)throw new Error(u+"Expected "+r+" saw "+l);this.l+=r.length>>1}function mo(r,u){r.l=u,r.read_shift=bg,r.chk=E2,r.write_shift=qE}function qo(r,u){r.l+=u}function As(r){var u=Td(r);return mo(u,0),u}function If(r,u,l){if(r){var f,p,b;mo(r,r.l||0);for(var _=r.length,s=0,C=0;r.l<_;){s=r.read_shift(1),s&128&&(s=(s&127)+((r.read_shift(1)&127)<<7));var M=Dx[s]||Dx[65535];for(f=r.read_shift(1),b=f&127,p=1;p<4&&f&128;++p)b+=((f=r.read_shift(1))&127)<<7*p;C=r.l+b;var D=M.f&&M.f(r,b,l);if(r.l=C,u(D,M,s))return}}}function Fy(){var r=[],u=ta?256:2048,l=function(M){var D=As(M);return mo(D,0),D},f=l(u),p=function(){f&&(f.length>f.l&&(f=f.slice(0,f.l),f.l=f.length),f.length>0&&r.push(f),f=null)},b=function(M){return f&&M<f.length-f.l?f:(p(),f=l(Math.max(M+1,u)))},_=function(){return p(),gd(r)},s=function(M){p(),f=M,f.l==null&&(f.l=f.length),b(u)};return{next:b,push:s,end:_,_bufs:r}}function wg(r,u,l){var f=go(r);if(u.s?(f.cRel&&(f.c+=u.s.c),f.rRel&&(f.r+=u.s.r)):(f.cRel&&(f.c+=u.c),f.rRel&&(f.r+=u.r)),!l||l.biff<12){for(;f.c>=256;)f.c-=256;for(;f.r>=65536;)f.r-=65536}return f}function Mv(r,u,l){var f=go(r);return f.s=wg(f.s,u.s,l),f.e=wg(f.e,u.s,l),f}function Tg(r,u){if(r.cRel&&r.c<0)for(r=go(r);r.c<0;)r.c+=u>8?16384:256;if(r.rRel&&r.r<0)for(r=go(r);r.r<0;)r.r+=u>8?1048576:u>5?65536:16384;var l=kn(r);return!r.cRel&&r.cRel!=null&&(l=$E(l)),!r.rRel&&r.rRel!=null&&(l=ZE(l)),l}function gy(r,u){return r.s.r==0&&!r.s.rRel&&r.e.r==(u.biff>=12?1048575:u.biff>=8?65536:16384)&&!r.e.rRel?(r.s.cRel?"":"$")+ks(r.s.c)+":"+(r.e.cRel?"":"$")+ks(r.e.c):r.s.c==0&&!r.s.cRel&&r.e.c==(u.biff>=12?16383:255)&&!r.e.cRel?(r.s.rRel?"":"$")+_o(r.s.r)+":"+(r.e.rRel?"":"$")+_o(r.e.r):Tg(r.s,u.biff)+":"+Tg(r.e,u.biff)}function h1(r){return parseInt(WE(r),10)-1}function _o(r){return""+(r+1)}function ZE(r){return r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function WE(r){return r.replace(/\$(\d+)$/,"$1")}function f1(r){for(var u=XE(r),l=0,f=0;f!==u.length;++f)l=26*l+u.charCodeAt(f)-64;return l-1}function ks(r){if(r<0)throw new Error("invalid column "+r);var u="";for(++r;r;r=Math.floor((r-1)/26))u=String.fromCharCode((r-1)%26+65)+u;return u}function $E(r){return r.replace(/^([A-Z])/,"$$$1")}function XE(r){return r.replace(/^\$([A-Z])/,"$1")}function YE(r){return r.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function bl(r){for(var u=0,l=0,f=0;f<r.length;++f){var p=r.charCodeAt(f);p>=48&&p<=57?u=10*u+(p-48):p>=65&&p<=90&&(l=26*l+(p-64))}return{c:l-1,r:u-1}}function kn(r){for(var u=r.c+1,l="";u;u=(u-1)/26|0)l=String.fromCharCode((u-1)%26+65)+l;return l+(r.r+1)}function rm(r){var u=r.indexOf(":");return u==-1?{s:bl(r),e:bl(r)}:{s:bl(r.slice(0,u)),e:bl(r.slice(u+1))}}function oa(r,u){return typeof u>"u"||typeof u=="number"?oa(r.s,r.e):(typeof r!="string"&&(r=kn(r)),typeof u!="string"&&(u=kn(u)),r==u?r:r+":"+u)}function Xi(r){var u={s:{c:0,r:0},e:{c:0,r:0}},l=0,f=0,p=0,b=r.length;for(l=0;f<b&&!((p=r.charCodeAt(f)-64)<1||p>26);++f)l=26*l+p;for(u.s.c=--l,l=0;f<b&&!((p=r.charCodeAt(f)-48)<0||p>9);++f)l=10*l+p;if(u.s.r=--l,f===b||p!=10)return u.e.c=u.s.c,u.e.r=u.s.r,u;for(++f,l=0;f!=b&&!((p=r.charCodeAt(f)-64)<1||p>26);++f)l=26*l+p;for(u.e.c=--l,l=0;f!=b&&!((p=r.charCodeAt(f)-48)<0||p>9);++f)l=10*l+p;return u.e.r=--l,u}function Dv(r,u){var l=r.t=="d"&&u instanceof Date;if(r.z!=null)try{return r.w=lu(r.z,l?Tl(u):u)}catch{}try{return r.w=lu((r.XF||{}).numFmtId||(l?14:0),l?Tl(u):u)}catch{return""+u}}function Df(r,u,l){return r==null||r.t==null||r.t=="z"?"":r.w!==void 0?r.w:(r.t=="d"&&!r.z&&l&&l.dateNF&&(r.z=l.dateNF),r.t=="e"?Ip[r.v]||r.v:u==null?Dv(r,r.v):Dv(r,u))}function Ed(r,u){var l=u&&u.sheet?u.sheet:"Sheet1",f={};return f[l]=r,{SheetNames:[l],Sheets:f}}function A2(r,u,l){var f=l||{},p=r?Array.isArray(r):f.dense,b=r||(p?[]:{}),_=0,s=0;if(b&&f.origin!=null){if(typeof f.origin=="number")_=f.origin;else{var C=typeof f.origin=="string"?bl(f.origin):f.origin;_=C.r,s=C.c}b["!ref"]||(b["!ref"]="A1:A1")}var M={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(b["!ref"]){var D=Xi(b["!ref"]);M.s.c=D.s.c,M.s.r=D.s.r,M.e.c=Math.max(M.e.c,D.e.c),M.e.r=Math.max(M.e.r,D.e.r),_==-1&&(M.e.r=_=D.e.r+1)}for(var B=0;B!=u.length;++B)if(u[B]){if(!Array.isArray(u[B]))throw new Error("aoa_to_sheet expects an array of arrays");for(var U=0;U!=u[B].length;++U)if(!(typeof u[B][U]>"u")){var j={v:u[B][U]},H=_+B,z=s+U;if(M.s.r>H&&(M.s.r=H),M.s.c>z&&(M.s.c=z),M.e.r<H&&(M.e.r=H),M.e.c<z&&(M.e.c=z),u[B][U]&&typeof u[B][U]=="object"&&!Array.isArray(u[B][U])&&!(u[B][U]instanceof Date))j=u[B][U];else if(Array.isArray(j.v)&&(j.f=u[B][U][1],j.v=j.v[0]),j.v===null)if(j.f)j.t="n";else if(f.nullError)j.t="e",j.v=0;else if(f.sheetStubs)j.t="z";else continue;else typeof j.v=="number"?j.t="n":typeof j.v=="boolean"?j.t="b":j.v instanceof Date?(j.z=f.dateNF||Pn[14],f.cellDates?(j.t="d",j.w=lu(j.z,Tl(j.v))):(j.t="n",j.v=Tl(j.v),j.w=lu(j.z,j.v))):j.t="s";if(p)b[H]||(b[H]=[]),b[H][z]&&b[H][z].z&&(j.z=b[H][z].z),b[H][z]=j;else{var N=kn({c:z,r:H});b[N]&&b[N].z&&(j.z=b[N].z),b[N]=j}}}return M.s.c<1e7&&(b["!ref"]=oa(M)),b}function nm(r,u){return A2(null,r,u)}function KE(r){return r.read_shift(4,"i")}function Ho(r){var u=r.read_shift(4);return u===0?"":r.read_shift(u,"dbcs")}function JE(r){return{ich:r.read_shift(2),ifnt:r.read_shift(2)}}function d1(r,u){var l=r.l,f=r.read_shift(1),p=Ho(r),b=[],_={t:p,h:p};if((f&1)!==0){for(var s=r.read_shift(4),C=0;C!=s;++C)b.push(JE(r));_.r=b}else _.r=[{ich:0,ifnt:0}];return r.l=l+u,_}var QE=d1;function uu(r){var u=r.read_shift(4),l=r.read_shift(2);return l+=r.read_shift(1)<<16,r.l++,{c:u,iStyleRef:l}}function Dp(r){var u=r.read_shift(2);return u+=r.read_shift(1)<<16,r.l++,{c:-1,iStyleRef:u}}var eA=Ho;function p1(r){var u=r.read_shift(4);return u===0||u===4294967295?"":r.read_shift(u,"dbcs")}var tA=Ho,Ly=p1;function m1(r){var u=r.slice(r.l,r.l+4),l=u[0]&1,f=u[0]&2;r.l+=4;var p=f===0?Sx([0,0,0,0,u[0]&252,u[1],u[2],u[3]],0):vp(u,0)>>2;return l?p/100:p}function k2(r){var u={s:{},e:{}};return u.s.r=r.read_shift(4),u.e.r=r.read_shift(4),u.s.c=r.read_shift(4),u.e.c=r.read_shift(4),u}var Rp=k2;function Vo(r){if(r.length-r.l<8)throw"XLS Xnum Buffer underflow";return r.read_shift(8,"f")}function rA(r){var u={},l=r.read_shift(1),f=l>>>1,p=r.read_shift(1),b=r.read_shift(2,"i"),_=r.read_shift(1),s=r.read_shift(1),C=r.read_shift(1);switch(r.l++,f){case 0:u.auto=1;break;case 1:u.index=p;var M=Tp[p];M&&(u.rgb=zg(M));break;case 2:u.rgb=zg([_,s,C]);break;case 3:u.theme=p;break}return b!=0&&(u.tint=b>0?b/32767:b/32768),u}function nA(r){var u=r.read_shift(1);r.l++;var l={fBold:u&1,fItalic:u&2,fUnderline:u&4,fStrikeout:u&8,fOutline:u&16,fShadow:u&32,fCondense:u&64,fExtend:u&128};return l}function C2(r,u){var l={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},f=r.read_shift(4);switch(f){case 0:return"";case 4294967295:case 4294967294:return l[r.read_shift(4)]||""}if(f>400)throw new Error("Unsupported Clipboard: "+f.toString(16));return r.l-=4,r.read_shift(0,u==1?"lpstr":"lpwstr")}function aA(r){return C2(r,1)}function iA(r){return C2(r,2)}var g1=2,Kl=3,Q_=11,Rv=12,Ex=19,ex=64,sA=65,oA=71,lA=4108,cA=4126,Xs=80,M2=81,uA=[Xs,M2],hA={1:{n:"CodePage",t:g1},2:{n:"Category",t:Xs},3:{n:"PresentationFormat",t:Xs},4:{n:"ByteCount",t:Kl},5:{n:"LineCount",t:Kl},6:{n:"ParagraphCount",t:Kl},7:{n:"SlideCount",t:Kl},8:{n:"NoteCount",t:Kl},9:{n:"HiddenCount",t:Kl},10:{n:"MultimediaClipCount",t:Kl},11:{n:"ScaleCrop",t:Q_},12:{n:"HeadingPairs",t:lA},13:{n:"TitlesOfParts",t:cA},14:{n:"Manager",t:Xs},15:{n:"Company",t:Xs},16:{n:"LinksUpToDate",t:Q_},17:{n:"CharacterCount",t:Kl},19:{n:"SharedDoc",t:Q_},22:{n:"HyperlinksChanged",t:Q_},23:{n:"AppVersion",t:Kl,p:"version"},24:{n:"DigSig",t:sA},26:{n:"ContentType",t:Xs},27:{n:"ContentStatus",t:Xs},28:{n:"Language",t:Xs},29:{n:"Version",t:Xs},255:{},2147483648:{n:"Locale",t:Ex},2147483651:{n:"Behavior",t:Ex},1919054434:{}},fA={1:{n:"CodePage",t:g1},2:{n:"Title",t:Xs},3:{n:"Subject",t:Xs},4:{n:"Author",t:Xs},5:{n:"Keywords",t:Xs},6:{n:"Comments",t:Xs},7:{n:"Template",t:Xs},8:{n:"LastAuthor",t:Xs},9:{n:"RevNumber",t:Xs},10:{n:"EditTime",t:ex},11:{n:"LastPrinted",t:ex},12:{n:"CreatedDate",t:ex},13:{n:"ModifiedDate",t:ex},14:{n:"PageCount",t:Kl},15:{n:"WordCount",t:Kl},16:{n:"CharCount",t:Kl},17:{n:"Thumbnail",t:oA},18:{n:"Application",t:Xs},19:{n:"DocSecurity",t:Kl},255:{},2147483648:{n:"Locale",t:Ex},2147483651:{n:"Behavior",t:Ex},1919054434:{}},Iv={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},dA=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function pA(r){return r.map(function(u){return[u>>16&255,u>>8&255,u&255]})}var mA=pA([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Tp=go(mA),Ip={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},D2={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Pv={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function gA(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function _A(r){var u=gA();if(!r||!r.match)return u;var l={};if((r.match(Zo)||[]).forEach(function(f){var p=vn(f);switch(p[0].replace(EE,"<")){case"<?xml":break;case"<Types":u.xmlns=p["xmlns"+(p[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":l[p.Extension]=p.ContentType;break;case"<Override":u[Pv[p.ContentType]]!==void 0&&u[Pv[p.ContentType]].push(p.PartName);break}}),u.xmlns!==zE.CT)throw new Error("Unknown Namespace: "+u.xmlns);return u.calcchain=u.calcchains.length>0?u.calcchains[0]:"",u.sst=u.strs.length>0?u.strs[0]:"",u.style=u.styles.length>0?u.styles[0]:"",u.defaults=l,delete u.calcchains,u}var G0={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function zy(r){var u=r.lastIndexOf("/");return r.slice(0,u+1)+"_rels/"+r.slice(u+1)+".rels"}function Sg(r,u){var l={"!id":{}};if(!r)return l;u.charAt(0)!=="/"&&(u="/"+u);var f={};return(r.match(Zo)||[]).forEach(function(p){var b=vn(p);if(b[0]==="<Relationship"){var _={};_.Type=b.Type,_.Target=b.Target,_.Id=b.Id,b.TargetMode&&(_.TargetMode=b.TargetMode);var s=b.TargetMode==="External"?b.Target:gg(b.Target,u);l[s]=_,f[b.Id]=_}}),l["!id"]=f,l}var xA="application/vnd.oasis.opendocument.spreadsheet";function yA(r,u){for(var l=c1(r),f,p;f=Fg.exec(l);)switch(f[3]){case"manifest":break;case"file-entry":if(p=vn(f[0],!1),p.path=="/"&&p.type!==xA)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(u&&u.WTF)throw f}}var Eg=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],vA=(function(){for(var r=new Array(Eg.length),u=0;u<Eg.length;++u){var l=Eg[u],f="(?:"+l[0].slice(0,l[0].indexOf(":"))+":)"+l[0].slice(l[0].indexOf(":")+1);r[u]=new RegExp("<"+f+"[^>]*>([\\s\\S]*?)</"+f+">")}return r})();function R2(r){var u={};r=si(r);for(var l=0;l<Eg.length;++l){var f=Eg[l],p=r.match(vA[l]);p!=null&&p.length>0&&(u[f[1]]=ma(p[1])),f[2]==="date"&&u[f[1]]&&(u[f[1]]=Ys(u[f[1]]))}return u}var bA=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function I2(r,u,l,f){var p=[];if(typeof r=="string")p=Tv(r,f);else for(var b=0;b<r.length;++b)p=p.concat(r[b].map(function(D){return{v:D}}));var _=typeof u=="string"?Tv(u,f).map(function(D){return D.v}):u,s=0,C=0;if(_.length>0)for(var M=0;M!==p.length;M+=2){switch(C=+p[M+1].v,p[M].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":l.Worksheets=C,l.SheetNames=_.slice(s,s+C);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":l.NamedRanges=C,l.DefinedNames=_.slice(s,s+C);break;case"Charts":case"Diagramme":l.Chartsheets=C,l.ChartNames=_.slice(s,s+C);break}s+=C}}function wA(r,u,l){var f={};return u||(u={}),r=si(r),bA.forEach(function(p){var b=(r.match(Pg(p[0]))||[])[1];switch(p[2]){case"string":b&&(u[p[1]]=ma(b));break;case"bool":u[p[1]]=b==="true";break;case"raw":var _=r.match(new RegExp("<"+p[0]+"[^>]*>([\\s\\S]*?)</"+p[0]+">"));_&&_.length>0&&(f[p[1]]=_[1]);break}}),f.HeadingPairs&&f.TitlesOfParts&&I2(f.HeadingPairs,f.TitlesOfParts,u,l),u}var TA=/<[^>]+>[^<]*/g;function SA(r,u){var l={},f="",p=r.match(TA);if(p)for(var b=0;b!=p.length;++b){var _=p[b],s=vn(_);switch(s[0]){case"<?xml":break;case"<Properties":break;case"<property":f=ma(s.name);break;case"</property>":f=null;break;default:if(_.indexOf("<vt:")===0){var C=_.split(">"),M=C[0].slice(4),D=C[1];switch(M){case"lpstr":case"bstr":case"lpwstr":l[f]=ma(D);break;case"bool":l[f]=bi(D);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":l[f]=parseInt(D,10);break;case"r4":case"r8":case"decimal":l[f]=parseFloat(D);break;case"filetime":case"date":l[f]=Ys(D);break;case"cy":case"error":l[f]=ma(D);break;default:if(M.slice(-1)=="/")break;u.WTF&&typeof console<"u"&&console.warn("Unexpected",_,M,C)}}else if(_.slice(0,2)!=="</"){if(u.WTF)throw new Error(_)}}}return l}var EA={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},_y;function AA(r,u,l){_y||(_y=s1(EA)),u=_y[u]||u,r[u]=l}function _1(r){var u=r.read_shift(4),l=r.read_shift(4);return new Date((l/1e7*Math.pow(2,32)+u/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function P2(r,u,l){var f=r.l,p=r.read_shift(0,"lpstr-cp");if(l)for(;r.l-f&3;)++r.l;return p}function F2(r,u,l){var f=r.read_shift(0,"lpwstr");return f}function L2(r,u,l){return u===31?F2(r):P2(r,u,l)}function Oy(r,u,l){return L2(r,u,l===!1?0:4)}function kA(r,u){if(!u)throw new Error("VtUnalignedString must have positive length");return L2(r,u,0)}function CA(r){for(var u=r.read_shift(4),l=[],f=0;f!=u;++f){var p=r.l;l[f]=r.read_shift(0,"lpwstr").replace(wl,""),r.l-p&2&&(r.l+=2)}return l}function MA(r){for(var u=r.read_shift(4),l=[],f=0;f!=u;++f)l[f]=r.read_shift(0,"lpstr-cp").replace(wl,"");return l}function DA(r){var u=r.l,l=Ax(r,M2);r[r.l]==0&&r[r.l+1]==0&&r.l-u&2&&(r.l+=2);var f=Ax(r,Kl);return[l,f]}function RA(r){for(var u=r.read_shift(4),l=[],f=0;f<u/2;++f)l.push(DA(r));return l}function Fv(r,u){for(var l=r.read_shift(4),f={},p=0;p!=l;++p){var b=r.read_shift(4),_=r.read_shift(4);f[b]=r.read_shift(_,u===1200?"utf16le":"utf8").replace(wl,"").replace(mg,"!"),u===1200&&_%2&&(r.l+=2)}return r.l&3&&(r.l=r.l>>3<<2),f}function z2(r){var u=r.read_shift(4),l=r.slice(r.l,r.l+u);return r.l+=u,(u&3)>0&&(r.l+=4-(u&3)&3),l}function IA(r){var u={};return u.Size=r.read_shift(4),r.l+=u.Size+3-(u.Size-1)%4,u}function Ax(r,u,l){var f=r.read_shift(2),p,b=l||{};if(r.l+=2,u!==Rv&&f!==u&&uA.indexOf(u)===-1&&!((u&65534)==4126&&(f&65534)==4126))throw new Error("Expected type "+u+" saw "+f);switch(u===Rv?f:u){case 2:return p=r.read_shift(2,"i"),b.raw||(r.l+=2),p;case 3:return p=r.read_shift(4,"i"),p;case 11:return r.read_shift(4)!==0;case 19:return p=r.read_shift(4),p;case 30:return P2(r,f,4).replace(wl,"");case 31:return F2(r);case 64:return _1(r);case 65:return z2(r);case 71:return IA(r);case 80:return Oy(r,f,!b.raw).replace(wl,"");case 81:return kA(r,f).replace(wl,"");case 4108:return RA(r);case 4126:case 4127:return f==4127?CA(r):MA(r);default:throw new Error("TypedPropertyValue unrecognized type "+u+" "+f)}}function Lv(r,u){var l=r.l,f=r.read_shift(4),p=r.read_shift(4),b=[],_=0,s=0,C=-1,M={};for(_=0;_!=p;++_){var D=r.read_shift(4),B=r.read_shift(4);b[_]=[D,B+l]}b.sort(function(Y,W){return Y[1]-W[1]});var U={};for(_=0;_!=p;++_){if(r.l!==b[_][1]){var j=!0;if(_>0&&u)switch(u[b[_-1][0]].t){case 2:r.l+2===b[_][1]&&(r.l+=2,j=!1);break;case 80:r.l<=b[_][1]&&(r.l=b[_][1],j=!1);break;case 4108:r.l<=b[_][1]&&(r.l=b[_][1],j=!1);break}if((!u||_==0)&&r.l<=b[_][1]&&(j=!1,r.l=b[_][1]),j)throw new Error("Read Error: Expected address "+b[_][1]+" at "+r.l+" :"+_)}if(u){var H=u[b[_][0]];if(U[H.n]=Ax(r,H.t,{raw:!0}),H.p==="version"&&(U[H.n]=String(U[H.n]>>16)+"."+("0000"+String(U[H.n]&65535)).slice(-4)),H.n=="CodePage")switch(U[H.n]){case 0:U[H.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:rh(s=U[H.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+U[H.n])}}else if(b[_][0]===1){if(s=U.CodePage=Ax(r,g1),rh(s),C!==-1){var z=r.l;r.l=b[C][1],M=Fv(r,s),r.l=z}}else if(b[_][0]===0){if(s===0){C=_,r.l=b[_+1][1];continue}M=Fv(r,s)}else{var N=M[b[_][0]],Z;switch(r[r.l]){case 65:r.l+=4,Z=z2(r);break;case 30:r.l+=4,Z=Oy(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 31:r.l+=4,Z=Oy(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 3:r.l+=4,Z=r.read_shift(4,"i");break;case 19:r.l+=4,Z=r.read_shift(4);break;case 5:r.l+=4,Z=r.read_shift(8,"f");break;case 11:r.l+=4,Z=is(r,4);break;case 64:r.l+=4,Z=Ys(_1(r));break;default:throw new Error("unparsed value: "+r[r.l])}U[N]=Z}}return r.l=l+f,U}function zv(r,u,l){var f=r.content;if(!f)return{};mo(f,0);var p,b,_,s,C=0;f.chk("feff","Byte Order: "),f.read_shift(2);var M=f.read_shift(4),D=f.read_shift(16);if(D!==sa.utils.consts.HEADER_CLSID&&D!==l)throw new Error("Bad PropertySet CLSID "+D);if(p=f.read_shift(4),p!==1&&p!==2)throw new Error("Unrecognized #Sets: "+p);if(b=f.read_shift(16),s=f.read_shift(4),p===1&&s!==f.l)throw new Error("Length mismatch: "+s+" !== "+f.l);p===2&&(_=f.read_shift(16),C=f.read_shift(4));var B=Lv(f,u),U={SystemIdentifier:M};for(var j in B)U[j]=B[j];if(U.FMTID=b,p===1)return U;if(C-f.l==2&&(f.l+=2),f.l!==C)throw new Error("Length mismatch 2: "+f.l+" !== "+C);var H;try{H=Lv(f,null)}catch{}for(j in H)U[j]=H[j];return U.FMTID=[b,_],U}function dd(r,u){return r.read_shift(u),null}function PA(r,u,l){for(var f=[],p=r.l+u;r.l<p;)f.push(l(r,p-r.l));if(p!==r.l)throw new Error("Slurp error");return f}function is(r,u){return r.read_shift(u)===1}function _s(r){return r.read_shift(2,"u")}function O2(r,u){return PA(r,u,_s)}function FA(r){var u=r.read_shift(1),l=r.read_shift(1);return l===1?u:u===1}function Hg(r,u,l){var f=r.read_shift(l&&l.biff>=12?2:1),p="sbcs-cont";if(l&&l.biff>=8,!l||l.biff==8){var b=r.read_shift(1);b&&(p="dbcs-cont")}else l.biff==12&&(p="wstr");l.biff>=2&&l.biff<=5&&(p="cpstr");var _=f?r.read_shift(f,p):"";return _}function LA(r){var u=r.read_shift(2),l=r.read_shift(1),f=l&4,p=l&8,b=1+(l&1),_=0,s,C={};p&&(_=r.read_shift(2)),f&&(s=r.read_shift(4));var M=b==2?"dbcs-cont":"sbcs-cont",D=u===0?"":r.read_shift(u,M);return p&&(r.l+=4*_),f&&(r.l+=s),C.t=D,p||(C.raw="<t>"+C.t+"</t>",C.r=C.t),C}function Ap(r,u,l){var f;if(l){if(l.biff>=2&&l.biff<=5)return r.read_shift(u,"cpstr");if(l.biff>=12)return r.read_shift(u,"dbcs-cont")}var p=r.read_shift(1);return p===0?f=r.read_shift(u,"sbcs-cont"):f=r.read_shift(u,"dbcs-cont"),f}function qg(r,u,l){var f=r.read_shift(l&&l.biff==2?1:2);return f===0?(r.l++,""):Ap(r,f,l)}function Pp(r,u,l){if(l.biff>5)return qg(r,u,l);var f=r.read_shift(1);return f===0?(r.l++,""):r.read_shift(f,l.biff<=4||!r.lens?"cpstr":"sbcs-cont")}function zA(r){var u=r.read_shift(1);r.l++;var l=r.read_shift(2);return r.l+=2,[u,l]}function OA(r){var u=r.read_shift(4),l=r.l,f=!1;u>24&&(r.l+=u-24,r.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(f=!0),r.l=l);var p=r.read_shift((f?u-24:u)>>1,"utf16le").replace(wl,"");return f&&(r.l+=24),p}function BA(r){for(var u=r.read_shift(2),l="";u-- >0;)l+="../";var f=r.read_shift(0,"lpstr-ansi");if(r.l+=2,r.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var p=r.read_shift(4);if(p===0)return l+f.replace(/\\/g,"/");var b=r.read_shift(4);if(r.read_shift(2)!=3)throw new Error("Bad FileMoniker");var _=r.read_shift(b>>1,"utf16le").replace(wl,"");return l+_}function NA(r,u){var l=r.read_shift(16);switch(l){case"e0c9ea79f9bace118c8200aa004ba90b":return OA(r);case"0303000000000000c000000000000046":return BA(r);default:throw new Error("Unsupported Moniker "+l)}}function tx(r){var u=r.read_shift(4),l=u>0?r.read_shift(u,"utf16le").replace(wl,""):"";return l}function jA(r,u){var l=r.l+u,f=r.read_shift(4);if(f!==2)throw new Error("Unrecognized streamVersion: "+f);var p=r.read_shift(2);r.l+=2;var b,_,s,C,M="",D,B;p&16&&(b=tx(r,l-r.l)),p&128&&(_=tx(r,l-r.l)),(p&257)===257&&(s=tx(r,l-r.l)),(p&257)===1&&(C=NA(r,l-r.l)),p&8&&(M=tx(r,l-r.l)),p&32&&(D=r.read_shift(16)),p&64&&(B=_1(r)),r.l=l;var U=_||s||C||"";U&&M&&(U+="#"+M),U||(U="#"+M),p&2&&U.charAt(0)=="/"&&U.charAt(1)!="/"&&(U="file://"+U);var j={Target:U};return D&&(j.guid=D),B&&(j.time=B),b&&(j.Tooltip=b),j}function B2(r){var u=r.read_shift(1),l=r.read_shift(1),f=r.read_shift(1),p=r.read_shift(1);return[u,l,f,p]}function N2(r,u){var l=B2(r);return l[3]=0,l}function qh(r){var u=r.read_shift(2),l=r.read_shift(2),f=r.read_shift(2);return{r:u,c:l,ixfe:f}}function UA(r){var u=r.read_shift(2),l=r.read_shift(2);return r.l+=8,{type:u,flags:l}}function VA(r,u,l){return u===0?"":Pp(r,u,l)}function GA(r,u,l){var f=l.biff>8?4:2,p=r.read_shift(f),b=r.read_shift(f,"i"),_=r.read_shift(f,"i");return[p,b,_]}function j2(r){var u=r.read_shift(2),l=m1(r);return[u,l]}function HA(r,u,l){r.l+=4,u-=4;var f=r.l+u,p=Hg(r,u,l),b=r.read_shift(2);if(f-=r.l,b!==f)throw new Error("Malformed AddinUdf: padding = "+f+" != "+b);return r.l+=b,p}function Bx(r){var u=r.read_shift(2),l=r.read_shift(2),f=r.read_shift(2),p=r.read_shift(2);return{s:{c:f,r:u},e:{c:p,r:l}}}function U2(r){var u=r.read_shift(2),l=r.read_shift(2),f=r.read_shift(1),p=r.read_shift(1);return{s:{c:f,r:u},e:{c:p,r:l}}}var qA=U2;function V2(r){r.l+=4;var u=r.read_shift(2),l=r.read_shift(2),f=r.read_shift(2);return r.l+=12,[l,u,f]}function ZA(r){var u={};return r.l+=4,r.l+=16,u.fSharedNote=r.read_shift(2),r.l+=4,u}function WA(r){var u={};return r.l+=4,r.cf=r.read_shift(2),u}function jo(r){r.l+=2,r.l+=r.read_shift(2)}var $A={0:jo,4:jo,5:jo,6:jo,7:WA,8:jo,9:jo,10:jo,11:jo,12:jo,13:ZA,14:jo,15:jo,16:jo,17:jo,18:jo,19:jo,20:jo,21:V2};function XA(r,u){for(var l=r.l+u,f=[];r.l<l;){var p=r.read_shift(2);r.l-=2;try{f.push($A[p](r,l-r.l))}catch{return r.l=l,f}}return r.l!=l&&(r.l=l),f}function rx(r,u){var l={BIFFVer:0,dt:0};switch(l.BIFFVer=r.read_shift(2),u-=2,u>=2&&(l.dt=r.read_shift(2),r.l-=2),l.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(u>6)throw new Error("Unexpected BIFF Ver "+l.BIFFVer)}return r.read_shift(u),l}function YA(r,u){return u===0||r.read_shift(2),1200}function KA(r,u,l){if(l.enc)return r.l+=u,"";var f=r.l,p=Pp(r,0,l);return r.read_shift(u+f-r.l),p}function JA(r,u,l){var f=l&&l.biff==8||u==2?r.read_shift(2):(r.l+=u,0);return{fDialog:f&16,fBelow:f&64,fRight:f&128}}function QA(r,u,l){var f=r.read_shift(4),p=r.read_shift(1)&3,b=r.read_shift(1);switch(b){case 0:b="Worksheet";break;case 1:b="Macrosheet";break;case 2:b="Chartsheet";break;case 6:b="VBAModule";break}var _=Hg(r,0,l);return _.length===0&&(_="Sheet1"),{pos:f,hs:p,dt:b,name:_}}function ek(r,u){for(var l=r.l+u,f=r.read_shift(4),p=r.read_shift(4),b=[],_=0;_!=p&&r.l<l;++_)b.push(LA(r));return b.Count=f,b.Unique=p,b}function tk(r,u){var l={};return l.dsst=r.read_shift(2),r.l+=u-2,l}function rk(r){var u={};u.r=r.read_shift(2),u.c=r.read_shift(2),u.cnt=r.read_shift(2)-u.c;var l=r.read_shift(2);r.l+=4;var f=r.read_shift(1);return r.l+=3,f&7&&(u.level=f&7),f&32&&(u.hidden=!0),f&64&&(u.hpt=l/20),u}function nk(r){var u=UA(r);if(u.type!=2211)throw new Error("Invalid Future Record "+u.type);var l=r.read_shift(4);return l!==0}function ak(r){return r.read_shift(2),r.read_shift(4)}function Ov(r,u,l){var f=0;l&&l.biff==2||(f=r.read_shift(2));var p=r.read_shift(2);l&&l.biff==2&&(f=1-(p>>15),p&=32767);var b={Unsynced:f&1,DyZero:(f&2)>>1,ExAsc:(f&4)>>2,ExDsc:(f&8)>>3};return[b,p]}function ik(r){var u=r.read_shift(2),l=r.read_shift(2),f=r.read_shift(2),p=r.read_shift(2),b=r.read_shift(2),_=r.read_shift(2),s=r.read_shift(2),C=r.read_shift(2),M=r.read_shift(2);return{Pos:[u,l],Dim:[f,p],Flags:b,CurTab:_,FirstTab:s,Selected:C,TabRatio:M}}function sk(r,u,l){if(l&&l.biff>=2&&l.biff<5)return{};var f=r.read_shift(2);return{RTL:f&64}}function ok(){}function lk(r,u,l){var f={dyHeight:r.read_shift(2),fl:r.read_shift(2)};switch(l&&l.biff||8){case 2:break;case 3:case 4:r.l+=2;break;default:r.l+=10;break}return f.name=Hg(r,0,l),f}function ck(r){var u=qh(r);return u.isst=r.read_shift(4),u}function uk(r,u,l){l.biffguess&&l.biff==2&&(l.biff=5);var f=r.l+u,p=qh(r);l.biff==2&&r.l++;var b=qg(r,f-r.l,l);return p.val=b,p}function hk(r,u,l){var f=r.read_shift(2),p=Pp(r,0,l);return[f,p]}var fk=Pp;function Bv(r,u,l){var f=r.l+u,p=l.biff==8||!l.biff?4:2,b=r.read_shift(p),_=r.read_shift(p),s=r.read_shift(2),C=r.read_shift(2);return r.l=f,{s:{r:b,c:s},e:{r:_,c:C}}}function dk(r){var u=r.read_shift(2),l=r.read_shift(2),f=j2(r);return{r:u,c:l,ixfe:f[0],rknum:f[1]}}function pk(r,u){for(var l=r.l+u-2,f=r.read_shift(2),p=r.read_shift(2),b=[];r.l<l;)b.push(j2(r));if(r.l!==l)throw new Error("MulRK read error");var _=r.read_shift(2);if(b.length!=_-p+1)throw new Error("MulRK length mismatch");return{r:f,c:p,C:_,rkrec:b}}function mk(r,u){for(var l=r.l+u-2,f=r.read_shift(2),p=r.read_shift(2),b=[];r.l<l;)b.push(r.read_shift(2));if(r.l!==l)throw new Error("MulBlank read error");var _=r.read_shift(2);if(b.length!=_-p+1)throw new Error("MulBlank length mismatch");return{r:f,c:p,C:_,ixfe:b}}function gk(r,u,l,f){var p={},b=r.read_shift(4),_=r.read_shift(4),s=r.read_shift(4),C=r.read_shift(2);return p.patternType=dA[s>>26],f.cellStyles&&(p.alc=b&7,p.fWrap=b>>3&1,p.alcV=b>>4&7,p.fJustLast=b>>7&1,p.trot=b>>8&255,p.cIndent=b>>16&15,p.fShrinkToFit=b>>20&1,p.iReadOrder=b>>22&2,p.fAtrNum=b>>26&1,p.fAtrFnt=b>>27&1,p.fAtrAlc=b>>28&1,p.fAtrBdr=b>>29&1,p.fAtrPat=b>>30&1,p.fAtrProt=b>>31&1,p.dgLeft=_&15,p.dgRight=_>>4&15,p.dgTop=_>>8&15,p.dgBottom=_>>12&15,p.icvLeft=_>>16&127,p.icvRight=_>>23&127,p.grbitDiag=_>>30&3,p.icvTop=s&127,p.icvBottom=s>>7&127,p.icvDiag=s>>14&127,p.dgDiag=s>>21&15,p.icvFore=C&127,p.icvBack=C>>7&127,p.fsxButton=C>>14&1),p}function _k(r,u,l){var f={};return f.ifnt=r.read_shift(2),f.numFmtId=r.read_shift(2),f.flags=r.read_shift(2),f.fStyle=f.flags>>2&1,u-=6,f.data=gk(r,u,f.fStyle,l),f}function xk(r){r.l+=4;var u=[r.read_shift(2),r.read_shift(2)];if(u[0]!==0&&u[0]--,u[1]!==0&&u[1]--,u[0]>7||u[1]>7)throw new Error("Bad Gutters: "+u.join("|"));return u}function Nv(r,u,l){var f=qh(r);(l.biff==2||u==9)&&++r.l;var p=FA(r);return f.val=p,f.t=p===!0||p===!1?"b":"e",f}function yk(r,u,l){l.biffguess&&l.biff==2&&(l.biff=5);var f=qh(r),p=Vo(r);return f.val=p,f}var jv=VA;function vk(r,u,l){var f=r.l+u,p=r.read_shift(2),b=r.read_shift(2);if(l.sbcch=b,b==1025||b==14849)return[b,p];if(b<1||b>255)throw new Error("Unexpected SupBook type: "+b);for(var _=Ap(r,b),s=[];f>r.l;)s.push(qg(r));return[b,p,_,s]}function Uv(r,u,l){var f=r.read_shift(2),p,b={fBuiltIn:f&1,fWantAdvise:f>>>1&1,fWantPict:f>>>2&1,fOle:f>>>3&1,fOleLink:f>>>4&1,cf:f>>>5&1023,fIcon:f>>>15&1};return l.sbcch===14849&&(p=HA(r,u-2,l)),b.body=p||r.read_shift(u-2),typeof p=="string"&&(b.Name=p),b}var bk=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Vv(r,u,l){var f=r.l+u,p=r.read_shift(2),b=r.read_shift(1),_=r.read_shift(1),s=r.read_shift(l&&l.biff==2?1:2),C=0;(!l||l.biff>=5)&&(l.biff!=5&&(r.l+=2),C=r.read_shift(2),l.biff==5&&(r.l+=2),r.l+=4);var M=Ap(r,_,l);p&32&&(M=bk[M.charCodeAt(0)]);var D=f-r.l;l&&l.biff==2&&--D;var B=f==r.l||s===0||!(D>0)?[]:rM(r,D,l,s);return{chKey:b,Name:M,itab:C,rgce:B}}function G2(r,u,l){if(l.biff<8)return wk(r,u,l);for(var f=[],p=r.l+u,b=r.read_shift(l.biff>8?4:2);b--!==0;)f.push(GA(r,l.biff>8?12:6,l));if(r.l!=p)throw new Error("Bad ExternSheet: "+r.l+" != "+p);return f}function wk(r,u,l){r[r.l+1]==3&&r[r.l]++;var f=Hg(r,u,l);return f.charCodeAt(0)==3?f.slice(1):f}function Tk(r,u,l){if(l.biff<8){r.l+=u;return}var f=r.read_shift(2),p=r.read_shift(2),b=Ap(r,f,l),_=Ap(r,p,l);return[b,_]}function Sk(r,u,l){var f=U2(r);r.l++;var p=r.read_shift(1);return u-=8,[nM(r,u,l),p,f]}function Gv(r,u,l){var f=qA(r);switch(l.biff){case 2:r.l++,u-=7;break;case 3:case 4:r.l+=2,u-=8;break;default:r.l+=6,u-=12}return[f,eM(r,u,l)]}function Ek(r){var u=r.read_shift(4)!==0,l=r.read_shift(4)!==0,f=r.read_shift(4);return[u,l,f]}function Ak(r,u,l){if(!(l.biff<8)){var f=r.read_shift(2),p=r.read_shift(2),b=r.read_shift(2),_=r.read_shift(2),s=Pp(r,0,l);return l.biff<8&&r.read_shift(1),[{r:f,c:p},s,_,b]}}function kk(r,u,l){return Ak(r,u,l)}function Ck(r,u){for(var l=[],f=r.read_shift(2);f--;)l.push(Bx(r));return l}function Mk(r,u,l){if(l&&l.biff<8)return Rk(r,u,l);var f=V2(r),p=XA(r,u-22,f[1]);return{cmo:f,ft:p}}var Dk={8:function(r,u){var l=r.l+u;r.l+=10;var f=r.read_shift(2);r.l+=4,r.l+=2,r.l+=2,r.l+=2,r.l+=4;var p=r.read_shift(1);return r.l+=p,r.l=l,{fmt:f}}};function Rk(r,u,l){r.l+=4;var f=r.read_shift(2),p=r.read_shift(2),b=r.read_shift(2);r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=6,u-=36;var _=[];return _.push((Dk[f]||qo)(r,u,l)),{cmo:[p,f,b],ft:_}}function Ik(r,u,l){var f=r.l,p="";try{r.l+=4;var b=(l.lastobj||{cmo:[0,0]}).cmo[1],_;[0,5,7,11,12,14].indexOf(b)==-1?r.l+=6:_=zA(r,6,l);var s=r.read_shift(2);r.read_shift(2),_s(r,2);var C=r.read_shift(2);r.l+=C;for(var M=1;M<r.lens.length-1;++M){if(r.l-f!=r.lens[M])throw new Error("TxO: bad continue record");var D=r[r.l],B=Ap(r,r.lens[M+1]-r.lens[M]-1);if(p+=B,p.length>=(D?s:2*s))break}if(p.length!==s&&p.length!==s*2)throw new Error("cchText: "+s+" != "+p.length);return r.l=f+u,{t:p}}catch{return r.l=f+u,{t:p}}}function Pk(r,u){var l=Bx(r);r.l+=16;var f=jA(r,u-24);return[l,f]}function Fk(r,u){r.read_shift(2);var l=Bx(r),f=r.read_shift((u-10)/2,"dbcs-cont");return f=f.replace(wl,""),[l,f]}function Lk(r){var u=[0,0],l;return l=r.read_shift(2),u[0]=Iv[l]||l,l=r.read_shift(2),u[1]=Iv[l]||l,u}function zk(r){for(var u=r.read_shift(2),l=[];u-- >0;)l.push(N2(r));return l}function Ok(r){for(var u=r.read_shift(2),l=[];u-- >0;)l.push(N2(r));return l}function Bk(r){r.l+=2;var u={cxfs:0,crc:0};return u.cxfs=r.read_shift(2),u.crc=r.read_shift(4),u}function H2(r,u,l){if(!l.cellStyles)return qo(r,u);var f=l&&l.biff>=12?4:2,p=r.read_shift(f),b=r.read_shift(f),_=r.read_shift(f),s=r.read_shift(f),C=r.read_shift(2);f==2&&(r.l+=2);var M={s:p,e:b,w:_,ixfe:s,flags:C};return(l.biff>=5||!l.biff)&&(M.level=C>>8&7),M}function Nk(r,u){var l={};return u<32||(r.l+=16,l.header=Vo(r),l.footer=Vo(r),r.l+=2),l}function jk(r,u,l){var f={area:!1};if(l.biff!=5)return r.l+=u,f;var p=r.read_shift(1);return r.l+=3,p&16&&(f.area=!0),f}var Uk=qh,Vk=O2,Gk=qg;function Hk(r){var u=r.read_shift(2),l=r.read_shift(2),f=r.read_shift(4),p={fmt:u,env:l,len:f,data:r.slice(r.l,r.l+f)};return r.l+=f,p}function qk(r,u,l){l.biffguess&&l.biff==5&&(l.biff=2);var f=qh(r);++r.l;var p=Pp(r,u-7,l);return f.t="str",f.val=p,f}function Zk(r){var u=qh(r);++r.l;var l=Vo(r);return u.t="n",u.val=l,u}function Wk(r){var u=qh(r);++r.l;var l=r.read_shift(2);return u.t="n",u.val=l,u}function $k(r){var u=r.read_shift(1);return u===0?(r.l++,""):r.read_shift(u,"sbcs-cont")}function Xk(r,u){r.l+=6,r.l+=2,r.l+=1,r.l+=3,r.l+=1,r.l+=u-13}function Yk(r,u,l){var f=r.l+u,p=qh(r),b=r.read_shift(2),_=Ap(r,b,l);return r.l=f,p.t="str",p.val=_,p}var Kk=[2,3,48,49,131,139,140,245],Hv=(function(){var r={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},u=s1({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function l(s,C){var M=[],D=Td(1);switch(C.type){case"base64":D=eh(Ic(s));break;case"binary":D=eh(s);break;case"buffer":case"array":D=s;break}mo(D,0);var B=D.read_shift(1),U=!!(B&136),j=!1,H=!1;switch(B){case 2:break;case 3:break;case 48:j=!0,U=!0;break;case 49:j=!0,U=!0;break;case 131:break;case 139:break;case 140:H=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+B.toString(16))}var z=0,N=521;B==2&&(z=D.read_shift(2)),D.l+=3,B!=2&&(z=D.read_shift(4)),z>1048576&&(z=1e6),B!=2&&(N=D.read_shift(2));var Z=D.read_shift(2),Y=C.codepage||1252;B!=2&&(D.l+=16,D.read_shift(1),D[D.l]!==0&&(Y=r[D[D.l]]),D.l+=1,D.l+=2),H&&(D.l+=36);for(var W=[],de={},ge=Math.min(D.length,B==2?521:N-10-(j?264:0)),ve=H?32:11;D.l<ge&&D[D.l]!=13;)switch(de={},de.name=Rg.utils.decode(Y,D.slice(D.l,D.l+ve)).replace(/[\u0000\r\n].*$/g,""),D.l+=ve,de.type=String.fromCharCode(D.read_shift(1)),B!=2&&!H&&(de.offset=D.read_shift(4)),de.len=D.read_shift(1),B==2&&(de.offset=D.read_shift(2)),de.dec=D.read_shift(1),de.name.length&&W.push(de),B!=2&&(D.l+=H?13:14),de.type){case"B":(!j||de.len!=8)&&C.WTF&&console.log("Skipping "+de.name+":"+de.type);break;case"G":case"P":C.WTF&&console.log("Skipping "+de.name+":"+de.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+de.type)}if(D[D.l]!==13&&(D.l=N-1),D.read_shift(1)!==13)throw new Error("DBF Terminator not found "+D.l+" "+D[D.l]);D.l=N;var ie=0,Me=0;for(M[0]=[],Me=0;Me!=W.length;++Me)M[0][Me]=W[Me].name;for(;z-- >0;){if(D[D.l]===42){D.l+=Z;continue}for(++D.l,M[++ie]=[],Me=0,Me=0;Me!=W.length;++Me){var we=D.slice(D.l,D.l+W[Me].len);D.l+=W[Me].len,mo(we,0);var Ge=Rg.utils.decode(Y,we);switch(W[Me].type){case"C":Ge.trim().length&&(M[ie][Me]=Ge.replace(/\s+$/,""));break;case"D":Ge.length===8?M[ie][Me]=new Date(+Ge.slice(0,4),+Ge.slice(4,6)-1,+Ge.slice(6,8)):M[ie][Me]=Ge;break;case"F":M[ie][Me]=parseFloat(Ge.trim());break;case"+":case"I":M[ie][Me]=H?we.read_shift(-4,"i")^2147483648:we.read_shift(4,"i");break;case"L":switch(Ge.trim().toUpperCase()){case"Y":case"T":M[ie][Me]=!0;break;case"N":case"F":M[ie][Me]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Ge+"|")}break;case"M":if(!U)throw new Error("DBF Unexpected MEMO for type "+B.toString(16));M[ie][Me]="##MEMO##"+(H?parseInt(Ge.trim(),10):we.read_shift(4));break;case"N":Ge=Ge.replace(/\u0000/g,"").trim(),Ge&&Ge!="."&&(M[ie][Me]=+Ge||0);break;case"@":M[ie][Me]=new Date(we.read_shift(-8,"f")-621356832e5);break;case"T":M[ie][Me]=new Date((we.read_shift(4)-2440588)*864e5+we.read_shift(4));break;case"Y":M[ie][Me]=we.read_shift(4,"i")/1e4+we.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":M[ie][Me]=-we.read_shift(-8,"f");break;case"B":if(j&&W[Me].len==8){M[ie][Me]=we.read_shift(8,"f");break}case"G":case"P":we.l+=W[Me].len;break;case"0":if(W[Me].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+W[Me].type)}}}if(B!=2&&D.l<D.length&&D[D.l++]!=26)throw new Error("DBF EOF Marker missing "+(D.l-1)+" of "+D.length+" "+D[D.l-1].toString(16));return C&&C.sheetRows&&(M=M.slice(0,C.sheetRows)),C.DBF=W,M}function f(s,C){var M=C||{};M.dateNF||(M.dateNF="yyyymmdd");var D=nm(l(s,M),M);return D["!cols"]=M.DBF.map(function(B){return{wch:B.len,DBF:B}}),delete M.DBF,D}function p(s,C){try{return Ed(f(s,C),C)}catch(M){if(C&&C.WTF)throw M}return{SheetNames:[],Sheets:{}}}var b={B:8,C:250,L:1,D:8,"?":0,"":0};function _(s,C){var M=C||{};if(+M.codepage>=0&&rh(+M.codepage),M.type=="string")throw new Error("Cannot write DBF to JS string");var D=Fy(),B=Hy(s,{header:1,raw:!0,cellDates:!0}),U=B[0],j=B.slice(1),H=s["!cols"]||[],z=0,N=0,Z=0,Y=1;for(z=0;z<U.length;++z){if(((H[z]||{}).DBF||{}).name){U[z]=H[z].DBF.name,++Z;continue}if(U[z]!=null){if(++Z,typeof U[z]=="number"&&(U[z]=U[z].toString(10)),typeof U[z]!="string")throw new Error("DBF Invalid column name "+U[z]+" |"+typeof U[z]+"|");if(U.indexOf(U[z])!==z){for(N=0;N<1024;++N)if(U.indexOf(U[z]+"_"+N)==-1){U[z]+="_"+N;break}}}}var W=Xi(s["!ref"]),de=[],ge=[],ve=[];for(z=0;z<=W.e.c-W.s.c;++z){var ie="",Me="",we=0,Ge=[];for(N=0;N<j.length;++N)j[N][z]!=null&&Ge.push(j[N][z]);if(Ge.length==0||U[z]==null){de[z]="?";continue}for(N=0;N<Ge.length;++N){switch(typeof Ge[N]){case"number":Me="B";break;case"string":Me="C";break;case"boolean":Me="L";break;case"object":Me=Ge[N]instanceof Date?"D":"C";break;default:Me="C"}we=Math.max(we,String(Ge[N]).length),ie=ie&&ie!=Me?"C":Me}we>250&&(we=250),Me=((H[z]||{}).DBF||{}).type,Me=="C"&&H[z].DBF.len>we&&(we=H[z].DBF.len),ie=="B"&&Me=="N"&&(ie="N",ve[z]=H[z].DBF.dec,we=H[z].DBF.len),ge[z]=ie=="C"||Me=="N"?we:b[ie]||0,Y+=ge[z],de[z]=ie}var et=D.next(32);for(et.write_shift(4,318902576),et.write_shift(4,j.length),et.write_shift(2,296+32*Z),et.write_shift(2,Y),z=0;z<4;++z)et.write_shift(4,0);for(et.write_shift(4,0|(+u[Gb]||3)<<8),z=0,N=0;z<U.length;++z)if(U[z]!=null){var pe=D.next(32),Je=(U[z].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);pe.write_shift(1,Je,"sbcs"),pe.write_shift(1,de[z]=="?"?"C":de[z],"sbcs"),pe.write_shift(4,N),pe.write_shift(1,ge[z]||b[de[z]]||0),pe.write_shift(1,ve[z]||0),pe.write_shift(1,2),pe.write_shift(4,0),pe.write_shift(1,0),pe.write_shift(4,0),pe.write_shift(4,0),N+=ge[z]||b[de[z]]||0}var le=D.next(264);for(le.write_shift(4,13),z=0;z<65;++z)le.write_shift(4,0);for(z=0;z<j.length;++z){var ut=D.next(Y);for(ut.write_shift(1,0),N=0;N<U.length;++N)if(U[N]!=null)switch(de[N]){case"L":ut.write_shift(1,j[z][N]==null?63:j[z][N]?84:70);break;case"B":ut.write_shift(8,j[z][N]||0,"f");break;case"N":var tt="0";for(typeof j[z][N]=="number"&&(tt=j[z][N].toFixed(ve[N]||0)),Z=0;Z<ge[N]-tt.length;++Z)ut.write_shift(1,32);ut.write_shift(1,tt,"sbcs");break;case"D":j[z][N]?(ut.write_shift(4,("0000"+j[z][N].getFullYear()).slice(-4),"sbcs"),ut.write_shift(2,("00"+(j[z][N].getMonth()+1)).slice(-2),"sbcs"),ut.write_shift(2,("00"+j[z][N].getDate()).slice(-2),"sbcs")):ut.write_shift(8,"00000000","sbcs");break;case"C":var We=String(j[z][N]!=null?j[z][N]:"").slice(0,ge[N]);for(ut.write_shift(1,We,"sbcs"),Z=0;Z<ge[N]-We.length;++Z)ut.write_shift(1,32);break}}return D.next(1).write_shift(1,26),D.end()}return{to_workbook:p,to_sheet:f,from_sheet:_}})(),Jk=(function(){var r={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},u=new RegExp("\x1BN("+Gh(r).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),l=function(U,j){var H=r[j];return typeof H=="number"?sv(H):H},f=function(U,j,H){var z=j.charCodeAt(0)-32<<4|H.charCodeAt(0)-48;return z==59?U:sv(z)};r["|"]=254;function p(U,j){switch(j.type){case"base64":return b(Ic(U),j);case"binary":return b(U,j);case"buffer":return b(ta&&Buffer.isBuffer(U)?U.toString("binary"):Mp(U),j);case"array":return b(Ep(U),j)}throw new Error("Unrecognized type "+j.type)}function b(U,j){var H=U.split(/[\n\r]+/),z=-1,N=-1,Z=0,Y=0,W=[],de=[],ge=null,ve={},ie=[],Me=[],we=[],Ge=0,et;for(+j.codepage>=0&&rh(+j.codepage);Z!==H.length;++Z){Ge=0;var pe=H[Z].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,f).replace(u,l),Je=pe.replace(/;;/g,"\0").split(";").map(function(De){return De.replace(/\u0000/g,";")}),le=Je[0],ut;if(pe.length>0)switch(le){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Je[1].charAt(0)=="P"&&de.push(pe.slice(3).replace(/;;/g,";"));break;case"C":var tt=!1,We=!1,$t=!1,Be=!1,Mt=-1,me=-1;for(Y=1;Y<Je.length;++Y)switch(Je[Y].charAt(0)){case"A":break;case"X":N=parseInt(Je[Y].slice(1))-1,We=!0;break;case"Y":for(z=parseInt(Je[Y].slice(1))-1,We||(N=0),et=W.length;et<=z;++et)W[et]=[];break;case"K":ut=Je[Y].slice(1),ut.charAt(0)==='"'?ut=ut.slice(1,ut.length-1):ut==="TRUE"?ut=!0:ut==="FALSE"?ut=!1:isNaN(ah(ut))?isNaN(X0(ut).getDate())||(ut=Ys(ut)):(ut=ah(ut),ge!==null&&tm(ge)&&(ut=Ox(ut))),tt=!0;break;case"E":Be=!0;var re=Z0(Je[Y].slice(1),{r:z,c:N});W[z][N]=[W[z][N],re];break;case"S":$t=!0,W[z][N]=[W[z][N],"S5S"];break;case"G":break;case"R":Mt=parseInt(Je[Y].slice(1))-1;break;case"C":me=parseInt(Je[Y].slice(1))-1;break;default:if(j&&j.WTF)throw new Error("SYLK bad record "+pe)}if(tt&&(W[z][N]&&W[z][N].length==2?W[z][N][0]=ut:W[z][N]=ut,ge=null),$t){if(Be)throw new Error("SYLK shared formula cannot have own formula");var Ve=Mt>-1&&W[Mt][me];if(!Ve||!Ve[1])throw new Error("SYLK shared formula cannot find base");W[z][N][1]=ew(Ve[1],{r:z-Mt,c:N-me})}break;case"F":var Pe=0;for(Y=1;Y<Je.length;++Y)switch(Je[Y].charAt(0)){case"X":N=parseInt(Je[Y].slice(1))-1,++Pe;break;case"Y":for(z=parseInt(Je[Y].slice(1))-1,et=W.length;et<=z;++et)W[et]=[];break;case"M":Ge=parseInt(Je[Y].slice(1))/20;break;case"F":break;case"G":break;case"P":ge=de[parseInt(Je[Y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(we=Je[Y].slice(1).split(" "),et=parseInt(we[0],10);et<=parseInt(we[1],10);++et)Ge=parseInt(we[2],10),Me[et-1]=Ge===0?{hidden:!0}:{wch:Ge},Y0(Me[et-1]);break;case"C":N=parseInt(Je[Y].slice(1))-1,Me[N]||(Me[N]={});break;case"R":z=parseInt(Je[Y].slice(1))-1,ie[z]||(ie[z]={}),Ge>0?(ie[z].hpt=Ge,ie[z].hpx=Og(Ge)):Ge===0&&(ie[z].hidden=!0);break;default:if(j&&j.WTF)throw new Error("SYLK bad record "+pe)}Pe<1&&(ge=null);break;default:if(j&&j.WTF)throw new Error("SYLK bad record "+pe)}}return ie.length>0&&(ve["!rows"]=ie),Me.length>0&&(ve["!cols"]=Me),j&&j.sheetRows&&(W=W.slice(0,j.sheetRows)),[W,ve]}function _(U,j){var H=p(U,j),z=H[0],N=H[1],Z=nm(z,j);return Gh(N).forEach(function(Y){Z[Y]=N[Y]}),Z}function s(U,j){return Ed(_(U,j),j)}function C(U,j,H,z){var N="C;Y"+(H+1)+";X"+(z+1)+";K";switch(U.t){case"n":N+=U.v||0,U.f&&!U.F&&(N+=";E"+B5(U.f,{r:H,c:z}));break;case"b":N+=U.v?"TRUE":"FALSE";break;case"e":N+=U.w||U.v;break;case"d":N+='"'+(U.w||U.v)+'"';break;case"s":N+='"'+U.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return N}function M(U,j){j.forEach(function(H,z){var N="F;W"+(z+1)+" "+(z+1)+" ";H.hidden?N+="0":(typeof H.width=="number"&&!H.wpx&&(H.wpx=Cx(H.width)),typeof H.wpx=="number"&&!H.wch&&(H.wch=Mx(H.wpx)),typeof H.wch=="number"&&(N+=Math.round(H.wch))),N.charAt(N.length-1)!=" "&&U.push(N)})}function D(U,j){j.forEach(function(H,z){var N="F;";H.hidden?N+="M0;":H.hpt?N+="M"+20*H.hpt+";":H.hpx&&(N+="M"+20*K2(H.hpx)+";"),N.length>2&&U.push(N+"R"+(z+1))})}function B(U,j){var H=["ID;PWXL;N;E"],z=[],N=Xi(U["!ref"]),Z,Y=Array.isArray(U),W=`\r
`;H.push("P;PGeneral"),H.push("F;P0;DG0G8;M255"),U["!cols"]&&M(H,U["!cols"]),U["!rows"]&&D(H,U["!rows"]),H.push("B;Y"+(N.e.r-N.s.r+1)+";X"+(N.e.c-N.s.c+1)+";D"+[N.s.c,N.s.r,N.e.c,N.e.r].join(" "));for(var de=N.s.r;de<=N.e.r;++de)for(var ge=N.s.c;ge<=N.e.c;++ge){var ve=kn({r:de,c:ge});Z=Y?(U[de]||[])[ge]:U[ve],!(!Z||Z.v==null&&(!Z.f||Z.F))&&z.push(C(Z,U,de,ge))}return H.join(W)+W+z.join(W)+W+"E"+W}return{to_workbook:s,to_sheet:_,from_sheet:B}})(),Qk=(function(){function r(b,_){switch(_.type){case"base64":return u(Ic(b),_);case"binary":return u(b,_);case"buffer":return u(ta&&Buffer.isBuffer(b)?b.toString("binary"):Mp(b),_);case"array":return u(Ep(b),_)}throw new Error("Unrecognized type "+_.type)}function u(b,_){for(var s=b.split(`
`),C=-1,M=-1,D=0,B=[];D!==s.length;++D){if(s[D].trim()==="BOT"){B[++C]=[],M=0;continue}if(!(C<0)){var U=s[D].trim().split(","),j=U[0],H=U[1];++D;for(var z=s[D]||"";(z.match(/["]/g)||[]).length&1&&D<s.length-1;)z+=`
`+s[++D];switch(z=z.trim(),+j){case-1:if(z==="BOT"){B[++C]=[],M=0;continue}else if(z!=="EOD")throw new Error("Unrecognized DIF special command "+z);break;case 0:z==="TRUE"?B[C][M]=!0:z==="FALSE"?B[C][M]=!1:isNaN(ah(H))?isNaN(X0(H).getDate())?B[C][M]=H:B[C][M]=Ys(H):B[C][M]=ah(H),++M;break;case 1:z=z.slice(1,z.length-1),z=z.replace(/""/g,'"'),z&&z.match(/^=".*"$/)&&(z=z.slice(2,-1)),B[C][M++]=z!==""?z:null;break}if(z==="EOD")break}}return _&&_.sheetRows&&(B=B.slice(0,_.sheetRows)),B}function l(b,_){return nm(r(b,_),_)}function f(b,_){return Ed(l(b,_),_)}var p=(function(){var b=function(C,M,D,B,U){C.push(M),C.push(D+","+B),C.push('"'+U.replace(/"/g,'""')+'"')},_=function(C,M,D,B){C.push(M+","+D),C.push(M==1?'"'+B.replace(/"/g,'""')+'"':B)};return function(C){var M=[],D=Xi(C["!ref"]),B,U=Array.isArray(C);b(M,"TABLE",0,1,"sheetjs"),b(M,"VECTORS",0,D.e.r-D.s.r+1,""),b(M,"TUPLES",0,D.e.c-D.s.c+1,""),b(M,"DATA",0,0,"");for(var j=D.s.r;j<=D.e.r;++j){_(M,-1,0,"BOT");for(var H=D.s.c;H<=D.e.c;++H){var z=kn({r:j,c:H});if(B=U?(C[j]||[])[H]:C[z],!B){_(M,1,0,"");continue}switch(B.t){case"n":var N=B.w;!N&&B.v!=null&&(N=B.v),N==null?B.f&&!B.F?_(M,1,0,"="+B.f):_(M,1,0,""):_(M,0,N,"V");break;case"b":_(M,0,B.v?1:0,B.v?"TRUE":"FALSE");break;case"s":_(M,1,0,isNaN(B.v)?B.v:'="'+B.v+'"');break;case"d":B.w||(B.w=lu(B.z||Pn[14],Tl(Ys(B.v)))),_(M,0,B.w,"V");break;default:_(M,1,0,"")}}}_(M,-1,0,"EOD");var Z=`\r
`,Y=M.join(Z);return Y}})();return{to_workbook:f,to_sheet:l,from_sheet:p}})(),eC=(function(){function r(B){return B.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function u(B){return B.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function l(B,U){for(var j=B.split(`
`),H=-1,z=-1,N=0,Z=[];N!==j.length;++N){var Y=j[N].trim().split(":");if(Y[0]==="cell"){var W=bl(Y[1]);if(Z.length<=W.r)for(H=Z.length;H<=W.r;++H)Z[H]||(Z[H]=[]);switch(H=W.r,z=W.c,Y[2]){case"t":Z[H][z]=r(Y[3]);break;case"v":Z[H][z]=+Y[3];break;case"vtf":var de=Y[Y.length-1];case"vtc":Y[3]==="nl"?Z[H][z]=!!+Y[4]:Z[H][z]=+Y[4],Y[2]=="vtf"&&(Z[H][z]=[Z[H][z],de])}}}return U&&U.sheetRows&&(Z=Z.slice(0,U.sheetRows)),Z}function f(B,U){return nm(l(B,U),U)}function p(B,U){return Ed(f(B,U),U)}var b=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),_=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,s=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),C="--SocialCalcSpreadsheetControlSave--";function M(B){if(!B||!B["!ref"])return"";for(var U=[],j=[],H,z="",N=rm(B["!ref"]),Z=Array.isArray(B),Y=N.s.r;Y<=N.e.r;++Y)for(var W=N.s.c;W<=N.e.c;++W)if(z=kn({r:Y,c:W}),H=Z?(B[Y]||[])[W]:B[z],!(!H||H.v==null||H.t==="z")){switch(j=["cell",z,"t"],H.t){case"s":case"str":j.push(u(H.v));break;case"n":H.f?(j[2]="vtf",j[3]="n",j[4]=H.v,j[5]=u(H.f)):(j[2]="v",j[3]=H.v);break;case"b":j[2]="vt"+(H.f?"f":"c"),j[3]="nl",j[4]=H.v?"1":"0",j[5]=u(H.f||(H.v?"TRUE":"FALSE"));break;case"d":var de=Tl(Ys(H.v));j[2]="vtc",j[3]="nd",j[4]=""+de,j[5]=H.w||lu(H.z||Pn[14],de);break;case"e":continue}U.push(j.join(":"))}return U.push("sheet:c:"+(N.e.c-N.s.c+1)+":r:"+(N.e.r-N.s.r+1)+":tvf:1"),U.push("valueformat:1:text-wiki"),U.join(`
`)}function D(B){return[b,_,s,_,M(B),C].join(`
`)}return{to_workbook:p,to_sheet:f,from_sheet:D}})(),Lg=(function(){function r(D,B,U,j,H){H.raw?B[U][j]=D:D===""||(D==="TRUE"?B[U][j]=!0:D==="FALSE"?B[U][j]=!1:isNaN(ah(D))?isNaN(X0(D).getDate())?B[U][j]=D:B[U][j]=Ys(D):B[U][j]=ah(D))}function u(D,B){var U=B||{},j=[];if(!D||D.length===0)return j;for(var H=D.split(/[\r\n]/),z=H.length-1;z>=0&&H[z].length===0;)--z;for(var N=10,Z=0,Y=0;Y<=z;++Y)Z=H[Y].indexOf(" "),Z==-1?Z=H[Y].length:Z++,N=Math.max(N,Z);for(Y=0;Y<=z;++Y){j[Y]=[];var W=0;for(r(H[Y].slice(0,N).trim(),j,Y,W,U),W=1;W<=(H[Y].length-N)/10+1;++W)r(H[Y].slice(N+(W-1)*10,N+W*10).trim(),j,Y,W,U)}return U.sheetRows&&(j=j.slice(0,U.sheetRows)),j}var l={44:",",9:"	",59:";",124:"|"},f={44:3,9:2,59:1,124:0};function p(D){for(var B={},U=!1,j=0,H=0;j<D.length;++j)(H=D.charCodeAt(j))==34?U=!U:!U&&H in l&&(B[H]=(B[H]||0)+1);H=[];for(j in B)Object.prototype.hasOwnProperty.call(B,j)&&H.push([B[j],j]);if(!H.length){B=f;for(j in B)Object.prototype.hasOwnProperty.call(B,j)&&H.push([B[j],j])}return H.sort(function(z,N){return z[0]-N[0]||f[z[1]]-f[N[1]]}),l[H.pop()[1]]||44}function b(D,B){var U=B||{},j="",H=U.dense?[]:{},z={s:{c:0,r:0},e:{c:0,r:0}};D.slice(0,4)=="sep="?D.charCodeAt(5)==13&&D.charCodeAt(6)==10?(j=D.charAt(4),D=D.slice(7)):D.charCodeAt(5)==13||D.charCodeAt(5)==10?(j=D.charAt(4),D=D.slice(6)):j=p(D.slice(0,1024)):U&&U.FS?j=U.FS:j=p(D.slice(0,1024));var N=0,Z=0,Y=0,W=0,de=0,ge=j.charCodeAt(0),ve=!1,ie=0,Me=D.charCodeAt(0);D=D.replace(/\r\n/mg,`
`);var we=U.dateNF!=null?hE(U.dateNF):null;function Ge(){var et=D.slice(W,de),pe={};if(et.charAt(0)=='"'&&et.charAt(et.length-1)=='"'&&(et=et.slice(1,-1).replace(/""/g,'"')),et.length===0)pe.t="z";else if(U.raw)pe.t="s",pe.v=et;else if(et.trim().length===0)pe.t="s",pe.v=et;else if(et.charCodeAt(0)==61)et.charCodeAt(1)==34&&et.charCodeAt(et.length-1)==34?(pe.t="s",pe.v=et.slice(2,-1).replace(/""/g,'"')):j5(et)?(pe.t="n",pe.f=et.slice(1)):(pe.t="s",pe.v=et);else if(et=="TRUE")pe.t="b",pe.v=!0;else if(et=="FALSE")pe.t="b",pe.v=!1;else if(!isNaN(Y=ah(et)))pe.t="n",U.cellText!==!1&&(pe.w=et),pe.v=Y;else if(!isNaN(X0(et).getDate())||we&&et.match(we)){pe.z=U.dateNF||Pn[14];var Je=0;we&&et.match(we)&&(et=fE(et,U.dateNF,et.match(we)||[]),Je=1),U.cellDates?(pe.t="d",pe.v=Ys(et,Je)):(pe.t="n",pe.v=Tl(Ys(et,Je))),U.cellText!==!1&&(pe.w=lu(pe.z,pe.v instanceof Date?Tl(pe.v):pe.v)),U.cellNF||delete pe.z}else pe.t="s",pe.v=et;if(pe.t=="z"||(U.dense?(H[N]||(H[N]=[]),H[N][Z]=pe):H[kn({c:Z,r:N})]=pe),W=de+1,Me=D.charCodeAt(W),z.e.c<Z&&(z.e.c=Z),z.e.r<N&&(z.e.r=N),ie==ge)++Z;else if(Z=0,++N,U.sheetRows&&U.sheetRows<=N)return!0}e:for(;de<D.length;++de)switch(ie=D.charCodeAt(de)){case 34:Me===34&&(ve=!ve);break;case ge:case 10:case 13:if(!ve&&Ge())break e;break}return de-W>0&&Ge(),H["!ref"]=oa(z),H}function _(D,B){return!(B&&B.PRN)||B.FS||D.slice(0,4)=="sep="||D.indexOf("	")>=0||D.indexOf(",")>=0||D.indexOf(";")>=0?b(D,B):nm(u(D,B),B)}function s(D,B){var U="",j=B.type=="string"?[0,0,0,0]:E1(D,B);switch(B.type){case"base64":U=Ic(D);break;case"binary":U=D;break;case"buffer":B.codepage==65001?U=D.toString("utf8"):B.codepage&&typeof Rg<"u"||(U=ta&&Buffer.isBuffer(D)?D.toString("binary"):Mp(D));break;case"array":U=Ep(D);break;case"string":U=D;break;default:throw new Error("Unrecognized type "+B.type)}return j[0]==239&&j[1]==187&&j[2]==191?U=si(U.slice(3)):B.type!="string"&&B.type!="buffer"&&B.codepage==65001?U=si(U):B.type=="binary"&&typeof Rg<"u",U.slice(0,19)=="socialcalc:version:"?eC.to_sheet(B.type=="string"?U:si(U),B):_(U,B)}function C(D,B){return Ed(s(D,B),B)}function M(D){for(var B=[],U=Xi(D["!ref"]),j,H=Array.isArray(D),z=U.s.r;z<=U.e.r;++z){for(var N=[],Z=U.s.c;Z<=U.e.c;++Z){var Y=kn({r:z,c:Z});if(j=H?(D[z]||[])[Z]:D[Y],!j||j.v==null){N.push("          ");continue}for(var W=(j.w||(Df(j),j.w)||"").slice(0,10);W.length<10;)W+=" ";N.push(W+(Z===0?" ":""))}B.push(N.join(""))}return B.join(`
`)}return{to_workbook:C,to_sheet:s,from_sheet:M}})();function tC(r,u){var l=u||{},f=!!l.WTF;l.WTF=!0;try{var p=Jk.to_workbook(r,l);return l.WTF=f,p}catch(b){if(l.WTF=f,!b.message.match(/SYLK bad record ID/)&&f)throw b;return Lg.to_workbook(r,u)}}var Ag=(function(){function r(re,Ve,Pe){if(re){mo(re,re.l||0);for(var De=Pe.Enum||Mt;re.l<re.length;){var bt=re.read_shift(2),Vt=De[bt]||De[65535],Zt=re.read_shift(2),jt=re.l+Zt,Yt=Vt.f&&Vt.f(re,Zt,Pe);if(re.l=jt,Ve(Yt,Vt,bt))return}}}function u(re,Ve){switch(Ve.type){case"base64":return l(eh(Ic(re)),Ve);case"binary":return l(eh(re),Ve);case"buffer":case"array":return l(re,Ve)}throw"Unsupported type "+Ve.type}function l(re,Ve){if(!re)return re;var Pe=Ve||{},De=Pe.dense?[]:{},bt="Sheet1",Vt="",Zt=0,jt={},Yt=[],jr=[],Qe={s:{r:0,c:0},e:{r:0,c:0}},_n=Pe.sheetRows||0;if(re[2]==0&&(re[3]==8||re[3]==9)&&re.length>=16&&re[14]==5&&re[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(re[2]==2)Pe.Enum=Mt,r(re,function(Ee,Ne,dt){switch(dt){case 0:Pe.vers=Ee,Ee>=4096&&(Pe.qpro=!0);break;case 6:Qe=Ee;break;case 204:Ee&&(Vt=Ee);break;case 222:Vt=Ee;break;case 15:case 51:Pe.qpro||(Ee[1].v=Ee[1].v.slice(1));case 13:case 14:case 16:dt==14&&(Ee[2]&112)==112&&(Ee[2]&15)>1&&(Ee[2]&15)<15&&(Ee[1].z=Pe.dateNF||Pn[14],Pe.cellDates&&(Ee[1].t="d",Ee[1].v=Ox(Ee[1].v))),Pe.qpro&&Ee[3]>Zt&&(De["!ref"]=oa(Qe),jt[bt]=De,Yt.push(bt),De=Pe.dense?[]:{},Qe={s:{r:0,c:0},e:{r:0,c:0}},Zt=Ee[3],bt=Vt||"Sheet"+(Zt+1),Vt="");var Kt=Pe.dense?(De[Ee[0].r]||[])[Ee[0].c]:De[kn(Ee[0])];if(Kt){Kt.t=Ee[1].t,Kt.v=Ee[1].v,Ee[1].z!=null&&(Kt.z=Ee[1].z),Ee[1].f!=null&&(Kt.f=Ee[1].f);break}Pe.dense?(De[Ee[0].r]||(De[Ee[0].r]=[]),De[Ee[0].r][Ee[0].c]=Ee[1]):De[kn(Ee[0])]=Ee[1];break}},Pe);else if(re[2]==26||re[2]==14)Pe.Enum=me,re[2]==14&&(Pe.qpro=!0,re.l=0),r(re,function(Ee,Ne,dt){switch(dt){case 204:bt=Ee;break;case 22:Ee[1].v=Ee[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ee[3]>Zt&&(De["!ref"]=oa(Qe),jt[bt]=De,Yt.push(bt),De=Pe.dense?[]:{},Qe={s:{r:0,c:0},e:{r:0,c:0}},Zt=Ee[3],bt="Sheet"+(Zt+1)),_n>0&&Ee[0].r>=_n)break;Pe.dense?(De[Ee[0].r]||(De[Ee[0].r]=[]),De[Ee[0].r][Ee[0].c]=Ee[1]):De[kn(Ee[0])]=Ee[1],Qe.e.c<Ee[0].c&&(Qe.e.c=Ee[0].c),Qe.e.r<Ee[0].r&&(Qe.e.r=Ee[0].r);break;case 27:Ee[14e3]&&(jr[Ee[14e3][0]]=Ee[14e3][1]);break;case 1537:jr[Ee[0]]=Ee[1],Ee[0]==Zt&&(bt=Ee[1]);break}},Pe);else throw new Error("Unrecognized LOTUS BOF "+re[2]);if(De["!ref"]=oa(Qe),jt[Vt||bt]=De,Yt.push(Vt||bt),!jr.length)return{SheetNames:Yt,Sheets:jt};for(var se={},Rt=[],yt=0;yt<jr.length;++yt)jt[Yt[yt]]?(Rt.push(jr[yt]||Yt[yt]),se[jr[yt]]=jt[jr[yt]]||jt[Yt[yt]]):(Rt.push(jr[yt]),se[jr[yt]]={"!ref":"A1"});return{SheetNames:Rt,Sheets:se}}function f(re,Ve){var Pe=Ve||{};if(+Pe.codepage>=0&&rh(+Pe.codepage),Pe.type=="string")throw new Error("Cannot write WK1 to JS string");var De=Fy(),bt=Xi(re["!ref"]),Vt=Array.isArray(re),Zt=[];Qu(De,0,b(1030)),Qu(De,6,C(bt));for(var jt=Math.min(bt.e.r,8191),Yt=bt.s.r;Yt<=jt;++Yt)for(var jr=_o(Yt),Qe=bt.s.c;Qe<=bt.e.c;++Qe){Yt===bt.s.r&&(Zt[Qe]=ks(Qe));var _n=Zt[Qe]+jr,se=Vt?(re[Yt]||[])[Qe]:re[_n];if(!(!se||se.t=="z"))if(se.t=="n")(se.v|0)==se.v&&se.v>=-32768&&se.v<=32767?Qu(De,13,j(Yt,Qe,se.v)):Qu(De,14,z(Yt,Qe,se.v));else{var Rt=Df(se);Qu(De,15,B(Yt,Qe,Rt.slice(0,239)))}}return Qu(De,1),De.end()}function p(re,Ve){var Pe=Ve||{};if(+Pe.codepage>=0&&rh(+Pe.codepage),Pe.type=="string")throw new Error("Cannot write WK3 to JS string");var De=Fy();Qu(De,0,_(re));for(var bt=0,Vt=0;bt<re.SheetNames.length;++bt)(re.Sheets[re.SheetNames[bt]]||{})["!ref"]&&Qu(De,27,Be(re.SheetNames[bt],Vt++));var Zt=0;for(bt=0;bt<re.SheetNames.length;++bt){var jt=re.Sheets[re.SheetNames[bt]];if(!(!jt||!jt["!ref"])){for(var Yt=Xi(jt["!ref"]),jr=Array.isArray(jt),Qe=[],_n=Math.min(Yt.e.r,8191),se=Yt.s.r;se<=_n;++se)for(var Rt=_o(se),yt=Yt.s.c;yt<=Yt.e.c;++yt){se===Yt.s.r&&(Qe[yt]=ks(yt));var Ee=Qe[yt]+Rt,Ne=jr?(jt[se]||[])[yt]:jt[Ee];if(!(!Ne||Ne.t=="z"))if(Ne.t=="n")Qu(De,23,Ge(se,yt,Zt,Ne.v));else{var dt=Df(Ne);Qu(De,22,ie(se,yt,Zt,dt.slice(0,239)))}}++Zt}}return Qu(De,1),De.end()}function b(re){var Ve=As(2);return Ve.write_shift(2,re),Ve}function _(re){var Ve=As(26);Ve.write_shift(2,4096),Ve.write_shift(2,4),Ve.write_shift(4,0);for(var Pe=0,De=0,bt=0,Vt=0;Vt<re.SheetNames.length;++Vt){var Zt=re.SheetNames[Vt],jt=re.Sheets[Zt];if(!(!jt||!jt["!ref"])){++bt;var Yt=rm(jt["!ref"]);Pe<Yt.e.r&&(Pe=Yt.e.r),De<Yt.e.c&&(De=Yt.e.c)}}return Pe>8191&&(Pe=8191),Ve.write_shift(2,Pe),Ve.write_shift(1,bt),Ve.write_shift(1,De),Ve.write_shift(2,0),Ve.write_shift(2,0),Ve.write_shift(1,1),Ve.write_shift(1,2),Ve.write_shift(4,0),Ve.write_shift(4,0),Ve}function s(re,Ve,Pe){var De={s:{c:0,r:0},e:{c:0,r:0}};return Ve==8&&Pe.qpro?(De.s.c=re.read_shift(1),re.l++,De.s.r=re.read_shift(2),De.e.c=re.read_shift(1),re.l++,De.e.r=re.read_shift(2),De):(De.s.c=re.read_shift(2),De.s.r=re.read_shift(2),Ve==12&&Pe.qpro&&(re.l+=2),De.e.c=re.read_shift(2),De.e.r=re.read_shift(2),Ve==12&&Pe.qpro&&(re.l+=2),De.s.c==65535&&(De.s.c=De.e.c=De.s.r=De.e.r=0),De)}function C(re){var Ve=As(8);return Ve.write_shift(2,re.s.c),Ve.write_shift(2,re.s.r),Ve.write_shift(2,re.e.c),Ve.write_shift(2,re.e.r),Ve}function M(re,Ve,Pe){var De=[{c:0,r:0},{t:"n",v:0},0,0];return Pe.qpro&&Pe.vers!=20768?(De[0].c=re.read_shift(1),De[3]=re.read_shift(1),De[0].r=re.read_shift(2),re.l+=2):(De[2]=re.read_shift(1),De[0].c=re.read_shift(2),De[0].r=re.read_shift(2)),De}function D(re,Ve,Pe){var De=re.l+Ve,bt=M(re,Ve,Pe);if(bt[1].t="s",Pe.vers==20768){re.l++;var Vt=re.read_shift(1);return bt[1].v=re.read_shift(Vt,"utf8"),bt}return Pe.qpro&&re.l++,bt[1].v=re.read_shift(De-re.l,"cstr"),bt}function B(re,Ve,Pe){var De=As(7+Pe.length);De.write_shift(1,255),De.write_shift(2,Ve),De.write_shift(2,re),De.write_shift(1,39);for(var bt=0;bt<De.length;++bt){var Vt=Pe.charCodeAt(bt);De.write_shift(1,Vt>=128?95:Vt)}return De.write_shift(1,0),De}function U(re,Ve,Pe){var De=M(re,Ve,Pe);return De[1].v=re.read_shift(2,"i"),De}function j(re,Ve,Pe){var De=As(7);return De.write_shift(1,255),De.write_shift(2,Ve),De.write_shift(2,re),De.write_shift(2,Pe,"i"),De}function H(re,Ve,Pe){var De=M(re,Ve,Pe);return De[1].v=re.read_shift(8,"f"),De}function z(re,Ve,Pe){var De=As(13);return De.write_shift(1,255),De.write_shift(2,Ve),De.write_shift(2,re),De.write_shift(8,Pe,"f"),De}function N(re,Ve,Pe){var De=re.l+Ve,bt=M(re,Ve,Pe);if(bt[1].v=re.read_shift(8,"f"),Pe.qpro)re.l=De;else{var Vt=re.read_shift(2);de(re.slice(re.l,re.l+Vt),bt),re.l+=Vt}return bt}function Z(re,Ve,Pe){var De=Ve&32768;return Ve&=-32769,Ve=(De?re:0)+(Ve>=8192?Ve-16384:Ve),(De?"":"$")+(Pe?ks(Ve):_o(Ve))}var Y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},W=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function de(re,Ve){mo(re,0);for(var Pe=[],De=0,bt="",Vt="",Zt="",jt="";re.l<re.length;){var Yt=re[re.l++];switch(Yt){case 0:Pe.push(re.read_shift(8,"f"));break;case 1:Vt=Z(Ve[0].c,re.read_shift(2),!0),bt=Z(Ve[0].r,re.read_shift(2),!1),Pe.push(Vt+bt);break;case 2:{var jr=Z(Ve[0].c,re.read_shift(2),!0),Qe=Z(Ve[0].r,re.read_shift(2),!1);Vt=Z(Ve[0].c,re.read_shift(2),!0),bt=Z(Ve[0].r,re.read_shift(2),!1),Pe.push(jr+Qe+":"+Vt+bt)}break;case 3:if(re.l<re.length){console.error("WK1 premature formula end");return}break;case 4:Pe.push("("+Pe.pop()+")");break;case 5:Pe.push(re.read_shift(2));break;case 6:{for(var _n="";Yt=re[re.l++];)_n+=String.fromCharCode(Yt);Pe.push('"'+_n.replace(/"/g,'""')+'"')}break;case 8:Pe.push("-"+Pe.pop());break;case 23:Pe.push("+"+Pe.pop());break;case 22:Pe.push("NOT("+Pe.pop()+")");break;case 20:case 21:jt=Pe.pop(),Zt=Pe.pop(),Pe.push(["AND","OR"][Yt-20]+"("+Zt+","+jt+")");break;default:if(Yt<32&&W[Yt])jt=Pe.pop(),Zt=Pe.pop(),Pe.push(Zt+W[Yt]+jt);else if(Y[Yt]){if(De=Y[Yt][1],De==69&&(De=re[re.l++]),De>Pe.length){console.error("WK1 bad formula parse 0x"+Yt.toString(16)+":|"+Pe.join("|")+"|");return}var se=Pe.slice(-De);Pe.length-=De,Pe.push(Y[Yt][0]+"("+se.join(",")+")")}else return Yt<=7?console.error("WK1 invalid opcode "+Yt.toString(16)):Yt<=24?console.error("WK1 unsupported op "+Yt.toString(16)):Yt<=30?console.error("WK1 invalid opcode "+Yt.toString(16)):Yt<=115?console.error("WK1 unsupported function opcode "+Yt.toString(16)):console.error("WK1 unrecognized opcode "+Yt.toString(16))}}Pe.length==1?Ve[1].f=""+Pe[0]:console.error("WK1 bad formula parse |"+Pe.join("|")+"|")}function ge(re){var Ve=[{c:0,r:0},{t:"n",v:0},0];return Ve[0].r=re.read_shift(2),Ve[3]=re[re.l++],Ve[0].c=re[re.l++],Ve}function ve(re,Ve){var Pe=ge(re);return Pe[1].t="s",Pe[1].v=re.read_shift(Ve-4,"cstr"),Pe}function ie(re,Ve,Pe,De){var bt=As(6+De.length);bt.write_shift(2,re),bt.write_shift(1,Pe),bt.write_shift(1,Ve),bt.write_shift(1,39);for(var Vt=0;Vt<De.length;++Vt){var Zt=De.charCodeAt(Vt);bt.write_shift(1,Zt>=128?95:Zt)}return bt.write_shift(1,0),bt}function Me(re,Ve){var Pe=ge(re);Pe[1].v=re.read_shift(2);var De=Pe[1].v>>1;if(Pe[1].v&1)switch(De&7){case 0:De=(De>>3)*5e3;break;case 1:De=(De>>3)*500;break;case 2:De=(De>>3)/20;break;case 3:De=(De>>3)/200;break;case 4:De=(De>>3)/2e3;break;case 5:De=(De>>3)/2e4;break;case 6:De=(De>>3)/16;break;case 7:De=(De>>3)/64;break}return Pe[1].v=De,Pe}function we(re,Ve){var Pe=ge(re),De=re.read_shift(4),bt=re.read_shift(4),Vt=re.read_shift(2);if(Vt==65535)return De===0&&bt===3221225472?(Pe[1].t="e",Pe[1].v=15):De===0&&bt===3489660928?(Pe[1].t="e",Pe[1].v=42):Pe[1].v=0,Pe;var Zt=Vt&32768;return Vt=(Vt&32767)-16446,Pe[1].v=(1-Zt*2)*(bt*Math.pow(2,Vt+32)+De*Math.pow(2,Vt)),Pe}function Ge(re,Ve,Pe,De){var bt=As(14);if(bt.write_shift(2,re),bt.write_shift(1,Pe),bt.write_shift(1,Ve),De==0)return bt.write_shift(4,0),bt.write_shift(4,0),bt.write_shift(2,65535),bt;var Vt=0,Zt=0,jt=0,Yt=0;return De<0&&(Vt=1,De=-De),Zt=Math.log2(De)|0,De/=Math.pow(2,Zt-31),Yt=De>>>0,(Yt&2147483648)==0&&(De/=2,++Zt,Yt=De>>>0),De-=Yt,Yt|=2147483648,Yt>>>=0,De*=Math.pow(2,32),jt=De>>>0,bt.write_shift(4,jt),bt.write_shift(4,Yt),Zt+=16383+(Vt?32768:0),bt.write_shift(2,Zt),bt}function et(re,Ve){var Pe=we(re);return re.l+=Ve-14,Pe}function pe(re,Ve){var Pe=ge(re),De=re.read_shift(4);return Pe[1].v=De>>6,Pe}function Je(re,Ve){var Pe=ge(re),De=re.read_shift(8,"f");return Pe[1].v=De,Pe}function le(re,Ve){var Pe=Je(re);return re.l+=Ve-10,Pe}function ut(re,Ve){return re[re.l+Ve-1]==0?re.read_shift(Ve,"cstr"):""}function tt(re,Ve){var Pe=re[re.l++];Pe>Ve-1&&(Pe=Ve-1);for(var De="";De.length<Pe;)De+=String.fromCharCode(re[re.l++]);return De}function We(re,Ve,Pe){if(!(!Pe.qpro||Ve<21)){var De=re.read_shift(1);re.l+=17,re.l+=1,re.l+=2;var bt=re.read_shift(Ve-21,"cstr");return[De,bt]}}function $t(re,Ve){for(var Pe={},De=re.l+Ve;re.l<De;){var bt=re.read_shift(2);if(bt==14e3){for(Pe[bt]=[0,""],Pe[bt][0]=re.read_shift(2);re[re.l];)Pe[bt][1]+=String.fromCharCode(re[re.l]),re.l++;re.l++}}return Pe}function Be(re,Ve){var Pe=As(5+re.length);Pe.write_shift(2,14e3),Pe.write_shift(2,Ve);for(var De=0;De<re.length;++De){var bt=re.charCodeAt(De);Pe[Pe.l++]=bt>127?95:bt}return Pe[Pe.l++]=0,Pe}var Mt={0:{n:"BOF",f:_s},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:s},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:U},14:{n:"NUMBER",f:H},15:{n:"LABEL",f:D},16:{n:"FORMULA",f:N},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:D},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ut},222:{n:"SHEETNAMELP",f:tt},65535:{n:""}},me={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:ve},23:{n:"NUMBER17",f:we},24:{n:"NUMBER18",f:Me},25:{n:"FORMULA19",f:et},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:$t},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:pe},38:{n:"??"},39:{n:"NUMBER27",f:Je},40:{n:"FORMULA28",f:le},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ut},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:We},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:f,book_to_wk3:p,to_workbook:u}})();function rC(r){var u={},l=r.match(Zo),f=0,p=!1;if(l)for(;f!=l.length;++f){var b=vn(l[f]);switch(b[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!b.val)break;case"<shadow>":case"<shadow/>":u.shadow=1;break;case"</shadow>":break;case"<charset":if(b.val=="1")break;u.cp=t1[parseInt(b.val,10)];break;case"<outline":if(!b.val)break;case"<outline>":case"<outline/>":u.outline=1;break;case"</outline>":break;case"<rFont":u.name=b.val;break;case"<sz":u.sz=b.val;break;case"<strike":if(!b.val)break;case"<strike>":case"<strike/>":u.strike=1;break;case"</strike>":break;case"<u":if(!b.val)break;switch(b.val){case"double":u.uval="double";break;case"singleAccounting":u.uval="single-accounting";break;case"doubleAccounting":u.uval="double-accounting";break}case"<u>":case"<u/>":u.u=1;break;case"</u>":break;case"<b":if(b.val=="0")break;case"<b>":case"<b/>":u.b=1;break;case"</b>":break;case"<i":if(b.val=="0")break;case"<i>":case"<i/>":u.i=1;break;case"</i>":break;case"<color":b.rgb&&(u.color=b.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":u.family=b.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":u.valign=b.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":p=!0;break;case"</ext>":p=!1;break;default:if(b[0].charCodeAt(1)!==47&&!p)throw new Error("Unrecognized rich format "+b[0])}}return u}var nC=(function(){var r=Pg("t"),u=Pg("rPr");function l(b){var _=b.match(r);if(!_)return{t:"s",v:""};var s={t:"s",v:ma(_[1])},C=b.match(u);return C&&(s.s=rC(C[1])),s}var f=/<(?:\w+:)?r>/g,p=/<\/(?:\w+:)?r>/;return function(_){return _.replace(f,"").split(p).map(l).filter(function(s){return s.v})}})(),aC=(function(){var u=/(\r\n|\n)/g;function l(p,b,_){var s=[];p.u&&s.push("text-decoration: underline;"),p.uval&&s.push("text-underline-style:"+p.uval+";"),p.sz&&s.push("font-size:"+p.sz+"pt;"),p.outline&&s.push("text-effect: outline;"),p.shadow&&s.push("text-shadow: auto;"),b.push('<span style="'+s.join("")+'">'),p.b&&(b.push("<b>"),_.push("</b>")),p.i&&(b.push("<i>"),_.push("</i>")),p.strike&&(b.push("<s>"),_.push("</s>"));var C=p.valign||"";return C=="superscript"||C=="super"?C="sup":C=="subscript"&&(C="sub"),C!=""&&(b.push("<"+C+">"),_.push("</"+C+">")),_.push("</span>"),p}function f(p){var b=[[],p.v,[]];return p.v?(p.s&&l(p.s,b[0],b[2]),b[0].join("")+b[1].replace(u,"<br/>")+b[2].join("")):""}return function(b){return b.map(f).join("")}})(),iC=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,sC=/<(?:\w+:)?r>/,oC=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function x1(r,u){var l=u?u.cellHTML:!0,f={};return r?(r.match(/^\s*<(?:\w+:)?t[^>]*>/)?(f.t=ma(si(r.slice(r.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),f.r=si(r),l&&(f.h=l1(f.t))):r.match(sC)&&(f.r=si(r),f.t=ma(si((r.replace(oC,"").match(iC)||[]).join("").replace(Zo,""))),l&&(f.h=aC(nC(f.r)))),f):{t:""}}var lC=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,cC=/<(?:\w+:)?(?:si|sstItem)>/g,uC=/<\/(?:\w+:)?(?:si|sstItem)>/;function hC(r,u){var l=[],f="";if(!r)return l;var p=r.match(lC);if(p){f=p[2].replace(cC,"").split(uC);for(var b=0;b!=f.length;++b){var _=x1(f[b].trim(),u);_!=null&&(l[l.length]=_)}p=vn(p[1]),l.Count=p.count,l.Unique=p.uniqueCount}return l}function fC(r){return[r.read_shift(4),r.read_shift(4)]}function dC(r,u){var l=[],f=!1;return If(r,function(b,_,s){switch(s){case 159:l.Count=b[0],l.Unique=b[1];break;case 19:l.push(b);break;case 160:return!0;case 35:f=!0;break;case 36:f=!1;break;default:if(_.T,!f||u.WTF)throw new Error("Unexpected record 0x"+s.toString(16))}}),l}function q2(r){for(var u=[],l=r.split(""),f=0;f<l.length;++f)u[f]=l[f].charCodeAt(0);return u}function Cf(r,u){var l={};return l.Major=r.read_shift(2),l.Minor=r.read_shift(2),u>=4&&(r.l+=u-4),l}function pC(r){var u={};return u.id=r.read_shift(0,"lpp4"),u.R=Cf(r,4),u.U=Cf(r,4),u.W=Cf(r,4),u}function mC(r){for(var u=r.read_shift(4),l=r.l+u-4,f={},p=r.read_shift(4),b=[];p-- >0;)b.push({t:r.read_shift(4),v:r.read_shift(0,"lpp4")});if(f.name=r.read_shift(0,"lpp4"),f.comps=b,r.l!=l)throw new Error("Bad DataSpaceMapEntry: "+r.l+" != "+l);return f}function gC(r){var u=[];r.l+=4;for(var l=r.read_shift(4);l-- >0;)u.push(mC(r));return u}function _C(r){var u=[];r.l+=4;for(var l=r.read_shift(4);l-- >0;)u.push(r.read_shift(0,"lpp4"));return u}function xC(r){var u={};return r.read_shift(4),r.l+=4,u.id=r.read_shift(0,"lpp4"),u.name=r.read_shift(0,"lpp4"),u.R=Cf(r,4),u.U=Cf(r,4),u.W=Cf(r,4),u}function yC(r){var u=xC(r);if(u.ename=r.read_shift(0,"8lpp4"),u.blksz=r.read_shift(4),u.cmode=r.read_shift(4),r.read_shift(4)!=4)throw new Error("Bad !Primary record");return u}function Z2(r,u){var l=r.l+u,f={};f.Flags=r.read_shift(4)&63,r.l+=4,f.AlgID=r.read_shift(4);var p=!1;switch(f.AlgID){case 26126:case 26127:case 26128:p=f.Flags==36;break;case 26625:p=f.Flags==4;break;case 0:p=f.Flags==16||f.Flags==4||f.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+f.AlgID}if(!p)throw new Error("Encryption Flags/AlgID mismatch");return f.AlgIDHash=r.read_shift(4),f.KeySize=r.read_shift(4),f.ProviderType=r.read_shift(4),r.l+=8,f.CSPName=r.read_shift(l-r.l>>1,"utf16le"),r.l=l,f}function W2(r,u){var l={},f=r.l+u;return r.l+=4,l.Salt=r.slice(r.l,r.l+16),r.l+=16,l.Verifier=r.slice(r.l,r.l+16),r.l+=16,r.read_shift(4),l.VerifierHash=r.slice(r.l,f),r.l=f,l}function vC(r){var u=Cf(r);switch(u.Minor){case 2:return[u.Minor,bC(r)];case 3:return[u.Minor,wC()];case 4:return[u.Minor,TC(r)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+u.Minor)}function bC(r){var u=r.read_shift(4);if((u&63)!=36)throw new Error("EncryptionInfo mismatch");var l=r.read_shift(4),f=Z2(r,l),p=W2(r,r.length-r.l);return{t:"Std",h:f,v:p}}function wC(){throw new Error("File is password-protected: ECMA-376 Extensible")}function TC(r){var u=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];r.l+=4;var l=r.read_shift(r.length-r.l,"utf8"),f={};return l.replace(Zo,function(b){var _=vn(b);switch(Hh(_[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":u.forEach(function(s){f[s]=_[s]});break;case"<dataIntegrity":f.encryptedHmacKey=_.encryptedHmacKey,f.encryptedHmacValue=_.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":f.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":f.uri=_.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":f.encs.push(_);break;default:throw _[0]}}),f}function SC(r,u){var l={},f=l.EncryptionVersionInfo=Cf(r,4);if(u-=4,f.Minor!=2)throw new Error("unrecognized minor version code: "+f.Minor);if(f.Major>4||f.Major<2)throw new Error("unrecognized major version code: "+f.Major);l.Flags=r.read_shift(4),u-=4;var p=r.read_shift(4);return u-=4,l.EncryptionHeader=Z2(r,p),u-=p,l.EncryptionVerifier=W2(r,u),l}function EC(r){var u={},l=u.EncryptionVersionInfo=Cf(r,4);if(l.Major!=1||l.Minor!=1)throw"unrecognized version code "+l.Major+" : "+l.Minor;return u.Salt=r.read_shift(16),u.EncryptedVerifier=r.read_shift(16),u.EncryptedVerifierHash=r.read_shift(16),u}function AC(r){var u=0,l,f=q2(r),p=f.length+1,b,_,s,C,M;for(l=Td(p),l[0]=f.length,b=1;b!=p;++b)l[b]=f[b-1];for(b=p-1;b>=0;--b)_=l[b],s=(u&16384)===0?0:1,C=u<<1&32767,M=s|C,u=M^_;return u^52811}var $2=(function(){var r=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],u=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],l=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],f=function(_){return(_/2|_*128)&255},p=function(_,s){return f(_^s)},b=function(_){for(var s=u[_.length-1],C=104,M=_.length-1;M>=0;--M)for(var D=_[M],B=0;B!=7;++B)D&64&&(s^=l[C]),D*=2,--C;return s};return function(_){for(var s=q2(_),C=b(s),M=s.length,D=Td(16),B=0;B!=16;++B)D[B]=0;var U,j,H;for((M&1)===1&&(U=C>>8,D[M]=p(r[0],U),--M,U=C&255,j=s[s.length-1],D[M]=p(j,U));M>0;)--M,U=C>>8,D[M]=p(s[M],U),--M,U=C&255,D[M]=p(s[M],U);for(M=15,H=15-s.length;H>0;)U=C>>8,D[M]=p(r[H],U),--M,--H,U=C&255,D[M]=p(s[M],U),--M,--H;return D}})(),kC=function(r,u,l,f,p){p||(p=u),f||(f=$2(r));var b,_;for(b=0;b!=u.length;++b)_=u[b],_^=f[l],_=(_>>5|_<<3)&255,p[b]=_,++l;return[p,l,f]},CC=function(r){var u=0,l=$2(r);return function(f){var p=kC("",f,u,l);return u=p[1],p[0]}};function MC(r,u,l,f){var p={key:_s(r),verificationBytes:_s(r)};return l.password&&(p.verifier=AC(l.password)),f.valid=p.verificationBytes===p.verifier,f.valid&&(f.insitu=CC(l.password)),p}function DC(r,u,l){var f=l||{};return f.Info=r.read_shift(2),r.l-=2,f.Info===1?f.Data=EC(r):f.Data=SC(r,u),f}function RC(r,u,l){var f={Type:l.biff>=8?r.read_shift(2):0};return f.Type?DC(r,u-2,f):MC(r,l.biff>=8?u:u-2,l,f),f}var IC=(function(){function r(p,b){switch(b.type){case"base64":return u(Ic(p),b);case"binary":return u(p,b);case"buffer":return u(ta&&Buffer.isBuffer(p)?p.toString("binary"):Mp(p),b);case"array":return u(Ep(p),b)}throw new Error("Unrecognized type "+b.type)}function u(p,b){var _=b||{},s=_.dense?[]:{},C=p.match(/\\trowd.*?\\row\b/g);if(!C.length)throw new Error("RTF missing table");var M={s:{c:0,r:0},e:{c:0,r:C.length-1}};return C.forEach(function(D,B){Array.isArray(s)&&(s[B]=[]);for(var U=/\\\w+\b/g,j=0,H,z=-1;H=U.exec(D);){switch(H[0]){case"\\cell":var N=D.slice(j,U.lastIndex-H[0].length);if(N[0]==" "&&(N=N.slice(1)),++z,N.length){var Z={v:N,t:"s"};Array.isArray(s)?s[B][z]=Z:s[kn({r:B,c:z})]=Z}break}j=U.lastIndex}z>M.e.c&&(M.e.c=z)}),s["!ref"]=oa(M),s}function l(p,b){return Ed(r(p,b),b)}function f(p){for(var b=["{\\rtf1\\ansi"],_=Xi(p["!ref"]),s,C=Array.isArray(p),M=_.s.r;M<=_.e.r;++M){b.push("\\trowd\\trautofit1");for(var D=_.s.c;D<=_.e.c;++D)b.push("\\cellx"+(D+1));for(b.push("\\pard\\intbl"),D=_.s.c;D<=_.e.c;++D){var B=kn({r:M,c:D});s=C?(p[M]||[])[D]:p[B],!(!s||s.v==null&&(!s.f||s.F))&&(b.push(" "+(s.w||(Df(s),s.w))),b.push("\\cell"))}b.push("\\pard\\intbl\\row")}return b.join("")+"}"}return{to_workbook:l,to_sheet:r,from_sheet:f}})();function PC(r){var u=r.slice(r[0]==="#"?1:0).slice(0,6);return[parseInt(u.slice(0,2),16),parseInt(u.slice(2,4),16),parseInt(u.slice(4,6),16)]}function zg(r){for(var u=0,l=1;u!=3;++u)l=l*256+(r[u]>255?255:r[u]<0?0:r[u]);return l.toString(16).toUpperCase().slice(1)}function FC(r){var u=r[0]/255,l=r[1]/255,f=r[2]/255,p=Math.max(u,l,f),b=Math.min(u,l,f),_=p-b;if(_===0)return[0,0,u];var s=0,C=0,M=p+b;switch(C=_/(M>1?2-M:M),p){case u:s=((l-f)/_+6)%6;break;case l:s=(f-u)/_+2;break;case f:s=(u-l)/_+4;break}return[s/6,C,M/2]}function LC(r){var u=r[0],l=r[1],f=r[2],p=l*2*(f<.5?f:1-f),b=f-p/2,_=[b,b,b],s=6*u,C;if(l!==0)switch(s|0){case 0:case 6:C=p*s,_[0]+=p,_[1]+=C;break;case 1:C=p*(2-s),_[0]+=C,_[1]+=p;break;case 2:C=p*(s-2),_[1]+=p,_[2]+=C;break;case 3:C=p*(4-s),_[1]+=C,_[2]+=p;break;case 4:C=p*(s-4),_[2]+=p,_[0]+=C;break;case 5:C=p*(6-s),_[2]+=C,_[0]+=p;break}for(var M=0;M!=3;++M)_[M]=Math.round(_[M]*255);return _}function kx(r,u){if(u===0)return r;var l=FC(PC(r));return u<0?l[2]=l[2]*(1+u):l[2]=1-(1-l[2])*(1-u),zg(LC(l))}var X2=6,zC=15,OC=1,vl=X2;function Cx(r){return Math.floor((r+Math.round(128/vl)/256)*vl)}function Mx(r){return Math.floor((r-5)/vl*100+.5)/100}function By(r){return Math.round((r*vl+5)/vl*256)/256}function xy(r){return By(Mx(Cx(r)))}function y1(r){var u=Math.abs(r-xy(r)),l=vl;if(u>.005)for(vl=OC;vl<zC;++vl)Math.abs(r-xy(r))<=u&&(u=Math.abs(r-xy(r)),l=vl);vl=l}function Y0(r){r.width?(r.wpx=Cx(r.width),r.wch=Mx(r.wpx),r.MDW=vl):r.wpx?(r.wch=Mx(r.wpx),r.width=By(r.wch),r.MDW=vl):typeof r.wch=="number"&&(r.width=By(r.wch),r.wpx=Cx(r.width),r.MDW=vl),r.customWidth&&delete r.customWidth}var BC=96,Y2=BC;function K2(r){return r*96/Y2}function Og(r){return r*Y2/96}var NC={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function jC(r,u,l,f){u.Borders=[];var p={},b=!1;(r[0].match(Zo)||[]).forEach(function(_){var s=vn(_);switch(Hh(s[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":p={},s.diagonalUp&&(p.diagonalUp=bi(s.diagonalUp)),s.diagonalDown&&(p.diagonalDown=bi(s.diagonalDown)),u.Borders.push(p);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":b=!0;break;case"</ext>":b=!1;break;default:if(f&&f.WTF&&!b)throw new Error("unrecognized "+s[0]+" in borders")}})}function UC(r,u,l,f){u.Fills=[];var p={},b=!1;(r[0].match(Zo)||[]).forEach(function(_){var s=vn(_);switch(Hh(s[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":p={},u.Fills.push(p);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":u.Fills.push(p),p={};break;case"<patternFill":case"<patternFill>":s.patternType&&(p.patternType=s.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":p.bgColor||(p.bgColor={}),s.indexed&&(p.bgColor.indexed=parseInt(s.indexed,10)),s.theme&&(p.bgColor.theme=parseInt(s.theme,10)),s.tint&&(p.bgColor.tint=parseFloat(s.tint)),s.rgb&&(p.bgColor.rgb=s.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":p.fgColor||(p.fgColor={}),s.theme&&(p.fgColor.theme=parseInt(s.theme,10)),s.tint&&(p.fgColor.tint=parseFloat(s.tint)),s.rgb!=null&&(p.fgColor.rgb=s.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":b=!0;break;case"</ext>":b=!1;break;default:if(f&&f.WTF&&!b)throw new Error("unrecognized "+s[0]+" in fills")}})}function VC(r,u,l,f){u.Fonts=[];var p={},b=!1;(r[0].match(Zo)||[]).forEach(function(_){var s=vn(_);switch(Hh(s[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":u.Fonts.push(p),p={};break;case"<name":s.val&&(p.name=si(s.val));break;case"<name/>":case"</name>":break;case"<b":p.bold=s.val?bi(s.val):1;break;case"<b/>":p.bold=1;break;case"<i":p.italic=s.val?bi(s.val):1;break;case"<i/>":p.italic=1;break;case"<u":switch(s.val){case"none":p.underline=0;break;case"single":p.underline=1;break;case"double":p.underline=2;break;case"singleAccounting":p.underline=33;break;case"doubleAccounting":p.underline=34;break}break;case"<u/>":p.underline=1;break;case"<strike":p.strike=s.val?bi(s.val):1;break;case"<strike/>":p.strike=1;break;case"<outline":p.outline=s.val?bi(s.val):1;break;case"<outline/>":p.outline=1;break;case"<shadow":p.shadow=s.val?bi(s.val):1;break;case"<shadow/>":p.shadow=1;break;case"<condense":p.condense=s.val?bi(s.val):1;break;case"<condense/>":p.condense=1;break;case"<extend":p.extend=s.val?bi(s.val):1;break;case"<extend/>":p.extend=1;break;case"<sz":s.val&&(p.sz=+s.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":s.val&&(p.vertAlign=s.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":s.val&&(p.family=parseInt(s.val,10));break;case"<family/>":case"</family>":break;case"<scheme":s.val&&(p.scheme=s.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(s.val=="1")break;s.codepage=t1[parseInt(s.val,10)];break;case"<color":if(p.color||(p.color={}),s.auto&&(p.color.auto=bi(s.auto)),s.rgb)p.color.rgb=s.rgb.slice(-6);else if(s.indexed){p.color.index=parseInt(s.indexed,10);var C=Tp[p.color.index];p.color.index==81&&(C=Tp[1]),C||(C=Tp[1]),p.color.rgb=C[0].toString(16)+C[1].toString(16)+C[2].toString(16)}else s.theme&&(p.color.theme=parseInt(s.theme,10),s.tint&&(p.color.tint=parseFloat(s.tint)),s.theme&&l.themeElements&&l.themeElements.clrScheme&&(p.color.rgb=kx(l.themeElements.clrScheme[p.color.theme].rgb,p.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":b=!0;break;case"</AlternateContent>":b=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":b=!0;break;case"</ext>":b=!1;break;default:if(f&&f.WTF&&!b)throw new Error("unrecognized "+s[0]+" in fonts")}})}function GC(r,u,l){u.NumberFmt=[];for(var f=Gh(Pn),p=0;p<f.length;++p)u.NumberFmt[f[p]]=Pn[f[p]];var b=r[0].match(Zo);if(b)for(p=0;p<b.length;++p){var _=vn(b[p]);switch(Hh(_[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var s=ma(si(_.formatCode)),C=parseInt(_.numFmtId,10);if(u.NumberFmt[C]=s,C>0){if(C>392){for(C=392;C>60&&u.NumberFmt[C]!=null;--C);u.NumberFmt[C]=s}wp(s,C)}}break;case"</numFmt>":break;default:if(l.WTF)throw new Error("unrecognized "+_[0]+" in numFmts")}}}var nx=["numFmtId","fillId","fontId","borderId","xfId"],ax=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function HC(r,u,l){u.CellXf=[];var f,p=!1;(r[0].match(Zo)||[]).forEach(function(b){var _=vn(b),s=0;switch(Hh(_[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(f=_,delete f[0],s=0;s<nx.length;++s)f[nx[s]]&&(f[nx[s]]=parseInt(f[nx[s]],10));for(s=0;s<ax.length;++s)f[ax[s]]&&(f[ax[s]]=bi(f[ax[s]]));if(u.NumberFmt&&f.numFmtId>392){for(s=392;s>60;--s)if(u.NumberFmt[f.numFmtId]==u.NumberFmt[s]){f.numFmtId=s;break}}u.CellXf.push(f);break;case"</xf>":break;case"<alignment":case"<alignment/>":var C={};_.vertical&&(C.vertical=_.vertical),_.horizontal&&(C.horizontal=_.horizontal),_.textRotation!=null&&(C.textRotation=_.textRotation),_.indent&&(C.indent=_.indent),_.wrapText&&(C.wrapText=bi(_.wrapText)),f.alignment=C;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":p=!0;break;case"</AlternateContent>":p=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":p=!0;break;case"</ext>":p=!1;break;default:if(l&&l.WTF&&!p)throw new Error("unrecognized "+_[0]+" in cellXfs")}})}var qC=(function(){var u=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,l=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,f=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,p=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,b=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(s,C,M){var D={};if(!s)return D;s=s.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var B;return(B=s.match(u))&&GC(B,D,M),(B=s.match(p))&&VC(B,D,C,M),(B=s.match(f))&&UC(B,D,C,M),(B=s.match(b))&&jC(B,D,C,M),(B=s.match(l))&&HC(B,D,M),D}})();function ZC(r,u){var l=r.read_shift(2),f=Ho(r);return[l,f]}function WC(r,u,l){var f={};f.sz=r.read_shift(2)/20;var p=nA(r);p.fItalic&&(f.italic=1),p.fCondense&&(f.condense=1),p.fExtend&&(f.extend=1),p.fShadow&&(f.shadow=1),p.fOutline&&(f.outline=1),p.fStrikeout&&(f.strike=1);var b=r.read_shift(2);switch(b===700&&(f.bold=1),r.read_shift(2)){case 1:f.vertAlign="superscript";break;case 2:f.vertAlign="subscript";break}var _=r.read_shift(1);_!=0&&(f.underline=_);var s=r.read_shift(1);s>0&&(f.family=s);var C=r.read_shift(1);switch(C>0&&(f.charset=C),r.l++,f.color=rA(r),r.read_shift(1)){case 1:f.scheme="major";break;case 2:f.scheme="minor";break}return f.name=Ho(r),f}var $C=qo;function XC(r,u){var l=r.l+u,f=r.read_shift(2),p=r.read_shift(2);return r.l=l,{ixfe:f,numFmtId:p}}var YC=qo;function KC(r,u,l){var f={};f.NumberFmt=[];for(var p in Pn)f.NumberFmt[p]=Pn[p];f.CellXf=[],f.Fonts=[];var b=[],_=!1;return If(r,function(C,M,D){switch(D){case 44:f.NumberFmt[C[0]]=C[1],wp(C[1],C[0]);break;case 43:f.Fonts.push(C),C.color.theme!=null&&u&&u.themeElements&&u.themeElements.clrScheme&&(C.color.rgb=kx(u.themeElements.clrScheme[C.color.theme].rgb,C.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:b[b.length-1]==617&&f.CellXf.push(C);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:_=!0;break;case 36:_=!1;break;case 37:b.push(D),_=!0;break;case 38:b.pop(),_=!1;break;default:if(M.T>0)b.push(D);else if(M.T<0)b.pop();else if(!_||l.WTF&&b[b.length-1]!=37)throw new Error("Unexpected record 0x"+D.toString(16))}}),f}var JC=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function QC(r,u,l){u.themeElements.clrScheme=[];var f={};(r[0].match(Zo)||[]).forEach(function(p){var b=vn(p);switch(b[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":f.rgb=b.val;break;case"<a:sysClr":f.rgb=b.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":b[0].charAt(1)==="/"?(u.themeElements.clrScheme[JC.indexOf(b[0])]=f,f={}):f.name=b[0].slice(3,b[0].length-1);break;default:if(l&&l.WTF)throw new Error("Unrecognized "+b[0]+" in clrScheme")}})}function e5(){}function t5(){}var r5=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,n5=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,a5=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function i5(r,u,l){u.themeElements={};var f;[["clrScheme",r5,QC],["fontScheme",n5,e5],["fmtScheme",a5,t5]].forEach(function(p){if(!(f=r.match(p[1])))throw new Error(p[0]+" not found in themeElements");p[2](f,u,l)})}var s5=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function J2(r,u){(!r||r.length===0)&&(r=o5());var l,f={};if(!(l=r.match(s5)))throw new Error("themeElements not found in theme");return i5(l[0],f,u),f.raw=r,f}function o5(r,u){var l=[c2];return l[l.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',l[l.length]="<a:themeElements>",l[l.length]='<a:clrScheme name="Office">',l[l.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',l[l.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',l[l.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',l[l.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',l[l.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',l[l.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',l[l.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',l[l.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',l[l.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',l[l.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',l[l.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',l[l.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',l[l.length]="</a:clrScheme>",l[l.length]='<a:fontScheme name="Office">',l[l.length]="<a:majorFont>",l[l.length]='<a:latin typeface="Cambria"/>',l[l.length]='<a:ea typeface=""/>',l[l.length]='<a:cs typeface=""/>',l[l.length]='<a:font script="Jpan" typeface=" "/>',l[l.length]='<a:font script="Hang" typeface=" "/>',l[l.length]='<a:font script="Hans" typeface=""/>',l[l.length]='<a:font script="Hant" typeface=""/>',l[l.length]='<a:font script="Arab" typeface="Times New Roman"/>',l[l.length]='<a:font script="Hebr" typeface="Times New Roman"/>',l[l.length]='<a:font script="Thai" typeface="Tahoma"/>',l[l.length]='<a:font script="Ethi" typeface="Nyala"/>',l[l.length]='<a:font script="Beng" typeface="Vrinda"/>',l[l.length]='<a:font script="Gujr" typeface="Shruti"/>',l[l.length]='<a:font script="Khmr" typeface="MoolBoran"/>',l[l.length]='<a:font script="Knda" typeface="Tunga"/>',l[l.length]='<a:font script="Guru" typeface="Raavi"/>',l[l.length]='<a:font script="Cans" typeface="Euphemia"/>',l[l.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',l[l.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',l[l.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',l[l.length]='<a:font script="Thaa" typeface="MV Boli"/>',l[l.length]='<a:font script="Deva" typeface="Mangal"/>',l[l.length]='<a:font script="Telu" typeface="Gautami"/>',l[l.length]='<a:font script="Taml" typeface="Latha"/>',l[l.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',l[l.length]='<a:font script="Orya" typeface="Kalinga"/>',l[l.length]='<a:font script="Mlym" typeface="Kartika"/>',l[l.length]='<a:font script="Laoo" typeface="DokChampa"/>',l[l.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',l[l.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',l[l.length]='<a:font script="Viet" typeface="Times New Roman"/>',l[l.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',l[l.length]='<a:font script="Geor" typeface="Sylfaen"/>',l[l.length]="</a:majorFont>",l[l.length]="<a:minorFont>",l[l.length]='<a:latin typeface="Calibri"/>',l[l.length]='<a:ea typeface=""/>',l[l.length]='<a:cs typeface=""/>',l[l.length]='<a:font script="Jpan" typeface=" "/>',l[l.length]='<a:font script="Hang" typeface=" "/>',l[l.length]='<a:font script="Hans" typeface=""/>',l[l.length]='<a:font script="Hant" typeface=""/>',l[l.length]='<a:font script="Arab" typeface="Arial"/>',l[l.length]='<a:font script="Hebr" typeface="Arial"/>',l[l.length]='<a:font script="Thai" typeface="Tahoma"/>',l[l.length]='<a:font script="Ethi" typeface="Nyala"/>',l[l.length]='<a:font script="Beng" typeface="Vrinda"/>',l[l.length]='<a:font script="Gujr" typeface="Shruti"/>',l[l.length]='<a:font script="Khmr" typeface="DaunPenh"/>',l[l.length]='<a:font script="Knda" typeface="Tunga"/>',l[l.length]='<a:font script="Guru" typeface="Raavi"/>',l[l.length]='<a:font script="Cans" typeface="Euphemia"/>',l[l.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',l[l.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',l[l.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',l[l.length]='<a:font script="Thaa" typeface="MV Boli"/>',l[l.length]='<a:font script="Deva" typeface="Mangal"/>',l[l.length]='<a:font script="Telu" typeface="Gautami"/>',l[l.length]='<a:font script="Taml" typeface="Latha"/>',l[l.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',l[l.length]='<a:font script="Orya" typeface="Kalinga"/>',l[l.length]='<a:font script="Mlym" typeface="Kartika"/>',l[l.length]='<a:font script="Laoo" typeface="DokChampa"/>',l[l.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',l[l.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',l[l.length]='<a:font script="Viet" typeface="Arial"/>',l[l.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',l[l.length]='<a:font script="Geor" typeface="Sylfaen"/>',l[l.length]="</a:minorFont>",l[l.length]="</a:fontScheme>",l[l.length]='<a:fmtScheme name="Office">',l[l.length]="<a:fillStyleLst>",l[l.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',l[l.length]='<a:gradFill rotWithShape="1">',l[l.length]="<a:gsLst>",l[l.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',l[l.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',l[l.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',l[l.length]="</a:gsLst>",l[l.length]='<a:lin ang="16200000" scaled="1"/>',l[l.length]="</a:gradFill>",l[l.length]='<a:gradFill rotWithShape="1">',l[l.length]="<a:gsLst>",l[l.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',l[l.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',l[l.length]="</a:gsLst>",l[l.length]='<a:lin ang="16200000" scaled="0"/>',l[l.length]="</a:gradFill>",l[l.length]="</a:fillStyleLst>",l[l.length]="<a:lnStyleLst>",l[l.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',l[l.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',l[l.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',l[l.length]="</a:lnStyleLst>",l[l.length]="<a:effectStyleLst>",l[l.length]="<a:effectStyle>",l[l.length]="<a:effectLst>",l[l.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',l[l.length]="</a:effectLst>",l[l.length]="</a:effectStyle>",l[l.length]="<a:effectStyle>",l[l.length]="<a:effectLst>",l[l.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',l[l.length]="</a:effectLst>",l[l.length]="</a:effectStyle>",l[l.length]="<a:effectStyle>",l[l.length]="<a:effectLst>",l[l.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',l[l.length]="</a:effectLst>",l[l.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',l[l.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',l[l.length]="</a:effectStyle>",l[l.length]="</a:effectStyleLst>",l[l.length]="<a:bgFillStyleLst>",l[l.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',l[l.length]='<a:gradFill rotWithShape="1">',l[l.length]="<a:gsLst>",l[l.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',l[l.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',l[l.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',l[l.length]="</a:gsLst>",l[l.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',l[l.length]="</a:gradFill>",l[l.length]='<a:gradFill rotWithShape="1">',l[l.length]="<a:gsLst>",l[l.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',l[l.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',l[l.length]="</a:gsLst>",l[l.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',l[l.length]="</a:gradFill>",l[l.length]="</a:bgFillStyleLst>",l[l.length]="</a:fmtScheme>",l[l.length]="</a:themeElements>",l[l.length]="<a:objectDefaults>",l[l.length]="<a:spDef>",l[l.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',l[l.length]="</a:spDef>",l[l.length]="<a:lnDef>",l[l.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',l[l.length]="</a:lnDef>",l[l.length]="</a:objectDefaults>",l[l.length]="<a:extraClrSchemeLst/>",l[l.length]="</a:theme>",l.join("")}function l5(r,u,l){var f=r.l+u,p=r.read_shift(4);if(p!==124226){if(!l.cellStyles){r.l=f;return}var b=r.slice(r.l);r.l=f;var _;try{_=l2(b,{type:"array"})}catch{return}var s=Rc(_,"theme/theme/theme1.xml",!0);if(s)return J2(s,l)}}function c5(r){return r.read_shift(4)}function u5(r){var u={};switch(u.xclrType=r.read_shift(2),u.nTintShade=r.read_shift(2),u.xclrType){case 0:r.l+=4;break;case 1:u.xclrValue=h5(r,4);break;case 2:u.xclrValue=B2(r);break;case 3:u.xclrValue=c5(r);break;case 4:r.l+=4;break}return r.l+=8,u}function h5(r,u){return qo(r,u)}function f5(r,u){return qo(r,u)}function d5(r){var u=r.read_shift(2),l=r.read_shift(2)-4,f=[u];switch(u){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:f[1]=u5(r);break;case 6:f[1]=f5(r,l);break;case 14:case 15:f[1]=r.read_shift(l===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+u+" "+l)}return f}function p5(r,u){var l=r.l+u;r.l+=2;var f=r.read_shift(2);r.l+=2;for(var p=r.read_shift(2),b=[];p-- >0;)b.push(d5(r,l-r.l));return{ixfe:f,ext:b}}function m5(r,u){u.forEach(function(l){l[0]})}function g5(r,u){return{flags:r.read_shift(4),version:r.read_shift(4),name:Ho(r)}}function _5(r){for(var u=[],l=r.read_shift(4);l-- >0;)u.push([r.read_shift(4),r.read_shift(4)]);return u}function x5(r){return r.l+=4,r.read_shift(4)!=0}function y5(r,u,l){var f={Types:[],Cell:[],Value:[]},p=l||{},b=[],_=!1,s=2;return If(r,function(C,M,D){switch(D){case 335:f.Types.push({name:C.name});break;case 51:C.forEach(function(B){s==1?f.Cell.push({type:f.Types[B[0]-1].name,index:B[1]}):s==0&&f.Value.push({type:f.Types[B[0]-1].name,index:B[1]})});break;case 337:s=C?1:0;break;case 338:s=2;break;case 35:b.push(D),_=!0;break;case 36:b.pop(),_=!1;break;default:if(!M.T){if(!_||p.WTF&&b[b.length-1]!=35)throw new Error("Unexpected record 0x"+D.toString(16))}}}),f}function v5(r,u,l){var f={Types:[],Cell:[],Value:[]};if(!r)return f;var p=!1,b=2,_;return r.replace(Zo,function(s){var C=vn(s);switch(Hh(C[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":f.Types.push({name:C.name});break;case"</metadataType>":break;case"<futureMetadata":for(var M=0;M<f.Types.length;++M)f.Types[M].name==C.name&&(_=f.Types[M]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":b==1?f.Cell.push({type:f.Types[C.t-1].name,index:+C.v}):b==0&&f.Value.push({type:f.Types[C.t-1].name,index:+C.v});break;case"</rc>":break;case"<cellMetadata":b=1;break;case"</cellMetadata>":b=2;break;case"<valueMetadata":b=0;break;case"</valueMetadata>":b=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":p=!0;break;case"</ext>":p=!1;break;case"<rvb":if(!_)break;_.offsets||(_.offsets=[]),_.offsets.push(+C.i);break;default:if(!p&&l.WTF)throw new Error("unrecognized "+C[0]+" in metadata")}return s}),f}function b5(r){var u=[];if(!r)return u;var l=1;return(r.match(Zo)||[]).forEach(function(f){var p=vn(f);switch(p[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete p[0],p.i?l=p.i:p.i=l,u.push(p);break}}),u}function w5(r){var u={};u.i=r.read_shift(4);var l={};l.r=r.read_shift(4),l.c=r.read_shift(4),u.r=kn(l);var f=r.read_shift(1);return f&2&&(u.l="1"),f&8&&(u.a="1"),u}function T5(r,u,l){var f=[];return If(r,function(b,_,s){switch(s){case 63:f.push(b);break;default:if(!_.T)throw new Error("Unexpected record 0x"+s.toString(16))}}),f}function S5(r,u,l,f){if(!r)return r;var p=f||{},b=!1;If(r,function(s,C,M){switch(M){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:b=!0;break;case 36:b=!1;break;default:if(!C.T){if(!b||p.WTF)throw new Error("Unexpected record 0x"+M.toString(16))}}},p)}function E5(r,u){if(!r)return"??";var l=(r.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return u["!id"][l].Target}function qv(r,u,l,f){var p=Array.isArray(r),b;u.forEach(function(_){var s=bl(_.ref);if(p?(r[s.r]||(r[s.r]=[]),b=r[s.r][s.c]):b=r[_.ref],!b){b={t:"z"},p?r[s.r][s.c]=b:r[_.ref]=b;var C=Xi(r["!ref"]||"BDWGO1000001:A1");C.s.r>s.r&&(C.s.r=s.r),C.e.r<s.r&&(C.e.r=s.r),C.s.c>s.c&&(C.s.c=s.c),C.e.c<s.c&&(C.e.c=s.c);var M=oa(C);M!==r["!ref"]&&(r["!ref"]=M)}b.c||(b.c=[]);var D={a:_.author,t:_.t,r:_.r,T:l};_.h&&(D.h=_.h);for(var B=b.c.length-1;B>=0;--B){if(!l&&b.c[B].T)return;l&&!b.c[B].T&&b.c.splice(B,1)}if(l&&f){for(B=0;B<f.length;++B)if(D.a==f[B].id){D.a=f[B].name||D.a;break}}b.c.push(D)})}function A5(r,u){if(r.match(/<(?:\w+:)?comments *\/>/))return[];var l=[],f=[],p=r.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);p&&p[1]&&p[1].split(/<\/\w*:?author>/).forEach(function(_){if(!(_===""||_.trim()==="")){var s=_.match(/<(?:\w+:)?author[^>]*>(.*)/);s&&l.push(s[1])}});var b=r.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return b&&b[1]&&b[1].split(/<\/\w*:?comment>/).forEach(function(_){if(!(_===""||_.trim()==="")){var s=_.match(/<(?:\w+:)?comment[^>]*>/);if(s){var C=vn(s[0]),M={author:C.authorId&&l[C.authorId]||"sheetjsghost",ref:C.ref,guid:C.guid},D=bl(C.ref);if(!(u.sheetRows&&u.sheetRows<=D.r)){var B=_.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),U=!!B&&!!B[1]&&x1(B[1])||{r:"",t:"",h:""};M.r=U.r,U.r=="<t></t>"&&(U.t=U.h=""),M.t=(U.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),u.cellHTML&&(M.h=U.h),f.push(M)}}}}),f}function k5(r,u){var l=[],f=!1,p={},b=0;return r.replace(Zo,function(s,C){var M=vn(s);switch(Hh(M[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":p={author:M.personId,guid:M.id,ref:M.ref,T:1};break;case"</threadedComment>":p.t!=null&&l.push(p);break;case"<text>":case"<text":b=C+s.length;break;case"</text>":p.t=r.slice(b,C).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":f=!0;break;case"</mentions>":f=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":f=!0;break;case"</ext>":f=!1;break;default:if(!f&&u.WTF)throw new Error("unrecognized "+M[0]+" in threaded comments")}return s}),l}function C5(r,u){var l=[],f=!1;return r.replace(Zo,function(b){var _=vn(b);switch(Hh(_[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":l.push({name:_.displayname,id:_.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":f=!0;break;case"</ext>":f=!1;break;default:if(!f&&u.WTF)throw new Error("unrecognized "+_[0]+" in threaded comments")}return b}),l}function M5(r){var u={};u.iauthor=r.read_shift(4);var l=Rp(r);return u.rfx=l.s,u.ref=kn(l.s),r.l+=16,u}var D5=Ho;function R5(r,u){var l=[],f=[],p={},b=!1;return If(r,function(s,C,M){switch(M){case 632:f.push(s);break;case 635:p=s;break;case 637:p.t=s.t,p.h=s.h,p.r=s.r;break;case 636:if(p.author=f[p.iauthor],delete p.iauthor,u.sheetRows&&p.rfx&&u.sheetRows<=p.rfx.r)break;p.t||(p.t=""),delete p.rfx,l.push(p);break;case 3072:break;case 35:b=!0;break;case 36:b=!1;break;case 37:break;case 38:break;default:if(!C.T){if(!b||u.WTF)throw new Error("Unexpected record 0x"+M.toString(16))}}}),l}var I5="application/vnd.ms-office.vbaProject";function P5(r){var u=sa.utils.cfb_new({root:"R"});return r.FullPaths.forEach(function(l,f){if(!(l.slice(-1)==="/"||!l.match(/_VBA_PROJECT_CUR/))){var p=l.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");sa.utils.cfb_add(u,p,r.FileIndex[f].content)}}),sa.write(u)}function F5(){return{"!type":"dialog"}}function L5(){return{"!type":"dialog"}}function z5(){return{"!type":"macro"}}function O5(){return{"!type":"macro"}}var Z0=(function(){var r=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,u={r:0,c:0};function l(f,p,b,_){var s=!1,C=!1;b.length==0?C=!0:b.charAt(0)=="["&&(C=!0,b=b.slice(1,-1)),_.length==0?s=!0:_.charAt(0)=="["&&(s=!0,_=_.slice(1,-1));var M=b.length>0?parseInt(b,10)|0:0,D=_.length>0?parseInt(_,10)|0:0;return s?D+=u.c:--D,C?M+=u.r:--M,p+(s?"":"$")+ks(D)+(C?"":"$")+_o(M)}return function(p,b){return u=b,p.replace(r,l)}})(),Q2=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,B5=(function(){return function(u,l){return u.replace(Q2,function(f,p,b,_,s,C){var M=f1(_)-(b?0:l.c),D=h1(C)-(s?0:l.r),B=D==0?"":s?D+1:"["+D+"]",U=M==0?"":b?M+1:"["+M+"]";return p+"R"+B+"C"+U})}})();function ew(r,u){return r.replace(Q2,function(l,f,p,b,_,s){return f+(p=="$"?p+b:ks(f1(b)+u.c))+(_=="$"?_+s:_o(h1(s)+u.r))})}function N5(r,u,l){var f=rm(u),p=f.s,b=bl(l),_={r:b.r-p.r,c:b.c-p.c};return ew(r,_)}function j5(r){return r.length!=1}function Zv(r){return r.replace(/_xlfn\./g,"")}function ms(r){r.l+=1}function Sd(r,u){var l=r.read_shift(2);return[l&16383,l>>14&1,l>>15&1]}function tw(r,u,l){var f=2;if(l){if(l.biff>=2&&l.biff<=5)return rw(r);l.biff==12&&(f=4)}var p=r.read_shift(f),b=r.read_shift(f),_=Sd(r),s=Sd(r);return{s:{r:p,c:_[0],cRel:_[1],rRel:_[2]},e:{r:b,c:s[0],cRel:s[1],rRel:s[2]}}}function rw(r){var u=Sd(r),l=Sd(r),f=r.read_shift(1),p=r.read_shift(1);return{s:{r:u[0],c:f,cRel:u[1],rRel:u[2]},e:{r:l[0],c:p,cRel:l[1],rRel:l[2]}}}function U5(r,u,l){if(l.biff<8)return rw(r);var f=r.read_shift(l.biff==12?4:2),p=r.read_shift(l.biff==12?4:2),b=Sd(r),_=Sd(r);return{s:{r:f,c:b[0],cRel:b[1],rRel:b[2]},e:{r:p,c:_[0],cRel:_[1],rRel:_[2]}}}function nw(r,u,l){if(l&&l.biff>=2&&l.biff<=5)return V5(r);var f=r.read_shift(l&&l.biff==12?4:2),p=Sd(r);return{r:f,c:p[0],cRel:p[1],rRel:p[2]}}function V5(r){var u=Sd(r),l=r.read_shift(1);return{r:u[0],c:l,cRel:u[1],rRel:u[2]}}function G5(r){var u=r.read_shift(2),l=r.read_shift(2);return{r:u,c:l&255,fQuoted:!!(l&16384),cRel:l>>15,rRel:l>>15}}function H5(r,u,l){var f=l&&l.biff?l.biff:8;if(f>=2&&f<=5)return q5(r);var p=r.read_shift(f>=12?4:2),b=r.read_shift(2),_=(b&16384)>>14,s=(b&32768)>>15;if(b&=16383,s==1)for(;p>524287;)p-=1048576;if(_==1)for(;b>8191;)b=b-16384;return{r:p,c:b,cRel:_,rRel:s}}function q5(r){var u=r.read_shift(2),l=r.read_shift(1),f=(u&32768)>>15,p=(u&16384)>>14;return u&=16383,f==1&&u>=8192&&(u=u-16384),p==1&&l>=128&&(l=l-256),{r:u,c:l,cRel:p,rRel:f}}function Z5(r,u,l){var f=(r[r.l++]&96)>>5,p=tw(r,l.biff>=2&&l.biff<=5?6:8,l);return[f,p]}function W5(r,u,l){var f=(r[r.l++]&96)>>5,p=r.read_shift(2,"i"),b=8;if(l)switch(l.biff){case 5:r.l+=12,b=6;break;case 12:b=12;break}var _=tw(r,b,l);return[f,p,_]}function $5(r,u,l){var f=(r[r.l++]&96)>>5;return r.l+=l&&l.biff>8?12:l.biff<8?6:8,[f]}function X5(r,u,l){var f=(r[r.l++]&96)>>5,p=r.read_shift(2),b=8;if(l)switch(l.biff){case 5:r.l+=12,b=6;break;case 12:b=12;break}return r.l+=b,[f,p]}function Y5(r,u,l){var f=(r[r.l++]&96)>>5,p=U5(r,u-1,l);return[f,p]}function K5(r,u,l){var f=(r[r.l++]&96)>>5;return r.l+=l.biff==2?6:l.biff==12?14:7,[f]}function Wv(r){var u=r[r.l+1]&1,l=1;return r.l+=4,[u,l]}function J5(r,u,l){r.l+=2;for(var f=r.read_shift(l&&l.biff==2?1:2),p=[],b=0;b<=f;++b)p.push(r.read_shift(l&&l.biff==2?1:2));return p}function Q5(r,u,l){var f=r[r.l+1]&255?1:0;return r.l+=2,[f,r.read_shift(l&&l.biff==2?1:2)]}function e3(r,u,l){var f=r[r.l+1]&255?1:0;return r.l+=2,[f,r.read_shift(l&&l.biff==2?1:2)]}function t3(r){var u=r[r.l+1]&255?1:0;return r.l+=2,[u,r.read_shift(2)]}function r3(r,u,l){var f=r[r.l+1]&255?1:0;return r.l+=l&&l.biff==2?3:4,[f]}function aw(r){var u=r.read_shift(1),l=r.read_shift(1);return[u,l]}function n3(r){return r.read_shift(2),aw(r)}function a3(r){return r.read_shift(2),aw(r)}function i3(r,u,l){var f=(r[r.l]&96)>>5;r.l+=1;var p=nw(r,0,l);return[f,p]}function s3(r,u,l){var f=(r[r.l]&96)>>5;r.l+=1;var p=H5(r,0,l);return[f,p]}function o3(r,u,l){var f=(r[r.l]&96)>>5;r.l+=1;var p=r.read_shift(2);l&&l.biff==5&&(r.l+=12);var b=nw(r,0,l);return[f,p,b]}function l3(r,u,l){var f=(r[r.l]&96)>>5;r.l+=1;var p=r.read_shift(l&&l.biff<=3?1:2);return[cM[p],ow[p],f]}function c3(r,u,l){var f=r[r.l++],p=r.read_shift(1),b=l&&l.biff<=3?[f==88?-1:0,r.read_shift(1)]:u3(r);return[p,(b[0]===0?ow:lM)[b[1]]]}function u3(r){return[r[r.l+1]>>7,r.read_shift(2)&32767]}function h3(r,u,l){r.l+=l&&l.biff==2?3:4}function f3(r,u,l){if(r.l++,l&&l.biff==12)return[r.read_shift(4,"i"),0];var f=r.read_shift(2),p=r.read_shift(l&&l.biff==2?1:2);return[f,p]}function d3(r){return r.l++,Ip[r.read_shift(1)]}function p3(r){return r.l++,r.read_shift(2)}function m3(r){return r.l++,r.read_shift(1)!==0}function g3(r){return r.l++,Vo(r)}function _3(r,u,l){return r.l++,Hg(r,u-1,l)}function x3(r,u){var l=[r.read_shift(1)];if(u==12)switch(l[0]){case 2:l[0]=4;break;case 4:l[0]=16;break;case 0:l[0]=1;break;case 1:l[0]=2;break}switch(l[0]){case 4:l[1]=is(r,1)?"TRUE":"FALSE",u!=12&&(r.l+=7);break;case 37:case 16:l[1]=Ip[r[r.l]],r.l+=u==12?4:8;break;case 0:r.l+=8;break;case 1:l[1]=Vo(r);break;case 2:l[1]=Pp(r,0,{biff:u>0&&u<8?2:u});break;default:throw new Error("Bad SerAr: "+l[0])}return l}function y3(r,u,l){for(var f=r.read_shift(l.biff==12?4:2),p=[],b=0;b!=f;++b)p.push((l.biff==12?Rp:Bx)(r));return p}function v3(r,u,l){var f=0,p=0;l.biff==12?(f=r.read_shift(4),p=r.read_shift(4)):(p=1+r.read_shift(1),f=1+r.read_shift(2)),l.biff>=2&&l.biff<8&&(--f,--p==0&&(p=256));for(var b=0,_=[];b!=f&&(_[b]=[]);++b)for(var s=0;s!=p;++s)_[b][s]=x3(r,l.biff);return _}function b3(r,u,l){var f=r.read_shift(1)>>>5&3,p=!l||l.biff>=8?4:2,b=r.read_shift(p);switch(l.biff){case 2:r.l+=5;break;case 3:case 4:r.l+=8;break;case 5:r.l+=12;break}return[f,0,b]}function w3(r,u,l){if(l.biff==5)return T3(r);var f=r.read_shift(1)>>>5&3,p=r.read_shift(2),b=r.read_shift(4);return[f,p,b]}function T3(r){var u=r.read_shift(1)>>>5&3,l=r.read_shift(2,"i");r.l+=8;var f=r.read_shift(2);return r.l+=12,[u,l,f]}function S3(r,u,l){var f=r.read_shift(1)>>>5&3;r.l+=l&&l.biff==2?3:4;var p=r.read_shift(l&&l.biff==2?1:2);return[f,p]}function E3(r,u,l){var f=r.read_shift(1)>>>5&3,p=r.read_shift(l&&l.biff==2?1:2);return[f,p]}function A3(r,u,l){var f=r.read_shift(1)>>>5&3;return r.l+=4,l.biff<8&&r.l--,l.biff==12&&(r.l+=2),[f]}function k3(r,u,l){var f=(r[r.l++]&96)>>5,p=r.read_shift(2),b=4;if(l)switch(l.biff){case 5:b=15;break;case 12:b=6;break}return r.l+=b,[f,p]}var C3=qo,M3=qo,D3=qo;function Zg(r,u,l){return r.l+=2,[G5(r)]}function v1(r){return r.l+=6,[]}var R3=Zg,I3=v1,P3=v1,F3=Zg;function iw(r){return r.l+=2,[_s(r),r.read_shift(2)&1]}var L3=Zg,z3=iw,O3=v1,B3=Zg,N3=Zg,j3=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function U3(r){r.l+=2;var u=r.read_shift(2),l=r.read_shift(2),f=r.read_shift(4),p=r.read_shift(2),b=r.read_shift(2),_=j3[l>>2&31];return{ixti:u,coltype:l&3,rt:_,idx:f,c:p,C:b}}function V3(r){return r.l+=2,[r.read_shift(4)]}function G3(r,u,l){return r.l+=5,r.l+=2,r.l+=l.biff==2?1:4,["PTGSHEET"]}function H3(r,u,l){return r.l+=l.biff==2?4:5,["PTGENDSHEET"]}function q3(r){var u=r.read_shift(1)>>>5&3,l=r.read_shift(2);return[u,l]}function Z3(r){var u=r.read_shift(1)>>>5&3,l=r.read_shift(2);return[u,l]}function W3(r){return r.l+=4,[0,0]}var $v={1:{n:"PtgExp",f:f3},2:{n:"PtgTbl",f:D3},3:{n:"PtgAdd",f:ms},4:{n:"PtgSub",f:ms},5:{n:"PtgMul",f:ms},6:{n:"PtgDiv",f:ms},7:{n:"PtgPower",f:ms},8:{n:"PtgConcat",f:ms},9:{n:"PtgLt",f:ms},10:{n:"PtgLe",f:ms},11:{n:"PtgEq",f:ms},12:{n:"PtgGe",f:ms},13:{n:"PtgGt",f:ms},14:{n:"PtgNe",f:ms},15:{n:"PtgIsect",f:ms},16:{n:"PtgUnion",f:ms},17:{n:"PtgRange",f:ms},18:{n:"PtgUplus",f:ms},19:{n:"PtgUminus",f:ms},20:{n:"PtgPercent",f:ms},21:{n:"PtgParen",f:ms},22:{n:"PtgMissArg",f:ms},23:{n:"PtgStr",f:_3},26:{n:"PtgSheet",f:G3},27:{n:"PtgEndSheet",f:H3},28:{n:"PtgErr",f:d3},29:{n:"PtgBool",f:m3},30:{n:"PtgInt",f:p3},31:{n:"PtgNum",f:g3},32:{n:"PtgArray",f:K5},33:{n:"PtgFunc",f:l3},34:{n:"PtgFuncVar",f:c3},35:{n:"PtgName",f:b3},36:{n:"PtgRef",f:i3},37:{n:"PtgArea",f:Z5},38:{n:"PtgMemArea",f:S3},39:{n:"PtgMemErr",f:C3},40:{n:"PtgMemNoMem",f:M3},41:{n:"PtgMemFunc",f:E3},42:{n:"PtgRefErr",f:A3},43:{n:"PtgAreaErr",f:$5},44:{n:"PtgRefN",f:s3},45:{n:"PtgAreaN",f:Y5},46:{n:"PtgMemAreaN",f:q3},47:{n:"PtgMemNoMemN",f:Z3},57:{n:"PtgNameX",f:w3},58:{n:"PtgRef3d",f:o3},59:{n:"PtgArea3d",f:W5},60:{n:"PtgRefErr3d",f:k3},61:{n:"PtgAreaErr3d",f:X5},255:{}},$3={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},X3={1:{n:"PtgElfLel",f:iw},2:{n:"PtgElfRw",f:B3},3:{n:"PtgElfCol",f:R3},6:{n:"PtgElfRwV",f:N3},7:{n:"PtgElfColV",f:F3},10:{n:"PtgElfRadical",f:L3},11:{n:"PtgElfRadicalS",f:O3},13:{n:"PtgElfColS",f:I3},15:{n:"PtgElfColSV",f:P3},16:{n:"PtgElfRadicalLel",f:z3},25:{n:"PtgList",f:U3},29:{n:"PtgSxName",f:V3},255:{}},Y3={0:{n:"PtgAttrNoop",f:W3},1:{n:"PtgAttrSemi",f:r3},2:{n:"PtgAttrIf",f:e3},4:{n:"PtgAttrChoose",f:J5},8:{n:"PtgAttrGoto",f:Q5},16:{n:"PtgAttrSum",f:h3},32:{n:"PtgAttrBaxcel",f:Wv},33:{n:"PtgAttrBaxcel",f:Wv},64:{n:"PtgAttrSpace",f:n3},65:{n:"PtgAttrSpaceSemi",f:a3},128:{n:"PtgAttrIfError",f:t3},255:{}};function Wg(r,u,l,f){if(f.biff<8)return qo(r,u);for(var p=r.l+u,b=[],_=0;_!==l.length;++_)switch(l[_][0]){case"PtgArray":l[_][1]=v3(r,0,f),b.push(l[_][1]);break;case"PtgMemArea":l[_][2]=y3(r,l[_][1],f),b.push(l[_][2]);break;case"PtgExp":f&&f.biff==12&&(l[_][1][1]=r.read_shift(4),b.push(l[_][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+l[_][0]}return u=p-r.l,u!==0&&b.push(qo(r,u)),b}function $g(r,u,l){for(var f=r.l+u,p,b,_=[];f!=r.l;)u=f-r.l,b=r[r.l],p=$v[b]||$v[$3[b]],(b===24||b===25)&&(p=(b===24?X3:Y3)[r[r.l+1]]),!p||!p.f?qo(r,u):_.push([p.n,p.f(r,u,l)]);return _}function K3(r){for(var u=[],l=0;l<r.length;++l){for(var f=r[l],p=[],b=0;b<f.length;++b){var _=f[b];_?_[0]===2?p.push('"'+_[1].replace(/"/g,'""')+'"'):p.push(_[1]):p.push("")}u.push(p.join(","))}return u.join(";")}var J3={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Q3(r,u){if(!r&&!(u&&u.biff<=5&&u.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(r)?"'"+r+"'":r}function sw(r,u,l){if(!r)return"SH33TJSERR0";if(l.biff>8&&(!r.XTI||!r.XTI[u]))return r.SheetNames[u];if(!r.XTI)return"SH33TJSERR6";var f=r.XTI[u];if(l.biff<8)return u>1e4&&(u-=65536),u<0&&(u=-u),u==0?"":r.XTI[u-1];if(!f)return"SH33TJSERR1";var p="";if(l.biff>8)switch(r[f[0]][0]){case 357:return p=f[1]==-1?"#REF":r.SheetNames[f[1]],f[1]==f[2]?p:p+":"+r.SheetNames[f[2]];case 358:return l.SID!=null?r.SheetNames[l.SID]:"SH33TJSSAME"+r[f[0]][0];default:return"SH33TJSSRC"+r[f[0]][0]}switch(r[f[0]][0][0]){case 1025:return p=f[1]==-1?"#REF":r.SheetNames[f[1]]||"SH33TJSERR3",f[1]==f[2]?p:p+":"+r.SheetNames[f[2]];case 14849:return r[f[0]].slice(1).map(function(b){return b.Name}).join(";;");default:return r[f[0]][0][3]?(p=f[1]==-1?"#REF":r[f[0]][0][3][f[1]]||"SH33TJSERR4",f[1]==f[2]?p:p+":"+r[f[0]][0][3][f[2]]):"SH33TJSERR2"}}function Xv(r,u,l){var f=sw(r,u,l);return f=="#REF"?f:Q3(f,l)}function Uo(r,u,l,f,p){var b=p&&p.biff||8,_={s:{c:0,r:0}},s=[],C,M,D,B=0,U=0,j,H="";if(!r[0]||!r[0][0])return"";for(var z=-1,N="",Z=0,Y=r[0].length;Z<Y;++Z){var W=r[0][Z];switch(W[0]){case"PtgUminus":s.push("-"+s.pop());break;case"PtgUplus":s.push("+"+s.pop());break;case"PtgPercent":s.push(s.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(C=s.pop(),M=s.pop(),z>=0){switch(r[0][z][1][0]){case 0:N=$i(" ",r[0][z][1][1]);break;case 1:N=$i("\r",r[0][z][1][1]);break;default:if(N="",p.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][z][1][0])}M=M+N,z=-1}s.push(M+J3[W[0]]+C);break;case"PtgIsect":C=s.pop(),M=s.pop(),s.push(M+" "+C);break;case"PtgUnion":C=s.pop(),M=s.pop(),s.push(M+","+C);break;case"PtgRange":C=s.pop(),M=s.pop(),s.push(M+":"+C);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":D=wg(W[1][1],_,p),s.push(Tg(D,b));break;case"PtgRefN":D=l?wg(W[1][1],l,p):W[1][1],s.push(Tg(D,b));break;case"PtgRef3d":B=W[1][1],D=wg(W[1][2],_,p),H=Xv(f,B,p),s.push(H+"!"+Tg(D,b));break;case"PtgFunc":case"PtgFuncVar":var de=W[1][0],ge=W[1][1];de||(de=0),de&=127;var ve=de==0?[]:s.slice(-de);s.length-=de,ge==="User"&&(ge=ve.shift()),s.push(ge+"("+ve.join(",")+")");break;case"PtgBool":s.push(W[1]?"TRUE":"FALSE");break;case"PtgInt":s.push(W[1]);break;case"PtgNum":s.push(String(W[1]));break;case"PtgStr":s.push('"'+W[1].replace(/"/g,'""')+'"');break;case"PtgErr":s.push(W[1]);break;case"PtgAreaN":j=Mv(W[1][1],l?{s:l}:_,p),s.push(gy(j,p));break;case"PtgArea":j=Mv(W[1][1],_,p),s.push(gy(j,p));break;case"PtgArea3d":B=W[1][1],j=W[1][2],H=Xv(f,B,p),s.push(H+"!"+gy(j,p));break;case"PtgAttrSum":s.push("SUM("+s.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":U=W[1][2];var ie=(f.names||[])[U-1]||(f[0]||[])[U],Me=ie?ie.Name:"SH33TJSNAME"+String(U);Me&&Me.slice(0,6)=="_xlfn."&&!p.xlfn&&(Me=Me.slice(6)),s.push(Me);break;case"PtgNameX":var we=W[1][1];U=W[1][2];var Ge;if(p.biff<=5)we<0&&(we=-we),f[we]&&(Ge=f[we][U]);else{var et="";if(((f[we]||[])[0]||[])[0]==14849||(((f[we]||[])[0]||[])[0]==1025?f[we][U]&&f[we][U].itab>0&&(et=f.SheetNames[f[we][U].itab-1]+"!"):et=f.SheetNames[U-1]+"!"),f[we]&&f[we][U])et+=f[we][U].Name;else if(f[0]&&f[0][U])et+=f[0][U].Name;else{var pe=(sw(f,we,p)||"").split(";;");pe[U-1]?et=pe[U-1]:et+="SH33TJSERRX"}s.push(et);break}Ge||(Ge={Name:"SH33TJSERRY"}),s.push(Ge.Name);break;case"PtgParen":var Je="(",le=")";if(z>=0){switch(N="",r[0][z][1][0]){case 2:Je=$i(" ",r[0][z][1][1])+Je;break;case 3:Je=$i("\r",r[0][z][1][1])+Je;break;case 4:le=$i(" ",r[0][z][1][1])+le;break;case 5:le=$i("\r",r[0][z][1][1])+le;break;default:if(p.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][z][1][0])}z=-1}s.push(Je+s.pop()+le);break;case"PtgRefErr":s.push("#REF!");break;case"PtgRefErr3d":s.push("#REF!");break;case"PtgExp":D={c:W[1][1],r:W[1][0]};var ut={c:l.c,r:l.r};if(f.sharedf[kn(D)]){var tt=f.sharedf[kn(D)];s.push(Uo(tt,_,ut,f,p))}else{var We=!1;for(C=0;C!=f.arrayf.length;++C)if(M=f.arrayf[C],!(D.c<M[0].s.c||D.c>M[0].e.c)&&!(D.r<M[0].s.r||D.r>M[0].e.r)){s.push(Uo(M[1],_,ut,f,p)),We=!0;break}We||s.push(W[1])}break;case"PtgArray":s.push("{"+K3(W[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":z=Z;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":s.push("");break;case"PtgAreaErr":s.push("#REF!");break;case"PtgAreaErr3d":s.push("#REF!");break;case"PtgList":s.push("Table"+W[1].idx+"[#"+W[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(W));default:throw new Error("Unrecognized Formula Token: "+String(W))}var $t=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(p.biff!=3&&z>=0&&$t.indexOf(r[0][Z][0])==-1){W=r[0][z];var Be=!0;switch(W[1][0]){case 4:Be=!1;case 0:N=$i(" ",W[1][1]);break;case 5:Be=!1;case 1:N=$i("\r",W[1][1]);break;default:if(N="",p.WTF)throw new Error("Unexpected PtgAttrSpaceType "+W[1][0])}s.push((Be?N:"")+s.pop()+(Be?"":N)),z=-1}}if(s.length>1&&p.WTF)throw new Error("bad formula stack");return s[0]}function eM(r,u,l){var f=r.l+u,p=l.biff==2?1:2,b,_=r.read_shift(p);if(_==65535)return[[],qo(r,u-2)];var s=$g(r,_,l);return u!==_+p&&(b=Wg(r,u-_-p,s,l)),r.l=f,[s,b]}function tM(r,u,l){var f=r.l+u,p=l.biff==2?1:2,b,_=r.read_shift(p);if(_==65535)return[[],qo(r,u-2)];var s=$g(r,_,l);return u!==_+p&&(b=Wg(r,u-_-p,s,l)),r.l=f,[s,b]}function rM(r,u,l,f){var p=r.l+u,b=$g(r,f,l),_;return p!==r.l&&(_=Wg(r,p-r.l,b,l)),[b,_]}function nM(r,u,l){var f=r.l+u,p,b=r.read_shift(2),_=$g(r,b,l);return b==65535?[[],qo(r,u-2)]:(u!==b+2&&(p=Wg(r,f-b-2,_,l)),[_,p])}function aM(r){var u;if(Ef(r,r.l+6)!==65535)return[Vo(r),"n"];switch(r[r.l]){case 0:return r.l+=8,["String","s"];case 1:return u=r[r.l+2]===1,r.l+=8,[u,"b"];case 2:return u=r[r.l+2],r.l+=8,[u,"e"];case 3:return r.l+=8,["","s"]}return[]}function yy(r,u,l){var f=r.l+u,p=qh(r);l.biff==2&&++r.l;var b=aM(r),_=r.read_shift(1);l.biff!=2&&(r.read_shift(1),l.biff>=5&&r.read_shift(4));var s=tM(r,f-r.l,l);return{cell:p,val:b[0],formula:s,shared:_>>3&1,tt:b[1]}}function Nx(r,u,l){var f=r.read_shift(4),p=$g(r,f,l),b=r.read_shift(4),_=b>0?Wg(r,b,p,l):null;return[p,_]}var iM=Nx,jx=Nx,sM=Nx,oM=Nx,lM={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ow={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},cM={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Yv(r){return r.slice(0,3)=="of:"&&(r=r.slice(3)),r.charCodeAt(0)==61&&(r=r.slice(1),r.charCodeAt(0)==61&&(r=r.slice(1))),r=r.replace(/COM\.MICROSOFT\./g,""),r=r.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(u,l){return l.replace(/\./g,"")}),r=r.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),r.replace(/[;~]/g,",").replace(/\|/g,";")}function vy(r){var u=r.split(":"),l=u[0].split(".")[0];return[l,u[0].split(".")[1]+(u.length>1?":"+(u[1].split(".")[1]||u[1].split(".")[0]):"")]}var kg={},W0={};function Cg(r,u){if(r){var l=[.7,.7,.75,.75,.3,.3];u=="xlml"&&(l=[1,1,1,1,.5,.5]),r.left==null&&(r.left=l[0]),r.right==null&&(r.right=l[1]),r.top==null&&(r.top=l[2]),r.bottom==null&&(r.bottom=l[3]),r.header==null&&(r.header=l[4]),r.footer==null&&(r.footer=l[5])}}function lw(r,u,l,f,p,b){try{f.cellNF&&(r.z=Pn[u])}catch(s){if(f.WTF)throw s}if(!(r.t==="z"&&!f.cellStyles)){if(r.t==="d"&&typeof r.v=="string"&&(r.v=Ys(r.v)),(!f||f.cellText!==!1)&&r.t!=="z")try{if(Pn[u]==null&&wp(uE[u]||"General",u),r.t==="e")r.w=r.w||Ip[r.v];else if(u===0)if(r.t==="n")(r.v|0)===r.v?r.w=r.v.toString(10):r.w=Ig(r.v);else if(r.t==="d"){var _=Tl(r.v);(_|0)===_?r.w=_.toString(10):r.w=Ig(_)}else{if(r.v===void 0)return"";r.w=Sp(r.v,W0)}else r.t==="d"?r.w=lu(u,Tl(r.v),W0):r.w=lu(u,r.v,W0)}catch(s){if(f.WTF)throw s}if(f.cellStyles&&l!=null)try{r.s=b.Fills[l],r.s.fgColor&&r.s.fgColor.theme&&!r.s.fgColor.rgb&&(r.s.fgColor.rgb=kx(p.themeElements.clrScheme[r.s.fgColor.theme].rgb,r.s.fgColor.tint||0),f.WTF&&(r.s.fgColor.raw_rgb=p.themeElements.clrScheme[r.s.fgColor.theme].rgb)),r.s.bgColor&&r.s.bgColor.theme&&(r.s.bgColor.rgb=kx(p.themeElements.clrScheme[r.s.bgColor.theme].rgb,r.s.bgColor.tint||0),f.WTF&&(r.s.bgColor.raw_rgb=p.themeElements.clrScheme[r.s.bgColor.theme].rgb))}catch(s){if(f.WTF&&b.Fills)throw s}}}function uM(r,u){var l=Xi(u);l.s.r<=l.e.r&&l.s.c<=l.e.c&&l.s.r>=0&&l.s.c>=0&&(r["!ref"]=oa(l))}var hM=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,fM=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,dM=/<(?:\w:)?hyperlink [^>]*>/mg,pM=/"(\w*:\w*)"/,mM=/<(?:\w:)?col\b[^>]*[\/]?>/g,gM=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,_M=/<(?:\w:)?pageMargins[^>]*\/>/g,cw=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,xM=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,yM=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function vM(r,u,l,f,p,b,_){if(!r)return r;f||(f={"!id":{}});var s=u.dense?[]:{},C={s:{r:2e6,c:2e6},e:{r:0,c:0}},M="",D="",B=r.match(fM);B?(M=r.slice(0,B.index),D=r.slice(B.index+B[0].length)):M=D=r;var U=M.match(cw);U?b1(U[0],s,p,l):(U=M.match(xM))&&bM(U[0],U[1]||"",s,p,l);var j=(M.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(j>0){var H=M.slice(j,j+50).match(pM);H&&uM(s,H[1])}var z=M.match(yM);z&&z[1]&&kM(z[1],p);var N=[];if(u.cellStyles){var Z=M.match(mM);Z&&SM(N,Z)}B&&CM(B[1],s,u,C,b,_);var Y=D.match(gM);Y&&(s["!autofilter"]=EM(Y[0]));var W=[],de=D.match(hM);if(de)for(j=0;j!=de.length;++j)W[j]=Xi(de[j].slice(de[j].indexOf('"')+1));var ge=D.match(dM);ge&&wM(s,ge,f);var ve=D.match(_M);if(ve&&(s["!margins"]=TM(vn(ve[0]))),!s["!ref"]&&C.e.c>=C.s.c&&C.e.r>=C.s.r&&(s["!ref"]=oa(C)),u.sheetRows>0&&s["!ref"]){var ie=Xi(s["!ref"]);u.sheetRows<=+ie.e.r&&(ie.e.r=u.sheetRows-1,ie.e.r>C.e.r&&(ie.e.r=C.e.r),ie.e.r<ie.s.r&&(ie.s.r=ie.e.r),ie.e.c>C.e.c&&(ie.e.c=C.e.c),ie.e.c<ie.s.c&&(ie.s.c=ie.e.c),s["!fullref"]=s["!ref"],s["!ref"]=oa(ie))}return N.length>0&&(s["!cols"]=N),W.length>0&&(s["!merges"]=W),s}function b1(r,u,l,f){var p=vn(r);l.Sheets[f]||(l.Sheets[f]={}),p.codeName&&(l.Sheets[f].CodeName=ma(si(p.codeName)))}function bM(r,u,l,f,p){b1(r.slice(0,r.indexOf(">")),l,f,p)}function wM(r,u,l){for(var f=Array.isArray(r),p=0;p!=u.length;++p){var b=vn(si(u[p]),!0);if(!b.ref)return;var _=((l||{})["!id"]||[])[b.id];_?(b.Target=_.Target,b.location&&(b.Target+="#"+ma(b.location))):(b.Target="#"+ma(b.location),_={Target:b.Target,TargetMode:"Internal"}),b.Rel=_,b.tooltip&&(b.Tooltip=b.tooltip,delete b.tooltip);for(var s=Xi(b.ref),C=s.s.r;C<=s.e.r;++C)for(var M=s.s.c;M<=s.e.c;++M){var D=kn({c:M,r:C});f?(r[C]||(r[C]=[]),r[C][M]||(r[C][M]={t:"z",v:void 0}),r[C][M].l=b):(r[D]||(r[D]={t:"z",v:void 0}),r[D].l=b)}}}function TM(r){var u={};return["left","right","top","bottom","header","footer"].forEach(function(l){r[l]&&(u[l]=parseFloat(r[l]))}),u}function SM(r,u){for(var l=!1,f=0;f!=u.length;++f){var p=vn(u[f],!0);p.hidden&&(p.hidden=bi(p.hidden));var b=parseInt(p.min,10)-1,_=parseInt(p.max,10)-1;for(p.outlineLevel&&(p.level=+p.outlineLevel||0),delete p.min,delete p.max,p.width=+p.width,!l&&p.width&&(l=!0,y1(p.width)),Y0(p);b<=_;)r[b++]=go(p)}}function EM(r){var u={ref:(r.match(/ref="([^"]*)"/)||[])[1]};return u}var AM=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function kM(r,u){u.Views||(u.Views=[{}]),(r.match(AM)||[]).forEach(function(l,f){var p=vn(l);u.Views[f]||(u.Views[f]={}),+p.zoomScale&&(u.Views[f].zoom=+p.zoomScale),bi(p.rightToLeft)&&(u.Views[f].RTL=!0)})}var CM=(function(){var r=/<(?:\w+:)?c[ \/>]/,u=/<\/(?:\w+:)?row>/,l=/r=["']([^"']*)["']/,f=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,p=/ref=["']([^"']*)["']/,b=Pg("v"),_=Pg("f");return function(C,M,D,B,U,j){for(var H=0,z="",N=[],Z=[],Y=0,W=0,de=0,ge="",ve,ie,Me=0,we=0,Ge,et,pe=0,Je=0,le=Array.isArray(j.CellXf),ut,tt=[],We=[],$t=Array.isArray(M),Be=[],Mt={},me=!1,re=!!D.sheetStubs,Ve=C.split(u),Pe=0,De=Ve.length;Pe!=De;++Pe){z=Ve[Pe].trim();var bt=z.length;if(bt!==0){var Vt=0;e:for(H=0;H<bt;++H)switch(z[H]){case">":if(z[H-1]!="/"){++H;break e}if(D&&D.cellStyles){if(ie=vn(z.slice(Vt,H),!0),Me=ie.r!=null?parseInt(ie.r,10):Me+1,we=-1,D.sheetRows&&D.sheetRows<Me)continue;Mt={},me=!1,ie.ht&&(me=!0,Mt.hpt=parseFloat(ie.ht),Mt.hpx=Og(Mt.hpt)),ie.hidden=="1"&&(me=!0,Mt.hidden=!0),ie.outlineLevel!=null&&(me=!0,Mt.level=+ie.outlineLevel),me&&(Be[Me-1]=Mt)}break;case"<":Vt=H;break}if(Vt>=H)break;if(ie=vn(z.slice(Vt,H),!0),Me=ie.r!=null?parseInt(ie.r,10):Me+1,we=-1,!(D.sheetRows&&D.sheetRows<Me)){B.s.r>Me-1&&(B.s.r=Me-1),B.e.r<Me-1&&(B.e.r=Me-1),D&&D.cellStyles&&(Mt={},me=!1,ie.ht&&(me=!0,Mt.hpt=parseFloat(ie.ht),Mt.hpx=Og(Mt.hpt)),ie.hidden=="1"&&(me=!0,Mt.hidden=!0),ie.outlineLevel!=null&&(me=!0,Mt.level=+ie.outlineLevel),me&&(Be[Me-1]=Mt)),N=z.slice(H).split(r);for(var Zt=0;Zt!=N.length&&N[Zt].trim().charAt(0)=="<";++Zt);for(N=N.slice(Zt),H=0;H!=N.length;++H)if(z=N[H].trim(),z.length!==0){if(Z=z.match(l),Y=H,W=0,de=0,z="<c "+(z.slice(0,1)=="<"?">":"")+z,Z!=null&&Z.length===2){for(Y=0,ge=Z[1],W=0;W!=ge.length&&!((de=ge.charCodeAt(W)-64)<1||de>26);++W)Y=26*Y+de;--Y,we=Y}else++we;for(W=0;W!=z.length&&z.charCodeAt(W)!==62;++W);if(++W,ie=vn(z.slice(0,W),!0),ie.r||(ie.r=kn({r:Me-1,c:we})),ge=z.slice(W),ve={t:""},(Z=ge.match(b))!=null&&Z[1]!==""&&(ve.v=ma(Z[1])),D.cellFormula){if((Z=ge.match(_))!=null&&Z[1]!==""){if(ve.f=ma(si(Z[1])).replace(/\r\n/g,`
`),D.xlfn||(ve.f=Zv(ve.f)),Z[0].indexOf('t="array"')>-1)ve.F=(ge.match(p)||[])[1],ve.F.indexOf(":")>-1&&tt.push([Xi(ve.F),ve.F]);else if(Z[0].indexOf('t="shared"')>-1){et=vn(Z[0]);var jt=ma(si(Z[1]));D.xlfn||(jt=Zv(jt)),We[parseInt(et.si,10)]=[et,jt,ie.r]}}else(Z=ge.match(/<f[^>]*\/>/))&&(et=vn(Z[0]),We[et.si]&&(ve.f=N5(We[et.si][1],We[et.si][2],ie.r)));var Yt=bl(ie.r);for(W=0;W<tt.length;++W)Yt.r>=tt[W][0].s.r&&Yt.r<=tt[W][0].e.r&&Yt.c>=tt[W][0].s.c&&Yt.c<=tt[W][0].e.c&&(ve.F=tt[W][1])}if(ie.t==null&&ve.v===void 0)if(ve.f||ve.F)ve.v=0,ve.t="n";else if(re)ve.t="z";else continue;else ve.t=ie.t||"n";switch(B.s.c>we&&(B.s.c=we),B.e.c<we&&(B.e.c=we),ve.t){case"n":if(ve.v==""||ve.v==null){if(!re)continue;ve.t="z"}else ve.v=parseFloat(ve.v);break;case"s":if(typeof ve.v>"u"){if(!re)continue;ve.t="z"}else Ge=kg[parseInt(ve.v,10)],ve.v=Ge.t,ve.r=Ge.r,D.cellHTML&&(ve.h=Ge.h);break;case"str":ve.t="s",ve.v=ve.v!=null?si(ve.v):"",D.cellHTML&&(ve.h=l1(ve.v));break;case"inlineStr":Z=ge.match(f),ve.t="s",Z!=null&&(Ge=x1(Z[1]))?(ve.v=Ge.t,D.cellHTML&&(ve.h=Ge.h)):ve.v="";break;case"b":ve.v=bi(ve.v);break;case"d":D.cellDates?ve.v=Ys(ve.v,1):(ve.v=Tl(Ys(ve.v,1)),ve.t="n");break;case"e":(!D||D.cellText!==!1)&&(ve.w=ve.v),ve.v=D2[ve.v];break}if(pe=Je=0,ut=null,le&&ie.s!==void 0&&(ut=j.CellXf[ie.s],ut!=null&&(ut.numFmtId!=null&&(pe=ut.numFmtId),D.cellStyles&&ut.fillId!=null&&(Je=ut.fillId))),lw(ve,pe,Je,D,U,j),D.cellDates&&le&&ve.t=="n"&&tm(Pn[pe])&&(ve.t="d",ve.v=Ox(ve.v)),ie.cm&&D.xlmeta){var jr=(D.xlmeta.Cell||[])[+ie.cm-1];jr&&jr.type=="XLDAPR"&&(ve.D=!0)}if($t){var Qe=bl(ie.r);M[Qe.r]||(M[Qe.r]=[]),M[Qe.r][Qe.c]=ve}else M[ie.r]=ve}}}}Be.length>0&&(M["!rows"]=Be)}})();function MM(r,u){var l={},f=r.l+u;l.r=r.read_shift(4),r.l+=4;var p=r.read_shift(2);r.l+=1;var b=r.read_shift(1);return r.l=f,b&7&&(l.level=b&7),b&16&&(l.hidden=!0),b&32&&(l.hpt=p/20),l}var DM=Rp;function RM(){}function IM(r,u){var l={},f=r[r.l];return++r.l,l.above=!(f&64),l.left=!(f&128),r.l+=18,l.name=eA(r),l}function PM(r){var u=uu(r);return[u]}function FM(r){var u=Dp(r);return[u]}function LM(r){var u=uu(r),l=r.read_shift(1);return[u,l,"b"]}function zM(r){var u=Dp(r),l=r.read_shift(1);return[u,l,"b"]}function OM(r){var u=uu(r),l=r.read_shift(1);return[u,l,"e"]}function BM(r){var u=Dp(r),l=r.read_shift(1);return[u,l,"e"]}function NM(r){var u=uu(r),l=r.read_shift(4);return[u,l,"s"]}function jM(r){var u=Dp(r),l=r.read_shift(4);return[u,l,"s"]}function UM(r){var u=uu(r),l=Vo(r);return[u,l,"n"]}function uw(r){var u=Dp(r),l=Vo(r);return[u,l,"n"]}function VM(r){var u=uu(r),l=m1(r);return[u,l,"n"]}function GM(r){var u=Dp(r),l=m1(r);return[u,l,"n"]}function HM(r){var u=uu(r),l=d1(r);return[u,l,"is"]}function qM(r){var u=uu(r),l=Ho(r);return[u,l,"str"]}function ZM(r){var u=Dp(r),l=Ho(r);return[u,l,"str"]}function WM(r,u,l){var f=r.l+u,p=uu(r);p.r=l["!row"];var b=r.read_shift(1),_=[p,b,"b"];if(l.cellFormula){r.l+=2;var s=jx(r,f-r.l,l);_[3]=Uo(s,null,p,l.supbooks,l)}else r.l=f;return _}function $M(r,u,l){var f=r.l+u,p=uu(r);p.r=l["!row"];var b=r.read_shift(1),_=[p,b,"e"];if(l.cellFormula){r.l+=2;var s=jx(r,f-r.l,l);_[3]=Uo(s,null,p,l.supbooks,l)}else r.l=f;return _}function XM(r,u,l){var f=r.l+u,p=uu(r);p.r=l["!row"];var b=Vo(r),_=[p,b,"n"];if(l.cellFormula){r.l+=2;var s=jx(r,f-r.l,l);_[3]=Uo(s,null,p,l.supbooks,l)}else r.l=f;return _}function YM(r,u,l){var f=r.l+u,p=uu(r);p.r=l["!row"];var b=Ho(r),_=[p,b,"str"];if(l.cellFormula){r.l+=2;var s=jx(r,f-r.l,l);_[3]=Uo(s,null,p,l.supbooks,l)}else r.l=f;return _}var KM=Rp;function JM(r,u){var l=r.l+u,f=Rp(r),p=p1(r),b=Ho(r),_=Ho(r),s=Ho(r);r.l=l;var C={rfx:f,relId:p,loc:b,display:s};return _&&(C.Tooltip=_),C}function QM(){}function e4(r,u,l){var f=r.l+u,p=k2(r),b=r.read_shift(1),_=[p];if(_[2]=b,l.cellFormula){var s=iM(r,f-r.l,l);_[1]=s}else r.l=f;return _}function t4(r,u,l){var f=r.l+u,p=Rp(r),b=[p];if(l.cellFormula){var _=oM(r,f-r.l,l);b[1]=_,r.l=f}else r.l=f;return b}var r4=["left","right","top","bottom","header","footer"];function n4(r){var u={};return r4.forEach(function(l){u[l]=Vo(r)}),u}function a4(r){var u=r.read_shift(2);return r.l+=28,{RTL:u&32}}function i4(){}function s4(){}function o4(r,u,l,f,p,b,_){if(!r)return r;var s=u||{};f||(f={"!id":{}});var C=s.dense?[]:{},M,D={s:{r:2e6,c:2e6},e:{r:0,c:0}},B=!1,U=!1,j,H,z,N,Z,Y,W,de,ge,ve=[];s.biff=12,s["!row"]=0;var ie=0,Me=!1,we=[],Ge={},et=s.supbooks||p.supbooks||[[]];if(et.sharedf=Ge,et.arrayf=we,et.SheetNames=p.SheetNames||p.Sheets.map(function($t){return $t.name}),!s.supbooks&&(s.supbooks=et,p.Names))for(var pe=0;pe<p.Names.length;++pe)et[0][pe+1]=p.Names[pe];var Je=[],le=[],ut=!1;Dx[16]={n:"BrtShortReal",f:uw};var tt;if(If(r,function(Be,Mt,me){if(!U)switch(me){case 148:M=Be;break;case 0:j=Be,s.sheetRows&&s.sheetRows<=j.r&&(U=!0),de=_o(N=j.r),s["!row"]=j.r,(Be.hidden||Be.hpt||Be.level!=null)&&(Be.hpt&&(Be.hpx=Og(Be.hpt)),le[Be.r]=Be);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(H={t:Be[2]},Be[2]){case"n":H.v=Be[1];break;case"s":W=kg[Be[1]],H.v=W.t,H.r=W.r;break;case"b":H.v=!!Be[1];break;case"e":H.v=Be[1],s.cellText!==!1&&(H.w=Ip[H.v]);break;case"str":H.t="s",H.v=Be[1];break;case"is":H.t="s",H.v=Be[1].t;break}if((z=_.CellXf[Be[0].iStyleRef])&&lw(H,z.numFmtId,null,s,b,_),Z=Be[0].c==-1?Z+1:Be[0].c,s.dense?(C[N]||(C[N]=[]),C[N][Z]=H):C[ks(Z)+de]=H,s.cellFormula){for(Me=!1,ie=0;ie<we.length;++ie){var re=we[ie];j.r>=re[0].s.r&&j.r<=re[0].e.r&&Z>=re[0].s.c&&Z<=re[0].e.c&&(H.F=oa(re[0]),Me=!0)}!Me&&Be.length>3&&(H.f=Be[3])}if(D.s.r>j.r&&(D.s.r=j.r),D.s.c>Z&&(D.s.c=Z),D.e.r<j.r&&(D.e.r=j.r),D.e.c<Z&&(D.e.c=Z),s.cellDates&&z&&H.t=="n"&&tm(Pn[z.numFmtId])){var Ve=bp(H.v);Ve&&(H.t="d",H.v=new Date(Ve.y,Ve.m-1,Ve.d,Ve.H,Ve.M,Ve.S,Ve.u))}tt&&(tt.type=="XLDAPR"&&(H.D=!0),tt=void 0);break;case 1:case 12:if(!s.sheetStubs||B)break;H={t:"z",v:void 0},Z=Be[0].c==-1?Z+1:Be[0].c,s.dense?(C[N]||(C[N]=[]),C[N][Z]=H):C[ks(Z)+de]=H,D.s.r>j.r&&(D.s.r=j.r),D.s.c>Z&&(D.s.c=Z),D.e.r<j.r&&(D.e.r=j.r),D.e.c<Z&&(D.e.c=Z),tt&&(tt.type=="XLDAPR"&&(H.D=!0),tt=void 0);break;case 176:ve.push(Be);break;case 49:tt=((s.xlmeta||{}).Cell||[])[Be-1];break;case 494:var Pe=f["!id"][Be.relId];for(Pe?(Be.Target=Pe.Target,Be.loc&&(Be.Target+="#"+Be.loc),Be.Rel=Pe):Be.relId==""&&(Be.Target="#"+Be.loc),N=Be.rfx.s.r;N<=Be.rfx.e.r;++N)for(Z=Be.rfx.s.c;Z<=Be.rfx.e.c;++Z)s.dense?(C[N]||(C[N]=[]),C[N][Z]||(C[N][Z]={t:"z",v:void 0}),C[N][Z].l=Be):(Y=kn({c:Z,r:N}),C[Y]||(C[Y]={t:"z",v:void 0}),C[Y].l=Be);break;case 426:if(!s.cellFormula)break;we.push(Be),ge=s.dense?C[N][Z]:C[ks(Z)+de],ge.f=Uo(Be[1],D,{r:j.r,c:Z},et,s),ge.F=oa(Be[0]);break;case 427:if(!s.cellFormula)break;Ge[kn(Be[0].s)]=Be[1],ge=s.dense?C[N][Z]:C[ks(Z)+de],ge.f=Uo(Be[1],D,{r:j.r,c:Z},et,s);break;case 60:if(!s.cellStyles)break;for(;Be.e>=Be.s;)Je[Be.e--]={width:Be.w/256,hidden:!!(Be.flags&1),level:Be.level},ut||(ut=!0,y1(Be.w/256)),Y0(Je[Be.e+1]);break;case 161:C["!autofilter"]={ref:oa(Be)};break;case 476:C["!margins"]=Be;break;case 147:p.Sheets[l]||(p.Sheets[l]={}),Be.name&&(p.Sheets[l].CodeName=Be.name),(Be.above||Be.left)&&(C["!outline"]={above:Be.above,left:Be.left});break;case 137:p.Views||(p.Views=[{}]),p.Views[0]||(p.Views[0]={}),Be.RTL&&(p.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:B=!0;break;case 36:B=!1;break;case 37:B=!0;break;case 38:B=!1;break;default:if(!Mt.T){if(!B||s.WTF)throw new Error("Unexpected record 0x"+me.toString(16))}}},s),delete s.supbooks,delete s["!row"],!C["!ref"]&&(D.s.r<2e6||M&&(M.e.r>0||M.e.c>0||M.s.r>0||M.s.c>0))&&(C["!ref"]=oa(M||D)),s.sheetRows&&C["!ref"]){var We=Xi(C["!ref"]);s.sheetRows<=+We.e.r&&(We.e.r=s.sheetRows-1,We.e.r>D.e.r&&(We.e.r=D.e.r),We.e.r<We.s.r&&(We.s.r=We.e.r),We.e.c>D.e.c&&(We.e.c=D.e.c),We.e.c<We.s.c&&(We.s.c=We.e.c),C["!fullref"]=C["!ref"],C["!ref"]=oa(We))}return ve.length>0&&(C["!merges"]=ve),Je.length>0&&(C["!cols"]=Je),le.length>0&&(C["!rows"]=le),C}function l4(r){var u=[],l=r.match(/^<c:numCache>/),f;(r.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(b){var _=b.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);_&&(u[+_[1]]=l?+_[2]:_[2])});var p=ma((r.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(r.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(b){f=b.replace(/<.*?>/g,"")}),[u,p,f]}function c4(r,u,l,f,p,b){var _=b||{"!type":"chart"};if(!r)return b;var s=0,C=0,M="A",D={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(r.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(B){var U=l4(B);D.s.r=D.s.c=0,D.e.c=s,M=ks(s),U[0].forEach(function(j,H){_[M+_o(H)]={t:"n",v:j,z:U[1]},C=H}),D.e.r<C&&(D.e.r=C),++s}),s>0&&(_["!ref"]=oa(D)),_}function u4(r,u,l,f,p){if(!r)return r;f||(f={"!id":{}});var b={"!type":"chart","!drawel":null,"!rel":""},_,s=r.match(cw);return s&&b1(s[0],b,p,l),(_=r.match(/drawing r:id="(.*?)"/))&&(b["!rel"]=_[1]),f["!id"][b["!rel"]]&&(b["!drawel"]=f["!id"][b["!rel"]]),b}function h4(r,u){r.l+=10;var l=Ho(r);return{name:l}}function f4(r,u,l,f,p){if(!r)return r;f||(f={"!id":{}});var b={"!type":"chart","!drawel":null,"!rel":""},_=!1;return If(r,function(C,M,D){switch(D){case 550:b["!rel"]=C;break;case 651:p.Sheets[l]||(p.Sheets[l]={}),C.name&&(p.Sheets[l].CodeName=C.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:_=!0;break;case 36:_=!1;break;case 37:break;case 38:break;default:if(!(M.T>0)){if(!(M.T<0)){if(!_||u.WTF)throw new Error("Unexpected record 0x"+D.toString(16))}}}},u),f["!id"][b["!rel"]]&&(b["!drawel"]=f["!id"][b["!rel"]]),b}var hw=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],d4=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],p4=[],m4=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Kv(r,u){for(var l=0;l!=r.length;++l)for(var f=r[l],p=0;p!=u.length;++p){var b=u[p];if(f[b[0]]==null)f[b[0]]=b[1];else switch(b[2]){case"bool":typeof f[b[0]]=="string"&&(f[b[0]]=bi(f[b[0]]));break;case"int":typeof f[b[0]]=="string"&&(f[b[0]]=parseInt(f[b[0]],10));break}}}function Jv(r,u){for(var l=0;l!=u.length;++l){var f=u[l];if(r[f[0]]==null)r[f[0]]=f[1];else switch(f[2]){case"bool":typeof r[f[0]]=="string"&&(r[f[0]]=bi(r[f[0]]));break;case"int":typeof r[f[0]]=="string"&&(r[f[0]]=parseInt(r[f[0]],10));break}}}function fw(r){Jv(r.WBProps,hw),Jv(r.CalcPr,m4),Kv(r.WBView,d4),Kv(r.Sheets,p4),W0.date1904=bi(r.WBProps.date1904)}var g4="][*?/\\".split("");function _4(r,u){if(r.length>31)throw new Error("Sheet names cannot exceed 31 chars");var l=!0;return g4.forEach(function(f){if(r.indexOf(f)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),l}var x4=/<\w+:workbook/;function y4(r,u){if(!r)throw new Error("Could not find file");var l={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},f=!1,p="xmlns",b={},_=0;if(r.replace(Zo,function(C,M){var D=vn(C);switch(Hh(D[0])){case"<?xml":break;case"<workbook":C.match(x4)&&(p="xmlns"+C.match(/<(\w+):/)[1]),l.xmlns=D[p];break;case"</workbook>":break;case"<fileVersion":delete D[0],l.AppVersion=D;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":hw.forEach(function(B){if(D[B[0]]!=null)switch(B[2]){case"bool":l.WBProps[B[0]]=bi(D[B[0]]);break;case"int":l.WBProps[B[0]]=parseInt(D[B[0]],10);break;default:l.WBProps[B[0]]=D[B[0]]}}),D.codeName&&(l.WBProps.CodeName=si(D.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete D[0],l.WBView.push(D);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(D.state){case"hidden":D.Hidden=1;break;case"veryHidden":D.Hidden=2;break;default:D.Hidden=0}delete D.state,D.name=ma(si(D.name)),delete D[0],l.Sheets.push(D);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":f=!0;break;case"</definedNames>":f=!1;break;case"<definedName":b={},b.Name=si(D.name),D.comment&&(b.Comment=D.comment),D.localSheetId&&(b.Sheet=+D.localSheetId),bi(D.hidden||"0")&&(b.Hidden=!0),_=M+C.length;break;case"</definedName>":b.Ref=ma(si(r.slice(_,M))),l.Names.push(b);break;case"<definedName/>":break;case"<calcPr":delete D[0],l.CalcPr=D;break;case"<calcPr/>":delete D[0],l.CalcPr=D;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":f=!0;break;case"</ext>":f=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":f=!0;break;case"</AlternateContent>":f=!1;break;case"<revisionPtr":break;default:if(!f&&u.WTF)throw new Error("unrecognized "+D[0]+" in workbook")}return C}),OE.indexOf(l.xmlns)===-1)throw new Error("Unknown Namespace: "+l.xmlns);return fw(l),l}function v4(r,u){var l={};return l.Hidden=r.read_shift(4),l.iTabID=r.read_shift(4),l.strRelID=Ly(r),l.name=Ho(r),l}function b4(r,u){var l={},f=r.read_shift(4);l.defaultThemeVersion=r.read_shift(4);var p=u>8?Ho(r):"";return p.length>0&&(l.CodeName=p),l.autoCompressPictures=!!(f&65536),l.backupFile=!!(f&64),l.checkCompatibility=!!(f&4096),l.date1904=!!(f&1),l.filterPrivacy=!!(f&8),l.hidePivotFieldList=!!(f&1024),l.promptedSolutions=!!(f&16),l.publishItems=!!(f&2048),l.refreshAllConnections=!!(f&262144),l.saveExternalLinkValues=!!(f&128),l.showBorderUnselectedTables=!!(f&4),l.showInkAnnotation=!!(f&32),l.showObjects=["all","placeholders","none"][f>>13&3],l.showPivotChartFilter=!!(f&32768),l.updateLinks=["userSet","never","always"][f>>8&3],l}function w4(r,u){var l={};return r.read_shift(4),l.ArchID=r.read_shift(4),r.l+=u-8,l}function T4(r,u,l){var f=r.l+u;r.l+=4,r.l+=1;var p=r.read_shift(4),b=tA(r),_=sM(r,0,l),s=p1(r);r.l=f;var C={Name:b,Ptg:_};return p<268435455&&(C.Sheet=p),s&&(C.Comment=s),C}function S4(r,u){var l={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},f=[],p=!1;u||(u={}),u.biff=12;var b=[],_=[[]];return _.SheetNames=[],_.XTI=[],Dx[16]={n:"BrtFRTArchID$",f:w4},If(r,function(C,M,D){switch(D){case 156:_.SheetNames.push(C.name),l.Sheets.push(C);break;case 153:l.WBProps=C;break;case 39:C.Sheet!=null&&(u.SID=C.Sheet),C.Ref=Uo(C.Ptg,null,null,_,u),delete u.SID,delete C.Ptg,b.push(C);break;case 1036:break;case 357:case 358:case 355:case 667:_[0].length?_.push([D,C]):_[0]=[D,C],_[_.length-1].XTI=[];break;case 362:_.length===0&&(_[0]=[],_[0].XTI=[]),_[_.length-1].XTI=_[_.length-1].XTI.concat(C),_.XTI=_.XTI.concat(C);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:f.push(D),p=!0;break;case 36:f.pop(),p=!1;break;case 37:f.push(D),p=!0;break;case 38:f.pop(),p=!1;break;case 16:break;default:if(!M.T){if(!p||u.WTF&&f[f.length-1]!=37&&f[f.length-1]!=35)throw new Error("Unexpected record 0x"+D.toString(16))}}},u),fw(l),l.Names=b,l.supbooks=_,l}function E4(r,u,l){return u.slice(-4)===".bin"?S4(r,l):y4(r,l)}function A4(r,u,l,f,p,b,_,s){return u.slice(-4)===".bin"?o4(r,f,l,p,b,_,s):vM(r,f,l,p,b,_,s)}function k4(r,u,l,f,p,b,_,s){return u.slice(-4)===".bin"?f4(r,f,l,p,b):u4(r,f,l,p,b)}function C4(r,u,l,f,p,b,_,s){return u.slice(-4)===".bin"?z5():O5()}function M4(r,u,l,f,p,b,_,s){return u.slice(-4)===".bin"?F5():L5()}function D4(r,u,l,f){return u.slice(-4)===".bin"?KC(r,l,f):qC(r,l,f)}function R4(r,u,l){return J2(r,l)}function I4(r,u,l){return u.slice(-4)===".bin"?dC(r,l):hC(r,l)}function P4(r,u,l){return u.slice(-4)===".bin"?R5(r,l):A5(r,l)}function F4(r,u,l){return u.slice(-4)===".bin"?T5(r):b5(r)}function L4(r,u,l,f){return l.slice(-4)===".bin"?S5(r,u,l,f):void 0}function z4(r,u,l){return u.slice(-4)===".bin"?y5(r,u,l):v5(r,u,l)}var dw=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,pw=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ju(r,u){var l=r.split(/\s+/),f=[];if(f[0]=l[0],l.length===1)return f;var p=r.match(dw),b,_,s,C;if(p)for(C=0;C!=p.length;++C)b=p[C].match(pw),(_=b[1].indexOf(":"))===-1?f[b[1]]=b[2].slice(1,b[2].length-1):(b[1].slice(0,6)==="xmlns:"?s="xmlns"+b[1].slice(6):s=b[1].slice(_+1),f[s]=b[2].slice(1,b[2].length-1));return f}function O4(r){var u=r.split(/\s+/),l={};if(u.length===1)return l;var f=r.match(dw),p,b,_,s;if(f)for(s=0;s!=f.length;++s)p=f[s].match(pw),(b=p[1].indexOf(":"))===-1?l[p[1]]=p[2].slice(1,p[2].length-1):(p[1].slice(0,6)==="xmlns:"?_="xmlns"+p[1].slice(6):_=p[1].slice(b+1),l[_]=p[2].slice(1,p[2].length-1));return l}var Mg;function B4(r,u){var l=Mg[r]||ma(r);return l==="General"?Sp(u):lu(l,u)}function N4(r,u,l,f){var p=f;switch((l[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":p=bi(f);break;case"i2":case"int":p=parseInt(f,10);break;case"r4":case"float":p=parseFloat(f);break;case"date":case"dateTime.tz":p=Ys(f);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+l[0])}r[ma(u)]=p}function j4(r,u,l){if(r.t!=="z"){if(!l||l.cellText!==!1)try{r.t==="e"?r.w=r.w||Ip[r.v]:u==="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=Ig(r.v):r.w=Sp(r.v):r.w=B4(u||"General",r.v)}catch(b){if(l.WTF)throw b}try{var f=Mg[u]||u||"General";if(l.cellNF&&(r.z=f),l.cellDates&&r.t=="n"&&tm(f)){var p=bp(r.v);p&&(r.t="d",r.v=new Date(p.y,p.m-1,p.d,p.H,p.M,p.S,p.u))}}catch(b){if(l.WTF)throw b}}}function U4(r,u,l){if(l.cellStyles&&u.Interior){var f=u.Interior;f.Pattern&&(f.patternType=NC[f.Pattern]||f.Pattern)}r[u.ID]=u}function V4(r,u,l,f,p,b,_,s,C,M){var D="General",B=f.StyleID,U={};M=M||{};var j=[],H=0;for(B===void 0&&s&&(B=s.StyleID),B===void 0&&_&&(B=_.StyleID);b[B]!==void 0&&(b[B].nf&&(D=b[B].nf),b[B].Interior&&j.push(b[B].Interior),!!b[B].Parent);)B=b[B].Parent;switch(l.Type){case"Boolean":f.t="b",f.v=bi(r);break;case"String":f.t="s",f.r=vv(ma(r)),f.v=r.indexOf("<")>-1?ma(u||r).replace(/<.*?>/g,""):f.r;break;case"DateTime":r.slice(-1)!="Z"&&(r+="Z"),f.v=(Ys(r)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),f.v!==f.v?f.v=ma(r):f.v<60&&(f.v=f.v-1),(!D||D=="General")&&(D="yyyy-mm-dd");case"Number":f.v===void 0&&(f.v=+r),f.t||(f.t="n");break;case"Error":f.t="e",f.v=D2[r],M.cellText!==!1&&(f.w=r);break;default:r==""&&u==""?f.t="z":(f.t="s",f.v=vv(u||r));break}if(j4(f,D,M),M.cellFormula!==!1)if(f.Formula){var z=ma(f.Formula);z.charCodeAt(0)==61&&(z=z.slice(1)),f.f=Z0(z,p),delete f.Formula,f.ArrayRange=="RC"?f.F=Z0("RC:RC",p):f.ArrayRange&&(f.F=Z0(f.ArrayRange,p),C.push([Xi(f.F),f.F]))}else for(H=0;H<C.length;++H)p.r>=C[H][0].s.r&&p.r<=C[H][0].e.r&&p.c>=C[H][0].s.c&&p.c<=C[H][0].e.c&&(f.F=C[H][1]);M.cellStyles&&(j.forEach(function(N){!U.patternType&&N.patternType&&(U.patternType=N.patternType)}),f.s=U),f.StyleID!==void 0&&(f.ixfe=f.StyleID)}function G4(r){r.t=r.v||"",r.t=r.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.v=r.w=r.ixfe=void 0}function by(r,u){var l=u||{};r2();var f=pg(c1(r));(l.type=="binary"||l.type=="array"||l.type=="base64")&&(f=si(f));var p=f.slice(0,1024).toLowerCase(),b=!1;if(p=p.replace(/".*?"/g,""),(p.indexOf(">")&1023)>Math.min(p.indexOf(",")&1023,p.indexOf(";")&1023)){var _=go(l);return _.type="string",Lg.to_workbook(f,_)}if(p.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ne){p.indexOf("<"+Ne)>=0&&(b=!0)}),b)return J4(f,l);Mg={"General Number":"General","General Date":Pn[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Pn[15],"Short Date":Pn[14],"Long Time":Pn[19],"Medium Time":Pn[18],"Short Time":Pn[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Pn[2],Standard:Pn[4],Percent:Pn[10],Scientific:Pn[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var s,C=[],M,D={},B=[],U=l.dense?[]:{},j="",H={},z={},N=Ju('<Data ss:Type="String">'),Z=0,Y=0,W=0,de={s:{r:2e6,c:2e6},e:{r:0,c:0}},ge={},ve={},ie="",Me=0,we=[],Ge={},et={},pe=0,Je=[],le=[],ut={},tt=[],We,$t=!1,Be=[],Mt=[],me={},re=0,Ve=0,Pe={Sheets:[],WBProps:{date1904:!1}},De={};Fg.lastIndex=0,f=f.replace(/<!--([\s\S]*?)-->/mg,"");for(var bt="";s=Fg.exec(f);)switch(s[3]=(bt=s[3]).toLowerCase()){case"data":if(bt=="data"){if(s[1]==="/"){if((M=C.pop())[0]!==s[3])throw new Error("Bad state: "+M.join("|"))}else s[0].charAt(s[0].length-2)!=="/"&&C.push([s[3],!0]);break}if(C[C.length-1][1])break;s[1]==="/"?V4(f.slice(Z,s.index),ie,N,C[C.length-1][0]=="comment"?ut:H,{c:Y,r:W},ge,tt[Y],z,Be,l):(ie="",N=Ju(s[0]),Z=s.index+s[0].length);break;case"cell":if(s[1]==="/")if(le.length>0&&(H.c=le),(!l.sheetRows||l.sheetRows>W)&&H.v!==void 0&&(l.dense?(U[W]||(U[W]=[]),U[W][Y]=H):U[ks(Y)+_o(W)]=H),H.HRef&&(H.l={Target:ma(H.HRef)},H.HRefScreenTip&&(H.l.Tooltip=H.HRefScreenTip),delete H.HRef,delete H.HRefScreenTip),(H.MergeAcross||H.MergeDown)&&(re=Y+(parseInt(H.MergeAcross,10)|0),Ve=W+(parseInt(H.MergeDown,10)|0),we.push({s:{c:Y,r:W},e:{c:re,r:Ve}})),!l.sheetStubs)H.MergeAcross?Y=re+1:++Y;else if(H.MergeAcross||H.MergeDown){for(var Vt=Y;Vt<=re;++Vt)for(var Zt=W;Zt<=Ve;++Zt)(Vt>Y||Zt>W)&&(l.dense?(U[Zt]||(U[Zt]=[]),U[Zt][Vt]={t:"z"}):U[ks(Vt)+_o(Zt)]={t:"z"});Y=re+1}else++Y;else H=O4(s[0]),H.Index&&(Y=+H.Index-1),Y<de.s.c&&(de.s.c=Y),Y>de.e.c&&(de.e.c=Y),s[0].slice(-2)==="/>"&&++Y,le=[];break;case"row":s[1]==="/"||s[0].slice(-2)==="/>"?(W<de.s.r&&(de.s.r=W),W>de.e.r&&(de.e.r=W),s[0].slice(-2)==="/>"&&(z=Ju(s[0]),z.Index&&(W=+z.Index-1)),Y=0,++W):(z=Ju(s[0]),z.Index&&(W=+z.Index-1),me={},(z.AutoFitHeight=="0"||z.Height)&&(me.hpx=parseInt(z.Height,10),me.hpt=K2(me.hpx),Mt[W]=me),z.Hidden=="1"&&(me.hidden=!0,Mt[W]=me));break;case"worksheet":if(s[1]==="/"){if((M=C.pop())[0]!==s[3])throw new Error("Bad state: "+M.join("|"));B.push(j),de.s.r<=de.e.r&&de.s.c<=de.e.c&&(U["!ref"]=oa(de),l.sheetRows&&l.sheetRows<=de.e.r&&(U["!fullref"]=U["!ref"],de.e.r=l.sheetRows-1,U["!ref"]=oa(de))),we.length&&(U["!merges"]=we),tt.length>0&&(U["!cols"]=tt),Mt.length>0&&(U["!rows"]=Mt),D[j]=U}else de={s:{r:2e6,c:2e6},e:{r:0,c:0}},W=Y=0,C.push([s[3],!1]),M=Ju(s[0]),j=ma(M.Name),U=l.dense?[]:{},we=[],Be=[],Mt=[],De={name:j,Hidden:0},Pe.Sheets.push(De);break;case"table":if(s[1]==="/"){if((M=C.pop())[0]!==s[3])throw new Error("Bad state: "+M.join("|"))}else{if(s[0].slice(-2)=="/>")break;C.push([s[3],!1]),tt=[],$t=!1}break;case"style":s[1]==="/"?U4(ge,ve,l):ve=Ju(s[0]);break;case"numberformat":ve.nf=ma(Ju(s[0]).Format||"General"),Mg[ve.nf]&&(ve.nf=Mg[ve.nf]);for(var jt=0;jt!=392&&Pn[jt]!=ve.nf;++jt);if(jt==392){for(jt=57;jt!=392;++jt)if(Pn[jt]==null){wp(ve.nf,jt);break}}break;case"column":if(C[C.length-1][0]!=="table")break;if(We=Ju(s[0]),We.Hidden&&(We.hidden=!0,delete We.Hidden),We.Width&&(We.wpx=parseInt(We.Width,10)),!$t&&We.wpx>10){$t=!0,vl=X2;for(var Yt=0;Yt<tt.length;++Yt)tt[Yt]&&Y0(tt[Yt])}$t&&Y0(We),tt[We.Index-1||tt.length]=We;for(var jr=0;jr<+We.Span;++jr)tt[tt.length]=go(We);break;case"namedrange":if(s[1]==="/")break;Pe.Names||(Pe.Names=[]);var Qe=vn(s[0]),_n={Name:Qe.Name,Ref:Z0(Qe.RefersTo.slice(1),{r:0,c:0})};Pe.Sheets.length>0&&(_n.Sheet=Pe.Sheets.length-1),Pe.Names.push(_n);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(s[0].slice(-2)==="/>")break;s[1]==="/"?ie+=f.slice(Me,s.index):Me=s.index+s[0].length;break;case"interior":if(!l.cellStyles)break;ve.Interior=Ju(s[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(s[0].slice(-2)==="/>")break;s[1]==="/"?AA(Ge,bt,f.slice(pe,s.index)):pe=s.index+s[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(s[1]==="/"){if((M=C.pop())[0]!==s[3])throw new Error("Bad state: "+M.join("|"))}else C.push([s[3],!1]);break;case"comment":if(s[1]==="/"){if((M=C.pop())[0]!==s[3])throw new Error("Bad state: "+M.join("|"));G4(ut),le.push(ut)}else C.push([s[3],!1]),M=Ju(s[0]),ut={a:M.Author};break;case"autofilter":if(s[1]==="/"){if((M=C.pop())[0]!==s[3])throw new Error("Bad state: "+M.join("|"))}else if(s[0].charAt(s[0].length-2)!=="/"){var se=Ju(s[0]);U["!autofilter"]={ref:Z0(se.Range).replace(/\$/g,"")},C.push([s[3],!0])}break;case"name":break;case"datavalidation":if(s[1]==="/"){if((M=C.pop())[0]!==s[3])throw new Error("Bad state: "+M.join("|"))}else s[0].charAt(s[0].length-2)!=="/"&&C.push([s[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(s[1]==="/"){if((M=C.pop())[0]!==s[3])throw new Error("Bad state: "+M.join("|"))}else s[0].charAt(s[0].length-2)!=="/"&&C.push([s[3],!0]);break;case"null":break;default:if(C.length==0&&s[3]=="document"||C.length==0&&s[3]=="uof")return ab(f,l);var Rt=!0;switch(C[C.length-1][0]){case"officedocumentsettings":switch(s[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Rt=!1}break;case"componentoptions":switch(s[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Rt=!1}break;case"excelworkbook":switch(s[3]){case"date1904":Pe.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Rt=!1}break;case"workbookoptions":switch(s[3]){case"owcversion":break;case"height":break;case"width":break;default:Rt=!1}break;case"worksheetoptions":switch(s[3]){case"visible":if(s[0].slice(-2)!=="/>")if(s[1]==="/")switch(f.slice(pe,s.index)){case"SheetHidden":De.Hidden=1;break;case"SheetVeryHidden":De.Hidden=2;break}else pe=s.index+s[0].length;break;case"header":U["!margins"]||Cg(U["!margins"]={},"xlml"),isNaN(+vn(s[0]).Margin)||(U["!margins"].header=+vn(s[0]).Margin);break;case"footer":U["!margins"]||Cg(U["!margins"]={},"xlml"),isNaN(+vn(s[0]).Margin)||(U["!margins"].footer=+vn(s[0]).Margin);break;case"pagemargins":var yt=vn(s[0]);U["!margins"]||Cg(U["!margins"]={},"xlml"),isNaN(+yt.Top)||(U["!margins"].top=+yt.Top),isNaN(+yt.Left)||(U["!margins"].left=+yt.Left),isNaN(+yt.Right)||(U["!margins"].right=+yt.Right),isNaN(+yt.Bottom)||(U["!margins"].bottom=+yt.Bottom);break;case"displayrighttoleft":Pe.Views||(Pe.Views=[]),Pe.Views[0]||(Pe.Views[0]={}),Pe.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":U["!outline"]||(U["!outline"]={}),U["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":U["!outline"]||(U["!outline"]={}),U["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Rt=!1}break;case"pivottable":case"pivotcache":switch(s[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Rt=!1}break;case"pagebreaks":switch(s[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Rt=!1}break;case"autofilter":switch(s[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Rt=!1}break;case"querytable":switch(s[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Rt=!1}break;case"datavalidation":switch(s[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Rt=!1}break;case"sorting":case"conditionalformatting":switch(s[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Rt=!1}break;case"mapinfo":case"schema":case"data":switch(s[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Rt=!1}break;case"smarttags":break;default:Rt=!1;break}if(Rt||s[3].match(/!\[CDATA/))break;if(!C[C.length-1][1])throw"Unrecognized tag: "+s[3]+"|"+C.join("|");if(C[C.length-1][0]==="customdocumentproperties"){if(s[0].slice(-2)==="/>")break;s[1]==="/"?N4(et,bt,Je,f.slice(pe,s.index)):(Je=s,pe=s.index+s[0].length);break}if(l.WTF)throw"Unrecognized tag: "+s[3]+"|"+C.join("|")}var Ee={};return!l.bookSheets&&!l.bookProps&&(Ee.Sheets=D),Ee.SheetNames=B,Ee.Workbook=Pe,Ee.SSF=go(Pn),Ee.Props=Ge,Ee.Custprops=et,Ee}function Ny(r,u){switch(S1(u=u||{}),u.type||"base64"){case"base64":return by(Ic(r),u);case"binary":case"buffer":case"file":return by(r,u);case"array":return by(Mp(r),u)}}function H4(r){var u={},l=r.content;if(l.l=28,u.AnsiUserType=l.read_shift(0,"lpstr-ansi"),u.AnsiClipboardFormat=aA(l),l.length-l.l<=4)return u;var f=l.read_shift(4);if(f==0||f>40||(l.l-=4,u.Reserved1=l.read_shift(0,"lpstr-ansi"),l.length-l.l<=4)||(f=l.read_shift(4),f!==1907505652)||(u.UnicodeClipboardFormat=iA(l),f=l.read_shift(4),f==0||f>40))return u;l.l-=4,u.Reserved2=l.read_shift(0,"lpwstr")}var q4=[60,1084,2066,2165,2175];function Z4(r,u,l,f,p){var b=f,_=[],s=l.slice(l.l,l.l+b);if(p&&p.enc&&p.enc.insitu&&s.length>0)switch(r){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:p.enc.insitu(s)}_.push(s),l.l+=b;for(var C=Ef(l,l.l),M=jy[C],D=0;M!=null&&q4.indexOf(C)>-1;)b=Ef(l,l.l+2),D=l.l+4,C==2066?D+=4:(C==2165||C==2175)&&(D+=12),s=l.slice(D,l.l+4+b),_.push(s),l.l+=4+b,M=jy[C=Ef(l,l.l)];var B=gd(_);mo(B,0);var U=0;B.lens=[];for(var j=0;j<_.length;++j)B.lens.push(U),U+=_[j].length;if(B.length<f)throw"XLS Record 0x"+r.toString(16)+" Truncated: "+B.length+" < "+f;return u.f(B,B.length,p)}function Nh(r,u,l){if(r.t!=="z"&&r.XF){var f=0;try{f=r.z||r.XF.numFmtId||0,u.cellNF&&(r.z=Pn[f])}catch(b){if(u.WTF)throw b}if(!u||u.cellText!==!1)try{r.t==="e"?r.w=r.w||Ip[r.v]:f===0||f=="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=Ig(r.v):r.w=Sp(r.v):r.w=lu(f,r.v,{date1904:!!l,dateNF:u&&u.dateNF})}catch(b){if(u.WTF)throw b}if(u.cellDates&&f&&r.t=="n"&&tm(Pn[f]||String(f))){var p=bp(r.v);p&&(r.t="d",r.v=new Date(p.y,p.m-1,p.d,p.H,p.M,p.S,p.u))}}}function ix(r,u,l){return{v:r,ixfe:u,t:l}}function W4(r,u){var l={opts:{}},f={},p=u.dense?[]:{},b={},_={},s=null,C=[],M="",D={},B,U="",j,H,z,N,Z={},Y=[],W,de,ge=[],ve=[],ie={Sheets:[],WBProps:{date1904:!1},Views:[{}]},Me={},we=function(je){return je<8?Tp[je]:je<64&&ve[je-8]||Tp[je]},Ge=function(je,$e,_t){var lt=$e.XF.data;if(!(!lt||!lt.patternType||!_t||!_t.cellStyles)){$e.s={},$e.s.patternType=lt.patternType;var at;(at=zg(we(lt.icvFore)))&&($e.s.fgColor={rgb:at}),(at=zg(we(lt.icvBack)))&&($e.s.bgColor={rgb:at})}},et=function(je,$e,_t){if(!(me>1)&&!(_t.sheetRows&&je.r>=_t.sheetRows)){if(_t.cellStyles&&$e.XF&&$e.XF.data&&Ge(je,$e,_t),delete $e.ixfe,delete $e.XF,B=je,U=kn(je),(!_||!_.s||!_.e)&&(_={s:{r:0,c:0},e:{r:0,c:0}}),je.r<_.s.r&&(_.s.r=je.r),je.c<_.s.c&&(_.s.c=je.c),je.r+1>_.e.r&&(_.e.r=je.r+1),je.c+1>_.e.c&&(_.e.c=je.c+1),_t.cellFormula&&$e.f){for(var lt=0;lt<Y.length;++lt)if(!(Y[lt][0].s.c>je.c||Y[lt][0].s.r>je.r)&&!(Y[lt][0].e.c<je.c||Y[lt][0].e.r<je.r)){$e.F=oa(Y[lt][0]),(Y[lt][0].s.c!=je.c||Y[lt][0].s.r!=je.r)&&delete $e.f,$e.f&&($e.f=""+Uo(Y[lt][1],_,je,Be,pe));break}}_t.dense?(p[je.r]||(p[je.r]=[]),p[je.r][je.c]=$e):p[U]=$e}},pe={enc:!1,sbcch:0,snames:[],sharedf:Z,arrayf:Y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!u&&!!u.cellStyles,WTF:!!u&&!!u.wtf};u.password&&(pe.password=u.password);var Je,le=[],ut=[],tt=[],We=[],$t=!1,Be=[];Be.SheetNames=pe.snames,Be.sharedf=pe.sharedf,Be.arrayf=pe.arrayf,Be.names=[],Be.XTI=[];var Mt=0,me=0,re=0,Ve=[],Pe=[],De;pe.codepage=1200,rh(1200);for(var bt=!1;r.l<r.length-1;){var Vt=r.l,Zt=r.read_shift(2);if(Zt===0&&Mt===10)break;var jt=r.l===r.length?0:r.read_shift(2),Yt=jy[Zt];if(Yt&&Yt.f){if(u.bookSheets&&Mt===133&&Zt!==133)break;if(Mt=Zt,Yt.r===2||Yt.r==12){var jr=r.read_shift(2);if(jt-=2,!pe.enc&&jr!==Zt&&((jr&255)<<8|jr>>8)!==Zt)throw new Error("rt mismatch: "+jr+"!="+Zt);Yt.r==12&&(r.l+=10,jt-=10)}var Qe={};if(Zt===10?Qe=Yt.f(r,jt,pe):Qe=Z4(Zt,Yt,r,jt,pe),me==0&&[9,521,1033,2057].indexOf(Mt)===-1)continue;switch(Zt){case 34:l.opts.Date1904=ie.WBProps.date1904=Qe;break;case 134:l.opts.WriteProtect=!0;break;case 47:if(pe.enc||(r.l=0),pe.enc=Qe,!u.password)throw new Error("File is password-protected");if(Qe.valid==null)throw new Error("Encryption scheme unsupported");if(!Qe.valid)throw new Error("Password is incorrect");break;case 92:pe.lastuser=Qe;break;case 66:var _n=Number(Qe);switch(_n){case 21010:_n=1200;break;case 32768:_n=1e4;break;case 32769:_n=1252;break}rh(pe.codepage=_n),bt=!0;break;case 317:pe.rrtabid=Qe;break;case 25:pe.winlocked=Qe;break;case 439:l.opts.RefreshAll=Qe;break;case 12:l.opts.CalcCount=Qe;break;case 16:l.opts.CalcDelta=Qe;break;case 17:l.opts.CalcIter=Qe;break;case 13:l.opts.CalcMode=Qe;break;case 14:l.opts.CalcPrecision=Qe;break;case 95:l.opts.CalcSaveRecalc=Qe;break;case 15:pe.CalcRefMode=Qe;break;case 2211:l.opts.FullCalc=Qe;break;case 129:Qe.fDialog&&(p["!type"]="dialog"),Qe.fBelow||((p["!outline"]||(p["!outline"]={})).above=!0),Qe.fRight||((p["!outline"]||(p["!outline"]={})).left=!0);break;case 224:ge.push(Qe);break;case 430:Be.push([Qe]),Be[Be.length-1].XTI=[];break;case 35:case 547:Be[Be.length-1].push(Qe);break;case 24:case 536:De={Name:Qe.Name,Ref:Uo(Qe.rgce,_,null,Be,pe)},Qe.itab>0&&(De.Sheet=Qe.itab-1),Be.names.push(De),Be[0]||(Be[0]=[],Be[0].XTI=[]),Be[Be.length-1].push(Qe),Qe.Name=="_xlnm._FilterDatabase"&&Qe.itab>0&&Qe.rgce&&Qe.rgce[0]&&Qe.rgce[0][0]&&Qe.rgce[0][0][0]=="PtgArea3d"&&(Pe[Qe.itab-1]={ref:oa(Qe.rgce[0][0][1][2])});break;case 22:pe.ExternCount=Qe;break;case 23:Be.length==0&&(Be[0]=[],Be[0].XTI=[]),Be[Be.length-1].XTI=Be[Be.length-1].XTI.concat(Qe),Be.XTI=Be.XTI.concat(Qe);break;case 2196:if(pe.biff<8)break;De!=null&&(De.Comment=Qe[1]);break;case 18:p["!protect"]=Qe;break;case 19:Qe!==0&&pe.WTF&&console.error("Password verifier: "+Qe);break;case 133:b[Qe.pos]=Qe,pe.snames.push(Qe.name);break;case 10:{if(--me)break;if(_.e){if(_.e.r>0&&_.e.c>0){if(_.e.r--,_.e.c--,p["!ref"]=oa(_),u.sheetRows&&u.sheetRows<=_.e.r){var se=_.e.r;_.e.r=u.sheetRows-1,p["!fullref"]=p["!ref"],p["!ref"]=oa(_),_.e.r=se}_.e.r++,_.e.c++}le.length>0&&(p["!merges"]=le),ut.length>0&&(p["!objects"]=ut),tt.length>0&&(p["!cols"]=tt),We.length>0&&(p["!rows"]=We),ie.Sheets.push(Me)}M===""?D=p:f[M]=p,p=u.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(pe.biff===8&&(pe.biff={9:2,521:3,1033:4}[Zt]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Qe.BIFFVer]||8),pe.biffguess=Qe.BIFFVer==0,Qe.BIFFVer==0&&Qe.dt==4096&&(pe.biff=5,bt=!0,rh(pe.codepage=28591)),pe.biff==8&&Qe.BIFFVer==0&&Qe.dt==16&&(pe.biff=2),me++)break;if(p=u.dense?[]:{},pe.biff<8&&!bt&&(bt=!0,rh(pe.codepage=u.codepage||1252)),pe.biff<5||Qe.BIFFVer==0&&Qe.dt==4096){M===""&&(M="Sheet1"),_={s:{r:0,c:0},e:{r:0,c:0}};var Rt={pos:r.l-jt,name:M};b[Rt.pos]=Rt,pe.snames.push(M)}else M=(b[Vt]||{name:""}).name;Qe.dt==32&&(p["!type"]="chart"),Qe.dt==64&&(p["!type"]="macro"),le=[],ut=[],pe.arrayf=Y=[],tt=[],We=[],$t=!1,Me={Hidden:(b[Vt]||{hs:0}).hs,name:M}}break;case 515:case 3:case 2:p["!type"]=="chart"&&(u.dense?(p[Qe.r]||[])[Qe.c]:p[kn({c:Qe.c,r:Qe.r})])&&++Qe.c,W={ixfe:Qe.ixfe,XF:ge[Qe.ixfe]||{},v:Qe.val,t:"n"},re>0&&(W.z=Ve[W.ixfe>>8&63]),Nh(W,u,l.opts.Date1904),et({c:Qe.c,r:Qe.r},W,u);break;case 5:case 517:W={ixfe:Qe.ixfe,XF:ge[Qe.ixfe],v:Qe.val,t:Qe.t},re>0&&(W.z=Ve[W.ixfe>>8&63]),Nh(W,u,l.opts.Date1904),et({c:Qe.c,r:Qe.r},W,u);break;case 638:W={ixfe:Qe.ixfe,XF:ge[Qe.ixfe],v:Qe.rknum,t:"n"},re>0&&(W.z=Ve[W.ixfe>>8&63]),Nh(W,u,l.opts.Date1904),et({c:Qe.c,r:Qe.r},W,u);break;case 189:for(var yt=Qe.c;yt<=Qe.C;++yt){var Ee=Qe.rkrec[yt-Qe.c][0];W={ixfe:Ee,XF:ge[Ee],v:Qe.rkrec[yt-Qe.c][1],t:"n"},re>0&&(W.z=Ve[W.ixfe>>8&63]),Nh(W,u,l.opts.Date1904),et({c:yt,r:Qe.r},W,u)}break;case 6:case 518:case 1030:{if(Qe.val=="String"){s=Qe;break}if(W=ix(Qe.val,Qe.cell.ixfe,Qe.tt),W.XF=ge[W.ixfe],u.cellFormula){var Ne=Qe.formula;if(Ne&&Ne[0]&&Ne[0][0]&&Ne[0][0][0]=="PtgExp"){var dt=Ne[0][0][1][0],Kt=Ne[0][0][1][1],Jt=kn({r:dt,c:Kt});Z[Jt]?W.f=""+Uo(Qe.formula,_,Qe.cell,Be,pe):W.F=((u.dense?(p[dt]||[])[Kt]:p[Jt])||{}).F}else W.f=""+Uo(Qe.formula,_,Qe.cell,Be,pe)}re>0&&(W.z=Ve[W.ixfe>>8&63]),Nh(W,u,l.opts.Date1904),et(Qe.cell,W,u),s=Qe}break;case 7:case 519:if(s)s.val=Qe,W=ix(Qe,s.cell.ixfe,"s"),W.XF=ge[W.ixfe],u.cellFormula&&(W.f=""+Uo(s.formula,_,s.cell,Be,pe)),re>0&&(W.z=Ve[W.ixfe>>8&63]),Nh(W,u,l.opts.Date1904),et(s.cell,W,u),s=null;else throw new Error("String record expects Formula");break;case 33:case 545:{Y.push(Qe);var kt=kn(Qe[0].s);if(j=u.dense?(p[Qe[0].s.r]||[])[Qe[0].s.c]:p[kt],u.cellFormula&&j){if(!s||!kt||!j)break;j.f=""+Uo(Qe[1],_,Qe[0],Be,pe),j.F=oa(Qe[0])}}break;case 1212:{if(!u.cellFormula)break;if(U){if(!s)break;Z[kn(s.cell)]=Qe[0],j=u.dense?(p[s.cell.r]||[])[s.cell.c]:p[kn(s.cell)],(j||{}).f=""+Uo(Qe[0],_,B,Be,pe)}}break;case 253:W=ix(C[Qe.isst].t,Qe.ixfe,"s"),C[Qe.isst].h&&(W.h=C[Qe.isst].h),W.XF=ge[W.ixfe],re>0&&(W.z=Ve[W.ixfe>>8&63]),Nh(W,u,l.opts.Date1904),et({c:Qe.c,r:Qe.r},W,u);break;case 513:u.sheetStubs&&(W={ixfe:Qe.ixfe,XF:ge[Qe.ixfe],t:"z"},re>0&&(W.z=Ve[W.ixfe>>8&63]),Nh(W,u,l.opts.Date1904),et({c:Qe.c,r:Qe.r},W,u));break;case 190:if(u.sheetStubs)for(var lr=Qe.c;lr<=Qe.C;++lr){var pr=Qe.ixfe[lr-Qe.c];W={ixfe:pr,XF:ge[pr],t:"z"},re>0&&(W.z=Ve[W.ixfe>>8&63]),Nh(W,u,l.opts.Date1904),et({c:lr,r:Qe.r},W,u)}break;case 214:case 516:case 4:W=ix(Qe.val,Qe.ixfe,"s"),W.XF=ge[W.ixfe],re>0&&(W.z=Ve[W.ixfe>>8&63]),Nh(W,u,l.opts.Date1904),et({c:Qe.c,r:Qe.r},W,u);break;case 0:case 512:me===1&&(_=Qe);break;case 252:C=Qe;break;case 1054:if(pe.biff==4){Ve[re++]=Qe[1];for(var sr=0;sr<re+163&&Pn[sr]!=Qe[1];++sr);sr>=163&&wp(Qe[1],re+163)}else wp(Qe[1],Qe[0]);break;case 30:{Ve[re++]=Qe;for(var st=0;st<re+163&&Pn[st]!=Qe;++st);st>=163&&wp(Qe,re+163)}break;case 229:le=le.concat(Qe);break;case 93:ut[Qe.cmo[0]]=pe.lastobj=Qe;break;case 438:pe.lastobj.TxO=Qe;break;case 127:pe.lastobj.ImData=Qe;break;case 440:for(N=Qe[0].s.r;N<=Qe[0].e.r;++N)for(z=Qe[0].s.c;z<=Qe[0].e.c;++z)j=u.dense?(p[N]||[])[z]:p[kn({c:z,r:N})],j&&(j.l=Qe[1]);break;case 2048:for(N=Qe[0].s.r;N<=Qe[0].e.r;++N)for(z=Qe[0].s.c;z<=Qe[0].e.c;++z)j=u.dense?(p[N]||[])[z]:p[kn({c:z,r:N})],j&&j.l&&(j.l.Tooltip=Qe[1]);break;case 28:{if(pe.biff<=5&&pe.biff>=2)break;j=u.dense?(p[Qe[0].r]||[])[Qe[0].c]:p[kn(Qe[0])];var fe=ut[Qe[2]];j||(u.dense?(p[Qe[0].r]||(p[Qe[0].r]=[]),j=p[Qe[0].r][Qe[0].c]={t:"z"}):j=p[kn(Qe[0])]={t:"z"},_.e.r=Math.max(_.e.r,Qe[0].r),_.s.r=Math.min(_.s.r,Qe[0].r),_.e.c=Math.max(_.e.c,Qe[0].c),_.s.c=Math.min(_.s.c,Qe[0].c)),j.c||(j.c=[]),H={a:Qe[1],t:fe.TxO.t},j.c.push(H)}break;case 2173:m5(ge[Qe.ixfe],Qe.ext);break;case 125:{if(!pe.cellStyles)break;for(;Qe.e>=Qe.s;)tt[Qe.e--]={width:Qe.w/256,level:Qe.level||0,hidden:!!(Qe.flags&1)},$t||($t=!0,y1(Qe.w/256)),Y0(tt[Qe.e+1])}break;case 520:{var ue={};Qe.level!=null&&(We[Qe.r]=ue,ue.level=Qe.level),Qe.hidden&&(We[Qe.r]=ue,ue.hidden=!0),Qe.hpt&&(We[Qe.r]=ue,ue.hpt=Qe.hpt,ue.hpx=Og(Qe.hpt))}break;case 38:case 39:case 40:case 41:p["!margins"]||Cg(p["!margins"]={}),p["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Zt]]=Qe;break;case 161:p["!margins"]||Cg(p["!margins"]={}),p["!margins"].header=Qe.header,p["!margins"].footer=Qe.footer;break;case 574:Qe.RTL&&(ie.Views[0].RTL=!0);break;case 146:ve=Qe;break;case 2198:Je=Qe;break;case 140:de=Qe;break;case 442:M?Me.CodeName=Qe||Me.name:ie.WBProps.CodeName=Qe||"ThisWorkbook";break}}else Yt||console.error("Missing Info for XLS Record 0x"+Zt.toString(16)),r.l+=jt}return l.SheetNames=Gh(b).sort(function(ye,je){return Number(ye)-Number(je)}).map(function(ye){return b[ye].name}),u.bookSheets||(l.Sheets=f),!l.SheetNames.length&&D["!ref"]?(l.SheetNames.push("Sheet1"),l.Sheets&&(l.Sheets.Sheet1=D)):l.Preamble=D,l.Sheets&&Pe.forEach(function(ye,je){l.Sheets[l.SheetNames[je]]["!autofilter"]=ye}),l.Strings=C,l.SSF=go(Pn),pe.enc&&(l.Encryption=pe.enc),Je&&(l.Themes=Je),l.Metadata={},de!==void 0&&(l.Metadata.Country=de),Be.names.length>0&&(ie.Names=Be.names),l.Workbook=ie,l}var Qv={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function $4(r,u,l){var f=sa.find(r,"/!DocumentSummaryInformation");if(f&&f.size>0)try{var p=zv(f,hA,Qv.DSI);for(var b in p)u[b]=p[b]}catch(M){if(l.WTF)throw M}var _=sa.find(r,"/!SummaryInformation");if(_&&_.size>0)try{var s=zv(_,fA,Qv.SI);for(var C in s)u[C]==null&&(u[C]=s[C])}catch(M){if(l.WTF)throw M}u.HeadingPairs&&u.TitlesOfParts&&(I2(u.HeadingPairs,u.TitlesOfParts,u,l),delete u.HeadingPairs,delete u.TitlesOfParts)}function mw(r,u){u||(u={}),S1(u),Hb(),u.codepage&&r1(u.codepage);var l,f;if(r.FullPaths){if(sa.find(r,"/encryption"))throw new Error("File is password-protected");l=sa.find(r,"!CompObj"),f=sa.find(r,"/Workbook")||sa.find(r,"/Book")}else{switch(u.type){case"base64":r=eh(Ic(r));break;case"binary":r=eh(r);break;case"buffer":break;case"array":Array.isArray(r)||(r=Array.prototype.slice.call(r));break}mo(r,0),f={content:r}}var p,b;if(l&&H4(l),u.bookProps&&!u.bookSheets)p={};else{var _=ta?"buffer":"array";if(f&&f.content)p=W4(f.content,u);else if((b=sa.find(r,"PerfectOffice_MAIN"))&&b.content)p=Ag.to_workbook(b.content,(u.type=_,u));else if((b=sa.find(r,"NativeContent_MAIN"))&&b.content)p=Ag.to_workbook(b.content,(u.type=_,u));else throw(b=sa.find(r,"MN0"))&&b.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");u.bookVBA&&r.FullPaths&&sa.find(r,"/_VBA_PROJECT_CUR/VBA/dir")&&(p.vbaraw=P5(r))}var s={};return r.FullPaths&&$4(r,s,u),p.Props=p.Custprops=s,u.bookFiles&&(p.cfb=r),p}var Dx={0:{f:MM},1:{f:PM},2:{f:VM},3:{f:OM},4:{f:LM},5:{f:UM},6:{f:qM},7:{f:NM},8:{f:YM},9:{f:XM},10:{f:WM},11:{f:$M},12:{f:FM},13:{f:GM},14:{f:BM},15:{f:zM},16:{f:uw},17:{f:ZM},18:{f:jM},19:{f:d1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:T4},40:{},42:{},43:{f:WC},44:{f:ZC},45:{f:$C},46:{f:YC},47:{f:XC},48:{},49:{f:KE},50:{},51:{f:_5},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:H2},62:{f:HM},63:{f:w5},64:{f:i4},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:qo,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:a4},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:IM},148:{f:DM,p:16},151:{f:QM},152:{},153:{f:b4},154:{},155:{},156:{f:v4},157:{},158:{},159:{T:1,f:fC},160:{T:-1},161:{T:1,f:Rp},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:KM},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:g5},336:{T:-1},337:{f:x5,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ly},357:{},358:{},359:{},360:{T:1},361:{},362:{f:G2},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:e4},427:{f:t4},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:n4},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:RM},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:JM},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ly},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:D5},633:{T:1},634:{T:-1},635:{T:1,f:M5},636:{T:-1},637:{f:QE},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:h4},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:s4},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},jy={6:{f:yy},10:{f:dd},12:{f:_s},13:{f:_s},14:{f:is},15:{f:is},16:{f:Vo},17:{f:is},18:{f:is},19:{f:_s},20:{f:jv},21:{f:jv},23:{f:G2},24:{f:Vv},25:{f:is},26:{},27:{},28:{f:kk},29:{},34:{f:is},35:{f:Uv},38:{f:Vo},39:{f:Vo},40:{f:Vo},41:{f:Vo},42:{f:is},43:{f:is},47:{f:RC},49:{f:lk},51:{f:_s},60:{},61:{f:ik},64:{f:is},65:{f:ok},66:{f:_s},77:{},80:{},81:{},82:{},85:{f:_s},89:{},90:{},91:{},92:{f:KA},93:{f:Mk},94:{},95:{f:is},96:{},97:{},99:{f:is},125:{f:H2},128:{f:xk},129:{f:JA},130:{f:_s},131:{f:is},132:{f:is},133:{f:QA},134:{},140:{f:Lk},141:{f:_s},144:{},146:{f:Ok},151:{},152:{},153:{},154:{},155:{},156:{f:_s},157:{},158:{},160:{f:Vk},161:{f:Nk},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:pk},190:{f:mk},193:{f:dd},197:{},198:{},199:{},200:{},201:{},202:{f:is},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:_s},220:{},221:{f:is},222:{},224:{f:_k},225:{f:YA},226:{f:dd},227:{},229:{f:Ck},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:ek},253:{f:ck},255:{f:tk},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:O2},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:is},353:{f:dd},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:vk},431:{f:is},432:{},433:{},434:{},437:{},438:{f:Ik},439:{f:is},440:{f:Pk},441:{},442:{f:qg},443:{},444:{f:_s},445:{},446:{},448:{f:dd},449:{f:ak,r:2},450:{f:dd},512:{f:Bv},513:{f:Uk},515:{f:yk},516:{f:uk},517:{f:Nv},519:{f:Gk},520:{f:rk},523:{},545:{f:Gv},549:{f:Ov},566:{},574:{f:sk},638:{f:dk},659:{},1048:{},1054:{f:hk},1084:{},1212:{f:Sk},2048:{f:Fk},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:rx},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:dd},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Bk,r:12},2173:{f:p5,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:is,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Tk,r:12},2197:{},2198:{f:l5,r:12},2199:{},2200:{},2201:{},2202:{f:Ek,r:12},2203:{f:dd},2204:{},2205:{},2206:{},2207:{},2211:{f:nk},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:_s},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:jk},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:zk},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Bv},1:{},2:{f:Wk},3:{f:Zk},4:{f:qk},5:{f:Nv},7:{f:$k},8:{},9:{f:rx},11:{},22:{f:_s},30:{f:fk},31:{},32:{},33:{f:Gv},36:{},37:{f:Ov},50:{f:Xk},62:{},52:{},67:{},68:{f:_s},69:{},86:{},126:{},127:{f:Hk},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Yk},223:{},234:{},354:{},421:{},518:{f:yy},521:{f:rx},536:{f:Vv},547:{f:Uv},561:{},579:{},1030:{f:yy},1033:{f:rx},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Qu(r,u,l,f){var p=u;if(!isNaN(p)){var b=(l||[]).length||0,_=r.next(4);_.write_shift(2,p),_.write_shift(2,b),b>0&&S2(l)&&r.push(l)}}function eb(r,u){var l=u||{},f=l.dense?[]:{};r=r.replace(/<!--.*?-->/g,"");var p=r.match(/<table/i);if(!p)throw new Error("Invalid HTML: could not find <table>");var b=r.match(/<\/table/i),_=p.index,s=b&&b.index||r.length,C=yE(r.slice(_,s),/(:?<tr[^>]*>)/i,"<tr>"),M=-1,D=0,B=0,U=0,j={s:{r:1e7,c:1e7},e:{r:0,c:0}},H=[];for(_=0;_<C.length;++_){var z=C[_].trim(),N=z.slice(0,3).toLowerCase();if(N=="<tr"){if(++M,l.sheetRows&&l.sheetRows<=M){--M;break}D=0;continue}if(!(N!="<td"&&N!="<th")){var Z=z.split(/<\/t[dh]>/i);for(s=0;s<Z.length;++s){var Y=Z[s].trim();if(Y.match(/<t[dh]/i)){for(var W=Y,de=0;W.charAt(0)=="<"&&(de=W.indexOf(">"))>-1;)W=W.slice(de+1);for(var ge=0;ge<H.length;++ge){var ve=H[ge];ve.s.c==D&&ve.s.r<M&&M<=ve.e.r&&(D=ve.e.c+1,ge=-1)}var ie=vn(Y.slice(0,Y.indexOf(">")));U=ie.colspan?+ie.colspan:1,((B=+ie.rowspan)>1||U>1)&&H.push({s:{r:M,c:D},e:{r:M+(B||1)-1,c:D+U-1}});var Me=ie.t||ie["data-t"]||"";if(!W.length){D+=U;continue}if(W=h2(W),j.s.r>M&&(j.s.r=M),j.e.r<M&&(j.e.r=M),j.s.c>D&&(j.s.c=D),j.e.c<D&&(j.e.c=D),!W.length){D+=U;continue}var we={t:"s",v:W};l.raw||!W.trim().length||Me=="s"||(W==="TRUE"?we={t:"b",v:!0}:W==="FALSE"?we={t:"b",v:!1}:isNaN(ah(W))?isNaN(X0(W).getDate())||(we={t:"d",v:Ys(W)},l.cellDates||(we={t:"n",v:Tl(we.v)}),we.z=l.dateNF||Pn[14]):we={t:"n",v:ah(W)}),l.dense?(f[M]||(f[M]=[]),f[M][D]=we):f[kn({r:M,c:D})]=we,D+=U}}}}return f["!ref"]=oa(j),H.length&&(f["!merges"]=H),f}function X4(r,u,l,f){for(var p=r["!merges"]||[],b=[],_=u.s.c;_<=u.e.c;++_){for(var s=0,C=0,M=0;M<p.length;++M)if(!(p[M].s.r>l||p[M].s.c>_)&&!(p[M].e.r<l||p[M].e.c<_)){if(p[M].s.r<l||p[M].s.c<_){s=-1;break}s=p[M].e.r-p[M].s.r+1,C=p[M].e.c-p[M].s.c+1;break}if(!(s<0)){var D=kn({r:l,c:_}),B=f.dense?(r[l]||[])[_]:r[D],U=B&&B.v!=null&&(B.h||l1(B.w||(Df(B),B.w)||""))||"",j={};s>1&&(j.rowspan=s),C>1&&(j.colspan=C),f.editable?U='<span contenteditable="true">'+U+"</span>":B&&(j["data-t"]=B&&B.t||"z",B.v!=null&&(j["data-v"]=B.v),B.z!=null&&(j["data-z"]=B.z),B.l&&(B.l.Target||"#").charAt(0)!="#"&&(U='<a href="'+B.l.Target+'">'+U+"</a>")),j.id=(f.id||"sjs")+"-"+D,b.push(LE("td",U,j))}}var H="<tr>";return H+b.join("")+"</tr>"}var Y4='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',K4="</body></html>";function J4(r,u){var l=r.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!l||l.length==0)throw new Error("Invalid HTML: could not find <table>");if(l.length==1)return Ed(eb(l[0],u),u);var f=A1();return l.forEach(function(p,b){k1(f,eb(p,u),"Sheet"+(b+1))}),f}function Q4(r,u,l){var f=[];return f.join("")+"<table"+(l&&l.id?' id="'+l.id+'"':"")+">"}function eD(r,u){var l=u||{},f=l.header!=null?l.header:Y4,p=l.footer!=null?l.footer:K4,b=[f],_=rm(r["!ref"]);l.dense=Array.isArray(r),b.push(Q4(r,_,l));for(var s=_.s.r;s<=_.e.r;++s)b.push(X4(r,_,s,l));return b.push("</table>"+p),b.join("")}function gw(r,u,l){var f=l||{},p=0,b=0;if(f.origin!=null)if(typeof f.origin=="number")p=f.origin;else{var _=typeof f.origin=="string"?bl(f.origin):f.origin;p=_.r,b=_.c}var s=u.getElementsByTagName("tr"),C=Math.min(f.sheetRows||1e7,s.length),M={s:{r:0,c:0},e:{r:p,c:b}};if(r["!ref"]){var D=rm(r["!ref"]);M.s.r=Math.min(M.s.r,D.s.r),M.s.c=Math.min(M.s.c,D.s.c),M.e.r=Math.max(M.e.r,D.e.r),M.e.c=Math.max(M.e.c,D.e.c),p==-1&&(M.e.r=p=D.e.r+1)}var B=[],U=0,j=r["!rows"]||(r["!rows"]=[]),H=0,z=0,N=0,Z=0,Y=0,W=0;for(r["!cols"]||(r["!cols"]=[]);H<s.length&&z<C;++H){var de=s[H];if(tb(de)){if(f.display)continue;j[z]={hidden:!0}}var ge=de.children;for(N=Z=0;N<ge.length;++N){var ve=ge[N];if(!(f.display&&tb(ve))){var ie=ve.hasAttribute("data-v")?ve.getAttribute("data-v"):ve.hasAttribute("v")?ve.getAttribute("v"):h2(ve.innerHTML),Me=ve.getAttribute("data-z")||ve.getAttribute("z");for(U=0;U<B.length;++U){var we=B[U];we.s.c==Z+b&&we.s.r<z+p&&z+p<=we.e.r&&(Z=we.e.c+1-b,U=-1)}W=+ve.getAttribute("colspan")||1,((Y=+ve.getAttribute("rowspan")||1)>1||W>1)&&B.push({s:{r:z+p,c:Z+b},e:{r:z+p+(Y||1)-1,c:Z+b+(W||1)-1}});var Ge={t:"s",v:ie},et=ve.getAttribute("data-t")||ve.getAttribute("t")||"";ie!=null&&(ie.length==0?Ge.t=et||"z":f.raw||ie.trim().length==0||et=="s"||(ie==="TRUE"?Ge={t:"b",v:!0}:ie==="FALSE"?Ge={t:"b",v:!1}:isNaN(ah(ie))?isNaN(X0(ie).getDate())||(Ge={t:"d",v:Ys(ie)},f.cellDates||(Ge={t:"n",v:Tl(Ge.v)}),Ge.z=f.dateNF||Pn[14]):Ge={t:"n",v:ah(ie)})),Ge.z===void 0&&Me!=null&&(Ge.z=Me);var pe="",Je=ve.getElementsByTagName("A");if(Je&&Je.length)for(var le=0;le<Je.length&&!(Je[le].hasAttribute("href")&&(pe=Je[le].getAttribute("href"),pe.charAt(0)!="#"));++le);pe&&pe.charAt(0)!="#"&&(Ge.l={Target:pe}),f.dense?(r[z+p]||(r[z+p]=[]),r[z+p][Z+b]=Ge):r[kn({c:Z+b,r:z+p})]=Ge,M.e.c<Z+b&&(M.e.c=Z+b),Z+=W}}++z}return B.length&&(r["!merges"]=(r["!merges"]||[]).concat(B)),M.e.r=Math.max(M.e.r,z-1+p),r["!ref"]=oa(M),z>=C&&(r["!fullref"]=oa((M.e.r=s.length-H+z-1+p,M))),r}function _w(r,u){var l=u||{},f=l.dense?[]:{};return gw(f,r,u)}function tD(r,u){return Ed(_w(r,u),u)}function tb(r){var u="",l=rD(r);return l&&(u=l(r).getPropertyValue("display")),u||(u=r.style&&r.style.display),u==="none"}function rD(r){return r.ownerDocument.defaultView&&typeof r.ownerDocument.defaultView.getComputedStyle=="function"?r.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function nD(r){var u=r.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(f,p){return Array(parseInt(p,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),l=ma(u.replace(/<[^>]*>/g,""));return[l]}var rb={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function xw(r,u){var l=u||{},f=c1(r),p=[],b,_,s={name:""},C="",M=0,D,B,U={},j=[],H=l.dense?[]:{},z,N,Z={value:""},Y="",W=0,de=[],ge=-1,ve=-1,ie={s:{r:1e6,c:1e7},e:{r:0,c:0}},Me=0,we={},Ge=[],et={},pe=0,Je=0,le=[],ut=1,tt=1,We=[],$t={Names:[]},Be={},Mt=["",""],me=[],re={},Ve="",Pe=0,De=!1,bt=!1,Vt=0;for(Fg.lastIndex=0,f=f.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");z=Fg.exec(f);)switch(z[3]=z[3].replace(/_.*$/,"")){case"table":case"":z[1]==="/"?(ie.e.c>=ie.s.c&&ie.e.r>=ie.s.r?H["!ref"]=oa(ie):H["!ref"]="A1:A1",l.sheetRows>0&&l.sheetRows<=ie.e.r&&(H["!fullref"]=H["!ref"],ie.e.r=l.sheetRows-1,H["!ref"]=oa(ie)),Ge.length&&(H["!merges"]=Ge),le.length&&(H["!rows"]=le),D.name=D.||D.name,typeof JSON<"u"&&JSON.stringify(D),j.push(D.name),U[D.name]=H,bt=!1):z[0].charAt(z[0].length-2)!=="/"&&(D=vn(z[0],!1),ge=ve=-1,ie.s.r=ie.s.c=1e7,ie.e.r=ie.e.c=0,H=l.dense?[]:{},Ge=[],le=[],bt=!0);break;case"table-row-group":z[1]==="/"?--Me:++Me;break;case"table-row":case"":if(z[1]==="/"){ge+=ut,ut=1;break}if(B=vn(z[0],!1),B.?ge=B.-1:ge==-1&&(ge=0),ut=+B["number-rows-repeated"]||1,ut<10)for(Vt=0;Vt<ut;++Vt)Me>0&&(le[ge+Vt]={level:Me});ve=-1;break;case"covered-table-cell":z[1]!=="/"&&++ve,l.sheetStubs&&(l.dense?(H[ge]||(H[ge]=[]),H[ge][ve]={t:"z"}):H[kn({r:ge,c:ve})]={t:"z"}),Y="",de=[];break;case"table-cell":case"":if(z[0].charAt(z[0].length-2)==="/")++ve,Z=vn(z[0],!1),tt=parseInt(Z["number-columns-repeated"]||"1",10),N={t:"z",v:null},Z.formula&&l.cellFormula!=!1&&(N.f=Yv(ma(Z.formula))),(Z.||Z["value-type"])=="string"&&(N.t="s",N.v=ma(Z["string-value"]||""),l.dense?(H[ge]||(H[ge]=[]),H[ge][ve]=N):H[kn({r:ge,c:ve})]=N),ve+=tt-1;else if(z[1]!=="/"){++ve,Y="",W=0,de=[],tt=1;var Zt=ut?ge+ut-1:ge;if(ve>ie.e.c&&(ie.e.c=ve),ve<ie.s.c&&(ie.s.c=ve),ge<ie.s.r&&(ie.s.r=ge),Zt>ie.e.r&&(ie.e.r=Zt),Z=vn(z[0],!1),me=[],re={},N={t:Z.||Z["value-type"],v:null},l.cellFormula)if(Z.formula&&(Z.formula=ma(Z.formula)),Z["number-matrix-columns-spanned"]&&Z["number-matrix-rows-spanned"]&&(pe=parseInt(Z["number-matrix-rows-spanned"],10)||0,Je=parseInt(Z["number-matrix-columns-spanned"],10)||0,et={s:{r:ge,c:ve},e:{r:ge+pe-1,c:ve+Je-1}},N.F=oa(et),We.push([et,N.F])),Z.formula)N.f=Yv(Z.formula);else for(Vt=0;Vt<We.length;++Vt)ge>=We[Vt][0].s.r&&ge<=We[Vt][0].e.r&&ve>=We[Vt][0].s.c&&ve<=We[Vt][0].e.c&&(N.F=We[Vt][1]);switch((Z["number-columns-spanned"]||Z["number-rows-spanned"])&&(pe=parseInt(Z["number-rows-spanned"],10)||0,Je=parseInt(Z["number-columns-spanned"],10)||0,et={s:{r:ge,c:ve},e:{r:ge+pe-1,c:ve+Je-1}},Ge.push(et)),Z["number-columns-repeated"]&&(tt=parseInt(Z["number-columns-repeated"],10)),N.t){case"boolean":N.t="b",N.v=bi(Z["boolean-value"]);break;case"float":N.t="n",N.v=parseFloat(Z.value);break;case"percentage":N.t="n",N.v=parseFloat(Z.value);break;case"currency":N.t="n",N.v=parseFloat(Z.value);break;case"date":N.t="d",N.v=Ys(Z["date-value"]),l.cellDates||(N.t="n",N.v=Tl(N.v)),N.z="m/d/yy";break;case"time":N.t="n",N.v=gE(Z["time-value"])/86400,l.cellDates&&(N.t="d",N.v=Ox(N.v)),N.z="HH:MM:SS";break;case"number":N.t="n",N.v=parseFloat(Z.);break;default:if(N.t==="string"||N.t==="text"||!N.t)N.t="s",Z["string-value"]!=null&&(Y=ma(Z["string-value"]),de=[]);else throw new Error("Unsupported value type "+N.t)}}else{if(De=!1,N.t==="s"&&(N.v=Y||"",de.length&&(N.R=de),De=W==0),Be.Target&&(N.l=Be),me.length>0&&(N.c=me,me=[]),Y&&l.cellText!==!1&&(N.w=Y),De&&(N.t="z",delete N.v),(!De||l.sheetStubs)&&!(l.sheetRows&&l.sheetRows<=ge))for(var jt=0;jt<ut;++jt){if(tt=parseInt(Z["number-columns-repeated"]||"1",10),l.dense)for(H[ge+jt]||(H[ge+jt]=[]),H[ge+jt][ve]=jt==0?N:go(N);--tt>0;)H[ge+jt][ve+tt]=go(N);else for(H[kn({r:ge+jt,c:ve})]=N;--tt>0;)H[kn({r:ge+jt,c:ve+tt})]=go(N);ie.e.c<=ve&&(ie.e.c=ve)}tt=parseInt(Z["number-columns-repeated"]||"1",10),ve+=tt-1,tt=0,N={},Y="",de=[]}Be={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(z[1]==="/"){if((b=p.pop())[0]!==z[3])throw"Bad state: "+b}else z[0].charAt(z[0].length-2)!=="/"&&p.push([z[3],!0]);break;case"annotation":if(z[1]==="/"){if((b=p.pop())[0]!==z[3])throw"Bad state: "+b;re.t=Y,de.length&&(re.R=de),re.a=Ve,me.push(re)}else z[0].charAt(z[0].length-2)!=="/"&&p.push([z[3],!1]);Ve="",Pe=0,Y="",W=0,de=[];break;case"creator":z[1]==="/"?Ve=f.slice(Pe,z.index):Pe=z.index+z[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(z[1]==="/"){if((b=p.pop())[0]!==z[3])throw"Bad state: "+b}else z[0].charAt(z[0].length-2)!=="/"&&p.push([z[3],!1]);Y="",W=0,de=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(z[1]==="/"){if(we[s.name]=C,(b=p.pop())[0]!==z[3])throw"Bad state: "+b}else z[0].charAt(z[0].length-2)!=="/"&&(C="",s=vn(z[0],!1),p.push([z[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(p[p.length-1][0]){case"time-style":case"date-style":_=vn(z[0],!1),C+=rb[z[3]][_.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(p[p.length-1][0]){case"time-style":case"date-style":_=vn(z[0],!1),C+=rb[z[3]][_.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(z[0].slice(-2)==="/>")break;if(z[1]==="/")switch(p[p.length-1][0]){case"number-style":case"date-style":case"time-style":C+=f.slice(M,z.index);break}else M=z.index+z[0].length;break;case"named-range":_=vn(z[0],!1),Mt=vy(_["cell-range-address"]);var Yt={Name:_.name,Ref:Mt[0]+"!"+Mt[1]};bt&&(Yt.Sheet=j.length),$t.Names.push(Yt);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(p[p.length-1][0])>-1)break;if(z[1]==="/"&&(!Z||!Z["string-value"])){var jr=nD(f.slice(W,z.index));Y=(Y.length>0?Y+`
`:"")+jr[0]}else vn(z[0],!1),W=z.index+z[0].length;break;case"s":break;case"database-range":if(z[1]==="/")break;try{Mt=vy(vn(z[0])["target-range-address"]),U[Mt[0]]["!autofilter"]={ref:Mt[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(z[1]!=="/"){if(Be=vn(z[0],!1),!Be.href)break;Be.Target=ma(Be.href),delete Be.href,Be.Target.charAt(0)=="#"&&Be.Target.indexOf(".")>-1?(Mt=vy(Be.Target.slice(1)),Be.Target="#"+Mt[0]+"!"+Mt[1]):Be.Target.match(/^\.\.[\\\/]/)&&(Be.Target=Be.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(z[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(l.WTF)throw new Error(z)}}var Qe={Sheets:U,SheetNames:j,Workbook:$t};return l.bookSheets&&delete Qe.Sheets,Qe}function nb(r,u){u=u||{},su(r,"META-INF/manifest.xml")&&yA(gs(r,"META-INF/manifest.xml"),u);var l=Rc(r,"content.xml");if(!l)throw new Error("Missing content.xml in ODS / UOF file");var f=xw(si(l),u);return su(r,"meta.xml")&&(f.Props=R2(gs(r,"meta.xml"))),f}function ab(r,u){return xw(r,u)}function w1(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function Uy(r){return typeof TextDecoder<"u"?new TextDecoder().decode(r):si(Mp(r))}function Vy(r){var u=r.reduce(function(p,b){return p+b.length},0),l=new Uint8Array(u),f=0;return r.forEach(function(p){l.set(p,f),f+=p.length}),l}function ib(r){return r-=r>>1&1431655765,r=(r&858993459)+(r>>2&858993459),(r+(r>>4)&252645135)*16843009>>>24}function aD(r,u){for(var l=(r[u+15]&127)<<7|r[u+14]>>1,f=r[u+14]&1,p=u+13;p>=u;--p)f=f*256+r[p];return(r[u+15]&128?-f:f)*Math.pow(10,l-6176)}function Bg(r,u){var l=u?u[0]:0,f=r[l]&127;e:if(r[l++]>=128&&(f|=(r[l]&127)<<7,r[l++]<128||(f|=(r[l]&127)<<14,r[l++]<128)||(f|=(r[l]&127)<<21,r[l++]<128)||(f+=(r[l]&127)*Math.pow(2,28),++l,r[l++]<128)||(f+=(r[l]&127)*Math.pow(2,35),++l,r[l++]<128)||(f+=(r[l]&127)*Math.pow(2,42),++l,r[l++]<128)))break e;return u&&(u[0]=l),f}function Cs(r){var u=0,l=r[u]&127;e:if(r[u++]>=128){if(l|=(r[u]&127)<<7,r[u++]<128||(l|=(r[u]&127)<<14,r[u++]<128)||(l|=(r[u]&127)<<21,r[u++]<128))break e;l|=(r[u]&127)<<28}return l}function Go(r){for(var u=[],l=[0];l[0]<r.length;){var f=l[0],p=Bg(r,l),b=p&7;p=Math.floor(p/8);var _=0,s;if(p==0)break;switch(b){case 0:{for(var C=l[0];r[l[0]++]>=128;);s=r.slice(C,l[0])}break;case 5:_=4,s=r.slice(l[0],l[0]+_),l[0]+=_;break;case 1:_=8,s=r.slice(l[0],l[0]+_),l[0]+=_;break;case 2:_=Bg(r,l),s=r.slice(l[0],l[0]+_),l[0]+=_;break;default:throw new Error("PB Type ".concat(b," for Field ").concat(p," at offset ").concat(f))}var M={data:s,type:b};u[p]==null?u[p]=[M]:u[p].push(M)}return u}function T1(r,u){return r?.map(function(l){return u(l.data)})||[]}function iD(r){for(var u,l=[],f=[0];f[0]<r.length;){var p=Bg(r,f),b=Go(r.slice(f[0],f[0]+p));f[0]+=p;var _={id:Cs(b[1][0].data),messages:[]};b[2].forEach(function(s){var C=Go(s.data),M=Cs(C[3][0].data);_.messages.push({meta:C,data:r.slice(f[0],f[0]+M)}),f[0]+=M}),(u=b[3])!=null&&u[0]&&(_.merge=Cs(b[3][0].data)>>>0>0),l.push(_)}return l}function sD(r,u){if(r!=0)throw new Error("Unexpected Snappy chunk type ".concat(r));for(var l=[0],f=Bg(u,l),p=[];l[0]<u.length;){var b=u[l[0]]&3;if(b==0){var _=u[l[0]++]>>2;if(_<60)++_;else{var s=_-59;_=u[l[0]],s>1&&(_|=u[l[0]+1]<<8),s>2&&(_|=u[l[0]+2]<<16),s>3&&(_|=u[l[0]+3]<<24),_>>>=0,_++,l[0]+=s}p.push(u.slice(l[0],l[0]+_)),l[0]+=_;continue}else{var C=0,M=0;if(b==1?(M=(u[l[0]]>>2&7)+4,C=(u[l[0]++]&224)<<3,C|=u[l[0]++]):(M=(u[l[0]++]>>2)+1,b==2?(C=u[l[0]]|u[l[0]+1]<<8,l[0]+=2):(C=(u[l[0]]|u[l[0]+1]<<8|u[l[0]+2]<<16|u[l[0]+3]<<24)>>>0,l[0]+=4)),p=[Vy(p)],C==0)throw new Error("Invalid offset 0");if(C>p[0].length)throw new Error("Invalid offset beyond length");if(M>=C)for(p.push(p[0].slice(-C)),M-=C;M>=p[p.length-1].length;)p.push(p[p.length-1]),M-=p[p.length-1].length;p.push(p[0].slice(-C,-C+M))}}var D=Vy(p);if(D.length!=f)throw new Error("Unexpected length: ".concat(D.length," != ").concat(f));return D}function oD(r){for(var u=[],l=0;l<r.length;){var f=r[l++],p=r[l]|r[l+1]<<8|r[l+2]<<16;l+=3,u.push(sD(f,r.slice(l,l+p))),l+=p}if(l!==r.length)throw new Error("data is not a valid framed stream!");return Vy(u)}function lD(r,u,l,f){var p=w1(r),b=p.getUint32(4,!0),_=(f>1?12:8)+ib(b&(f>1?3470:398))*4,s=-1,C=-1,M=NaN,D=new Date(2001,0,1);b&512&&(s=p.getUint32(_,!0),_+=4),_+=ib(b&(f>1?12288:4096))*4,b&16&&(C=p.getUint32(_,!0),_+=4),b&32&&(M=p.getFloat64(_,!0),_+=8),b&64&&(D.setTime(D.getTime()+p.getFloat64(_,!0)*1e3),_+=8);var B;switch(r[2]){case 0:break;case 2:B={t:"n",v:M};break;case 3:B={t:"s",v:u[C]};break;case 5:B={t:"d",v:D};break;case 6:B={t:"b",v:M>0};break;case 7:B={t:"n",v:M/86400};break;case 8:B={t:"e",v:0};break;case 9:if(s>-1)B={t:"s",v:l[s]};else if(C>-1)B={t:"s",v:u[C]};else if(!isNaN(M))B={t:"n",v:M};else throw new Error("Unsupported cell type ".concat(r.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(r.slice(0,4)))}return B}function cD(r,u,l){var f=w1(r),p=f.getUint32(8,!0),b=12,_=-1,s=-1,C=NaN,M=NaN,D=new Date(2001,0,1);p&1&&(C=aD(r,b),b+=16),p&2&&(M=f.getFloat64(b,!0),b+=8),p&4&&(D.setTime(D.getTime()+f.getFloat64(b,!0)*1e3),b+=8),p&8&&(s=f.getUint32(b,!0),b+=4),p&16&&(_=f.getUint32(b,!0),b+=4);var B;switch(r[1]){case 0:break;case 2:B={t:"n",v:C};break;case 3:B={t:"s",v:u[s]};break;case 5:B={t:"d",v:D};break;case 6:B={t:"b",v:M>0};break;case 7:B={t:"n",v:M/86400};break;case 8:B={t:"e",v:0};break;case 9:if(_>-1)B={t:"s",v:l[_]};else throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(p&31," : ").concat(r.slice(0,4)));break;case 10:B={t:"n",v:C};break;default:throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(p&31," : ").concat(r.slice(0,4)))}return B}function uD(r,u,l){switch(r[0]){case 0:case 1:case 2:case 3:return lD(r,u,l,r[0]);case 5:return cD(r,u,l);default:throw new Error("Unsupported payload version ".concat(r[0]))}}function wd(r){var u=Go(r);return Bg(u[1][0].data)}function sb(r,u){var l=Go(u.data),f=Cs(l[1][0].data),p=l[3],b=[];return(p||[]).forEach(function(_){var s=Go(_.data),C=Cs(s[1][0].data)>>>0;switch(f){case 1:b[C]=Uy(s[3][0].data);break;case 8:{var M=r[wd(s[9][0].data)][0],D=Go(M.data),B=r[wd(D[1][0].data)][0],U=Cs(B.meta[1][0].data);if(U!=2001)throw new Error("2000 unexpected reference to ".concat(U));var j=Go(B.data);b[C]=j[3].map(function(H){return Uy(H.data)}).join("")}break}}),b}function hD(r,u){var l,f,p,b,_,s,C,M,D,B,U,j,H,z,N=Go(r),Z=Cs(N[1][0].data)>>>0,Y=Cs(N[2][0].data)>>>0,W=((f=(l=N[8])==null?void 0:l[0])==null?void 0:f.data)&&Cs(N[8][0].data)>0||!1,de,ge;if((b=(p=N[7])==null?void 0:p[0])!=null&&b.data&&u!=0)de=(s=(_=N[7])==null?void 0:_[0])==null?void 0:s.data,ge=(M=(C=N[6])==null?void 0:C[0])==null?void 0:M.data;else if((B=(D=N[4])==null?void 0:D[0])!=null&&B.data&&u!=1)de=(j=(U=N[4])==null?void 0:U[0])==null?void 0:j.data,ge=(z=(H=N[3])==null?void 0:H[0])==null?void 0:z.data;else throw"NUMBERS Tile missing ".concat(u," cell storage");for(var ve=W?4:1,ie=w1(de),Me=[],we=0;we<de.length/2;++we){var Ge=ie.getUint16(we*2,!0);Ge<65535&&Me.push([we,Ge])}if(Me.length!=Y)throw"Expected ".concat(Y," cells, found ").concat(Me.length);var et=[];for(we=0;we<Me.length-1;++we)et[Me[we][0]]=ge.subarray(Me[we][1]*ve,Me[we+1][1]*ve);return Me.length>=1&&(et[Me[Me.length-1][0]]=ge.subarray(Me[Me.length-1][1]*ve)),{R:Z,cells:et}}function fD(r,u){var l,f=Go(u.data),p=(l=f?.[7])!=null&&l[0]?Cs(f[7][0].data)>>>0>0?1:0:-1,b=T1(f[5],function(_){return hD(_,p)});return{nrows:Cs(f[4][0].data)>>>0,data:b.reduce(function(_,s){return _[s.R]||(_[s.R]=[]),s.cells.forEach(function(C,M){if(_[s.R][M])throw new Error("Duplicate cell r=".concat(s.R," c=").concat(M));_[s.R][M]=C}),_},[])}}function dD(r,u,l){var f,p=Go(u.data),b={s:{r:0,c:0},e:{r:0,c:0}};if(b.e.r=(Cs(p[6][0].data)>>>0)-1,b.e.r<0)throw new Error("Invalid row varint ".concat(p[6][0].data));if(b.e.c=(Cs(p[7][0].data)>>>0)-1,b.e.c<0)throw new Error("Invalid col varint ".concat(p[7][0].data));l["!ref"]=oa(b);var _=Go(p[4][0].data),s=sb(r,r[wd(_[4][0].data)][0]),C=(f=_[17])!=null&&f[0]?sb(r,r[wd(_[17][0].data)][0]):[],M=Go(_[3][0].data),D=0;M[1].forEach(function(B){var U=Go(B.data),j=r[wd(U[2][0].data)][0],H=Cs(j.meta[1][0].data);if(H!=6002)throw new Error("6001 unexpected reference to ".concat(H));var z=fD(r,j);z.data.forEach(function(N,Z){N.forEach(function(Y,W){var de=kn({r:D+Z,c:W}),ge=uD(Y,s,C);ge&&(l[de]=ge)})}),D+=z.nrows})}function pD(r,u){var l=Go(u.data),f={"!ref":"A1"},p=r[wd(l[2][0].data)],b=Cs(p[0].meta[1][0].data);if(b!=6001)throw new Error("6000 unexpected reference to ".concat(b));return dD(r,p[0],f),f}function mD(r,u){var l,f=Go(u.data),p={name:(l=f[1])!=null&&l[0]?Uy(f[1][0].data):"",sheets:[]},b=T1(f[2],wd);return b.forEach(function(_){r[_].forEach(function(s){var C=Cs(s.meta[1][0].data);C==6e3&&p.sheets.push(pD(r,s))})}),p}function gD(r,u){var l=A1(),f=Go(u.data),p=T1(f[1],wd);if(p.forEach(function(b){r[b].forEach(function(_){var s=Cs(_.meta[1][0].data);if(s==2){var C=mD(r,_);C.sheets.forEach(function(M,D){k1(l,M,D==0?C.name:C.name+"_"+D,!0)})}})}),l.SheetNames.length==0)throw new Error("Empty NUMBERS file");return l}function wy(r){var u,l,f,p,b={},_=[];if(r.FullPaths.forEach(function(C){if(C.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),r.FileIndex.forEach(function(C){if(C.name.match(/\.iwa$/)){var M;try{M=oD(C.content)}catch(B){return console.log("?? "+C.content.length+" "+(B.message||B))}var D;try{D=iD(M)}catch(B){return console.log("## "+(B.message||B))}D.forEach(function(B){b[B.id]=B.messages,_.push(B.id)})}}),!_.length)throw new Error("File has no messages");var s=((p=(f=(l=(u=b?.[1])==null?void 0:u[0])==null?void 0:l.meta)==null?void 0:f[1])==null?void 0:p[0].data)&&Cs(b[1][0].meta[1][0].data)==1&&b[1][0];if(s||_.forEach(function(C){b[C].forEach(function(M){var D=Cs(M.meta[1][0].data)>>>0;if(D==1)if(!s)s=M;else throw new Error("Document has multiple roots")})}),!s)throw new Error("Cannot find Document root");return gD(b,s)}function _D(r){return function(l){for(var f=0;f!=r.length;++f){var p=r[f];l[p[0]]===void 0&&(l[p[0]]=p[1]),p[2]==="n"&&(l[p[0]]=Number(l[p[0]]))}}}function S1(r){_D([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(r)}function xD(r){return G0.WS.indexOf(r)>-1?"sheet":r==G0.CS?"chart":r==G0.DS?"dialog":r==G0.MS?"macro":r&&r.length?r:"sheet"}function yD(r,u){if(!r)return 0;try{r=u.map(function(f){return f.id||(f.id=f.strRelID),[f.name,r["!id"][f.id].Target,xD(r["!id"][f.id].Type)]})}catch{return null}return!r||r.length===0?null:r}function vD(r,u,l,f,p,b,_,s,C,M,D,B){try{b[f]=Sg(Rc(r,l,!0),u);var U=gs(r,u),j;switch(s){case"sheet":j=A4(U,u,p,C,b[f],M,D,B);break;case"chart":if(j=k4(U,u,p,C,b[f],M,D,B),!j||!j["!drawel"])break;var H=gg(j["!drawel"].Target,u),z=zy(H),N=E5(Rc(r,H,!0),Sg(Rc(r,z,!0),H)),Z=gg(N,H),Y=zy(Z);j=c4(Rc(r,Z,!0),Z,C,Sg(Rc(r,Y,!0),Z),M,j);break;case"macro":j=C4(U,u,p,C,b[f],M,D,B);break;case"dialog":j=M4(U,u,p,C,b[f],M,D,B);break;default:throw new Error("Unrecognized sheet type "+s)}_[f]=j;var W=[];b&&b[f]&&Gh(b[f]).forEach(function(de){var ge="";if(b[f][de].Type==G0.CMNT){ge=gg(b[f][de].Target,u);var ve=P4(gs(r,ge,!0),ge,C);if(!ve||!ve.length)return;qv(j,ve,!1)}b[f][de].Type==G0.TCMNT&&(ge=gg(b[f][de].Target,u),W=W.concat(k5(gs(r,ge,!0),C)))}),W&&W.length&&qv(j,W,!0,C.people||[])}catch(de){if(C.WTF)throw de}}function au(r){return r.charAt(0)=="/"?r.slice(1):r}function bD(r,u){if(r2(),u=u||{},S1(u),su(r,"META-INF/manifest.xml")||su(r,"objectdata.xml"))return nb(r,u);if(su(r,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof wy<"u"){if(r.FileIndex)return wy(r);var l=sa.utils.cfb_new();return xv(r).forEach(function(le){wE(l,le,bE(r,le))}),wy(l)}throw new Error("Unsupported NUMBERS file")}if(!su(r,"[Content_Types].xml"))throw su(r,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):su(r,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var f=xv(r),p=_A(Rc(r,"[Content_Types].xml")),b=!1,_,s;if(p.workbooks.length===0&&(s="xl/workbook.xml",gs(r,s,!0)&&p.workbooks.push(s)),p.workbooks.length===0){if(s="xl/workbook.bin",!gs(r,s,!0))throw new Error("Could not find workbook");p.workbooks.push(s),b=!0}p.workbooks[0].slice(-3)=="bin"&&(b=!0);var C={},M={};if(!u.bookSheets&&!u.bookProps){if(kg=[],p.sst)try{kg=I4(gs(r,au(p.sst)),p.sst,u)}catch(le){if(u.WTF)throw le}u.cellStyles&&p.themes.length&&(C=R4(Rc(r,p.themes[0].replace(/^\//,""),!0)||"",p.themes[0],u)),p.style&&(M=D4(gs(r,au(p.style)),p.style,C,u))}p.links.map(function(le){try{var ut=Sg(Rc(r,zy(au(le))),le);return L4(gs(r,au(le)),ut,le,u)}catch{}});var D=E4(gs(r,au(p.workbooks[0])),p.workbooks[0],u),B={},U="";p.coreprops.length&&(U=gs(r,au(p.coreprops[0]),!0),U&&(B=R2(U)),p.extprops.length!==0&&(U=gs(r,au(p.extprops[0]),!0),U&&wA(U,B,u)));var j={};(!u.bookSheets||u.bookProps)&&p.custprops.length!==0&&(U=Rc(r,au(p.custprops[0]),!0),U&&(j=SA(U,u)));var H={};if((u.bookSheets||u.bookProps)&&(D.Sheets?_=D.Sheets.map(function(ut){return ut.name}):B.Worksheets&&B.SheetNames.length>0&&(_=B.SheetNames),u.bookProps&&(H.Props=B,H.Custprops=j),u.bookSheets&&typeof _<"u"&&(H.SheetNames=_),u.bookSheets?H.SheetNames:u.bookProps))return H;_={};var z={};u.bookDeps&&p.calcchain&&(z=F4(gs(r,au(p.calcchain)),p.calcchain));var N=0,Z={},Y,W;{var de=D.Sheets;B.Worksheets=de.length,B.SheetNames=[];for(var ge=0;ge!=de.length;++ge)B.SheetNames[ge]=de[ge].name}var ve=b?"bin":"xml",ie=p.workbooks[0].lastIndexOf("/"),Me=(p.workbooks[0].slice(0,ie+1)+"_rels/"+p.workbooks[0].slice(ie+1)+".rels").replace(/^\//,"");su(r,Me)||(Me="xl/_rels/workbook."+ve+".rels");var we=Sg(Rc(r,Me,!0),Me.replace(/_rels.*/,"s5s"));(p.metadata||[]).length>=1&&(u.xlmeta=z4(gs(r,au(p.metadata[0])),p.metadata[0],u)),(p.people||[]).length>=1&&(u.people=C5(gs(r,au(p.people[0])),u)),we&&(we=yD(we,D.Sheets));var Ge=gs(r,"xl/worksheets/sheet.xml",!0)?1:0;e:for(N=0;N!=B.Worksheets;++N){var et="sheet";if(we&&we[N]?(Y="xl/"+we[N][1].replace(/[\/]?xl\//,""),su(r,Y)||(Y=we[N][1]),su(r,Y)||(Y=Me.replace(/_rels\/.*$/,"")+we[N][1]),et=we[N][2]):(Y="xl/worksheets/sheet"+(N+1-Ge)+"."+ve,Y=Y.replace(/sheet0\./,"sheet.")),W=Y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),u&&u.sheets!=null)switch(typeof u.sheets){case"number":if(N!=u.sheets)continue e;break;case"string":if(B.SheetNames[N].toLowerCase()!=u.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(u.sheets)){for(var pe=!1,Je=0;Je!=u.sheets.length;++Je)typeof u.sheets[Je]=="number"&&u.sheets[Je]==N&&(pe=1),typeof u.sheets[Je]=="string"&&u.sheets[Je].toLowerCase()==B.SheetNames[N].toLowerCase()&&(pe=1);if(!pe)continue e}}vD(r,Y,W,B.SheetNames[N],N,Z,_,et,u,D,C,M)}return H={Directory:p,Workbook:D,Props:B,Custprops:j,Deps:z,Sheets:_,SheetNames:B.SheetNames,Strings:kg,Styles:M,Themes:C,SSF:go(Pn)},u&&u.bookFiles&&(r.files?(H.keys=f,H.files=r.files):(H.keys=[],H.files={},r.FullPaths.forEach(function(le,ut){le=le.replace(/^Root Entry[\/]/,""),H.keys.push(le),H.files[le]=r.FileIndex[ut]}))),u&&u.bookVBA&&(p.vba.length>0?H.vbaraw=gs(r,au(p.vba[0]),!0):p.defaults&&p.defaults.bin===I5&&(H.vbaraw=gs(r,"xl/vbaProject.bin",!0))),H}function wD(r,u){var l=u||{},f="Workbook",p=sa.find(r,f);try{if(f="/!DataSpaces/Version",p=sa.find(r,f),!p||!p.content)throw new Error("ECMA-376 Encrypted file missing "+f);if(pC(p.content),f="/!DataSpaces/DataSpaceMap",p=sa.find(r,f),!p||!p.content)throw new Error("ECMA-376 Encrypted file missing "+f);var b=gC(p.content);if(b.length!==1||b[0].comps.length!==1||b[0].comps[0].t!==0||b[0].name!=="StrongEncryptionDataSpace"||b[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+f);if(f="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",p=sa.find(r,f),!p||!p.content)throw new Error("ECMA-376 Encrypted file missing "+f);var _=_C(p.content);if(_.length!=1||_[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+f);if(f="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",p=sa.find(r,f),!p||!p.content)throw new Error("ECMA-376 Encrypted file missing "+f);yC(p.content)}catch{}if(f="/EncryptionInfo",p=sa.find(r,f),!p||!p.content)throw new Error("ECMA-376 Encrypted file missing "+f);var s=vC(p.content);if(f="/EncryptedPackage",p=sa.find(r,f),!p||!p.content)throw new Error("ECMA-376 Encrypted file missing "+f);if(s[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(s[1],p.content,l.password||"",l);if(s[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(s[1],p.content,l.password||"",l);throw new Error("File is password-protected")}function E1(r,u){var l="";switch((u||{}).type||"base64"){case"buffer":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];case"base64":l=Ic(r.slice(0,12));break;case"binary":l=r;break;case"array":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];default:throw new Error("Unrecognized type "+(u&&u.type||"undefined"))}return[l.charCodeAt(0),l.charCodeAt(1),l.charCodeAt(2),l.charCodeAt(3),l.charCodeAt(4),l.charCodeAt(5),l.charCodeAt(6),l.charCodeAt(7)]}function TD(r,u){return sa.find(r,"EncryptedPackage")?wD(r,u):mw(r,u)}function SD(r,u){var l,f=r,p=u||{};return p.type||(p.type=ta&&Buffer.isBuffer(r)?"buffer":"base64"),l=l2(f,p),bD(l,p)}function yw(r,u){var l=0;e:for(;l<r.length;)switch(r.charCodeAt(l)){case 10:case 13:case 32:++l;break;case 60:return Ny(r.slice(l),u);default:break e}return Lg.to_workbook(r,u)}function ED(r,u){var l="",f=E1(r,u);switch(u.type){case"base64":l=Ic(r);break;case"binary":l=r;break;case"buffer":l=r.toString("binary");break;case"array":l=Ep(r);break;default:throw new Error("Unrecognized type "+u.type)}return f[0]==239&&f[1]==187&&f[2]==191&&(l=si(l)),u.type="binary",yw(l,u)}function AD(r,u){var l=r;return u.type=="base64"&&(l=Ic(l)),l=Rg.utils.decode(1200,l.slice(2),"str"),u.type="binary",yw(l,u)}function kD(r){return r.match(/[^\x00-\x7F]/)?_g(r):r}function Ty(r,u,l,f){return f?(l.type="string",Lg.to_workbook(r,l)):Lg.to_workbook(u,l)}function Gy(r,u){Hb();var l=u||{};if(typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer)return Gy(new Uint8Array(r),(l=go(l),l.type="array",l));typeof Uint8Array<"u"&&r instanceof Uint8Array&&!l.type&&(l.type=typeof Deno<"u"?"buffer":"array");var f=r,p=[0,0,0,0],b=!1;if(l.cellStyles&&(l.cellNF=!0,l.sheetStubs=!0),W0={},l.dateNF&&(W0.dateNF=l.dateNF),l.type||(l.type=ta&&Buffer.isBuffer(r)?"buffer":"base64"),l.type=="file"&&(l.type=ta?"buffer":"binary",f=pE(r),typeof Uint8Array<"u"&&!ta&&(l.type="array")),l.type=="string"&&(b=!0,l.type="binary",l.codepage=65001,f=kD(r)),l.type=="array"&&typeof Uint8Array<"u"&&r instanceof Uint8Array&&typeof ArrayBuffer<"u"){var _=new ArrayBuffer(3),s=new Uint8Array(_);if(s.foo="bar",!s.foo)return l=go(l),l.type="array",Gy(n1(f),l)}switch((p=E1(f,l))[0]){case 208:if(p[1]===207&&p[2]===17&&p[3]===224&&p[4]===161&&p[5]===177&&p[6]===26&&p[7]===225)return TD(sa.read(f,l),l);break;case 9:if(p[1]<=8)return mw(f,l);break;case 60:return Ny(f,l);case 73:if(p[1]===73&&p[2]===42&&p[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(p[1]===68)return tC(f,l);break;case 84:if(p[1]===65&&p[2]===66&&p[3]===76)return Qk.to_workbook(f,l);break;case 80:return p[1]===75&&p[2]<9&&p[3]<9?SD(f,l):Ty(r,f,l,b);case 239:return p[3]===60?Ny(f,l):Ty(r,f,l,b);case 255:if(p[1]===254)return AD(f,l);if(p[1]===0&&p[2]===2&&p[3]===0)return Ag.to_workbook(f,l);break;case 0:if(p[1]===0&&(p[2]>=2&&p[3]===0||p[2]===0&&(p[3]===8||p[3]===9)))return Ag.to_workbook(f,l);break;case 3:case 131:case 139:case 140:return Hv.to_workbook(f,l);case 123:if(p[1]===92&&p[2]===114&&p[3]===116)return IC.to_workbook(f,l);break;case 10:case 13:case 32:return ED(f,l);case 137:if(p[1]===80&&p[2]===78&&p[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Kk.indexOf(p[0])>-1&&p[2]<=12&&p[3]<=31?Hv.to_workbook(f,l):Ty(r,f,l,b)}function CD(r,u,l,f,p,b,_,s){var C=_o(l),M=s.defval,D=s.raw||!Object.prototype.hasOwnProperty.call(s,"raw"),B=!0,U=p===1?[]:{};if(p!==1)if(Object.defineProperty)try{Object.defineProperty(U,"__rowNum__",{value:l,enumerable:!1})}catch{U.__rowNum__=l}else U.__rowNum__=l;if(!_||r[l])for(var j=u.s.c;j<=u.e.c;++j){var H=_?r[l][j]:r[f[j]+C];if(H===void 0||H.t===void 0){if(M===void 0)continue;b[j]!=null&&(U[b[j]]=M);continue}var z=H.v;switch(H.t){case"z":if(z==null)break;continue;case"e":z=z==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+H.t)}if(b[j]!=null){if(z==null)if(H.t=="e"&&z===null)U[b[j]]=null;else if(M!==void 0)U[b[j]]=M;else if(D&&z===null)U[b[j]]=null;else continue;else U[b[j]]=D&&(H.t!=="n"||H.t==="n"&&s.rawNumbers!==!1)?z:Df(H,z,s);z!=null&&(B=!1)}}return{row:U,isempty:B}}function Hy(r,u){if(r==null||r["!ref"]==null)return[];var l={t:"n",v:0},f=0,p=1,b=[],_=0,s="",C={s:{r:0,c:0},e:{r:0,c:0}},M=u||{},D=M.range!=null?M.range:r["!ref"];switch(M.header===1?f=1:M.header==="A"?f=2:Array.isArray(M.header)?f=3:M.header==null&&(f=0),typeof D){case"string":C=Xi(D);break;case"number":C=Xi(r["!ref"]),C.s.r=D;break;default:C=D}f>0&&(p=0);var B=_o(C.s.r),U=[],j=[],H=0,z=0,N=Array.isArray(r),Z=C.s.r,Y=0,W={};N&&!r[Z]&&(r[Z]=[]);var de=M.skipHidden&&r["!cols"]||[],ge=M.skipHidden&&r["!rows"]||[];for(Y=C.s.c;Y<=C.e.c;++Y)if(!(de[Y]||{}).hidden)switch(U[Y]=ks(Y),l=N?r[Z][Y]:r[U[Y]+B],f){case 1:b[Y]=Y-C.s.c;break;case 2:b[Y]=U[Y];break;case 3:b[Y]=M.header[Y-C.s.c];break;default:if(l==null&&(l={w:"__EMPTY",t:"s"}),s=_=Df(l,null,M),z=W[_]||0,!z)W[_]=1;else{do s=_+"_"+z++;while(W[s]);W[_]=z,W[s]=1}b[Y]=s}for(Z=C.s.r+p;Z<=C.e.r;++Z)if(!(ge[Z]||{}).hidden){var ve=CD(r,C,Z,U,f,b,N,M);(ve.isempty===!1||(f===1?M.blankrows!==!1:M.blankrows))&&(j[H++]=ve.row)}return j.length=H,j}var ob=/"/g;function MD(r,u,l,f,p,b,_,s){for(var C=!0,M=[],D="",B=_o(l),U=u.s.c;U<=u.e.c;++U)if(f[U]){var j=s.dense?(r[l]||[])[U]:r[f[U]+B];if(j==null)D="";else if(j.v!=null){C=!1,D=""+(s.rawNumbers&&j.t=="n"?j.v:Df(j,null,s));for(var H=0,z=0;H!==D.length;++H)if((z=D.charCodeAt(H))===p||z===b||z===34||s.forceQuotes){D='"'+D.replace(ob,'""')+'"';break}D=="ID"&&(D='"ID"')}else j.f!=null&&!j.F?(C=!1,D="="+j.f,D.indexOf(",")>=0&&(D='"'+D.replace(ob,'""')+'"')):D="";M.push(D)}return s.blankrows===!1&&C?null:M.join(_)}function vw(r,u){var l=[],f=u??{};if(r==null||r["!ref"]==null)return"";var p=Xi(r["!ref"]),b=f.FS!==void 0?f.FS:",",_=b.charCodeAt(0),s=f.RS!==void 0?f.RS:`
`,C=s.charCodeAt(0),M=new RegExp((b=="|"?"\\|":b)+"+$"),D="",B=[];f.dense=Array.isArray(r);for(var U=f.skipHidden&&r["!cols"]||[],j=f.skipHidden&&r["!rows"]||[],H=p.s.c;H<=p.e.c;++H)(U[H]||{}).hidden||(B[H]=ks(H));for(var z=0,N=p.s.r;N<=p.e.r;++N)(j[N]||{}).hidden||(D=MD(r,p,N,B,_,C,b,f),D!=null&&(f.strip&&(D=D.replace(M,"")),(D||f.blankrows!==!1)&&l.push((z++?s:"")+D)));return delete f.dense,l.join("")}function DD(r,u){u||(u={}),u.FS="	",u.RS=`
`;var l=vw(r,u);return l}function RD(r){var u="",l,f="";if(r==null||r["!ref"]==null)return[];var p=Xi(r["!ref"]),b="",_=[],s,C=[],M=Array.isArray(r);for(s=p.s.c;s<=p.e.c;++s)_[s]=ks(s);for(var D=p.s.r;D<=p.e.r;++D)for(b=_o(D),s=p.s.c;s<=p.e.c;++s)if(u=_[s]+b,l=M?(r[D]||[])[s]:r[u],f="",l!==void 0){if(l.F!=null){if(u=l.F,!l.f)continue;f=l.f,u.indexOf(":")==-1&&(u=u+":"+u)}if(l.f!=null)f=l.f;else{if(l.t=="z")continue;if(l.t=="n"&&l.v!=null)f=""+l.v;else if(l.t=="b")f=l.v?"TRUE":"FALSE";else if(l.w!==void 0)f="'"+l.w;else{if(l.v===void 0)continue;l.t=="s"?f="'"+l.v:f=""+l.v}}C[C.length]=u+"="+f}return C}function bw(r,u,l){var f=l||{},p=+!f.skipHeader,b=r||{},_=0,s=0;if(b&&f.origin!=null)if(typeof f.origin=="number")_=f.origin;else{var C=typeof f.origin=="string"?bl(f.origin):f.origin;_=C.r,s=C.c}var M,D={s:{c:0,r:0},e:{c:s,r:_+u.length-1+p}};if(b["!ref"]){var B=Xi(b["!ref"]);D.e.c=Math.max(D.e.c,B.e.c),D.e.r=Math.max(D.e.r,B.e.r),_==-1&&(_=B.e.r+1,D.e.r=_+u.length-1+p)}else _==-1&&(_=0,D.e.r=u.length-1+p);var U=f.header||[],j=0;u.forEach(function(z,N){Gh(z).forEach(function(Z){(j=U.indexOf(Z))==-1&&(U[j=U.length]=Z);var Y=z[Z],W="z",de="",ge=kn({c:s+j,r:_+N+p});M=Ng(b,ge),Y&&typeof Y=="object"&&!(Y instanceof Date)?b[ge]=Y:(typeof Y=="number"?W="n":typeof Y=="boolean"?W="b":typeof Y=="string"?W="s":Y instanceof Date?(W="d",f.cellDates||(W="n",Y=Tl(Y)),de=f.dateNF||Pn[14]):Y===null&&f.nullError&&(W="e",Y=0),M?(M.t=W,M.v=Y,delete M.w,delete M.R,de&&(M.z=de)):b[ge]=M={t:W,v:Y},de&&(M.z=de))})}),D.e.c=Math.max(D.e.c,s+U.length-1);var H=_o(_);if(p)for(j=0;j<U.length;++j)b[ks(j+s)+H]={t:"s",v:U[j]};return b["!ref"]=oa(D),b}function ID(r,u){return bw(null,r,u)}function Ng(r,u,l){if(typeof u=="string"){if(Array.isArray(r)){var f=bl(u);return r[f.r]||(r[f.r]=[]),r[f.r][f.c]||(r[f.r][f.c]={t:"z"})}return r[u]||(r[u]={t:"z"})}return typeof u!="number"?Ng(r,kn(u)):Ng(r,kn({r:u,c:l||0}))}function PD(r,u){if(typeof u=="number"){if(u>=0&&r.SheetNames.length>u)return u;throw new Error("Cannot find sheet # "+u)}else if(typeof u=="string"){var l=r.SheetNames.indexOf(u);if(l>-1)return l;throw new Error("Cannot find sheet name |"+u+"|")}else throw new Error("Cannot find sheet |"+u+"|")}function A1(){return{SheetNames:[],Sheets:{}}}function k1(r,u,l,f){var p=1;if(!l)for(;p<=65535&&r.SheetNames.indexOf(l="Sheet"+p)!=-1;++p,l=void 0);if(!l||r.SheetNames.length>=65535)throw new Error("Too many worksheets");if(f&&r.SheetNames.indexOf(l)>=0){var b=l.match(/(^.*?)(\d+)$/);p=b&&+b[2]||0;var _=b&&b[1]||l;for(++p;p<=65535&&r.SheetNames.indexOf(l=_+p)!=-1;++p);}if(_4(l),r.SheetNames.indexOf(l)>=0)throw new Error("Worksheet with name |"+l+"| already exists!");return r.SheetNames.push(l),r.Sheets[l]=u,l}function FD(r,u,l){r.Workbook||(r.Workbook={}),r.Workbook.Sheets||(r.Workbook.Sheets=[]);var f=PD(r,u);switch(r.Workbook.Sheets[f]||(r.Workbook.Sheets[f]={}),l){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+l)}r.Workbook.Sheets[f].Hidden=l}function LD(r,u){return r.z=u,r}function ww(r,u,l){return u?(r.l={Target:u},l&&(r.l.Tooltip=l)):delete r.l,r}function zD(r,u,l){return ww(r,"#"+u,l)}function OD(r,u,l){r.c||(r.c=[]),r.c.push({t:u,a:l||"SheetJS"})}function BD(r,u,l,f){for(var p=typeof u!="string"?u:Xi(u),b=typeof u=="string"?u:oa(u),_=p.s.r;_<=p.e.r;++_)for(var s=p.s.c;s<=p.e.c;++s){var C=Ng(r,_,s);C.t="n",C.F=b,delete C.v,_==p.s.r&&s==p.s.c&&(C.f=l,f&&(C.D=!0))}return r}var lb={encode_col:ks,encode_row:_o,encode_cell:kn,encode_range:oa,decode_col:f1,decode_row:h1,split_cell:YE,decode_cell:bl,decode_range:rm,format_cell:Df,sheet_add_aoa:A2,sheet_add_json:bw,sheet_add_dom:gw,aoa_to_sheet:nm,json_to_sheet:ID,table_to_sheet:_w,table_to_book:tD,sheet_to_csv:vw,sheet_to_txt:DD,sheet_to_json:Hy,sheet_to_html:eD,sheet_to_formulae:RD,sheet_to_row_object_array:Hy,sheet_get_cell:Ng,book_new:A1,book_append_sheet:k1,book_set_sheet_visibility:FD,cell_set_number_format:LD,cell_set_hyperlink:ww,cell_set_internal_link:zD,cell_add_comment:OD,sheet_set_array_formula:BD,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function sx(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Sy={exports:{}};var cb;function ND(){return cb||(cb=1,(function(r,u){(function(l){r.exports=l()})(function(){return(function l(f,p,b){function _(M,D){if(!p[M]){if(!f[M]){var B=typeof sx=="function"&&sx;if(!D&&B)return B(M,!0);if(s)return s(M,!0);var U=new Error("Cannot find module '"+M+"'");throw U.code="MODULE_NOT_FOUND",U}var j=p[M]={exports:{}};f[M][0].call(j.exports,function(H){var z=f[M][1][H];return _(z||H)},j,j.exports,l,f,p,b)}return p[M].exports}for(var s=typeof sx=="function"&&sx,C=0;C<b.length;C++)_(b[C]);return _})({1:[function(l,f,p){var b=l("./utils"),_=l("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";p.encode=function(C){for(var M,D,B,U,j,H,z,N=[],Z=0,Y=C.length,W=Y,de=b.getTypeOf(C)!=="string";Z<C.length;)W=Y-Z,B=de?(M=C[Z++],D=Z<Y?C[Z++]:0,Z<Y?C[Z++]:0):(M=C.charCodeAt(Z++),D=Z<Y?C.charCodeAt(Z++):0,Z<Y?C.charCodeAt(Z++):0),U=M>>2,j=(3&M)<<4|D>>4,H=1<W?(15&D)<<2|B>>6:64,z=2<W?63&B:64,N.push(s.charAt(U)+s.charAt(j)+s.charAt(H)+s.charAt(z));return N.join("")},p.decode=function(C){var M,D,B,U,j,H,z=0,N=0,Z="data:";if(C.substr(0,Z.length)===Z)throw new Error("Invalid base64 input, it looks like a data url.");var Y,W=3*(C=C.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(C.charAt(C.length-1)===s.charAt(64)&&W--,C.charAt(C.length-2)===s.charAt(64)&&W--,W%1!=0)throw new Error("Invalid base64 input, bad content length.");for(Y=_.uint8array?new Uint8Array(0|W):new Array(0|W);z<C.length;)M=s.indexOf(C.charAt(z++))<<2|(U=s.indexOf(C.charAt(z++)))>>4,D=(15&U)<<4|(j=s.indexOf(C.charAt(z++)))>>2,B=(3&j)<<6|(H=s.indexOf(C.charAt(z++))),Y[N++]=M,j!==64&&(Y[N++]=D),H!==64&&(Y[N++]=B);return Y}},{"./support":30,"./utils":32}],2:[function(l,f,p){var b=l("./external"),_=l("./stream/DataWorker"),s=l("./stream/Crc32Probe"),C=l("./stream/DataLengthProbe");function M(D,B,U,j,H){this.compressedSize=D,this.uncompressedSize=B,this.crc32=U,this.compression=j,this.compressedContent=H}M.prototype={getContentWorker:function(){var D=new _(b.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new C("data_length")),B=this;return D.on("end",function(){if(this.streamInfo.data_length!==B.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),D},getCompressedWorker:function(){return new _(b.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},M.createWorkerFrom=function(D,B,U){return D.pipe(new s).pipe(new C("uncompressedSize")).pipe(B.compressWorker(U)).pipe(new C("compressedSize")).withStreamInfo("compression",B)},f.exports=M},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(l,f,p){var b=l("./stream/GenericWorker");p.STORE={magic:"\0\0",compressWorker:function(){return new b("STORE compression")},uncompressWorker:function(){return new b("STORE decompression")}},p.DEFLATE=l("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(l,f,p){var b=l("./utils"),_=(function(){for(var s,C=[],M=0;M<256;M++){s=M;for(var D=0;D<8;D++)s=1&s?3988292384^s>>>1:s>>>1;C[M]=s}return C})();f.exports=function(s,C){return s!==void 0&&s.length?b.getTypeOf(s)!=="string"?(function(M,D,B,U){var j=_,H=U+B;M^=-1;for(var z=U;z<H;z++)M=M>>>8^j[255&(M^D[z])];return-1^M})(0|C,s,s.length,0):(function(M,D,B,U){var j=_,H=U+B;M^=-1;for(var z=U;z<H;z++)M=M>>>8^j[255&(M^D.charCodeAt(z))];return-1^M})(0|C,s,s.length,0):0}},{"./utils":32}],5:[function(l,f,p){p.base64=!1,p.binary=!1,p.dir=!1,p.createFolders=!0,p.date=null,p.compression=null,p.compressionOptions=null,p.comment=null,p.unixPermissions=null,p.dosPermissions=null},{}],6:[function(l,f,p){var b=null;b=typeof Promise<"u"?Promise:l("lie"),f.exports={Promise:b}},{lie:37}],7:[function(l,f,p){var b=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",_=l("pako"),s=l("./utils"),C=l("./stream/GenericWorker"),M=b?"uint8array":"array";function D(B,U){C.call(this,"FlateWorker/"+B),this._pako=null,this._pakoAction=B,this._pakoOptions=U,this.meta={}}p.magic="\b\0",s.inherits(D,C),D.prototype.processChunk=function(B){this.meta=B.meta,this._pako===null&&this._createPako(),this._pako.push(s.transformTo(M,B.data),!1)},D.prototype.flush=function(){C.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},D.prototype.cleanUp=function(){C.prototype.cleanUp.call(this),this._pako=null},D.prototype._createPako=function(){this._pako=new _[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var B=this;this._pako.onData=function(U){B.push({data:U,meta:B.meta})}},p.compressWorker=function(B){return new D("Deflate",B)},p.uncompressWorker=function(){return new D("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(l,f,p){function b(j,H){var z,N="";for(z=0;z<H;z++)N+=String.fromCharCode(255&j),j>>>=8;return N}function _(j,H,z,N,Z,Y){var W,de,ge=j.file,ve=j.compression,ie=Y!==M.utf8encode,Me=s.transformTo("string",Y(ge.name)),we=s.transformTo("string",M.utf8encode(ge.name)),Ge=ge.comment,et=s.transformTo("string",Y(Ge)),pe=s.transformTo("string",M.utf8encode(Ge)),Je=we.length!==ge.name.length,le=pe.length!==Ge.length,ut="",tt="",We="",$t=ge.dir,Be=ge.date,Mt={crc32:0,compressedSize:0,uncompressedSize:0};H&&!z||(Mt.crc32=j.crc32,Mt.compressedSize=j.compressedSize,Mt.uncompressedSize=j.uncompressedSize);var me=0;H&&(me|=8),ie||!Je&&!le||(me|=2048);var re=0,Ve=0;$t&&(re|=16),Z==="UNIX"?(Ve=798,re|=(function(De,bt){var Vt=De;return De||(Vt=bt?16893:33204),(65535&Vt)<<16})(ge.unixPermissions,$t)):(Ve=20,re|=(function(De){return 63&(De||0)})(ge.dosPermissions)),W=Be.getUTCHours(),W<<=6,W|=Be.getUTCMinutes(),W<<=5,W|=Be.getUTCSeconds()/2,de=Be.getUTCFullYear()-1980,de<<=4,de|=Be.getUTCMonth()+1,de<<=5,de|=Be.getUTCDate(),Je&&(tt=b(1,1)+b(D(Me),4)+we,ut+="up"+b(tt.length,2)+tt),le&&(We=b(1,1)+b(D(et),4)+pe,ut+="uc"+b(We.length,2)+We);var Pe="";return Pe+=`
\0`,Pe+=b(me,2),Pe+=ve.magic,Pe+=b(W,2),Pe+=b(de,2),Pe+=b(Mt.crc32,4),Pe+=b(Mt.compressedSize,4),Pe+=b(Mt.uncompressedSize,4),Pe+=b(Me.length,2),Pe+=b(ut.length,2),{fileRecord:B.LOCAL_FILE_HEADER+Pe+Me+ut,dirRecord:B.CENTRAL_FILE_HEADER+b(Ve,2)+Pe+b(et.length,2)+"\0\0\0\0"+b(re,4)+b(N,4)+Me+ut+et}}var s=l("../utils"),C=l("../stream/GenericWorker"),M=l("../utf8"),D=l("../crc32"),B=l("../signature");function U(j,H,z,N){C.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=H,this.zipPlatform=z,this.encodeFileName=N,this.streamFiles=j,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(U,C),U.prototype.push=function(j){var H=j.meta.percent||0,z=this.entriesCount,N=this._sources.length;this.accumulate?this.contentBuffer.push(j):(this.bytesWritten+=j.data.length,C.prototype.push.call(this,{data:j.data,meta:{currentFile:this.currentFile,percent:z?(H+100*(z-N-1))/z:100}}))},U.prototype.openedSource=function(j){this.currentSourceOffset=this.bytesWritten,this.currentFile=j.file.name;var H=this.streamFiles&&!j.file.dir;if(H){var z=_(j,H,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:z.fileRecord,meta:{percent:0}})}else this.accumulate=!0},U.prototype.closedSource=function(j){this.accumulate=!1;var H=this.streamFiles&&!j.file.dir,z=_(j,H,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(z.dirRecord),H)this.push({data:(function(N){return B.DATA_DESCRIPTOR+b(N.crc32,4)+b(N.compressedSize,4)+b(N.uncompressedSize,4)})(j),meta:{percent:100}});else for(this.push({data:z.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},U.prototype.flush=function(){for(var j=this.bytesWritten,H=0;H<this.dirRecords.length;H++)this.push({data:this.dirRecords[H],meta:{percent:100}});var z=this.bytesWritten-j,N=(function(Z,Y,W,de,ge){var ve=s.transformTo("string",ge(de));return B.CENTRAL_DIRECTORY_END+"\0\0\0\0"+b(Z,2)+b(Z,2)+b(Y,4)+b(W,4)+b(ve.length,2)+ve})(this.dirRecords.length,z,j,this.zipComment,this.encodeFileName);this.push({data:N,meta:{percent:100}})},U.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},U.prototype.registerPrevious=function(j){this._sources.push(j);var H=this;return j.on("data",function(z){H.processChunk(z)}),j.on("end",function(){H.closedSource(H.previous.streamInfo),H._sources.length?H.prepareNextSource():H.end()}),j.on("error",function(z){H.error(z)}),this},U.prototype.resume=function(){return!!C.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},U.prototype.error=function(j){var H=this._sources;if(!C.prototype.error.call(this,j))return!1;for(var z=0;z<H.length;z++)try{H[z].error(j)}catch{}return!0},U.prototype.lock=function(){C.prototype.lock.call(this);for(var j=this._sources,H=0;H<j.length;H++)j[H].lock()},f.exports=U},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(l,f,p){var b=l("../compressions"),_=l("./ZipFileWorker");p.generateWorker=function(s,C,M){var D=new _(C.streamFiles,M,C.platform,C.encodeFileName),B=0;try{s.forEach(function(U,j){B++;var H=(function(Y,W){var de=Y||W,ge=b[de];if(!ge)throw new Error(de+" is not a valid compression method !");return ge})(j.options.compression,C.compression),z=j.options.compressionOptions||C.compressionOptions||{},N=j.dir,Z=j.date;j._compressWorker(H,z).withStreamInfo("file",{name:U,dir:N,date:Z,comment:j.comment||"",unixPermissions:j.unixPermissions,dosPermissions:j.dosPermissions}).pipe(D)}),D.entriesCount=B}catch(U){D.error(U)}return D}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(l,f,p){function b(){if(!(this instanceof b))return new b;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var _=new b;for(var s in this)typeof this[s]!="function"&&(_[s]=this[s]);return _}}(b.prototype=l("./object")).loadAsync=l("./load"),b.support=l("./support"),b.defaults=l("./defaults"),b.version="3.10.1",b.loadAsync=function(_,s){return new b().loadAsync(_,s)},b.external=l("./external"),f.exports=b},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(l,f,p){var b=l("./utils"),_=l("./external"),s=l("./utf8"),C=l("./zipEntries"),M=l("./stream/Crc32Probe"),D=l("./nodejsUtils");function B(U){return new _.Promise(function(j,H){var z=U.decompressed.getContentWorker().pipe(new M);z.on("error",function(N){H(N)}).on("end",function(){z.streamInfo.crc32!==U.decompressed.crc32?H(new Error("Corrupted zip : CRC32 mismatch")):j()}).resume()})}f.exports=function(U,j){var H=this;return j=b.extend(j||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),D.isNode&&D.isStream(U)?_.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):b.prepareContent("the loaded zip file",U,!0,j.optimizedBinaryString,j.base64).then(function(z){var N=new C(j);return N.load(z),N}).then(function(z){var N=[_.Promise.resolve(z)],Z=z.files;if(j.checkCRC32)for(var Y=0;Y<Z.length;Y++)N.push(B(Z[Y]));return _.Promise.all(N)}).then(function(z){for(var N=z.shift(),Z=N.files,Y=0;Y<Z.length;Y++){var W=Z[Y],de=W.fileNameStr,ge=b.resolve(W.fileNameStr);H.file(ge,W.decompressed,{binary:!0,optimizedBinaryString:!0,date:W.date,dir:W.dir,comment:W.fileCommentStr.length?W.fileCommentStr:null,unixPermissions:W.unixPermissions,dosPermissions:W.dosPermissions,createFolders:j.createFolders}),W.dir||(H.file(ge).unsafeOriginalName=de)}return N.zipComment.length&&(H.comment=N.zipComment),H})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(l,f,p){var b=l("../utils"),_=l("../stream/GenericWorker");function s(C,M){_.call(this,"Nodejs stream input adapter for "+C),this._upstreamEnded=!1,this._bindStream(M)}b.inherits(s,_),s.prototype._bindStream=function(C){var M=this;(this._stream=C).pause(),C.on("data",function(D){M.push({data:D,meta:{percent:0}})}).on("error",function(D){M.isPaused?this.generatedError=D:M.error(D)}).on("end",function(){M.isPaused?M._upstreamEnded=!0:M.end()})},s.prototype.pause=function(){return!!_.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!_.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},f.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(l,f,p){var b=l("readable-stream").Readable;function _(s,C,M){b.call(this,C),this._helper=s;var D=this;s.on("data",function(B,U){D.push(B)||D._helper.pause(),M&&M(U)}).on("error",function(B){D.emit("error",B)}).on("end",function(){D.push(null)})}l("../utils").inherits(_,b),_.prototype._read=function(){this._helper.resume()},f.exports=_},{"../utils":32,"readable-stream":16}],14:[function(l,f,p){f.exports={isNode:typeof Buffer<"u",newBufferFrom:function(b,_){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(b,_);if(typeof b=="number")throw new Error('The "data" argument must not be a number');return new Buffer(b,_)},allocBuffer:function(b){if(Buffer.alloc)return Buffer.alloc(b);var _=new Buffer(b);return _.fill(0),_},isBuffer:function(b){return Buffer.isBuffer(b)},isStream:function(b){return b&&typeof b.on=="function"&&typeof b.pause=="function"&&typeof b.resume=="function"}}},{}],15:[function(l,f,p){function b(ge,ve,ie){var Me,we=s.getTypeOf(ve),Ge=s.extend(ie||{},D);Ge.date=Ge.date||new Date,Ge.compression!==null&&(Ge.compression=Ge.compression.toUpperCase()),typeof Ge.unixPermissions=="string"&&(Ge.unixPermissions=parseInt(Ge.unixPermissions,8)),Ge.unixPermissions&&16384&Ge.unixPermissions&&(Ge.dir=!0),Ge.dosPermissions&&16&Ge.dosPermissions&&(Ge.dir=!0),Ge.dir&&(ge=Z(ge)),Ge.createFolders&&(Me=N(ge))&&Y.call(this,Me,!0);var et=we==="string"&&Ge.binary===!1&&Ge.base64===!1;ie&&ie.binary!==void 0||(Ge.binary=!et),(ve instanceof B&&ve.uncompressedSize===0||Ge.dir||!ve||ve.length===0)&&(Ge.base64=!1,Ge.binary=!0,ve="",Ge.compression="STORE",we="string");var pe=null;pe=ve instanceof B||ve instanceof C?ve:H.isNode&&H.isStream(ve)?new z(ge,ve):s.prepareContent(ge,ve,Ge.binary,Ge.optimizedBinaryString,Ge.base64);var Je=new U(ge,pe,Ge);this.files[ge]=Je}var _=l("./utf8"),s=l("./utils"),C=l("./stream/GenericWorker"),M=l("./stream/StreamHelper"),D=l("./defaults"),B=l("./compressedObject"),U=l("./zipObject"),j=l("./generate"),H=l("./nodejsUtils"),z=l("./nodejs/NodejsStreamInputAdapter"),N=function(ge){ge.slice(-1)==="/"&&(ge=ge.substring(0,ge.length-1));var ve=ge.lastIndexOf("/");return 0<ve?ge.substring(0,ve):""},Z=function(ge){return ge.slice(-1)!=="/"&&(ge+="/"),ge},Y=function(ge,ve){return ve=ve!==void 0?ve:D.createFolders,ge=Z(ge),this.files[ge]||b.call(this,ge,null,{dir:!0,createFolders:ve}),this.files[ge]};function W(ge){return Object.prototype.toString.call(ge)==="[object RegExp]"}var de={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(ge){var ve,ie,Me;for(ve in this.files)Me=this.files[ve],(ie=ve.slice(this.root.length,ve.length))&&ve.slice(0,this.root.length)===this.root&&ge(ie,Me)},filter:function(ge){var ve=[];return this.forEach(function(ie,Me){ge(ie,Me)&&ve.push(Me)}),ve},file:function(ge,ve,ie){if(arguments.length!==1)return ge=this.root+ge,b.call(this,ge,ve,ie),this;if(W(ge)){var Me=ge;return this.filter(function(Ge,et){return!et.dir&&Me.test(Ge)})}var we=this.files[this.root+ge];return we&&!we.dir?we:null},folder:function(ge){if(!ge)return this;if(W(ge))return this.filter(function(we,Ge){return Ge.dir&&ge.test(we)});var ve=this.root+ge,ie=Y.call(this,ve),Me=this.clone();return Me.root=ie.name,Me},remove:function(ge){ge=this.root+ge;var ve=this.files[ge];if(ve||(ge.slice(-1)!=="/"&&(ge+="/"),ve=this.files[ge]),ve&&!ve.dir)delete this.files[ge];else for(var ie=this.filter(function(we,Ge){return Ge.name.slice(0,ge.length)===ge}),Me=0;Me<ie.length;Me++)delete this.files[ie[Me].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(ge){var ve,ie={};try{if((ie=s.extend(ge||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:_.utf8encode})).type=ie.type.toLowerCase(),ie.compression=ie.compression.toUpperCase(),ie.type==="binarystring"&&(ie.type="string"),!ie.type)throw new Error("No output type specified.");s.checkSupport(ie.type),ie.platform!=="darwin"&&ie.platform!=="freebsd"&&ie.platform!=="linux"&&ie.platform!=="sunos"||(ie.platform="UNIX"),ie.platform==="win32"&&(ie.platform="DOS");var Me=ie.comment||this.comment||"";ve=j.generateWorker(this,ie,Me)}catch(we){(ve=new C("error")).error(we)}return new M(ve,ie.type||"string",ie.mimeType)},generateAsync:function(ge,ve){return this.generateInternalStream(ge).accumulate(ve)},generateNodeStream:function(ge,ve){return(ge=ge||{}).type||(ge.type="nodebuffer"),this.generateInternalStream(ge).toNodejsStream(ve)}};f.exports=de},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(l,f,p){f.exports=l("stream")},{stream:void 0}],17:[function(l,f,p){var b=l("./DataReader");function _(s){b.call(this,s);for(var C=0;C<this.data.length;C++)s[C]=255&s[C]}l("../utils").inherits(_,b),_.prototype.byteAt=function(s){return this.data[this.zero+s]},_.prototype.lastIndexOfSignature=function(s){for(var C=s.charCodeAt(0),M=s.charCodeAt(1),D=s.charCodeAt(2),B=s.charCodeAt(3),U=this.length-4;0<=U;--U)if(this.data[U]===C&&this.data[U+1]===M&&this.data[U+2]===D&&this.data[U+3]===B)return U-this.zero;return-1},_.prototype.readAndCheckSignature=function(s){var C=s.charCodeAt(0),M=s.charCodeAt(1),D=s.charCodeAt(2),B=s.charCodeAt(3),U=this.readData(4);return C===U[0]&&M===U[1]&&D===U[2]&&B===U[3]},_.prototype.readData=function(s){if(this.checkOffset(s),s===0)return[];var C=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,C},f.exports=_},{"../utils":32,"./DataReader":18}],18:[function(l,f,p){var b=l("../utils");function _(s){this.data=s,this.length=s.length,this.index=0,this.zero=0}_.prototype={checkOffset:function(s){this.checkIndex(this.index+s)},checkIndex:function(s){if(this.length<this.zero+s||s<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+s+"). Corrupted zip ?")},setIndex:function(s){this.checkIndex(s),this.index=s},skip:function(s){this.setIndex(this.index+s)},byteAt:function(){},readInt:function(s){var C,M=0;for(this.checkOffset(s),C=this.index+s-1;C>=this.index;C--)M=(M<<8)+this.byteAt(C);return this.index+=s,M},readString:function(s){return b.transformTo("string",this.readData(s))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var s=this.readInt(4);return new Date(Date.UTC(1980+(s>>25&127),(s>>21&15)-1,s>>16&31,s>>11&31,s>>5&63,(31&s)<<1))}},f.exports=_},{"../utils":32}],19:[function(l,f,p){var b=l("./Uint8ArrayReader");function _(s){b.call(this,s)}l("../utils").inherits(_,b),_.prototype.readData=function(s){this.checkOffset(s);var C=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,C},f.exports=_},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(l,f,p){var b=l("./DataReader");function _(s){b.call(this,s)}l("../utils").inherits(_,b),_.prototype.byteAt=function(s){return this.data.charCodeAt(this.zero+s)},_.prototype.lastIndexOfSignature=function(s){return this.data.lastIndexOf(s)-this.zero},_.prototype.readAndCheckSignature=function(s){return s===this.readData(4)},_.prototype.readData=function(s){this.checkOffset(s);var C=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,C},f.exports=_},{"../utils":32,"./DataReader":18}],21:[function(l,f,p){var b=l("./ArrayReader");function _(s){b.call(this,s)}l("../utils").inherits(_,b),_.prototype.readData=function(s){if(this.checkOffset(s),s===0)return new Uint8Array(0);var C=this.data.subarray(this.zero+this.index,this.zero+this.index+s);return this.index+=s,C},f.exports=_},{"../utils":32,"./ArrayReader":17}],22:[function(l,f,p){var b=l("../utils"),_=l("../support"),s=l("./ArrayReader"),C=l("./StringReader"),M=l("./NodeBufferReader"),D=l("./Uint8ArrayReader");f.exports=function(B){var U=b.getTypeOf(B);return b.checkSupport(U),U!=="string"||_.uint8array?U==="nodebuffer"?new M(B):_.uint8array?new D(b.transformTo("uint8array",B)):new s(b.transformTo("array",B)):new C(B)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(l,f,p){p.LOCAL_FILE_HEADER="PK",p.CENTRAL_FILE_HEADER="PK",p.CENTRAL_DIRECTORY_END="PK",p.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",p.ZIP64_CENTRAL_DIRECTORY_END="PK",p.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(l,f,p){var b=l("./GenericWorker"),_=l("../utils");function s(C){b.call(this,"ConvertWorker to "+C),this.destType=C}_.inherits(s,b),s.prototype.processChunk=function(C){this.push({data:_.transformTo(this.destType,C.data),meta:C.meta})},f.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(l,f,p){var b=l("./GenericWorker"),_=l("../crc32");function s(){b.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}l("../utils").inherits(s,b),s.prototype.processChunk=function(C){this.streamInfo.crc32=_(C.data,this.streamInfo.crc32||0),this.push(C)},f.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(l,f,p){var b=l("../utils"),_=l("./GenericWorker");function s(C){_.call(this,"DataLengthProbe for "+C),this.propName=C,this.withStreamInfo(C,0)}b.inherits(s,_),s.prototype.processChunk=function(C){if(C){var M=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=M+C.data.length}_.prototype.processChunk.call(this,C)},f.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(l,f,p){var b=l("../utils"),_=l("./GenericWorker");function s(C){_.call(this,"DataWorker");var M=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,C.then(function(D){M.dataIsReady=!0,M.data=D,M.max=D&&D.length||0,M.type=b.getTypeOf(D),M.isPaused||M._tickAndRepeat()},function(D){M.error(D)})}b.inherits(s,_),s.prototype.cleanUp=function(){_.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!_.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,b.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(b.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var C=null,M=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":C=this.data.substring(this.index,M);break;case"uint8array":C=this.data.subarray(this.index,M);break;case"array":case"nodebuffer":C=this.data.slice(this.index,M)}return this.index=M,this.push({data:C,meta:{percent:this.max?this.index/this.max*100:0}})},f.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(l,f,p){function b(_){this.name=_||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}b.prototype={push:function(_){this.emit("data",_)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(_){this.emit("error",_)}return!0},error:function(_){return!this.isFinished&&(this.isPaused?this.generatedError=_:(this.isFinished=!0,this.emit("error",_),this.previous&&this.previous.error(_),this.cleanUp()),!0)},on:function(_,s){return this._listeners[_].push(s),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(_,s){if(this._listeners[_])for(var C=0;C<this._listeners[_].length;C++)this._listeners[_][C].call(this,s)},pipe:function(_){return _.registerPrevious(this)},registerPrevious:function(_){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=_.streamInfo,this.mergeStreamInfo(),this.previous=_;var s=this;return _.on("data",function(C){s.processChunk(C)}),_.on("end",function(){s.end()}),_.on("error",function(C){s.error(C)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var _=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),_=!0),this.previous&&this.previous.resume(),!_},flush:function(){},processChunk:function(_){this.push(_)},withStreamInfo:function(_,s){return this.extraStreamInfo[_]=s,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var _ in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,_)&&(this.streamInfo[_]=this.extraStreamInfo[_])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var _="Worker "+this.name;return this.previous?this.previous+" -> "+_:_}},f.exports=b},{}],29:[function(l,f,p){var b=l("../utils"),_=l("./ConvertWorker"),s=l("./GenericWorker"),C=l("../base64"),M=l("../support"),D=l("../external"),B=null;if(M.nodestream)try{B=l("../nodejs/NodejsStreamOutputAdapter")}catch{}function U(H,z){return new D.Promise(function(N,Z){var Y=[],W=H._internalType,de=H._outputType,ge=H._mimeType;H.on("data",function(ve,ie){Y.push(ve),z&&z(ie)}).on("error",function(ve){Y=[],Z(ve)}).on("end",function(){try{var ve=(function(ie,Me,we){switch(ie){case"blob":return b.newBlob(b.transformTo("arraybuffer",Me),we);case"base64":return C.encode(Me);default:return b.transformTo(ie,Me)}})(de,(function(ie,Me){var we,Ge=0,et=null,pe=0;for(we=0;we<Me.length;we++)pe+=Me[we].length;switch(ie){case"string":return Me.join("");case"array":return Array.prototype.concat.apply([],Me);case"uint8array":for(et=new Uint8Array(pe),we=0;we<Me.length;we++)et.set(Me[we],Ge),Ge+=Me[we].length;return et;case"nodebuffer":return Buffer.concat(Me);default:throw new Error("concat : unsupported type '"+ie+"'")}})(W,Y),ge);N(ve)}catch(ie){Z(ie)}Y=[]}).resume()})}function j(H,z,N){var Z=z;switch(z){case"blob":case"arraybuffer":Z="uint8array";break;case"base64":Z="string"}try{this._internalType=Z,this._outputType=z,this._mimeType=N,b.checkSupport(Z),this._worker=H.pipe(new _(Z)),H.lock()}catch(Y){this._worker=new s("error"),this._worker.error(Y)}}j.prototype={accumulate:function(H){return U(this,H)},on:function(H,z){var N=this;return H==="data"?this._worker.on(H,function(Z){z.call(N,Z.data,Z.meta)}):this._worker.on(H,function(){b.delay(z,arguments,N)}),this},resume:function(){return b.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(H){if(b.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new B(this,{objectMode:this._outputType!=="nodebuffer"},H)}},f.exports=j},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(l,f,p){if(p.base64=!0,p.array=!0,p.string=!0,p.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",p.nodebuffer=typeof Buffer<"u",p.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")p.blob=!1;else{var b=new ArrayBuffer(0);try{p.blob=new Blob([b],{type:"application/zip"}).size===0}catch{try{var _=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);_.append(b),p.blob=_.getBlob("application/zip").size===0}catch{p.blob=!1}}}try{p.nodestream=!!l("readable-stream").Readable}catch{p.nodestream=!1}},{"readable-stream":16}],31:[function(l,f,p){for(var b=l("./utils"),_=l("./support"),s=l("./nodejsUtils"),C=l("./stream/GenericWorker"),M=new Array(256),D=0;D<256;D++)M[D]=252<=D?6:248<=D?5:240<=D?4:224<=D?3:192<=D?2:1;M[254]=M[254]=1;function B(){C.call(this,"utf-8 decode"),this.leftOver=null}function U(){C.call(this,"utf-8 encode")}p.utf8encode=function(j){return _.nodebuffer?s.newBufferFrom(j,"utf-8"):(function(H){var z,N,Z,Y,W,de=H.length,ge=0;for(Y=0;Y<de;Y++)(64512&(N=H.charCodeAt(Y)))==55296&&Y+1<de&&(64512&(Z=H.charCodeAt(Y+1)))==56320&&(N=65536+(N-55296<<10)+(Z-56320),Y++),ge+=N<128?1:N<2048?2:N<65536?3:4;for(z=_.uint8array?new Uint8Array(ge):new Array(ge),Y=W=0;W<ge;Y++)(64512&(N=H.charCodeAt(Y)))==55296&&Y+1<de&&(64512&(Z=H.charCodeAt(Y+1)))==56320&&(N=65536+(N-55296<<10)+(Z-56320),Y++),N<128?z[W++]=N:(N<2048?z[W++]=192|N>>>6:(N<65536?z[W++]=224|N>>>12:(z[W++]=240|N>>>18,z[W++]=128|N>>>12&63),z[W++]=128|N>>>6&63),z[W++]=128|63&N);return z})(j)},p.utf8decode=function(j){return _.nodebuffer?b.transformTo("nodebuffer",j).toString("utf-8"):(function(H){var z,N,Z,Y,W=H.length,de=new Array(2*W);for(z=N=0;z<W;)if((Z=H[z++])<128)de[N++]=Z;else if(4<(Y=M[Z]))de[N++]=65533,z+=Y-1;else{for(Z&=Y===2?31:Y===3?15:7;1<Y&&z<W;)Z=Z<<6|63&H[z++],Y--;1<Y?de[N++]=65533:Z<65536?de[N++]=Z:(Z-=65536,de[N++]=55296|Z>>10&1023,de[N++]=56320|1023&Z)}return de.length!==N&&(de.subarray?de=de.subarray(0,N):de.length=N),b.applyFromCharCode(de)})(j=b.transformTo(_.uint8array?"uint8array":"array",j))},b.inherits(B,C),B.prototype.processChunk=function(j){var H=b.transformTo(_.uint8array?"uint8array":"array",j.data);if(this.leftOver&&this.leftOver.length){if(_.uint8array){var z=H;(H=new Uint8Array(z.length+this.leftOver.length)).set(this.leftOver,0),H.set(z,this.leftOver.length)}else H=this.leftOver.concat(H);this.leftOver=null}var N=(function(Y,W){var de;for((W=W||Y.length)>Y.length&&(W=Y.length),de=W-1;0<=de&&(192&Y[de])==128;)de--;return de<0||de===0?W:de+M[Y[de]]>W?de:W})(H),Z=H;N!==H.length&&(_.uint8array?(Z=H.subarray(0,N),this.leftOver=H.subarray(N,H.length)):(Z=H.slice(0,N),this.leftOver=H.slice(N,H.length))),this.push({data:p.utf8decode(Z),meta:j.meta})},B.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:p.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},p.Utf8DecodeWorker=B,b.inherits(U,C),U.prototype.processChunk=function(j){this.push({data:p.utf8encode(j.data),meta:j.meta})},p.Utf8EncodeWorker=U},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(l,f,p){var b=l("./support"),_=l("./base64"),s=l("./nodejsUtils"),C=l("./external");function M(z){return z}function D(z,N){for(var Z=0;Z<z.length;++Z)N[Z]=255&z.charCodeAt(Z);return N}l("setimmediate"),p.newBlob=function(z,N){p.checkSupport("blob");try{return new Blob([z],{type:N})}catch{try{var Z=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return Z.append(z),Z.getBlob(N)}catch{throw new Error("Bug : can't construct the Blob.")}}};var B={stringifyByChunk:function(z,N,Z){var Y=[],W=0,de=z.length;if(de<=Z)return String.fromCharCode.apply(null,z);for(;W<de;)N==="array"||N==="nodebuffer"?Y.push(String.fromCharCode.apply(null,z.slice(W,Math.min(W+Z,de)))):Y.push(String.fromCharCode.apply(null,z.subarray(W,Math.min(W+Z,de)))),W+=Z;return Y.join("")},stringifyByChar:function(z){for(var N="",Z=0;Z<z.length;Z++)N+=String.fromCharCode(z[Z]);return N},applyCanBeUsed:{uint8array:(function(){try{return b.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return b.nodebuffer&&String.fromCharCode.apply(null,s.allocBuffer(1)).length===1}catch{return!1}})()}};function U(z){var N=65536,Z=p.getTypeOf(z),Y=!0;if(Z==="uint8array"?Y=B.applyCanBeUsed.uint8array:Z==="nodebuffer"&&(Y=B.applyCanBeUsed.nodebuffer),Y)for(;1<N;)try{return B.stringifyByChunk(z,Z,N)}catch{N=Math.floor(N/2)}return B.stringifyByChar(z)}function j(z,N){for(var Z=0;Z<z.length;Z++)N[Z]=z[Z];return N}p.applyFromCharCode=U;var H={};H.string={string:M,array:function(z){return D(z,new Array(z.length))},arraybuffer:function(z){return H.string.uint8array(z).buffer},uint8array:function(z){return D(z,new Uint8Array(z.length))},nodebuffer:function(z){return D(z,s.allocBuffer(z.length))}},H.array={string:U,array:M,arraybuffer:function(z){return new Uint8Array(z).buffer},uint8array:function(z){return new Uint8Array(z)},nodebuffer:function(z){return s.newBufferFrom(z)}},H.arraybuffer={string:function(z){return U(new Uint8Array(z))},array:function(z){return j(new Uint8Array(z),new Array(z.byteLength))},arraybuffer:M,uint8array:function(z){return new Uint8Array(z)},nodebuffer:function(z){return s.newBufferFrom(new Uint8Array(z))}},H.uint8array={string:U,array:function(z){return j(z,new Array(z.length))},arraybuffer:function(z){return z.buffer},uint8array:M,nodebuffer:function(z){return s.newBufferFrom(z)}},H.nodebuffer={string:U,array:function(z){return j(z,new Array(z.length))},arraybuffer:function(z){return H.nodebuffer.uint8array(z).buffer},uint8array:function(z){return j(z,new Uint8Array(z.length))},nodebuffer:M},p.transformTo=function(z,N){if(N=N||"",!z)return N;p.checkSupport(z);var Z=p.getTypeOf(N);return H[Z][z](N)},p.resolve=function(z){for(var N=z.split("/"),Z=[],Y=0;Y<N.length;Y++){var W=N[Y];W==="."||W===""&&Y!==0&&Y!==N.length-1||(W===".."?Z.pop():Z.push(W))}return Z.join("/")},p.getTypeOf=function(z){return typeof z=="string"?"string":Object.prototype.toString.call(z)==="[object Array]"?"array":b.nodebuffer&&s.isBuffer(z)?"nodebuffer":b.uint8array&&z instanceof Uint8Array?"uint8array":b.arraybuffer&&z instanceof ArrayBuffer?"arraybuffer":void 0},p.checkSupport=function(z){if(!b[z.toLowerCase()])throw new Error(z+" is not supported by this platform")},p.MAX_VALUE_16BITS=65535,p.MAX_VALUE_32BITS=-1,p.pretty=function(z){var N,Z,Y="";for(Z=0;Z<(z||"").length;Z++)Y+="\\x"+((N=z.charCodeAt(Z))<16?"0":"")+N.toString(16).toUpperCase();return Y},p.delay=function(z,N,Z){setImmediate(function(){z.apply(Z||null,N||[])})},p.inherits=function(z,N){function Z(){}Z.prototype=N.prototype,z.prototype=new Z},p.extend=function(){var z,N,Z={};for(z=0;z<arguments.length;z++)for(N in arguments[z])Object.prototype.hasOwnProperty.call(arguments[z],N)&&Z[N]===void 0&&(Z[N]=arguments[z][N]);return Z},p.prepareContent=function(z,N,Z,Y,W){return C.Promise.resolve(N).then(function(de){return b.blob&&(de instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(de))!==-1)&&typeof FileReader<"u"?new C.Promise(function(ge,ve){var ie=new FileReader;ie.onload=function(Me){ge(Me.target.result)},ie.onerror=function(Me){ve(Me.target.error)},ie.readAsArrayBuffer(de)}):de}).then(function(de){var ge=p.getTypeOf(de);return ge?(ge==="arraybuffer"?de=p.transformTo("uint8array",de):ge==="string"&&(W?de=_.decode(de):Z&&Y!==!0&&(de=(function(ve){return D(ve,b.uint8array?new Uint8Array(ve.length):new Array(ve.length))})(de))),de):C.Promise.reject(new Error("Can't read the data of '"+z+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(l,f,p){var b=l("./reader/readerFor"),_=l("./utils"),s=l("./signature"),C=l("./zipEntry"),M=l("./support");function D(B){this.files=[],this.loadOptions=B}D.prototype={checkSignature:function(B){if(!this.reader.readAndCheckSignature(B)){this.reader.index-=4;var U=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+_.pretty(U)+", expected "+_.pretty(B)+")")}},isSignature:function(B,U){var j=this.reader.index;this.reader.setIndex(B);var H=this.reader.readString(4)===U;return this.reader.setIndex(j),H},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var B=this.reader.readData(this.zipCommentLength),U=M.uint8array?"uint8array":"array",j=_.transformTo(U,B);this.zipComment=this.loadOptions.decodeFileName(j)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var B,U,j,H=this.zip64EndOfCentralSize-44;0<H;)B=this.reader.readInt(2),U=this.reader.readInt(4),j=this.reader.readData(U),this.zip64ExtensibleData[B]={id:B,length:U,value:j}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var B,U;for(B=0;B<this.files.length;B++)U=this.files[B],this.reader.setIndex(U.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),U.readLocalPart(this.reader),U.handleUTF8(),U.processAttributes()},readCentralDir:function(){var B;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(B=new C({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(B);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var B=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(B<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(B);var U=B;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===_.MAX_VALUE_16BITS||this.diskWithCentralDirStart===_.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===_.MAX_VALUE_16BITS||this.centralDirRecords===_.MAX_VALUE_16BITS||this.centralDirSize===_.MAX_VALUE_32BITS||this.centralDirOffset===_.MAX_VALUE_32BITS){if(this.zip64=!0,(B=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(B),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var j=this.centralDirOffset+this.centralDirSize;this.zip64&&(j+=20,j+=12+this.zip64EndOfCentralSize);var H=U-j;if(0<H)this.isSignature(U,s.CENTRAL_FILE_HEADER)||(this.reader.zero=H);else if(H<0)throw new Error("Corrupted zip: missing "+Math.abs(H)+" bytes.")},prepareReader:function(B){this.reader=b(B)},load:function(B){this.prepareReader(B),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},f.exports=D},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(l,f,p){var b=l("./reader/readerFor"),_=l("./utils"),s=l("./compressedObject"),C=l("./crc32"),M=l("./utf8"),D=l("./compressions"),B=l("./support");function U(j,H){this.options=j,this.loadOptions=H}U.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(j){var H,z;if(j.skip(22),this.fileNameLength=j.readInt(2),z=j.readInt(2),this.fileName=j.readData(this.fileNameLength),j.skip(z),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((H=(function(N){for(var Z in D)if(Object.prototype.hasOwnProperty.call(D,Z)&&D[Z].magic===N)return D[Z];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+_.pretty(this.compressionMethod)+" unknown (inner file : "+_.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,H,j.readData(this.compressedSize))},readCentralPart:function(j){this.versionMadeBy=j.readInt(2),j.skip(2),this.bitFlag=j.readInt(2),this.compressionMethod=j.readString(2),this.date=j.readDate(),this.crc32=j.readInt(4),this.compressedSize=j.readInt(4),this.uncompressedSize=j.readInt(4);var H=j.readInt(2);if(this.extraFieldsLength=j.readInt(2),this.fileCommentLength=j.readInt(2),this.diskNumberStart=j.readInt(2),this.internalFileAttributes=j.readInt(2),this.externalFileAttributes=j.readInt(4),this.localHeaderOffset=j.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");j.skip(H),this.readExtraFields(j),this.parseZIP64ExtraField(j),this.fileComment=j.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var j=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),j==0&&(this.dosPermissions=63&this.externalFileAttributes),j==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var j=b(this.extraFields[1].value);this.uncompressedSize===_.MAX_VALUE_32BITS&&(this.uncompressedSize=j.readInt(8)),this.compressedSize===_.MAX_VALUE_32BITS&&(this.compressedSize=j.readInt(8)),this.localHeaderOffset===_.MAX_VALUE_32BITS&&(this.localHeaderOffset=j.readInt(8)),this.diskNumberStart===_.MAX_VALUE_32BITS&&(this.diskNumberStart=j.readInt(4))}},readExtraFields:function(j){var H,z,N,Z=j.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});j.index+4<Z;)H=j.readInt(2),z=j.readInt(2),N=j.readData(z),this.extraFields[H]={id:H,length:z,value:N};j.setIndex(Z)},handleUTF8:function(){var j=B.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=M.utf8decode(this.fileName),this.fileCommentStr=M.utf8decode(this.fileComment);else{var H=this.findExtraFieldUnicodePath();if(H!==null)this.fileNameStr=H;else{var z=_.transformTo(j,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(z)}var N=this.findExtraFieldUnicodeComment();if(N!==null)this.fileCommentStr=N;else{var Z=_.transformTo(j,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(Z)}}},findExtraFieldUnicodePath:function(){var j=this.extraFields[28789];if(j){var H=b(j.value);return H.readInt(1)!==1||C(this.fileName)!==H.readInt(4)?null:M.utf8decode(H.readData(j.length-5))}return null},findExtraFieldUnicodeComment:function(){var j=this.extraFields[25461];if(j){var H=b(j.value);return H.readInt(1)!==1||C(this.fileComment)!==H.readInt(4)?null:M.utf8decode(H.readData(j.length-5))}return null}},f.exports=U},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(l,f,p){function b(H,z,N){this.name=H,this.dir=N.dir,this.date=N.date,this.comment=N.comment,this.unixPermissions=N.unixPermissions,this.dosPermissions=N.dosPermissions,this._data=z,this._dataBinary=N.binary,this.options={compression:N.compression,compressionOptions:N.compressionOptions}}var _=l("./stream/StreamHelper"),s=l("./stream/DataWorker"),C=l("./utf8"),M=l("./compressedObject"),D=l("./stream/GenericWorker");b.prototype={internalStream:function(H){var z=null,N="string";try{if(!H)throw new Error("No output type specified.");var Z=(N=H.toLowerCase())==="string"||N==="text";N!=="binarystring"&&N!=="text"||(N="string"),z=this._decompressWorker();var Y=!this._dataBinary;Y&&!Z&&(z=z.pipe(new C.Utf8EncodeWorker)),!Y&&Z&&(z=z.pipe(new C.Utf8DecodeWorker))}catch(W){(z=new D("error")).error(W)}return new _(z,N,"")},async:function(H,z){return this.internalStream(H).accumulate(z)},nodeStream:function(H,z){return this.internalStream(H||"nodebuffer").toNodejsStream(z)},_compressWorker:function(H,z){if(this._data instanceof M&&this._data.compression.magic===H.magic)return this._data.getCompressedWorker();var N=this._decompressWorker();return this._dataBinary||(N=N.pipe(new C.Utf8EncodeWorker)),M.createWorkerFrom(N,H,z)},_decompressWorker:function(){return this._data instanceof M?this._data.getContentWorker():this._data instanceof D?this._data:new s(this._data)}};for(var B=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],U=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},j=0;j<B.length;j++)b.prototype[B[j]]=U;f.exports=b},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(l,f,p){(function(b){var _,s,C=b.MutationObserver||b.WebKitMutationObserver;if(C){var M=0,D=new C(H),B=b.document.createTextNode("");D.observe(B,{characterData:!0}),_=function(){B.data=M=++M%2}}else if(b.setImmediate||b.MessageChannel===void 0)_="document"in b&&"onreadystatechange"in b.document.createElement("script")?function(){var z=b.document.createElement("script");z.onreadystatechange=function(){H(),z.onreadystatechange=null,z.parentNode.removeChild(z),z=null},b.document.documentElement.appendChild(z)}:function(){setTimeout(H,0)};else{var U=new b.MessageChannel;U.port1.onmessage=H,_=function(){U.port2.postMessage(0)}}var j=[];function H(){var z,N;s=!0;for(var Z=j.length;Z;){for(N=j,j=[],z=-1;++z<Z;)N[z]();Z=j.length}s=!1}f.exports=function(z){j.push(z)!==1||s||_()}}).call(this,typeof xd<"u"?xd:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(l,f,p){var b=l("immediate");function _(){}var s={},C=["REJECTED"],M=["FULFILLED"],D=["PENDING"];function B(Z){if(typeof Z!="function")throw new TypeError("resolver must be a function");this.state=D,this.queue=[],this.outcome=void 0,Z!==_&&z(this,Z)}function U(Z,Y,W){this.promise=Z,typeof Y=="function"&&(this.onFulfilled=Y,this.callFulfilled=this.otherCallFulfilled),typeof W=="function"&&(this.onRejected=W,this.callRejected=this.otherCallRejected)}function j(Z,Y,W){b(function(){var de;try{de=Y(W)}catch(ge){return s.reject(Z,ge)}de===Z?s.reject(Z,new TypeError("Cannot resolve promise with itself")):s.resolve(Z,de)})}function H(Z){var Y=Z&&Z.then;if(Z&&(typeof Z=="object"||typeof Z=="function")&&typeof Y=="function")return function(){Y.apply(Z,arguments)}}function z(Z,Y){var W=!1;function de(ie){W||(W=!0,s.reject(Z,ie))}function ge(ie){W||(W=!0,s.resolve(Z,ie))}var ve=N(function(){Y(ge,de)});ve.status==="error"&&de(ve.value)}function N(Z,Y){var W={};try{W.value=Z(Y),W.status="success"}catch(de){W.status="error",W.value=de}return W}(f.exports=B).prototype.finally=function(Z){if(typeof Z!="function")return this;var Y=this.constructor;return this.then(function(W){return Y.resolve(Z()).then(function(){return W})},function(W){return Y.resolve(Z()).then(function(){throw W})})},B.prototype.catch=function(Z){return this.then(null,Z)},B.prototype.then=function(Z,Y){if(typeof Z!="function"&&this.state===M||typeof Y!="function"&&this.state===C)return this;var W=new this.constructor(_);return this.state!==D?j(W,this.state===M?Z:Y,this.outcome):this.queue.push(new U(W,Z,Y)),W},U.prototype.callFulfilled=function(Z){s.resolve(this.promise,Z)},U.prototype.otherCallFulfilled=function(Z){j(this.promise,this.onFulfilled,Z)},U.prototype.callRejected=function(Z){s.reject(this.promise,Z)},U.prototype.otherCallRejected=function(Z){j(this.promise,this.onRejected,Z)},s.resolve=function(Z,Y){var W=N(H,Y);if(W.status==="error")return s.reject(Z,W.value);var de=W.value;if(de)z(Z,de);else{Z.state=M,Z.outcome=Y;for(var ge=-1,ve=Z.queue.length;++ge<ve;)Z.queue[ge].callFulfilled(Y)}return Z},s.reject=function(Z,Y){Z.state=C,Z.outcome=Y;for(var W=-1,de=Z.queue.length;++W<de;)Z.queue[W].callRejected(Y);return Z},B.resolve=function(Z){return Z instanceof this?Z:s.resolve(new this(_),Z)},B.reject=function(Z){var Y=new this(_);return s.reject(Y,Z)},B.all=function(Z){var Y=this;if(Object.prototype.toString.call(Z)!=="[object Array]")return this.reject(new TypeError("must be an array"));var W=Z.length,de=!1;if(!W)return this.resolve([]);for(var ge=new Array(W),ve=0,ie=-1,Me=new this(_);++ie<W;)we(Z[ie],ie);return Me;function we(Ge,et){Y.resolve(Ge).then(function(pe){ge[et]=pe,++ve!==W||de||(de=!0,s.resolve(Me,ge))},function(pe){de||(de=!0,s.reject(Me,pe))})}},B.race=function(Z){var Y=this;if(Object.prototype.toString.call(Z)!=="[object Array]")return this.reject(new TypeError("must be an array"));var W=Z.length,de=!1;if(!W)return this.resolve([]);for(var ge=-1,ve=new this(_);++ge<W;)ie=Z[ge],Y.resolve(ie).then(function(Me){de||(de=!0,s.resolve(ve,Me))},function(Me){de||(de=!0,s.reject(ve,Me))});var ie;return ve}},{immediate:36}],38:[function(l,f,p){var b={};(0,l("./lib/utils/common").assign)(b,l("./lib/deflate"),l("./lib/inflate"),l("./lib/zlib/constants")),f.exports=b},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(l,f,p){var b=l("./zlib/deflate"),_=l("./utils/common"),s=l("./utils/strings"),C=l("./zlib/messages"),M=l("./zlib/zstream"),D=Object.prototype.toString,B=0,U=-1,j=0,H=8;function z(Z){if(!(this instanceof z))return new z(Z);this.options=_.assign({level:U,method:H,chunkSize:16384,windowBits:15,memLevel:8,strategy:j,to:""},Z||{});var Y=this.options;Y.raw&&0<Y.windowBits?Y.windowBits=-Y.windowBits:Y.gzip&&0<Y.windowBits&&Y.windowBits<16&&(Y.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new M,this.strm.avail_out=0;var W=b.deflateInit2(this.strm,Y.level,Y.method,Y.windowBits,Y.memLevel,Y.strategy);if(W!==B)throw new Error(C[W]);if(Y.header&&b.deflateSetHeader(this.strm,Y.header),Y.dictionary){var de;if(de=typeof Y.dictionary=="string"?s.string2buf(Y.dictionary):D.call(Y.dictionary)==="[object ArrayBuffer]"?new Uint8Array(Y.dictionary):Y.dictionary,(W=b.deflateSetDictionary(this.strm,de))!==B)throw new Error(C[W]);this._dict_set=!0}}function N(Z,Y){var W=new z(Y);if(W.push(Z,!0),W.err)throw W.msg||C[W.err];return W.result}z.prototype.push=function(Z,Y){var W,de,ge=this.strm,ve=this.options.chunkSize;if(this.ended)return!1;de=Y===~~Y?Y:Y===!0?4:0,typeof Z=="string"?ge.input=s.string2buf(Z):D.call(Z)==="[object ArrayBuffer]"?ge.input=new Uint8Array(Z):ge.input=Z,ge.next_in=0,ge.avail_in=ge.input.length;do{if(ge.avail_out===0&&(ge.output=new _.Buf8(ve),ge.next_out=0,ge.avail_out=ve),(W=b.deflate(ge,de))!==1&&W!==B)return this.onEnd(W),!(this.ended=!0);ge.avail_out!==0&&(ge.avail_in!==0||de!==4&&de!==2)||(this.options.to==="string"?this.onData(s.buf2binstring(_.shrinkBuf(ge.output,ge.next_out))):this.onData(_.shrinkBuf(ge.output,ge.next_out)))}while((0<ge.avail_in||ge.avail_out===0)&&W!==1);return de===4?(W=b.deflateEnd(this.strm),this.onEnd(W),this.ended=!0,W===B):de!==2||(this.onEnd(B),!(ge.avail_out=0))},z.prototype.onData=function(Z){this.chunks.push(Z)},z.prototype.onEnd=function(Z){Z===B&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=_.flattenChunks(this.chunks)),this.chunks=[],this.err=Z,this.msg=this.strm.msg},p.Deflate=z,p.deflate=N,p.deflateRaw=function(Z,Y){return(Y=Y||{}).raw=!0,N(Z,Y)},p.gzip=function(Z,Y){return(Y=Y||{}).gzip=!0,N(Z,Y)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(l,f,p){var b=l("./zlib/inflate"),_=l("./utils/common"),s=l("./utils/strings"),C=l("./zlib/constants"),M=l("./zlib/messages"),D=l("./zlib/zstream"),B=l("./zlib/gzheader"),U=Object.prototype.toString;function j(z){if(!(this instanceof j))return new j(z);this.options=_.assign({chunkSize:16384,windowBits:0,to:""},z||{});var N=this.options;N.raw&&0<=N.windowBits&&N.windowBits<16&&(N.windowBits=-N.windowBits,N.windowBits===0&&(N.windowBits=-15)),!(0<=N.windowBits&&N.windowBits<16)||z&&z.windowBits||(N.windowBits+=32),15<N.windowBits&&N.windowBits<48&&(15&N.windowBits)==0&&(N.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new D,this.strm.avail_out=0;var Z=b.inflateInit2(this.strm,N.windowBits);if(Z!==C.Z_OK)throw new Error(M[Z]);this.header=new B,b.inflateGetHeader(this.strm,this.header)}function H(z,N){var Z=new j(N);if(Z.push(z,!0),Z.err)throw Z.msg||M[Z.err];return Z.result}j.prototype.push=function(z,N){var Z,Y,W,de,ge,ve,ie=this.strm,Me=this.options.chunkSize,we=this.options.dictionary,Ge=!1;if(this.ended)return!1;Y=N===~~N?N:N===!0?C.Z_FINISH:C.Z_NO_FLUSH,typeof z=="string"?ie.input=s.binstring2buf(z):U.call(z)==="[object ArrayBuffer]"?ie.input=new Uint8Array(z):ie.input=z,ie.next_in=0,ie.avail_in=ie.input.length;do{if(ie.avail_out===0&&(ie.output=new _.Buf8(Me),ie.next_out=0,ie.avail_out=Me),(Z=b.inflate(ie,C.Z_NO_FLUSH))===C.Z_NEED_DICT&&we&&(ve=typeof we=="string"?s.string2buf(we):U.call(we)==="[object ArrayBuffer]"?new Uint8Array(we):we,Z=b.inflateSetDictionary(this.strm,ve)),Z===C.Z_BUF_ERROR&&Ge===!0&&(Z=C.Z_OK,Ge=!1),Z!==C.Z_STREAM_END&&Z!==C.Z_OK)return this.onEnd(Z),!(this.ended=!0);ie.next_out&&(ie.avail_out!==0&&Z!==C.Z_STREAM_END&&(ie.avail_in!==0||Y!==C.Z_FINISH&&Y!==C.Z_SYNC_FLUSH)||(this.options.to==="string"?(W=s.utf8border(ie.output,ie.next_out),de=ie.next_out-W,ge=s.buf2string(ie.output,W),ie.next_out=de,ie.avail_out=Me-de,de&&_.arraySet(ie.output,ie.output,W,de,0),this.onData(ge)):this.onData(_.shrinkBuf(ie.output,ie.next_out)))),ie.avail_in===0&&ie.avail_out===0&&(Ge=!0)}while((0<ie.avail_in||ie.avail_out===0)&&Z!==C.Z_STREAM_END);return Z===C.Z_STREAM_END&&(Y=C.Z_FINISH),Y===C.Z_FINISH?(Z=b.inflateEnd(this.strm),this.onEnd(Z),this.ended=!0,Z===C.Z_OK):Y!==C.Z_SYNC_FLUSH||(this.onEnd(C.Z_OK),!(ie.avail_out=0))},j.prototype.onData=function(z){this.chunks.push(z)},j.prototype.onEnd=function(z){z===C.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=_.flattenChunks(this.chunks)),this.chunks=[],this.err=z,this.msg=this.strm.msg},p.Inflate=j,p.inflate=H,p.inflateRaw=function(z,N){return(N=N||{}).raw=!0,H(z,N)},p.ungzip=H},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(l,f,p){var b=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";p.assign=function(C){for(var M=Array.prototype.slice.call(arguments,1);M.length;){var D=M.shift();if(D){if(typeof D!="object")throw new TypeError(D+"must be non-object");for(var B in D)D.hasOwnProperty(B)&&(C[B]=D[B])}}return C},p.shrinkBuf=function(C,M){return C.length===M?C:C.subarray?C.subarray(0,M):(C.length=M,C)};var _={arraySet:function(C,M,D,B,U){if(M.subarray&&C.subarray)C.set(M.subarray(D,D+B),U);else for(var j=0;j<B;j++)C[U+j]=M[D+j]},flattenChunks:function(C){var M,D,B,U,j,H;for(M=B=0,D=C.length;M<D;M++)B+=C[M].length;for(H=new Uint8Array(B),M=U=0,D=C.length;M<D;M++)j=C[M],H.set(j,U),U+=j.length;return H}},s={arraySet:function(C,M,D,B,U){for(var j=0;j<B;j++)C[U+j]=M[D+j]},flattenChunks:function(C){return[].concat.apply([],C)}};p.setTyped=function(C){C?(p.Buf8=Uint8Array,p.Buf16=Uint16Array,p.Buf32=Int32Array,p.assign(p,_)):(p.Buf8=Array,p.Buf16=Array,p.Buf32=Array,p.assign(p,s))},p.setTyped(b)},{}],42:[function(l,f,p){var b=l("./common"),_=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch{_=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{s=!1}for(var C=new b.Buf8(256),M=0;M<256;M++)C[M]=252<=M?6:248<=M?5:240<=M?4:224<=M?3:192<=M?2:1;function D(B,U){if(U<65537&&(B.subarray&&s||!B.subarray&&_))return String.fromCharCode.apply(null,b.shrinkBuf(B,U));for(var j="",H=0;H<U;H++)j+=String.fromCharCode(B[H]);return j}C[254]=C[254]=1,p.string2buf=function(B){var U,j,H,z,N,Z=B.length,Y=0;for(z=0;z<Z;z++)(64512&(j=B.charCodeAt(z)))==55296&&z+1<Z&&(64512&(H=B.charCodeAt(z+1)))==56320&&(j=65536+(j-55296<<10)+(H-56320),z++),Y+=j<128?1:j<2048?2:j<65536?3:4;for(U=new b.Buf8(Y),z=N=0;N<Y;z++)(64512&(j=B.charCodeAt(z)))==55296&&z+1<Z&&(64512&(H=B.charCodeAt(z+1)))==56320&&(j=65536+(j-55296<<10)+(H-56320),z++),j<128?U[N++]=j:(j<2048?U[N++]=192|j>>>6:(j<65536?U[N++]=224|j>>>12:(U[N++]=240|j>>>18,U[N++]=128|j>>>12&63),U[N++]=128|j>>>6&63),U[N++]=128|63&j);return U},p.buf2binstring=function(B){return D(B,B.length)},p.binstring2buf=function(B){for(var U=new b.Buf8(B.length),j=0,H=U.length;j<H;j++)U[j]=B.charCodeAt(j);return U},p.buf2string=function(B,U){var j,H,z,N,Z=U||B.length,Y=new Array(2*Z);for(j=H=0;j<Z;)if((z=B[j++])<128)Y[H++]=z;else if(4<(N=C[z]))Y[H++]=65533,j+=N-1;else{for(z&=N===2?31:N===3?15:7;1<N&&j<Z;)z=z<<6|63&B[j++],N--;1<N?Y[H++]=65533:z<65536?Y[H++]=z:(z-=65536,Y[H++]=55296|z>>10&1023,Y[H++]=56320|1023&z)}return D(Y,H)},p.utf8border=function(B,U){var j;for((U=U||B.length)>B.length&&(U=B.length),j=U-1;0<=j&&(192&B[j])==128;)j--;return j<0||j===0?U:j+C[B[j]]>U?j:U}},{"./common":41}],43:[function(l,f,p){f.exports=function(b,_,s,C){for(var M=65535&b|0,D=b>>>16&65535|0,B=0;s!==0;){for(s-=B=2e3<s?2e3:s;D=D+(M=M+_[C++]|0)|0,--B;);M%=65521,D%=65521}return M|D<<16|0}},{}],44:[function(l,f,p){f.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(l,f,p){var b=(function(){for(var _,s=[],C=0;C<256;C++){_=C;for(var M=0;M<8;M++)_=1&_?3988292384^_>>>1:_>>>1;s[C]=_}return s})();f.exports=function(_,s,C,M){var D=b,B=M+C;_^=-1;for(var U=M;U<B;U++)_=_>>>8^D[255&(_^s[U])];return-1^_}},{}],46:[function(l,f,p){var b,_=l("../utils/common"),s=l("./trees"),C=l("./adler32"),M=l("./crc32"),D=l("./messages"),B=0,U=4,j=0,H=-2,z=-1,N=4,Z=2,Y=8,W=9,de=286,ge=30,ve=19,ie=2*de+1,Me=15,we=3,Ge=258,et=Ge+we+1,pe=42,Je=113,le=1,ut=2,tt=3,We=4;function $t(se,Rt){return se.msg=D[Rt],Rt}function Be(se){return(se<<1)-(4<se?9:0)}function Mt(se){for(var Rt=se.length;0<=--Rt;)se[Rt]=0}function me(se){var Rt=se.state,yt=Rt.pending;yt>se.avail_out&&(yt=se.avail_out),yt!==0&&(_.arraySet(se.output,Rt.pending_buf,Rt.pending_out,yt,se.next_out),se.next_out+=yt,Rt.pending_out+=yt,se.total_out+=yt,se.avail_out-=yt,Rt.pending-=yt,Rt.pending===0&&(Rt.pending_out=0))}function re(se,Rt){s._tr_flush_block(se,0<=se.block_start?se.block_start:-1,se.strstart-se.block_start,Rt),se.block_start=se.strstart,me(se.strm)}function Ve(se,Rt){se.pending_buf[se.pending++]=Rt}function Pe(se,Rt){se.pending_buf[se.pending++]=Rt>>>8&255,se.pending_buf[se.pending++]=255&Rt}function De(se,Rt){var yt,Ee,Ne=se.max_chain_length,dt=se.strstart,Kt=se.prev_length,Jt=se.nice_match,kt=se.strstart>se.w_size-et?se.strstart-(se.w_size-et):0,lr=se.window,pr=se.w_mask,sr=se.prev,st=se.strstart+Ge,fe=lr[dt+Kt-1],ue=lr[dt+Kt];se.prev_length>=se.good_match&&(Ne>>=2),Jt>se.lookahead&&(Jt=se.lookahead);do if(lr[(yt=Rt)+Kt]===ue&&lr[yt+Kt-1]===fe&&lr[yt]===lr[dt]&&lr[++yt]===lr[dt+1]){dt+=2,yt++;do;while(lr[++dt]===lr[++yt]&&lr[++dt]===lr[++yt]&&lr[++dt]===lr[++yt]&&lr[++dt]===lr[++yt]&&lr[++dt]===lr[++yt]&&lr[++dt]===lr[++yt]&&lr[++dt]===lr[++yt]&&lr[++dt]===lr[++yt]&&dt<st);if(Ee=Ge-(st-dt),dt=st-Ge,Kt<Ee){if(se.match_start=Rt,Jt<=(Kt=Ee))break;fe=lr[dt+Kt-1],ue=lr[dt+Kt]}}while((Rt=sr[Rt&pr])>kt&&--Ne!=0);return Kt<=se.lookahead?Kt:se.lookahead}function bt(se){var Rt,yt,Ee,Ne,dt,Kt,Jt,kt,lr,pr,sr=se.w_size;do{if(Ne=se.window_size-se.lookahead-se.strstart,se.strstart>=sr+(sr-et)){for(_.arraySet(se.window,se.window,sr,sr,0),se.match_start-=sr,se.strstart-=sr,se.block_start-=sr,Rt=yt=se.hash_size;Ee=se.head[--Rt],se.head[Rt]=sr<=Ee?Ee-sr:0,--yt;);for(Rt=yt=sr;Ee=se.prev[--Rt],se.prev[Rt]=sr<=Ee?Ee-sr:0,--yt;);Ne+=sr}if(se.strm.avail_in===0)break;if(Kt=se.strm,Jt=se.window,kt=se.strstart+se.lookahead,lr=Ne,pr=void 0,pr=Kt.avail_in,lr<pr&&(pr=lr),yt=pr===0?0:(Kt.avail_in-=pr,_.arraySet(Jt,Kt.input,Kt.next_in,pr,kt),Kt.state.wrap===1?Kt.adler=C(Kt.adler,Jt,pr,kt):Kt.state.wrap===2&&(Kt.adler=M(Kt.adler,Jt,pr,kt)),Kt.next_in+=pr,Kt.total_in+=pr,pr),se.lookahead+=yt,se.lookahead+se.insert>=we)for(dt=se.strstart-se.insert,se.ins_h=se.window[dt],se.ins_h=(se.ins_h<<se.hash_shift^se.window[dt+1])&se.hash_mask;se.insert&&(se.ins_h=(se.ins_h<<se.hash_shift^se.window[dt+we-1])&se.hash_mask,se.prev[dt&se.w_mask]=se.head[se.ins_h],se.head[se.ins_h]=dt,dt++,se.insert--,!(se.lookahead+se.insert<we)););}while(se.lookahead<et&&se.strm.avail_in!==0)}function Vt(se,Rt){for(var yt,Ee;;){if(se.lookahead<et){if(bt(se),se.lookahead<et&&Rt===B)return le;if(se.lookahead===0)break}if(yt=0,se.lookahead>=we&&(se.ins_h=(se.ins_h<<se.hash_shift^se.window[se.strstart+we-1])&se.hash_mask,yt=se.prev[se.strstart&se.w_mask]=se.head[se.ins_h],se.head[se.ins_h]=se.strstart),yt!==0&&se.strstart-yt<=se.w_size-et&&(se.match_length=De(se,yt)),se.match_length>=we)if(Ee=s._tr_tally(se,se.strstart-se.match_start,se.match_length-we),se.lookahead-=se.match_length,se.match_length<=se.max_lazy_match&&se.lookahead>=we){for(se.match_length--;se.strstart++,se.ins_h=(se.ins_h<<se.hash_shift^se.window[se.strstart+we-1])&se.hash_mask,yt=se.prev[se.strstart&se.w_mask]=se.head[se.ins_h],se.head[se.ins_h]=se.strstart,--se.match_length!=0;);se.strstart++}else se.strstart+=se.match_length,se.match_length=0,se.ins_h=se.window[se.strstart],se.ins_h=(se.ins_h<<se.hash_shift^se.window[se.strstart+1])&se.hash_mask;else Ee=s._tr_tally(se,0,se.window[se.strstart]),se.lookahead--,se.strstart++;if(Ee&&(re(se,!1),se.strm.avail_out===0))return le}return se.insert=se.strstart<we-1?se.strstart:we-1,Rt===U?(re(se,!0),se.strm.avail_out===0?tt:We):se.last_lit&&(re(se,!1),se.strm.avail_out===0)?le:ut}function Zt(se,Rt){for(var yt,Ee,Ne;;){if(se.lookahead<et){if(bt(se),se.lookahead<et&&Rt===B)return le;if(se.lookahead===0)break}if(yt=0,se.lookahead>=we&&(se.ins_h=(se.ins_h<<se.hash_shift^se.window[se.strstart+we-1])&se.hash_mask,yt=se.prev[se.strstart&se.w_mask]=se.head[se.ins_h],se.head[se.ins_h]=se.strstart),se.prev_length=se.match_length,se.prev_match=se.match_start,se.match_length=we-1,yt!==0&&se.prev_length<se.max_lazy_match&&se.strstart-yt<=se.w_size-et&&(se.match_length=De(se,yt),se.match_length<=5&&(se.strategy===1||se.match_length===we&&4096<se.strstart-se.match_start)&&(se.match_length=we-1)),se.prev_length>=we&&se.match_length<=se.prev_length){for(Ne=se.strstart+se.lookahead-we,Ee=s._tr_tally(se,se.strstart-1-se.prev_match,se.prev_length-we),se.lookahead-=se.prev_length-1,se.prev_length-=2;++se.strstart<=Ne&&(se.ins_h=(se.ins_h<<se.hash_shift^se.window[se.strstart+we-1])&se.hash_mask,yt=se.prev[se.strstart&se.w_mask]=se.head[se.ins_h],se.head[se.ins_h]=se.strstart),--se.prev_length!=0;);if(se.match_available=0,se.match_length=we-1,se.strstart++,Ee&&(re(se,!1),se.strm.avail_out===0))return le}else if(se.match_available){if((Ee=s._tr_tally(se,0,se.window[se.strstart-1]))&&re(se,!1),se.strstart++,se.lookahead--,se.strm.avail_out===0)return le}else se.match_available=1,se.strstart++,se.lookahead--}return se.match_available&&(Ee=s._tr_tally(se,0,se.window[se.strstart-1]),se.match_available=0),se.insert=se.strstart<we-1?se.strstart:we-1,Rt===U?(re(se,!0),se.strm.avail_out===0?tt:We):se.last_lit&&(re(se,!1),se.strm.avail_out===0)?le:ut}function jt(se,Rt,yt,Ee,Ne){this.good_length=se,this.max_lazy=Rt,this.nice_length=yt,this.max_chain=Ee,this.func=Ne}function Yt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Y,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new _.Buf16(2*ie),this.dyn_dtree=new _.Buf16(2*(2*ge+1)),this.bl_tree=new _.Buf16(2*(2*ve+1)),Mt(this.dyn_ltree),Mt(this.dyn_dtree),Mt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new _.Buf16(Me+1),this.heap=new _.Buf16(2*de+1),Mt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new _.Buf16(2*de+1),Mt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function jr(se){var Rt;return se&&se.state?(se.total_in=se.total_out=0,se.data_type=Z,(Rt=se.state).pending=0,Rt.pending_out=0,Rt.wrap<0&&(Rt.wrap=-Rt.wrap),Rt.status=Rt.wrap?pe:Je,se.adler=Rt.wrap===2?0:1,Rt.last_flush=B,s._tr_init(Rt),j):$t(se,H)}function Qe(se){var Rt=jr(se);return Rt===j&&(function(yt){yt.window_size=2*yt.w_size,Mt(yt.head),yt.max_lazy_match=b[yt.level].max_lazy,yt.good_match=b[yt.level].good_length,yt.nice_match=b[yt.level].nice_length,yt.max_chain_length=b[yt.level].max_chain,yt.strstart=0,yt.block_start=0,yt.lookahead=0,yt.insert=0,yt.match_length=yt.prev_length=we-1,yt.match_available=0,yt.ins_h=0})(se.state),Rt}function _n(se,Rt,yt,Ee,Ne,dt){if(!se)return H;var Kt=1;if(Rt===z&&(Rt=6),Ee<0?(Kt=0,Ee=-Ee):15<Ee&&(Kt=2,Ee-=16),Ne<1||W<Ne||yt!==Y||Ee<8||15<Ee||Rt<0||9<Rt||dt<0||N<dt)return $t(se,H);Ee===8&&(Ee=9);var Jt=new Yt;return(se.state=Jt).strm=se,Jt.wrap=Kt,Jt.gzhead=null,Jt.w_bits=Ee,Jt.w_size=1<<Jt.w_bits,Jt.w_mask=Jt.w_size-1,Jt.hash_bits=Ne+7,Jt.hash_size=1<<Jt.hash_bits,Jt.hash_mask=Jt.hash_size-1,Jt.hash_shift=~~((Jt.hash_bits+we-1)/we),Jt.window=new _.Buf8(2*Jt.w_size),Jt.head=new _.Buf16(Jt.hash_size),Jt.prev=new _.Buf16(Jt.w_size),Jt.lit_bufsize=1<<Ne+6,Jt.pending_buf_size=4*Jt.lit_bufsize,Jt.pending_buf=new _.Buf8(Jt.pending_buf_size),Jt.d_buf=1*Jt.lit_bufsize,Jt.l_buf=3*Jt.lit_bufsize,Jt.level=Rt,Jt.strategy=dt,Jt.method=yt,Qe(se)}b=[new jt(0,0,0,0,function(se,Rt){var yt=65535;for(yt>se.pending_buf_size-5&&(yt=se.pending_buf_size-5);;){if(se.lookahead<=1){if(bt(se),se.lookahead===0&&Rt===B)return le;if(se.lookahead===0)break}se.strstart+=se.lookahead,se.lookahead=0;var Ee=se.block_start+yt;if((se.strstart===0||se.strstart>=Ee)&&(se.lookahead=se.strstart-Ee,se.strstart=Ee,re(se,!1),se.strm.avail_out===0)||se.strstart-se.block_start>=se.w_size-et&&(re(se,!1),se.strm.avail_out===0))return le}return se.insert=0,Rt===U?(re(se,!0),se.strm.avail_out===0?tt:We):(se.strstart>se.block_start&&(re(se,!1),se.strm.avail_out),le)}),new jt(4,4,8,4,Vt),new jt(4,5,16,8,Vt),new jt(4,6,32,32,Vt),new jt(4,4,16,16,Zt),new jt(8,16,32,32,Zt),new jt(8,16,128,128,Zt),new jt(8,32,128,256,Zt),new jt(32,128,258,1024,Zt),new jt(32,258,258,4096,Zt)],p.deflateInit=function(se,Rt){return _n(se,Rt,Y,15,8,0)},p.deflateInit2=_n,p.deflateReset=Qe,p.deflateResetKeep=jr,p.deflateSetHeader=function(se,Rt){return se&&se.state?se.state.wrap!==2?H:(se.state.gzhead=Rt,j):H},p.deflate=function(se,Rt){var yt,Ee,Ne,dt;if(!se||!se.state||5<Rt||Rt<0)return se?$t(se,H):H;if(Ee=se.state,!se.output||!se.input&&se.avail_in!==0||Ee.status===666&&Rt!==U)return $t(se,se.avail_out===0?-5:H);if(Ee.strm=se,yt=Ee.last_flush,Ee.last_flush=Rt,Ee.status===pe)if(Ee.wrap===2)se.adler=0,Ve(Ee,31),Ve(Ee,139),Ve(Ee,8),Ee.gzhead?(Ve(Ee,(Ee.gzhead.text?1:0)+(Ee.gzhead.hcrc?2:0)+(Ee.gzhead.extra?4:0)+(Ee.gzhead.name?8:0)+(Ee.gzhead.comment?16:0)),Ve(Ee,255&Ee.gzhead.time),Ve(Ee,Ee.gzhead.time>>8&255),Ve(Ee,Ee.gzhead.time>>16&255),Ve(Ee,Ee.gzhead.time>>24&255),Ve(Ee,Ee.level===9?2:2<=Ee.strategy||Ee.level<2?4:0),Ve(Ee,255&Ee.gzhead.os),Ee.gzhead.extra&&Ee.gzhead.extra.length&&(Ve(Ee,255&Ee.gzhead.extra.length),Ve(Ee,Ee.gzhead.extra.length>>8&255)),Ee.gzhead.hcrc&&(se.adler=M(se.adler,Ee.pending_buf,Ee.pending,0)),Ee.gzindex=0,Ee.status=69):(Ve(Ee,0),Ve(Ee,0),Ve(Ee,0),Ve(Ee,0),Ve(Ee,0),Ve(Ee,Ee.level===9?2:2<=Ee.strategy||Ee.level<2?4:0),Ve(Ee,3),Ee.status=Je);else{var Kt=Y+(Ee.w_bits-8<<4)<<8;Kt|=(2<=Ee.strategy||Ee.level<2?0:Ee.level<6?1:Ee.level===6?2:3)<<6,Ee.strstart!==0&&(Kt|=32),Kt+=31-Kt%31,Ee.status=Je,Pe(Ee,Kt),Ee.strstart!==0&&(Pe(Ee,se.adler>>>16),Pe(Ee,65535&se.adler)),se.adler=1}if(Ee.status===69)if(Ee.gzhead.extra){for(Ne=Ee.pending;Ee.gzindex<(65535&Ee.gzhead.extra.length)&&(Ee.pending!==Ee.pending_buf_size||(Ee.gzhead.hcrc&&Ee.pending>Ne&&(se.adler=M(se.adler,Ee.pending_buf,Ee.pending-Ne,Ne)),me(se),Ne=Ee.pending,Ee.pending!==Ee.pending_buf_size));)Ve(Ee,255&Ee.gzhead.extra[Ee.gzindex]),Ee.gzindex++;Ee.gzhead.hcrc&&Ee.pending>Ne&&(se.adler=M(se.adler,Ee.pending_buf,Ee.pending-Ne,Ne)),Ee.gzindex===Ee.gzhead.extra.length&&(Ee.gzindex=0,Ee.status=73)}else Ee.status=73;if(Ee.status===73)if(Ee.gzhead.name){Ne=Ee.pending;do{if(Ee.pending===Ee.pending_buf_size&&(Ee.gzhead.hcrc&&Ee.pending>Ne&&(se.adler=M(se.adler,Ee.pending_buf,Ee.pending-Ne,Ne)),me(se),Ne=Ee.pending,Ee.pending===Ee.pending_buf_size)){dt=1;break}dt=Ee.gzindex<Ee.gzhead.name.length?255&Ee.gzhead.name.charCodeAt(Ee.gzindex++):0,Ve(Ee,dt)}while(dt!==0);Ee.gzhead.hcrc&&Ee.pending>Ne&&(se.adler=M(se.adler,Ee.pending_buf,Ee.pending-Ne,Ne)),dt===0&&(Ee.gzindex=0,Ee.status=91)}else Ee.status=91;if(Ee.status===91)if(Ee.gzhead.comment){Ne=Ee.pending;do{if(Ee.pending===Ee.pending_buf_size&&(Ee.gzhead.hcrc&&Ee.pending>Ne&&(se.adler=M(se.adler,Ee.pending_buf,Ee.pending-Ne,Ne)),me(se),Ne=Ee.pending,Ee.pending===Ee.pending_buf_size)){dt=1;break}dt=Ee.gzindex<Ee.gzhead.comment.length?255&Ee.gzhead.comment.charCodeAt(Ee.gzindex++):0,Ve(Ee,dt)}while(dt!==0);Ee.gzhead.hcrc&&Ee.pending>Ne&&(se.adler=M(se.adler,Ee.pending_buf,Ee.pending-Ne,Ne)),dt===0&&(Ee.status=103)}else Ee.status=103;if(Ee.status===103&&(Ee.gzhead.hcrc?(Ee.pending+2>Ee.pending_buf_size&&me(se),Ee.pending+2<=Ee.pending_buf_size&&(Ve(Ee,255&se.adler),Ve(Ee,se.adler>>8&255),se.adler=0,Ee.status=Je)):Ee.status=Je),Ee.pending!==0){if(me(se),se.avail_out===0)return Ee.last_flush=-1,j}else if(se.avail_in===0&&Be(Rt)<=Be(yt)&&Rt!==U)return $t(se,-5);if(Ee.status===666&&se.avail_in!==0)return $t(se,-5);if(se.avail_in!==0||Ee.lookahead!==0||Rt!==B&&Ee.status!==666){var Jt=Ee.strategy===2?(function(kt,lr){for(var pr;;){if(kt.lookahead===0&&(bt(kt),kt.lookahead===0)){if(lr===B)return le;break}if(kt.match_length=0,pr=s._tr_tally(kt,0,kt.window[kt.strstart]),kt.lookahead--,kt.strstart++,pr&&(re(kt,!1),kt.strm.avail_out===0))return le}return kt.insert=0,lr===U?(re(kt,!0),kt.strm.avail_out===0?tt:We):kt.last_lit&&(re(kt,!1),kt.strm.avail_out===0)?le:ut})(Ee,Rt):Ee.strategy===3?(function(kt,lr){for(var pr,sr,st,fe,ue=kt.window;;){if(kt.lookahead<=Ge){if(bt(kt),kt.lookahead<=Ge&&lr===B)return le;if(kt.lookahead===0)break}if(kt.match_length=0,kt.lookahead>=we&&0<kt.strstart&&(sr=ue[st=kt.strstart-1])===ue[++st]&&sr===ue[++st]&&sr===ue[++st]){fe=kt.strstart+Ge;do;while(sr===ue[++st]&&sr===ue[++st]&&sr===ue[++st]&&sr===ue[++st]&&sr===ue[++st]&&sr===ue[++st]&&sr===ue[++st]&&sr===ue[++st]&&st<fe);kt.match_length=Ge-(fe-st),kt.match_length>kt.lookahead&&(kt.match_length=kt.lookahead)}if(kt.match_length>=we?(pr=s._tr_tally(kt,1,kt.match_length-we),kt.lookahead-=kt.match_length,kt.strstart+=kt.match_length,kt.match_length=0):(pr=s._tr_tally(kt,0,kt.window[kt.strstart]),kt.lookahead--,kt.strstart++),pr&&(re(kt,!1),kt.strm.avail_out===0))return le}return kt.insert=0,lr===U?(re(kt,!0),kt.strm.avail_out===0?tt:We):kt.last_lit&&(re(kt,!1),kt.strm.avail_out===0)?le:ut})(Ee,Rt):b[Ee.level].func(Ee,Rt);if(Jt!==tt&&Jt!==We||(Ee.status=666),Jt===le||Jt===tt)return se.avail_out===0&&(Ee.last_flush=-1),j;if(Jt===ut&&(Rt===1?s._tr_align(Ee):Rt!==5&&(s._tr_stored_block(Ee,0,0,!1),Rt===3&&(Mt(Ee.head),Ee.lookahead===0&&(Ee.strstart=0,Ee.block_start=0,Ee.insert=0))),me(se),se.avail_out===0))return Ee.last_flush=-1,j}return Rt!==U?j:Ee.wrap<=0?1:(Ee.wrap===2?(Ve(Ee,255&se.adler),Ve(Ee,se.adler>>8&255),Ve(Ee,se.adler>>16&255),Ve(Ee,se.adler>>24&255),Ve(Ee,255&se.total_in),Ve(Ee,se.total_in>>8&255),Ve(Ee,se.total_in>>16&255),Ve(Ee,se.total_in>>24&255)):(Pe(Ee,se.adler>>>16),Pe(Ee,65535&se.adler)),me(se),0<Ee.wrap&&(Ee.wrap=-Ee.wrap),Ee.pending!==0?j:1)},p.deflateEnd=function(se){var Rt;return se&&se.state?(Rt=se.state.status)!==pe&&Rt!==69&&Rt!==73&&Rt!==91&&Rt!==103&&Rt!==Je&&Rt!==666?$t(se,H):(se.state=null,Rt===Je?$t(se,-3):j):H},p.deflateSetDictionary=function(se,Rt){var yt,Ee,Ne,dt,Kt,Jt,kt,lr,pr=Rt.length;if(!se||!se.state||(dt=(yt=se.state).wrap)===2||dt===1&&yt.status!==pe||yt.lookahead)return H;for(dt===1&&(se.adler=C(se.adler,Rt,pr,0)),yt.wrap=0,pr>=yt.w_size&&(dt===0&&(Mt(yt.head),yt.strstart=0,yt.block_start=0,yt.insert=0),lr=new _.Buf8(yt.w_size),_.arraySet(lr,Rt,pr-yt.w_size,yt.w_size,0),Rt=lr,pr=yt.w_size),Kt=se.avail_in,Jt=se.next_in,kt=se.input,se.avail_in=pr,se.next_in=0,se.input=Rt,bt(yt);yt.lookahead>=we;){for(Ee=yt.strstart,Ne=yt.lookahead-(we-1);yt.ins_h=(yt.ins_h<<yt.hash_shift^yt.window[Ee+we-1])&yt.hash_mask,yt.prev[Ee&yt.w_mask]=yt.head[yt.ins_h],yt.head[yt.ins_h]=Ee,Ee++,--Ne;);yt.strstart=Ee,yt.lookahead=we-1,bt(yt)}return yt.strstart+=yt.lookahead,yt.block_start=yt.strstart,yt.insert=yt.lookahead,yt.lookahead=0,yt.match_length=yt.prev_length=we-1,yt.match_available=0,se.next_in=Jt,se.input=kt,se.avail_in=Kt,yt.wrap=dt,j},p.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(l,f,p){f.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(l,f,p){f.exports=function(b,_){var s,C,M,D,B,U,j,H,z,N,Z,Y,W,de,ge,ve,ie,Me,we,Ge,et,pe,Je,le,ut;s=b.state,C=b.next_in,le=b.input,M=C+(b.avail_in-5),D=b.next_out,ut=b.output,B=D-(_-b.avail_out),U=D+(b.avail_out-257),j=s.dmax,H=s.wsize,z=s.whave,N=s.wnext,Z=s.window,Y=s.hold,W=s.bits,de=s.lencode,ge=s.distcode,ve=(1<<s.lenbits)-1,ie=(1<<s.distbits)-1;e:do{W<15&&(Y+=le[C++]<<W,W+=8,Y+=le[C++]<<W,W+=8),Me=de[Y&ve];t:for(;;){if(Y>>>=we=Me>>>24,W-=we,(we=Me>>>16&255)===0)ut[D++]=65535&Me;else{if(!(16&we)){if((64&we)==0){Me=de[(65535&Me)+(Y&(1<<we)-1)];continue t}if(32&we){s.mode=12;break e}b.msg="invalid literal/length code",s.mode=30;break e}Ge=65535&Me,(we&=15)&&(W<we&&(Y+=le[C++]<<W,W+=8),Ge+=Y&(1<<we)-1,Y>>>=we,W-=we),W<15&&(Y+=le[C++]<<W,W+=8,Y+=le[C++]<<W,W+=8),Me=ge[Y&ie];r:for(;;){if(Y>>>=we=Me>>>24,W-=we,!(16&(we=Me>>>16&255))){if((64&we)==0){Me=ge[(65535&Me)+(Y&(1<<we)-1)];continue r}b.msg="invalid distance code",s.mode=30;break e}if(et=65535&Me,W<(we&=15)&&(Y+=le[C++]<<W,(W+=8)<we&&(Y+=le[C++]<<W,W+=8)),j<(et+=Y&(1<<we)-1)){b.msg="invalid distance too far back",s.mode=30;break e}if(Y>>>=we,W-=we,(we=D-B)<et){if(z<(we=et-we)&&s.sane){b.msg="invalid distance too far back",s.mode=30;break e}if(Je=Z,(pe=0)===N){if(pe+=H-we,we<Ge){for(Ge-=we;ut[D++]=Z[pe++],--we;);pe=D-et,Je=ut}}else if(N<we){if(pe+=H+N-we,(we-=N)<Ge){for(Ge-=we;ut[D++]=Z[pe++],--we;);if(pe=0,N<Ge){for(Ge-=we=N;ut[D++]=Z[pe++],--we;);pe=D-et,Je=ut}}}else if(pe+=N-we,we<Ge){for(Ge-=we;ut[D++]=Z[pe++],--we;);pe=D-et,Je=ut}for(;2<Ge;)ut[D++]=Je[pe++],ut[D++]=Je[pe++],ut[D++]=Je[pe++],Ge-=3;Ge&&(ut[D++]=Je[pe++],1<Ge&&(ut[D++]=Je[pe++]))}else{for(pe=D-et;ut[D++]=ut[pe++],ut[D++]=ut[pe++],ut[D++]=ut[pe++],2<(Ge-=3););Ge&&(ut[D++]=ut[pe++],1<Ge&&(ut[D++]=ut[pe++]))}break}}break}}while(C<M&&D<U);C-=Ge=W>>3,Y&=(1<<(W-=Ge<<3))-1,b.next_in=C,b.next_out=D,b.avail_in=C<M?M-C+5:5-(C-M),b.avail_out=D<U?U-D+257:257-(D-U),s.hold=Y,s.bits=W}},{}],49:[function(l,f,p){var b=l("../utils/common"),_=l("./adler32"),s=l("./crc32"),C=l("./inffast"),M=l("./inftrees"),D=1,B=2,U=0,j=-2,H=1,z=852,N=592;function Z(pe){return(pe>>>24&255)+(pe>>>8&65280)+((65280&pe)<<8)+((255&pe)<<24)}function Y(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new b.Buf16(320),this.work=new b.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function W(pe){var Je;return pe&&pe.state?(Je=pe.state,pe.total_in=pe.total_out=Je.total=0,pe.msg="",Je.wrap&&(pe.adler=1&Je.wrap),Je.mode=H,Je.last=0,Je.havedict=0,Je.dmax=32768,Je.head=null,Je.hold=0,Je.bits=0,Je.lencode=Je.lendyn=new b.Buf32(z),Je.distcode=Je.distdyn=new b.Buf32(N),Je.sane=1,Je.back=-1,U):j}function de(pe){var Je;return pe&&pe.state?((Je=pe.state).wsize=0,Je.whave=0,Je.wnext=0,W(pe)):j}function ge(pe,Je){var le,ut;return pe&&pe.state?(ut=pe.state,Je<0?(le=0,Je=-Je):(le=1+(Je>>4),Je<48&&(Je&=15)),Je&&(Je<8||15<Je)?j:(ut.window!==null&&ut.wbits!==Je&&(ut.window=null),ut.wrap=le,ut.wbits=Je,de(pe))):j}function ve(pe,Je){var le,ut;return pe?(ut=new Y,(pe.state=ut).window=null,(le=ge(pe,Je))!==U&&(pe.state=null),le):j}var ie,Me,we=!0;function Ge(pe){if(we){var Je;for(ie=new b.Buf32(512),Me=new b.Buf32(32),Je=0;Je<144;)pe.lens[Je++]=8;for(;Je<256;)pe.lens[Je++]=9;for(;Je<280;)pe.lens[Je++]=7;for(;Je<288;)pe.lens[Je++]=8;for(M(D,pe.lens,0,288,ie,0,pe.work,{bits:9}),Je=0;Je<32;)pe.lens[Je++]=5;M(B,pe.lens,0,32,Me,0,pe.work,{bits:5}),we=!1}pe.lencode=ie,pe.lenbits=9,pe.distcode=Me,pe.distbits=5}function et(pe,Je,le,ut){var tt,We=pe.state;return We.window===null&&(We.wsize=1<<We.wbits,We.wnext=0,We.whave=0,We.window=new b.Buf8(We.wsize)),ut>=We.wsize?(b.arraySet(We.window,Je,le-We.wsize,We.wsize,0),We.wnext=0,We.whave=We.wsize):(ut<(tt=We.wsize-We.wnext)&&(tt=ut),b.arraySet(We.window,Je,le-ut,tt,We.wnext),(ut-=tt)?(b.arraySet(We.window,Je,le-ut,ut,0),We.wnext=ut,We.whave=We.wsize):(We.wnext+=tt,We.wnext===We.wsize&&(We.wnext=0),We.whave<We.wsize&&(We.whave+=tt))),0}p.inflateReset=de,p.inflateReset2=ge,p.inflateResetKeep=W,p.inflateInit=function(pe){return ve(pe,15)},p.inflateInit2=ve,p.inflate=function(pe,Je){var le,ut,tt,We,$t,Be,Mt,me,re,Ve,Pe,De,bt,Vt,Zt,jt,Yt,jr,Qe,_n,se,Rt,yt,Ee,Ne=0,dt=new b.Buf8(4),Kt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!pe||!pe.state||!pe.output||!pe.input&&pe.avail_in!==0)return j;(le=pe.state).mode===12&&(le.mode=13),$t=pe.next_out,tt=pe.output,Mt=pe.avail_out,We=pe.next_in,ut=pe.input,Be=pe.avail_in,me=le.hold,re=le.bits,Ve=Be,Pe=Mt,Rt=U;e:for(;;)switch(le.mode){case H:if(le.wrap===0){le.mode=13;break}for(;re<16;){if(Be===0)break e;Be--,me+=ut[We++]<<re,re+=8}if(2&le.wrap&&me===35615){dt[le.check=0]=255&me,dt[1]=me>>>8&255,le.check=s(le.check,dt,2,0),re=me=0,le.mode=2;break}if(le.flags=0,le.head&&(le.head.done=!1),!(1&le.wrap)||(((255&me)<<8)+(me>>8))%31){pe.msg="incorrect header check",le.mode=30;break}if((15&me)!=8){pe.msg="unknown compression method",le.mode=30;break}if(re-=4,se=8+(15&(me>>>=4)),le.wbits===0)le.wbits=se;else if(se>le.wbits){pe.msg="invalid window size",le.mode=30;break}le.dmax=1<<se,pe.adler=le.check=1,le.mode=512&me?10:12,re=me=0;break;case 2:for(;re<16;){if(Be===0)break e;Be--,me+=ut[We++]<<re,re+=8}if(le.flags=me,(255&le.flags)!=8){pe.msg="unknown compression method",le.mode=30;break}if(57344&le.flags){pe.msg="unknown header flags set",le.mode=30;break}le.head&&(le.head.text=me>>8&1),512&le.flags&&(dt[0]=255&me,dt[1]=me>>>8&255,le.check=s(le.check,dt,2,0)),re=me=0,le.mode=3;case 3:for(;re<32;){if(Be===0)break e;Be--,me+=ut[We++]<<re,re+=8}le.head&&(le.head.time=me),512&le.flags&&(dt[0]=255&me,dt[1]=me>>>8&255,dt[2]=me>>>16&255,dt[3]=me>>>24&255,le.check=s(le.check,dt,4,0)),re=me=0,le.mode=4;case 4:for(;re<16;){if(Be===0)break e;Be--,me+=ut[We++]<<re,re+=8}le.head&&(le.head.xflags=255&me,le.head.os=me>>8),512&le.flags&&(dt[0]=255&me,dt[1]=me>>>8&255,le.check=s(le.check,dt,2,0)),re=me=0,le.mode=5;case 5:if(1024&le.flags){for(;re<16;){if(Be===0)break e;Be--,me+=ut[We++]<<re,re+=8}le.length=me,le.head&&(le.head.extra_len=me),512&le.flags&&(dt[0]=255&me,dt[1]=me>>>8&255,le.check=s(le.check,dt,2,0)),re=me=0}else le.head&&(le.head.extra=null);le.mode=6;case 6:if(1024&le.flags&&(Be<(De=le.length)&&(De=Be),De&&(le.head&&(se=le.head.extra_len-le.length,le.head.extra||(le.head.extra=new Array(le.head.extra_len)),b.arraySet(le.head.extra,ut,We,De,se)),512&le.flags&&(le.check=s(le.check,ut,De,We)),Be-=De,We+=De,le.length-=De),le.length))break e;le.length=0,le.mode=7;case 7:if(2048&le.flags){if(Be===0)break e;for(De=0;se=ut[We+De++],le.head&&se&&le.length<65536&&(le.head.name+=String.fromCharCode(se)),se&&De<Be;);if(512&le.flags&&(le.check=s(le.check,ut,De,We)),Be-=De,We+=De,se)break e}else le.head&&(le.head.name=null);le.length=0,le.mode=8;case 8:if(4096&le.flags){if(Be===0)break e;for(De=0;se=ut[We+De++],le.head&&se&&le.length<65536&&(le.head.comment+=String.fromCharCode(se)),se&&De<Be;);if(512&le.flags&&(le.check=s(le.check,ut,De,We)),Be-=De,We+=De,se)break e}else le.head&&(le.head.comment=null);le.mode=9;case 9:if(512&le.flags){for(;re<16;){if(Be===0)break e;Be--,me+=ut[We++]<<re,re+=8}if(me!==(65535&le.check)){pe.msg="header crc mismatch",le.mode=30;break}re=me=0}le.head&&(le.head.hcrc=le.flags>>9&1,le.head.done=!0),pe.adler=le.check=0,le.mode=12;break;case 10:for(;re<32;){if(Be===0)break e;Be--,me+=ut[We++]<<re,re+=8}pe.adler=le.check=Z(me),re=me=0,le.mode=11;case 11:if(le.havedict===0)return pe.next_out=$t,pe.avail_out=Mt,pe.next_in=We,pe.avail_in=Be,le.hold=me,le.bits=re,2;pe.adler=le.check=1,le.mode=12;case 12:if(Je===5||Je===6)break e;case 13:if(le.last){me>>>=7&re,re-=7&re,le.mode=27;break}for(;re<3;){if(Be===0)break e;Be--,me+=ut[We++]<<re,re+=8}switch(le.last=1&me,re-=1,3&(me>>>=1)){case 0:le.mode=14;break;case 1:if(Ge(le),le.mode=20,Je!==6)break;me>>>=2,re-=2;break e;case 2:le.mode=17;break;case 3:pe.msg="invalid block type",le.mode=30}me>>>=2,re-=2;break;case 14:for(me>>>=7&re,re-=7&re;re<32;){if(Be===0)break e;Be--,me+=ut[We++]<<re,re+=8}if((65535&me)!=(me>>>16^65535)){pe.msg="invalid stored block lengths",le.mode=30;break}if(le.length=65535&me,re=me=0,le.mode=15,Je===6)break e;case 15:le.mode=16;case 16:if(De=le.length){if(Be<De&&(De=Be),Mt<De&&(De=Mt),De===0)break e;b.arraySet(tt,ut,We,De,$t),Be-=De,We+=De,Mt-=De,$t+=De,le.length-=De;break}le.mode=12;break;case 17:for(;re<14;){if(Be===0)break e;Be--,me+=ut[We++]<<re,re+=8}if(le.nlen=257+(31&me),me>>>=5,re-=5,le.ndist=1+(31&me),me>>>=5,re-=5,le.ncode=4+(15&me),me>>>=4,re-=4,286<le.nlen||30<le.ndist){pe.msg="too many length or distance symbols",le.mode=30;break}le.have=0,le.mode=18;case 18:for(;le.have<le.ncode;){for(;re<3;){if(Be===0)break e;Be--,me+=ut[We++]<<re,re+=8}le.lens[Kt[le.have++]]=7&me,me>>>=3,re-=3}for(;le.have<19;)le.lens[Kt[le.have++]]=0;if(le.lencode=le.lendyn,le.lenbits=7,yt={bits:le.lenbits},Rt=M(0,le.lens,0,19,le.lencode,0,le.work,yt),le.lenbits=yt.bits,Rt){pe.msg="invalid code lengths set",le.mode=30;break}le.have=0,le.mode=19;case 19:for(;le.have<le.nlen+le.ndist;){for(;jt=(Ne=le.lencode[me&(1<<le.lenbits)-1])>>>16&255,Yt=65535&Ne,!((Zt=Ne>>>24)<=re);){if(Be===0)break e;Be--,me+=ut[We++]<<re,re+=8}if(Yt<16)me>>>=Zt,re-=Zt,le.lens[le.have++]=Yt;else{if(Yt===16){for(Ee=Zt+2;re<Ee;){if(Be===0)break e;Be--,me+=ut[We++]<<re,re+=8}if(me>>>=Zt,re-=Zt,le.have===0){pe.msg="invalid bit length repeat",le.mode=30;break}se=le.lens[le.have-1],De=3+(3&me),me>>>=2,re-=2}else if(Yt===17){for(Ee=Zt+3;re<Ee;){if(Be===0)break e;Be--,me+=ut[We++]<<re,re+=8}re-=Zt,se=0,De=3+(7&(me>>>=Zt)),me>>>=3,re-=3}else{for(Ee=Zt+7;re<Ee;){if(Be===0)break e;Be--,me+=ut[We++]<<re,re+=8}re-=Zt,se=0,De=11+(127&(me>>>=Zt)),me>>>=7,re-=7}if(le.have+De>le.nlen+le.ndist){pe.msg="invalid bit length repeat",le.mode=30;break}for(;De--;)le.lens[le.have++]=se}}if(le.mode===30)break;if(le.lens[256]===0){pe.msg="invalid code -- missing end-of-block",le.mode=30;break}if(le.lenbits=9,yt={bits:le.lenbits},Rt=M(D,le.lens,0,le.nlen,le.lencode,0,le.work,yt),le.lenbits=yt.bits,Rt){pe.msg="invalid literal/lengths set",le.mode=30;break}if(le.distbits=6,le.distcode=le.distdyn,yt={bits:le.distbits},Rt=M(B,le.lens,le.nlen,le.ndist,le.distcode,0,le.work,yt),le.distbits=yt.bits,Rt){pe.msg="invalid distances set",le.mode=30;break}if(le.mode=20,Je===6)break e;case 20:le.mode=21;case 21:if(6<=Be&&258<=Mt){pe.next_out=$t,pe.avail_out=Mt,pe.next_in=We,pe.avail_in=Be,le.hold=me,le.bits=re,C(pe,Pe),$t=pe.next_out,tt=pe.output,Mt=pe.avail_out,We=pe.next_in,ut=pe.input,Be=pe.avail_in,me=le.hold,re=le.bits,le.mode===12&&(le.back=-1);break}for(le.back=0;jt=(Ne=le.lencode[me&(1<<le.lenbits)-1])>>>16&255,Yt=65535&Ne,!((Zt=Ne>>>24)<=re);){if(Be===0)break e;Be--,me+=ut[We++]<<re,re+=8}if(jt&&(240&jt)==0){for(jr=Zt,Qe=jt,_n=Yt;jt=(Ne=le.lencode[_n+((me&(1<<jr+Qe)-1)>>jr)])>>>16&255,Yt=65535&Ne,!(jr+(Zt=Ne>>>24)<=re);){if(Be===0)break e;Be--,me+=ut[We++]<<re,re+=8}me>>>=jr,re-=jr,le.back+=jr}if(me>>>=Zt,re-=Zt,le.back+=Zt,le.length=Yt,jt===0){le.mode=26;break}if(32&jt){le.back=-1,le.mode=12;break}if(64&jt){pe.msg="invalid literal/length code",le.mode=30;break}le.extra=15&jt,le.mode=22;case 22:if(le.extra){for(Ee=le.extra;re<Ee;){if(Be===0)break e;Be--,me+=ut[We++]<<re,re+=8}le.length+=me&(1<<le.extra)-1,me>>>=le.extra,re-=le.extra,le.back+=le.extra}le.was=le.length,le.mode=23;case 23:for(;jt=(Ne=le.distcode[me&(1<<le.distbits)-1])>>>16&255,Yt=65535&Ne,!((Zt=Ne>>>24)<=re);){if(Be===0)break e;Be--,me+=ut[We++]<<re,re+=8}if((240&jt)==0){for(jr=Zt,Qe=jt,_n=Yt;jt=(Ne=le.distcode[_n+((me&(1<<jr+Qe)-1)>>jr)])>>>16&255,Yt=65535&Ne,!(jr+(Zt=Ne>>>24)<=re);){if(Be===0)break e;Be--,me+=ut[We++]<<re,re+=8}me>>>=jr,re-=jr,le.back+=jr}if(me>>>=Zt,re-=Zt,le.back+=Zt,64&jt){pe.msg="invalid distance code",le.mode=30;break}le.offset=Yt,le.extra=15&jt,le.mode=24;case 24:if(le.extra){for(Ee=le.extra;re<Ee;){if(Be===0)break e;Be--,me+=ut[We++]<<re,re+=8}le.offset+=me&(1<<le.extra)-1,me>>>=le.extra,re-=le.extra,le.back+=le.extra}if(le.offset>le.dmax){pe.msg="invalid distance too far back",le.mode=30;break}le.mode=25;case 25:if(Mt===0)break e;if(De=Pe-Mt,le.offset>De){if((De=le.offset-De)>le.whave&&le.sane){pe.msg="invalid distance too far back",le.mode=30;break}bt=De>le.wnext?(De-=le.wnext,le.wsize-De):le.wnext-De,De>le.length&&(De=le.length),Vt=le.window}else Vt=tt,bt=$t-le.offset,De=le.length;for(Mt<De&&(De=Mt),Mt-=De,le.length-=De;tt[$t++]=Vt[bt++],--De;);le.length===0&&(le.mode=21);break;case 26:if(Mt===0)break e;tt[$t++]=le.length,Mt--,le.mode=21;break;case 27:if(le.wrap){for(;re<32;){if(Be===0)break e;Be--,me|=ut[We++]<<re,re+=8}if(Pe-=Mt,pe.total_out+=Pe,le.total+=Pe,Pe&&(pe.adler=le.check=le.flags?s(le.check,tt,Pe,$t-Pe):_(le.check,tt,Pe,$t-Pe)),Pe=Mt,(le.flags?me:Z(me))!==le.check){pe.msg="incorrect data check",le.mode=30;break}re=me=0}le.mode=28;case 28:if(le.wrap&&le.flags){for(;re<32;){if(Be===0)break e;Be--,me+=ut[We++]<<re,re+=8}if(me!==(4294967295&le.total)){pe.msg="incorrect length check",le.mode=30;break}re=me=0}le.mode=29;case 29:Rt=1;break e;case 30:Rt=-3;break e;case 31:return-4;default:return j}return pe.next_out=$t,pe.avail_out=Mt,pe.next_in=We,pe.avail_in=Be,le.hold=me,le.bits=re,(le.wsize||Pe!==pe.avail_out&&le.mode<30&&(le.mode<27||Je!==4))&&et(pe,pe.output,pe.next_out,Pe-pe.avail_out)?(le.mode=31,-4):(Ve-=pe.avail_in,Pe-=pe.avail_out,pe.total_in+=Ve,pe.total_out+=Pe,le.total+=Pe,le.wrap&&Pe&&(pe.adler=le.check=le.flags?s(le.check,tt,Pe,pe.next_out-Pe):_(le.check,tt,Pe,pe.next_out-Pe)),pe.data_type=le.bits+(le.last?64:0)+(le.mode===12?128:0)+(le.mode===20||le.mode===15?256:0),(Ve==0&&Pe===0||Je===4)&&Rt===U&&(Rt=-5),Rt)},p.inflateEnd=function(pe){if(!pe||!pe.state)return j;var Je=pe.state;return Je.window&&(Je.window=null),pe.state=null,U},p.inflateGetHeader=function(pe,Je){var le;return pe&&pe.state?(2&(le=pe.state).wrap)==0?j:((le.head=Je).done=!1,U):j},p.inflateSetDictionary=function(pe,Je){var le,ut=Je.length;return pe&&pe.state?(le=pe.state).wrap!==0&&le.mode!==11?j:le.mode===11&&_(1,Je,ut,0)!==le.check?-3:et(pe,Je,ut,ut)?(le.mode=31,-4):(le.havedict=1,U):j},p.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(l,f,p){var b=l("../utils/common"),_=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],C=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],M=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];f.exports=function(D,B,U,j,H,z,N,Z){var Y,W,de,ge,ve,ie,Me,we,Ge,et=Z.bits,pe=0,Je=0,le=0,ut=0,tt=0,We=0,$t=0,Be=0,Mt=0,me=0,re=null,Ve=0,Pe=new b.Buf16(16),De=new b.Buf16(16),bt=null,Vt=0;for(pe=0;pe<=15;pe++)Pe[pe]=0;for(Je=0;Je<j;Je++)Pe[B[U+Je]]++;for(tt=et,ut=15;1<=ut&&Pe[ut]===0;ut--);if(ut<tt&&(tt=ut),ut===0)return H[z++]=20971520,H[z++]=20971520,Z.bits=1,0;for(le=1;le<ut&&Pe[le]===0;le++);for(tt<le&&(tt=le),pe=Be=1;pe<=15;pe++)if(Be<<=1,(Be-=Pe[pe])<0)return-1;if(0<Be&&(D===0||ut!==1))return-1;for(De[1]=0,pe=1;pe<15;pe++)De[pe+1]=De[pe]+Pe[pe];for(Je=0;Je<j;Je++)B[U+Je]!==0&&(N[De[B[U+Je]]++]=Je);if(ie=D===0?(re=bt=N,19):D===1?(re=_,Ve-=257,bt=s,Vt-=257,256):(re=C,bt=M,-1),pe=le,ve=z,$t=Je=me=0,de=-1,ge=(Mt=1<<(We=tt))-1,D===1&&852<Mt||D===2&&592<Mt)return 1;for(;;){for(Me=pe-$t,Ge=N[Je]<ie?(we=0,N[Je]):N[Je]>ie?(we=bt[Vt+N[Je]],re[Ve+N[Je]]):(we=96,0),Y=1<<pe-$t,le=W=1<<We;H[ve+(me>>$t)+(W-=Y)]=Me<<24|we<<16|Ge|0,W!==0;);for(Y=1<<pe-1;me&Y;)Y>>=1;if(Y!==0?(me&=Y-1,me+=Y):me=0,Je++,--Pe[pe]==0){if(pe===ut)break;pe=B[U+N[Je]]}if(tt<pe&&(me&ge)!==de){for($t===0&&($t=tt),ve+=le,Be=1<<(We=pe-$t);We+$t<ut&&!((Be-=Pe[We+$t])<=0);)We++,Be<<=1;if(Mt+=1<<We,D===1&&852<Mt||D===2&&592<Mt)return 1;H[de=me&ge]=tt<<24|We<<16|ve-z|0}}return me!==0&&(H[ve+me]=pe-$t<<24|64<<16|0),Z.bits=tt,0}},{"../utils/common":41}],51:[function(l,f,p){f.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(l,f,p){var b=l("../utils/common"),_=0,s=1;function C(Ne){for(var dt=Ne.length;0<=--dt;)Ne[dt]=0}var M=0,D=29,B=256,U=B+1+D,j=30,H=19,z=2*U+1,N=15,Z=16,Y=7,W=256,de=16,ge=17,ve=18,ie=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Me=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],we=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Ge=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],et=new Array(2*(U+2));C(et);var pe=new Array(2*j);C(pe);var Je=new Array(512);C(Je);var le=new Array(256);C(le);var ut=new Array(D);C(ut);var tt,We,$t,Be=new Array(j);function Mt(Ne,dt,Kt,Jt,kt){this.static_tree=Ne,this.extra_bits=dt,this.extra_base=Kt,this.elems=Jt,this.max_length=kt,this.has_stree=Ne&&Ne.length}function me(Ne,dt){this.dyn_tree=Ne,this.max_code=0,this.stat_desc=dt}function re(Ne){return Ne<256?Je[Ne]:Je[256+(Ne>>>7)]}function Ve(Ne,dt){Ne.pending_buf[Ne.pending++]=255&dt,Ne.pending_buf[Ne.pending++]=dt>>>8&255}function Pe(Ne,dt,Kt){Ne.bi_valid>Z-Kt?(Ne.bi_buf|=dt<<Ne.bi_valid&65535,Ve(Ne,Ne.bi_buf),Ne.bi_buf=dt>>Z-Ne.bi_valid,Ne.bi_valid+=Kt-Z):(Ne.bi_buf|=dt<<Ne.bi_valid&65535,Ne.bi_valid+=Kt)}function De(Ne,dt,Kt){Pe(Ne,Kt[2*dt],Kt[2*dt+1])}function bt(Ne,dt){for(var Kt=0;Kt|=1&Ne,Ne>>>=1,Kt<<=1,0<--dt;);return Kt>>>1}function Vt(Ne,dt,Kt){var Jt,kt,lr=new Array(N+1),pr=0;for(Jt=1;Jt<=N;Jt++)lr[Jt]=pr=pr+Kt[Jt-1]<<1;for(kt=0;kt<=dt;kt++){var sr=Ne[2*kt+1];sr!==0&&(Ne[2*kt]=bt(lr[sr]++,sr))}}function Zt(Ne){var dt;for(dt=0;dt<U;dt++)Ne.dyn_ltree[2*dt]=0;for(dt=0;dt<j;dt++)Ne.dyn_dtree[2*dt]=0;for(dt=0;dt<H;dt++)Ne.bl_tree[2*dt]=0;Ne.dyn_ltree[2*W]=1,Ne.opt_len=Ne.static_len=0,Ne.last_lit=Ne.matches=0}function jt(Ne){8<Ne.bi_valid?Ve(Ne,Ne.bi_buf):0<Ne.bi_valid&&(Ne.pending_buf[Ne.pending++]=Ne.bi_buf),Ne.bi_buf=0,Ne.bi_valid=0}function Yt(Ne,dt,Kt,Jt){var kt=2*dt,lr=2*Kt;return Ne[kt]<Ne[lr]||Ne[kt]===Ne[lr]&&Jt[dt]<=Jt[Kt]}function jr(Ne,dt,Kt){for(var Jt=Ne.heap[Kt],kt=Kt<<1;kt<=Ne.heap_len&&(kt<Ne.heap_len&&Yt(dt,Ne.heap[kt+1],Ne.heap[kt],Ne.depth)&&kt++,!Yt(dt,Jt,Ne.heap[kt],Ne.depth));)Ne.heap[Kt]=Ne.heap[kt],Kt=kt,kt<<=1;Ne.heap[Kt]=Jt}function Qe(Ne,dt,Kt){var Jt,kt,lr,pr,sr=0;if(Ne.last_lit!==0)for(;Jt=Ne.pending_buf[Ne.d_buf+2*sr]<<8|Ne.pending_buf[Ne.d_buf+2*sr+1],kt=Ne.pending_buf[Ne.l_buf+sr],sr++,Jt===0?De(Ne,kt,dt):(De(Ne,(lr=le[kt])+B+1,dt),(pr=ie[lr])!==0&&Pe(Ne,kt-=ut[lr],pr),De(Ne,lr=re(--Jt),Kt),(pr=Me[lr])!==0&&Pe(Ne,Jt-=Be[lr],pr)),sr<Ne.last_lit;);De(Ne,W,dt)}function _n(Ne,dt){var Kt,Jt,kt,lr=dt.dyn_tree,pr=dt.stat_desc.static_tree,sr=dt.stat_desc.has_stree,st=dt.stat_desc.elems,fe=-1;for(Ne.heap_len=0,Ne.heap_max=z,Kt=0;Kt<st;Kt++)lr[2*Kt]!==0?(Ne.heap[++Ne.heap_len]=fe=Kt,Ne.depth[Kt]=0):lr[2*Kt+1]=0;for(;Ne.heap_len<2;)lr[2*(kt=Ne.heap[++Ne.heap_len]=fe<2?++fe:0)]=1,Ne.depth[kt]=0,Ne.opt_len--,sr&&(Ne.static_len-=pr[2*kt+1]);for(dt.max_code=fe,Kt=Ne.heap_len>>1;1<=Kt;Kt--)jr(Ne,lr,Kt);for(kt=st;Kt=Ne.heap[1],Ne.heap[1]=Ne.heap[Ne.heap_len--],jr(Ne,lr,1),Jt=Ne.heap[1],Ne.heap[--Ne.heap_max]=Kt,Ne.heap[--Ne.heap_max]=Jt,lr[2*kt]=lr[2*Kt]+lr[2*Jt],Ne.depth[kt]=(Ne.depth[Kt]>=Ne.depth[Jt]?Ne.depth[Kt]:Ne.depth[Jt])+1,lr[2*Kt+1]=lr[2*Jt+1]=kt,Ne.heap[1]=kt++,jr(Ne,lr,1),2<=Ne.heap_len;);Ne.heap[--Ne.heap_max]=Ne.heap[1],(function(ue,ye){var je,$e,_t,lt,at,vt,Bt=ye.dyn_tree,Ht=ye.max_code,Tr=ye.stat_desc.static_tree,hr=ye.stat_desc.has_stree,Gr=ye.stat_desc.extra_bits,xn=ye.stat_desc.extra_base,an=ye.stat_desc.max_length,xt=0;for(lt=0;lt<=N;lt++)ue.bl_count[lt]=0;for(Bt[2*ue.heap[ue.heap_max]+1]=0,je=ue.heap_max+1;je<z;je++)an<(lt=Bt[2*Bt[2*($e=ue.heap[je])+1]+1]+1)&&(lt=an,xt++),Bt[2*$e+1]=lt,Ht<$e||(ue.bl_count[lt]++,at=0,xn<=$e&&(at=Gr[$e-xn]),vt=Bt[2*$e],ue.opt_len+=vt*(lt+at),hr&&(ue.static_len+=vt*(Tr[2*$e+1]+at)));if(xt!==0){do{for(lt=an-1;ue.bl_count[lt]===0;)lt--;ue.bl_count[lt]--,ue.bl_count[lt+1]+=2,ue.bl_count[an]--,xt-=2}while(0<xt);for(lt=an;lt!==0;lt--)for($e=ue.bl_count[lt];$e!==0;)Ht<(_t=ue.heap[--je])||(Bt[2*_t+1]!==lt&&(ue.opt_len+=(lt-Bt[2*_t+1])*Bt[2*_t],Bt[2*_t+1]=lt),$e--)}})(Ne,dt),Vt(lr,fe,Ne.bl_count)}function se(Ne,dt,Kt){var Jt,kt,lr=-1,pr=dt[1],sr=0,st=7,fe=4;for(pr===0&&(st=138,fe=3),dt[2*(Kt+1)+1]=65535,Jt=0;Jt<=Kt;Jt++)kt=pr,pr=dt[2*(Jt+1)+1],++sr<st&&kt===pr||(sr<fe?Ne.bl_tree[2*kt]+=sr:kt!==0?(kt!==lr&&Ne.bl_tree[2*kt]++,Ne.bl_tree[2*de]++):sr<=10?Ne.bl_tree[2*ge]++:Ne.bl_tree[2*ve]++,lr=kt,fe=(sr=0)===pr?(st=138,3):kt===pr?(st=6,3):(st=7,4))}function Rt(Ne,dt,Kt){var Jt,kt,lr=-1,pr=dt[1],sr=0,st=7,fe=4;for(pr===0&&(st=138,fe=3),Jt=0;Jt<=Kt;Jt++)if(kt=pr,pr=dt[2*(Jt+1)+1],!(++sr<st&&kt===pr)){if(sr<fe)for(;De(Ne,kt,Ne.bl_tree),--sr!=0;);else kt!==0?(kt!==lr&&(De(Ne,kt,Ne.bl_tree),sr--),De(Ne,de,Ne.bl_tree),Pe(Ne,sr-3,2)):sr<=10?(De(Ne,ge,Ne.bl_tree),Pe(Ne,sr-3,3)):(De(Ne,ve,Ne.bl_tree),Pe(Ne,sr-11,7));lr=kt,fe=(sr=0)===pr?(st=138,3):kt===pr?(st=6,3):(st=7,4)}}C(Be);var yt=!1;function Ee(Ne,dt,Kt,Jt){Pe(Ne,(M<<1)+(Jt?1:0),3),(function(kt,lr,pr,sr){jt(kt),Ve(kt,pr),Ve(kt,~pr),b.arraySet(kt.pending_buf,kt.window,lr,pr,kt.pending),kt.pending+=pr})(Ne,dt,Kt)}p._tr_init=function(Ne){yt||((function(){var dt,Kt,Jt,kt,lr,pr=new Array(N+1);for(kt=Jt=0;kt<D-1;kt++)for(ut[kt]=Jt,dt=0;dt<1<<ie[kt];dt++)le[Jt++]=kt;for(le[Jt-1]=kt,kt=lr=0;kt<16;kt++)for(Be[kt]=lr,dt=0;dt<1<<Me[kt];dt++)Je[lr++]=kt;for(lr>>=7;kt<j;kt++)for(Be[kt]=lr<<7,dt=0;dt<1<<Me[kt]-7;dt++)Je[256+lr++]=kt;for(Kt=0;Kt<=N;Kt++)pr[Kt]=0;for(dt=0;dt<=143;)et[2*dt+1]=8,dt++,pr[8]++;for(;dt<=255;)et[2*dt+1]=9,dt++,pr[9]++;for(;dt<=279;)et[2*dt+1]=7,dt++,pr[7]++;for(;dt<=287;)et[2*dt+1]=8,dt++,pr[8]++;for(Vt(et,U+1,pr),dt=0;dt<j;dt++)pe[2*dt+1]=5,pe[2*dt]=bt(dt,5);tt=new Mt(et,ie,B+1,U,N),We=new Mt(pe,Me,0,j,N),$t=new Mt(new Array(0),we,0,H,Y)})(),yt=!0),Ne.l_desc=new me(Ne.dyn_ltree,tt),Ne.d_desc=new me(Ne.dyn_dtree,We),Ne.bl_desc=new me(Ne.bl_tree,$t),Ne.bi_buf=0,Ne.bi_valid=0,Zt(Ne)},p._tr_stored_block=Ee,p._tr_flush_block=function(Ne,dt,Kt,Jt){var kt,lr,pr=0;0<Ne.level?(Ne.strm.data_type===2&&(Ne.strm.data_type=(function(sr){var st,fe=4093624447;for(st=0;st<=31;st++,fe>>>=1)if(1&fe&&sr.dyn_ltree[2*st]!==0)return _;if(sr.dyn_ltree[18]!==0||sr.dyn_ltree[20]!==0||sr.dyn_ltree[26]!==0)return s;for(st=32;st<B;st++)if(sr.dyn_ltree[2*st]!==0)return s;return _})(Ne)),_n(Ne,Ne.l_desc),_n(Ne,Ne.d_desc),pr=(function(sr){var st;for(se(sr,sr.dyn_ltree,sr.l_desc.max_code),se(sr,sr.dyn_dtree,sr.d_desc.max_code),_n(sr,sr.bl_desc),st=H-1;3<=st&&sr.bl_tree[2*Ge[st]+1]===0;st--);return sr.opt_len+=3*(st+1)+5+5+4,st})(Ne),kt=Ne.opt_len+3+7>>>3,(lr=Ne.static_len+3+7>>>3)<=kt&&(kt=lr)):kt=lr=Kt+5,Kt+4<=kt&&dt!==-1?Ee(Ne,dt,Kt,Jt):Ne.strategy===4||lr===kt?(Pe(Ne,2+(Jt?1:0),3),Qe(Ne,et,pe)):(Pe(Ne,4+(Jt?1:0),3),(function(sr,st,fe,ue){var ye;for(Pe(sr,st-257,5),Pe(sr,fe-1,5),Pe(sr,ue-4,4),ye=0;ye<ue;ye++)Pe(sr,sr.bl_tree[2*Ge[ye]+1],3);Rt(sr,sr.dyn_ltree,st-1),Rt(sr,sr.dyn_dtree,fe-1)})(Ne,Ne.l_desc.max_code+1,Ne.d_desc.max_code+1,pr+1),Qe(Ne,Ne.dyn_ltree,Ne.dyn_dtree)),Zt(Ne),Jt&&jt(Ne)},p._tr_tally=function(Ne,dt,Kt){return Ne.pending_buf[Ne.d_buf+2*Ne.last_lit]=dt>>>8&255,Ne.pending_buf[Ne.d_buf+2*Ne.last_lit+1]=255&dt,Ne.pending_buf[Ne.l_buf+Ne.last_lit]=255&Kt,Ne.last_lit++,dt===0?Ne.dyn_ltree[2*Kt]++:(Ne.matches++,dt--,Ne.dyn_ltree[2*(le[Kt]+B+1)]++,Ne.dyn_dtree[2*re(dt)]++),Ne.last_lit===Ne.lit_bufsize-1},p._tr_align=function(Ne){Pe(Ne,2,3),De(Ne,W,et),(function(dt){dt.bi_valid===16?(Ve(dt,dt.bi_buf),dt.bi_buf=0,dt.bi_valid=0):8<=dt.bi_valid&&(dt.pending_buf[dt.pending++]=255&dt.bi_buf,dt.bi_buf>>=8,dt.bi_valid-=8)})(Ne)}},{"../utils/common":41}],53:[function(l,f,p){f.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(l,f,p){(function(b){(function(_,s){if(!_.setImmediate){var C,M,D,B,U=1,j={},H=!1,z=_.document,N=Object.getPrototypeOf&&Object.getPrototypeOf(_);N=N&&N.setTimeout?N:_,C={}.toString.call(_.process)==="[object process]"?function(de){process.nextTick(function(){Y(de)})}:(function(){if(_.postMessage&&!_.importScripts){var de=!0,ge=_.onmessage;return _.onmessage=function(){de=!1},_.postMessage("","*"),_.onmessage=ge,de}})()?(B="setImmediate$"+Math.random()+"$",_.addEventListener?_.addEventListener("message",W,!1):_.attachEvent("onmessage",W),function(de){_.postMessage(B+de,"*")}):_.MessageChannel?((D=new MessageChannel).port1.onmessage=function(de){Y(de.data)},function(de){D.port2.postMessage(de)}):z&&"onreadystatechange"in z.createElement("script")?(M=z.documentElement,function(de){var ge=z.createElement("script");ge.onreadystatechange=function(){Y(de),ge.onreadystatechange=null,M.removeChild(ge),ge=null},M.appendChild(ge)}):function(de){setTimeout(Y,0,de)},N.setImmediate=function(de){typeof de!="function"&&(de=new Function(""+de));for(var ge=new Array(arguments.length-1),ve=0;ve<ge.length;ve++)ge[ve]=arguments[ve+1];var ie={callback:de,args:ge};return j[U]=ie,C(U),U++},N.clearImmediate=Z}function Z(de){delete j[de]}function Y(de){if(H)setTimeout(Y,0,de);else{var ge=j[de];if(ge){H=!0;try{(function(ve){var ie=ve.callback,Me=ve.args;switch(Me.length){case 0:ie();break;case 1:ie(Me[0]);break;case 2:ie(Me[0],Me[1]);break;case 3:ie(Me[0],Me[1],Me[2]);break;default:ie.apply(s,Me)}})(ge)}finally{Z(de),H=!1}}}}function W(de){de.source===_&&typeof de.data=="string"&&de.data.indexOf(B)===0&&Y(+de.data.slice(B.length))}})(typeof self>"u"?b===void 0?this:b:self)}).call(this,typeof xd<"u"?xd:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Sy)),Sy.exports}var jD=ND();const Tw=Fx(jD);var mx={exports:{}},UD=mx.exports,ub;function VD(){return ub||(ub=1,(function(r,u){(function(l,f){f()})(UD,function(){function l(M,D){return typeof D>"u"?D={autoBom:!1}:typeof D!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),D={autoBom:!D}),D.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(M.type)?new Blob(["\uFEFF",M],{type:M.type}):M}function f(M,D,B){var U=new XMLHttpRequest;U.open("GET",M),U.responseType="blob",U.onload=function(){C(U.response,D,B)},U.onerror=function(){console.error("could not download file")},U.send()}function p(M){var D=new XMLHttpRequest;D.open("HEAD",M,!1);try{D.send()}catch{}return 200<=D.status&&299>=D.status}function b(M){try{M.dispatchEvent(new MouseEvent("click"))}catch{var D=document.createEvent("MouseEvents");D.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),M.dispatchEvent(D)}}var _=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof xd=="object"&&xd.global===xd?xd:void 0,s=_.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),C=_.saveAs||(typeof window!="object"||window!==_?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(M,D,B){var U=_.URL||_.webkitURL,j=document.createElement("a");D=D||M.name||"download",j.download=D,j.rel="noopener",typeof M=="string"?(j.href=M,j.origin===location.origin?b(j):p(j.href)?f(M,D,B):b(j,j.target="_blank")):(j.href=U.createObjectURL(M),setTimeout(function(){U.revokeObjectURL(j.href)},4e4),setTimeout(function(){b(j)},0))}:"msSaveOrOpenBlob"in navigator?function(M,D,B){if(D=D||M.name||"download",typeof M!="string")navigator.msSaveOrOpenBlob(l(M,B),D);else if(p(M))f(M,D,B);else{var U=document.createElement("a");U.href=M,U.target="_blank",setTimeout(function(){b(U)})}}:function(M,D,B,U){if(U=U||open("","_blank"),U&&(U.document.title=U.document.body.innerText="downloading..."),typeof M=="string")return f(M,D,B);var j=M.type==="application/octet-stream",H=/constructor/i.test(_.HTMLElement)||_.safari,z=/CriOS\/[\d]+/.test(navigator.userAgent);if((z||j&&H||s)&&typeof FileReader<"u"){var N=new FileReader;N.onloadend=function(){var W=N.result;W=z?W:W.replace(/^data:[^;]*;/,"data:attachment/file;"),U?U.location.href=W:location=W,U=null},N.readAsDataURL(M)}else{var Z=_.URL||_.webkitURL,Y=Z.createObjectURL(M);U?U.location=Y:location.href=Y,U=null,setTimeout(function(){Z.revokeObjectURL(Y)},4e4)}});_.saveAs=C.saveAs=C,r.exports=C})})(mx)),mx.exports}var Sw=VD();const GD=()=>{const[r,u]=ke.useState(null),[l,f]=ke.useState([]),[p,b]=ke.useState(""),[_,s]=ke.useState(!1),[C,M]=ke.useState([]),[D,B]=ke.useState(!1),U=ke.useRef(null),j=ge=>M(ve=>[...ve,`${new Date().toLocaleTimeString("he-IL")}: ${ge}`]),H=ge=>ge?String(ge).trim().replace(/[\u200B-\u200D\uFEFF]/g,""):"",z=(ge,ve)=>{for(const Me of ve)if(ge[Me]!==void 0&&ge[Me]!==null)return String(ge[Me]).trim();const ie=Object.keys(ge);for(const Me of ve){const we=ie.find(Ge=>Ge.trim().toLowerCase()===Me.toLowerCase().trim());if(we&&ge[we])return String(ge[we]).trim()}return""},N=ge=>{if(!ge)return"";const ve=ge.trim().replace(/['`"]/g,"");return ve===""?"A":ve===""?"B":ve===""?"C":ve},Z=ge=>{const ve=ge.target.files?.[0];if(!ve)return;const ie=new FileReader;ie.onload=Me=>{try{const we=Me.target?.result,Ge=Gy(we,{type:"binary"});let et="",pe=[],Je=[];for(const We of Ge.SheetNames){const $t=Ge.Sheets[We],Be=lb.sheet_to_json($t);if(Be.length>0){const Mt=Object.keys(Be[0]);if(Mt.some(re=>re.toUpperCase().includes("REC_INACCURATE")||re.toUpperCase().includes("INACCURATE")||re.includes("")||re.toLowerCase().includes("task"))&&!Mt.includes("Participant_ID")){et=We,pe=Be,Je=Mt;break}}}et||(et=Ge.SheetNames[0],pe=lb.sheet_to_json(Ge.Sheets[et]),pe.length>0&&(Je=Object.keys(pe[0]))),j(`  : "${et}"`),j(`  : ${Je.join(", ")}`);const le={};let ut=0;pe.forEach((We,$t)=>{const Be=z(We,["Scenario_ID","Scenario ID","ID","m_ID"]);if(!Be)return;const Mt=H(Be),me=z(We,["REC_INACCURATE","Rec_Inaccurate","Inaccurate","Rec Inaccurate","REC INACCURATE"]),re=N(me);$t<3&&console.log(`Row ${$t}: ID=${Mt}, RawInaccurate="${me}", Mapped="${re}"`);const Ve={id:Mt,taskText:z(We,["Task","TASK","","TaskText"]),requirements:z(We,["Priority_Task","Priority Task","Participant_Task","Requirements"]),correctRoute:N(z(We,["CORRECT_ROUTE","Correct_Route","Correct"])),inaccurateRoute:re};le[Mt]=Ve,le[`${Mt}_H`]=Ve,le[`${Mt}_R`]=Ve,le[`${Mt}_S`]=Ve,ut++}),u(le),j(`  ${ut} .`);const tt=Object.keys(le)[0];tt&&le[tt].inaccurateRoute?j(` :  ${tt},   : "${le[tt].inaccurateRoute}"`):j("  :       .     .")}catch(we){console.error(we),j("   .")}},ie.readAsBinaryString(ve)},Y=ge=>{if(ge.target.files){const ve=Array.from(ge.target.files).filter(ie=>ie.name.toLowerCase().endsWith(".html"));f(ve),j(`  ${ve.length}  HTML.`)}},W=async()=>{if(!r||l.length===0){alert("    .");return}s(!0);const ge=new Tw;let ve=0;const ie=D?ge.folder("Correct"):ge,Me=D?ge.folder("Inaccurate"):null;j("---   ---");for(const Ge of l)try{const et=await Ge.text(),pe=/(const|var|let)\s+DATA\s*=\s*({[\s\S]*?});/,Je=et.match(pe);let le=et,ut=et;if(Je){const tt=Je[2];let We;try{We=JSON.parse(tt)}catch{try{We=new Function("return "+tt)()}catch{ie&&ie.file(Ge.name,et);continue}}let $t=We.scenarioName?String(We.scenarioName):"",Be=H($t);if(Be){let Mt=r[Be];if(!Mt&&Be.includes("_")){const me=Be.split("_");if(me.length>=2){const re=me.slice(0,me.length-1).join("_");Mt=r[re]}}if(Mt){const me={...We};if(Mt.taskText&&(me.taskText=Mt.taskText),Mt.requirements&&(me.requirementsText=Mt.requirements),Mt.correctRoute&&(me.recVal=Mt.correctRoute),le=le.replace(tt,JSON.stringify(me,null,2)),D&&Me){const re={...We};Mt.taskText&&(re.taskText=Mt.taskText),Mt.requirements&&(re.requirementsText=Mt.requirements),Mt.inaccurateRoute&&(re.recVal=Mt.inaccurateRoute),ut=ut.replace(tt,JSON.stringify(re,null,2))}ve++}else j(` ${Ge.name} (${Be}):   .`)}}if(p.trim()){const tt=`
<style>
${p}
</style>
</head>`;le=le.replace("</head>",tt),D&&(ut=ut.replace("</head>",tt))}ie&&ie.file(Ge.name,le),D&&Me&&Me.file(Ge.name,ut)}catch(et){console.error(`Error processing ${Ge.name}`,et)}const we=await ge.generateAsync({type:"blob"});Sw.saveAs(we,D?"Scenarios_Correct_Inaccurate.zip":"Scenarios_Updated.zip"),j(` : ${ve}  .`),s(!1)},de={container:{padding:"20px 30px",direction:"rtl",fontFamily:"Segoe UI, Tahoma, sans-serif",maxWidth:"900px",margin:"0 auto",marginTop:"20px",height:"calc(100% - 40px)",overflowY:"auto",backgroundColor:"#0f172a",color:"#e2e8f0",borderRadius:"8px",boxSizing:"border-box",border:"1px solid #334155"},header:{marginBottom:"20px",borderBottom:"2px solid #3b82f6",paddingBottom:"10px"},card:{background:"#1e293b",padding:"20px",borderRadius:"12px",border:"1px solid #334155",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.5)",marginBottom:"20px"},cardHeader:{display:"flex",alignItems:"center",marginBottom:"15px"},stepIcon:{background:"rgba(59, 130, 246, 0.2)",color:"#60a5fa",width:"32px",height:"32px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",marginLeft:"12px",flexShrink:0},input:{width:"100%",padding:"12px",background:"#0f172a",border:"1px solid #475569",color:"#f1f5f9",borderRadius:"6px",marginTop:"10px",boxSizing:"border-box",outline:"none"},checkboxContainer:{marginTop:"15px",padding:"12px",background:"rgba(59, 130, 246, 0.1)",border:"1px solid #1e40af",borderRadius:"6px",display:"flex",alignItems:"flex-start",gap:"10px"},button:{width:"100%",padding:"15px",background:_?"#475569":"linear-gradient(to left, #2563EB, #3b82f6)",color:"white",fontWeight:"bold",border:"none",borderRadius:"10px",cursor:_?"not-allowed":"pointer",fontSize:"18px",marginTop:"10px",transition:"all 0.2s",boxShadow:"0 4px 12px rgba(37, 99, 235, 0.3)"},logBox:{background:"#020617",color:"#4ade80",padding:"15px",borderRadius:"12px",fontSize:"13px",fontFamily:"Consolas, monospace",height:"200px",overflowY:"auto",direction:"ltr",border:"1px solid #334155"}};return J.jsxs("div",{style:de.container,children:[J.jsxs("header",{style:de.header,children:[J.jsx("h1",{style:{margin:0,fontSize:"22px",color:"#f8fafc"},children:"  "}),J.jsx("p",{style:{margin:"5px 0 0 0",color:"#94a3b8",fontSize:"14px"},children:": Priority_Task, REC_INACCURATE  ."})]}),J.jsxs("div",{children:[J.jsxs("section",{style:de.card,children:[J.jsxs("div",{style:de.cardHeader,children:[J.jsx("div",{style:de.stepIcon,children:"1"}),J.jsx("h3",{style:{margin:0,fontSize:"18px"},children:"  (Excel)"})]}),J.jsxs("div",{style:{fontSize:"13px",color:"#cbd5e1",marginBottom:"15px",lineHeight:"1.6"},children:["  : ",J.jsx("b",{children:"Scenario_ID, Task, Priority_Task, Correct_Route, REC_INACCURATE"})]}),J.jsx("input",{type:"file",accept:".xlsx, .xls, .csv",onChange:Z,style:de.input}),J.jsxs("div",{style:de.checkboxContainer,children:[J.jsx("input",{type:"checkbox",id:"inaccurateMode",checked:D,onChange:ge=>B(ge.target.checked),style:{width:"20px",height:"20px",cursor:"pointer",marginTop:"2px"}}),J.jsx("label",{htmlFor:"inaccurateMode",style:{cursor:"pointer",fontSize:"14px"},children:J.jsx("b",{children:"   (Correct / Inaccurate)"})})]}),r&&J.jsxs("div",{style:{marginTop:"10px",color:"#4ade80",fontSize:"14px",fontWeight:"bold"},children:["  ",Object.keys(r).length,"  ."]})]}),J.jsxs("section",{style:de.card,children:[J.jsxs("div",{style:de.cardHeader,children:[J.jsx("div",{style:de.stepIcon,children:"2"}),J.jsx("h3",{style:{margin:0,fontSize:"18px"},children:"  (HTML)"})]}),"//@ts-expect-error",J.jsx("input",{type:"file",webkitdirectory:"true",multiple:!0,onChange:Y,style:de.input}),l.length>0&&J.jsxs("div",{style:{marginTop:"10px",color:"#4ade80"},children:["  ",l.length," "]})]}),J.jsxs("section",{style:de.card,children:[J.jsxs("div",{style:de.cardHeader,children:[J.jsx("div",{style:de.stepIcon,children:"3"}),J.jsx("h3",{style:{margin:0,fontSize:"18px"},children:"  (CSS)"})]}),J.jsx("textarea",{rows:3,placeholder:": body { background: #1a1a1a; }",value:p,onChange:ge=>b(ge.target.value),style:{...de.input,fontFamily:"monospace",direction:"ltr",resize:"vertical"}})]}),J.jsx("button",{onClick:W,disabled:_||!r||l.length===0,style:de.button,children:_?" ...":"  "}),J.jsxs("div",{style:{marginTop:"20px"},children:[J.jsx("label",{style:{color:"#94a3b8",fontSize:"14px",marginBottom:"5px",display:"block"},children:" :"}),J.jsxs("div",{style:de.logBox,children:[C.length===0?J.jsx("span",{style:{opacity:.5},children:">  ..."}):C.map((ge,ve)=>J.jsx("div",{style:{marginBottom:"4px",borderBottom:"1px solid #1e293b"},children:"> "+ge},ve)),J.jsx("div",{ref:U})]})]})]})]})};var gx={exports:{}};var HD=gx.exports,hb;function qD(){return hb||(hb=1,(function(r,u){(function(l,f){r.exports=f()})(HD,(function(){var l={},f={};function p(_,s,C){if(f[_]=C,_==="index"){var M="var sharedModule = {}; ("+f.shared+")(sharedModule); ("+f.worker+")(sharedModule);",D={};return f.shared(D),f.index(l,D),typeof window<"u"&&l.setWorkerUrl(window.URL.createObjectURL(new Blob([M],{type:"text/javascript"}))),l}}p("shared",["exports"],(function(_){function s(a,e,n,h){return new(n||(n=Promise))((function(m,y){function v(P){try{k(h.next(P))}catch(O){y(O)}}function E(P){try{k(h.throw(P))}catch(O){y(O)}}function k(P){var O;P.done?m(P.value):(O=P.value,O instanceof n?O:new n((function(G){G(O)}))).then(v,E)}k((h=h.apply(a,e||[])).next())}))}function C(a,e){this.x=a,this.y=e}function M(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var D,B;typeof SuppressedError=="function"&&SuppressedError,C.prototype={clone(){return new C(this.x,this.y)},add(a){return this.clone()._add(a)},sub(a){return this.clone()._sub(a)},multByPoint(a){return this.clone()._multByPoint(a)},divByPoint(a){return this.clone()._divByPoint(a)},mult(a){return this.clone()._mult(a)},div(a){return this.clone()._div(a)},rotate(a){return this.clone()._rotate(a)},rotateAround(a,e){return this.clone()._rotateAround(a,e)},matMult(a){return this.clone()._matMult(a)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(a){return this.x===a.x&&this.y===a.y},dist(a){return Math.sqrt(this.distSqr(a))},distSqr(a){const e=a.x-this.x,n=a.y-this.y;return e*e+n*n},angle(){return Math.atan2(this.y,this.x)},angleTo(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith(a){return this.angleWithSep(a.x,a.y)},angleWithSep(a,e){return Math.atan2(this.x*e-this.y*a,this.x*a+this.y*e)},_matMult(a){const e=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=e,this},_add(a){return this.x+=a.x,this.y+=a.y,this},_sub(a){return this.x-=a.x,this.y-=a.y,this},_mult(a){return this.x*=a,this.y*=a,this},_div(a){return this.x/=a,this.y/=a,this},_multByPoint(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint(a){return this.x/=a.x,this.y/=a.y,this},_unit(){return this._div(this.mag()),this},_perp(){const a=this.y;return this.y=this.x,this.x=-a,this},_rotate(a){const e=Math.cos(a),n=Math.sin(a),h=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=h,this},_rotateAround(a,e){const n=Math.cos(a),h=Math.sin(a),m=e.y+h*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-h*(this.y-e.y),this.y=m,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:C},C.convert=function(a){if(a instanceof C)return a;if(Array.isArray(a))return new C(+a[0],+a[1]);if(a.x!==void 0&&a.y!==void 0)return new C(+a.x,+a.y);throw new Error("Expected [x, y] or {x, y} point format")};var U=(function(){if(B)return D;function a(e,n,h,m){this.cx=3*e,this.bx=3*(h-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(m-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=n,this.p2x=h,this.p2y=m}return B=1,D=a,a.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,n){if(n===void 0&&(n=1e-6),e<0)return 0;if(e>1)return 1;for(var h=e,m=0;m<8;m++){var y=this.sampleCurveX(h)-e;if(Math.abs(y)<n)return h;var v=this.sampleCurveDerivativeX(h);if(Math.abs(v)<1e-6)break;h-=y/v}var E=0,k=1;for(h=e,m=0;m<20&&(y=this.sampleCurveX(h),!(Math.abs(y-e)<n));m++)e>y?E=h:k=h,h=.5*(k-E)+E;return h},solve:function(e,n){return this.sampleCurveY(this.solveCurveX(e,n))}},D})(),j=M(U);let H,z;function N(){return H==null&&(H=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),H}function Z(){if(z==null&&(z=!1,N())){const e=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(e){for(let h=0;h<25;h++){const m=4*h;e.fillStyle=`rgb(${m},${m+1},${m+2})`,e.fillRect(h%5,Math.floor(h/5),1,1)}const n=e.getImageData(0,0,5,5).data;for(let h=0;h<100;h++)if(h%4!=3&&n[h]!==h){z=!0;break}}}return z||!1}var Y=1e-6,W=typeof Float32Array<"u"?Float32Array:Array;function de(){var a=new W(9);return W!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function ge(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function ve(){var a=new W(3);return W!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function ie(a){var e=a[0],n=a[1],h=a[2];return Math.sqrt(e*e+n*n+h*h)}function Me(a,e,n){var h=new W(3);return h[0]=a,h[1]=e,h[2]=n,h}function we(a,e,n){return a[0]=e[0]+n[0],a[1]=e[1]+n[1],a[2]=e[2]+n[2],a}function Ge(a,e,n){return a[0]=e[0]*n,a[1]=e[1]*n,a[2]=e[2]*n,a}function et(a,e,n){var h=e[0],m=e[1],y=e[2],v=n[0],E=n[1],k=n[2];return a[0]=m*k-y*E,a[1]=y*v-h*k,a[2]=h*E-m*v,a}var pe,Je=ie;function le(a,e,n){var h=e[0],m=e[1],y=e[2],v=e[3];return a[0]=n[0]*h+n[4]*m+n[8]*y+n[12]*v,a[1]=n[1]*h+n[5]*m+n[9]*y+n[13]*v,a[2]=n[2]*h+n[6]*m+n[10]*y+n[14]*v,a[3]=n[3]*h+n[7]*m+n[11]*y+n[15]*v,a}function ut(){var a=new W(4);return W!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function tt(a,e,n,h){var m=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",y=Math.PI/360;e*=y,h*=y,n*=y;var v=Math.sin(e),E=Math.cos(e),k=Math.sin(n),P=Math.cos(n),O=Math.sin(h),G=Math.cos(h);switch(m){case"xyz":a[0]=v*P*G+E*k*O,a[1]=E*k*G-v*P*O,a[2]=E*P*O+v*k*G,a[3]=E*P*G-v*k*O;break;case"xzy":a[0]=v*P*G-E*k*O,a[1]=E*k*G-v*P*O,a[2]=E*P*O+v*k*G,a[3]=E*P*G+v*k*O;break;case"yxz":a[0]=v*P*G+E*k*O,a[1]=E*k*G-v*P*O,a[2]=E*P*O-v*k*G,a[3]=E*P*G+v*k*O;break;case"yzx":a[0]=v*P*G+E*k*O,a[1]=E*k*G+v*P*O,a[2]=E*P*O-v*k*G,a[3]=E*P*G-v*k*O;break;case"zxy":a[0]=v*P*G-E*k*O,a[1]=E*k*G+v*P*O,a[2]=E*P*O+v*k*G,a[3]=E*P*G-v*k*O;break;case"zyx":a[0]=v*P*G-E*k*O,a[1]=E*k*G+v*P*O,a[2]=E*P*O-v*k*G,a[3]=E*P*G+v*k*O;break;default:throw new Error("Unknown angle order "+m)}return a}function We(){var a=new W(2);return W!=Float32Array&&(a[0]=0,a[1]=0),a}function $t(a,e){var n=new W(2);return n[0]=a,n[1]=e,n}ve(),pe=new W(4),W!=Float32Array&&(pe[0]=0,pe[1]=0,pe[2]=0,pe[3]=0),ve(),Me(1,0,0),Me(0,1,0),ut(),ut(),de(),We();const Be=8192;function Mt(a,e,n){return e*(Be/(a.tileSize*Math.pow(2,n-a.tileID.overscaledZ)))}function me(a,e){return(a%e+e)%e}function re(a,e,n){return a*(1-n)+e*n}function Ve(a){if(a<=0)return 0;if(a>=1)return 1;const e=a*a,n=e*a;return 4*(a<.5?n:3*(a-e)+n-.75)}function Pe(a,e,n,h){const m=new j(a,e,n,h);return y=>m.solve(y)}const De=Pe(.25,.1,.25,1);function bt(a,e,n){return Math.min(n,Math.max(e,a))}function Vt(a,e,n){const h=n-e,m=((a-e)%h+h)%h+e;return m===e?n:m}function Zt(a,...e){for(const n of e)for(const h in n)a[h]=n[h];return a}let jt=1;function Yt(a,e,n){const h={};for(const m in a)h[m]=e.call(this,a[m],m,a);return h}function jr(a,e,n){const h={};for(const m in a)e.call(this,a[m],m,a)&&(h[m]=a[m]);return h}function Qe(a){return Array.isArray(a)?a.map(Qe):typeof a=="object"&&a?Yt(a,Qe):a}const _n={};function se(a){_n[a]||(typeof console<"u"&&console.warn(a),_n[a]=!0)}function Rt(a,e,n){return(n.y-a.y)*(e.x-a.x)>(e.y-a.y)*(n.x-a.x)}function yt(a){return typeof WorkerGlobalScope<"u"&&a!==void 0&&a instanceof WorkerGlobalScope}let Ee=null;function Ne(a){return typeof ImageBitmap<"u"&&a instanceof ImageBitmap}const dt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Kt(a,e,n,h,m){return s(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const y=new VideoFrame(a,{timestamp:0});try{const v=y?.format;if(!v||!v.startsWith("BGR")&&!v.startsWith("RGB"))throw new Error(`Unrecognized format ${v}`);const E=v.startsWith("BGR"),k=new Uint8ClampedArray(h*m*4);if(yield y.copyTo(k,(function(P,O,G,X,K){const ae=4*Math.max(-O,0),oe=(Math.max(0,G)-G)*X*4+ae,he=4*X,be=Math.max(0,O),Ze=Math.max(0,G);return{rect:{x:be,y:Ze,width:Math.min(P.width,O+X)-be,height:Math.min(P.height,G+K)-Ze},layout:[{offset:oe,stride:he}]}})(a,e,n,h,m)),E)for(let P=0;P<k.length;P+=4){const O=k[P];k[P]=k[P+2],k[P+2]=O}return k}finally{y.close()}}))}let Jt,kt;function lr(a,e,n,h){return a.addEventListener(e,n,h),{unsubscribe:()=>{a.removeEventListener(e,n,h)}}}function pr(a){return a*Math.PI/180}function sr(a){return a/Math.PI*180}const st={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},fe={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},ue="AbortError";class ye extends Error{constructor(e=ue){super(e instanceof Error?e.message:e),this.name=ue,e instanceof Error&&e.stack&&(this.stack=e.stack)}}function je(a){return a.name===ue}const $e={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function _t(a){return $e.REGISTERED_PROTOCOLS[a.substring(0,a.indexOf("://"))]}const lt="global-dispatcher";class at extends Error{constructor(e,n,h,m){super(`AJAXError: ${n} (${e}): ${h}`),this.status=e,this.statusText=n,this.url=h,this.body=m}}const vt=()=>yt(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Bt=function(a,e){if(/:\/\//.test(a.url)&&!/^https?:|^file:/.test(a.url)){const h=_t(a.url);if(h)return h(a,e);if(yt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,targetMapId:lt},e)}if(!(/^file:/.test(n=a.url)||/^file:/.test(vt())&&!/^\w+:/.test(n))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(h,m){return s(this,void 0,void 0,(function*(){const y=new Request(h.url,{method:h.method||"GET",body:h.body,credentials:h.credentials,headers:h.headers,cache:h.cache,referrer:vt(),signal:m.signal});let v,E;h.type!=="json"||y.headers.has("Accept")||y.headers.set("Accept","application/json");try{v=yield fetch(y)}catch(P){throw je(P)?P:new at(0,P.message,h.url,new Blob)}if(!v.ok){const P=yield v.blob();throw new at(v.status,v.statusText,h.url,P)}E=h.type==="arrayBuffer"||h.type==="image"?v.arrayBuffer():h.type==="json"?v.json():v.text();const k=yield E;return m.signal.throwIfAborted(),{data:k,cacheControl:v.headers.get("Cache-Control"),expires:v.headers.get("Expires")}}))})(a,e);if(yt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,mustQueue:!0,targetMapId:lt},e)}var n;return(function(h,m){return new Promise(((y,v)=>{var E;const k=new XMLHttpRequest;k.open(h.method||"GET",h.url,!0),h.type!=="arrayBuffer"&&h.type!=="image"||(k.responseType="arraybuffer");for(const P in h.headers)k.setRequestHeader(P,h.headers[P]);h.type==="json"&&(k.responseType="text",!((E=h.headers)===null||E===void 0)&&E.Accept||k.setRequestHeader("Accept","application/json")),k.withCredentials=h.credentials==="include",k.onerror=()=>{v(new Error(k.statusText))},k.onload=()=>{if(!m.signal.aborted)if((k.status>=200&&k.status<300||k.status===0)&&k.response!==null){let P=k.response;if(h.type==="json")try{P=JSON.parse(k.response)}catch(O){return void v(O)}y({data:P,cacheControl:k.getResponseHeader("Cache-Control"),expires:k.getResponseHeader("Expires")})}else{const P=new Blob([k.response],{type:k.getResponseHeader("Content-Type")});v(new at(k.status,k.statusText,h.url,P))}},m.signal.addEventListener("abort",(()=>{k.abort(),v(new ye(m.signal.reason))})),k.send(h.body)}))})(a,e)};function Ht(a){if(!a||a.indexOf("://")<=0||a.indexOf("data:image/")===0||a.indexOf("blob:")===0)return!0;const e=new URL(a),n=window.location;return e.protocol===n.protocol&&e.host===n.host}function Tr(a,e,n){n[a]&&n[a].indexOf(e)!==-1||(n[a]=n[a]||[],n[a].push(e))}function hr(a,e,n){if(n&&n[a]){const h=n[a].indexOf(e);h!==-1&&n[a].splice(h,1)}}class Gr{constructor(e,n={}){Zt(this,n),this.type=e}}class xn extends Gr{constructor(e,n={}){super("error",Zt({error:e},n))}}class an{on(e,n){return this._listeners=this._listeners||{},Tr(e,n,this._listeners),{unsubscribe:()=>{this.off(e,n)}}}off(e,n){return hr(e,n,this._listeners),hr(e,n,this._oneTimeListeners),this}once(e,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},Tr(e,n,this._oneTimeListeners),this):new Promise((h=>this.once(e,h)))}fire(e,n){typeof e=="string"&&(e=new Gr(e,n||{}));const h=e.type;if(this.listens(h)){e.target=this;const m=this._listeners&&this._listeners[h]?this._listeners[h].slice():[];for(const E of m)E.call(this,e);const y=this._oneTimeListeners&&this._oneTimeListeners[h]?this._oneTimeListeners[h].slice():[];for(const E of y)hr(h,E,this._oneTimeListeners),E.call(this,e);const v=this._eventedParent;v&&(Zt(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),v.fire(e))}else e instanceof xn&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,n){return this._eventedParent=e,this._eventedParentData=n,this}}var xt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number",length:2},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},encoding:{type:"enum",values:{mvt:{},mlt:{}},default:"mvt"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"filter"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},filter:{type:"boolean",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"expression_name",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}},interpolation:{type:"array",value:"interpolation_name",minimum:1},interpolation_name:{type:"enum",values:{linear:{syntax:{overloads:[{parameters:[],"output-type":"interpolation"}],parameters:[]}},exponential:{syntax:{overloads:[{parameters:["base"],"output-type":"interpolation"}],parameters:[{name:"base",type:"number literal"}]}},"cubic-bezier":{syntax:{overloads:[{parameters:["x1","y1","x2","y2"],"output-type":"interpolation"}],parameters:[{name:"x1",type:"number literal"},{name:"y1",type:"number literal"},{name:"x2",type:"number literal"},{name:"y2",type:"number literal"}]}}}}};const Ln=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function ya(a,e){const n={};for(const h in a)h!=="ref"&&(n[h]=a[h]);return Ln.forEach((h=>{h in e&&(n[h]=e[h])})),n}function Mr(a,e){if(Array.isArray(a)){if(!Array.isArray(e)||a.length!==e.length)return!1;for(let n=0;n<a.length;n++)if(!Mr(a[n],e[n]))return!1;return!0}if(typeof a=="object"&&a!==null&&e!==null){if(typeof e!="object"||Object.keys(a).length!==Object.keys(e).length)return!1;for(const n in a)if(!Mr(a[n],e[n]))return!1;return!0}return a===e}function Fn(a,e){a.push(e)}function Ga(a,e,n){Fn(n,{command:"addSource",args:[a,e[a]]})}function Vn(a,e,n){Fn(e,{command:"removeSource",args:[a]}),n[a]=!0}function va(a,e,n,h){Vn(a,n,h),Ga(a,e,n)}function gn(a,e,n){let h;for(h in a[n])if(Object.prototype.hasOwnProperty.call(a[n],h)&&h!=="data"&&!Mr(a[n][h],e[n][h]))return!1;for(h in e[n])if(Object.prototype.hasOwnProperty.call(e[n],h)&&h!=="data"&&!Mr(a[n][h],e[n][h]))return!1;return!0}function ga(a,e,n,h,m,y){a=a||{},e=e||{};for(const v in a)Object.prototype.hasOwnProperty.call(a,v)&&(Mr(a[v],e[v])||n.push({command:y,args:[h,v,e[v],m]}));for(const v in e)Object.prototype.hasOwnProperty.call(e,v)&&!Object.prototype.hasOwnProperty.call(a,v)&&(Mr(a[v],e[v])||n.push({command:y,args:[h,v,e[v],m]}))}function Yi(a){return a.id}function xo(a,e){return a[e.id]=e,a}class Xt{constructor(e,n,h,m){this.message=(e?`${e}: `:"")+h,m&&(this.identifier=m),n!=null&&n.__line__&&(this.line=n.__line__)}}function xe(a,...e){for(const n of e)for(const h in n)a[h]=n[h];return a}class Ue extends Error{constructor(e,n){super(n),this.message=n,this.key=e}}class Fe{constructor(e,n=[]){this.parent=e,this.bindings={};for(const[h,m]of n)this.bindings[h]=m}concat(e){return new Fe(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const Re={kind:"null"},Te={kind:"number"},ze={kind:"string"},mt={kind:"boolean"},Ut={kind:"color"},It={kind:"projectionDefinition"},Tt={kind:"object"},gt={kind:"value"},ir={kind:"collator"},vr={kind:"formatted"},Sr={kind:"padding"},dr={kind:"colorArray"},xr={kind:"numberArray"},Nr={kind:"resolvedImage"},Wn={kind:"variableAnchorOffsetCollection"};function mn(a,e){return{kind:"array",itemType:a,N:e}}function tn(a){if(a.kind==="array"){const e=tn(a.itemType);return typeof a.N=="number"?`array<${e}, ${a.N}>`:a.itemType.kind==="value"?"array":`array<${e}>`}return a.kind}const oi=[Re,Te,ze,mt,Ut,It,vr,Tt,mn(gt),Sr,xr,dr,Nr,Wn];function xs(a,e){if(e.kind==="error")return null;if(a.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!xs(a.itemType,e.itemType))&&(typeof a.N!="number"||a.N===e.N))return null}else{if(a.kind===e.kind)return null;if(a.kind==="value"){for(const n of oi)if(!xs(n,e))return null}}return`Expected ${tn(a)} but found ${tn(e)} instead.`}function li(a,e){return e.some((n=>n.kind===a.kind))}function wi(a,e){return e.some((n=>n==="null"?a===null:n==="array"?Array.isArray(a):n==="object"?a&&!Array.isArray(a)&&typeof a=="object":n===typeof a))}function za(a,e){return a.kind==="array"&&e.kind==="array"?a.itemType.kind===e.itemType.kind&&typeof a.N=="number":a.kind===e.kind}const Ti=.96422,ss=.82521,os=4/29,Dn=6/29,Zh=3*Dn*Dn,hu=Dn*Dn*Dn,Ki=Math.PI/180,ih=180/Math.PI;function Wo(a){return(a%=360)<0&&(a+=360),a}function Pf([a,e,n,h]){let m,y;const v=fu((.2225045*(a=gi(a))+.7168786*(e=gi(e))+.0606169*(n=gi(n)))/1);a===e&&e===n?m=y=v:(m=fu((.4360747*a+.3850649*e+.1430804*n)/Ti),y=fu((.0139322*a+.0971045*e+.7141733*n)/ss));const E=116*v-16;return[E<0?0:E,500*(m-v),200*(v-y),h]}function gi(a){return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function fu(a){return a>hu?Math.pow(a,1/3):a/Zh+os}function Sl([a,e,n,h]){let m=(a+16)/116,y=isNaN(e)?m:m+e/500,v=isNaN(n)?m:m-n/200;return m=1*Ms(m),y=Ti*Ms(y),v=ss*Ms(v),[du(3.1338561*y-1.6168667*m-.4906146*v),du(-.9787684*y+1.9161415*m+.033454*v),du(.0719453*y-.2289914*m+1.4052427*v),h]}function du(a){return(a=a<=.00304?12.92*a:1.055*Math.pow(a,1/2.4)-.055)<0?0:a>1?1:a}function Ms(a){return a>Dn?a*a*a:Zh*(a-os)}const Wh=Object.hasOwn||function(a,e){return Object.prototype.hasOwnProperty.call(a,e)};function Jl(a,e){return Wh(a,e)?a[e]:void 0}function Ks(a){return parseInt(a.padEnd(2,a),16)/255}function sh(a,e){return $o(e?a/100:a,0,1)}function $o(a,e,n){return Math.min(Math.max(e,a),n)}function Pc(a){return!a.some(Number.isNaN)}const yo={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Js(a,e,n){return a+n*(e-a)}function Ql(a,e,n){return a.map(((h,m)=>Js(h,e[m],n)))}class fn{constructor(e,n,h,m=1,y=!0){this.r=e,this.g=n,this.b=h,this.a=m,y||(this.r*=m,this.g*=m,this.b*=m,m||this.overwriteGetter("rgb",[e,n,h,m]))}static parse(e){if(e instanceof fn)return e;if(typeof e!="string")return;const n=(function(h){if((h=h.toLowerCase().trim())==="transparent")return[0,0,0,0];const m=Jl(yo,h);if(m){const[v,E,k]=m;return[v/255,E/255,k/255,1]}if(h.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(h)){const v=h.length<6?1:2;let E=1;return[Ks(h.slice(E,E+=v)),Ks(h.slice(E,E+=v)),Ks(h.slice(E,E+=v)),Ks(h.slice(E,E+v)||"ff")]}if(h.startsWith("rgb")){const v=h.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(v){const[E,k,P,O,G,X,K,ae,oe,he,be,Ze]=v,Se=[O||" ",K||" ",he].join("");if(Se==="  "||Se==="  /"||Se===",,"||Se===",,,"){const Ce=[P,X,oe].join(""),Ye=Ce==="%%%"?100:Ce===""?255:0;if(Ye){const it=[$o(+k/Ye,0,1),$o(+G/Ye,0,1),$o(+ae/Ye,0,1),be?sh(+be,Ze):1];if(Pc(it))return it}}return}}const y=h.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){const[v,E,k,P,O,G,X,K,ae]=y,oe=[k||" ",O||" ",X].join("");if(oe==="  "||oe==="  /"||oe===",,"||oe===",,,"){const he=[+E,$o(+P,0,100),$o(+G,0,100),K?sh(+K,ae):1];if(Pc(he))return(function([be,Ze,Se,Ce]){function Ye(it){const At=(it+be/30)%12,Wt=Ze*Math.min(Se,1-Se);return Se-Wt*Math.max(-1,Math.min(At-3,9-At,1))}return be=Wo(be),Ze/=100,Se/=100,[Ye(0),Ye(8),Ye(4),Ce]})(he)}}})(e);return n?new fn(...n,!1):void 0}get rgb(){const{r:e,g:n,b:h,a:m}=this,y=m||1/0;return this.overwriteGetter("rgb",[e/y,n/y,h/y,m])}get hcl(){return this.overwriteGetter("hcl",(function(e){const[n,h,m,y]=Pf(e),v=Math.sqrt(h*h+m*m);return[Math.round(1e4*v)?Wo(Math.atan2(m,h)*ih):NaN,v,n,y]})(this.rgb))}get lab(){return this.overwriteGetter("lab",Pf(this.rgb))}overwriteGetter(e,n){return Object.defineProperty(this,e,{value:n}),n}toString(){const[e,n,h,m]=this.rgb;return`rgba(${[e,n,h].map((y=>Math.round(255*y))).join(",")},${m})`}static interpolate(e,n,h,m="rgb"){switch(m){case"rgb":{const[y,v,E,k]=Ql(e.rgb,n.rgb,h);return new fn(y,v,E,k,!1)}case"hcl":{const[y,v,E,k]=e.hcl,[P,O,G,X]=n.hcl;let K,ae;if(isNaN(y)||isNaN(P))isNaN(y)?isNaN(P)?K=NaN:(K=P,E!==1&&E!==0||(ae=O)):(K=y,G!==1&&G!==0||(ae=v));else{let Se=P-y;P>y&&Se>180?Se-=360:P<y&&y-P>180&&(Se+=360),K=y+h*Se}const[oe,he,be,Ze]=(function([Se,Ce,Ye,it]){return Se=isNaN(Se)?0:Se*Ki,Sl([Ye,Math.cos(Se)*Ce,Math.sin(Se)*Ce,it])})([K,ae??Js(v,O,h),Js(E,G,h),Js(k,X,h)]);return new fn(oe,he,be,Ze,!1)}case"lab":{const[y,v,E,k]=Sl(Ql(e.lab,n.lab,h));return new fn(y,v,E,k,!1)}}}}fn.black=new fn(0,0,0,1),fn.white=new fn(1,1,1,1),fn.transparent=new fn(0,0,0,0),fn.red=new fn(1,0,0,1);class Ds{constructor(e,n,h){this.sensitivity=e?n?"variant":"case":n?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,n){return this.collator.compare(e,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const ec=["bottom","center","top"];class pu{constructor(e,n,h,m,y,v){this.text=e,this.image=n,this.scale=h,this.fontStack=m,this.textColor=y,this.verticalAlign=v}}class ba{constructor(e){this.sections=e}static fromString(e){return new ba([new pu(e,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((e=>e.text.length!==0||e.image&&e.image.name.length!==0))}static factory(e){return e instanceof ba?e:ba.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map((e=>e.text)).join("")}}class Ha{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Ha)return e;if(typeof e=="number")return new Ha([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const n of e)if(typeof n!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new Ha(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,n,h){return new Ha(Ql(e.values,n.values,h))}}class wa{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof wa)return e;if(typeof e=="number")return new wa([e]);if(Array.isArray(e)){for(const n of e)if(typeof n!="number")return;return new wa(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,n,h){return new wa(Ql(e.values,n.values,h))}}class Qr{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Qr)return e;if(typeof e=="string"){const h=fn.parse(e);return h?new Qr([h]):void 0}if(!Array.isArray(e))return;const n=[];for(const h of e){if(typeof h!="string")return;const m=fn.parse(h);if(!m)return;n.push(m)}return new Qr(n)}toString(){return JSON.stringify(this.values)}static interpolate(e,n,h,m="rgb"){const y=[];if(e.values.length!=n.values.length)throw new Error(`colorArray: Arrays have mismatched length (${e.values.length} vs. ${n.values.length}), cannot interpolate.`);for(let v=0;v<e.values.length;v++)y.push(fn.interpolate(e.values[v],n.values[v],h,m));return new Qr(y)}}class Yn extends Error{constructor(e){super(e),this.name="RuntimeError"}toJSON(){return this.message}}const ys=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class zn{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof zn)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2==0){for(let n=0;n<e.length;n+=2){const h=e[n],m=e[n+1];if(typeof h!="string"||!ys.has(h)||!Array.isArray(m)||m.length!==2||typeof m[0]!="number"||typeof m[1]!="number")return}return new zn(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,n,h){const m=e.values,y=n.values;if(m.length!==y.length)throw new Yn(`Cannot interpolate values of different length. from: ${e.toString()}, to: ${n.toString()}`);const v=[];for(let E=0;E<m.length;E+=2){if(m[E]!==y[E])throw new Yn(`Cannot interpolate values containing mismatched anchors. from[${E}]: ${m[E]}, to[${E}]: ${y[E]}`);v.push(m[E]);const[k,P]=m[E+1],[O,G]=y[E+1];v.push([Js(k,O,h),Js(P,G,h)])}return new zn(v)}}class Oa{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Oa({name:e,available:!1}):null}}class la{constructor(e,n,h){this.from=e,this.to=n,this.transition=h}static interpolate(e,n,h){return new la(e,n,h)}static parse(e){return e instanceof la?e:Array.isArray(e)&&e.length===3&&typeof e[0]=="string"&&typeof e[1]=="string"&&typeof e[2]=="number"?new la(e[0],e[1],e[2]):typeof e=="object"&&typeof e.from=="string"&&typeof e.to=="string"&&typeof e.transition=="number"?new la(e.from,e.to,e.transition):typeof e=="string"?new la(e,e,1):void 0}}function _a(a,e,n,h){return typeof a=="number"&&a>=0&&a<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof n=="number"&&n>=0&&n<=255?h===void 0||typeof h=="number"&&h>=0&&h<=1?null:`Invalid rgba value [${[a,e,n,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof h=="number"?[a,e,n,h]:[a,e,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function vo(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof la||a instanceof fn||a instanceof Ds||a instanceof ba||a instanceof Ha||a instanceof wa||a instanceof Qr||a instanceof zn||a instanceof Oa)return!0;if(Array.isArray(a)){for(const e of a)if(!vo(e))return!1;return!0}if(typeof a=="object"){for(const e in a)if(!vo(a[e]))return!1;return!0}return!1}function Rn(a){if(a===null)return Re;if(typeof a=="string")return ze;if(typeof a=="boolean")return mt;if(typeof a=="number")return Te;if(a instanceof fn)return Ut;if(a instanceof la)return It;if(a instanceof Ds)return ir;if(a instanceof ba)return vr;if(a instanceof Ha)return Sr;if(a instanceof wa)return xr;if(a instanceof Qr)return dr;if(a instanceof zn)return Wn;if(a instanceof Oa)return Nr;if(Array.isArray(a)){const e=a.length;let n;for(const h of a){const m=Rn(h);if(n){if(n===m)continue;n=gt;break}n=m}return mn(n||gt,e)}return Tt}function Si(a){const e=typeof a;return a===null?"":e==="string"||e==="number"||e==="boolean"?String(a):a instanceof fn||a instanceof la||a instanceof ba||a instanceof Ha||a instanceof wa||a instanceof Qr||a instanceof zn||a instanceof Oa?a.toString():JSON.stringify(a)}class ri{constructor(e,n){this.type=e,this.value=n}static parse(e,n){if(e.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!vo(e[1]))return n.error("invalid value");const h=e[1];let m=Rn(h);const y=n.expectedType;return m.kind!=="array"||m.N!==0||!y||y.kind!=="array"||typeof y.N=="number"&&y.N!==0||(m=y),new ri(m,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Qs={string:ze,number:Te,boolean:mt,object:Tt};class Ri{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");let h,m=1;const y=e[0];if(y==="array"){let E,k;if(e.length>2){const P=e[1];if(typeof P!="string"||!(P in Qs)||P==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);E=Qs[P],m++}else E=gt;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return n.error('The length argument to "array" must be a positive integer literal',2);k=e[2],m++}h=mn(E,k)}else{if(!Qs[y])throw new Error(`Types doesn't contain name = ${y}`);h=Qs[y]}const v=[];for(;m<e.length;m++){const E=n.parse(e[m],m,gt);if(!E)return null;v.push(E)}return new Ri(h,v)}evaluate(e){for(let n=0;n<this.args.length;n++){const h=this.args[n].evaluate(e);if(!xs(this.type,Rn(h)))return h;if(n===this.args.length-1)throw new Yn(`Expected value to be of type ${tn(this.type)}, but found ${tn(Rn(h))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const qa={"to-boolean":mt,"to-color":Ut,"to-number":Te,"to-string":ze};class Da{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const h=e[0];if(!qa[h])throw new Error(`Can't parse ${h} as it is not part of the known types`);if((h==="to-boolean"||h==="to-string")&&e.length!==2)return n.error("Expected one argument.");const m=qa[h],y=[];for(let v=1;v<e.length;v++){const E=n.parse(e[v],v,gt);if(!E)return null;y.push(E)}return new Da(m,y)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let n,h;for(const m of this.args){if(n=m.evaluate(e),h=null,n instanceof fn)return n;if(typeof n=="string"){const y=e.parseColor(n);if(y)return y}else if(Array.isArray(n)&&(h=n.length<3||n.length>4?`Invalid rgba value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:_a(n[0],n[1],n[2],n[3]),!h))return new fn(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new Yn(h||`Could not parse color from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"padding":{let n;for(const h of this.args){n=h.evaluate(e);const m=Ha.parse(n);if(m)return m}throw new Yn(`Could not parse padding from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"numberArray":{let n;for(const h of this.args){n=h.evaluate(e);const m=wa.parse(n);if(m)return m}throw new Yn(`Could not parse numberArray from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"colorArray":{let n;for(const h of this.args){n=h.evaluate(e);const m=Qr.parse(n);if(m)return m}throw new Yn(`Could not parse colorArray from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"variableAnchorOffsetCollection":{let n;for(const h of this.args){n=h.evaluate(e);const m=zn.parse(n);if(m)return m}throw new Yn(`Could not parse variableAnchorOffsetCollection from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"number":{let n=null;for(const h of this.args){if(n=h.evaluate(e),n===null)return 0;const m=Number(n);if(!isNaN(m))return m}throw new Yn(`Could not convert ${JSON.stringify(n)} to number.`)}case"formatted":return ba.fromString(Si(this.args[0].evaluate(e)));case"resolvedImage":return Oa.fromString(Si(this.args[0].evaluate(e)));case"projectionDefinition":return this.args[0].evaluate(e);default:return Si(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const El=["Unknown","Point","LineString","Polygon"];class Al{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?El[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let n=this._parseColorCache.get(e);return n||(n=fn.parse(e),this._parseColorCache.set(e,n)),n}}class ls{constructor(e,n,h=[],m,y=new Fe,v=[]){this.registry=e,this.path=h,this.key=h.map((E=>`[${E}]`)).join(""),this.scope=y,this.errors=v,this.expectedType=m,this._isConstant=n}parse(e,n,h,m,y={}){return n?this.concat(n,h,m)._parse(e,y):this._parse(e,y)}_parse(e,n){function h(m,y,v){return v==="assert"?new Ri(y,[m]):v==="coerce"?new Da(y,[m]):m}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=e[0];if(typeof m!="string")return this.error(`Expression name must be a string, but found ${typeof m} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const y=this.registry[m];if(y){let v=y.parse(e,this);if(!v)return null;if(this.expectedType){const E=this.expectedType,k=v.type;if(E.kind!=="string"&&E.kind!=="number"&&E.kind!=="boolean"&&E.kind!=="object"&&E.kind!=="array"||k.kind!=="value"){if(E.kind==="projectionDefinition"&&["string","array"].includes(k.kind)||["color","formatted","resolvedImage"].includes(E.kind)&&["value","string"].includes(k.kind)||["padding","numberArray"].includes(E.kind)&&["value","number","array"].includes(k.kind)||E.kind==="colorArray"&&["value","string","array"].includes(k.kind)||E.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(k.kind))v=h(v,E,n.typeAnnotation||"coerce");else if(this.checkSubtype(E,k))return null}else v=h(v,E,n.typeAnnotation||"assert")}if(!(v instanceof ri)&&v.type.kind!=="resolvedImage"&&this._isConstant(v)){const E=new Al;try{v=new ri(v.type,v.evaluate(E))}catch(k){return this.error(k.message),null}}return v}return this.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,n,h){const m=typeof e=="number"?this.path.concat(e):this.path,y=h?this.scope.concat(h):this.scope;return new ls(this.registry,this._isConstant,m,n||null,y,this.errors)}error(e,...n){const h=`${this.key}${n.map((m=>`[${m}]`)).join("")}`;this.errors.push(new Ue(h,e))}checkSubtype(e,n){const h=xs(e,n);return h&&this.error(h),h}}class Zn{constructor(e,n){this.type=n.type,this.bindings=[].concat(e),this.result=n}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const n of this.bindings)e(n[1]);e(this.result)}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const h=[];for(let y=1;y<e.length-1;y+=2){const v=e[y];if(typeof v!="string")return n.error(`Expected string, but found ${typeof v} instead.`,y);if(/[^a-zA-Z0-9_]/.test(v))return n.error("Variable names must contain only alphanumeric characters or '_'.",y);const E=n.parse(e[y+1],y+1);if(!E)return null;h.push([v,E])}const m=n.parse(e[e.length-1],e.length-1,n.expectedType,h);return m?new Zn(h,m):null}outputDefined(){return this.result.outputDefined()}}class Xo{constructor(e,n){this.type=n.type,this.name=e,this.boundExpression=n}static parse(e,n){if(e.length!==2||typeof e[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");const h=e[1];return n.scope.has(h)?new Xo(h,n.scope.get(h)):n.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class cn{constructor(e,n,h){this.type=e,this.index=n,this.input=h}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const h=n.parse(e[1],1,Te),m=n.parse(e[2],2,mn(n.expectedType||gt));return h&&m?new cn(m.type.itemType,h,m):null}evaluate(e){const n=this.index.evaluate(e),h=this.input.evaluate(e);if(n<0)throw new Yn(`Array index out of bounds: ${n} < 0.`);if(n>=h.length)throw new Yn(`Array index out of bounds: ${n} > ${h.length-1}.`);if(n!==Math.floor(n))throw new Yn(`Array index must be an integer, but found ${n} instead.`);return h[n]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class sn{constructor(e,n){this.type=mt,this.needle=e,this.haystack=n}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const h=n.parse(e[1],1,gt),m=n.parse(e[2],2,gt);return h&&m?li(h.type,[mt,ze,Te,Re,gt])?new sn(h,m):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${tn(h.type)} instead`):null}evaluate(e){const n=this.needle.evaluate(e),h=this.haystack.evaluate(e);if(!h)return!1;if(!wi(n,["boolean","string","number","null"]))throw new Yn(`Expected first argument to be of type boolean, string, number or null, but found ${tn(Rn(n))} instead.`);if(!wi(h,["string","array"]))throw new Yn(`Expected second argument to be of type array or string, but found ${tn(Rn(h))} instead.`);return h.indexOf(n)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class bo{constructor(e,n,h){this.type=Te,this.needle=e,this.haystack=n,this.fromIndex=h}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 2 or 3 arguments, but found ${e.length-1} instead.`);const h=n.parse(e[1],1,gt),m=n.parse(e[2],2,gt);if(!h||!m)return null;if(!li(h.type,[mt,ze,Te,Re,gt]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${tn(h.type)} instead`);if(e.length===4){const y=n.parse(e[3],3,Te);return y?new bo(h,m,y):null}return new bo(h,m)}evaluate(e){const n=this.needle.evaluate(e),h=this.haystack.evaluate(e);if(!wi(n,["boolean","string","number","null"]))throw new Yn(`Expected first argument to be of type boolean, string, number or null, but found ${tn(Rn(n))} instead.`);let m;if(this.fromIndex&&(m=this.fromIndex.evaluate(e)),wi(h,["string"])){const y=h.indexOf(n,m);return y===-1?-1:[...h.slice(0,y)].length}if(wi(h,["array"]))return h.indexOf(n,m);throw new Yn(`Expected second argument to be of type array or string, but found ${tn(Rn(h))} instead.`)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class bn{constructor(e,n,h,m,y,v){this.inputType=e,this.type=n,this.input=h,this.cases=m,this.outputs=y,this.otherwise=v}static parse(e,n){if(e.length<5)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return n.error("Expected an even number of arguments.");let h,m;n.expectedType&&n.expectedType.kind!=="value"&&(m=n.expectedType);const y={},v=[];for(let P=2;P<e.length-1;P+=2){let O=e[P];const G=e[P+1];Array.isArray(O)||(O=[O]);const X=n.concat(P);if(O.length===0)return X.error("Expected at least one branch label.");for(const ae of O){if(typeof ae!="number"&&typeof ae!="string")return X.error("Branch labels must be numbers or strings.");if(typeof ae=="number"&&Math.abs(ae)>Number.MAX_SAFE_INTEGER)return X.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof ae=="number"&&Math.floor(ae)!==ae)return X.error("Numeric branch labels must be integer values.");if(h){if(X.checkSubtype(h,Rn(ae)))return null}else h=Rn(ae);if(y[String(ae)]!==void 0)return X.error("Branch labels must be unique.");y[String(ae)]=v.length}const K=n.parse(G,P,m);if(!K)return null;m=m||K.type,v.push(K)}const E=n.parse(e[1],1,gt);if(!E)return null;const k=n.parse(e[e.length-1],e.length-1,m);return k?E.type.kind!=="value"&&n.concat(1).checkSubtype(h,E.type)?null:new bn(h,m,E,y,v,k):null}evaluate(e){const n=this.input.evaluate(e);return(Rn(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))&&this.otherwise.outputDefined()}}class Fc{constructor(e,n,h){this.type=e,this.branches=n,this.otherwise=h}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return n.error("Expected an odd number of arguments.");let h;n.expectedType&&n.expectedType.kind!=="value"&&(h=n.expectedType);const m=[];for(let v=1;v<e.length-1;v+=2){const E=n.parse(e[v],v,mt);if(!E)return null;const k=n.parse(e[v+1],v+1,h);if(!k)return null;m.push([E,k]),h=h||k.type}const y=n.parse(e[e.length-1],e.length-1,h);if(!y)return null;if(!h)throw new Error("Can't infer output type");return new Fc(h,m,y)}evaluate(e){for(const[n,h]of this.branches)if(n.evaluate(e))return h.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[n,h]of this.branches)e(n),e(h);e(this.otherwise)}outputDefined(){return this.branches.every((([e,n])=>n.outputDefined()))&&this.otherwise.outputDefined()}}class _i{constructor(e,n,h,m){this.type=e,this.input=n,this.beginIndex=h,this.endIndex=m}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 2 or 3 arguments, but found ${e.length-1} instead.`);const h=n.parse(e[1],1,gt),m=n.parse(e[2],2,Te);if(!h||!m)return null;if(!li(h.type,[mn(gt),ze,gt]))return n.error(`Expected first argument to be of type array or string, but found ${tn(h.type)} instead`);if(e.length===4){const y=n.parse(e[3],3,Te);return y?new _i(h.type,h,m,y):null}return new _i(h.type,h,m)}evaluate(e){const n=this.input.evaluate(e),h=this.beginIndex.evaluate(e);let m;if(this.endIndex&&(m=this.endIndex.evaluate(e)),wi(n,["string"]))return[...n].slice(h,m).join("");if(wi(n,["array"]))return n.slice(h,m);throw new Yn(`Expected first argument to be of type array or string, but found ${tn(Rn(n))} instead.`)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function Rs(a,e){const n=a.length-1;let h,m,y=0,v=n,E=0;for(;y<=v;)if(E=Math.floor((y+v)/2),h=a[E],m=a[E+1],h<=e){if(E===n||e<m)return E;y=E+1}else{if(!(h>e))throw new Yn("Input is not a number.");v=E-1}return 0}class Ji{constructor(e,n,h){this.type=e,this.input=n,this.labels=[],this.outputs=[];for(const[m,y]of h)this.labels.push(m),this.outputs.push(y)}static parse(e,n){if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");const h=n.parse(e[1],1,Te);if(!h)return null;const m=[];let y=null;n.expectedType&&n.expectedType.kind!=="value"&&(y=n.expectedType);for(let v=1;v<e.length;v+=2){const E=v===1?-1/0:e[v],k=e[v+1],P=v,O=v+1;if(typeof E!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',P);if(m.length&&m[m.length-1][0]>=E)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',P);const G=n.parse(k,O,y);if(!G)return null;y=y||G.type,m.push([E,G])}return new Ji(y,h,m)}evaluate(e){const n=this.labels,h=this.outputs;if(n.length===1)return h[0].evaluate(e);const m=this.input.evaluate(e);if(m<=n[0])return h[0].evaluate(e);const y=n.length;return m>=n[y-1]?h[y-1].evaluate(e):h[Rs(n,m)].evaluate(e)}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}function oh(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var vs,tc,Lc=(function(){if(tc)return vs;function a(e,n,h,m){this.cx=3*e,this.bx=3*(h-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(m-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=n,this.p2x=h,this.p2y=m}return tc=1,vs=a,a.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,n){if(n===void 0&&(n=1e-6),e<0)return 0;if(e>1)return 1;for(var h=e,m=0;m<8;m++){var y=this.sampleCurveX(h)-e;if(Math.abs(y)<n)return h;var v=this.sampleCurveDerivativeX(h);if(Math.abs(v)<1e-6)break;h-=y/v}var E=0,k=1;for(h=e,m=0;m<20&&(y=this.sampleCurveX(h),!(Math.abs(y-e)<n));m++)e>y?E=h:k=h,h=.5*(k-E)+E;return h},solve:function(e,n){return this.sampleCurveY(this.solveCurveX(e,n))}},vs})(),mu=oh(Lc);class Ii{constructor(e,n,h,m,y){this.type=e,this.operator=n,this.interpolation=h,this.input=m,this.labels=[],this.outputs=[];for(const[v,E]of y)this.labels.push(v),this.outputs.push(E)}static interpolationFactor(e,n,h,m){let y=0;if(e.name==="exponential")y=ci(n,e.base,h,m);else if(e.name==="linear")y=ci(n,1,h,m);else if(e.name==="cubic-bezier"){const v=e.controlPoints;y=new mu(v[0],v[1],v[2],v[3]).solve(ci(n,1,h,m))}return y}static parse(e,n){let[h,m,y,...v]=e;if(!Array.isArray(m)||m.length===0)return n.error("Expected an interpolation type expression.",1);if(m[0]==="linear")m={name:"linear"};else if(m[0]==="exponential"){const P=m[1];if(typeof P!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:P}}else{if(m[0]!=="cubic-bezier")return n.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const P=m.slice(1);if(P.length!==4||P.some((O=>typeof O!="number"||O<0||O>1)))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:P}}}if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(y=n.parse(y,2,Te),!y)return null;const E=[];let k=null;h!=="interpolate-hcl"&&h!=="interpolate-lab"||n.expectedType==dr?n.expectedType&&n.expectedType.kind!=="value"&&(k=n.expectedType):k=Ut;for(let P=0;P<v.length;P+=2){const O=v[P],G=v[P+1],X=P+3,K=P+4;if(typeof O!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',X);if(E.length&&E[E.length-1][0]>=O)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',X);const ae=n.parse(G,K,k);if(!ae)return null;k=k||ae.type,E.push([O,ae])}return za(k,Te)||za(k,It)||za(k,Ut)||za(k,Sr)||za(k,xr)||za(k,dr)||za(k,Wn)||za(k,mn(Te))?new Ii(k,h,m,y,E):n.error(`Type ${tn(k)} is not interpolatable.`)}evaluate(e){const n=this.labels,h=this.outputs;if(n.length===1)return h[0].evaluate(e);const m=this.input.evaluate(e);if(m<=n[0])return h[0].evaluate(e);const y=n.length;if(m>=n[y-1])return h[y-1].evaluate(e);const v=Rs(n,m),E=Ii.interpolationFactor(this.interpolation,m,n[v],n[v+1]),k=h[v].evaluate(e),P=h[v+1].evaluate(e);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Js(k,P,E);case"color":return fn.interpolate(k,P,E);case"padding":return Ha.interpolate(k,P,E);case"colorArray":return Qr.interpolate(k,P,E);case"numberArray":return wa.interpolate(k,P,E);case"variableAnchorOffsetCollection":return zn.interpolate(k,P,E);case"array":return Ql(k,P,E);case"projectionDefinition":return la.interpolate(k,P,E)}case"interpolate-hcl":switch(this.type.kind){case"color":return fn.interpolate(k,P,E,"hcl");case"colorArray":return Qr.interpolate(k,P,E,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return fn.interpolate(k,P,E,"lab");case"colorArray":return Qr.interpolate(k,P,E,"lab")}}}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}function ci(a,e,n,h){const m=h-n,y=a-n;return m===0?0:e===1?y/m:(Math.pow(e,y)-1)/(Math.pow(e,m)-1)}const ca={color:fn.interpolate,number:Js,padding:Ha.interpolate,numberArray:wa.interpolate,colorArray:Qr.interpolate,variableAnchorOffsetCollection:zn.interpolate,array:Ql};class Yo{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");let h=null;const m=n.expectedType;m&&m.kind!=="value"&&(h=m);const y=[];for(const E of e.slice(1)){const k=n.parse(E,1+y.length,h,void 0,{typeAnnotation:"omit"});if(!k)return null;h=h||k.type,y.push(k)}if(!h)throw new Error("No output type");const v=m&&y.some((E=>xs(m,E.type)));return new Yo(v?gt:h,y)}evaluate(e){let n,h=null,m=0;for(const y of this.args)if(m++,h=y.evaluate(e),h&&h instanceof Oa&&!h.available&&(n||(n=h.name),h=null,m===this.args.length&&(h=n)),h!==null)break;return h}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}function Ko(a,e){return a==="=="||a==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function gu(a,e,n,h){return h.compare(e,n)===0}function Ta(a,e,n){const h=a!=="=="&&a!=="!=";return class Ew{constructor(y,v,E){this.type=mt,this.lhs=y,this.rhs=v,this.collator=E,this.hasUntypedArgument=y.type.kind==="value"||v.type.kind==="value"}static parse(y,v){if(y.length!==3&&y.length!==4)return v.error("Expected two or three arguments.");const E=y[0];let k=v.parse(y[1],1,gt);if(!k)return null;if(!Ko(E,k.type))return v.concat(1).error(`"${E}" comparisons are not supported for type '${tn(k.type)}'.`);let P=v.parse(y[2],2,gt);if(!P)return null;if(!Ko(E,P.type))return v.concat(2).error(`"${E}" comparisons are not supported for type '${tn(P.type)}'.`);if(k.type.kind!==P.type.kind&&k.type.kind!=="value"&&P.type.kind!=="value")return v.error(`Cannot compare types '${tn(k.type)}' and '${tn(P.type)}'.`);h&&(k.type.kind==="value"&&P.type.kind!=="value"?k=new Ri(P.type,[k]):k.type.kind!=="value"&&P.type.kind==="value"&&(P=new Ri(k.type,[P])));let O=null;if(y.length===4){if(k.type.kind!=="string"&&P.type.kind!=="string"&&k.type.kind!=="value"&&P.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(O=v.parse(y[3],3,ir),!O)return null}return new Ew(k,P,O)}evaluate(y){const v=this.lhs.evaluate(y),E=this.rhs.evaluate(y);if(h&&this.hasUntypedArgument){const k=Rn(v),P=Rn(E);if(k.kind!==P.kind||k.kind!=="string"&&k.kind!=="number")throw new Yn(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${k.kind}, ${P.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){const k=Rn(v),P=Rn(E);if(k.kind!=="string"||P.kind!=="string")return e(y,v,E)}return this.collator?n(y,v,E,this.collator.evaluate(y)):e(y,v,E)}eachChild(y){y(this.lhs),y(this.rhs),this.collator&&y(this.collator)}outputDefined(){return!0}}}const $h=Ta("==",(function(a,e,n){return e===n}),gu),Gn=Ta("!=",(function(a,e,n){return e!==n}),(function(a,e,n,h){return!gu(0,e,n,h)})),_u=Ta("<",(function(a,e,n){return e<n}),(function(a,e,n,h){return h.compare(e,n)<0})),Kn=Ta(">",(function(a,e,n){return e>n}),(function(a,e,n,h){return h.compare(e,n)>0})),wo=Ta("<=",(function(a,e,n){return e<=n}),(function(a,e,n,h){return h.compare(e,n)<=0})),kl=Ta(">=",(function(a,e,n){return e>=n}),(function(a,e,n,h){return h.compare(e,n)>=0}));class Cl{constructor(e,n,h){this.type=ir,this.locale=h,this.caseSensitive=e,this.diacriticSensitive=n}static parse(e,n){if(e.length!==2)return n.error("Expected one argument.");const h=e[1];if(typeof h!="object"||Array.isArray(h))return n.error("Collator options argument must be an object.");const m=n.parse(h["case-sensitive"]!==void 0&&h["case-sensitive"],1,mt);if(!m)return null;const y=n.parse(h["diacritic-sensitive"]!==void 0&&h["diacritic-sensitive"],1,mt);if(!y)return null;let v=null;return h.locale&&(v=n.parse(h.locale,1,ze),!v)?null:new Cl(m,y,v)}evaluate(e){return new Ds(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}class Ml{constructor(e,n,h,m,y){this.type=ze,this.number=e,this.locale=n,this.currency=h,this.minFractionDigits=m,this.maxFractionDigits=y}static parse(e,n){if(e.length!==3)return n.error("Expected two arguments.");const h=n.parse(e[1],1,Te);if(!h)return null;const m=e[2];if(typeof m!="object"||Array.isArray(m))return n.error("NumberFormat options argument must be an object.");let y=null;if(m.locale&&(y=n.parse(m.locale,1,ze),!y))return null;let v=null;if(m.currency&&(v=n.parse(m.currency,1,ze),!v))return null;let E=null;if(m["min-fraction-digits"]&&(E=n.parse(m["min-fraction-digits"],1,Te),!E))return null;let k=null;return m["max-fraction-digits"]&&(k=n.parse(m["max-fraction-digits"],1,Te),!k)?null:new Ml(h,y,v,E,k)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class rc{constructor(e){this.type=vr,this.sections=e}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const h=e[1];if(!Array.isArray(h)&&typeof h=="object")return n.error("First argument must be an image or text section.");const m=[];let y=!1;for(let v=1;v<=e.length-1;++v){const E=e[v];if(y&&typeof E=="object"&&!Array.isArray(E)){y=!1;let k=null;if(E["font-scale"]&&(k=n.parse(E["font-scale"],1,Te),!k))return null;let P=null;if(E["text-font"]&&(P=n.parse(E["text-font"],1,mn(ze)),!P))return null;let O=null;if(E["text-color"]&&(O=n.parse(E["text-color"],1,Ut),!O))return null;let G=null;if(E["vertical-align"]){if(typeof E["vertical-align"]=="string"&&!ec.includes(E["vertical-align"]))return n.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${E["vertical-align"]}' instead.`);if(G=n.parse(E["vertical-align"],1,ze),!G)return null}const X=m[m.length-1];X.scale=k,X.font=P,X.textColor=O,X.verticalAlign=G}else{const k=n.parse(e[v],1,gt);if(!k)return null;const P=k.type.kind;if(P!=="string"&&P!=="value"&&P!=="null"&&P!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,m.push({content:k,scale:null,font:null,textColor:null,verticalAlign:null})}}return new rc(m)}evaluate(e){return new ba(this.sections.map((n=>{const h=n.content.evaluate(e);return Rn(h)===Nr?new pu("",h,null,null,null,n.verticalAlign?n.verticalAlign.evaluate(e):null):new pu(Si(h),null,n.scale?n.scale.evaluate(e):null,n.font?n.font.evaluate(e).join(","):null,n.textColor?n.textColor.evaluate(e):null,n.verticalAlign?n.verticalAlign.evaluate(e):null)})))}eachChild(e){for(const n of this.sections)e(n.content),n.scale&&e(n.scale),n.font&&e(n.font),n.textColor&&e(n.textColor),n.verticalAlign&&e(n.verticalAlign)}outputDefined(){return!1}}class Jo{constructor(e){this.type=Nr,this.input=e}static parse(e,n){if(e.length!==2)return n.error("Expected two arguments.");const h=n.parse(e[1],1,ze);return h?new Jo(h):n.error("No image name provided.")}evaluate(e){const n=this.input.evaluate(e),h=Oa.fromString(n);return h&&e.availableImages&&(h.available=e.availableImages.indexOf(n)>-1),h}eachChild(e){e(this.input)}outputDefined(){return!1}}class nc{constructor(e){this.type=Te,this.input=e}static parse(e,n){if(e.length!==2)return n.error(`Expected 1 argument, but found ${e.length-1} instead.`);const h=n.parse(e[1],1);return h?h.type.kind!=="array"&&h.type.kind!=="string"&&h.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${tn(h.type)} instead.`):new nc(h):null}evaluate(e){const n=this.input.evaluate(e);if(typeof n=="string")return[...n].length;if(Array.isArray(n))return n.length;throw new Yn(`Expected value to be of type string or array, but found ${tn(Rn(n))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const Ra=8192;function To(a,e){const n=(180+a[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,m=Math.pow(2,e.z);return[Math.round(n*m*Ra),Math.round(h*m*Ra)]}function ac(a,e){const n=Math.pow(2,e.z);return[(m=(a[0]/Ra+e.x)/n,360*m-180),(h=(a[1]/Ra+e.y)/n,360/Math.PI*Math.atan(Math.exp((180-360*h)*Math.PI/180))-90)];var h,m}function So(a,e){a[0]=Math.min(a[0],e[0]),a[1]=Math.min(a[1],e[1]),a[2]=Math.max(a[2],e[0]),a[3]=Math.max(a[3],e[1])}function eo(a,e){return!(a[0]<=e[0]||a[2]>=e[2]||a[1]<=e[1]||a[3]>=e[3])}function lh(a,e,n){const h=a[0]-e[0],m=a[1]-e[1],y=a[0]-n[0],v=a[1]-n[1];return h*v-y*m==0&&h*y<=0&&m*v<=0}function Dl(a,e,n,h){return(m=[h[0]-n[0],h[1]-n[1]])[0]*(y=[e[0]-a[0],e[1]-a[1]])[1]-m[1]*y[0]!=0&&!(!Aa(a,e,n,h)||!Aa(n,h,a,e));var m,y}function Xh(a,e,n){for(const h of n)for(let m=0;m<h.length-1;++m)if(Dl(a,e,h[m],h[m+1]))return!0;return!1}function Is(a,e,n=!1){let h=!1;for(const E of e)for(let k=0;k<E.length-1;k++){if(lh(a,E[k],E[k+1]))return n;(y=E[k])[1]>(m=a)[1]!=(v=E[k+1])[1]>m[1]&&m[0]<(v[0]-y[0])*(m[1]-y[1])/(v[1]-y[1])+y[0]&&(h=!h)}var m,y,v;return h}function xu(a,e){for(const n of e)if(Is(a,n))return!0;return!1}function Za(a,e){for(const n of a)if(!Is(n,e))return!1;for(let n=0;n<a.length-1;++n)if(Xh(a[n],a[n+1],e))return!1;return!0}function Qo(a,e){for(const n of e)if(Za(a,n))return!0;return!1}function Aa(a,e,n,h){const m=h[0]-n[0],y=h[1]-n[1],v=(a[0]-n[0])*y-m*(a[1]-n[1]),E=(e[0]-n[0])*y-m*(e[1]-n[1]);return v>0&&E<0||v<0&&E>0}function bs(a,e,n){const h=[];for(let m=0;m<a.length;m++){const y=[];for(let v=0;v<a[m].length;v++){const E=To(a[m][v],n);So(e,E),y.push(E)}h.push(y)}return h}function Ps(a,e,n){const h=[];for(let m=0;m<a.length;m++){const y=bs(a[m],e,n);h.push(y)}return h}function Rl(a,e,n,h){if(a[0]<n[0]||a[0]>n[2]){const m=.5*h;let y=a[0]-n[0]>m?-h:n[0]-a[0]>m?h:0;y===0&&(y=a[0]-n[2]>m?-h:n[2]-a[0]>m?h:0),a[0]+=y}So(e,a)}function zc(a,e,n,h){const m=Math.pow(2,h.z)*Ra,y=[h.x*Ra,h.y*Ra],v=[];for(const E of a)for(const k of E){const P=[k.x+y[0],k.y+y[1]];Rl(P,e,n,m),v.push(P)}return v}function Qi(a,e,n,h){const m=Math.pow(2,h.z)*Ra,y=[h.x*Ra,h.y*Ra],v=[];for(const k of a){const P=[];for(const O of k){const G=[O.x+y[0],O.y+y[1]];So(e,G),P.push(G)}v.push(P)}if(e[2]-e[0]<=m/2){(E=e)[0]=E[1]=1/0,E[2]=E[3]=-1/0;for(const k of v)for(const P of k)Rl(P,e,n,m)}var E;return v}class el{constructor(e,n){this.type=mt,this.geojson=e,this.geometries=n}static parse(e,n){if(e.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(vo(e[1])){const h=e[1];if(h.type==="FeatureCollection"){const m=[];for(const y of h.features){const{type:v,coordinates:E}=y.geometry;v==="Polygon"&&m.push(E),v==="MultiPolygon"&&m.push(...E)}if(m.length)return new el(h,{type:"MultiPolygon",coordinates:m})}else if(h.type==="Feature"){const m=h.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new el(h,h.geometry)}else if(h.type==="Polygon"||h.type==="MultiPolygon")return new el(h,h)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return(function(n,h){const m=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],v=n.canonicalID();if(h.type==="Polygon"){const E=bs(h.coordinates,y,v),k=zc(n.geometry(),m,y,v);if(!eo(m,y))return!1;for(const P of k)if(!Is(P,E))return!1}if(h.type==="MultiPolygon"){const E=Ps(h.coordinates,y,v),k=zc(n.geometry(),m,y,v);if(!eo(m,y))return!1;for(const P of k)if(!xu(P,E))return!1}return!0})(e,this.geometries);if(e.geometryType()==="LineString")return(function(n,h){const m=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],v=n.canonicalID();if(h.type==="Polygon"){const E=bs(h.coordinates,y,v),k=Qi(n.geometry(),m,y,v);if(!eo(m,y))return!1;for(const P of k)if(!Za(P,E))return!1}if(h.type==="MultiPolygon"){const E=Ps(h.coordinates,y,v),k=Qi(n.geometry(),m,y,v);if(!eo(m,y))return!1;for(const P of k)if(!Qo(P,E))return!1}return!0})(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Il=class{constructor(a=[],e=(n,h)=>n<h?-1:n>h?1:0){if(this.data=a,this.length=this.data.length,this.compare=e,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(a){this.data.push(a),this._up(this.length++)}pop(){if(this.length===0)return;const a=this.data[0],e=this.data.pop();return--this.length>0&&(this.data[0]=e,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:e,compare:n}=this,h=e[a];for(;a>0;){const m=a-1>>1,y=e[m];if(n(h,y)>=0)break;e[a]=y,a=m}e[a]=h}_down(a){const{data:e,compare:n}=this,h=this.length>>1,m=e[a];for(;a<h;){let y=1+(a<<1);const v=y+1;if(v<this.length&&n(e[v],e[y])<0&&(y=v),n(e[y],m)>=0)break;e[a]=e[y],a=y}e[a]=m}};function ic(a,e,n=0,h=a.length-1,m=to){for(;h>n;){if(h-n>600){const k=h-n+1,P=e-n+1,O=Math.log(k),G=.5*Math.exp(2*O/3),X=.5*Math.sqrt(O*G*(k-G)/k)*(P-k/2<0?-1:1);ic(a,e,Math.max(n,Math.floor(e-P*G/k+X)),Math.min(h,Math.floor(e+(k-P)*G/k+X)),m)}const y=a[e];let v=n,E=h;for(tl(a,n,e),m(a[h],y)>0&&tl(a,n,h);v<E;){for(tl(a,v,E),v++,E--;m(a[v],y)<0;)v++;for(;m(a[E],y)>0;)E--}m(a[n],y)===0?tl(a,n,E):(E++,tl(a,E,h)),E<=e&&(n=E+1),e<=E&&(h=E-1)}}function tl(a,e,n){const h=a[e];a[e]=a[n],a[n]=h}function to(a,e){return a<e?-1:a>e?1:0}function Oc(a,e){if(a.length<=1)return[a];const n=[];let h,m;for(const y of a){const v=Pl(y);v!==0&&(y.area=Math.abs(v),m===void 0&&(m=v<0),m===v<0?(h&&n.push(h),h=[y]):h.push(y))}if(h&&n.push(h),e>1)for(let y=0;y<n.length;y++)n[y].length<=e||(ic(n[y],e,1,n[y].length-1,Bc),n[y]=n[y].slice(0,e));return n}function Bc(a,e){return e.area-a.area}function Pl(a){let e=0;for(let n,h,m=0,y=a.length,v=y-1;m<y;v=m++)n=a[m],h=a[v],e+=(h.x-n.x)*(n.y+h.y);return e}const ch=1/298.257223563,Fs=ch*(2-ch),ro=Math.PI/180;class Nc{constructor(e){const n=6378.137*ro*1e3,h=Math.cos(e*ro),m=1/(1-Fs*(1-h*h)),y=Math.sqrt(m);this.kx=n*y*h,this.ky=n*y*m*(1-Fs)}distance(e,n){const h=this.wrap(e[0]-n[0])*this.kx,m=(e[1]-n[1])*this.ky;return Math.sqrt(h*h+m*m)}pointOnLine(e,n){let h,m,y,v,E=1/0;for(let k=0;k<e.length-1;k++){let P=e[k][0],O=e[k][1],G=this.wrap(e[k+1][0]-P)*this.kx,X=(e[k+1][1]-O)*this.ky,K=0;G===0&&X===0||(K=(this.wrap(n[0]-P)*this.kx*G+(n[1]-O)*this.ky*X)/(G*G+X*X),K>1?(P=e[k+1][0],O=e[k+1][1]):K>0&&(P+=G/this.kx*K,O+=X/this.ky*K)),G=this.wrap(n[0]-P)*this.kx,X=(n[1]-O)*this.ky;const ae=G*G+X*X;ae<E&&(E=ae,h=P,m=O,y=k,v=K)}return{point:[h,m],index:y,t:Math.max(0,Math.min(1,v))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}}function es(a,e){return e[0]-a[0]}function Fl(a){return a[1]-a[0]+1}function Ls(a,e){return a[1]>=a[0]&&a[1]<e}function yu(a,e){if(a[0]>a[1])return[null,null];const n=Fl(a);if(e){if(n===2)return[a,null];const m=Math.floor(n/2);return[[a[0],a[0]+m],[a[0]+m,a[1]]]}if(n===1)return[a,null];const h=Math.floor(n/2)-1;return[[a[0],a[0]+h],[a[0]+h+1,a[1]]]}function uh(a,e){if(!Ls(e,a.length))return[1/0,1/0,-1/0,-1/0];const n=[1/0,1/0,-1/0,-1/0];for(let h=e[0];h<=e[1];++h)So(n,a[h]);return n}function vu(a){const e=[1/0,1/0,-1/0,-1/0];for(const n of a)for(const h of n)So(e,h);return e}function Ll(a){return a[0]!==-1/0&&a[1]!==-1/0&&a[2]!==1/0&&a[3]!==1/0}function jc(a,e,n){if(!Ll(a)||!Ll(e))return NaN;let h=0,m=0;return a[2]<e[0]&&(h=e[0]-a[2]),a[0]>e[2]&&(h=a[0]-e[2]),a[1]>e[3]&&(m=a[1]-e[3]),a[3]<e[1]&&(m=e[1]-a[3]),n.distance([0,0],[h,m])}function ws(a,e,n){const h=n.pointOnLine(e,a);return n.distance(a,h.point)}function sc(a,e,n,h,m){const y=Math.min(ws(a,[n,h],m),ws(e,[n,h],m)),v=Math.min(ws(n,[a,e],m),ws(h,[a,e],m));return Math.min(y,v)}function oc(a,e,n,h,m){if(!Ls(e,a.length)||!Ls(h,n.length))return 1/0;let y=1/0;for(let v=e[0];v<e[1];++v){const E=a[v],k=a[v+1];for(let P=h[0];P<h[1];++P){const O=n[P],G=n[P+1];if(Dl(E,k,O,G))return 0;y=Math.min(y,sc(E,k,O,G,m))}}return y}function bu(a,e,n,h,m){if(!Ls(e,a.length)||!Ls(h,n.length))return NaN;let y=1/0;for(let v=e[0];v<=e[1];++v)for(let E=h[0];E<=h[1];++E)if(y=Math.min(y,m.distance(a[v],n[E])),y===0)return y;return y}function wu(a,e,n){if(Is(a,e,!0))return 0;let h=1/0;for(const m of e){const y=m[0],v=m[m.length-1];if(y!==v&&(h=Math.min(h,ws(a,[v,y],n)),h===0))return h;const E=n.pointOnLine(m,a);if(h=Math.min(h,n.distance(a,E.point)),h===0)return h}return h}function lc(a,e,n,h){if(!Ls(e,a.length))return NaN;for(let y=e[0];y<=e[1];++y)if(Is(a[y],n,!0))return 0;let m=1/0;for(let y=e[0];y<e[1];++y){const v=a[y],E=a[y+1];for(const k of n)for(let P=0,O=k.length,G=O-1;P<O;G=P++){const X=k[G],K=k[P];if(Dl(v,E,X,K))return 0;m=Math.min(m,sc(v,E,X,K,h))}}return m}function zl(a,e){for(const n of a)for(const h of n)if(Is(h,e,!0))return!0;return!1}function Uc(a,e,n,h=1/0){const m=vu(a),y=vu(e);if(h!==1/0&&jc(m,y,n)>=h)return h;if(eo(m,y)){if(zl(a,e))return 0}else if(zl(e,a))return 0;let v=1/0;for(const E of a)for(let k=0,P=E.length,O=P-1;k<P;O=k++){const G=E[O],X=E[k];for(const K of e)for(let ae=0,oe=K.length,he=oe-1;ae<oe;he=ae++){const be=K[he],Ze=K[ae];if(Dl(G,X,be,Ze))return 0;v=Math.min(v,sc(G,X,be,Ze,n))}}return v}function En(a,e,n,h,m,y){if(!y)return;const v=jc(uh(h,y),m,n);v<e&&a.push([v,y,[0,0]])}function Eo(a,e,n,h,m,y,v){if(!y||!v)return;const E=jc(uh(h,y),uh(m,v),n);E<e&&a.push([E,y,v])}function Tu(a,e,n,h,m=1/0){let y=Math.min(h.distance(a[0],n[0][0]),m);if(y===0)return y;const v=new Il([[0,[0,a.length-1],[0,0]]],es),E=vu(n);for(;v.length>0;){const k=v.pop();if(k[0]>=y)continue;const P=k[1],O=e?50:100;if(Fl(P)<=O){if(!Ls(P,a.length))return NaN;if(e){const G=lc(a,P,n,h);if(isNaN(G)||G===0)return G;y=Math.min(y,G)}else for(let G=P[0];G<=P[1];++G){const X=wu(a[G],n,h);if(y=Math.min(y,X),y===0)return 0}}else{const G=yu(P,e);En(v,y,h,a,E,G[0]),En(v,y,h,a,E,G[1])}}return y}function Su(a,e,n,h,m,y=1/0){let v=Math.min(y,m.distance(a[0],n[0]));if(v===0)return v;const E=new Il([[0,[0,a.length-1],[0,n.length-1]]],es);for(;E.length>0;){const k=E.pop();if(k[0]>=v)continue;const P=k[1],O=k[2],G=e?50:100,X=h?50:100;if(Fl(P)<=G&&Fl(O)<=X){if(!Ls(P,a.length)&&Ls(O,n.length))return NaN;let K;if(e&&h)K=oc(a,P,n,O,m),v=Math.min(v,K);else if(e&&!h){const ae=a.slice(P[0],P[1]+1);for(let oe=O[0];oe<=O[1];++oe)if(K=ws(n[oe],ae,m),v=Math.min(v,K),v===0)return v}else if(!e&&h){const ae=n.slice(O[0],O[1]+1);for(let oe=P[0];oe<=P[1];++oe)if(K=ws(a[oe],ae,m),v=Math.min(v,K),v===0)return v}else K=bu(a,P,n,O,m),v=Math.min(v,K)}else{const K=yu(P,e),ae=yu(O,h);Eo(E,v,m,a,n,K[0],ae[0]),Eo(E,v,m,a,n,K[0],ae[1]),Eo(E,v,m,a,n,K[1],ae[0]),Eo(E,v,m,a,n,K[1],ae[1])}}return v}function hh(a){return a.type==="MultiPolygon"?a.coordinates.map((e=>({type:"Polygon",coordinates:e}))):a.type==="MultiLineString"?a.coordinates.map((e=>({type:"LineString",coordinates:e}))):a.type==="MultiPoint"?a.coordinates.map((e=>({type:"Point",coordinates:e}))):[a]}class cc{constructor(e,n){this.type=Te,this.geojson=e,this.geometries=n}static parse(e,n){if(e.length!==2)return n.error(`'distance' expression requires exactly one argument, but found ${e.length-1} instead.`);if(vo(e[1])){const h=e[1];if(h.type==="FeatureCollection")return new cc(h,h.features.map((m=>hh(m.geometry))).flat());if(h.type==="Feature")return new cc(h,hh(h.geometry));if("type"in h&&"coordinates"in h)return new cc(h,hh(h))}return n.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return(function(n,h){const m=n.geometry(),y=m.flat().map((k=>ac([k.x,k.y],n.canonical)));if(m.length===0)return NaN;const v=new Nc(y[0][1]);let E=1/0;for(const k of h){switch(k.type){case"Point":E=Math.min(E,Su(y,!1,[k.coordinates],!1,v,E));break;case"LineString":E=Math.min(E,Su(y,!1,k.coordinates,!0,v,E));break;case"Polygon":E=Math.min(E,Tu(y,!1,k.coordinates,v,E))}if(E===0)return E}return E})(e,this.geometries);if(e.geometryType()==="LineString")return(function(n,h){const m=n.geometry(),y=m.flat().map((k=>ac([k.x,k.y],n.canonical)));if(m.length===0)return NaN;const v=new Nc(y[0][1]);let E=1/0;for(const k of h){switch(k.type){case"Point":E=Math.min(E,Su(y,!0,[k.coordinates],!1,v,E));break;case"LineString":E=Math.min(E,Su(y,!0,k.coordinates,!0,v,E));break;case"Polygon":E=Math.min(E,Tu(y,!0,k.coordinates,v,E))}if(E===0)return E}return E})(e,this.geometries);if(e.geometryType()==="Polygon")return(function(n,h){const m=n.geometry();if(m.length===0||m[0].length===0)return NaN;const y=Oc(m,0).map((k=>k.map((P=>P.map((O=>ac([O.x,O.y],n.canonical))))))),v=new Nc(y[0][0][0][1]);let E=1/0;for(const k of h)for(const P of y){switch(k.type){case"Point":E=Math.min(E,Tu([k.coordinates],!1,P,v,E));break;case"LineString":E=Math.min(E,Tu(k.coordinates,!0,P,v,E));break;case"Polygon":E=Math.min(E,Uc(P,k.coordinates,v,E))}if(E===0)return E}return E})(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Ao{constructor(e){this.type=gt,this.key=e}static parse(e,n){if(e.length!==2)return n.error(`Expected 1 argument, but found ${e.length-1} instead.`);const h=e[1];return h==null?n.error("Global state property must be defined."):typeof h!="string"?n.error(`Global state property must be string, but found ${typeof e[1]} instead.`):new Ao(h)}evaluate(e){var n;const h=(n=e.globals)===null||n===void 0?void 0:n.globalState;return h&&Object.keys(h).length!==0?Jl(h,this.key):null}eachChild(){}outputDefined(){return!1}}const uc={"==":$h,"!=":Gn,">":Kn,"<":_u,">=":kl,"<=":wo,array:Ri,at:cn,boolean:Ri,case:Fc,coalesce:Yo,collator:Cl,format:rc,image:Jo,in:sn,"index-of":bo,interpolate:Ii,"interpolate-hcl":Ii,"interpolate-lab":Ii,length:nc,let:Zn,literal:ri,match:bn,number:Ri,"number-format":Ml,object:Ri,slice:_i,step:Ji,string:Ri,"to-boolean":Da,"to-color":Da,"to-number":Da,"to-string":Da,var:Xo,within:el,distance:cc,"global-state":Ao};class Pi{constructor(e,n,h,m){this.name=e,this.type=n,this._evaluate=h,this.args=m}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,n){const h=e[0],m=Pi.definitions[h];if(!m)return n.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);const y=Array.isArray(m)?m[0]:m.type,v=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,E=v.filter((([P])=>!Array.isArray(P)||P.length===e.length-1));let k=null;for(const[P,O]of E){k=new ls(n.registry,Ei,n.path,null,n.scope);const G=[];let X=!1;for(let K=1;K<e.length;K++){const ae=e[K],oe=Array.isArray(P)?P[K-1]:P.type,he=k.parse(ae,1+G.length,oe);if(!he){X=!0;break}G.push(he)}if(!X)if(Array.isArray(P)&&P.length!==G.length)k.error(`Expected ${P.length} arguments, but found ${G.length} instead.`);else{for(let K=0;K<G.length;K++){const ae=Array.isArray(P)?P[K]:P.type,oe=G[K];k.concat(K+1).checkSubtype(ae,oe.type)}if(k.errors.length===0)return new Pi(h,y,O,G)}}if(E.length===1)n.errors.push(...k.errors);else{const P=(E.length?E:v).map((([G])=>{return X=G,Array.isArray(X)?`(${X.map(tn).join(", ")})`:`(${tn(X.type)}...)`;var X})).join(" | "),O=[];for(let G=1;G<e.length;G++){const X=n.parse(e[G],1+O.length);if(!X)return null;O.push(tn(X.type))}n.error(`Expected arguments of type ${P}, but found (${O.join(", ")}) instead.`)}return null}static register(e,n){Pi.definitions=n;for(const h in n)e[h]=Pi}}function fh(a,[e,n,h,m]){e=e.evaluate(a),n=n.evaluate(a),h=h.evaluate(a);const y=m?m.evaluate(a):1,v=_a(e,n,h,y);if(v)throw new Yn(v);return new fn(e/255,n/255,h/255,y,!1)}function rl(a,e){return a in e}function cs(a,e){const n=e[a];return n===void 0?null:n}function zs(a){return{type:a}}function Ei(a){if(a instanceof Xo)return Ei(a.boundExpression);if(a instanceof Pi&&a.name==="error"||a instanceof Cl||a instanceof el||a instanceof cc||a instanceof Ao)return!1;const e=a instanceof Da||a instanceof Ri;let n=!0;return a.eachChild((h=>{n=e?n&&Ei(h):n&&h instanceof ri})),!!n&&no(a)&&fc(a,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function no(a){if(a instanceof Pi&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof el||a instanceof cc)return!1;let e=!0;return a.eachChild((n=>{e&&!no(n)&&(e=!1)})),e}function hc(a){if(a instanceof Pi&&a.name==="feature-state")return!1;let e=!0;return a.eachChild((n=>{e&&!hc(n)&&(e=!1)})),e}function fc(a,e){if(a instanceof Pi&&e.indexOf(a.name)>=0)return!1;let n=!0;return a.eachChild((h=>{n&&!fc(h,e)&&(n=!1)})),n}function Vc(a){return{result:"success",value:a}}function ao(a){return{result:"error",value:a}}function Os(a){return a["property-type"]==="data-driven"||a["property-type"]==="cross-faded-data-driven"}function dh(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function Gc(a){return!!a.expression&&a.expression.interpolated}function dn(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}function ph(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)&&Rn(a)===Tt}function Ts(a){return a}function ee(a,e){const n=a.stops&&typeof a.stops[0][0]=="object",h=n||!(n||a.property!==void 0),m=a.type||(Gc(e)?"exponential":"interval"),y=(function(O){switch(O.type){case"color":return fn.parse;case"padding":return Ha.parse;case"numberArray":return wa.parse;case"colorArray":return Qr.parse;default:return null}})(e);if(y&&((a=xe({},a)).stops&&(a.stops=a.stops.map((O=>[O[0],y(O[1])]))),a.default=y(a.default?a.default:e.default)),a.colorSpace&&(v=a.colorSpace)!=="rgb"&&v!=="hcl"&&v!=="lab")throw new Error(`Unknown color space: "${a.colorSpace}"`);var v;const E=(function(O){switch(O){case"exponential":return St;case"interval":return er;case"categorical":return ht;case"identity":return _r;default:throw new Error(`Unknown function type "${O}"`)}})(m);let k,P;if(m==="categorical"){k=Object.create(null);for(const O of a.stops)k[O[0]]=O[1];P=typeof a.stops[0][0]}if(n){const O={},G=[];for(let ae=0;ae<a.stops.length;ae++){const oe=a.stops[ae],he=oe[0].zoom;O[he]===void 0&&(O[he]={zoom:he,type:a.type,property:a.property,default:a.default,stops:[]},G.push(he)),O[he].stops.push([oe[0].value,oe[1]])}const X=[];for(const ae of G)X.push([O[ae].zoom,ee(O[ae],e)]);const K={name:"linear"};return{kind:"composite",interpolationType:K,interpolationFactor:Ii.interpolationFactor.bind(void 0,K),zoomStops:X.map((ae=>ae[0])),evaluate:({zoom:ae},oe)=>St({stops:X,base:a.base},e,ae).evaluate(ae,oe)}}if(h){const O=m==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:O,interpolationFactor:Ii.interpolationFactor.bind(void 0,O),zoomStops:a.stops.map((G=>G[0])),evaluate:({zoom:G})=>E(a,e,G,k,P)}}return{kind:"source",evaluate(O,G){const X=G&&G.properties?G.properties[a.property]:void 0;return X===void 0?Ke(a.default,e.default):E(a,e,X,k,P)}}}function Ke(a,e,n){return a!==void 0?a:e!==void 0?e:n!==void 0?n:void 0}function ht(a,e,n,h,m){return Ke(typeof n===m?h[n]:void 0,a.default,e.default)}function er(a,e,n){if(dn(n)!=="number")return Ke(a.default,e.default);const h=a.stops.length;if(h===1||n<=a.stops[0][0])return a.stops[0][1];if(n>=a.stops[h-1][0])return a.stops[h-1][1];const m=Rs(a.stops.map((y=>y[0])),n);return a.stops[m][1]}function St(a,e,n){const h=a.base!==void 0?a.base:1;if(dn(n)!=="number")return Ke(a.default,e.default);const m=a.stops.length;if(m===1||n<=a.stops[0][0])return a.stops[0][1];if(n>=a.stops[m-1][0])return a.stops[m-1][1];const y=Rs(a.stops.map((O=>O[0])),n),v=(function(O,G,X,K){const ae=K-X,oe=O-X;return ae===0?0:G===1?oe/ae:(Math.pow(G,oe)-1)/(Math.pow(G,ae)-1)})(n,h,a.stops[y][0],a.stops[y+1][0]),E=a.stops[y][1],k=a.stops[y+1][1],P=ca[e.type]||Ts;return typeof E.evaluate=="function"?{evaluate(...O){const G=E.evaluate.apply(void 0,O),X=k.evaluate.apply(void 0,O);if(G!==void 0&&X!==void 0)return P(G,X,v,a.colorSpace)}}:P(E,k,v,a.colorSpace)}function _r(a,e,n){switch(e.type){case"color":n=fn.parse(n);break;case"formatted":n=ba.fromString(n.toString());break;case"resolvedImage":n=Oa.fromString(n.toString());break;case"padding":n=Ha.parse(n);break;case"colorArray":n=Qr.parse(n);break;case"numberArray":n=wa.parse(n);break;default:dn(n)===e.type||e.type==="enum"&&e.values[n]||(n=void 0)}return Ke(n,a.default,e.default)}Pi.register(uc,{error:[{kind:"error"},[ze],(a,[e])=>{throw new Yn(e.evaluate(a))}],typeof:[ze,[gt],(a,[e])=>tn(Rn(e.evaluate(a)))],"to-rgba":[mn(Te,4),[Ut],(a,[e])=>{const[n,h,m,y]=e.evaluate(a).rgb;return[255*n,255*h,255*m,y]}],rgb:[Ut,[Te,Te,Te],fh],rgba:[Ut,[Te,Te,Te,Te],fh],has:{type:mt,overloads:[[[ze],(a,[e])=>rl(e.evaluate(a),a.properties())],[[ze,Tt],(a,[e,n])=>rl(e.evaluate(a),n.evaluate(a))]]},get:{type:gt,overloads:[[[ze],(a,[e])=>cs(e.evaluate(a),a.properties())],[[ze,Tt],(a,[e,n])=>cs(e.evaluate(a),n.evaluate(a))]]},"feature-state":[gt,[ze],(a,[e])=>cs(e.evaluate(a),a.featureState||{})],properties:[Tt,[],a=>a.properties()],"geometry-type":[ze,[],a=>a.geometryType()],id:[gt,[],a=>a.id()],zoom:[Te,[],a=>a.globals.zoom],"heatmap-density":[Te,[],a=>a.globals.heatmapDensity||0],elevation:[Te,[],a=>a.globals.elevation||0],"line-progress":[Te,[],a=>a.globals.lineProgress||0],accumulated:[gt,[],a=>a.globals.accumulated===void 0?null:a.globals.accumulated],"+":[Te,zs(Te),(a,e)=>{let n=0;for(const h of e)n+=h.evaluate(a);return n}],"*":[Te,zs(Te),(a,e)=>{let n=1;for(const h of e)n*=h.evaluate(a);return n}],"-":{type:Te,overloads:[[[Te,Te],(a,[e,n])=>e.evaluate(a)-n.evaluate(a)],[[Te],(a,[e])=>-e.evaluate(a)]]},"/":[Te,[Te,Te],(a,[e,n])=>e.evaluate(a)/n.evaluate(a)],"%":[Te,[Te,Te],(a,[e,n])=>e.evaluate(a)%n.evaluate(a)],ln2:[Te,[],()=>Math.LN2],pi:[Te,[],()=>Math.PI],e:[Te,[],()=>Math.E],"^":[Te,[Te,Te],(a,[e,n])=>Math.pow(e.evaluate(a),n.evaluate(a))],sqrt:[Te,[Te],(a,[e])=>Math.sqrt(e.evaluate(a))],log10:[Te,[Te],(a,[e])=>Math.log(e.evaluate(a))/Math.LN10],ln:[Te,[Te],(a,[e])=>Math.log(e.evaluate(a))],log2:[Te,[Te],(a,[e])=>Math.log(e.evaluate(a))/Math.LN2],sin:[Te,[Te],(a,[e])=>Math.sin(e.evaluate(a))],cos:[Te,[Te],(a,[e])=>Math.cos(e.evaluate(a))],tan:[Te,[Te],(a,[e])=>Math.tan(e.evaluate(a))],asin:[Te,[Te],(a,[e])=>Math.asin(e.evaluate(a))],acos:[Te,[Te],(a,[e])=>Math.acos(e.evaluate(a))],atan:[Te,[Te],(a,[e])=>Math.atan(e.evaluate(a))],min:[Te,zs(Te),(a,e)=>Math.min(...e.map((n=>n.evaluate(a))))],max:[Te,zs(Te),(a,e)=>Math.max(...e.map((n=>n.evaluate(a))))],abs:[Te,[Te],(a,[e])=>Math.abs(e.evaluate(a))],round:[Te,[Te],(a,[e])=>{const n=e.evaluate(a);return n<0?-Math.round(-n):Math.round(n)}],floor:[Te,[Te],(a,[e])=>Math.floor(e.evaluate(a))],ceil:[Te,[Te],(a,[e])=>Math.ceil(e.evaluate(a))],"filter-==":[mt,[ze,gt],(a,[e,n])=>a.properties()[e.value]===n.value],"filter-id-==":[mt,[gt],(a,[e])=>a.id()===e.value],"filter-type-==":[mt,[ze],(a,[e])=>a.geometryType()===e.value],"filter-<":[mt,[ze,gt],(a,[e,n])=>{const h=a.properties()[e.value],m=n.value;return typeof h==typeof m&&h<m}],"filter-id-<":[mt,[gt],(a,[e])=>{const n=a.id(),h=e.value;return typeof n==typeof h&&n<h}],"filter->":[mt,[ze,gt],(a,[e,n])=>{const h=a.properties()[e.value],m=n.value;return typeof h==typeof m&&h>m}],"filter-id->":[mt,[gt],(a,[e])=>{const n=a.id(),h=e.value;return typeof n==typeof h&&n>h}],"filter-<=":[mt,[ze,gt],(a,[e,n])=>{const h=a.properties()[e.value],m=n.value;return typeof h==typeof m&&h<=m}],"filter-id-<=":[mt,[gt],(a,[e])=>{const n=a.id(),h=e.value;return typeof n==typeof h&&n<=h}],"filter->=":[mt,[ze,gt],(a,[e,n])=>{const h=a.properties()[e.value],m=n.value;return typeof h==typeof m&&h>=m}],"filter-id->=":[mt,[gt],(a,[e])=>{const n=a.id(),h=e.value;return typeof n==typeof h&&n>=h}],"filter-has":[mt,[gt],(a,[e])=>e.value in a.properties()],"filter-has-id":[mt,[],a=>a.id()!==null&&a.id()!==void 0],"filter-type-in":[mt,[mn(ze)],(a,[e])=>e.value.indexOf(a.geometryType())>=0],"filter-id-in":[mt,[mn(gt)],(a,[e])=>e.value.indexOf(a.id())>=0],"filter-in-small":[mt,[ze,mn(gt)],(a,[e,n])=>n.value.indexOf(a.properties()[e.value])>=0],"filter-in-large":[mt,[ze,mn(gt)],(a,[e,n])=>(function(h,m,y,v){for(;y<=v;){const E=y+v>>1;if(m[E]===h)return!0;m[E]>h?v=E-1:y=E+1}return!1})(a.properties()[e.value],n.value,0,n.value.length-1)],all:{type:mt,overloads:[[[mt,mt],(a,[e,n])=>e.evaluate(a)&&n.evaluate(a)],[zs(mt),(a,e)=>{for(const n of e)if(!n.evaluate(a))return!1;return!0}]]},any:{type:mt,overloads:[[[mt,mt],(a,[e,n])=>e.evaluate(a)||n.evaluate(a)],[zs(mt),(a,e)=>{for(const n of e)if(n.evaluate(a))return!0;return!1}]]},"!":[mt,[mt],(a,[e])=>!e.evaluate(a)],"is-supported-script":[mt,[ze],(a,[e])=>{const n=a.globals&&a.globals.isSupportedScript;return!n||n(e.evaluate(a))}],upcase:[ze,[ze],(a,[e])=>e.evaluate(a).toUpperCase()],downcase:[ze,[ze],(a,[e])=>e.evaluate(a).toLowerCase()],concat:[ze,zs(gt),(a,e)=>e.map((n=>Si(n.evaluate(a)))).join("")],"resolved-locale":[ze,[ir],(a,[e])=>e.evaluate(a).resolvedLocale()]});class Kr{constructor(e,n,h){this.expression=e,this._warningHistory={},this._evaluator=new Al,this._defaultValue=n?(function(m){if(m.type==="color"&&ph(m.default))return new fn(0,0,0,0);switch(m.type){case"color":return fn.parse(m.default)||null;case"padding":return Ha.parse(m.default)||null;case"numberArray":return wa.parse(m.default)||null;case"colorArray":return Qr.parse(m.default)||null;case"variableAnchorOffsetCollection":return zn.parse(m.default)||null;case"projectionDefinition":return la.parse(m.default)||null;default:return m.default===void 0?null:m.default}})(n):null,this._enumValues=n&&n.type==="enum"?n.values:null,this._globalState=h}evaluateWithoutErrorHandling(e,n,h,m,y,v){return this._globalState&&(e=yr(e,this._globalState)),this._evaluator.globals=e,this._evaluator.feature=n,this._evaluator.featureState=h,this._evaluator.canonical=m,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=v,this.expression.evaluate(this._evaluator)}evaluate(e,n,h,m,y,v){this._globalState&&(e=yr(e,this._globalState)),this._evaluator.globals=e,this._evaluator.feature=n||null,this._evaluator.featureState=h||null,this._evaluator.canonical=m,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=v||null;try{const E=this.expression.evaluate(this._evaluator);if(E==null||typeof E=="number"&&E!=E)return this._defaultValue;if(this._enumValues&&!(E in this._enumValues))throw new Yn(`Expected value to be one of ${Object.keys(this._enumValues).map((k=>JSON.stringify(k))).join(", ")}, but found ${JSON.stringify(E)} instead.`);return E}catch(E){return this._warningHistory[E.message]||(this._warningHistory[E.message]=!0,typeof console<"u"&&console.warn(E.message)),this._defaultValue}}}function un(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in uc}function Jr(a,e,n){const h=new ls(uc,Ei,[],e?(function(y){const v={color:Ut,string:ze,number:Te,enum:ze,boolean:mt,formatted:vr,padding:Sr,numberArray:xr,colorArray:dr,projectionDefinition:It,resolvedImage:Nr,variableAnchorOffsetCollection:Wn};return y.type==="array"?mn(v[y.value]||gt,y.length):v[y.type]})(e):void 0),m=h.parse(a,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return m?Vc(new Kr(m,e,n)):ao(h.errors)}class Or{constructor(e,n,h){this.kind=e,this._styleExpression=n,this.isStateDependent=e!=="constant"&&!hc(n.expression),this.globalStateRefs=Ar(n.expression),this._globalState=h}evaluateWithoutErrorHandling(e,n,h,m,y,v){return this._globalState&&(e=yr(e,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(e,n,h,m,y,v)}evaluate(e,n,h,m,y,v){return this._globalState&&(e=yr(e,this._globalState)),this._styleExpression.evaluate(e,n,h,m,y,v)}}class Lr{constructor(e,n,h,m,y){this.kind=e,this.zoomStops=h,this._styleExpression=n,this.isStateDependent=e!=="camera"&&!hc(n.expression),this.globalStateRefs=Ar(n.expression),this.interpolationType=m,this._globalState=y}evaluateWithoutErrorHandling(e,n,h,m,y,v){return this._globalState&&(e=yr(e,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(e,n,h,m,y,v)}evaluate(e,n,h,m,y,v){return this._globalState&&(e=yr(e,this._globalState)),this._styleExpression.evaluate(e,n,h,m,y,v)}interpolationFactor(e,n,h){return this.interpolationType?Ii.interpolationFactor(this.interpolationType,e,n,h):0}}function Ur(a,e,n){const h=Jr(a,e,n);if(h.result==="error")return h;const m=h.value.expression,y=no(m);if(!y&&!Os(e))return ao([new Ue("","data expressions not supported")]);const v=fc(m,["zoom"]);if(!v&&!dh(e))return ao([new Ue("","zoom expressions not supported")]);const E=Dr(m);return E||v?E instanceof Ue?ao([E]):E instanceof Ii&&!Gc(e)?ao([new Ue("",'"interpolate" expressions cannot be used with this property')]):Vc(E?new Lr(y?"camera":"composite",h.value,E.labels,E instanceof Ii?E.interpolation:void 0,n):new Or(y?"constant":"source",h.value,n)):ao([new Ue("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class mr{constructor(e,n){this._parameters=e,this._specification=n,xe(this,ee(this._parameters,this._specification))}static deserialize(e){return new mr(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function Dr(a){let e=null;if(a instanceof Zn)e=Dr(a.result);else if(a instanceof Yo){for(const n of a.args)if(e=Dr(n),e)break}else(a instanceof Ji||a instanceof Ii)&&a.input instanceof Pi&&a.input.name==="zoom"&&(e=a);return e instanceof Ue||a.eachChild((n=>{const h=Dr(n);h instanceof Ue?e=h:!e&&h?e=new Ue("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&h&&e!==h&&(e=new Ue("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),e}function Ar(a,e=new Set){return a instanceof Ao&&e.add(a.key),a.eachChild((n=>{Ar(n,e)})),e}function yr(a,e){const{zoom:n,heatmapDensity:h,elevation:m,lineProgress:y,isSupportedScript:v,accumulated:E}=a??{};return{zoom:n,heatmapDensity:h,elevation:m,lineProgress:y,isSupportedScript:v,accumulated:E,globalState:e}}function Ir(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const e of a.slice(1))if(!Ir(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}const pn={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function gr(a,e){if(a==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};Ir(a)||(a=Wr(a));const n=Jr(a,pn,e);if(n.result==="error")throw new Error(n.value.map((h=>`${h.key}: ${h.message}`)).join(", "));return{filter:(h,m,y)=>n.value.evaluate(h,m,{},y),needGeometry:yn(a),getGlobalStateRefs:()=>Ar(n.value.expression)}}function Fr(a,e){return a<e?-1:a>e?1:0}function yn(a){if(!Array.isArray(a))return!1;if(a[0]==="within"||a[0]==="distance")return!0;for(let e=1;e<a.length;e++)if(yn(a[e]))return!0;return!1}function Wr(a){if(!a)return!0;const e=a[0];return a.length<=1?e!=="any":e==="=="?ln(a[1],a[2],"=="):e==="!="?$r(ln(a[1],a[2],"==")):e==="<"||e===">"||e==="<="||e===">="?ln(a[1],a[2],e):e==="any"?(n=a.slice(1),["any"].concat(n.map(Wr))):e==="all"?["all"].concat(a.slice(1).map(Wr)):e==="none"?["all"].concat(a.slice(1).map(Wr).map($r)):e==="in"?Vr(a[1],a.slice(2)):e==="!in"?$r(Vr(a[1],a.slice(2))):e==="has"?en(a[1]):e!=="!has"||$r(en(a[1]));var n}function ln(a,e,n){switch(a){case"$type":return[`filter-type-${n}`,e];case"$id":return[`filter-id-${n}`,e];default:return[`filter-${n}`,a,e]}}function Vr(a,e){if(e.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((n=>typeof n!=typeof e[0]))?["filter-in-large",a,["literal",e.sort(Fr)]]:["filter-in-small",a,["literal",e]]}}function en(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function $r(a){return["!",a]}function Yr(a){const e=typeof a;if(e==="number"||e==="boolean"||e==="string"||a==null)return JSON.stringify(a);if(Array.isArray(a)){let m="[";for(const y of a)m+=`${Yr(y)},`;return`${m}]`}const n=Object.keys(a).sort();let h="{";for(let m=0;m<n.length;m++)h+=`${JSON.stringify(n[m])}:${Yr(a[n[m]])},`;return`${h}}`}function Xr(a){let e="";for(const n of Ln)e+=`/${Yr(a[n])}`;return e}function On(a){const e=a.value;return e?[new Xt(a.key,e,"constants have been deprecated as of v8")]:[]}function Cn(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function Wa(a){if(Array.isArray(a))return a.map(Wa);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const e={};for(const n in a)e[n]=Wa(a[n]);return e}return Cn(a)}function $a(a){const e=a.key,n=a.value,h=a.valueSpec||{},m=a.objectElementValidators||{},y=a.style,v=a.styleSpec,E=a.validateSpec;let k=[];const P=dn(n);if(P!=="object")return[new Xt(e,n,`object expected, ${P} found`)];for(const O in n){const G=O.split(".")[0],X=Jl(h,G)||h["*"];let K;if(Jl(m,G))K=m[G];else if(Jl(h,G)){if(n[O]===void 0)continue;K=E}else if(m["*"])K=m["*"];else{if(!h["*"]){k.push(new Xt(e,n[O],`unknown property "${O}"`));continue}K=E}k=k.concat(K({key:(e&&`${e}.`)+O,value:n[O],valueSpec:X,style:y,styleSpec:v,object:n,objectKey:O,validateSpec:E},n))}for(const O in h)m[O]||h[O].required&&h[O].default===void 0&&n[O]===void 0&&k.push(new Xt(e,n,`missing required property "${O}"`));return k}function nl(a){const e=a.value,n=a.valueSpec,h=a.style,m=a.styleSpec,y=a.key,v=a.arrayElementValidator||a.validateSpec;if(dn(e)!=="array")return[new Xt(y,e,`array expected, ${dn(e)} found`)];if(n.length&&e.length!==n.length)return[new Xt(y,e,`array length ${n.length} expected, length ${e.length} found`)];let E={type:n.value,values:n.values};m.$version<7&&(E.function=n.function),dn(n.value)==="object"&&(E=n.value);let k=[];for(let P=0;P<e.length;P++)k=k.concat(v({array:e,arrayIndex:P,value:e[P],valueSpec:E,validateSpec:a.validateSpec,style:h,styleSpec:m,key:`${y}[${P}]`}));return k}function Fi(a){const e=a.key,n=a.value,h=a.valueSpec;let m=dn(n);return m==="number"&&n!=n&&(m="NaN"),m!=="number"?[new Xt(e,n,`number expected, ${m} found`)]:"minimum"in h&&n<h.minimum?[new Xt(e,n,`${n} is less than the minimum value ${h.minimum}`)]:"maximum"in h&&n>h.maximum?[new Xt(e,n,`${n} is greater than the maximum value ${h.maximum}`)]:[]}function Li(a){const e=a.valueSpec,n=Cn(a.value.type);let h,m,y,v={};const E=n!=="categorical"&&a.value.property===void 0,k=!E,P=dn(a.value.stops)==="array"&&dn(a.value.stops[0])==="array"&&dn(a.value.stops[0][0])==="object",O=$a({key:a.key,value:a.value,valueSpec:a.styleSpec.function,validateSpec:a.validateSpec,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(K){if(n==="identity")return[new Xt(K.key,K.value,'identity function may not have a "stops" property')];let ae=[];const oe=K.value;return ae=ae.concat(nl({key:K.key,value:oe,valueSpec:K.valueSpec,validateSpec:K.validateSpec,style:K.style,styleSpec:K.styleSpec,arrayElementValidator:G})),dn(oe)==="array"&&oe.length===0&&ae.push(new Xt(K.key,oe,"array must have at least one stop")),ae},default:function(K){return K.validateSpec({key:K.key,value:K.value,valueSpec:e,validateSpec:K.validateSpec,style:K.style,styleSpec:K.styleSpec})}}});return n==="identity"&&E&&O.push(new Xt(a.key,a.value,'missing required property "property"')),n==="identity"||a.value.stops||O.push(new Xt(a.key,a.value,'missing required property "stops"')),n==="exponential"&&a.valueSpec.expression&&!Gc(a.valueSpec)&&O.push(new Xt(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(k&&!Os(a.valueSpec)?O.push(new Xt(a.key,a.value,"property functions not supported")):E&&!dh(a.valueSpec)&&O.push(new Xt(a.key,a.value,"zoom functions not supported"))),n!=="categorical"&&!P||a.value.property!==void 0||O.push(new Xt(a.key,a.value,'"property" property is required')),O;function G(K){let ae=[];const oe=K.value,he=K.key;if(dn(oe)!=="array")return[new Xt(he,oe,`array expected, ${dn(oe)} found`)];if(oe.length!==2)return[new Xt(he,oe,`array length 2 expected, length ${oe.length} found`)];if(P){if(dn(oe[0])!=="object")return[new Xt(he,oe,`object expected, ${dn(oe[0])} found`)];if(oe[0].zoom===void 0)return[new Xt(he,oe,"object stop key must have zoom")];if(oe[0].value===void 0)return[new Xt(he,oe,"object stop key must have value")];if(y&&y>Cn(oe[0].zoom))return[new Xt(he,oe[0].zoom,"stop zoom values must appear in ascending order")];Cn(oe[0].zoom)!==y&&(y=Cn(oe[0].zoom),m=void 0,v={}),ae=ae.concat($a({key:`${he}[0]`,value:oe[0],valueSpec:{zoom:{}},validateSpec:K.validateSpec,style:K.style,styleSpec:K.styleSpec,objectElementValidators:{zoom:Fi,value:X}}))}else ae=ae.concat(X({key:`${he}[0]`,value:oe[0],validateSpec:K.validateSpec,style:K.style,styleSpec:K.styleSpec},oe));return un(Wa(oe[1]))?ae.concat([new Xt(`${he}[1]`,oe[1],"expressions are not allowed in function stops.")]):ae.concat(K.validateSpec({key:`${he}[1]`,value:oe[1],valueSpec:e,validateSpec:K.validateSpec,style:K.style,styleSpec:K.styleSpec}))}function X(K,ae){const oe=dn(K.value),he=Cn(K.value),be=K.value!==null?K.value:ae;if(h){if(oe!==h)return[new Xt(K.key,be,`${oe} stop domain type must match previous stop domain type ${h}`)]}else h=oe;if(oe!=="number"&&oe!=="string"&&oe!=="boolean")return[new Xt(K.key,be,"stop domain value must be a number, string, or boolean")];if(oe!=="number"&&n!=="categorical"){let Ze=`number expected, ${oe} found`;return Os(e)&&n===void 0&&(Ze+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Xt(K.key,be,Ze)]}return n!=="categorical"||oe!=="number"||isFinite(he)&&Math.floor(he)===he?n!=="categorical"&&oe==="number"&&m!==void 0&&he<m?[new Xt(K.key,be,"stop domain values must appear in ascending order")]:(m=he,n==="categorical"&&he in v?[new Xt(K.key,be,"stop domain values must be unique")]:(v[he]=!0,[])):[new Xt(K.key,be,`integer expected, found ${he}`)]}}function Bs(a){const e=(a.expressionContext==="property"?Ur:Jr)(Wa(a.value),a.valueSpec);if(e.result==="error")return e.value.map((h=>new Xt(`${a.key}${h.key}`,a.value,h.message)));const n=e.value.expression||e.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!n.outputDefined())return[new Xt(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!hc(n))return[new Xt(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter"&&!hc(n))return[new Xt(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!fc(n,["zoom","feature-state"]))return[new Xt(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!no(n))return[new Xt(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function io(a){const e=a.key,n=a.value,h=dn(n);return h!=="string"?[new Xt(e,n,`color expected, ${h} found`)]:fn.parse(String(n))?[]:[new Xt(e,n,`color expected, "${n}" found`)]}function so(a){const e=a.key,n=a.value,h=a.valueSpec,m=[];return Array.isArray(h.values)?h.values.indexOf(Cn(n))===-1&&m.push(new Xt(e,n,`expected one of [${h.values.join(", ")}], ${JSON.stringify(n)} found`)):Object.keys(h.values).indexOf(Cn(n))===-1&&m.push(new Xt(e,n,`expected one of [${Object.keys(h.values).join(", ")}], ${JSON.stringify(n)} found`)),m}function Ba(a){return Ir(Wa(a.value))?Bs(xe({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Ai(a)}function Ai(a){const e=a.value,n=a.key;if(dn(e)!=="array")return[new Xt(n,e,`array expected, ${dn(e)} found`)];const h=a.styleSpec;let m,y=[];if(e.length<1)return[new Xt(n,e,"filter array must have at least 1 element")];switch(y=y.concat(so({key:`${n}[0]`,value:e[0],valueSpec:h.filter_operator,style:a.style,styleSpec:a.styleSpec})),Cn(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&Cn(e[1])==="$type"&&y.push(new Xt(n,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&y.push(new Xt(n,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(m=dn(e[1]),m!=="string"&&y.push(new Xt(`${n}[1]`,e[1],`string expected, ${m} found`)));for(let v=2;v<e.length;v++)m=dn(e[v]),Cn(e[1])==="$type"?y=y.concat(so({key:`${n}[${v}]`,value:e[v],valueSpec:h.geometry_type,style:a.style,styleSpec:a.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&y.push(new Xt(`${n}[${v}]`,e[v],`string, number, or boolean expected, ${m} found`));break;case"any":case"all":case"none":for(let v=1;v<e.length;v++)y=y.concat(Ai({key:`${n}[${v}]`,value:e[v],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":m=dn(e[1]),e.length!==2?y.push(new Xt(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):m!=="string"&&y.push(new Xt(`${n}[1]`,e[1],`string expected, ${m} found`))}return y}function zi(a,e){const n=a.key,h=a.validateSpec,m=a.style,y=a.styleSpec,v=a.value,E=a.objectKey,k=y[`${e}_${a.layerType}`];if(!k)return[];const P=E.match(/^(.*)-transition$/);if(e==="paint"&&P&&k[P[1]]&&k[P[1]].transition)return h({key:n,value:v,valueSpec:y.transition,style:m,styleSpec:y});const O=a.valueSpec||k[E];if(!O)return[new Xt(n,v,`unknown property "${E}"`)];let G;if(dn(v)==="string"&&Os(O)&&!O.tokens&&(G=/^{([^}]+)}$/.exec(v)))return[new Xt(n,v,`"${E}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(G[1])} }\`.`)];const X=[];return a.layerType==="symbol"&&E==="text-font"&&ph(Wa(v))&&Cn(v.type)==="identity"&&X.push(new Xt(n,v,'"text-font" does not support identity functions')),X.concat(h({key:a.key,value:v,valueSpec:O,style:m,styleSpec:y,expressionContext:"property",propertyType:e,propertyKey:E}))}function ui(a){return zi(a,"paint")}function Ol(a){return zi(a,"layout")}function mh(a){let e=[];const n=a.value,h=a.key,m=a.style,y=a.styleSpec;if(dn(n)!=="object")return[new Xt(h,n,`object expected, ${dn(n)} found`)];n.type||n.ref||e.push(new Xt(h,n,'either "type" or "ref" is required'));let v=Cn(n.type);const E=Cn(n.ref);if(n.id){const k=Cn(n.id);for(let P=0;P<a.arrayIndex;P++){const O=m.layers[P];Cn(O.id)===k&&e.push(new Xt(h,n.id,`duplicate layer id "${n.id}", previously used at line ${O.id.__line__}`))}}if("ref"in n){let k;["type","source","source-layer","filter","layout"].forEach((P=>{P in n&&e.push(new Xt(h,n[P],`"${P}" is prohibited for ref layers`))})),m.layers.forEach((P=>{Cn(P.id)===E&&(k=P)})),k?k.ref?e.push(new Xt(h,n.ref,"ref cannot reference another ref layer")):v=Cn(k.type):e.push(new Xt(h,n.ref,`ref layer "${E}" not found`))}else if(v!=="background")if(n.source){const k=m.sources&&m.sources[n.source],P=k&&Cn(k.type);k?P==="vector"&&v==="raster"?e.push(new Xt(h,n.source,`layer "${n.id}" requires a raster source`)):P!=="raster-dem"&&v==="hillshade"||P!=="raster-dem"&&v==="color-relief"?e.push(new Xt(h,n.source,`layer "${n.id}" requires a raster-dem source`)):P==="raster"&&v!=="raster"?e.push(new Xt(h,n.source,`layer "${n.id}" requires a vector source`)):P!=="vector"||n["source-layer"]?P==="raster-dem"&&v!=="hillshade"&&v!=="color-relief"?e.push(new Xt(h,n.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):v!=="line"||!n.paint||!n.paint["line-gradient"]||P==="geojson"&&k.lineMetrics||e.push(new Xt(h,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Xt(h,n,`layer "${n.id}" must specify a "source-layer"`)):e.push(new Xt(h,n.source,`source "${n.source}" not found`))}else e.push(new Xt(h,n,'missing required property "source"'));return e=e.concat($a({key:h,value:n,valueSpec:y.layer,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,objectElementValidators:{"*":()=>[],type:()=>a.validateSpec({key:`${h}.type`,value:n.type,valueSpec:y.layer.type,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,object:n,objectKey:"type"}),filter:Ba,layout:k=>$a({layer:n,key:k.key,value:k.value,style:k.style,styleSpec:k.styleSpec,validateSpec:k.validateSpec,objectElementValidators:{"*":P=>Ol(xe({layerType:v},P))}}),paint:k=>$a({layer:n,key:k.key,value:k.value,style:k.style,styleSpec:k.styleSpec,validateSpec:k.validateSpec,objectElementValidators:{"*":P=>ui(xe({layerType:v},P))}})}})),e}function us(a){const e=a.value,n=a.key,h=dn(e);return h!=="string"?[new Xt(n,e,`string expected, ${h} found`)]:[]}const dc={promoteId:function({key:a,value:e}){if(dn(e)==="string")return us({key:a,value:e});{const n=[];for(const h in e)n.push(...us({key:`${a}.${h}`,value:e[h]}));return n}}};function al(a){const e=a.value,n=a.key,h=a.styleSpec,m=a.style,y=a.validateSpec;if(!e.type)return[new Xt(n,e,'"type" is required')];const v=Cn(e.type);let E;switch(v){case"vector":case"raster":return E=$a({key:n,value:e,valueSpec:h[`source_${v.replace("-","_")}`],style:a.style,styleSpec:h,objectElementValidators:dc,validateSpec:y}),E;case"raster-dem":return E=(function(k){var P;const O=(P=k.sourceName)!==null&&P!==void 0?P:"",G=k.value,X=k.styleSpec,K=X.source_raster_dem,ae=k.style;let oe=[];const he=dn(G);if(G===void 0)return oe;if(he!=="object")return oe.push(new Xt("source_raster_dem",G,`object expected, ${he} found`)),oe;const be=Cn(G.encoding)==="custom",Ze=["redFactor","greenFactor","blueFactor","baseShift"],Se=k.value.encoding?`"${k.value.encoding}"`:"Default";for(const Ce in G)!be&&Ze.includes(Ce)?oe.push(new Xt(Ce,G[Ce],`In "${O}": "${Ce}" is only valid when "encoding" is set to "custom". ${Se} encoding found`)):K[Ce]?oe=oe.concat(k.validateSpec({key:Ce,value:G[Ce],valueSpec:K[Ce],validateSpec:k.validateSpec,style:ae,styleSpec:X})):oe.push(new Xt(Ce,G[Ce],`unknown property "${Ce}"`));return oe})({sourceName:n,value:e,style:a.style,styleSpec:h,validateSpec:y}),E;case"geojson":if(E=$a({key:n,value:e,valueSpec:h.source_geojson,style:m,styleSpec:h,validateSpec:y,objectElementValidators:dc}),e.cluster)for(const k in e.clusterProperties){const[P,O]=e.clusterProperties[k],G=typeof P=="string"?[P,["accumulated"],["get",k]]:P;E.push(...Bs({key:`${n}.${k}.map`,value:O,expressionContext:"cluster-map"})),E.push(...Bs({key:`${n}.${k}.reduce`,value:G,expressionContext:"cluster-reduce"}))}return E;case"video":return $a({key:n,value:e,valueSpec:h.source_video,style:m,validateSpec:y,styleSpec:h});case"image":return $a({key:n,value:e,valueSpec:h.source_image,style:m,validateSpec:y,styleSpec:h});case"canvas":return[new Xt(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return so({key:`${n}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Xa(a){const e=a.value,n=a.styleSpec,h=n.light,m=a.style;let y=[];const v=dn(e);if(e===void 0)return y;if(v!=="object")return y=y.concat([new Xt("light",e,`object expected, ${v} found`)]),y;for(const E in e){const k=E.match(/^(.*)-transition$/);y=y.concat(k&&h[k[1]]&&h[k[1]].transition?a.validateSpec({key:E,value:e[E],valueSpec:n.transition,validateSpec:a.validateSpec,style:m,styleSpec:n}):h[E]?a.validateSpec({key:E,value:e[E],valueSpec:h[E],validateSpec:a.validateSpec,style:m,styleSpec:n}):[new Xt(E,e[E],`unknown property "${E}"`)])}return y}function Eu(a){const e=a.value,n=a.styleSpec,h=n.sky,m=a.style,y=dn(e);if(e===void 0)return[];if(y!=="object")return[new Xt("sky",e,`object expected, ${y} found`)];let v=[];for(const E in e)v=v.concat(h[E]?a.validateSpec({key:E,value:e[E],valueSpec:h[E],style:m,styleSpec:n}):[new Xt(E,e[E],`unknown property "${E}"`)]);return v}function gh(a){const e=a.value,n=a.styleSpec,h=n.terrain,m=a.style;let y=[];const v=dn(e);if(e===void 0)return y;if(v!=="object")return y=y.concat([new Xt("terrain",e,`object expected, ${v} found`)]),y;for(const E in e)y=y.concat(h[E]?a.validateSpec({key:E,value:e[E],valueSpec:h[E],validateSpec:a.validateSpec,style:m,styleSpec:n}):[new Xt(E,e[E],`unknown property "${E}"`)]);return y}function Hc(a){let e=[];const n=a.value,h=a.key;if(Array.isArray(n)){const m=[],y=[];for(const v in n)n[v].id&&m.includes(n[v].id)&&e.push(new Xt(h,n,`all the sprites' ids must be unique, but ${n[v].id} is duplicated`)),m.push(n[v].id),n[v].url&&y.includes(n[v].url)&&e.push(new Xt(h,n,`all the sprites' URLs must be unique, but ${n[v].url} is duplicated`)),y.push(n[v].url),e=e.concat($a({key:`${h}[${v}]`,value:n[v],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:a.validateSpec}));return e}return us({key:h,value:n})}function Yh(a){return!!a&&a.constructor===Object}function Kh(a){return Yh(a.value)?[]:[new Xt(a.key,a.value,`object expected, ${dn(a.value)} found`)]}const Na={"*":()=>[],array:nl,boolean:function(a){const e=a.value,n=a.key,h=dn(e);return h!=="boolean"?[new Xt(n,e,`boolean expected, ${h} found`)]:[]},number:Fi,color:io,constants:On,enum:so,filter:Ba,function:Li,layer:mh,object:$a,source:al,light:Xa,sky:Eu,terrain:gh,projection:function(a){const e=a.value,n=a.styleSpec,h=n.projection,m=a.style,y=dn(e);if(e===void 0)return[];if(y!=="object")return[new Xt("projection",e,`object expected, ${y} found`)];let v=[];for(const E in e)v=v.concat(h[E]?a.validateSpec({key:E,value:e[E],valueSpec:h[E],style:m,styleSpec:n}):[new Xt(E,e[E],`unknown property "${E}"`)]);return v},projectionDefinition:function(a){const e=a.key;let n=a.value;n=n instanceof String?n.valueOf():n;const h=dn(n);return h!=="array"||(function(m){return Array.isArray(m)&&m.length===3&&typeof m[0]=="string"&&typeof m[1]=="string"&&typeof m[2]=="number"})(n)||(function(m){return!!["interpolate","step","literal"].includes(m[0])})(n)?["array","string"].includes(h)?[]:[new Xt(e,n,`projection expected, invalid type "${h}" found`)]:[new Xt(e,n,`projection expected, invalid array ${JSON.stringify(n)} found`)]},string:us,formatted:function(a){return us(a).length===0?[]:Bs(a)},resolvedImage:function(a){return us(a).length===0?[]:Bs(a)},padding:function(a){const e=a.key,n=a.value;if(dn(n)==="array"){if(n.length<1||n.length>4)return[new Xt(e,n,`padding requires 1 to 4 values; ${n.length} values found`)];const h={type:"number"};let m=[];for(let y=0;y<n.length;y++)m=m.concat(a.validateSpec({key:`${e}[${y}]`,value:n[y],validateSpec:a.validateSpec,valueSpec:h}));return m}return Fi({key:e,value:n,valueSpec:{}})},numberArray:function(a){const e=a.key,n=a.value;if(dn(n)==="array"){const h={type:"number"};if(n.length<1)return[new Xt(e,n,"array length at least 1 expected, length 0 found")];let m=[];for(let y=0;y<n.length;y++)m=m.concat(a.validateSpec({key:`${e}[${y}]`,value:n[y],validateSpec:a.validateSpec,valueSpec:h}));return m}return Fi({key:e,value:n,valueSpec:{}})},colorArray:function(a){const e=a.key,n=a.value;if(dn(n)==="array"){if(n.length<1)return[new Xt(e,n,"array length at least 1 expected, length 0 found")];let h=[];for(let m=0;m<n.length;m++)h=h.concat(io({key:`${e}[${m}]`,value:n[m]}));return h}return io({key:e,value:n})},variableAnchorOffsetCollection:function(a){const e=a.key,n=a.value,h=dn(n),m=a.styleSpec;if(h!=="array"||n.length<1||n.length%2!=0)return[new Xt(e,n,"variableAnchorOffsetCollection requires a non-empty array of even length")];let y=[];for(let v=0;v<n.length;v+=2)y=y.concat(so({key:`${e}[${v}]`,value:n[v],valueSpec:m.layout_symbol["text-anchor"]})),y=y.concat(nl({key:`${e}[${v+1}]`,value:n[v+1],valueSpec:{length:2,value:"number"},validateSpec:a.validateSpec,style:a.style,styleSpec:m}));return y},sprite:Hc,state:Kh,fontFaces:function(a){const e=a.key,n=a.value,h=a.validateSpec,m=a.styleSpec,y=a.style;if(!Yh(n))return[new Xt(e,n,`object expected, ${dn(n)} found`)];const v=[];for(const E in n){const k=n[E],P=dn(k);if(P==="string")v.push(...us({key:`${e}.${E}`,value:k}));else if(P==="array"){const O={url:{type:"string",required:!0},"unicode-range":{type:"array",value:"string"}};for(const[G,X]of k.entries())v.push(...$a({key:`${e}.${E}[${G}]`,value:X,valueSpec:O,styleSpec:m,style:y,validateSpec:h}))}else v.push(new Xt(`${e}.${E}`,k,`string or array expected, ${P} found`))}return v}};function Ns(a){const e=a.value,n=a.valueSpec,h=a.styleSpec;return a.validateSpec=Ns,n.expression&&ph(Cn(e))?Li(a):n.expression&&un(Wa(e))?Bs(a):n.type&&Na[n.type]?Na[n.type](a):$a(xe({},a,{valueSpec:n.type?h[n.type]:n}))}function pc(a){const e=a.value,n=a.key,h=us(a);return h.length||(e.indexOf("{fontstack}")===-1&&h.push(new Xt(n,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&h.push(new Xt(n,e,'"glyphs" url must include a "{range}" token'))),h}function Oi(a,e=xt){let n=[];return n=n.concat(Ns({key:"",value:a,valueSpec:e.$root,styleSpec:e,style:a,validateSpec:Ns,objectElementValidators:{glyphs:pc,"*":()=>[]}})),a.constants&&(n=n.concat(On({key:"constants",value:a.constants}))),Bl(n)}function Ss(a){return function(e){return a(Object.assign({},e,{validateSpec:Ns}))}}function Bl(a){return[].concat(a).sort(((e,n)=>e.line-n.line))}function ki(a){return function(...e){return Bl(a.apply(this,e))}}Oi.source=ki(Ss(al)),Oi.sprite=ki(Ss(Hc)),Oi.glyphs=ki(Ss(pc)),Oi.light=ki(Ss(Xa)),Oi.sky=ki(Ss(Eu)),Oi.terrain=ki(Ss(gh)),Oi.state=ki(Ss(Kh)),Oi.layer=ki(Ss(mh)),Oi.filter=ki(Ss(Ba)),Oi.paintProperty=ki(Ss(ui)),Oi.layoutProperty=ki(Ss(Ol));const Ff={type:"enum","property-type":"data-constant",expression:{interpolated:!1,parameters:["global-state"]},values:{visible:{},none:{}},transition:!1,default:"visible"};class qc{constructor(e,n){this._globalState=n,this.setValue(e)}evaluate(){var e;return(e=this._literalValue)!==null&&e!==void 0?e:this._compiledValue.evaluate({})}setValue(e){if(e==null||e==="visible"||e==="none")return this._literalValue=e==="none"?"none":"visible",this._compiledValue=void 0,void(this._globalStateRefs=new Set);const n=Jr(e,Ff,this._globalState);if(n.result==="error")throw this._literalValue="visible",this._compiledValue=void 0,new Error(n.value.map((h=>`${h.key}: ${h.message}`)).join(", "));this._literalValue=void 0,this._compiledValue=n.value,this._globalStateRefs=Ar(n.value.expression)}getGlobalStateRefs(){return this._globalStateRefs}}const Au=xt,Ci=Oi,il=Ci.light,Lf=Ci.sky,zf=Ci.paintProperty,Fp=Ci.layoutProperty;function sl(a,e){let n=!1;if(e&&e.length)for(const h of e)a.fire(new xn(new Error(h.message))),n=!0;return n}class Zc{constructor(e,n,h){const m=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const v=new Int32Array(this.arrayBuffer);e=v[0],this.d=(n=v[1])+2*(h=v[2]);for(let k=0;k<this.d*this.d;k++){const P=v[3+k],O=v[3+k+1];m.push(P===O?null:v.subarray(P,O))}const E=v[3+m.length+1];this.keys=v.subarray(v[3+m.length],E),this.bboxes=v.subarray(E),this.insert=this._insertReadonly}else{this.d=n+2*h;for(let v=0;v<this.d*this.d;v++)m.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=e,this.padding=h,this.scale=n/e,this.uid=0;const y=h/n*e;this.min=-y,this.max=e+y}insert(e,n,h,m,y){this._forEachCell(n,h,m,y,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(n),this.bboxes.push(h),this.bboxes.push(m),this.bboxes.push(y)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,n,h,m,y,v){this.cells[y].push(v)}query(e,n,h,m,y){const v=this.min,E=this.max;if(e<=v&&n<=v&&E<=h&&E<=m&&!y)return Array.prototype.slice.call(this.keys);{const k=[];return this._forEachCell(e,n,h,m,this._queryCell,k,{},y),k}}_queryCell(e,n,h,m,y,v,E,k){const P=this.cells[y];if(P!==null){const O=this.keys,G=this.bboxes;for(let X=0;X<P.length;X++){const K=P[X];if(E[K]===void 0){const ae=4*K;(k?k(G[ae+0],G[ae+1],G[ae+2],G[ae+3]):e<=G[ae+2]&&n<=G[ae+3]&&h>=G[ae+0]&&m>=G[ae+1])?(E[K]=!0,v.push(O[K])):E[K]=!1}}}}_forEachCell(e,n,h,m,y,v,E,k){const P=this._convertToCellCoord(e),O=this._convertToCellCoord(n),G=this._convertToCellCoord(h),X=this._convertToCellCoord(m);for(let K=P;K<=G;K++)for(let ae=O;ae<=X;ae++){const oe=this.d*ae+K;if((!k||k(this._convertFromCellCoord(K),this._convertFromCellCoord(ae),this._convertFromCellCoord(K+1),this._convertFromCellCoord(ae+1)))&&y.call(this,e,n,h,m,oe,v,E,k))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,n=3+this.cells.length+1+1;let h=0;for(let v=0;v<this.cells.length;v++)h+=this.cells[v].length;const m=new Int32Array(n+h+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;let y=n;for(let v=0;v<e.length;v++){const E=e[v];m[3+v]=y,m.set(E,y),y+=E.length}return m[3+e.length]=y,m.set(this.keys,y),y+=this.keys.length,m[3+e.length+1]=y,m.set(this.bboxes,y),y+=this.bboxes.length,m.buffer}static serialize(e,n){const h=e.toArrayBuffer();return n&&n.push(h),{buffer:h}}static deserialize(e){return new Zc(e.buffer)}}const js={};function kr(a,e,n={}){if(js[a])throw new Error(`${a} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:a,writeable:!1}),js[a]={klass:e,omit:n.omit||[],shallow:n.shallow||[]}}kr("Object",Object),kr("Set",Set),kr("TransferableGridIndex",Zc),kr("Color",fn),kr("Error",Error),kr("AJAXError",at),kr("ResolvedImage",Oa),kr("StylePropertyFunction",mr),kr("StyleExpression",Kr,{omit:["_evaluator"]}),kr("ZoomDependentExpression",Lr),kr("ZoomConstantExpression",Or),kr("CompoundExpression",Pi,{omit:["_evaluate"]});for(const a in uc)uc[a]._classRegistryKey||kr(`Expression_${a}`,uc[a]);function Jh(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function Of(a){return a.$name||a.constructor._classRegistryKey}function ko(a){return!(function(e){if(e===null||typeof e!="object")return!1;const n=Of(e);return!(!n||n==="Object")})(a)&&(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob||a instanceof Error||Jh(a)||Ne(a)||ArrayBuffer.isView(a)||a instanceof ImageData)}function ol(a,e){if(ko(a))return(Jh(a)||Ne(a))&&e&&e.push(a),ArrayBuffer.isView(a)&&e&&e.push(a.buffer),a instanceof ImageData&&e&&e.push(a.data.buffer),a;if(Array.isArray(a)){const y=[];for(const v of a)y.push(ol(v,e));return y}if(typeof a!="object")throw new Error("can't serialize object of type "+typeof a);const n=Of(a);if(!n)throw new Error(`can't serialize object of unregistered class ${a.constructor.name}`);if(!js[n])throw new Error(`${n} is not registered.`);const{klass:h}=js[n],m=h.serialize?h.serialize(a,e):{};if(h.serialize){if(e&&m===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const y in a){if(!a.hasOwnProperty(y)||js[n].omit.indexOf(y)>=0)continue;const v=a[y];m[y]=js[n].shallow.indexOf(y)>=0?v:ol(v,e)}a instanceof Error&&(m.message=a.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return n!=="Object"&&(m.$name=n),m}function _h(a){if(ko(a))return a;if(Array.isArray(a))return a.map(_h);if(typeof a!="object")throw new Error("can't deserialize object of type "+typeof a);const e=Of(a)||"Object";if(!js[e])throw new Error(`can't deserialize unregistered class ${e}`);const{klass:n}=js[e];if(!n)throw new Error(`can't deserialize unregistered class ${e}`);if(n.deserialize)return n.deserialize(a);const h=Object.create(n.prototype);for(const m of Object.keys(a)){if(m==="$name")continue;const y=a[m];h[m]=js[e].shallow.indexOf(m)>=0?y:_h(y)}return h}class Bf{constructor(){this.first=!0}update(e,n){const h=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=h,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=h,!0):(this.lastFloorZoom>h?(this.lastIntegerZoom=h+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<h&&(this.lastIntegerZoom=h,this.lastIntegerZoomTime=n),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=h,!0))}}function Nl(a){return/[\u02EA\u02EB\u2E80-\u2FDF\u2FF0-\u303F\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FD-\u30FF\u3105-\u312F\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(a))}function ku(a){return/[\u02EA\u02EB\u1100-\u11FF\u1400-\u167F\u18B0-\u18F5\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u3007\u3012\u3013\u3020-\u302F\u3031-\u303F\u3041-\u3096\u309D-\u30FB\u30FD-\u30FF\u3105-\u312F\u3131-\u318E\u3190-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE48\uFE50-\uFE57\uFE5F-\uFE62\uFE67-\uFE6F\uFF00-\uFF07\uFF0A-\uFF0C\uFF0E-\uFF19\uFF1F-\uFF3A\uFF3C\uFF3E\uFF40-\uFF5A\uFFE0-\uFFE2\uFFE4-\uFFE7]|\uD802[\uDD80-\uDD9F]|\uD805[\uDD80-\uDDFF]|\uD806[\uDE00-\uDEBF]|\uD811[\uDC00-\uDE7F]|\uD81B[\uDFE0-\uDFE4\uDFF0-\uDFF6]|[\uD81C-\uD822\uD83D\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD30-\uDEFB]|\uD833[\uDEC0-\uDFCF]|\uD834[\uDC00-\uDDFF\uDEE0-\uDF7F]|\uD836[\uDC00-\uDEAF]|\uD83C[\uDC00-\uDE00\uDF00-\uDFFF]|\uD83E[\uDD00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(a))}function Qh(a){return/\s/u.test(String.fromCodePoint(a))}function jl(a){for(const e of a)if(ku(e.codePointAt(0)))return!0;return!1}function Nf(a){for(const e of a)if(!Ad(e.codePointAt(0)))return!1;return!0}function ef(a){const e=a.map((n=>{try{return new RegExp(`\\p{sc=${n}}`,"u").source}catch{return null}})).filter((n=>n));return new RegExp(e.join("|"),"u")}const Ul=ef(["Arab","Dupl","Mong","Ougr","Syrc"]);function Ad(a){return!Ul.test(String.fromCodePoint(a))}function Vl(a){return!(ku(a)||(e=a,/[\xA7\xA9\xAE\xB1\xBC-\xBE\xD7\xF7\u2016\u2020\u2021\u2030\u2031\u203B\u203C\u2042\u2047-\u2049\u2051\u2100-\u218F\u221E\u2234\u2235\u2300-\u2307\u230C-\u231F\u2324-\u2328\u232B\u237D-\u239A\u23BE-\u23CD\u23CF\u23D1-\u23DB\u23E2-\u2422\u2424-\u24FF\u25A0-\u2619\u2620-\u2767\u2776-\u2793\u2B12-\u2B2F\u2B50-\u2B59\u2BB8-\u2BEB\u3000-\u303F\u30A0-\u30FF\uE000-\uF8FF\uFE30-\uFE6F\uFF00-\uFFEF\uFFFC\uFFFD]|[\uDB80-\uDBFF][\uDC00-\uDFFF]/gim.test(String.fromCodePoint(e))));var e}const jf=ef(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function tf(a){return jf.test(String.fromCodePoint(a))}function Gl(a,e){return!(!e&&tf(a)||/[\u0900-\u0DFF\u0F00-\u109F\u1780-\u17FF]/gim.test(String.fromCodePoint(a)))}function mc(a){for(const e of a)if(tf(e.codePointAt(0)))return!0;return!1}const Co=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(a){this.pluginStatus=a.pluginStatus,this.pluginURL=a.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(a){if(Co.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=a.applyArabicShaping,this.processBidirectionalText=a.processBidirectionalText,this.processStyledBidirectionalText=a.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(a,e){return s(this,void 0,void 0,(function*(){if(this.isParsed())return this.getState();if(a.pluginStatus!=="loading")return this.setState(a),a;const n=a.pluginURL,h=new Promise((y=>{this.loadScriptResolve=y}));e(n);const m=new Promise((y=>setTimeout((()=>y()),this.TIMEOUT)));if(yield Promise.race([h,m]),this.isParsed()){const y={pluginStatus:"loaded",pluginURL:n};return this.setState(y),y}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${n}`)}))}};class Jn{constructor(e,n){this.isSupportedScript=kd,this.zoom=e,n?(this.now=n.now||0,this.fadeDuration=n.fadeDuration||0,this.zoomHistory=n.zoomHistory||new Bf,this.transition=n.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Bf,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,n=e-Math.floor(e),h=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*h}:{fromScale:.5,toScale:1,t:1-(1-h)*n}}}function kd(a){return(function(e,n){for(const h of e)if(!Gl(h.codePointAt(0),n))return!1;return!0})(a,Co.getRTLTextPluginStatus()==="loaded")}const gc="-transition";class Wc{constructor(e,n,h){this.property=e,this.value=n,this.expression=(function(m,y,v){if(ph(m))return new mr(m,y);if(un(m)){const E=Ur(m,y,v);if(E.result==="error")throw new Error(E.value.map((k=>`${k.key}: ${k.message}`)).join(", "));return E.value}{let E=m;return y.type==="color"&&typeof m=="string"?E=fn.parse(m):y.type!=="padding"||typeof m!="number"&&!Array.isArray(m)?y.type!=="numberArray"||typeof m!="number"&&!Array.isArray(m)?y.type!=="colorArray"||typeof m!="string"&&!Array.isArray(m)?y.type==="variableAnchorOffsetCollection"&&Array.isArray(m)?E=zn.parse(m):y.type==="projectionDefinition"&&typeof m=="string"&&(E=la.parse(m)):E=Qr.parse(m):E=wa.parse(m):E=Ha.parse(m),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>E}}})(n===void 0?e.specification.default:n,e.specification,h)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(e,n,h){return this.property.possiblyEvaluate(this,e,n,h)}}class rf{constructor(e,n){this.property=e,this.value=new Wc(e,void 0,n)}transitioned(e,n){return new Cu(this.property,this.value,n,Zt({},e.transition,this.transition),e.now)}untransitioned(){return new Cu(this.property,this.value,null,{},0)}}class Uf{constructor(e,n){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues),this._globalState=n}getValue(e){return Qe(this._values[e].value.value)}setValue(e,n){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new rf(this._values[e].property,this._globalState)),this._values[e].value=new Wc(this._values[e].property,n===null?void 0:Qe(n),this._globalState)}getTransition(e){return Qe(this._values[e].transition)}setTransition(e,n){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new rf(this._values[e].property,this._globalState)),this._values[e].transition=Qe(n)||void 0}serialize(){const e={};for(const n of Object.keys(this._values)){const h=this.getValue(n);h!==void 0&&(e[n]=h);const m=this.getTransition(n);m!==void 0&&(e[`${n}${gc}`]=m)}return e}transitioned(e,n){const h=new nf(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].transitioned(e,n._values[m]);return h}untransitioned(){const e=new nf(this._properties);for(const n of Object.keys(this._values))e._values[n]=this._values[n].untransitioned();return e}}class Cu{constructor(e,n,h,m,y){this.property=e,this.value=n,this.begin=y+m.delay||0,this.end=this.begin+m.duration||0,e.specification.transition&&(m.delay||m.duration)&&(this.prior=h)}possiblyEvaluate(e,n,h){const m=e.now||0,y=this.value.possiblyEvaluate(e,n,h),v=this.prior;if(v){if(m>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(m<this.begin)return v.possiblyEvaluate(e,n,h);{const E=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(e,n,h),y,Ve(E))}}return y}}class nf{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,n,h){const m=new Mu(this._properties);for(const y of Object.keys(this._values))m._values[y]=this._values[y].possiblyEvaluate(e,n,h);return m}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Cd{constructor(e,n){this._properties=e,this._values=Object.create(e.defaultPropertyValues),this._globalState=n}hasValue(e){return this._values[e].value!==void 0}getValue(e){return Qe(this._values[e].value)}setValue(e,n){this._values[e]=new Wc(this._values[e].property,n===null?void 0:Qe(n),this._globalState)}serialize(){const e={};for(const n of Object.keys(this._values)){const h=this.getValue(n);h!==void 0&&(e[n]=h)}return e}possiblyEvaluate(e,n,h){const m=new Mu(this._properties);for(const y of Object.keys(this._values))m._values[y]=this._values[y].possiblyEvaluate(e,n,h);return m}}class oo{constructor(e,n,h){this.property=e,this.value=n,this.parameters=h}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,n,h,m){return this.property.evaluate(this.value,this.parameters,e,n,h,m)}}class Mu{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Rr{constructor(e){this.specification=e}possiblyEvaluate(e,n){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(n)}interpolate(e,n,h){const m=ca[this.specification.type];return m?m(e,n,h):e}}class Br{constructor(e,n){this.specification=e,this.overrides=n}possiblyEvaluate(e,n,h,m){return new oo(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(n,null,{},h,m)}:e.expression,n)}interpolate(e,n,h){if(e.value.kind!=="constant"||n.value.kind!=="constant")return e;if(e.value.value===void 0||n.value.value===void 0)return new oo(this,{kind:"constant",value:void 0},e.parameters);const m=ca[this.specification.type];if(m){const y=m(e.value.value,n.value.value,h);return new oo(this,{kind:"constant",value:y},e.parameters)}return e}evaluate(e,n,h,m,y,v){return e.kind==="constant"?e.value:e.evaluate(n,h,m,y,v)}}class Mo extends Br{possiblyEvaluate(e,n,h,m){if(e.value===void 0)return new oo(this,{kind:"constant",value:void 0},n);if(e.expression.kind==="constant"){const y=e.expression.evaluate(n,null,{},h,m),v=e.property.specification.type==="resolvedImage"&&typeof y!="string"?y.name:y,E=this._calculate(v,v,v,n);return new oo(this,{kind:"constant",value:E},n)}if(e.expression.kind==="camera"){const y=this._calculate(e.expression.evaluate({zoom:n.zoom-1}),e.expression.evaluate({zoom:n.zoom}),e.expression.evaluate({zoom:n.zoom+1}),n);return new oo(this,{kind:"constant",value:y},n)}return new oo(this,e.expression,n)}evaluate(e,n,h,m,y,v){if(e.kind==="source"){const E=e.evaluate(n,h,m,y,v);return this._calculate(E,E,E,n)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(n.zoom)-1},h,m),e.evaluate({zoom:Math.floor(n.zoom)},h,m),e.evaluate({zoom:Math.floor(n.zoom)+1},h,m),n):e.value}_calculate(e,n,h,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:e,to:n}:{from:h,to:n}}interpolate(e){return e}}class xh{constructor(e){this.specification=e}possiblyEvaluate(e,n,h,m){if(e.value!==void 0){if(e.expression.kind==="constant"){const y=e.expression.evaluate(n,null,{},h,m);return this._calculate(y,y,y,n)}return this._calculate(e.expression.evaluate(new Jn(Math.floor(n.zoom-1),n)),e.expression.evaluate(new Jn(Math.floor(n.zoom),n)),e.expression.evaluate(new Jn(Math.floor(n.zoom+1),n)),n)}}_calculate(e,n,h,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:e,to:n}:{from:h,to:n}}interpolate(e){return e}}class af{constructor(e){this.specification=e}possiblyEvaluate(e,n,h,m){return!!e.expression.evaluate(n,null,{},h,m)}interpolate(){return!1}}class ni{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const n in e){const h=e[n];h.specification.overridable&&this.overridableProperties.push(n);const m=this.defaultPropertyValues[n]=new Wc(h,void 0,void 0),y=this.defaultTransitionablePropertyValues[n]=new rf(h,void 0);this.defaultTransitioningPropertyValues[n]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=m.possiblyEvaluate({})}}}kr("DataDrivenProperty",Br),kr("DataConstantProperty",Rr),kr("CrossFadedDataDrivenProperty",Mo),kr("CrossFadedProperty",xh),kr("ColorRampProperty",af);class ja extends an{constructor(e,n,h){if(super(),this.id=e.id,this.type=e.type,this._globalState=h,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,this._visibilityExpression=(function(m,y){return new qc(m,y)})(this.visibility,h),e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter,this._featureFilter=gr(e.filter,h)),n.layout&&(this._unevaluatedLayout=new Cd(n.layout,h)),n.paint)){this._transitionablePaint=new Uf(n.paint,h);for(const m in e.paint)this.setPaintProperty(m,e.paint[m],{validate:!1});for(const m in e.layout)this.setLayoutProperty(m,e.layout[m],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Mu(n.paint)}}setFilter(e){this.filter=e,this._featureFilter=gr(e,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}getLayoutAffectingGlobalStateRefs(){const e=new Set;for(const n of this._visibilityExpression.getGlobalStateRefs())e.add(n);if(this._unevaluatedLayout)for(const n in this._unevaluatedLayout._values){const h=this._unevaluatedLayout._values[n];for(const m of h.getGlobalStateRefs())e.add(m)}for(const n of this._featureFilter.getGlobalStateRefs())e.add(n);return e}getPaintAffectingGlobalStateRefs(){var e;const n=new globalThis.Map;if(this._transitionablePaint)for(const h in this._transitionablePaint._values){const m=this._transitionablePaint._values[h].value;for(const y of m.getGlobalStateRefs()){const v=(e=n.get(y))!==null&&e!==void 0?e:[];v.push({name:h,value:m.value}),n.set(y,v)}}return n}getVisibilityAffectingGlobalStateRefs(){return this._visibilityExpression.getGlobalStateRefs()}setLayoutProperty(e,n,h={}){if(n==null||!this._validate(Fp,`layers.${this.id}.layout.${e}`,e,n,h))return e==="visibility"?(this.visibility=n,this._visibilityExpression.setValue(n),void this.recalculateVisibility()):void this._unevaluatedLayout.setValue(e,n)}getPaintProperty(e){return e.endsWith(gc)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,n,h={}){if(n!=null&&this._validate(zf,`layers.${this.id}.paint.${e}`,e,n,h))return!1;if(e.endsWith(gc))return this._transitionablePaint.setTransition(e.slice(0,-11),n||void 0),!1;{const m=this._transitionablePaint._values[e],y=m.property.specification["property-type"]==="cross-faded-data-driven",v=m.value.isDataDriven(),E=m.value;this._transitionablePaint.setValue(e,n),this._handleSpecialPaintPropertyUpdate(e);const k=this._transitionablePaint._values[e].value;return k.isDataDriven()||v||y||this._handleOverridablePaintPropertyUpdate(e,E,k)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,n,h){return!1}isHidden(e=this.minzoom,n=!1){return!!(this.minzoom&&e<(n?Math.floor(this.minzoom):this.minzoom))||!!(this.maxzoom&&e>=this.maxzoom)||this._evaluatedVisibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculateVisibility(){this._evaluatedVisibility=this._visibilityExpression.evaluate()}recalculate(e,n){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,n)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),jr(e,((n,h)=>!(n===void 0||h==="layout"&&!Object.keys(n).length||h==="paint"&&!Object.keys(n).length)))}_validate(e,n,h,m,y={}){return(!y||y.validate!==!1)&&sl(this,e.call(Ci,{key:n,layerType:this.type,objectKey:h,value:m,styleSpec:xt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const n=this.paint.get(e);if(n instanceof oo&&Os(n.property.specification)&&(n.value.kind==="source"||n.value.kind==="composite")&&n.value.isStateDependent)return!0}return!1}}let Ya;var sf={get paint(){return Ya=Ya||new ni({"raster-opacity":new Rr(xt.paint_raster["raster-opacity"]),"raster-hue-rotate":new Rr(xt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Rr(xt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Rr(xt.paint_raster["raster-brightness-max"]),"raster-saturation":new Rr(xt.paint_raster["raster-saturation"]),"raster-contrast":new Rr(xt.paint_raster["raster-contrast"]),"raster-resampling":new Rr(xt.paint_raster["raster-resampling"]),"raster-fade-duration":new Rr(xt.paint_raster["raster-fade-duration"])})}};class _c extends ja{constructor(e,n){super(e,sf,n)}}const Tn={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class $n{constructor(e,n){this._structArray=e,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class wn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,n){return e._trim(),n&&(e.isTransferred=!0,n.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const n=Object.create(this.prototype);return n.arrayBuffer=e.arrayBuffer,n.length=e.length,n.capacity=e.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Ia(a,e=1){let n=0,h=0;return{members:a.map((m=>{const y=Tn[m.type].BYTES_PER_ELEMENT,v=n=Do(n,Math.max(e,y)),E=m.components||1;return h=Math.max(h,y),n+=y*E,{name:m.name,type:m.type,components:E,offset:v}})),size:Do(n,Math.max(h,e)),alignment:e}}function Do(a,e){return Math.ceil(a/e)*e}class ll extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n){const h=this.length;return this.resize(h+1),this.emplace(h,e,n)}emplace(e,n,h){const m=2*e;return this.int16[m+0]=n,this.int16[m+1]=h,e}}ll.prototype.bytesPerElement=4,kr("StructArrayLayout2i4",ll);class Du extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,n,h)}emplace(e,n,h,m){const y=3*e;return this.int16[y+0]=n,this.int16[y+1]=h,this.int16[y+2]=m,e}}Du.prototype.bytesPerElement=6,kr("StructArrayLayout3i6",Du);class Ru extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,h,m){const y=this.length;return this.resize(y+1),this.emplace(y,e,n,h,m)}emplace(e,n,h,m,y){const v=4*e;return this.int16[v+0]=n,this.int16[v+1]=h,this.int16[v+2]=m,this.int16[v+3]=y,e}}Ru.prototype.bytesPerElement=8,kr("StructArrayLayout4i8",Ru);class xc extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,h,m,y,v){const E=this.length;return this.resize(E+1),this.emplace(E,e,n,h,m,y,v)}emplace(e,n,h,m,y,v,E){const k=6*e;return this.int16[k+0]=n,this.int16[k+1]=h,this.int16[k+2]=m,this.int16[k+3]=y,this.int16[k+4]=v,this.int16[k+5]=E,e}}xc.prototype.bytesPerElement=12,kr("StructArrayLayout2i4i12",xc);class Md extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,h,m,y,v){const E=this.length;return this.resize(E+1),this.emplace(E,e,n,h,m,y,v)}emplace(e,n,h,m,y,v,E){const k=4*e,P=8*e;return this.int16[k+0]=n,this.int16[k+1]=h,this.uint8[P+4]=m,this.uint8[P+5]=y,this.uint8[P+6]=v,this.uint8[P+7]=E,e}}Md.prototype.bytesPerElement=8,kr("StructArrayLayout2i4ub8",Md);class ka extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n){const h=this.length;return this.resize(h+1),this.emplace(h,e,n)}emplace(e,n,h){const m=2*e;return this.float32[m+0]=n,this.float32[m+1]=h,e}}ka.prototype.bytesPerElement=8,kr("StructArrayLayout2f8",ka);class cl extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,h,m,y,v,E,k,P,O){const G=this.length;return this.resize(G+1),this.emplace(G,e,n,h,m,y,v,E,k,P,O)}emplace(e,n,h,m,y,v,E,k,P,O,G){const X=10*e;return this.uint16[X+0]=n,this.uint16[X+1]=h,this.uint16[X+2]=m,this.uint16[X+3]=y,this.uint16[X+4]=v,this.uint16[X+5]=E,this.uint16[X+6]=k,this.uint16[X+7]=P,this.uint16[X+8]=O,this.uint16[X+9]=G,e}}cl.prototype.bytesPerElement=20,kr("StructArrayLayout10ui20",cl);class yh extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,h,m,y,v,E,k){const P=this.length;return this.resize(P+1),this.emplace(P,e,n,h,m,y,v,E,k)}emplace(e,n,h,m,y,v,E,k,P){const O=8*e;return this.uint16[O+0]=n,this.uint16[O+1]=h,this.uint16[O+2]=m,this.uint16[O+3]=y,this.uint16[O+4]=v,this.uint16[O+5]=E,this.uint16[O+6]=k,this.uint16[O+7]=P,e}}yh.prototype.bytesPerElement=16,kr("StructArrayLayout8ui16",yh);class vh extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,h,m,y,v,E,k,P,O,G,X){const K=this.length;return this.resize(K+1),this.emplace(K,e,n,h,m,y,v,E,k,P,O,G,X)}emplace(e,n,h,m,y,v,E,k,P,O,G,X,K){const ae=12*e;return this.int16[ae+0]=n,this.int16[ae+1]=h,this.int16[ae+2]=m,this.int16[ae+3]=y,this.uint16[ae+4]=v,this.uint16[ae+5]=E,this.uint16[ae+6]=k,this.uint16[ae+7]=P,this.int16[ae+8]=O,this.int16[ae+9]=G,this.int16[ae+10]=X,this.int16[ae+11]=K,e}}vh.prototype.bytesPerElement=24,kr("StructArrayLayout4i4ui4i24",vh);class of extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,n,h)}emplace(e,n,h,m){const y=3*e;return this.float32[y+0]=n,this.float32[y+1]=h,this.float32[y+2]=m,e}}of.prototype.bytesPerElement=12,kr("StructArrayLayout3f12",of);class lf extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint32[1*e+0]=n,e}}lf.prototype.bytesPerElement=4,kr("StructArrayLayout1ul4",lf);class cf extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,h,m,y,v,E,k,P){const O=this.length;return this.resize(O+1),this.emplace(O,e,n,h,m,y,v,E,k,P)}emplace(e,n,h,m,y,v,E,k,P,O){const G=10*e,X=5*e;return this.int16[G+0]=n,this.int16[G+1]=h,this.int16[G+2]=m,this.int16[G+3]=y,this.int16[G+4]=v,this.int16[G+5]=E,this.uint32[X+3]=k,this.uint16[G+8]=P,this.uint16[G+9]=O,e}}cf.prototype.bytesPerElement=20,kr("StructArrayLayout6i1ul2ui20",cf);class $c extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,h,m,y,v){const E=this.length;return this.resize(E+1),this.emplace(E,e,n,h,m,y,v)}emplace(e,n,h,m,y,v,E){const k=6*e;return this.int16[k+0]=n,this.int16[k+1]=h,this.int16[k+2]=m,this.int16[k+3]=y,this.int16[k+4]=v,this.int16[k+5]=E,e}}$c.prototype.bytesPerElement=12,kr("StructArrayLayout2i2i2i12",$c);class yc extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,h,m,y){const v=this.length;return this.resize(v+1),this.emplace(v,e,n,h,m,y)}emplace(e,n,h,m,y,v){const E=4*e,k=8*e;return this.float32[E+0]=n,this.float32[E+1]=h,this.float32[E+2]=m,this.int16[k+6]=y,this.int16[k+7]=v,e}}yc.prototype.bytesPerElement=16,kr("StructArrayLayout2f1f2i16",yc);class ts extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,h,m,y,v){const E=this.length;return this.resize(E+1),this.emplace(E,e,n,h,m,y,v)}emplace(e,n,h,m,y,v,E){const k=16*e,P=4*e,O=8*e;return this.uint8[k+0]=n,this.uint8[k+1]=h,this.float32[P+1]=m,this.float32[P+2]=y,this.int16[O+6]=v,this.int16[O+7]=E,e}}ts.prototype.bytesPerElement=16,kr("StructArrayLayout2ub2f2i16",ts);class Pa extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,n,h)}emplace(e,n,h,m){const y=3*e;return this.uint16[y+0]=n,this.uint16[y+1]=h,this.uint16[y+2]=m,e}}Pa.prototype.bytesPerElement=6,kr("StructArrayLayout3ui6",Pa);class Hl extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,h,m,y,v,E,k,P,O,G,X,K,ae,oe,he,be){const Ze=this.length;return this.resize(Ze+1),this.emplace(Ze,e,n,h,m,y,v,E,k,P,O,G,X,K,ae,oe,he,be)}emplace(e,n,h,m,y,v,E,k,P,O,G,X,K,ae,oe,he,be,Ze){const Se=24*e,Ce=12*e,Ye=48*e;return this.int16[Se+0]=n,this.int16[Se+1]=h,this.uint16[Se+2]=m,this.uint16[Se+3]=y,this.uint32[Ce+2]=v,this.uint32[Ce+3]=E,this.uint32[Ce+4]=k,this.uint16[Se+10]=P,this.uint16[Se+11]=O,this.uint16[Se+12]=G,this.float32[Ce+7]=X,this.float32[Ce+8]=K,this.uint8[Ye+36]=ae,this.uint8[Ye+37]=oe,this.uint8[Ye+38]=he,this.uint32[Ce+10]=be,this.int16[Se+22]=Ze,e}}Hl.prototype.bytesPerElement=48,kr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Hl);class Iu extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,h,m,y,v,E,k,P,O,G,X,K,ae,oe,he,be,Ze,Se,Ce,Ye,it,At,Wt,Nt,rr,wr,ar){const qt=this.length;return this.resize(qt+1),this.emplace(qt,e,n,h,m,y,v,E,k,P,O,G,X,K,ae,oe,he,be,Ze,Se,Ce,Ye,it,At,Wt,Nt,rr,wr,ar)}emplace(e,n,h,m,y,v,E,k,P,O,G,X,K,ae,oe,he,be,Ze,Se,Ce,Ye,it,At,Wt,Nt,rr,wr,ar,qt){const Lt=32*e,Pr=16*e;return this.int16[Lt+0]=n,this.int16[Lt+1]=h,this.int16[Lt+2]=m,this.int16[Lt+3]=y,this.int16[Lt+4]=v,this.int16[Lt+5]=E,this.int16[Lt+6]=k,this.int16[Lt+7]=P,this.uint16[Lt+8]=O,this.uint16[Lt+9]=G,this.uint16[Lt+10]=X,this.uint16[Lt+11]=K,this.uint16[Lt+12]=ae,this.uint16[Lt+13]=oe,this.uint16[Lt+14]=he,this.uint16[Lt+15]=be,this.uint16[Lt+16]=Ze,this.uint16[Lt+17]=Se,this.uint16[Lt+18]=Ce,this.uint16[Lt+19]=Ye,this.uint16[Lt+20]=it,this.uint16[Lt+21]=At,this.uint16[Lt+22]=Wt,this.uint32[Pr+12]=Nt,this.float32[Pr+13]=rr,this.float32[Pr+14]=wr,this.uint16[Lt+30]=ar,this.uint16[Lt+31]=qt,e}}Iu.prototype.bytesPerElement=64,kr("StructArrayLayout8i15ui1ul2f2ui64",Iu);class Pu extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.float32[1*e+0]=n,e}}Pu.prototype.bytesPerElement=4,kr("StructArrayLayout1f4",Pu);class bh extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,n,h)}emplace(e,n,h,m){const y=3*e;return this.uint16[6*e+0]=n,this.float32[y+1]=h,this.float32[y+2]=m,e}}bh.prototype.bytesPerElement=12,kr("StructArrayLayout1ui2f12",bh);class ul extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,n,h)}emplace(e,n,h,m){const y=4*e;return this.uint32[2*e+0]=n,this.uint16[y+2]=h,this.uint16[y+3]=m,e}}ul.prototype.bytesPerElement=8,kr("StructArrayLayout1ul2ui8",ul);class w extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n){const h=this.length;return this.resize(h+1),this.emplace(h,e,n)}emplace(e,n,h){const m=2*e;return this.uint16[m+0]=n,this.uint16[m+1]=h,e}}w.prototype.bytesPerElement=4,kr("StructArrayLayout2ui4",w);class t extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint16[1*e+0]=n,e}}t.prototype.bytesPerElement=2,kr("StructArrayLayout1ui2",t);class o extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,h,m){const y=this.length;return this.resize(y+1),this.emplace(y,e,n,h,m)}emplace(e,n,h,m,y){const v=4*e;return this.float32[v+0]=n,this.float32[v+1]=h,this.float32[v+2]=m,this.float32[v+3]=y,e}}o.prototype.bytesPerElement=16,kr("StructArrayLayout4f16",o);class d extends $n{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new C(this.anchorPointX,this.anchorPointY)}}d.prototype.size=20;class x extends cf{get(e){return new d(this,e)}}kr("CollisionBoxArray",x);class S extends $n{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}S.prototype.size=48;class A extends Hl{get(e){return new S(this,e)}}kr("PlacedSymbolArray",A);class R extends $n{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}R.prototype.size=64;class F extends Iu{get(e){return new R(this,e)}}kr("SymbolInstanceArray",F);class V extends Pu{getoffsetX(e){return this.float32[1*e+0]}}kr("GlyphOffsetArray",V);class q extends Du{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}kr("SymbolLineVertexArray",q);class te extends $n{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}te.prototype.size=12;class Q extends bh{get(e){return new te(this,e)}}kr("TextAnchorOffsetArray",Q);class ce extends $n{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}ce.prototype.size=8;class _e extends ul{get(e){return new ce(this,e)}}kr("FeatureIndexArray",_e);class Ie extends ll{}class Oe extends ll{}class Le extends ll{}class qe extends xc{}class nt extends Md{}class He extends ka{}class rt extends cl{}class ot extends yh{}class Xe extends vh{}class ft extends of{}class Pt extends lf{}class Et extends $c{}class Ct extends ts{}class Dt extends Pa{}class ur extends w{}const fr=Ia([{name:"a_pos",components:2,type:"Int16"}],4),{members:tr}=fr;class br{constructor(e=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=e}prepareSegment(e,n,h,m){const y=this.segments[this.segments.length-1];return e>br.MAX_VERTEX_ARRAY_LENGTH&&se(`Max vertices per segment is ${br.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${br.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!y||y.vertexLength+e>br.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==m?this.createNewSegment(n,h,m):y}createNewSegment(e,n,h){const m={vertexOffset:e.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0,vaos:{}};return h!==void 0&&(m.sortKey=h),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(m),m}getOrCreateLatestSegment(e,n,h){return this.prepareSegment(0,e,n,h)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const e of this.segments)for(const n in e.vaos)e.vaos[n].destroy()}static simpleSegment(e,n,h,m){return new br([{vertexOffset:e,primitiveOffset:n,vertexLength:h,primitiveLength:m,vaos:{},sortKey:0}])}}function hn(a,e){return 256*(a=bt(Math.floor(a),0,255))+bt(Math.floor(e),0,255)}br.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,kr("SegmentVector",br);const Xn=Ia([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),xa=Ia([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);var ua,Ca,ra,Ua={exports:{}},Ma={exports:{}},Bi={exports:{}},Ka=(function(){if(ra)return Ua.exports;ra=1;var a=(ua||(ua=1,Ma.exports=function(n,h){var m,y,v,E,k,P,O,G;for(y=n.length-(m=3&n.length),v=h,k=3432918353,P=461845907,G=0;G<y;)O=255&n.charCodeAt(G)|(255&n.charCodeAt(++G))<<8|(255&n.charCodeAt(++G))<<16|(255&n.charCodeAt(++G))<<24,++G,v=27492+(65535&(E=5*(65535&(v=(v^=O=(65535&(O=(O=(65535&O)*k+(((O>>>16)*k&65535)<<16)&4294967295)<<15|O>>>17))*P+(((O>>>16)*P&65535)<<16)&4294967295)<<13|v>>>19))+((5*(v>>>16)&65535)<<16)&4294967295))+((58964+(E>>>16)&65535)<<16);switch(O=0,m){case 3:O^=(255&n.charCodeAt(G+2))<<16;case 2:O^=(255&n.charCodeAt(G+1))<<8;case 1:v^=O=(65535&(O=(O=(65535&(O^=255&n.charCodeAt(G)))*k+(((O>>>16)*k&65535)<<16)&4294967295)<<15|O>>>17))*P+(((O>>>16)*P&65535)<<16)&4294967295}return v^=n.length,v=2246822507*(65535&(v^=v>>>16))+((2246822507*(v>>>16)&65535)<<16)&4294967295,v=3266489909*(65535&(v^=v>>>13))+((3266489909*(v>>>16)&65535)<<16)&4294967295,(v^=v>>>16)>>>0}),Ma.exports),e=(Ca||(Ca=1,Bi.exports=function(n,h){for(var m,y=n.length,v=h^y,E=0;y>=4;)m=1540483477*(65535&(m=255&n.charCodeAt(E)|(255&n.charCodeAt(++E))<<8|(255&n.charCodeAt(++E))<<16|(255&n.charCodeAt(++E))<<24))+((1540483477*(m>>>16)&65535)<<16),v=1540483477*(65535&v)+((1540483477*(v>>>16)&65535)<<16)^(m=1540483477*(65535&(m^=m>>>24))+((1540483477*(m>>>16)&65535)<<16)),y-=4,++E;switch(y){case 3:v^=(255&n.charCodeAt(E+2))<<16;case 2:v^=(255&n.charCodeAt(E+1))<<8;case 1:v=1540483477*(65535&(v^=255&n.charCodeAt(E)))+((1540483477*(v>>>16)&65535)<<16)}return v=1540483477*(65535&(v^=v>>>13))+((1540483477*(v>>>16)&65535)<<16),(v^=v>>>15)>>>0}),Bi.exports);return Ua.exports=a,Ua.exports.murmur3=a,Ua.exports.murmur2=e,Ua.exports})(),Ja=M(Ka);class Ni{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,n,h,m){this.ids.push(ql(e)),this.positions.push(n,h,m)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const n=ql(e);let h=0,m=this.ids.length-1;for(;h<m;){const v=h+m>>1;this.ids[v]>=n?m=v:h=v+1}const y=[];for(;this.ids[h]===n;)y.push({index:this.positions[3*h],start:this.positions[3*h+1],end:this.positions[3*h+2]}),h++;return y}static serialize(e,n){const h=new Float64Array(e.ids),m=new Uint32Array(e.positions);return Zl(h,m,0,h.length-1),n&&n.push(h.buffer,m.buffer),{ids:h,positions:m}}static deserialize(e){const n=new Ni;return n.ids=e.ids,n.positions=e.positions,n.indexed=!0,n}}function ql(a){const e=+a;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:Ja(String(a))}function Zl(a,e,n,h){for(;n<h;){const m=a[n+h>>1];let y=n-1,v=h+1;for(;;){do y++;while(a[y]<m);do v--;while(a[v]>m);if(y>=v)break;hl(a,y,v),hl(e,3*y,3*v),hl(e,3*y+1,3*v+1),hl(e,3*y+2,3*v+2)}v-n<h-v?(Zl(a,e,n,v),n=v+1):(Zl(a,e,v+1,h),h=v)}}function hl(a,e,n){const h=a[e];a[e]=a[n],a[n]=h}kr("FeaturePositionMap",Ni);class Us{constructor(e,n){this.gl=e.gl,this.location=n}}class Fu extends Us{constructor(e,n){super(e,n),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class wh extends Us{constructor(e,n){super(e,n),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class fl extends Us{constructor(e,n){super(e,n),this.current=fn.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const Vs=new Float32Array(16);function lo(a){return[hn(255*a.r,255*a.g),hn(255*a.b,255*a.a)]}class Ro{constructor(e,n,h){this.value=e,this.uniformNames=n.map((m=>`u_${m}`)),this.type=h}setUniform(e,n,h){e.set(h.constantOr(this.value))}getBinding(e,n,h){return this.type==="color"?new fl(e,n):new Fu(e,n)}}class Io{constructor(e,n){this.uniformNames=n.map((h=>`u_${h}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,n){this.pixelRatioFrom=n.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=n.tlbr,this.patternTo=e.tlbr}setConstantDashPositions(e,n){this.dashTo=[0,e.y,e.height,e.width],this.dashFrom=[0,n.y,n.height,n.width]}setUniform(e,n,h,m){let y=null;m==="u_pattern_to"?y=this.patternTo:m==="u_pattern_from"?y=this.patternFrom:m==="u_dasharray_to"?y=this.dashTo:m==="u_dasharray_from"?y=this.dashFrom:m==="u_pixel_ratio_to"?y=this.pixelRatioTo:m==="u_pixel_ratio_from"&&(y=this.pixelRatioFrom),y!==null&&e.set(y)}getBinding(e,n,h){return h.substr(0,9)==="u_pattern"||h.substr(0,12)==="u_dasharray_"?new wh(e,n):new Fu(e,n)}}class Qn{constructor(e,n,h,m){this.expression=e,this.type=h,this.maxValue=0,this.paintVertexAttributes=n.map((y=>({name:`a_${y}`,type:"Float32",components:h==="color"?2:1,offset:0}))),this.paintVertexArray=new m}populatePaintArray(e,n,h){const m=this.paintVertexArray.length,y=this.expression.evaluate(new Jn(0,h),n,{},h.canonical,[],h.formattedSection);this.paintVertexArray.resize(e),this._setPaintValue(m,e,y)}updatePaintArray(e,n,h,m,y){const v=this.expression.evaluate(new Jn(0,y),h,m);this._setPaintValue(e,n,v)}_setPaintValue(e,n,h){if(this.type==="color"){const m=lo(h);for(let y=e;y<n;y++)this.paintVertexArray.emplace(y,m[0],m[1])}else{for(let m=e;m<n;m++)this.paintVertexArray.emplace(m,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ha{constructor(e,n,h,m,y,v){this.expression=e,this.uniformNames=n.map((E=>`u_${E}_t`)),this.type=h,this.useIntegerZoom=m,this.zoom=y,this.maxValue=0,this.paintVertexAttributes=n.map((E=>({name:`a_${E}`,type:"Float32",components:h==="color"?4:2,offset:0}))),this.paintVertexArray=new v}populatePaintArray(e,n,h){const m=this.expression.evaluate(new Jn(this.zoom,h),n,{},h.canonical,[],h.formattedSection),y=this.expression.evaluate(new Jn(this.zoom+1,h),n,{},h.canonical,[],h.formattedSection),v=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(v,e,m,y)}updatePaintArray(e,n,h,m,y){const v=this.expression.evaluate(new Jn(this.zoom,y),h,m),E=this.expression.evaluate(new Jn(this.zoom+1,y),h,m);this._setPaintValue(e,n,v,E)}_setPaintValue(e,n,h,m){if(this.type==="color"){const y=lo(h),v=lo(m);for(let E=e;E<n;E++)this.paintVertexArray.emplace(E,y[0],y[1],v[0],v[1])}else{for(let y=e;y<n;y++)this.paintVertexArray.emplace(y,h,m);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(m))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,n){const h=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,m=bt(this.expression.interpolationFactor(h,this.zoom,this.zoom+1),0,1);e.set(m)}getBinding(e,n,h){return new Fu(e,n)}}class hi{constructor(e,n,h,m,y,v){this.expression=e,this.type=n,this.useIntegerZoom=h,this.zoom=m,this.layerId=v,this.zoomInPaintVertexArray=new y,this.zoomOutPaintVertexArray=new y}populatePaintArray(e,n,h){const m=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(m,e,this.getPositionIds(n),h)}updatePaintArray(e,n,h,m,y){this._setPaintValues(e,n,this.getPositionIds(h),y)}_setPaintValues(e,n,h,m){const y=this.getPositions(m);if(!y||!h)return;const v=y[h.min],E=y[h.mid],k=y[h.max];if(v&&E&&k)for(let P=e;P<n;P++)this.emplace(this.zoomInPaintVertexArray,P,E,v),this.emplace(this.zoomOutPaintVertexArray,P,E,k)}upload(e){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){const n=this.getVertexAttributes();this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,n,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,n,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class xi extends hi{getPositions(e){return e.imagePositions}getPositionIds(e){return e.patterns&&e.patterns[this.layerId]}getVertexAttributes(){return Xn.members}emplace(e,n,h,m){e.emplace(n,h.tlbr[0],h.tlbr[1],h.tlbr[2],h.tlbr[3],m.tlbr[0],m.tlbr[1],m.tlbr[2],m.tlbr[3],h.pixelRatio,m.pixelRatio)}}class Vf extends hi{getPositions(e){return e.dashPositions}getPositionIds(e){return e.dashes&&e.dashes[this.layerId]}getVertexAttributes(){return xa.members}emplace(e,n,h,m){e.emplace(n,0,h.y,h.height,h.width,0,m.y,m.height,m.width)}}class Gf{constructor(e,n,h){this.binders={},this._buffers=[];const m=[];for(const y in e.paint._values){if(!h(y))continue;const v=e.paint.get(y);if(!(v instanceof oo&&Os(v.property.specification)))continue;const E=Lp(y,e.type),k=v.value,P=v.property.specification.type,O=v.property.useIntegerZoom,G=v.property.specification["property-type"],X=G==="cross-faded"||G==="cross-faded-data-driven";if(k.kind==="constant")this.binders[y]=X?new Io(k.value,E):new Ro(k.value,E,P),m.push(`/u_${y}`);else if(k.kind==="source"||X){const K=Yc(y,P,"source");this.binders[y]=X?y==="line-dasharray"?new Vf(k,P,O,n,K,e.id):new xi(k,P,O,n,K,e.id):new Qn(k,E,P,K),m.push(`/a_${y}`)}else{const K=Yc(y,P,"composite");this.binders[y]=new ha(k,E,P,O,n,K),m.push(`/z_${y}`)}}this.cacheKey=m.sort().join("")}getMaxValue(e){const n=this.binders[e];return n instanceof Qn||n instanceof ha?n.maxValue:0}populatePaintArrays(e,n,h){for(const m in this.binders){const y=this.binders[m];(y instanceof Qn||y instanceof ha||y instanceof hi)&&y.populatePaintArray(e,n,h)}}setConstantPatternPositions(e,n){for(const h in this.binders){const m=this.binders[h];m instanceof Io&&m.setConstantPatternPositions(e,n)}}setConstantDashPositions(e,n){for(const h in this.binders){const m=this.binders[h];m instanceof Io&&m.setConstantDashPositions(e,n)}}updatePaintArrays(e,n,h,m,y){let v=!1;for(const E in e){const k=n.getPositions(E);for(const P of k){const O=h.feature(P.index);for(const G in this.binders){const X=this.binders[G];if((X instanceof Qn||X instanceof ha||X instanceof hi)&&X.expression.isStateDependent===!0){const K=m.paint.get(G);X.expression=K.value,X.updatePaintArray(P.start,P.end,O,e[E],y),v=!0}}}}return v}defines(){const e=[];for(const n in this.binders){const h=this.binders[n];(h instanceof Ro||h instanceof Io)&&e.push(...h.uniformNames.map((m=>`#define HAS_UNIFORM_${m}`)))}return e}getBinderAttributes(){const e=[];for(const n in this.binders){const h=this.binders[n];if(h instanceof Qn||h instanceof ha)for(let m=0;m<h.paintVertexAttributes.length;m++)e.push(h.paintVertexAttributes[m].name);else if(h instanceof hi){const m=h.getVertexAttributes();for(const y of m)e.push(y.name)}}return e}getBinderUniforms(){const e=[];for(const n in this.binders){const h=this.binders[n];if(h instanceof Ro||h instanceof Io||h instanceof ha)for(const m of h.uniformNames)e.push(m)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,n){const h=[];for(const m in this.binders){const y=this.binders[m];if(y instanceof Ro||y instanceof Io||y instanceof ha){for(const v of y.uniformNames)if(n[v]){const E=y.getBinding(e,n[v],v);h.push({name:v,property:m,binding:E})}}}return h}setUniforms(e,n,h,m){for(const{name:y,property:v,binding:E}of n)this.binders[v].setUniform(E,m,h.get(v),y)}updatePaintBuffers(e){this._buffers=[];for(const n in this.binders){const h=this.binders[n];if(e&&h instanceof hi){const m=e.fromScale===2?h.zoomInPaintVertexBuffer:h.zoomOutPaintVertexBuffer;m&&this._buffers.push(m)}else(h instanceof Qn||h instanceof ha)&&h.paintVertexBuffer&&this._buffers.push(h.paintVertexBuffer)}}upload(e){for(const n in this.binders){const h=this.binders[n];(h instanceof Qn||h instanceof ha||h instanceof hi)&&h.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const n=this.binders[e];(n instanceof Qn||n instanceof ha||n instanceof hi)&&n.destroy()}}}class Xc{constructor(e,n,h=()=>!0){this.programConfigurations={};for(const m of e)this.programConfigurations[m.id]=new Gf(m,n,h);this.needsUpload=!1,this._featureMap=new Ni,this._bufferOffset=0}populatePaintArrays(e,n,h,m){for(const y in this.programConfigurations)this.programConfigurations[y].populatePaintArrays(e,n,m);n.id!==void 0&&this._featureMap.add(n.id,h,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,n,h,m){for(const y of h)this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(e,this._featureMap,n,y,m)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function Lp(a,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[a]||[a.replace(`${e}-`,"").replace(/-/g,"_")]}function Yc(a,e,n){const h={color:{source:ka,composite:o},number:{source:Pu,composite:ka}},m=(function(y){return{"line-pattern":{source:rt,composite:rt},"fill-pattern":{source:rt,composite:rt},"fill-extrusion-pattern":{source:rt,composite:rt},"line-dasharray":{source:ot,composite:ot}}[y]})(a);return m&&m[n]||h[e][n]}kr("ConstantBinder",Ro),kr("CrossFadedConstantBinder",Io),kr("SourceExpressionBinder",Qn),kr("CrossFadedPatternBinder",xi),kr("CrossFadedDasharrayBinder",Vf),kr("CompositeExpressionBinder",ha),kr("ProgramConfiguration",Gf,{omit:["_buffers"]}),kr("ProgramConfigurationSet",Xc);const Hf=Math.pow(2,14)-1,vc=-Hf-1;function bc(a){const e=Be/a.extent,n=a.loadGeometry();for(let h=0;h<n.length;h++){const m=n[h];for(let y=0;y<m.length;y++){const v=m[y],E=Math.round(v.x*e),k=Math.round(v.y*e);v.x=bt(E,vc,Hf),v.y=bt(k,vc,Hf),(E<v.x||E>v.x+1||k<v.y||k>v.y+1)&&se("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return n}function dl(a,e){return{type:a.type,id:a.id,properties:a.properties,geometry:e?bc(a):[]}}const qf=-32768;function uf(a,e,n,h,m){a.emplaceBack(qf+8*e+h,qf+8*n+m)}class hf{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((n=>n.id)),this.index=e.index,this.hasDependencies=!1,this.layoutVertexArray=new Oe,this.indexArray=new Dt,this.segments=new br,this.programConfigurations=new Xc(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter((n=>n.isStateDependent())).map((n=>n.id))}populate(e,n,h){const m=this.layers[0],y=[];let v=null,E=!1,k=m.type==="heatmap";if(m.type==="circle"){const O=m;v=O.layout.get("circle-sort-key"),E=!v.isConstant(),k=k||O.paint.get("circle-pitch-alignment")==="map"}const P=k?n.subdivisionGranularity.circle:1;for(const{feature:O,id:G,index:X,sourceLayerIndex:K}of e){const ae=this.layers[0]._featureFilter.needGeometry,oe=dl(O,ae);if(!this.layers[0]._featureFilter.filter(new Jn(this.zoom),oe,h))continue;const he=E?v.evaluate(oe,{},h):void 0,be={id:G,properties:O.properties,type:O.type,sourceLayerIndex:K,index:X,geometry:ae?oe.geometry:bc(O),patterns:{},sortKey:he};y.push(be)}E&&y.sort(((O,G)=>O.sortKey-G.sortKey));for(const O of y){const{geometry:G,index:X,sourceLayerIndex:K}=O,ae=e[X].feature;this.addFeature(O,G,X,h,P),n.featureIndex.insert(ae,G,X,K,this.index)}}update(e,n,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,{imagePositions:h})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,tr),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,n,h,m,y=1){let v;switch(y){case 1:v=[0,7];break;case 3:v=[0,2,5,7];break;case 5:v=[0,1,3,4,6,7];break;case 7:v=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${y}; valid values are 1, 3, 5, 7.`)}const E=v.length;for(const k of n)for(const P of k){const O=P.x,G=P.y;if(O<0||O>=Be||G<0||G>=Be)continue;const X=this.segments.prepareSegment(E*E,this.layoutVertexArray,this.indexArray,e.sortKey),K=X.vertexLength;for(let ae=0;ae<E;ae++)for(let oe=0;oe<E;oe++)uf(this.layoutVertexArray,O,G,v[oe],v[ae]);for(let ae=0;ae<E-1;ae++)for(let oe=0;oe<E-1;oe++){const he=K+ae*E+oe,be=K+(ae+1)*E+oe;this.indexArray.emplaceBack(he,be+1,he+1),this.indexArray.emplaceBack(he,be,be+1)}X.vertexLength+=E*E,X.primitiveLength+=(E-1)*(E-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,h,{imagePositions:{},canonical:m})}}function ff(a,e){for(let n=0;n<a.length;n++)if(Kc(e,a[n]))return!0;for(let n=0;n<e.length;n++)if(Kc(a,e[n]))return!0;return!!rs(a,e)}function zp(a,e,n){return!!Kc(a,e)||!!Bp(e,a,n)}function Op(a,e){if(a.length===1)return om(e,a[0]);for(let n=0;n<e.length;n++){const h=e[n];for(let m=0;m<h.length;m++)if(Kc(a,h[m]))return!0}for(let n=0;n<a.length;n++)if(om(e,a[n]))return!0;for(let n=0;n<e.length;n++)if(rs(a,e[n]))return!0;return!1}function ji(a,e,n){if(a.length>1){if(rs(a,e))return!0;for(let h=0;h<e.length;h++)if(Bp(e[h],a,n))return!0}for(let h=0;h<a.length;h++)if(Bp(a[h],e,n))return!0;return!1}function rs(a,e){if(a.length===0||e.length===0)return!1;for(let n=0;n<a.length-1;n++){const h=a[n],m=a[n+1];for(let y=0;y<e.length-1;y++)if(Yg(h,m,e[y],e[y+1]))return!0}return!1}function Yg(a,e,n,h){return Rt(a,n,h)!==Rt(e,n,h)&&Rt(a,e,n)!==Rt(a,e,h)}function Bp(a,e,n){const h=n*n;if(e.length===1)return a.distSqr(e[0])<h;for(let m=1;m<e.length;m++)if(sm(a,e[m-1],e[m])<h)return!0;return!1}function sm(a,e,n){const h=e.distSqr(n);if(h===0)return a.distSqr(e);const m=((a.x-e.x)*(n.x-e.x)+(a.y-e.y)*(n.y-e.y))/h;return a.distSqr(m<0?e:m>1?n:n.sub(e)._mult(m)._add(e))}function om(a,e){let n,h,m,y=!1;for(let v=0;v<a.length;v++){n=a[v];for(let E=0,k=n.length-1;E<n.length;k=E++)h=n[E],m=n[k],h.y>e.y!=m.y>e.y&&e.x<(m.x-h.x)*(e.y-h.y)/(m.y-h.y)+h.x&&(y=!y)}return y}function Kc(a,e){let n=!1;for(let h=0,m=a.length-1;h<a.length;m=h++){const y=a[h],v=a[m];y.y>e.y!=v.y>e.y&&e.x<(v.x-y.x)*(e.y-y.y)/(v.y-y.y)+y.x&&(n=!n)}return n}function Kg(a,e,n){const h=n[0],m=n[2];if(a.x<h.x&&e.x<h.x||a.x>m.x&&e.x>m.x||a.y<h.y&&e.y<h.y||a.y>m.y&&e.y>m.y)return!1;const y=Rt(a,e,n[0]);return y!==Rt(a,e,n[1])||y!==Rt(a,e,n[2])||y!==Rt(a,e,n[3])}function Lu(a,e,n){const h=e.paint.get(a).value;return h.kind==="constant"?h.value:n.programConfigurations.get(e.id).getMaxValue(a)}function Dd(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function Np(a,e,n,h,m){if(!e[0]&&!e[1])return a;const y=C.convert(e)._mult(m);n==="viewport"&&y._rotate(-h);const v=[];for(let E=0;E<a.length;E++)v.push(a[E].sub(y));return v}function jp(a){const e=[];for(let n=0;n<a.length;n++){const h=a[n],m=e.at(-1);(n===0||m&&!h.equals(m))&&e.push(h)}return e}function lm({queryGeometry:a,size:e},n){return zp(a,n,e)}function Jg({queryGeometry:a,size:e,transform:n,unwrappedTileID:h,getElevation:m},y){return zp(a,y,e*(n.projectTileCoordinates(y.x,y.y,h,m).signedDistanceFromCamera/n.cameraToCenterDistance))}function Qg({queryGeometry:a,size:e,transform:n,unwrappedTileID:h,getElevation:m},y){const v=n.projectTileCoordinates(y.x,y.y,h,m).signedDistanceFromCamera,E=e*(n.cameraToCenterDistance/v);return zp(a,Rd(y,n,h,m),E)}function e_({queryGeometry:a,size:e,transform:n,unwrappedTileID:h,getElevation:m},y){return zp(a,Rd(y,n,h,m),e)}function Up({queryGeometry:a,size:e,transform:n,unwrappedTileID:h,getElevation:m,pitchAlignment:y="map",pitchScale:v="map"},E){const k=y==="map"?v==="map"?lm:Jg:v==="map"?Qg:e_,P={queryGeometry:a,size:e,transform:n,unwrappedTileID:h,getElevation:m};for(const O of E)for(const G of O)if(k(P,G))return!0;return!1}function Rd(a,e,n,h){const m=e.projectTileCoordinates(a.x,a.y,n,h).point;return new C((.5*m.x+.5)*e.width,(.5*-m.y+.5)*e.height)}let Vp,cm;kr("CircleBucket",hf,{omit:["layers"]});var um={get paint(){return cm=cm||new ni({"circle-radius":new Br(xt.paint_circle["circle-radius"]),"circle-color":new Br(xt.paint_circle["circle-color"]),"circle-blur":new Br(xt.paint_circle["circle-blur"]),"circle-opacity":new Br(xt.paint_circle["circle-opacity"]),"circle-translate":new Rr(xt.paint_circle["circle-translate"]),"circle-translate-anchor":new Rr(xt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Rr(xt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Rr(xt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Br(xt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Br(xt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Br(xt.paint_circle["circle-stroke-opacity"])})},get layout(){return Vp=Vp||new ni({"circle-sort-key":new Br(xt.layout_circle["circle-sort-key"])})}};class Gp extends ja{constructor(e,n){super(e,um,n)}createBucket(e){return new hf(e)}queryRadius(e){const n=e;return Lu("circle-radius",this,n)+Lu("circle-stroke-width",this,n)+Dd(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:e,feature:n,featureState:h,geometry:m,transform:y,pixelsToTileUnits:v,unwrappedTileID:E,getElevation:k}){const P=Np(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-y.bearingInRadians,v),O=this.paint.get("circle-radius").evaluate(n,h)+this.paint.get("circle-stroke-width").evaluate(n,h),G=this.paint.get("circle-pitch-scale"),X=this.paint.get("circle-pitch-alignment");let K,ae;return X==="map"?(K=P,ae=O*v):(K=(function(oe,he,be,Ze){return oe.map((Se=>Rd(Se,he,be,Ze)))})(P,y,E,k),ae=O),Up({queryGeometry:K,size:ae,transform:y,unwrappedTileID:E,getElevation:k,pitchAlignment:X,pitchScale:G},m)}}class Hp extends hf{}let hm;kr("HeatmapBucket",Hp,{omit:["layers"]});var fm={get paint(){return hm=hm||new ni({"heatmap-radius":new Br(xt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Br(xt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Rr(xt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new af(xt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Rr(xt.paint_heatmap["heatmap-opacity"])})}};function qp(a,{width:e,height:n},h,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==e*n*h)throw new RangeError(`mismatched image size. expected: ${m.length} but got: ${e*n*h}`)}else m=new Uint8Array(e*n*h);return a.width=e,a.height=n,a.data=m,a}function Jc(a,{width:e,height:n},h){if(e===a.width&&n===a.height)return;const m=qp({},{width:e,height:n},h);Id(a,m,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,e),height:Math.min(a.height,n)},h),a.width=e,a.height=n,a.data=m.data}function Id(a,e,n,h,m,y){if(m.width===0||m.height===0)return e;if(m.width>a.width||m.height>a.height||n.x>a.width-m.width||n.y>a.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>e.width||m.height>e.height||h.x>e.width-m.width||h.y>e.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const v=a.data,E=e.data;if(v===E)throw new Error("srcData equals dstData, so image is already copied");for(let k=0;k<m.height;k++){const P=((n.y+k)*a.width+n.x)*y,O=((h.y+k)*e.width+h.x)*y;for(let G=0;G<m.width*y;G++)E[O+G]=v[P+G]}return e}class Pd{constructor(e,n){qp(this,e,1,n)}resize(e){Jc(this,e,1)}clone(){return new Pd({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,h,m,y){Id(e,n,h,m,y,1)}}class Gs{constructor(e,n){qp(this,e,4,n)}resize(e){Jc(this,e,4)}replace(e,n){n?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Gs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,h,m,y){Id(e,n,h,m,y,4)}setPixel(e,n,h){const m=4*(e*this.width+n);this.data[m+0]=Math.round(255*h.r/h.a),this.data[m+1]=Math.round(255*h.g/h.a),this.data[m+2]=Math.round(255*h.b/h.a),this.data[m+3]=Math.round(255*h.a)}}function Qc(a){const e={},n=a.resolution||256,h=a.clips?a.clips.length:1,m=a.image||new Gs({width:n,height:h});if(Math.log(n)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${n}`);const y=(v,E,k)=>{e[a.evaluationKey]=k;const P=a.expression.evaluate(e);m.setPixel(v/4/n,E/4,P)};if(a.clips)for(let v=0,E=0;v<h;++v,E+=4*n)for(let k=0,P=0;k<n;k++,P+=4){const O=k/(n-1),{start:G,end:X}=a.clips[v];y(E,P,G*(1-O)+X*O)}else for(let v=0,E=0;v<n;v++,E+=4)y(0,E,v/(n-1));return m}kr("AlphaImage",Pd),kr("RGBAImage",Gs);const Fd="big-fb";class t_ extends ja{createBucket(e){return new Hp(e)}constructor(e,n){super(e,fm,n),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Qc({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Fd)&&this.heatmapFbos.delete(Fd)}queryRadius(e){return Lu("heatmap-radius",this,e)}queryIntersectsFeature({queryGeometry:e,feature:n,featureState:h,geometry:m,transform:y,pixelsToTileUnits:v,unwrappedTileID:E,getElevation:k}){return Up({queryGeometry:e,size:this.paint.get("heatmap-radius").evaluate(n,h)*v,transform:y,unwrappedTileID:E,getElevation:k},m)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&!this.isHidden()}}let Ld;var zd={get paint(){return Ld=Ld||new ni({"hillshade-illumination-direction":new Rr(xt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Rr(xt.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Rr(xt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Rr(xt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Rr(xt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Rr(xt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Rr(xt.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Rr(xt.paint_hillshade["hillshade-method"])})}};class Qa extends ja{constructor(e,n){super(e,zd,n),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let e=this.paint.get("hillshade-illumination-direction").values,n=this.paint.get("hillshade-illumination-altitude").values,h=this.paint.get("hillshade-highlight-color").values,m=this.paint.get("hillshade-shadow-color").values;const y=Math.max(e.length,n.length,h.length,m.length);e=e.concat(Array(y-e.length).fill(e.at(-1))),n=n.concat(Array(y-n.length).fill(n.at(-1))),h=h.concat(Array(y-h.length).fill(h.at(-1))),m=m.concat(Array(y-m.length).fill(m.at(-1)));const v=n.map(pr);return{directionRadians:e.map(pr),altitudeRadians:v,shadowColor:m,highlightColor:h}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&!this.isHidden()}}let r_;var Vx={get paint(){return r_=r_||new ni({"color-relief-opacity":new Rr(xt["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new af(xt["paint_color-relief"]["color-relief-color"])})}};class Zp{constructor(e,n,h,m){this.context=e,this.format=h,this.texture=e.gl.createTexture(),this.update(n,m)}update(e,n,h){const{width:m,height:y}=e,v=!(this.size&&this.size[0]===m&&this.size[1]===y||h),{context:E}=this,{gl:k}=E;if(this.useMipmap=!!(n&&n.useMipmap),k.bindTexture(k.TEXTURE_2D,this.texture),E.pixelStoreUnpackFlipY.set(!1),E.pixelStoreUnpack.set(1),E.pixelStoreUnpackPremultiplyAlpha.set(this.format===k.RGBA&&(!n||n.premultiply!==!1)),v)this.size=[m,y],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||Ne(e)?k.texImage2D(k.TEXTURE_2D,0,this.format,this.format,k.UNSIGNED_BYTE,e):k.texImage2D(k.TEXTURE_2D,0,this.format,m,y,0,this.format,k.UNSIGNED_BYTE,e.data);else{const{x:P,y:O}=h||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||Ne(e)?k.texSubImage2D(k.TEXTURE_2D,0,P,O,k.RGBA,k.UNSIGNED_BYTE,e):k.texSubImage2D(k.TEXTURE_2D,0,P,O,m,y,k.RGBA,k.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&k.generateMipmap(k.TEXTURE_2D),E.pixelStoreUnpackFlipY.setDefault(),E.pixelStoreUnpack.setDefault(),E.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(e,n,h){const{context:m}=this,{gl:y}=m;y.bindTexture(y.TEXTURE_2D,this.texture),h!==y.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(h=y.LINEAR),e!==this.filter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,e),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,h||e),this.filter=e),n!==this.wrap&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,n),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,n),this.wrap=n)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class Zf{constructor(e,n,h,m=1,y=1,v=1,E=0){if(this.uid=e,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(h&&!["mapbox","terrarium","custom"].includes(h))return void se(`"${h}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=n.height;const k=this.dim=n.height-2;switch(this.data=new Uint32Array(n.data.buffer),h){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=m,this.greenFactor=y,this.blueFactor=v,this.baseShift=E;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let P=0;P<k;P++)this.data[this._idx(-1,P)]=this.data[this._idx(0,P)],this.data[this._idx(k,P)]=this.data[this._idx(k-1,P)],this.data[this._idx(P,-1)]=this.data[this._idx(P,0)],this.data[this._idx(P,k)]=this.data[this._idx(P,k-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(k,-1)]=this.data[this._idx(k-1,0)],this.data[this._idx(-1,k)]=this.data[this._idx(0,k-1)],this.data[this._idx(k,k)]=this.data[this._idx(k-1,k-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let P=0;P<k;P++)for(let O=0;O<k;O++){const G=this.get(P,O);G>this.max&&(this.max=G),G<this.min&&(this.min=G)}}get(e,n){const h=new Uint8Array(this.data.buffer),m=4*this._idx(e,n);return this.unpack(h[m],h[m+1],h[m+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,n){if(e<-1||e>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError(`Out of range source coordinates for DEM data. x: ${e}, y: ${n}, dim: ${this.dim}`);return(n+1)*this.stride+(e+1)}unpack(e,n,h){return e*this.redFactor+n*this.greenFactor+h*this.blueFactor-this.baseShift}pack(e){return zu(e,this.getUnpackVector())}getPixels(){return new Gs({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,n,h){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let m=n*this.dim,y=n*this.dim+this.dim,v=h*this.dim,E=h*this.dim+this.dim;switch(n){case-1:m=y-1;break;case 1:y=m+1}switch(h){case-1:v=E-1;break;case 1:E=v+1}const k=-n*this.dim,P=-h*this.dim;for(let O=v;O<E;O++)for(let G=m;G<y;G++)this.data[this._idx(G,O)]=e.data[this._idx(G+k,O+P)]}}function zu(a,e){const n=e[0],h=e[1],m=e[2],y=e[3],v=Math.min(n,h,m),E=Math.round((a+y)/v);return{r:Math.floor(E*v/n)%256,g:Math.floor(E*v/h)%256,b:Math.floor(E*v/m)%256}}kr("DEMData",Zf);class n_ extends ja{constructor(e,n){super(e,Vx,n)}_createColorRamp(e){const n={elevationStops:[],colorStops:[]},h=this._transitionablePaint._values["color-relief-color"].value.expression;if(h instanceof Or&&h._styleExpression.expression instanceof Ii){this.colorRampExpression=h;const v=h._styleExpression.expression;n.elevationStops=v.labels,n.colorStops=[];for(const E of n.elevationStops)n.colorStops.push(v.evaluate({globals:{elevation:E}}))}if(n.elevationStops.length<1&&(n.elevationStops=[0],n.colorStops=[fn.transparent]),n.elevationStops.length<2&&(n.elevationStops.push(n.elevationStops[0]+1),n.colorStops.push(n.colorStops[0])),n.elevationStops.length<=e)return n;const m={elevationStops:[],colorStops:[]},y=(n.elevationStops.length-1)/(e-1);for(let v=0;v<n.elevationStops.length-.5;v+=y)m.elevationStops.push(n.elevationStops[Math.round(v)]),m.colorStops.push(n.colorStops[Math.round(v)]);return se(`Too many colors in specification of ${this.id} color-relief layer, may not render properly. Max possible colors: ${e}, provided: ${n.elevationStops.length}`),m}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(e,n,h){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const m=this._createColorRamp(n),y=new Gs({width:m.colorStops.length,height:1}),v=new Gs({width:m.colorStops.length,height:1});for(let E=0;E<m.elevationStops.length;E++){const k=zu(m.elevationStops[E],h);v.setPixel(0,E,new fn(k.r/255,k.g/255,k.b/255,1)),y.setPixel(0,E,m.colorStops[E])}return this.colorRampTextures={elevationTexture:new Zp(e,v,e.gl.RGBA),colorTexture:new Zp(e,y,e.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return!this.isHidden()&&!!this.colorRampTextures}}const a_=Ia([{name:"a_pos",components:2,type:"Int16"}],4),{members:Od}=a_;function pl(a,e,n){const h=n.patternDependencies;let m=!1;for(const y of e){const v=y.paint.get(`${a}-pattern`);v.isConstant()||(m=!0);const E=v.constantOr(null);E&&(m=!0,h[E.to]=!0,h[E.from]=!0)}return m}function Wp(a,e,n,h,m){const{zoom:y}=h,v=m.patternDependencies;for(const E of e){const k=E.paint.get(`${a}-pattern`).value;if(k.kind!=="constant"){let P=k.evaluate({zoom:y-1},n,{},m.availableImages),O=k.evaluate({zoom:y},n,{},m.availableImages),G=k.evaluate({zoom:y+1},n,{},m.availableImages);P=P&&P.name?P.name:P,O=O&&O.name?O.name:O,G=G&&G.name?G.name:G,v[P]=!0,v[O]=!0,v[G]=!0,n.patterns[E.id]={min:P,mid:O,max:G}}}return n}function $p(a,e,n,h,m){let y;if(m===(function(v,E,k,P){let O=0;for(let G=E,X=k-P;G<k;G+=P)O+=(v[X]-v[G])*(v[G+1]+v[X+1]),X=G;return O})(a,e,n,h)>0)for(let v=e;v<n;v+=h)y=co(v/h|0,a[v],a[v+1],y);else for(let v=n-h;v>=e;v-=h)y=co(v/h|0,a[v],a[v+1],y);return y&&Po(y,y.next)&&(uo(y),y=y.next),y}function Th(a,e){if(!a)return a;e||(e=a);let n,h=a;do if(n=!1,h.steiner||!Po(h,h.next)&&Hn(h.prev,h,h.next)!==0)h=h.next;else{if(uo(h),h=e=h.prev,h===h.next)break;n=!0}while(n||h!==e);return e}function df(a,e,n,h,m,y,v){if(!a)return;!v&&y&&(function(k,P,O,G){let X=k;do X.z===0&&(X.z=Vi(X.x,X.y,P,O,G)),X.prevZ=X.prev,X.nextZ=X.next,X=X.next;while(X!==k);X.prevZ.nextZ=null,X.prevZ=null,(function(K){let ae,oe=1;do{let he,be=K;K=null;let Ze=null;for(ae=0;be;){ae++;let Se=be,Ce=0;for(let it=0;it<oe&&(Ce++,Se=Se.nextZ,Se);it++);let Ye=oe;for(;Ce>0||Ye>0&&Se;)Ce!==0&&(Ye===0||!Se||be.z<=Se.z)?(he=be,be=be.nextZ,Ce--):(he=Se,Se=Se.nextZ,Ye--),Ze?Ze.nextZ=he:K=he,he.prevZ=Ze,Ze=he;be=Se}Ze.nextZ=null,oe*=2}while(ae>1)})(X)})(a,h,m,y);let E=a;for(;a.prev!==a.next;){const k=a.prev,P=a.next;if(y?Xp(a,h,m,y):dm(a))e.push(k.i,a.i,P.i),uo(a),a=P.next,E=P.next;else if((a=P)===E){v?v===1?df(a=i_(Th(a),e),e,n,h,m,y,2):v===2&&Ou(a,e,n,h,m,y):df(Th(a),e,n,h,m,y,1);break}}}function dm(a){const e=a.prev,n=a,h=a.next;if(Hn(e,n,h)>=0)return!1;const m=e.x,y=n.x,v=h.x,E=e.y,k=n.y,P=h.y,O=Math.min(m,y,v),G=Math.min(E,k,P),X=Math.max(m,y,v),K=Math.max(E,k,P);let ae=h.next;for(;ae!==e;){if(ae.x>=O&&ae.x<=X&&ae.y>=G&&ae.y<=K&&Wf(m,E,y,k,v,P,ae.x,ae.y)&&Hn(ae.prev,ae,ae.next)>=0)return!1;ae=ae.next}return!0}function Xp(a,e,n,h){const m=a.prev,y=a,v=a.next;if(Hn(m,y,v)>=0)return!1;const E=m.x,k=y.x,P=v.x,O=m.y,G=y.y,X=v.y,K=Math.min(E,k,P),ae=Math.min(O,G,X),oe=Math.max(E,k,P),he=Math.max(O,G,X),be=Vi(K,ae,e,n,h),Ze=Vi(oe,he,e,n,h);let Se=a.prevZ,Ce=a.nextZ;for(;Se&&Se.z>=be&&Ce&&Ce.z<=Ze;){if(Se.x>=K&&Se.x<=oe&&Se.y>=ae&&Se.y<=he&&Se!==m&&Se!==v&&Wf(E,O,k,G,P,X,Se.x,Se.y)&&Hn(Se.prev,Se,Se.next)>=0||(Se=Se.prevZ,Ce.x>=K&&Ce.x<=oe&&Ce.y>=ae&&Ce.y<=he&&Ce!==m&&Ce!==v&&Wf(E,O,k,G,P,X,Ce.x,Ce.y)&&Hn(Ce.prev,Ce,Ce.next)>=0))return!1;Ce=Ce.nextZ}for(;Se&&Se.z>=be;){if(Se.x>=K&&Se.x<=oe&&Se.y>=ae&&Se.y<=he&&Se!==m&&Se!==v&&Wf(E,O,k,G,P,X,Se.x,Se.y)&&Hn(Se.prev,Se,Se.next)>=0)return!1;Se=Se.prevZ}for(;Ce&&Ce.z<=Ze;){if(Ce.x>=K&&Ce.x<=oe&&Ce.y>=ae&&Ce.y<=he&&Ce!==m&&Ce!==v&&Wf(E,O,k,G,P,X,Ce.x,Ce.y)&&Hn(Ce.prev,Ce,Ce.next)>=0)return!1;Ce=Ce.nextZ}return!0}function i_(a,e){let n=a;do{const h=n.prev,m=n.next.next;!Po(h,m)&&gm(h,n,n.next,m)&&jd(h,m)&&jd(m,h)&&(e.push(h.i,n.i,m.i),uo(n),uo(n.next),n=a=m),n=n.next}while(n!==a);return Th(n)}function Ou(a,e,n,h,m,y){let v=a;do{let E=v.next.next;for(;E!==v.prev;){if(v.i!==E.i&&ai(v,E)){let k=Ud(v,E);return v=Th(v,v.next),k=Th(k,k.next),df(v,e,n,h,m,y,0),void df(k,e,n,h,m,y,0)}E=E.next}v=v.next}while(v!==a)}function Ui(a,e){let n=a.x-e.x;return n===0&&(n=a.y-e.y,n===0)&&(n=(a.next.y-a.y)/(a.next.x-a.x)-(e.next.y-e.y)/(e.next.x-e.x)),n}function pm(a,e){const n=(function(m,y){let v=y;const E=m.x,k=m.y;let P,O=-1/0;if(Po(m,v))return v;do{if(Po(m,v.next))return v.next;if(k<=v.y&&k>=v.next.y&&v.next.y!==v.y){const oe=v.x+(k-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(oe<=E&&oe>O&&(O=oe,P=v.x<v.next.x?v:v.next,oe===E))return P}v=v.next}while(v!==y);if(!P)return null;const G=P,X=P.x,K=P.y;let ae=1/0;v=P;do{if(E>=v.x&&v.x>=X&&E!==v.x&&mm(k<K?E:O,k,X,K,k<K?O:E,k,v.x,v.y)){const oe=Math.abs(k-v.y)/(E-v.x);jd(v,m)&&(oe<ae||oe===ae&&(v.x>P.x||v.x===P.x&&s_(P,v)))&&(P=v,ae=oe)}v=v.next}while(v!==G);return P})(a,e);if(!n)return e;const h=Ud(n,a);return Th(h,h.next),Th(n,n.next)}function s_(a,e){return Hn(a.prev,a,e.prev)<0&&Hn(e.next,a,a.next)<0}function Vi(a,e,n,h,m){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-n)*m|0)|a<<8))|a<<4))|a<<2))|a<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-h)*m|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Gx(a){let e=a,n=a;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==a);return n}function mm(a,e,n,h,m,y,v,E){return(m-v)*(e-E)>=(a-v)*(y-E)&&(a-v)*(h-E)>=(n-v)*(e-E)&&(n-v)*(y-E)>=(m-v)*(h-E)}function Wf(a,e,n,h,m,y,v,E){return!(a===v&&e===E)&&mm(a,e,n,h,m,y,v,E)}function ai(a,e){return a.next.i!==e.i&&a.prev.i!==e.i&&!(function(n,h){let m=n;do{if(m.i!==n.i&&m.next.i!==n.i&&m.i!==h.i&&m.next.i!==h.i&&gm(m,m.next,n,h))return!0;m=m.next}while(m!==n);return!1})(a,e)&&(jd(a,e)&&jd(e,a)&&(function(n,h){let m=n,y=!1;const v=(n.x+h.x)/2,E=(n.y+h.y)/2;do m.y>E!=m.next.y>E&&m.next.y!==m.y&&v<(m.next.x-m.x)*(E-m.y)/(m.next.y-m.y)+m.x&&(y=!y),m=m.next;while(m!==n);return y})(a,e)&&(Hn(a.prev,a,e.prev)||Hn(a,e.prev,e))||Po(a,e)&&Hn(a.prev,a,a.next)>0&&Hn(e.prev,e,e.next)>0)}function Hn(a,e,n){return(e.y-a.y)*(n.x-e.x)-(e.x-a.x)*(n.y-e.y)}function Po(a,e){return a.x===e.x&&a.y===e.y}function gm(a,e,n,h){const m=Nd(Hn(a,e,n)),y=Nd(Hn(a,e,h)),v=Nd(Hn(n,h,a)),E=Nd(Hn(n,h,e));return m!==y&&v!==E||!(m!==0||!Bd(a,n,e))||!(y!==0||!Bd(a,h,e))||!(v!==0||!Bd(n,a,h))||!(E!==0||!Bd(n,e,h))}function Bd(a,e,n){return e.x<=Math.max(a.x,n.x)&&e.x>=Math.min(a.x,n.x)&&e.y<=Math.max(a.y,n.y)&&e.y>=Math.min(a.y,n.y)}function Nd(a){return a>0?1:a<0?-1:0}function jd(a,e){return Hn(a.prev,a,a.next)<0?Hn(a,e,a.next)>=0&&Hn(a,a.prev,e)>=0:Hn(a,e,a.prev)<0||Hn(a,a.next,e)<0}function Ud(a,e){const n=Yp(a.i,a.x,a.y),h=Yp(e.i,e.x,e.y),m=a.next,y=e.prev;return a.next=e,e.prev=a,n.next=m,m.prev=n,h.next=n,n.prev=h,y.next=h,h.prev=y,h}function co(a,e,n,h){const m=Yp(a,e,n);return h?(m.next=h.next,m.prev=h,h.next.prev=m,h.next=m):(m.prev=m,m.next=m),m}function uo(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function Yp(a,e,n){return{i:a,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class ns{constructor(e,n){if(n>e)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=e,this._minGranularity=n}getGranularityForZoomLevel(e){return Math.max(Math.floor(this._baseZoomGranularity/(1<<e)),this._minGranularity,1)}}class Vd{constructor(e){this.fill=e.fill,this.line=e.line,this.tile=e.tile,this.stencil=e.stencil,this.circle=e.circle}}Vd.noSubdivision=new Vd({fill:new ns(0,0),line:new ns(0,0),tile:new ns(0,0),stencil:new ns(0,0),circle:1}),kr("SubdivisionGranularityExpression",ns),kr("SubdivisionGranularitySetting",Vd);const Fo=-32768,wc=32767;class Bu{constructor(e,n){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=e,this._granularityCellSize=Be/e,this._canonical=n}_getKey(e,n){return(e+=32768)<<16|n+32768}_vertexToIndex(e,n){if(e<-32768||n<-32768||e>32767||n>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const h=0|Math.round(e),m=0|Math.round(n),y=this._getKey(h,m);if(this._vertexDictionary.has(y))return this._vertexDictionary.get(y);const v=this._vertexBuffer.length/2;return this._vertexDictionary.set(y,v),this._vertexBuffer.push(h,m),v}_subdivideTrianglesScanline(e){if(this._granularity<2)return(function(m,y){const v=[];for(let E=0;E<y.length;E+=3){const k=y[E],P=y[E+1],O=y[E+2],G=m[2*k],X=m[2*k+1];(m[2*P]-G)*(m[2*O+1]-X)-(m[2*P+1]-X)*(m[2*O]-G)>0?(v.push(k),v.push(O),v.push(P)):(v.push(k),v.push(P),v.push(O))}return v})(this._vertexBuffer,e);const n=[],h=e.length;for(let m=0;m<h;m+=3){const y=[e[m+0],e[m+1],e[m+2]],v=[this._vertexBuffer[2*e[m+0]+0],this._vertexBuffer[2*e[m+0]+1],this._vertexBuffer[2*e[m+1]+0],this._vertexBuffer[2*e[m+1]+1],this._vertexBuffer[2*e[m+2]+0],this._vertexBuffer[2*e[m+2]+1]];let E=1/0,k=1/0,P=-1/0,O=-1/0;for(let oe=0;oe<3;oe++){const he=v[2*oe],be=v[2*oe+1];E=Math.min(E,he),P=Math.max(P,he),k=Math.min(k,be),O=Math.max(O,be)}if(E===P||k===O)continue;const G=Math.floor(E/this._granularityCellSize),X=Math.ceil(P/this._granularityCellSize),K=Math.floor(k/this._granularityCellSize),ae=Math.ceil(O/this._granularityCellSize);if(G!==X||K!==ae)for(let oe=K;oe<ae;oe++){const he=this._scanlineGenerateVertexRingForCellRow(oe,v,y);Tc(this._vertexBuffer,he,n)}else n.push(...y)}return n}_scanlineGenerateVertexRingForCellRow(e,n,h){const m=e*this._granularityCellSize,y=m+this._granularityCellSize,v=[];for(let E=0;E<3;E++){const k=n[2*E],P=n[2*E+1],O=n[2*(E+1)%6],G=n[(2*(E+1)+1)%6],X=n[2*(E+2)%6],K=n[(2*(E+2)+1)%6],ae=O-k,oe=G-P,he=ae===0,be=oe===0,Ze=(m-P)/oe,Se=(y-P)/oe,Ce=Math.min(Ze,Se),Ye=Math.max(Ze,Se);if(!be&&(Ce>=1||Ye<=0)||be&&(P<m||P>y)){G>=m&&G<=y&&v.push(h[(E+1)%3]);continue}!be&&Ce>0&&v.push(this._vertexToIndex(k+ae*Ce,P+oe*Ce));const it=k+ae*Math.max(Ce,0),At=k+ae*Math.min(Ye,1);he||this._generateIntraEdgeVertices(v,k,P,O,G,it,At),!be&&Ye<1&&v.push(this._vertexToIndex(k+ae*Ye,P+oe*Ye)),(be||G>=m&&G<=y)&&v.push(h[(E+1)%3]),!be&&(G<=m||G>=y)&&this._generateInterEdgeVertices(v,k,P,O,G,X,K,At,m,y)}return v}_generateIntraEdgeVertices(e,n,h,m,y,v,E){const k=m-n,P=y-h,O=P===0,G=O?Math.min(n,m):Math.min(v,E),X=O?Math.max(n,m):Math.max(v,E),K=Math.floor(G/this._granularityCellSize)+1,ae=Math.ceil(X/this._granularityCellSize)-1;if(O?n<m:v<E)for(let oe=K;oe<=ae;oe++){const he=oe*this._granularityCellSize;e.push(this._vertexToIndex(he,h+P*(he-n)/k))}else for(let oe=ae;oe>=K;oe--){const he=oe*this._granularityCellSize;e.push(this._vertexToIndex(he,h+P*(he-n)/k))}}_generateInterEdgeVertices(e,n,h,m,y,v,E,k,P,O){const G=y-h,X=v-m,K=E-y,ae=(P-y)/K,oe=(O-y)/K,he=Math.min(ae,oe),be=Math.max(ae,oe),Ze=m+X*he;let Se=Math.floor(Math.min(Ze,k)/this._granularityCellSize)+1,Ce=Math.ceil(Math.max(Ze,k)/this._granularityCellSize)-1,Ye=k<Ze;const it=K===0;if(it&&(E===P||E===O))return;if(it||he>=1||be<=0){const Wt=h-E,Nt=v+(n-v)*Math.min((P-E)/Wt,(O-E)/Wt);Se=Math.floor(Math.min(Nt,k)/this._granularityCellSize)+1,Ce=Math.ceil(Math.max(Nt,k)/this._granularityCellSize)-1,Ye=k<Nt}const At=G>0?O:P;if(Ye)for(let Wt=Se;Wt<=Ce;Wt++)e.push(this._vertexToIndex(Wt*this._granularityCellSize,At));else for(let Wt=Ce;Wt>=Se;Wt--)e.push(this._vertexToIndex(Wt*this._granularityCellSize,At))}_generateOutline(e){const n=[];for(const h of e){const m=Nu(h,this._granularity,!0),y=this._pointArrayToIndices(m),v=[];for(let E=1;E<y.length;E++)v.push(y[E-1]),v.push(y[E]);n.push(v)}return n}_handlePoles(e){let n=!1,h=!1;this._canonical&&(this._canonical.y===0&&(n=!0),this._canonical.y===(1<<this._canonical.z)-1&&(h=!0)),(n||h)&&this._fillPoles(e,n,h)}_ensureNoPoleVertices(){const e=this._vertexBuffer;for(let n=0;n<e.length;n+=2){const h=e[n+1];h===Fo&&(e[n+1]=-32767),h===wc&&(e[n+1]=32766)}}_generatePoleQuad(e,n,h,m,y,v){m>y!=(v===Fo)?(e.push(n),e.push(h),e.push(this._vertexToIndex(m,v)),e.push(h),e.push(this._vertexToIndex(y,v)),e.push(this._vertexToIndex(m,v))):(e.push(h),e.push(n),e.push(this._vertexToIndex(m,v)),e.push(this._vertexToIndex(y,v)),e.push(h),e.push(this._vertexToIndex(m,v)))}_fillPoles(e,n,h){const m=this._vertexBuffer,y=Be,v=e.length;for(let E=2;E<v;E+=3){const k=e[E-2],P=e[E-1],O=e[E],G=m[2*k],X=m[2*k+1],K=m[2*P],ae=m[2*P+1],oe=m[2*O],he=m[2*O+1];n&&(X===0&&ae===0&&this._generatePoleQuad(e,k,P,G,K,Fo),ae===0&&he===0&&this._generatePoleQuad(e,P,O,K,oe,Fo),he===0&&X===0&&this._generatePoleQuad(e,O,k,oe,G,Fo)),h&&(X===y&&ae===y&&this._generatePoleQuad(e,k,P,G,K,wc),ae===y&&he===y&&this._generatePoleQuad(e,P,O,K,oe,wc),he===y&&X===y&&this._generatePoleQuad(e,O,k,oe,G,wc))}}_initializeVertices(e){for(let n=0;n<e.length;n+=2)this._vertexToIndex(e[n],e[n+1])}subdividePolygonInternal(e,n){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:h,holeIndices:m}=(function(E){const k=[],P=[];for(const O of E)if(O.length!==0){O!==E[0]&&k.push(P.length/2);for(let G=0;G<O.length;G++)P.push(O[G].x),P.push(O[G].y)}return{flattened:P,holeIndices:k}})(e);let y;this._initializeVertices(h);try{const E=(function(P,O,G=2){const X=O&&O.length,K=X?O[0]*G:P.length;let ae=$p(P,0,K,G,!0);const oe=[];if(!ae||ae.next===ae.prev)return oe;let he,be,Ze;if(X&&(ae=(function(Se,Ce,Ye,it){const At=[];for(let Wt=0,Nt=Ce.length;Wt<Nt;Wt++){const rr=$p(Se,Ce[Wt]*it,Wt<Nt-1?Ce[Wt+1]*it:Se.length,it,!1);rr===rr.next&&(rr.steiner=!0),At.push(Gx(rr))}At.sort(Ui);for(let Wt=0;Wt<At.length;Wt++)Ye=pm(At[Wt],Ye);return Ye})(P,O,ae,G)),P.length>80*G){he=P[0],be=P[1];let Se=he,Ce=be;for(let Ye=G;Ye<K;Ye+=G){const it=P[Ye],At=P[Ye+1];it<he&&(he=it),At<be&&(be=At),it>Se&&(Se=it),At>Ce&&(Ce=At)}Ze=Math.max(Se-he,Ce-be),Ze=Ze!==0?32767/Ze:0}return df(ae,oe,G,he,be,Ze,0),oe})(h,m),k=this._convertIndices(h,E);y=this._subdivideTrianglesScanline(k)}catch(E){console.error(E)}let v=[];return n&&(v=this._generateOutline(e)),this._ensureNoPoleVertices(),this._handlePoles(y),{verticesFlattened:this._vertexBuffer,indicesTriangles:y,indicesLineList:v}}_convertIndices(e,n){const h=[];for(let m=0;m<n.length;m++)h.push(this._vertexToIndex(e[2*n[m]],e[2*n[m]+1]));return h}_pointArrayToIndices(e){const n=[];for(let h=0;h<e.length;h++){const m=e[h];n.push(this._vertexToIndex(m.x,m.y))}return n}}function Kp(a,e,n,h=!0){return new Bu(n,e).subdividePolygonInternal(a,h)}function Nu(a,e,n=!1){if(!a||a.length<1)return[];if(a.length<2)return[];const h=a[0],m=a[a.length-1],y=n&&(h.x!==m.x||h.y!==m.y);if(e<2)return y?[...a,a[0]]:[...a];const v=Math.floor(Be/e),E=[];E.push(new C(a[0].x,a[0].y));const k=a.length,P=y?k:k-1;for(let O=0;O<P;O++){const G=a[O],X=O<k-1?a[O+1]:a[0],K=G.x,ae=G.y,oe=X.x,he=X.y,be=K!==oe,Ze=ae!==he;if(!be&&!Ze)continue;const Se=oe-K,Ce=he-ae,Ye=Math.abs(Se),it=Math.abs(Ce);let At=K,Wt=ae;for(;;){const rr=Se>0?(Math.floor(At/v)+1)*v:(Math.ceil(At/v)-1)*v,wr=Ce>0?(Math.floor(Wt/v)+1)*v:(Math.ceil(Wt/v)-1)*v,ar=Math.abs(At-rr),qt=Math.abs(Wt-wr),Lt=Math.abs(At-oe),Pr=Math.abs(Wt-he),Cr=be?ar/Ye:Number.POSITIVE_INFINITY,zr=Ze?qt/it:Number.POSITIVE_INFINITY;if((Lt<=ar||!be)&&(Pr<=qt||!Ze))break;if(Cr<zr&&be||!Ze){At=rr,Wt+=Ce*Cr;const Er=new C(At,Math.round(Wt));E[E.length-1].x===Er.x&&E[E.length-1].y===Er.y||E.push(Er)}else{At+=Se*zr,Wt=wr;const Er=new C(Math.round(At),Wt);E[E.length-1].x===Er.x&&E[E.length-1].y===Er.y||E.push(Er)}}const Nt=new C(oe,he);E[E.length-1].x===Nt.x&&E[E.length-1].y===Nt.y||E.push(Nt)}return E}function Tc(a,e,n){if(e.length===0)throw new Error("Subdivision vertex ring is empty.");let h=0,m=a[2*e[0]];for(let k=1;k<e.length;k++){const P=a[2*e[k]];P<m&&(m=P,h=k)}const y=e.length;let v=h,E=(v+1)%y;for(;;){const k=v-1>=0?v-1:y-1,P=(E+1)%y,O=a[2*e[k]],G=a[2*e[P]],X=a[2*e[v]],K=a[2*e[v]+1],ae=a[2*e[E]+1];let oe=!1;if(O<G)oe=!0;else if(O>G)oe=!1;else{const he=ae-K,be=-(a[2*e[E]]-X),Ze=K<ae?1:-1;((O-X)*he+(a[2*e[k]+1]-K)*be)*Ze>((G-X)*he+(a[2*e[P]+1]-K)*be)*Ze&&(oe=!0)}if(oe){const he=e[k],be=e[v],Ze=e[E];he!==be&&he!==Ze&&be!==Ze&&n.push(Ze,be,he),v--,v<0&&(v=y-1)}else{const he=e[P],be=e[v],Ze=e[E];he!==be&&he!==Ze&&be!==Ze&&n.push(Ze,be,he),E++,E>=y&&(E=0)}if(k===P)break}}function _m(a,e,n,h,m,y,v,E,k){const P=m.length/2,O=v&&E&&k;if(P<br.MAX_VERTEX_ARRAY_LENGTH){const G=e.prepareSegment(P,n,h),X=G.vertexLength;for(let oe=0;oe<y.length;oe+=3)h.emplaceBack(X+y[oe],X+y[oe+1],X+y[oe+2]);let K,ae;G.vertexLength+=P,G.primitiveLength+=y.length/3,O&&(ae=v.prepareSegment(P,n,E),K=ae.vertexLength,ae.vertexLength+=P);for(let oe=0;oe<m.length;oe+=2)a(m[oe],m[oe+1]);if(O)for(let oe=0;oe<k.length;oe++){const he=k[oe];for(let be=1;be<he.length;be+=2)E.emplaceBack(K+he[be-1],K+he[be]);ae.primitiveLength+=he.length/2}}else(function(G,X,K,ae,oe,he){const be=[];for(let it=0;it<ae.length/2;it++)be.push(-1);const Ze={count:0};let Se=0,Ce=G.getOrCreateLatestSegment(X,K),Ye=Ce.vertexLength;for(let it=2;it<oe.length;it+=3){const At=oe[it-2],Wt=oe[it-1],Nt=oe[it];let rr=be[At]<Se,wr=be[Wt]<Se,ar=be[Nt]<Se;Ce.vertexLength+((rr?1:0)+(wr?1:0)+(ar?1:0))>br.MAX_VERTEX_ARRAY_LENGTH&&(Ce=G.createNewSegment(X,K),Se=Ze.count,rr=!0,wr=!0,ar=!0,Ye=0);const qt=eu(be,ae,he,Ze,At,rr,Ce),Lt=eu(be,ae,he,Ze,Wt,wr,Ce),Pr=eu(be,ae,he,Ze,Nt,ar,Ce);K.emplaceBack(Ye+qt-Se,Ye+Lt-Se,Ye+Pr-Se),Ce.primitiveLength++}})(e,n,h,m,y,a),O&&(function(G,X,K,ae,oe,he){const be=[];for(let it=0;it<ae.length/2;it++)be.push(-1);const Ze={count:0};let Se=0,Ce=G.getOrCreateLatestSegment(X,K),Ye=Ce.vertexLength;for(let it=0;it<oe.length;it++){const At=oe[it];for(let Wt=1;Wt<oe[it].length;Wt+=2){const Nt=At[Wt-1],rr=At[Wt];let wr=be[Nt]<Se,ar=be[rr]<Se;Ce.vertexLength+((wr?1:0)+(ar?1:0))>br.MAX_VERTEX_ARRAY_LENGTH&&(Ce=G.createNewSegment(X,K),Se=Ze.count,wr=!0,ar=!0,Ye=0);const qt=eu(be,ae,he,Ze,Nt,wr,Ce),Lt=eu(be,ae,he,Ze,rr,ar,Ce);K.emplaceBack(Ye+qt-Se,Ye+Lt-Se),Ce.primitiveLength++}}})(v,n,E,m,k,a),e.forceNewSegmentOnNextPrepare(),v?.forceNewSegmentOnNextPrepare()}function eu(a,e,n,h,m,y,v){if(y){const E=h.count;return n(e[2*m],e[2*m+1]),a[m]=h.count,h.count++,v.vertexLength++,E}return a[m]}class pf{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((n=>n.id)),this.index=e.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new Le,this.indexArray=new Dt,this.indexArray2=new ur,this.programConfigurations=new Xc(e.layers,e.zoom),this.segments=new br,this.segments2=new br,this.stateDependentLayerIds=this.layers.filter((n=>n.isStateDependent())).map((n=>n.id))}populate(e,n,h){this.hasDependencies=pl("fill",this.layers,n);const m=this.layers[0].layout.get("fill-sort-key"),y=!m.isConstant(),v=[];for(const{feature:E,id:k,index:P,sourceLayerIndex:O}of e){const G=this.layers[0]._featureFilter.needGeometry,X=dl(E,G);if(!this.layers[0]._featureFilter.filter(new Jn(this.zoom),X,h))continue;const K=y?m.evaluate(X,{},h,n.availableImages):void 0,ae={id:k,properties:E.properties,type:E.type,sourceLayerIndex:O,index:P,geometry:G?X.geometry:bc(E),patterns:{},sortKey:K};v.push(ae)}y&&v.sort(((E,k)=>E.sortKey-k.sortKey));for(const E of v){const{geometry:k,index:P,sourceLayerIndex:O}=E;if(this.hasDependencies){const G=Wp("fill",this.layers,E,{zoom:this.zoom},n);this.patternFeatures.push(G)}else this.addFeature(E,k,P,h,{},n.subdivisionGranularity);n.featureIndex.insert(e[P].feature,k,P,O,this.index)}}update(e,n,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,{imagePositions:h})}addFeatures(e,n,h){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,n,h,e.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Od),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,n,h,m,y,v){for(const E of Oc(n,500)){const k=Kp(E,m,v.fill.getGranularityForZoomLevel(m.z)),P=this.layoutVertexArray;_m(((O,G)=>{P.emplaceBack(O,G)}),this.segments,this.layoutVertexArray,this.indexArray,k.verticesFlattened,k.indicesTriangles,this.segments2,this.indexArray2,k.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,h,{imagePositions:y,canonical:m})}}let $f,mf;kr("FillBucket",pf,{omit:["layers","patternFeatures"]});var o_={get paint(){return mf=mf||new ni({"fill-antialias":new Rr(xt.paint_fill["fill-antialias"]),"fill-opacity":new Br(xt.paint_fill["fill-opacity"]),"fill-color":new Br(xt.paint_fill["fill-color"]),"fill-outline-color":new Br(xt.paint_fill["fill-outline-color"]),"fill-translate":new Rr(xt.paint_fill["fill-translate"]),"fill-translate-anchor":new Rr(xt.paint_fill["fill-translate-anchor"]),"fill-pattern":new Mo(xt.paint_fill["fill-pattern"])})},get layout(){return $f=$f||new ni({"fill-sort-key":new Br(xt.layout_fill["fill-sort-key"])})}};class l_ extends ja{constructor(e,n){super(e,o_,n)}recalculate(e,n){super.recalculate(e,n);const h=this.paint._values["fill-outline-color"];h.value.kind==="constant"&&h.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new pf(e)}queryRadius(){return Dd(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:e,geometry:n,transform:h,pixelsToTileUnits:m}){return Op(Np(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-h.bearingInRadians,m),n)}isTileClipped(){return!0}}const Gd=Ia([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),c_=Ia([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Jp}=Gd;class Xf{constructor(e,n,h,m,y){this.properties={},this.extent=h,this.type=0,this.id=void 0,this._pbf=e,this._geometry=-1,this._keys=m,this._values=y,e.readFields(Hx,this,n)}loadGeometry(){const e=this._pbf;e.pos=this._geometry;const n=e.readVarint()+e.pos,h=[];let m,y=1,v=0,E=0,k=0;for(;e.pos<n;){if(v<=0){const P=e.readVarint();y=7&P,v=P>>3}if(v--,y===1||y===2)E+=e.readSVarint(),k+=e.readSVarint(),y===1&&(m&&h.push(m),m=[]),m&&m.push(new C(E,k));else{if(y!==7)throw new Error(`unknown command ${y}`);m&&m.push(m[0].clone())}}return m&&h.push(m),h}bbox(){const e=this._pbf;e.pos=this._geometry;const n=e.readVarint()+e.pos;let h=1,m=0,y=0,v=0,E=1/0,k=-1/0,P=1/0,O=-1/0;for(;e.pos<n;){if(m<=0){const G=e.readVarint();h=7&G,m=G>>3}if(m--,h===1||h===2)y+=e.readSVarint(),v+=e.readSVarint(),y<E&&(E=y),y>k&&(k=y),v<P&&(P=v),v>O&&(O=v);else if(h!==7)throw new Error(`unknown command ${h}`)}return[E,P,k,O]}toGeoJSON(e,n,h){const m=this.extent*Math.pow(2,h),y=this.extent*e,v=this.extent*n,E=this.loadGeometry();function k(X){return[360*(X.x+y)/m-180,360/Math.PI*Math.atan(Math.exp((1-2*(X.y+v)/m)*Math.PI))-90]}function P(X){return X.map(k)}let O;if(this.type===1){const X=[];for(const ae of E)X.push(ae[0]);const K=P(X);O=X.length===1?{type:"Point",coordinates:K[0]}:{type:"MultiPoint",coordinates:K}}else if(this.type===2){const X=E.map(P);O=X.length===1?{type:"LineString",coordinates:X[0]}:{type:"MultiLineString",coordinates:X}}else{if(this.type!==3)throw new Error("unknown feature type");{const X=u_(E),K=[];for(const ae of X)K.push(ae.map(P));O=K.length===1?{type:"Polygon",coordinates:K[0]}:{type:"MultiPolygon",coordinates:K}}}const G={type:"Feature",geometry:O,properties:this.properties};return this.id!=null&&(G.id=this.id),G}}function Hx(a,e,n){a===1?e.id=n.readVarint():a===2?(function(h,m){const y=h.readVarint()+h.pos;for(;h.pos<y;){const v=m._keys[h.readVarint()],E=m._values[h.readVarint()];m.properties[v]=E}})(n,e):a===3?e.type=n.readVarint():a===4&&(e._geometry=n.pos)}function u_(a){const e=a.length;if(e<=1)return[a];const n=[];let h,m;for(let y=0;y<e;y++){const v=fa(a[y]);v!==0&&(m===void 0&&(m=v<0),m===v<0?(h&&n.push(h),h=[a[y]]):h&&h.push(a[y]))}return h&&n.push(h),n}function fa(a){let e=0;for(let n,h,m=0,y=a.length,v=y-1;m<y;v=m++)n=a[m],h=a[v],e+=(h.x-n.x)*(n.y+h.y);return e}Xf.types=["Unknown","Point","LineString","Polygon"];class Fa{constructor(e,n){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Nn,this,n),this.length=this._features.length}feature(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];const n=this._pbf.readVarint()+this._pbf.pos;return new Xf(this._pbf,n,this.extent,this._keys,this._values)}}function Nn(a,e,n){a===15?e.version=n.readVarint():a===1?e.name=n.readString():a===5?e.extent=n.readVarint():a===2?e._features.push(n.pos):a===3?e._keys.push(n.readString()):a===4&&e._values.push((function(h){let m=null;const y=h.readVarint()+h.pos;for(;h.pos<y;){const v=h.readVarint()>>3;m=v===1?h.readString():v===2?h.readFloat():v===3?h.readDouble():v===4?h.readVarint64():v===5?h.readVarint():v===6?h.readSVarint():v===7?h.readBoolean():null}if(m==null)throw new Error("unknown feature value");return m})(n))}class jn{constructor(e,n){this.layers=e.readFields(Sa,{},n)}}function Sa(a,e,n){if(a===3){const h=new Fa(n,n.readVarint()+n.pos);h.length&&(e[h.name]=h)}}const ho=Math.pow(2,13);function Wl(a,e,n,h,m,y,v,E){a.emplaceBack(e,n,2*Math.floor(h*ho)+v,m*ho*2,y*ho*2,Math.round(E))}class Sh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((n=>n.id)),this.index=e.index,this.hasDependencies=!1,this.layoutVertexArray=new qe,this.centroidVertexArray=new Ie,this.indexArray=new Dt,this.programConfigurations=new Xc(e.layers,e.zoom),this.segments=new br,this.stateDependentLayerIds=this.layers.filter((n=>n.isStateDependent())).map((n=>n.id))}populate(e,n,h){this.features=[],this.hasDependencies=pl("fill-extrusion",this.layers,n);for(const{feature:m,id:y,index:v,sourceLayerIndex:E}of e){const k=this.layers[0]._featureFilter.needGeometry,P=dl(m,k);if(!this.layers[0]._featureFilter.filter(new Jn(this.zoom),P,h))continue;const O={id:y,sourceLayerIndex:E,index:v,geometry:k?P.geometry:bc(m),properties:m.properties,type:m.type,patterns:{}};this.hasDependencies?this.features.push(Wp("fill-extrusion",this.layers,O,{zoom:this.zoom},n)):this.addFeature(O,O.geometry,v,h,{},n.subdivisionGranularity),n.featureIndex.insert(m,O.geometry,v,E,this.index,!0)}}addFeatures(e,n,h){for(const m of this.features){const{geometry:y}=m;this.addFeature(m,y,m.index,n,h,e.subdivisionGranularity)}}update(e,n,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,{imagePositions:h})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Jp),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,c_.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,n,h,m,y,v){for(const E of Oc(n,500)){const k={x:0,y:0,sampleCount:0},P=this.layoutVertexArray.length;this.processPolygon(k,m,e,E,v);const O=this.layoutVertexArray.length-P,G=Math.floor(k.x/k.sampleCount),X=Math.floor(k.y/k.sampleCount);for(let K=0;K<O;K++)this.centroidVertexArray.emplaceBack(G,X)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,h,{imagePositions:y,canonical:m})}processPolygon(e,n,h,m,y){if(m.length<1||fi(m[0]))return;for(const G of m)G.length!==0&&xm(e,G);const v={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},E=y.fill.getGranularityForZoomLevel(n.z),k=Xf.types[h.type]==="Polygon";for(const G of m){if(G.length===0||fi(G))continue;const X=Nu(G,E,k);this._generateSideFaces(X,v)}if(!k)return;const P=Kp(m,n,E,!1),O=this.layoutVertexArray;_m(((G,X)=>{Wl(O,G,X,0,0,1,1,0)}),this.segments,this.layoutVertexArray,this.indexArray,P.verticesFlattened,P.indicesTriangles)}_generateSideFaces(e,n){let h=0;for(let m=1;m<e.length;m++){const y=e[m],v=e[m-1];if(ju(y,v))continue;n.segment.vertexLength+4>br.MAX_VERTEX_ARRAY_LENGTH&&(n.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const E=y.sub(v)._perp()._unit(),k=v.dist(y);h+k>32768&&(h=0),Wl(this.layoutVertexArray,y.x,y.y,E.x,E.y,0,0,h),Wl(this.layoutVertexArray,y.x,y.y,E.x,E.y,0,1,h),h+=k,Wl(this.layoutVertexArray,v.x,v.y,E.x,E.y,0,0,h),Wl(this.layoutVertexArray,v.x,v.y,E.x,E.y,0,1,h);const P=n.segment.vertexLength;this.indexArray.emplaceBack(P,P+2,P+1),this.indexArray.emplaceBack(P+1,P+2,P+3),n.segment.vertexLength+=4,n.segment.primitiveLength+=2}}}function xm(a,e){for(let n=0;n<e.length;n++){const h=e[n];n===e.length-1&&e[0].x===h.x&&e[0].y===h.y||(a.x+=h.x,a.y+=h.y,a.sampleCount++)}}function ju(a,e){return a.x===e.x&&(a.x<0||a.x>Be)||a.y===e.y&&(a.y<0||a.y>Be)}function fi(a){return a.every((e=>e.x<0))||a.every((e=>e.x>Be))||a.every((e=>e.y<0))||a.every((e=>e.y>Be))}let Uu;kr("FillExtrusionBucket",Sh,{omit:["layers","features"]});var gf={get paint(){return Uu=Uu||new ni({"fill-extrusion-opacity":new Rr(xt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Br(xt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Rr(xt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Rr(xt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Mo(xt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Br(xt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Br(xt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Rr(xt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class ym extends ja{constructor(e,n){super(e,gf,n)}createBucket(e){return new Sh(e)}queryRadius(){return Dd(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:e,feature:n,featureState:h,geometry:m,transform:y,pixelsToTileUnits:v,pixelPosMatrix:E}){const k=Np(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-y.bearingInRadians,v),P=this.paint.get("fill-extrusion-height").evaluate(n,h),O=this.paint.get("fill-extrusion-base").evaluate(n,h),G=(function(K,ae){const oe=[];for(const he of K){const be=[he.x,he.y,0,1];le(be,be,ae),oe.push(new C(be[0]/be[3],be[1]/be[3]))}return oe})(k,E),X=(function(K,ae,oe,he){const be=[],Ze=[],Se=he[8]*ae,Ce=he[9]*ae,Ye=he[10]*ae,it=he[11]*ae,At=he[8]*oe,Wt=he[9]*oe,Nt=he[10]*oe,rr=he[11]*oe;for(const wr of K){const ar=[],qt=[];for(const Lt of wr){const Pr=Lt.x,Cr=Lt.y,zr=he[0]*Pr+he[4]*Cr+he[12],Er=he[1]*Pr+he[5]*Cr+he[13],Zr=he[2]*Pr+he[6]*Cr+he[14],qn=he[3]*Pr+he[7]*Cr+he[15],Mn=Zr+Ye,ei=qn+it,Ws=zr+At,Zi=Er+Wt,ti=Zr+Nt,Va=qn+rr,ia=new C((zr+Se)/ei,(Er+Ce)/ei);ia.z=Mn/ei,ar.push(ia);const di=new C(Ws/Va,Zi/Va);di.z=ti/Va,qt.push(di)}be.push(ar),Ze.push(qt)}return[be,Ze]})(m,O,P,E);return(function(K,ae,oe){let he=1/0;Op(oe,ae)&&(he=_f(oe,ae[0]));for(let be=0;be<ae.length;be++){const Ze=ae[be],Se=K[be];for(let Ce=0;Ce<Ze.length-1;Ce++){const Ye=Ze[Ce],it=[Ye,Ze[Ce+1],Se[Ce+1],Se[Ce],Ye];ff(oe,it)&&(he=Math.min(he,_f(oe,it)))}}return he!==1/0&&he})(X[0],X[1],G)}}function Es(a,e){return a.x*e.x+a.y*e.y}function _f(a,e){if(a.length===1){let n=0;const h=e[n++];let m;for(;!m||h.equals(m);)if(m=e[n++],!m)return 1/0;for(;n<e.length;n++){const y=e[n],v=a[0],E=m.sub(h),k=y.sub(h),P=v.sub(h),O=Es(E,E),G=Es(E,k),X=Es(k,k),K=Es(P,E),ae=Es(P,k),oe=O*X-G*G,he=(X*K-G*ae)/oe,be=(O*ae-G*K)/oe,Ze=h.z*(1-he-be)+m.z*he+y.z*be;if(isFinite(Ze))return Ze}return 1/0}{let n=1/0;for(const h of e)n=Math.min(n,h.z);return n}}const Hd=Ia([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Lo}=Hd,vm=Ia([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Qp}=vm,h_=Math.cos(Math.PI/180*37.5),qd=Math.pow(2,14)/.5;class Yf{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((n=>n.id)),this.index=e.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((n=>{this.gradients[n.id]={}})),this.layoutVertexArray=new nt,this.layoutVertexArray2=new He,this.indexArray=new Dt,this.programConfigurations=new Xc(e.layers,e.zoom),this.segments=new br,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((n=>n.isStateDependent())).map((n=>n.id))}populate(e,n,h){this.hasDependencies=pl("line",this.layers,n)||this.hasLineDasharray(this.layers);const m=this.layers[0].layout.get("line-sort-key"),y=!m.isConstant(),v=[];for(const{feature:E,id:k,index:P,sourceLayerIndex:O}of e){const G=this.layers[0]._featureFilter.needGeometry,X=dl(E,G);if(!this.layers[0]._featureFilter.filter(new Jn(this.zoom),X,h))continue;const K=y?m.evaluate(X,{},h):void 0,ae={id:k,properties:E.properties,type:E.type,sourceLayerIndex:O,index:P,geometry:G?X.geometry:bc(E),patterns:{},dashes:{},sortKey:K};v.push(ae)}y&&v.sort(((E,k)=>E.sortKey-k.sortKey));for(const E of v){const{geometry:k,index:P,sourceLayerIndex:O}=E;this.hasDependencies?(pl("line",this.layers,n)?Wp("line",this.layers,E,{zoom:this.zoom},n):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,E,this.zoom,n),this.patternFeatures.push(E)):this.addFeature(E,k,P,h,{},{},n.subdivisionGranularity),n.featureIndex.insert(e[P].feature,k,P,O,this.index)}}update(e,n,h,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,{imagePositions:h,dashPositions:m})}addFeatures(e,n,h,m){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,n,h,m,e.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Qp)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Lo),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,n,h,m,y,v,E){const k=this.layers[0].layout,P=k.get("line-join").evaluate(e,{}),O=k.get("line-cap"),G=k.get("line-miter-limit"),X=k.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const K of n)this.addLine(K,e,P,O,G,X,m,E);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,h,{imagePositions:y,dashPositions:v,canonical:m})}addLine(e,n,h,m,y,v,E,k){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,e=Nu(e,E?k.line.getGranularityForZoomLevel(E.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Se=0;Se<e.length-1;Se++)this.totalDistance+=e[Se].dist(e[Se+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const P=Xf.types[n.type]==="Polygon";let O=e.length;for(;O>=2&&e[O-1].equals(e[O-2]);)O--;let G=0;for(;G<O-1&&e[G].equals(e[G+1]);)G++;if(O<(P?3:2))return;h==="bevel"&&(y=1.05);const X=this.overscaling<=16?122880/(512*this.overscaling):0,K=this.segments.prepareSegment(10*O,this.layoutVertexArray,this.indexArray);let ae,oe,he,be,Ze;this.e1=this.e2=-1,P&&(ae=e[O-2],Ze=e[G].sub(ae)._unit()._perp());for(let Se=G;Se<O;Se++){if(he=Se===O-1?P?e[G+1]:void 0:e[Se+1],he&&e[Se].equals(he))continue;Ze&&(be=Ze),ae&&(oe=ae),ae=e[Se],Ze=he?he.sub(ae)._unit()._perp():be,be=be||Ze;let Ce=be.add(Ze);Ce.x===0&&Ce.y===0||Ce._unit();const Ye=be.x*Ze.x+be.y*Ze.y,it=Ce.x*Ze.x+Ce.y*Ze.y,At=it!==0?1/it:1/0,Wt=2*Math.sqrt(2-2*it),Nt=it<h_&&oe&&he,rr=be.x*Ze.y-be.y*Ze.x>0;if(Nt&&Se>G){const qt=ae.dist(oe);if(qt>2*X){const Lt=ae.sub(ae.sub(oe)._mult(X/qt)._round());this.updateDistance(oe,Lt),this.addCurrentVertex(Lt,be,0,0,K),oe=Lt}}const wr=oe&&he;let ar=wr?h:P?"butt":m;if(wr&&ar==="round"&&(At<v?ar="miter":At<=2&&(ar="fakeround")),ar==="miter"&&At>y&&(ar="bevel"),ar==="bevel"&&(At>2&&(ar="flipbevel"),At<y&&(ar="miter")),oe&&this.updateDistance(oe,ae),ar==="miter")Ce._mult(At),this.addCurrentVertex(ae,Ce,0,0,K);else if(ar==="flipbevel"){if(At>100)Ce=Ze.mult(-1);else{const qt=At*be.add(Ze).mag()/be.sub(Ze).mag();Ce._perp()._mult(qt*(rr?-1:1))}this.addCurrentVertex(ae,Ce,0,0,K),this.addCurrentVertex(ae,Ce.mult(-1),0,0,K)}else if(ar==="bevel"||ar==="fakeround"){const qt=-Math.sqrt(At*At-1),Lt=rr?qt:0,Pr=rr?0:qt;if(oe&&this.addCurrentVertex(ae,be,Lt,Pr,K),ar==="fakeround"){const Cr=Math.round(180*Wt/Math.PI/20);for(let zr=1;zr<Cr;zr++){let Er=zr/Cr;if(Er!==.5){const qn=Er-.5;Er+=Er*qn*(Er-1)*((1.0904+Ye*(Ye*(3.55645-1.43519*Ye)-3.2452))*qn*qn+(.848013+Ye*(.215638*Ye-1.06021)))}const Zr=Ze.sub(be)._mult(Er)._add(be)._unit()._mult(rr?-1:1);this.addHalfVertex(ae,Zr.x,Zr.y,!1,rr,0,K)}}he&&this.addCurrentVertex(ae,Ze,-Lt,-Pr,K)}else if(ar==="butt")this.addCurrentVertex(ae,Ce,0,0,K);else if(ar==="square"){const qt=oe?1:-1;this.addCurrentVertex(ae,Ce,qt,qt,K)}else ar==="round"&&(oe&&(this.addCurrentVertex(ae,be,0,0,K),this.addCurrentVertex(ae,be,1,1,K,!0)),he&&(this.addCurrentVertex(ae,Ze,-1,-1,K,!0),this.addCurrentVertex(ae,Ze,0,0,K)));if(Nt&&Se<O-1){const qt=ae.dist(he);if(qt>2*X){const Lt=ae.add(he.sub(ae)._mult(X/qt)._round());this.updateDistance(ae,Lt),this.addCurrentVertex(Lt,Ze,0,0,K),ae=Lt}}}}addCurrentVertex(e,n,h,m,y,v=!1){const E=n.y*m-n.x,k=-n.y-n.x*m;this.addHalfVertex(e,n.x+n.y*h,n.y-n.x*h,v,!1,h,y),this.addHalfVertex(e,E,k,v,!0,-m,y),this.distance>qd/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,n,h,m,y,v))}addHalfVertex({x:e,y:n},h,m,y,v,E,k){const P=.5*(this.lineClips?this.scaledDistance*(qd-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(y?1:0),(n<<1)+(v?1:0),Math.round(63*h)+128,Math.round(63*m)+128,1+(E===0?0:E<0?-1:1)|(63&P)<<2,P>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const O=k.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,O,this.e2),k.primitiveLength++),v?this.e2=O:this.e1=O}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,n){this.distance+=e.dist(n),this.updateScaledDistance()}hasLineDasharray(e){for(const n of e){const h=n.paint.get("line-dasharray");if(h&&!h.isConstant())return!0}return!1}addLineDashDependencies(e,n,h,m){for(const y of e){const v=y.paint.get("line-dasharray");if(!v||v.value.kind==="constant")continue;const E=y.layout.get("line-cap")==="round",k={dasharray:v.value.evaluate({zoom:h-1},n,{}),round:E},P={dasharray:v.value.evaluate({zoom:h},n,{}),round:E},O={dasharray:v.value.evaluate({zoom:h+1},n,{}),round:E},G=`${k.dasharray.join(",")},${k.round}`,X=`${P.dasharray.join(",")},${P.round}`,K=`${O.dasharray.join(",")},${O.round}`;m.dashDependencies[G]=k,m.dashDependencies[X]=P,m.dashDependencies[K]=O,n.dashes[y.id]={min:G,mid:X,max:K}}}}let Vu,Gi;kr("LineBucket",Yf,{omit:["layers","patternFeatures"]});var Gu={get paint(){return Gi=Gi||new ni({"line-opacity":new Br(xt.paint_line["line-opacity"]),"line-color":new Br(xt.paint_line["line-color"]),"line-translate":new Rr(xt.paint_line["line-translate"]),"line-translate-anchor":new Rr(xt.paint_line["line-translate-anchor"]),"line-width":new Br(xt.paint_line["line-width"]),"line-gap-width":new Br(xt.paint_line["line-gap-width"]),"line-offset":new Br(xt.paint_line["line-offset"]),"line-blur":new Br(xt.paint_line["line-blur"]),"line-dasharray":new Mo(xt.paint_line["line-dasharray"]),"line-pattern":new Mo(xt.paint_line["line-pattern"]),"line-gradient":new af(xt.paint_line["line-gradient"])})},get layout(){return Vu=Vu||new ni({"line-cap":new Rr(xt.layout_line["line-cap"]),"line-join":new Br(xt.layout_line["line-join"]),"line-miter-limit":new Rr(xt.layout_line["line-miter-limit"]),"line-round-limit":new Rr(xt.layout_line["line-round-limit"]),"line-sort-key":new Br(xt.layout_line["line-sort-key"])})}};class Kf extends Br{possiblyEvaluate(e,n){return n=new Jn(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,zoomHistory:n.zoomHistory,transition:n.transition}),super.possiblyEvaluate(e,n)}evaluate(e,n,h,m){return n=Zt({},n,{zoom:Math.floor(n.zoom)}),super.evaluate(e,n,h,m)}}let $l;class bm extends ja{constructor(e,n){super(e,Gu,n),this.gradientVersion=0,$l||($l=new Kf(Gu.paint.properties["line-width"].specification),$l.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if(e==="line-gradient"){const n=this.gradientExpression();this.stepInterpolant=!!(function(h){return h._styleExpression!==void 0})(n)&&n._styleExpression.expression instanceof Ji,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,n){super.recalculate(e,n),this.paint._values["line-floorwidth"]=$l.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new Yf(e)}queryRadius(e){const n=e,h=e0(Lu("line-width",this,n),Lu("line-gap-width",this,n)),m=Lu("line-offset",this,n);return h/2+Math.abs(m)+Dd(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:e,feature:n,featureState:h,geometry:m,transform:y,pixelsToTileUnits:v}){const E=Np(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-y.bearingInRadians,v),k=v/2*e0(this.paint.get("line-width").evaluate(n,h),this.paint.get("line-gap-width").evaluate(n,h)),P=this.paint.get("line-offset").evaluate(n,h);return P&&(m=(function(O,G){const X=[];for(let K=0;K<O.length;K++){const ae=jp(O[K]),oe=[];for(let he=0;he<ae.length;he++){const be=ae[he],Ze=ae[he-1],Se=ae[he+1],Ce=he===0?new C(0,0):be.sub(Ze)._unit()._perp(),Ye=he===ae.length-1?new C(0,0):Se.sub(be)._unit()._perp(),it=Ce._add(Ye)._unit(),At=it.x*Ye.x+it.y*Ye.y;At!==0&&it._mult(1/At),oe.push(it._mult(G)._add(be))}X.push(oe)}return X})(m,P*v)),(function(O,G,X){for(let K=0;K<G.length;K++){const ae=G[K];if(O.length>=3){for(let oe=0;oe<ae.length;oe++)if(Kc(O,ae[oe]))return!0}if(ji(O,ae,X))return!0}return!1})(E,m,k)}isTileClipped(){return!0}}function e0(a,e){return e>0?e+2*a:a}const f_=Ia([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Zd=Ia([{name:"a_projected_pos",components:3,type:"Float32"}],4);Ia([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const wm=Ia([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Ia([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const zo=Ia([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),d_=Ia([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Oo(a,e,n){return a.sections.forEach((h=>{h.text=(function(m,y,v){const E=y.layout.get("text-transform").evaluate(v,{});return E==="uppercase"?m=m.toLocaleUpperCase():E==="lowercase"&&(m=m.toLocaleLowerCase()),Co.applyArabicShaping&&(m=Co.applyArabicShaping(m)),m})(h.text,e,n)})),a}Ia([{name:"triangle",components:3,type:"Uint16"}]),Ia([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Ia([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Ia([{type:"Float32",name:"offsetX"}]),Ia([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Ia([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);var Mi=24;const Jf={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},qx={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Eh={40:!0};function Wd(a,e,n,h,m,y){if("fontStack"in e){const v=n[e.fontStack],E=v&&v[a];return E?E.metrics.advance*e.scale+m:0}{const v=h[e.imageName];return v?v.displaySize[0]*e.scale*Mi/y+m:0}}function t0(a,e,n,h){const m=Math.pow(a-e,2);return h?a<e?m/2:2*m:m+Math.abs(n)*n}function Qf(a,e,n){let h=0;return a===10&&(h-=1e4),n&&(h+=150),a!==40&&a!==65288||(h+=50),e!==41&&e!==65289||(h+=50),h}function Tm(a,e,n,h,m,y){let v=null,E=t0(e,n,m,y);for(const k of h){const P=t0(e-k.x,n,m,y)+k.badness;P<=E&&(v=k,E=P)}return{index:a,x:e,priorBreak:v,badness:E}}function Sm(a){return a?Sm(a.priorBreak).concat(a.index):[]}class xf{constructor(e="",n=[],h=[]){this.text=e,this.sections=n,this.sectionIndex=h,this.imageSectionID=null}static fromFeature(e,n){const h=new xf;for(let m=0;m<e.sections.length;m++){const y=e.sections[m];y.image?h.addImageSection(y):h.addTextSection(y,n)}return h}length(){return[...this.text].length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}verticalizePunctuation(){this.text=(function(e){let n="",h={premature:!0,value:void 0};const m=e[Symbol.iterator]();let y=m.next();const v=e[Symbol.iterator]();v.next();let E=v.next();for(;!y.done;)n+=!E.done&&Vl(E.value.codePointAt(0))&&!Jf[E.value]||!h.premature&&Vl(h.value.codePointAt(0))&&!Jf[h.value]||!Jf[y.value]?y.value:Jf[y.value],h={value:y.value,premature:!1},y=m.next(),E=v.next();return n})(this.text)}hasZeroWidthSpaces(){return this.text.includes("")}trim(){const e=this.text.match(/^\s*/),n=e?e[0].length:0,h=this.text.match(/\S\s*$/),m=h?h[0].length-1:0;this.text=this.text.substring(n,this.text.length-m),this.sectionIndex=this.sectionIndex.slice(n,this.sectionIndex.length-m)}substring(e,n){const h=[...this.text].slice(e,n).join(""),m=this.sectionIndex.slice(e,n);return new xf(h,this.sections,m)}toCodeUnitIndex(e){return[...this.text].slice(0,e).join("").length}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((e,n)=>Math.max(e,this.sections[n].scale)),0)}getMaxImageSize(e){let n=0,h=0;for(let m=0;m<this.length();m++){const y=this.getSection(m);if("imageName"in y){const v=e[y.imageName];if(!v)continue;const E=v.displaySize;n=Math.max(n,E[0]),h=Math.max(h,E[1])}}return{maxImageWidth:n,maxImageHeight:h}}addTextSection(e,n){this.text+=e.text,this.sections.push({scale:e.scale||1,verticalAlign:e.verticalAlign||"bottom",fontStack:e.fontStack||n});const h=this.sections.length-1;this.sectionIndex.push(...[...e.text].map((()=>h)))}addImageSection(e){const n=e.image?e.image.name:"";if(n.length===0)return void se("Can't add FormattedSection with an empty image.");const h=this.getNextImageSectionCharCode();h?(this.text+=String.fromCharCode(h),this.sections.push({scale:1,verticalAlign:e.verticalAlign||"bottom",imageName:n}),this.sectionIndex.push(this.sections.length-1)):se("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}determineLineBreaks(e,n,h,m,y){const v=[],E=this.determineAverageLineWidth(e,n,h,m,y),k=this.hasZeroWidthSpaces();let P=0,O=0;const G=this.text[Symbol.iterator]();let X=G.next();const K=this.text[Symbol.iterator]();K.next();let ae=K.next();const oe=this.text[Symbol.iterator]();oe.next(),oe.next();let he=oe.next();for(;!X.done;){const be=this.getSection(O),Ze=X.value.codePointAt(0);if(Qh(Ze)||(P+=Wd(Ze,be,h,m,e,y)),!ae.done){const Se=Nl(Ze),Ce=ae.value.codePointAt(0);(qx[Ze]||Se||"imageName"in be||!he.done&&Eh[Ce])&&v.push(Tm(O+1,P,E,v,Qf(Ze,Ce,Se&&k),!1))}O++,X=G.next(),ae=K.next(),he=oe.next()}return Sm(Tm(this.length(),P,E,v,0,!0))}determineAverageLineWidth(e,n,h,m,y){let v=0,E=0;for(const k of this.text){const P=this.getSection(E);v+=Wd(k.codePointAt(0),P,h,m,e,y),E++}return v/Math.max(1,Math.ceil(v/n))}}const r0=4294967296,$d=1/r0,n0=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class a0{constructor(e=new Uint8Array(16)){this.buf=ArrayBuffer.isView(e)?e:new Uint8Array(e),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(e,n,h=this.length){for(;this.pos<h;){const m=this.readVarint(),y=m>>3,v=this.pos;this.type=7&m,e(y,n,this),this.pos===v&&this.skip(m)}return n}readMessage(e,n){return this.readFields(e,n,this.readVarint()+this.pos)}readFixed32(){const e=this.dataView.getUint32(this.pos,!0);return this.pos+=4,e}readSFixed32(){const e=this.dataView.getInt32(this.pos,!0);return this.pos+=4,e}readFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*r0;return this.pos+=8,e}readSFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*r0;return this.pos+=8,e}readFloat(){const e=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,e}readDouble(){const e=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,e}readVarint(e){const n=this.buf;let h,m;return m=n[this.pos++],h=127&m,m<128?h:(m=n[this.pos++],h|=(127&m)<<7,m<128?h:(m=n[this.pos++],h|=(127&m)<<14,m<128?h:(m=n[this.pos++],h|=(127&m)<<21,m<128?h:(m=n[this.pos],h|=(15&m)<<28,(function(y,v,E){const k=E.buf;let P,O;if(O=k[E.pos++],P=(112&O)>>4,O<128||(O=k[E.pos++],P|=(127&O)<<3,O<128)||(O=k[E.pos++],P|=(127&O)<<10,O<128)||(O=k[E.pos++],P|=(127&O)<<17,O<128)||(O=k[E.pos++],P|=(127&O)<<24,O<128)||(O=k[E.pos++],P|=(1&O)<<31,O<128))return ed(y,P,v);throw new Error("Expected varint not more than 10 bytes")})(h,e,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const e=this.readVarint();return e%2==1?(e+1)/-2:e/2}readBoolean(){return!!this.readVarint()}readString(){const e=this.readVarint()+this.pos,n=this.pos;return this.pos=e,e-n>=12&&n0?n0.decode(this.buf.subarray(n,e)):(function(h,m,y){let v="",E=m;for(;E<y;){const k=h[E];let P,O,G,X=null,K=k>239?4:k>223?3:k>191?2:1;if(E+K>y)break;K===1?k<128&&(X=k):K===2?(P=h[E+1],(192&P)==128&&(X=(31&k)<<6|63&P,X<=127&&(X=null))):K===3?(P=h[E+1],O=h[E+2],(192&P)==128&&(192&O)==128&&(X=(15&k)<<12|(63&P)<<6|63&O,(X<=2047||X>=55296&&X<=57343)&&(X=null))):K===4&&(P=h[E+1],O=h[E+2],G=h[E+3],(192&P)==128&&(192&O)==128&&(192&G)==128&&(X=(15&k)<<18|(63&P)<<12|(63&O)<<6|63&G,(X<=65535||X>=1114112)&&(X=null))),X===null?(X=65533,K=1):X>65535&&(X-=65536,v+=String.fromCharCode(X>>>10&1023|55296),X=56320|1023&X),v+=String.fromCharCode(X),E+=K}return v})(this.buf,n,e)}readBytes(){const e=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,e);return this.pos=e,n}readPackedVarint(e=[],n){const h=this.readPackedEnd();for(;this.pos<h;)e.push(this.readVarint(n));return e}readPackedSVarint(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readSVarint());return e}readPackedBoolean(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readBoolean());return e}readPackedFloat(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readFloat());return e}readPackedDouble(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readDouble());return e}readPackedFixed32(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readFixed32());return e}readPackedSFixed32(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readSFixed32());return e}readPackedFixed64(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readFixed64());return e}readPackedSFixed64(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readSFixed64());return e}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(e){const n=7&e;if(n===0)for(;this.buf[this.pos++]>127;);else if(n===2)this.pos=this.readVarint()+this.pos;else if(n===5)this.pos+=4;else{if(n!==1)throw new Error(`Unimplemented type: ${n}`);this.pos+=8}}writeTag(e,n){this.writeVarint(e<<3|n)}realloc(e){let n=this.length||16;for(;n<this.pos+e;)n*=2;if(n!==this.length){const h=new Uint8Array(n);h.set(this.buf),this.buf=h,this.dataView=new DataView(h.buffer),this.length=n}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeSFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,-1&e,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*$d),!0),this.pos+=8}writeSFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,-1&e,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*$d),!0),this.pos+=8}writeVarint(e){(e=+e||0)>268435455||e<0?(function(n,h){let m,y;if(n>=0?(m=n%4294967296|0,y=n/4294967296|0):(m=~(-n%4294967296),y=~(-n/4294967296),4294967295^m?m=m+1|0:(m=0,y=y+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");h.realloc(10),(function(v,E,k){k.buf[k.pos++]=127&v|128,v>>>=7,k.buf[k.pos++]=127&v|128,v>>>=7,k.buf[k.pos++]=127&v|128,v>>>=7,k.buf[k.pos++]=127&v|128,k.buf[k.pos]=127&(v>>>=7)})(m,0,h),(function(v,E){const k=(7&v)<<4;E.buf[E.pos++]|=k|((v>>>=3)?128:0),v&&(E.buf[E.pos++]=127&v|((v>>>=7)?128:0),v&&(E.buf[E.pos++]=127&v|((v>>>=7)?128:0),v&&(E.buf[E.pos++]=127&v|((v>>>=7)?128:0),v&&(E.buf[E.pos++]=127&v|((v>>>=7)?128:0),v&&(E.buf[E.pos++]=127&v)))))})(y,h)})(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))}writeSVarint(e){this.writeVarint(e<0?2*-e-1:2*e)}writeBoolean(e){this.writeVarint(+e)}writeString(e){e=String(e),this.realloc(4*e.length),this.pos++;const n=this.pos;this.pos=(function(m,y,v){for(let E,k,P=0;P<y.length;P++){if(E=y.charCodeAt(P),E>55295&&E<57344){if(!k){E>56319||P+1===y.length?(m[v++]=239,m[v++]=191,m[v++]=189):k=E;continue}if(E<56320){m[v++]=239,m[v++]=191,m[v++]=189,k=E;continue}E=k-55296<<10|E-56320|65536,k=null}else k&&(m[v++]=239,m[v++]=191,m[v++]=189,k=null);E<128?m[v++]=E:(E<2048?m[v++]=E>>6|192:(E<65536?m[v++]=E>>12|224:(m[v++]=E>>18|240,m[v++]=E>>12&63|128),m[v++]=E>>6&63|128),m[v++]=63&E|128)}return v})(this.buf,e,this.pos);const h=this.pos-n;h>=128&&p_(n,h,this),this.pos=n-1,this.writeVarint(h),this.pos+=h}writeFloat(e){this.realloc(4),this.dataView.setFloat32(this.pos,e,!0),this.pos+=4}writeDouble(e){this.realloc(8),this.dataView.setFloat64(this.pos,e,!0),this.pos+=8}writeBytes(e){const n=e.length;this.writeVarint(n),this.realloc(n);for(let h=0;h<n;h++)this.buf[this.pos++]=e[h]}writeRawMessage(e,n){this.pos++;const h=this.pos;e(n,this);const m=this.pos-h;m>=128&&p_(h,m,this),this.pos=h-1,this.writeVarint(m),this.pos+=m}writeMessage(e,n,h){this.writeTag(e,2),this.writeRawMessage(n,h)}writePackedVarint(e,n){n.length&&this.writeMessage(e,m_,n)}writePackedSVarint(e,n){n.length&&this.writeMessage(e,g_,n)}writePackedBoolean(e,n){n.length&&this.writeMessage(e,__,n)}writePackedFloat(e,n){n.length&&this.writeMessage(e,td,n)}writePackedDouble(e,n){n.length&&this.writeMessage(e,i0,n)}writePackedFixed32(e,n){n.length&&this.writeMessage(e,x_,n)}writePackedSFixed32(e,n){n.length&&this.writeMessage(e,y_,n)}writePackedFixed64(e,n){n.length&&this.writeMessage(e,v_,n)}writePackedSFixed64(e,n){n.length&&this.writeMessage(e,b_,n)}writeBytesField(e,n){this.writeTag(e,2),this.writeBytes(n)}writeFixed32Field(e,n){this.writeTag(e,5),this.writeFixed32(n)}writeSFixed32Field(e,n){this.writeTag(e,5),this.writeSFixed32(n)}writeFixed64Field(e,n){this.writeTag(e,1),this.writeFixed64(n)}writeSFixed64Field(e,n){this.writeTag(e,1),this.writeSFixed64(n)}writeVarintField(e,n){this.writeTag(e,0),this.writeVarint(n)}writeSVarintField(e,n){this.writeTag(e,0),this.writeSVarint(n)}writeStringField(e,n){this.writeTag(e,2),this.writeString(n)}writeFloatField(e,n){this.writeTag(e,5),this.writeFloat(n)}writeDoubleField(e,n){this.writeTag(e,1),this.writeDouble(n)}writeBooleanField(e,n){this.writeVarintField(e,+n)}}function ed(a,e,n){return n?4294967296*e+(a>>>0):4294967296*(e>>>0)+(a>>>0)}function p_(a,e,n){const h=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(h);for(let m=n.pos-1;m>=a;m--)n.buf[m+h]=n.buf[m]}function m_(a,e){for(let n=0;n<a.length;n++)e.writeVarint(a[n])}function g_(a,e){for(let n=0;n<a.length;n++)e.writeSVarint(a[n])}function td(a,e){for(let n=0;n<a.length;n++)e.writeFloat(a[n])}function i0(a,e){for(let n=0;n<a.length;n++)e.writeDouble(a[n])}function __(a,e){for(let n=0;n<a.length;n++)e.writeBoolean(a[n])}function x_(a,e){for(let n=0;n<a.length;n++)e.writeFixed32(a[n])}function y_(a,e){for(let n=0;n<a.length;n++)e.writeSFixed32(a[n])}function v_(a,e){for(let n=0;n<a.length;n++)e.writeFixed64(a[n])}function b_(a,e){for(let n=0;n<a.length;n++)e.writeSFixed64(a[n])}function w_(a,e,n){a===1&&n.readMessage(s0,e)}function s0(a,e,n){if(a===3){const{id:h,bitmap:m,width:y,height:v,left:E,top:k,advance:P}=n.readMessage(T_,{});e.push({id:h,bitmap:new Pd({width:y+6,height:v+6},m),metrics:{width:y,height:v,left:E,top:k,advance:P}})}}function T_(a,e,n){a===1?e.id=n.readVarint():a===2?e.bitmap=n.readBytes():a===3?e.width=n.readVarint():a===4?e.height=n.readVarint():a===5?e.left=n.readSVarint():a===6?e.top=n.readSVarint():a===7&&(e.advance=n.readVarint())}function Em(a){let e=0,n=0;for(const v of a)e+=v.w*v.h,n=Math.max(n,v.w);a.sort(((v,E)=>E.h-v.h));const h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}];let m=0,y=0;for(const v of a)for(let E=h.length-1;E>=0;E--){const k=h[E];if(!(v.w>k.w||v.h>k.h)){if(v.x=k.x,v.y=k.y,y=Math.max(y,v.y+v.h),m=Math.max(m,v.x+v.w),v.w===k.w&&v.h===k.h){const P=h.pop();P&&E<h.length&&(h[E]=P)}else v.h===k.h?(k.x+=v.w,k.w-=v.w):v.w===k.w?(k.y+=v.h,k.h-=v.h):(h.push({x:k.x+v.w,y:k.y,w:k.w-v.w,h:v.h}),k.y+=v.h,k.h-=v.h);break}}return{w:m,h:y,fill:e/(m*y)||0}}class da{constructor(e,{pixelRatio:n,version:h,stretchX:m,stretchY:y,content:v,textFitWidth:E,textFitHeight:k}){this.paddedRect=e,this.pixelRatio=n,this.stretchX=m,this.stretchY=y,this.content=v,this.version=h,this.textFitWidth=E,this.textFitHeight=k}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class o0{constructor(e,n){const h={},m={};this.haveRenderCallbacks=[];const y=[];this.addImages(e,h,y),this.addImages(n,m,y);const{w:v,h:E}=Em(y),k=new Gs({width:v||1,height:E||1});for(const P in e){const O=e[P],G=h[P].paddedRect;Gs.copy(O.data,k,{x:0,y:0},{x:G.x+1,y:G.y+1},O.data)}for(const P in n){const O=n[P],G=m[P].paddedRect,X=G.x+1,K=G.y+1,ae=O.data.width,oe=O.data.height;Gs.copy(O.data,k,{x:0,y:0},{x:X,y:K},O.data),Gs.copy(O.data,k,{x:0,y:oe-1},{x:X,y:K-1},{width:ae,height:1}),Gs.copy(O.data,k,{x:0,y:0},{x:X,y:K+oe},{width:ae,height:1}),Gs.copy(O.data,k,{x:ae-1,y:0},{x:X-1,y:K},{width:1,height:oe}),Gs.copy(O.data,k,{x:0,y:0},{x:X+ae,y:K},{width:1,height:oe})}this.image=k,this.iconPositions=h,this.patternPositions=m}addImages(e,n,h){for(const m in e){const y=e[m],v={x:0,y:0,w:y.data.width+2,h:y.data.height+2};h.push(v),n[m]=new da(v,y),y.hasRenderCallback&&this.haveRenderCallbacks.push(m)}}patchUpdatedImages(e,n){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const h in e.updatedImages)this.patchUpdatedImage(this.iconPositions[h],e.getImage(h),n),this.patchUpdatedImage(this.patternPositions[h],e.getImage(h),n)}patchUpdatedImage(e,n,h){if(!e||!n||e.version===n.version)return;e.version=n.version;const[m,y]=e.tl;h.update(n.data,void 0,{x:m,y})}}var Ah;function Xd(a,e,n,h,m,y,v,E,k,P,O,G,X,K,ae){const oe=xf.fromFeature(a,m);let he;G===_.az.vertical&&oe.verticalizePunctuation();let be=oe.determineLineBreaks(P,y,e,h,K);const{processBidirectionalText:Ze,processStyledBidirectionalText:Se}=Co;if(Ze&&oe.sections.length===1){he=[],be=be.map((At=>oe.toCodeUnitIndex(At)));const it=Ze(oe.toString(),be);for(const At of it){const Wt=[...At].map((()=>0));he.push(new xf(At,oe.sections,Wt))}}else if(Se){he=[],be=be.map((Nt=>oe.toCodeUnitIndex(Nt)));let it=0;const At=[];for(const Nt of oe.text)At.push(...Array(Nt.length).fill(oe.sectionIndex[it])),it++;const Wt=Se(oe.text,At,be);for(const Nt of Wt){const rr=[];let wr="";for(const ar of Nt[0])rr.push(Nt[1][wr.length]),wr+=ar;he.push(new xf(Nt[0],oe.sections,rr))}}else he=(function(it,At){const Wt=[];let Nt=0;for(const rr of At)Wt.push(it.substring(Nt,rr)),Nt=rr;return Nt<it.length()&&Wt.push(it.substring(Nt,it.length())),Wt})(oe,be);const Ce=[],Ye={positionedLines:Ce,text:oe.toString(),top:O[1],bottom:O[1],left:O[0],right:O[0],writingMode:G,iconsInText:!1,verticalizable:!1};return(function(it,At,Wt,Nt,rr,wr,ar,qt,Lt,Pr,Cr,zr){let Er=0,Zr=0,qn=0,Mn=0;const ei=qt==="right"?1:qt==="left"?0:.5,Ws=Mi/zr;let Zi=0;for(const ia of rr){ia.trim();const di=ia.getMaxScale(),vi={positionedGlyphs:[],lineOffset:0};it.positionedLines[Zi]=vi;const La=vi.positionedGlyphs;let _l=0;if(!ia.length()){Zr+=wr,++Zi;continue}const $s=Zx(Nt,ia,Ws);let xl=0;for(const ds of ia.text){const ii=ia.getSection(xl),Wi=ds.codePointAt(0),pi=l0(Lt,Cr,Wi),ps={glyph:Wi,imageName:null,x:Er,y:Zr+-17,vertical:pi,scale:1,fontStack:"",sectionIndex:ia.getSectionIndex(xl),metrics:null,rect:null};let wf;if("fontStack"in ii){if(wf=rd(ii,Wi,pi,$s,At,Wt),!wf)continue;ps.fontStack=ii.fontStack}else{if(it.iconsInText=!0,ii.scale*=Ws,wf=km(ii,pi,di,$s,Nt),!wf)continue;_l=Math.max(_l,wf.imageOffset),ps.imageName=ii.imageName}const{rect:Xu,metrics:og,baselineOffset:fd}=wf;ps.y+=fd,ps.scale=ii.scale,ps.metrics=og,ps.rect=Xu,La.push(ps),pi?(it.verticalizable=!0,Er+=("imageName"in ii?og.advance:Mi)*ii.scale+Pr):Er+=og.advance*ii.scale+Pr,xl++}La.length!==0&&(qn=Math.max(Er-Pr,qn),c0(La,0,La.length-1,ei)),Er=0,vi.lineOffset=Math.max(_l,(di-1)*Mi);const nu=wr*di+_l;Zr+=nu,Mn=Math.max(nu,Mn),++Zi}const{horizontalAlign:ti,verticalAlign:Va}=Am(ar);(function(ia,di,vi,La,_l,$s,xl,nu,ds){const ii=(di-vi)*_l;let Wi=0;Wi=$s!==xl?-nu*La- -17:-La*ds*xl+.5*xl;for(const pi of ia)for(const ps of pi.positionedGlyphs)ps.x+=ii,ps.y+=Wi})(it.positionedLines,ei,ti,Va,qn,Mn,wr,Zr,rr.length),it.top+=-Va*Zr,it.bottom=it.top+Zr,it.left+=-ti*qn,it.right=it.left+qn})(Ye,e,n,h,he,v,E,k,G,P,X,ae),!(function(it){for(const At of it)if(At.positionedGlyphs.length!==0)return!1;return!0})(Ce)&&Ye}function Am(a){let e=.5,n=.5;switch(a){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function Zx(a,e,n){const h=e.getMaxScale()*Mi,{maxImageWidth:m,maxImageHeight:y}=e.getMaxImageSize(a),v=Math.max(h,y*n);return{verticalLineContentWidth:Math.max(h,m*n),horizontalLineContentHeight:v}}function S_(a){switch(a){case"top":return 0;case"center":return .5;default:return 1}}function l0(a,e,n){return!(a===_.az.horizontal||!e&&!ku(n)||e&&(Qh(n)||(h=n,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(h)))));var h}function rd(a,e,n,h,m,y){const v=y[a.fontStack],E=(function(P,O,G,X){if(P&&P.rect)return P;const K=O[G.fontStack],ae=K&&K[X];return ae?{rect:null,metrics:ae.metrics}:null})(v&&v[e],m,a,e);if(E===null)return null;let k;if(n)k=h.verticalLineContentWidth-a.scale*Mi;else{const P=S_(a.verticalAlign);k=(h.horizontalLineContentHeight-a.scale*Mi)*P}return{rect:E.rect,metrics:E.metrics,baselineOffset:k}}function km(a,e,n,h,m){const y=m[a.imageName];if(!y)return null;const v=y.paddedRect,E=y.displaySize,k={width:E[0],height:E[1],left:1,top:-3,advance:e?E[1]:E[0]};let P;if(e)P=h.verticalLineContentWidth-E[1]*a.scale;else{const O=S_(a.verticalAlign);P=(h.horizontalLineContentHeight-E[1]*a.scale)*O}return{rect:v,metrics:k,baselineOffset:P,imageOffset:(e?E[0]:E[1])*a.scale-Mi*n}}function c0(a,e,n,h){if(h===0)return;const m=a[n],y=(a[n].x+m.metrics.advance*m.scale)*h;for(let v=e;v<=n;v++)a[v].x-=y}function Cm(a,e,n){const{horizontalAlign:h,verticalAlign:m}=Am(n),y=e[0]-a.displaySize[0]*h,v=e[1]-a.displaySize[1]*m;return{image:a,top:v,bottom:v+a.displaySize[1],left:y,right:y+a.displaySize[0]}}function Hu(a){var e,n;let h=a.left,m=a.top,y=a.right-h,v=a.bottom-m;const E=(e=a.image.textFitWidth)!==null&&e!==void 0?e:"stretchOrShrink",k=(n=a.image.textFitHeight)!==null&&n!==void 0?n:"stretchOrShrink",P=(a.image.content[2]-a.image.content[0])/(a.image.content[3]-a.image.content[1]);if(k==="proportional"){if(E==="stretchOnly"&&y/v<P||E==="proportional"){const O=Math.ceil(v*P);h*=O/y,y=O}}else if(E==="proportional"&&k==="stretchOnly"&&P!==0&&y/v>P){const O=Math.ceil(y/P);m*=O/v,v=O}return{x1:h,y1:m,x2:h+y,y2:m+v}}function Sc(a,e,n,h,m,y){const v=a.image;let E;if(v.content){const he=v.content,be=v.pixelRatio||1;E=[he[0]/be,he[1]/be,v.displaySize[0]-he[2]/be,v.displaySize[1]-he[3]/be]}const k=e.left*y,P=e.right*y;let O,G,X,K;n==="width"||n==="both"?(K=m[0]+k-h[3],G=m[0]+P+h[1]):(K=m[0]+(k+P-v.displaySize[0])/2,G=K+v.displaySize[0]);const ae=e.top*y,oe=e.bottom*y;return n==="height"||n==="both"?(O=m[1]+ae-h[0],X=m[1]+oe+h[2]):(O=m[1]+(ae+oe-v.displaySize[1])/2,X=O+v.displaySize[1]),{image:v,top:O,right:G,bottom:X,left:K,collisionPadding:E}}kr("ImagePosition",da),kr("ImageAtlas",o0),_.az=void 0,(Ah=_.az||(_.az={}))[Ah.none=0]="none",Ah[Ah.horizontal=1]="horizontal",Ah[Ah.vertical=2]="vertical",Ah[Ah.horizontalOnly=3]="horizontalOnly";const ml=128,kh=32640;function Mm(a,e){const{expression:n}=e;if(n.kind==="constant")return{kind:"constant",layoutSize:n.evaluate(new Jn(a+1))};if(n.kind==="source")return{kind:"source"};{const{zoomStops:h,interpolationType:m}=n;let y=0;for(;y<h.length&&h[y]<=a;)y++;y=Math.max(0,y-1);let v=y;for(;v<h.length&&h[v]<a+1;)v++;v=Math.min(h.length-1,v);const E=h[y],k=h[v];return n.kind==="composite"?{kind:"composite",minZoom:E,maxZoom:k,interpolationType:m}:{kind:"camera",minZoom:E,maxZoom:k,minSize:n.evaluate(new Jn(E)),maxSize:n.evaluate(new Jn(k)),interpolationType:m}}}function u0(a,e,n){let h="never";const m=a.get(e);return m?h=m:a.get(n)&&(h="always"),h}const E_=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Yd(a,e,n,h,m,y,v,E,k,P,O,G,X){const K=E?Math.min(kh,Math.round(E[0])):0,ae=E?Math.min(kh,Math.round(E[1])):0;a.emplaceBack(e,n,Math.round(32*h),Math.round(32*m),y,v,(K<<1)+(k?1:0),ae,16*P,16*O,256*G,256*X)}function Dm(a,e,n){a.emplaceBack(e.x,e.y,n),a.emplaceBack(e.x,e.y,n),a.emplaceBack(e.x,e.y,n),a.emplaceBack(e.x,e.y,n)}function Rm(a){for(const e of a.sections)if(mc(e.text))return!0;return!1}class h0{constructor(e){this.layoutVertexArray=new Xe,this.indexArray=new Dt,this.programConfigurations=e,this.segments=new br,this.dynamicLayoutVertexArray=new ft,this.opacityVertexArray=new Pt,this.hasVisibleVertices=!1,this.placedSymbolArray=new A}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,n,h,m){this.isEmpty()||(h&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,f_.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Zd.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,E_,!0),this.opacityVertexBuffer.itemSize=1),(h||m)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}kr("SymbolBuffers",h0);class f0{constructor(e,n,h){this.layoutVertexArray=new e,this.layoutAttributes=n,this.indexArray=new h,this.segments=new br,this.collisionVertexArray=new Ct}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,wm.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}kr("CollisionBuffers",f0);class nd{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((v=>v.id)),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Mm(this.zoom,n["text-size"]),this.iconSizeData=Mm(this.zoom,n["icon-size"]);const h=this.layers[0].layout,m=h.get("symbol-sort-key"),y=h.get("symbol-z-order");this.canOverlap=u0(h,"text-overlap","text-allow-overlap")!=="never"||u0(h,"icon-overlap","icon-allow-overlap")!=="never"||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey=y!=="viewport-y"&&!m.isConstant(),this.sortFeaturesByY=(y==="viewport-y"||y==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,h.get("symbol-placement")==="point"&&(this.writingModes=h.get("text-writing-mode").map((v=>_.az[v]))),this.stateDependentLayerIds=this.layers.filter((v=>v.isStateDependent())).map((v=>v.id)),this.sourceID=e.sourceID}createArrays(){this.text=new h0(new Xc(this.layers,this.zoom,(e=>/^text/.test(e)))),this.icon=new h0(new Xc(this.layers,this.zoom,(e=>/^icon/.test(e)))),this.glyphOffsetArray=new V,this.lineVertexArray=new q,this.symbolInstances=new F,this.textAnchorOffsets=new Q}calculateGlyphDependencies(e,n,h,m,y){for(const v of e)if(n[v.codePointAt(0)]=!0,(h||m)&&y){const E=Jf[v];E&&(n[E.codePointAt(0)]=!0)}}populate(e,n,h){const m=this.layers[0],y=m.layout,v=y.get("text-font"),E=y.get("text-field"),k=y.get("icon-image"),P=(E.value.kind!=="constant"||E.value.value instanceof ba&&!E.value.value.isEmpty()||E.value.value.toString().length>0)&&(v.value.kind!=="constant"||v.value.value.length>0),O=k.value.kind!=="constant"||!!k.value.value||Object.keys(k.parameters).length>0,G=y.get("symbol-sort-key");if(this.features=[],!P&&!O)return;const X=n.iconDependencies,K=n.glyphDependencies,ae=n.availableImages,oe=new Jn(this.zoom);for(const{feature:he,id:be,index:Ze,sourceLayerIndex:Se}of e){const Ce=m._featureFilter.needGeometry,Ye=dl(he,Ce);if(!m._featureFilter.filter(oe,Ye,h))continue;let it,At;if(Ce||(Ye.geometry=bc(he)),P){const Nt=m.getValueAndResolveTokens("text-field",Ye,h,ae),rr=ba.factory(Nt),wr=this.hasRTLText=this.hasRTLText||Rm(rr);(!wr||Co.getRTLTextPluginStatus()==="unavailable"||wr&&Co.isParsed())&&(it=Oo(rr,m,Ye))}if(O){const Nt=m.getValueAndResolveTokens("icon-image",Ye,h,ae);At=Nt instanceof Oa?Nt:Oa.fromString(Nt)}if(!it&&!At)continue;const Wt=this.sortFeaturesByKey?G.evaluate(Ye,{},h):void 0;if(this.features.push({id:be,text:it,icon:At,index:Ze,sourceLayerIndex:Se,geometry:Ye.geometry,properties:he.properties,type:Xf.types[he.type],sortKey:Wt}),At&&(X[At.name]=!0),it){const Nt=v.evaluate(Ye,{},h).join(","),rr=y.get("text-rotation-alignment")!=="viewport"&&y.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(_.az.vertical)>=0;for(const wr of it.sections)if(wr.image)X[wr.image.name]=!0;else{const ar=jl(it.toString()),qt=wr.fontStack||Nt,Lt=K[qt]=K[qt]||{};this.calculateGlyphDependencies(wr.text,Lt,rr,this.allowVerticalPlacement,ar)}}}y.get("symbol-placement")==="line"&&(this.features=(function(he){const be={},Ze={},Se=[];let Ce=0;function Ye(Nt){Se.push(he[Nt]),Ce++}function it(Nt,rr,wr){const ar=Ze[Nt];return delete Ze[Nt],Ze[rr]=ar,Se[ar].geometry[0].pop(),Se[ar].geometry[0]=Se[ar].geometry[0].concat(wr[0]),ar}function At(Nt,rr,wr){const ar=be[rr];return delete be[rr],be[Nt]=ar,Se[ar].geometry[0].shift(),Se[ar].geometry[0]=wr[0].concat(Se[ar].geometry[0]),ar}function Wt(Nt,rr,wr){const ar=wr?rr[0][rr[0].length-1]:rr[0][0];return`${Nt}:${ar.x}:${ar.y}`}for(let Nt=0;Nt<he.length;Nt++){const rr=he[Nt],wr=rr.geometry,ar=rr.text?rr.text.toString():null;if(!ar){Ye(Nt);continue}const qt=Wt(ar,wr),Lt=Wt(ar,wr,!0);if(qt in Ze&&Lt in be&&Ze[qt]!==be[Lt]){const Pr=At(qt,Lt,wr),Cr=it(qt,Lt,Se[Pr].geometry);delete be[qt],delete Ze[Lt],Ze[Wt(ar,Se[Cr].geometry,!0)]=Cr,Se[Pr].geometry=null}else qt in Ze?it(qt,Lt,wr):Lt in be?At(qt,Lt,wr):(Ye(Nt),be[qt]=Ce-1,Ze[Lt]=Ce-1)}return Se.filter((Nt=>Nt.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((he,be)=>he.sortKey-be.sortKey))}update(e,n,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,n,this.layers,{imagePositions:h}),this.icon.programConfigurations.updatePaintArrays(e,n,this.layers,{imagePositions:h}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,n){const h=this.lineVertexArray.length;if(e.segment!==void 0){let m=e.dist(n[e.segment+1]),y=e.dist(n[e.segment]);const v={};for(let E=e.segment+1;E<n.length;E++)v[E]={x:n[E].x,y:n[E].y,tileUnitDistanceFromAnchor:m},E<n.length-1&&(m+=n[E+1].dist(n[E]));for(let E=e.segment||0;E>=0;E--)v[E]={x:n[E].x,y:n[E].y,tileUnitDistanceFromAnchor:y},E>0&&(y+=n[E-1].dist(n[E]));for(let E=0;E<n.length;E++){const k=v[E];this.lineVertexArray.emplaceBack(k.x,k.y,k.tileUnitDistanceFromAnchor)}}return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(e,n,h,m,y,v,E,k,P,O,G,X){const K=e.indexArray,ae=e.layoutVertexArray,oe=e.segments.prepareSegment(4*n.length,ae,K,this.canOverlap?v.sortKey:void 0),he=this.glyphOffsetArray.length,be=oe.vertexLength,Ze=this.allowVerticalPlacement&&E===_.az.vertical?Math.PI/2:0,Se=v.text&&v.text.sections;for(let Ce=0;Ce<n.length;Ce++){const{tl:Ye,tr:it,bl:At,br:Wt,tex:Nt,pixelOffsetTL:rr,pixelOffsetBR:wr,minFontScaleX:ar,minFontScaleY:qt,glyphOffset:Lt,isSDF:Pr,sectionIndex:Cr}=n[Ce],zr=oe.vertexLength,Er=Lt[1];Yd(ae,k.x,k.y,Ye.x,Er+Ye.y,Nt.x,Nt.y,h,Pr,rr.x,rr.y,ar,qt),Yd(ae,k.x,k.y,it.x,Er+it.y,Nt.x+Nt.w,Nt.y,h,Pr,wr.x,rr.y,ar,qt),Yd(ae,k.x,k.y,At.x,Er+At.y,Nt.x,Nt.y+Nt.h,h,Pr,rr.x,wr.y,ar,qt),Yd(ae,k.x,k.y,Wt.x,Er+Wt.y,Nt.x+Nt.w,Nt.y+Nt.h,h,Pr,wr.x,wr.y,ar,qt),Dm(e.dynamicLayoutVertexArray,k,Ze),K.emplaceBack(zr,zr+2,zr+1),K.emplaceBack(zr+1,zr+2,zr+3),oe.vertexLength+=4,oe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Lt[0]),Ce!==n.length-1&&Cr===n[Ce+1].sectionIndex||e.programConfigurations.populatePaintArrays(ae.length,v,v.index,{imagePositions:{},canonical:X,formattedSection:Se&&Se[Cr]})}e.placedSymbolArray.emplaceBack(k.x,k.y,he,this.glyphOffsetArray.length-he,be,P,O,k.segment,h?h[0]:0,h?h[1]:0,m[0],m[1],E,0,!1,0,G)}_addCollisionDebugVertex(e,n,h,m,y,v){return n.emplaceBack(0,0),e.emplaceBack(h.x,h.y,m,y,Math.round(v.x),Math.round(v.y))}addCollisionDebugVertices(e,n,h,m,y,v,E){const k=y.segments.prepareSegment(4,y.layoutVertexArray,y.indexArray),P=k.vertexLength,O=y.layoutVertexArray,G=y.collisionVertexArray,X=E.anchorX,K=E.anchorY;this._addCollisionDebugVertex(O,G,v,X,K,new C(e,n)),this._addCollisionDebugVertex(O,G,v,X,K,new C(h,n)),this._addCollisionDebugVertex(O,G,v,X,K,new C(h,m)),this._addCollisionDebugVertex(O,G,v,X,K,new C(e,m)),k.vertexLength+=4;const ae=y.indexArray;ae.emplaceBack(P,P+1),ae.emplaceBack(P+1,P+2),ae.emplaceBack(P+2,P+3),ae.emplaceBack(P+3,P),k.primitiveLength+=4}addDebugCollisionBoxes(e,n,h,m){for(let y=e;y<n;y++){const v=this.collisionBoxArray.get(y);this.addCollisionDebugVertices(v.x1,v.y1,v.x2,v.y2,m?this.textCollisionBox:this.iconCollisionBox,v.anchorPoint,h)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new f0(Et,zo.members,ur),this.iconCollisionBox=new f0(Et,zo.members,ur);for(let e=0;e<this.symbolInstances.length;e++){const n=this.symbolInstances.get(e);this.addDebugCollisionBoxes(n.textBoxStartIndex,n.textBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.iconBoxStartIndex,n.iconBoxEndIndex,n,!1),this.addDebugCollisionBoxes(n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex,n,!1)}}_deserializeCollisionBoxesForSymbol(e,n,h,m,y,v,E,k,P){const O={};for(let G=n;G<h;G++){const X=e.get(G);O.textBox={x1:X.x1,y1:X.y1,x2:X.x2,y2:X.y2,anchorPointX:X.anchorPointX,anchorPointY:X.anchorPointY},O.textFeatureIndex=X.featureIndex;break}for(let G=m;G<y;G++){const X=e.get(G);O.verticalTextBox={x1:X.x1,y1:X.y1,x2:X.x2,y2:X.y2,anchorPointX:X.anchorPointX,anchorPointY:X.anchorPointY},O.verticalTextFeatureIndex=X.featureIndex;break}for(let G=v;G<E;G++){const X=e.get(G);O.iconBox={x1:X.x1,y1:X.y1,x2:X.x2,y2:X.y2,anchorPointX:X.anchorPointX,anchorPointY:X.anchorPointY},O.iconFeatureIndex=X.featureIndex;break}for(let G=k;G<P;G++){const X=e.get(G);O.verticalIconBox={x1:X.x1,y1:X.y1,x2:X.x2,y2:X.y2,anchorPointX:X.anchorPointX,anchorPointY:X.anchorPointY},O.verticalIconFeatureIndex=X.featureIndex;break}return O}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const h=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,n){const h=e.placedSymbolArray.get(n),m=h.vertexStartIndex+4*h.numGlyphs;for(let y=h.vertexStartIndex;y<m;y+=4)e.indexArray.emplaceBack(y,y+2,y+1),e.indexArray.emplaceBack(y+1,y+2,y+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const n=Math.sin(e),h=Math.cos(e),m=[],y=[],v=[];for(let E=0;E<this.symbolInstances.length;++E){v.push(E);const k=this.symbolInstances.get(E);m.push(0|Math.round(n*k.anchorX+h*k.anchorY)),y.push(k.featureIndex)}return v.sort(((E,k)=>m[E]-m[k]||y[k]-y[E])),v}addToSortKeyRanges(e,n){const h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===n?h.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const h=this.symbolInstances.get(n);this.featureSortOrder.push(h.featureIndex),[h.rightJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.leftJustifiedTextSymbolIndex].forEach(((m,y,v)=>{m>=0&&v.indexOf(m)===y&&this.addIndicesForPlacedSymbol(this.text,m)})),h.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,h.verticalPlacedTextSymbolIndex),h.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.placedIconSymbolIndex),h.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let d0,p0;kr("SymbolBucket",nd,{omit:["layers","collisionBoxArray","features","compareText"]}),nd.MAX_GLYPHS=65535,nd.addDynamicAttributes=Dm;var Im={get paint(){return p0=p0||new ni({"icon-opacity":new Br(xt.paint_symbol["icon-opacity"]),"icon-color":new Br(xt.paint_symbol["icon-color"]),"icon-halo-color":new Br(xt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Br(xt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Br(xt.paint_symbol["icon-halo-blur"]),"icon-translate":new Rr(xt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Rr(xt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Br(xt.paint_symbol["text-opacity"]),"text-color":new Br(xt.paint_symbol["text-color"],{runtimeType:Ut,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new Br(xt.paint_symbol["text-halo-color"]),"text-halo-width":new Br(xt.paint_symbol["text-halo-width"]),"text-halo-blur":new Br(xt.paint_symbol["text-halo-blur"]),"text-translate":new Rr(xt.paint_symbol["text-translate"]),"text-translate-anchor":new Rr(xt.paint_symbol["text-translate-anchor"])})},get layout(){return d0=d0||new ni({"symbol-placement":new Rr(xt.layout_symbol["symbol-placement"]),"symbol-spacing":new Rr(xt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Rr(xt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Br(xt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Rr(xt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Rr(xt.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Rr(xt.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Rr(xt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Rr(xt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Rr(xt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Br(xt.layout_symbol["icon-size"]),"icon-text-fit":new Rr(xt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Rr(xt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Br(xt.layout_symbol["icon-image"]),"icon-rotate":new Br(xt.layout_symbol["icon-rotate"]),"icon-padding":new Br(xt.layout_symbol["icon-padding"]),"icon-keep-upright":new Rr(xt.layout_symbol["icon-keep-upright"]),"icon-offset":new Br(xt.layout_symbol["icon-offset"]),"icon-anchor":new Br(xt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Rr(xt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Rr(xt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Rr(xt.layout_symbol["text-rotation-alignment"]),"text-field":new Br(xt.layout_symbol["text-field"]),"text-font":new Br(xt.layout_symbol["text-font"]),"text-size":new Br(xt.layout_symbol["text-size"]),"text-max-width":new Br(xt.layout_symbol["text-max-width"]),"text-line-height":new Rr(xt.layout_symbol["text-line-height"]),"text-letter-spacing":new Br(xt.layout_symbol["text-letter-spacing"]),"text-justify":new Br(xt.layout_symbol["text-justify"]),"text-radial-offset":new Br(xt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Rr(xt.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Br(xt.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Br(xt.layout_symbol["text-anchor"]),"text-max-angle":new Rr(xt.layout_symbol["text-max-angle"]),"text-writing-mode":new Rr(xt.layout_symbol["text-writing-mode"]),"text-rotate":new Br(xt.layout_symbol["text-rotate"]),"text-padding":new Rr(xt.layout_symbol["text-padding"]),"text-keep-upright":new Rr(xt.layout_symbol["text-keep-upright"]),"text-transform":new Br(xt.layout_symbol["text-transform"]),"text-offset":new Br(xt.layout_symbol["text-offset"]),"text-allow-overlap":new Rr(xt.layout_symbol["text-allow-overlap"]),"text-overlap":new Rr(xt.layout_symbol["text-overlap"]),"text-ignore-placement":new Rr(xt.layout_symbol["text-ignore-placement"]),"text-optional":new Rr(xt.layout_symbol["text-optional"])})}};class A_{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:Re,this.defaultValue=e}evaluate(e){if(e.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(e.formattedSection))return n.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}kr("FormatSectionOverride",A_,{omit:["defaultValue"]});class Ch extends ja{constructor(e,n){super(e,Im,n)}recalculate(e,n){if(super.recalculate(e,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const h=this.layout.get("text-writing-mode");if(h){const m=[];for(const y of h)m.indexOf(y)<0&&m.push(y);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,n,h,m){const y=this.layout.get(e).evaluate(n,{},h,m),v=this._unevaluatedLayout._values[e];return v.isDataDriven()||un(v.value)||!y?y:(function(E,k){return k.replace(/{([^{}]+)}/g,((P,O)=>E&&O in E?String(E[O]):""))})(n.properties,y)}createBucket(e){return new nd(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of Im.paint.overridableProperties){if(!Ch.hasPaintOverride(this.layout,e))continue;const n=this.paint.get(e),h=new A_(n),m=new Kr(h,n.property.specification);let y=null;y=n.value.kind==="constant"||n.value.kind==="source"?new Or("source",m):new Lr("composite",m,n.value.zoomStops),this.paint._values[e]=new oo(n.property,y,n.parameters)}}_handleOverridablePaintPropertyUpdate(e,n,h){return!(!this.layout||n.isDataDriven()||h.isDataDriven())&&Ch.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,n){const h=e.get("text-field"),m=Im.paint.properties[n];let y=!1;const v=E=>{for(const k of E)if(m.overrides&&m.overrides.hasOverride(k))return void(y=!0)};if(h.value.kind==="constant"&&h.value.value instanceof ba)v(h.value.value.sections);else if(h.value.kind==="source"||h.value.kind==="composite"){const E=P=>{y||(P instanceof ri&&Rn(P.value)===vr?v(P.value.sections):P instanceof rc?v(P.sections):P.eachChild(E))},k=h.value;k._styleExpression&&E(k._styleExpression.expression)}return y}}let k_;var C_={get paint(){return k_=k_||new ni({"background-color":new Rr(xt.paint_background["background-color"]),"background-pattern":new xh(xt.paint_background["background-pattern"]),"background-opacity":new Rr(xt.paint_background["background-opacity"])})}};class Un extends ja{constructor(e,n){super(e,C_,n)}}class Pm extends ja{constructor(e,n){super(e,{},n),this.onAdd=h=>{this.implementation.onAdd&&this.implementation.onAdd(h,h.painter.context.gl)},this.onRemove=h=>{this.implementation.onRemove&&this.implementation.onRemove(h,h.painter.context.gl)},this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class m0{constructor(e){this._methodToThrottle=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Fm={once:!0},g0=63710088e-1;class tu{constructor(e,n){if(isNaN(e)||isNaN(n))throw new Error(`Invalid LngLat object: (${e}, ${n})`);if(this.lng=+e,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new tu(Vt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const n=Math.PI/180,h=this.lat*n,m=e.lat*n,y=Math.sin(h)*Math.sin(m)+Math.cos(h)*Math.cos(m)*Math.cos((e.lng-this.lng)*n);return g0*Math.acos(Math.min(y,1))}static convert(e){if(e instanceof tu)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new tu(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new tu(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const ad=2*Math.PI*g0;function Kd(a){return ad*Math.cos(a*Math.PI/180)}function M_(a){return(180+a)/360}function Lm(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function D_(a,e){return a/Kd(e)}function R_(a){return 360*a-180}function Jd(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}function zm(a,e){return a*Kd(Jd(e))}class na{constructor(e,n,h=0){this.x=+e,this.y=+n,this.z=+h}static fromLngLat(e,n=0){const h=tu.convert(e);return new na(M_(h.lng),Lm(h.lat),D_(n,h.lat))}toLngLat(){return new tu(R_(this.x),Jd(this.y))}toAltitude(){return zm(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/ad*(e=Jd(this.y),1/Math.cos(e*Math.PI/180));var e}}function _0(a,e,n){var h=2*Math.PI*6378137/256/Math.pow(2,n);return[a*h-2*Math.PI*6378137/2,e*h-2*Math.PI*6378137/2]}class as{constructor(e,n,h){if(!(function(m,y,v){return!(m<0||m>25||v<0||v>=Math.pow(2,m)||y<0||y>=Math.pow(2,m))})(e,n,h))throw new Error(`x=${n}, y=${h}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=n,this.y=h,this.key=id(0,e,e,n,h)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,n,h){const m=(function(v,E,k){var P=_0(256*v,256*(E=Math.pow(2,k)-E-1),k),O=_0(256*(v+1),256*(E+1),k);return P[0]+","+P[1]+","+O[0]+","+O[1]})(this.x,this.y,this.z),y=(function(v,E,k){let P,O="";for(let G=v;G>0;G--)P=1<<G-1,O+=(E&P?1:0)+(k&P?2:0);return O})(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(h==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,n>1?"@2x":"").replace(/{quadkey}/g,y).replace(/{bbox-epsg-3857}/g,m)}isChildOf(e){const n=this.z-e.z;return n>0&&e.x===this.x>>n&&e.y===this.y>>n}getTilePoint(e){const n=Math.pow(2,this.z);return new C((e.x*n-this.x)*Be,(e.y*n-this.y)*Be)}toString(){return`${this.z}/${this.x}/${this.y}`}}class I_{constructor(e,n){this.wrap=e,this.canonical=n,this.key=id(e,n.z,n.z,n.x,n.y)}}class Bo{constructor(e,n,h,m,y){if(this.terrainRttPosMatrix32f=null,e<h)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${h}`);this.overscaledZ=e,this.wrap=n,this.canonical=new as(h,+m,+y),this.key=id(n,e,h,m,y)}clone(){return new Bo(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const n=this.canonical.z-e;return e>this.canonical.z?new Bo(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Bo(e,this.wrap,e,this.canonical.x>>n,this.canonical.y>>n)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(e,n){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-e;return e>this.canonical.z?id(this.wrap*+n,e,this.canonical.z,this.canonical.x,this.canonical.y):id(this.wrap*+n,e,e,this.canonical.x>>h,this.canonical.y>>h)}isChildOf(e){if(e.wrap!==this.wrap||this.overscaledZ-e.overscaledZ<=0)return!1;if(e.overscaledZ===0)return this.overscaledZ>0;const n=this.canonical.z-e.canonical.z;return!(n<0)&&e.canonical.x===this.canonical.x>>n&&e.canonical.y===this.canonical.y>>n}children(e){if(this.overscaledZ>=e)return[new Bo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,h=2*this.canonical.x,m=2*this.canonical.y;return[new Bo(n,this.wrap,n,h,m),new Bo(n,this.wrap,n,h+1,m),new Bo(n,this.wrap,n,h,m+1),new Bo(n,this.wrap,n,h+1,m+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Bo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Bo(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new I_(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new na(e.x-this.wrap,e.y))}}function id(a,e,n,h,m){(a*=2)<0&&(a=-1*a-1);const y=1<<n;return(y*y*a+y*m+h).toString(36)+n.toString(36)+e.toString(36)}function Qd(a,e){return e?a.properties[e]:a.id}function Om(a,e){const n={id:a.id};if(e.removeAllProperties&&(delete a.removeProperties,delete a.addOrUpdateProperties,delete e.removeProperties),e.removeProperties)for(const h of e.removeProperties){const m=a.addOrUpdateProperties.findIndex((y=>y.key===h));m>-1&&a.addOrUpdateProperties.splice(m,1)}return(a.removeAllProperties||e.removeAllProperties)&&(n.removeAllProperties=!0),(a.removeProperties||e.removeProperties)&&(n.removeProperties=[...a.removeProperties||[],...e.removeProperties||[]]),(a.addOrUpdateProperties||e.addOrUpdateProperties)&&(n.addOrUpdateProperties=[...a.addOrUpdateProperties||[],...e.addOrUpdateProperties||[]]),(a.newGeometry||e.newGeometry)&&(n.newGeometry=e.newGeometry||a.newGeometry),n}function ep(a){var e,n;if(!a)return{};const h={};return h.removeAll=a.removeAll,h.remove=new Set(a.remove||[]),h.add=new Map((e=a.add)===null||e===void 0?void 0:e.map((m=>[m.id,m]))),h.update=new Map((n=a.update)===null||n===void 0?void 0:n.map((m=>[m.id,m]))),h}kr("CanonicalTileID",as),kr("OverscaledTileID",Bo,{omit:["terrainRttPosMatrix32f"]});class Mh{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(e){return this.minX=Math.min(this.minX,e.x),this.minY=Math.min(this.minY,e.y),this.maxX=Math.max(this.maxX,e.x),this.maxY=Math.max(this.maxY,e.y),this}expandBy(e){return this.minX-=e,this.minY-=e,this.maxX+=e,this.maxY+=e,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(e){return this.expandBy(-e)}map(e){const n=new Mh;return n.extend(e(new C(this.minX,this.minY))),n.extend(e(new C(this.maxX,this.minY))),n.extend(e(new C(this.minX,this.maxY))),n.extend(e(new C(this.maxX,this.maxY))),n}static fromPoints(e){const n=new Mh;for(const h of e)n.extend(h);return n}contains(e){return e.x>=this.minX&&e.x<=this.maxX&&e.y>=this.minY&&e.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(e){return!this.empty()&&!e.empty()&&e.minX>=this.minX&&e.maxX<=this.maxX&&e.minY>=this.minY&&e.maxY<=this.maxY}intersects(e){return!this.empty()&&!e.empty()&&e.minX<=this.maxX&&e.maxX>=this.minX&&e.minY<=this.maxY&&e.maxY>=this.minY}}class Bm{constructor(e){this._stringToNumber={},this._numberToString=[];for(let n=0;n<e.length;n++){const h=e[n];this._stringToNumber[h]=n,this._numberToString[n]=h}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class x0{constructor(e,n,h,m,y){this.type="Feature",this._vectorTileFeature=e,this._x=h,this._y=m,this._z=n,this.properties=e.properties,this.id=y}projectPoint(e,n,h,m){return[360*(e.x+n)/m-180,360/Math.PI*Math.atan(Math.exp((1-2*(e.y+h)/m)*Math.PI))-90]}projectLine(e,n,h,m){return e.map((y=>this.projectPoint(y,n,h,m)))}get geometry(){if(this._geometry)return this._geometry;const e=this._vectorTileFeature,n=e.extent*Math.pow(2,this._z),h=e.extent*this._x,m=e.extent*this._y,y=e.loadGeometry();switch(e.type){case 1:{const v=[];for(const k of y)v.push(k[0]);const E=this.projectLine(v,h,m,n);this._geometry=v.length===1?{type:"Point",coordinates:E[0]}:{type:"MultiPoint",coordinates:E};break}case 2:{const v=y.map((E=>this.projectLine(E,h,m,n)));this._geometry=v.length===1?{type:"LineString",coordinates:v[0]}:{type:"MultiLineString",coordinates:v};break}case 3:{const v=u_(y),E=[];for(const k of v)E.push(k.map((P=>this.projectLine(P,h,m,n))));this._geometry=E.length===1?{type:"Polygon",coordinates:E[0]}:{type:"MultiPolygon",coordinates:E};break}default:throw new Error(`unknown feature type: ${e.type}`)}return this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const n in this)n!=="_geometry"&&n!=="_vectorTileFeature"&&n!=="_x"&&n!=="_y"&&n!=="_z"&&(e[n]=this[n]);return e}}class Dh{_name;dataBuffer;nullabilityBuffer;_size;constructor(e,n,h){this._name=e,this.dataBuffer=n,typeof h=="number"?this._size=h:(this.nullabilityBuffer=h,this._size=h.size())}getValue(e){return this.nullabilityBuffer&&!this.nullabilityBuffer.get(e)?null:this.getValueFromBuffer(e)}has(e){return this.nullabilityBuffer&&this.nullabilityBuffer.get(e)||!this.nullabilityBuffer}get name(){return this._name}get size(){return this._size}}class y0 extends Dh{}class v0 extends y0{getValueFromBuffer(e){return this.dataBuffer[e]}}class Nm extends y0{getValueFromBuffer(e){return this.dataBuffer[e]}}class jm extends Dh{delta;constructor(e,n,h,m){super(e,n,m),this.delta=h}}class Um extends jm{constructor(e,n,h,m){super(e,Int32Array.of(n),h,m)}getValueFromBuffer(e){return this.dataBuffer[0]+e*this.delta}}class Vm extends Dh{constructor(e,n,h){super(e,Int32Array.of(n),h)}getValueFromBuffer(e){return this.dataBuffer[0]}}class Rh{_name;_geometryVector;_idVector;_propertyVectors;_extent;propertyVectorsMap;constructor(e,n,h,m,y=4096){this._name=e,this._geometryVector=n,this._idVector=h,this._propertyVectors=m,this._extent=y}get name(){return this._name}get idVector(){return this._idVector}get geometryVector(){return this._geometryVector}get propertyVectors(){return this._propertyVectors}getPropertyVector(e){return this.propertyVectorsMap||(this.propertyVectorsMap=new Map(this._propertyVectors.map((n=>[n.name,n])))),this.propertyVectorsMap.get(e)}*[Symbol.iterator](){const e=this.geometryVector[Symbol.iterator]();let n=0;for(;n<this.numFeatures;){let h;this.idVector&&(h=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(n)):this.idVector.getValue(n));const m=e?.next().value,y={};for(const v of this.propertyVectors){if(!v)continue;const E=v.name,k=v.getValue(n);k!==null&&(y[E]=k)}n++,yield{id:h,geometry:m,properties:y}}}get numFeatures(){return this.geometryVector.numGeometries}get extent(){return this._extent}getFeatures(){const e=[],n=this.geometryVector.getGeometries();for(let h=0;h<this.numFeatures;h++){let m;this.idVector&&(m=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(h)):this.idVector.getValue(h));const y={coordinates:n[h],type:this.geometryVector.geometryType(h)},v={};for(const E of this.propertyVectors){if(!E)continue;const k=E.name,P=E.getValue(h);P!==null&&(v[k]=P)}e.push({id:m,geometry:y,properties:v})}return e}containsMaxSaveIntegerValues(e){return e instanceof v0||e instanceof Vm&&e instanceof Um||e instanceof Nm}}class P_{value;constructor(e){this.value=e}get(){return this.value}set(e){this.value=e}increment(){return this.value++}add(e){this.value+=e}}var Sn,Ec,hs,Ac,Ih,Hs,yi,Hi,gl,fo;function qi(a,e,n){const h=new Int32Array(n);let m=0,y=e.get();for(let v=0;v<h.length;v++){let E=a[y++],k=127&E;E<128||(E=a[y++],k|=(127&E)<<7,E<128||(E=a[y++],k|=(127&E)<<14,E<128||(E=a[y++],k|=(127&E)<<21,E<128||(E=a[y++],k|=(15&E)<<28)))),h[m++]=k}return e.set(y),h}function tp(a,e,n){const h=new BigInt64Array(n);for(let m=0;m<h.length;m++)h[m]=b0(a,e);return h}function F_(a,e){let n,h;return h=a[e.get()],e.increment(),n=127&h,h<128?n:(h=a[e.get()],e.increment(),n|=(127&h)<<7,h<128?n:(h=a[e.get()],e.increment(),n|=(127&h)<<14,h<128?n:(h=a[e.get()],e.increment(),n|=(127&h)<<21,h<128?n:(h=a[e.get()],n|=(15&h)<<28,(function(m,y,v){let E,k;if(k=y[v.get()],v.increment(),E=(112&k)>>4,k<128||(k=y[v.get()],v.increment(),E|=(127&k)<<3,k<128)||(k=y[v.get()],v.increment(),E|=(127&k)<<10,k<128)||(k=y[v.get()],v.increment(),E|=(127&k)<<17,k<128)||(k=y[v.get()],v.increment(),E|=(127&k)<<24,k<128)||(k=y[v.get()],v.increment(),E|=(1&k)<<31,k<128))return 4294967296*E+(m>>>0);throw new Error("Expected varint not more than 10 bytes")})(n,a,e)))))}function sd(a,e,n,h){throw new Error("FastPFor is not implemented yet.")}function fs(a){return a>>>1^-(1&a)}function yf(a){return a>>1n^-(1n&a)}function b0(a,e){let n=0n,h=0,m=e.get();for(;m<a.length;){const y=a[m++];if(n|=BigInt(127&y)<<BigInt(h),!(128&y))break;if(h+=7,h>=64)throw new Error("Varint too long")}return e.set(m),n}function ru(a,e,n){const h=new Int32Array(n);let m=0;for(let y=0;y<e;y++){const v=a[y];h.fill(a[y+e],m,m+v),m+=v}return h}function L_(a,e,n){const h=new BigInt64Array(n);let m=0;for(let y=0;y<e;y++){const v=Number(a[y]);h.fill(a[y+e],m,m+v),m+=v}return h}function z_(a,e,n){const h=new Float64Array(n);let m=0;for(let y=0;y<e;y++){const v=a[y];h.fill(a[y+e],m,m+v),m+=v}return h}function Ph(a){const e=a.length/4*4;let n=1;if(e>=4)for(let h=a[0];n<e-4;n+=4)h=a[n]+=h,h=a[n+1]+=h,h=a[n+2]+=h,h=a[n+3]+=h;for(;n!=a.length;)a[n]+=a[n-1],++n}function Gm(a){a[0]=a[0]>>>1^-(1&a[0]),a[1]=a[1]>>>1^-(1&a[1]);const e=a.length/4*4;let n=2;if(e>=4)for(;n<e-4;n+=4){const h=a[n],m=a[n+1],y=a[n+2],v=a[n+3];a[n]=(h>>>1^-(1&h))+a[n-2],a[n+1]=(m>>>1^-(1&m))+a[n-1],a[n+2]=(y>>>1^-(1&y))+a[n],a[n+3]=(v>>>1^-(1&v))+a[n+1]}for(;n!=a.length;n+=2)a[n]=(a[n]>>>1^-(1&a[n]))+a[n-2],a[n+1]=(a[n+1]>>>1^-(1&a[n+1]))+a[n-1]}(function(a){a.NONE="NONE",a.DELTA="DELTA",a.COMPONENTWISE_DELTA="COMPONENTWISE_DELTA",a.RLE="RLE",a.MORTON="MORTON",a.PDE="PDE"})(Sn||(Sn={})),(function(a){a.NONE="NONE",a.FAST_PFOR="FAST_PFOR",a.VARINT="VARINT",a.ALP="ALP"})(Ec||(Ec={})),(function(a){a.PRESENT="PRESENT",a.DATA="DATA",a.OFFSET="OFFSET",a.LENGTH="LENGTH"})(hs||(hs={}));class Hm{_dictionaryType;_offsetType;_lengthType;constructor(e,n,h){this._dictionaryType=e,this._offsetType=n,this._lengthType=h}get dictionaryType(){return this._dictionaryType}get offsetType(){return this._offsetType}get lengthType(){return this._lengthType}}function qs(a,e){const n=(function(h,m){const y=h[m.get()],v=Object.values(hs)[y>>4];let E=null;switch(v){case hs.DATA:E=new Hm(Object.values(Ac)[15&y]);break;case hs.OFFSET:E=new Hm(null,Object.values(Ih)[15&y]);break;case hs.LENGTH:E=new Hm(null,null,Object.values(Hs)[15&y])}m.increment();const k=h[m.get()],P=Object.values(Sn)[k>>5],O=Object.values(Sn)[k>>2&7],G=Object.values(Ec)[3&k];m.increment();const X=qi(h,m,2),K=X[0];return{physicalStreamType:v,logicalStreamType:E,logicalLevelTechnique1:P,logicalLevelTechnique2:O,physicalLevelTechnique:G,numValues:K,byteLength:X[1],decompressedCount:K}})(a,e);return n.logicalLevelTechnique1===Sn.MORTON?(function(h,m,y){const v=qi(m,y,2);return{physicalStreamType:h.physicalStreamType,logicalStreamType:h.logicalStreamType,logicalLevelTechnique1:h.logicalLevelTechnique1,logicalLevelTechnique2:h.logicalLevelTechnique2,physicalLevelTechnique:h.physicalLevelTechnique,numValues:h.numValues,byteLength:h.byteLength,decompressedCount:h.decompressedCount,numBits:v[0],coordinateShift:v[1]}})(n,a,e):Sn.RLE!==n.logicalLevelTechnique1&&Sn.RLE!==n.logicalLevelTechnique2||Ec.NONE===n.physicalLevelTechnique?n:(function(h,m,y){const v=qi(m,y,2);return{physicalStreamType:h.physicalStreamType,logicalStreamType:h.logicalStreamType,logicalLevelTechnique1:h.logicalLevelTechnique1,logicalLevelTechnique2:h.logicalLevelTechnique2,physicalLevelTechnique:h.physicalLevelTechnique,numValues:h.numValues,byteLength:h.byteLength,decompressedCount:v[1],runs:v[0],numRleValues:v[1]}})(n,a,e)}(function(a){a.NONE="NONE",a.SINGLE="SINGLE",a.SHARED="SHARED",a.VERTEX="VERTEX",a.MORTON="MORTON",a.FSST="FSST"})(Ac||(Ac={})),(function(a){a.VERTEX="VERTEX",a.INDEX="INDEX",a.STRING="STRING",a.KEY="KEY"})(Ih||(Ih={})),(function(a){a.VAR_BINARY="VAR_BINARY",a.GEOMETRIES="GEOMETRIES",a.PARTS="PARTS",a.RINGS="RINGS",a.TRIANGLES="TRIANGLES",a.SYMBOL="SYMBOL",a.DICTIONARY="DICTIONARY"})(Hs||(Hs={})),(function(a){a[a.FLAT=0]="FLAT",a[a.CONST=1]="CONST",a[a.SEQUENCE=2]="SEQUENCE",a[a.DICTIONARY=3]="DICTIONARY",a[a.FSST_DICTIONARY=4]="FSST_DICTIONARY"})(yi||(yi={}));class kc{values;_size;constructor(e,n){this.values=e,this._size=n}get(e){const n=Math.floor(e/8);return(this.values[n]>>e%8&1)==1}set(e,n){const h=Math.floor(e/8);this.values[h]=this.values[h]|(n?1:0)<<e%8}getInt(e){const n=Math.floor(e/8);return this.values[n]>>e%8&1}size(){return this._size}getBuffer(){return this.values}}function Zs(a,e,n,h,m){return(function(y,v,E){switch(v.logicalLevelTechnique1){case Sn.DELTA:return v.logicalLevelTechnique2===Sn.RLE?(function(k,P,O){const G=new Int32Array(O);let X=0,K=0;for(let ae=0;ae<P;ae++){const oe=k[ae],he=fs(k[ae+P]);for(let be=0;be<oe;be++)K+=he,G[X++]=K}return G})(y,v.runs,v.numRleValues):((function(k){k[0]=k[0]>>>1^-(1&k[0]);const P=k.length/4*4;let O=1;if(P>=4)for(;O<P-4;O+=4){const G=k[O],X=k[O+1],K=k[O+2],ae=k[O+3];k[O]=(G>>>1^-(1&G))+k[O-1],k[O+1]=(X>>>1^-(1&X))+k[O],k[O+2]=(K>>>1^-(1&K))+k[O+1],k[O+3]=(ae>>>1^-(1&ae))+k[O+2]}for(;O!=k.length;++O)k[O]=(k[O]>>>1^-(1&k[O]))+k[O-1]})(y),y);case Sn.RLE:return(function(k,P,O){return O?(function(G,X,K){const ae=new Int32Array(K);let oe=0;for(let he=0;he<X;he++){const be=G[he];let Ze=G[he+X];Ze=Ze>>>1^-(1&Ze),ae.fill(Ze,oe,oe+be),oe+=be}return ae})(k,P.runs,P.numRleValues):ru(k,P.runs,P.numRleValues)})(y,v,E);case Sn.MORTON:return Ph(y),y;case Sn.COMPONENTWISE_DELTA:return Gm(y),y;case Sn.NONE:return E&&(function(k){for(let P=0;P<k.length;P++){const O=k[P];k[P]=O>>>1^-(1&O)}})(y),y;default:throw new Error(`The specified Logical level technique is not supported: ${v.logicalLevelTechnique1}`)}})(w0(a,e,n),n,h)}function Fh(a,e,n){return(function(h,m){if(m.logicalLevelTechnique1===Sn.DELTA&&m.logicalLevelTechnique2===Sn.NONE)return(function(v){const E=new Int32Array(v.length+1);E[0]=0,E[1]=fs(v[0]);let k=E[1],P=2;for(;P!=E.length;++P){const O=v[P-1];k+=O>>>1^-(1&O),E[P]=E[P-1]+k}return E})(h);if(m.logicalLevelTechnique1===Sn.RLE&&m.logicalLevelTechnique2===Sn.NONE)return(function(v,E,k){const P=new Int32Array(k+1);P[0]=0;let O=1,G=P[0];for(let X=0;X<E;X++){const K=v[X],ae=v[X+E];for(let oe=O;oe<O+K;oe++)P[oe]=ae+G,G=P[oe];O+=K}return P})(h,m.runs,m.numRleValues);if(m.logicalLevelTechnique1===Sn.NONE&&m.logicalLevelTechnique2===Sn.NONE){(function(v){let E=0;for(let k=0;k<v.length;k++)v[k]+=E,E=v[k]})(h);const y=new Int32Array(m.numValues+1);return y[0]=0,y.set(h,1),y}if(m.logicalLevelTechnique1===Sn.DELTA&&m.logicalLevelTechnique2===Sn.RLE){const y=(function(v,E,k){const P=new Int32Array(k+1);P[0]=0;let O=1,G=P[0];for(let X=0;X<E;X++){const K=v[X];let ae=v[X+E];ae=ae>>>1^-(1&ae);for(let oe=O;oe<O+K;oe++)P[oe]=ae+G,G=P[oe];O+=K}return P})(h,m.runs,m.numRleValues);return Ph(y),y}throw new Error("Only delta encoding is supported for transforming length to offset streams yet.")})(w0(a,e,n),n)}function w0(a,e,n){const h=n.physicalLevelTechnique;if(h===Ec.FAST_PFOR)return sd();if(h===Ec.VARINT)return qi(a,e,n.numValues);if(h===Ec.NONE){const m=e.get();e.add(n.byteLength);const y=a.subarray(m,e.get());return new Int32Array(y)}throw new Error("Specified physicalLevelTechnique is not supported (yet).")}function qm(a,e,n,h){const m=w0(a,e,n);if(m.length===1){const y=m[0];return h?fs(y):y}return h?(function(y){return fs(y[1])})(m):(function(y){return y[1]})(m)}function Zm(a,e,n){return(function(h){if(h.length==2){const m=fs(h[1]);return[m,m]}return[fs(h[2]),fs(h[3])]})(w0(a,e,n))}function vf(a,e,n){return(function(h){if(h.length==2){const m=yf(h[1]);return[m,m]}return[yf(h[2]),yf(h[3])]})(tp(a,e,n.numValues))}function od(a,e,n,h){return(function(m,y,v){switch(y.logicalLevelTechnique1){case Sn.DELTA:return y.logicalLevelTechnique2===Sn.RLE?(function(E,k,P){const O=new BigInt64Array(P);let G=0,X=0n;for(let K=0;K<k;K++){const ae=Number(E[K]),oe=yf(E[K+k]);for(let he=0;he<ae;he++)X+=oe,O[G++]=X}return O})(m,y.runs,y.numRleValues):((function(E){E[0]=E[0]>>1n^-(1n&E[0]);const k=E.length/4*4;let P=1;if(k>=4)for(;P<k-4;P+=4){const O=E[P],G=E[P+1],X=E[P+2],K=E[P+3];E[P]=(O>>1n^-(1n&O))+E[P-1],E[P+1]=(G>>1n^-(1n&G))+E[P],E[P+2]=(X>>1n^-(1n&X))+E[P+1],E[P+3]=(K>>1n^-(1n&K))+E[P+2]}for(;P!=E.length;++P)E[P]=(E[P]>>1n^-(1n&E[P]))+E[P-1]})(m),m);case Sn.RLE:return(function(E,k,P){return P?(function(O,G,X){const K=new BigInt64Array(X);let ae=0;for(let oe=0;oe<G;oe++){const he=Number(O[oe]);let be=O[oe+G];be=be>>1n^-(1n&be),K.fill(be,ae,ae+he),ae+=he}return K})(E,k.runs,k.numRleValues):L_(E,k.runs,k.numRleValues)})(m,y,v);case Sn.NONE:return v&&(function(E){for(let k=0;k<E.length;k++){const P=E[k];E[k]=P>>1n^-(1n&P)}})(m),m;default:throw new Error(`The specified Logical level technique is not supported: ${y.logicalLevelTechnique1}`)}})(tp(a,e,n.numValues),n,h)}function Wm(a,e,n,h){const m=tp(a,e,n.numValues);if(m.length===1){const y=m[0];return h?yf(y):y}return h?(function(y){return yf(y[1])})(m):(function(y){return y[1]})(m)}function $m(a,e,n,h,m){return(function(y,v,E,k){switch(v.logicalLevelTechnique1){case Sn.DELTA:return v.logicalLevelTechnique2===Sn.RLE&&(y=ru(y,v.runs,v.numRleValues)),(function(P,O){const G=new Int32Array(P.size());let X=0;P.get(0)?(G[0]=P.get(0)?O[0]>>>1^-(1&O[0]):0,X=1):G[0]=0;let K=1;for(;K!=G.length;++K)G[K]=P.get(K)?G[K-1]+(O[X]>>>1^-(1&O[X++])):G[K-1];return G})(k,y);case Sn.RLE:return(function(P,O,G,X){const K=O;return G?(function(ae,oe,he){const be=new Int32Array(ae.size());let Ze=0;for(let Se=0;Se<he;Se++){const Ce=oe[Se];let Ye=oe[Se+he];Ye=Ye>>>1^-(1&Ye);for(let it=Ze;it<Ze+Ce;it++)ae.get(it)?be[it]=Ye:(be[it]=0,Ze++);Ze+=Ce}return be})(X,P,K.runs):(function(ae,oe,he){const be=new Int32Array(ae.size());let Ze=0;for(let Se=0;Se<he;Se++){const Ce=oe[Se],Ye=oe[Se+he];for(let it=Ze;it<Ze+Ce;it++)ae.get(it)?be[it]=Ye:(be[it]=0,Ze++);Ze+=Ce}return be})(X,P,K.runs)})(y,v,E,k);case Sn.MORTON:return Ph(y),y;case Sn.COMPONENTWISE_DELTA:return Gm(y),y;case Sn.NONE:return y=E?(function(P,O){const G=new Int32Array(P.size());let X=0,K=0;for(;K!=G.length;++K)if(P.get(K)){const ae=O[X++];G[K]=ae>>>1^-(1&ae)}else G[K]=0;return G})(k,y):(function(P,O){const G=new Int32Array(P.size());let X=0,K=0;for(;K!=G.length;++K)G[K]=P.get(K)?O[X++]:0;return G})(k,y),y;default:throw new Error("The specified Logical level technique is not supported")}})(n.physicalLevelTechnique===Ec.FAST_PFOR?sd():qi(a,e,n.numValues),n,h,m)}function qu(a,e,n,h){const m=a.logicalLevelTechnique1;if(m===Sn.RLE)return a.runs===1?yi.CONST:yi.FLAT;const y=e instanceof kc?e.size():e;if(m===Sn.DELTA&&a.logicalLevelTechnique2===Sn.RLE){const v=a.runs,E=2;if(a.numRleValues!==y)return yi.FLAT;if(v===1)return yi.SEQUENCE;if(v===2){const k=h.get();let P;if(a.physicalLevelTechnique===Ec.VARINT)P=qi(n,h,4);else{const O=h.get();P=new Int32Array(n.buffer,n.byteOffset+O,4)}if(h.set(k),P[2]===E&&P[3]===E)return yi.SEQUENCE}}return a.numValues===1?yi.CONST:yi.FLAT}class ld extends y0{getValueFromBuffer(e){return this.dataBuffer[e]}}class Xm extends jm{constructor(e,n,h,m){super(e,BigInt64Array.of(n),h,m)}getValueFromBuffer(e){return this.dataBuffer[0]+BigInt(e)*this.delta}}class Zu{_geometryOffsets;_partOffsets;_ringOffsets;constructor(e,n,h){this._geometryOffsets=e,this._partOffsets=n,this._ringOffsets=h}get geometryOffsets(){return this._geometryOffsets}get partOffsets(){return this._partOffsets}get ringOffsets(){return this._ringOffsets}}function rp(a,e,n){return{x:T0(a,e)-n,y:T0(a>>1,e)-n}}function T0(a,e){let n=0;for(let h=0;h<e;h++)n|=(a&1<<2*h)>>h;return n}(function(a){a[a.POINT=0]="POINT",a[a.LINESTRING=1]="LINESTRING",a[a.POLYGON=2]="POLYGON",a[a.MULTIPOINT=3]="MULTIPOINT",a[a.MULTILINESTRING=4]="MULTILINESTRING",a[a.MULTIPOLYGON=5]="MULTIPOLYGON"})(Hi||(Hi={})),(function(a){a[a.POINT=0]="POINT",a[a.LINESTRING=1]="LINESTRING",a[a.POLYGON=2]="POLYGON"})(gl||(gl={})),(function(a){a[a.MORTON=0]="MORTON",a[a.VEC_2=1]="VEC_2",a[a.VEC_3=2]="VEC_3"})(fo||(fo={}));class S0{createPoint(e){return[[e]]}createMultiPoint(e){return e.map((n=>[n]))}createLineString(e){return[e]}createMultiLineString(e){return e}createPolygon(e,n){return[e].concat(n)}createMultiPolygon(e){return e.flat()}}function Ym(a){const e=new Array(a.numGeometries);let n=1,h=1,m=1,y=0;const v=new S0;let E=0,k=0;const P=a.mortonSettings,O=a.topologyVector,G=O.geometryOffsets,X=O.partOffsets,K=O.ringOffsets,ae=a.vertexOffsets,oe=a.containsPolygonGeometry(),he=a.vertexBuffer;for(let be=0;be<a.numGeometries;be++){const Ze=a.geometryType(be);if(Ze===Hi.POINT){if(ae&&ae.length!==0)if(a.vertexBufferType===fo.VEC_2){const Se=2*ae[k++],Ce=new C(he[Se],he[Se+1]);e[y++]=v.createPoint(Ce)}else{const Se=rp(he[ae[k++]],P.numBits,P.coordinateShift),Ce=new C(Se.x,Se.y);e[y++]=v.createPoint(Ce)}else{const Se=new C(he[E++],he[E++]);e[y++]=v.createPoint(Se)}G&&m++,X&&n++,K&&h++}else if(Ze===Hi.MULTIPOINT){const Se=G[m]-G[m-1];m++;const Ce=new Array(Se);if(ae&&ae.length!==0){for(let Ye=0;Ye<Se;Ye++){const it=2*ae[k++];Ce[Ye]=new C(he[it],he[it+1])}e[y++]=v.createMultiPoint(Ce)}else{for(let Ye=0;Ye<Se;Ye++){const it=he[E++],At=he[E++];Ce[Ye]=new C(it,At)}e[y++]=v.createMultiPoint(Ce)}}else if(Ze===Hi.LINESTRING){let Se,Ce=0;oe?(Ce=K[h]-K[h-1],h++):Ce=X[n]-X[n-1],n++,ae&&ae.length!==0?(Se=a.vertexBufferType===fo.VEC_2?ip(he,ae,k,Ce,!1):Jm(he,ae,k,Ce,!1,P),k+=Ce):(Se=Km(he,E,Ce,!1),E+=2*Ce),e[y++]=v.createLineString(Se),G&&m++}else if(Ze===Hi.POLYGON){const Se=X[n]-X[n-1];n++;const Ce=new Array(Se-1);let Ye=K[h]-K[h-1];if(h++,ae&&ae.length!==0){const it=a.vertexBufferType===fo.VEC_2?E0(he,ae,k,Ye):ap(he,ae,k,Ye,0,P);k+=Ye;for(let At=0;At<Ce.length;At++)Ye=K[h]-K[h-1],h++,Ce[At]=a.vertexBufferType===fo.VEC_2?E0(he,ae,k,Ye):ap(he,ae,k,Ye,0,P),k+=Ye;e[y++]=v.createPolygon(it,Ce)}else{const it=np(he,E,Ye);E+=2*Ye;for(let At=0;At<Ce.length;At++)Ye=K[h]-K[h-1],h++,Ce[At]=np(he,E,Ye),E+=2*Ye;e[y++]=v.createPolygon(it,Ce)}G&&m++}else if(Ze===Hi.MULTILINESTRING){const Se=G[m]-G[m-1];m++;const Ce=new Array(Se);if(ae&&ae.length!==0){for(let Ye=0;Ye<Se;Ye++){let it=0;oe?(it=K[h]-K[h-1],h++):it=X[n]-X[n-1],n++;const At=a.vertexBufferType===fo.VEC_2?ip(he,ae,k,it,!1):Jm(he,ae,k,it,!1,P);Ce[Ye]=At,k+=it}e[y++]=v.createMultiLineString(Ce)}else{for(let Ye=0;Ye<Se;Ye++){let it=0;oe?(it=K[h]-K[h-1],h++):it=X[n]-X[n-1],n++,Ce[Ye]=Km(he,E,it,!1),E+=2*it}e[y++]=v.createMultiLineString(Ce)}}else{if(Ze!==Hi.MULTIPOLYGON)throw new Error("The specified geometry type is currently not supported.");{const Se=G[m]-G[m-1];m++;const Ce=new Array(Se);let Ye=0;if(ae&&ae.length!==0){for(let it=0;it<Se;it++){const At=X[n]-X[n-1];n++;const Wt=new Array(At-1);Ye=K[h]-K[h-1],h++;const Nt=a.vertexBufferType===fo.VEC_2?E0(he,ae,k,Ye):ap(he,ae,k,Ye,0,P);k+=Ye;for(let rr=0;rr<Wt.length;rr++)Ye=K[h]-K[h-1],h++,Wt[rr]=a.vertexBufferType===fo.VEC_2?E0(he,ae,k,Ye):ap(he,ae,k,Ye,0,P),k+=Ye;Ce[it]=v.createPolygon(Nt,Wt)}e[y++]=v.createMultiPolygon(Ce)}else{for(let it=0;it<Se;it++){const At=X[n]-X[n-1];n++;const Wt=new Array(At-1);Ye=K[h]-K[h-1],h++;const Nt=np(he,E,Ye);E+=2*Ye;for(let rr=0;rr<Wt.length;rr++){const wr=K[h]-K[h-1];h++,Wt[rr]=np(he,E,wr),E+=2*wr}Ce[it]=v.createPolygon(Nt,Wt)}e[y++]=v.createMultiPolygon(Ce)}}}}return e}function np(a,e,n){return Km(a,e,n,!0)}function E0(a,e,n,h){return ip(a,e,n,h,!0)}function ap(a,e,n,h,m,y){return Jm(a,e,n,h,!0,y)}function Km(a,e,n,h){const m=new Array(h?n+1:n);for(let y=0;y<2*n;y+=2)m[y/2]=new C(a[e+y],a[e+y+1]);return h&&(m[m.length-1]=m[0]),m}function ip(a,e,n,h,m){const y=new Array(m?h+1:h);for(let v=0;v<2*h;v+=2){const E=2*e[n+v/2];y[v/2]=new C(a[E],a[E+1])}return m&&(y[y.length-1]=y[0]),y}function Jm(a,e,n,h,m,y){const v=new Array(m?h+1:h);for(let E=0;E<h;E++){const k=rp(a[e[n+E]],y.numBits,y.coordinateShift);v[E]=new C(k.x,k.y)}return m&&(v[v.length-1]=v[0]),v}class sp{_vertexBufferType;_topologyVector;_vertexOffsets;_vertexBuffer;_mortonSettings;constructor(e,n,h,m,y){this._vertexBufferType=e,this._topologyVector=n,this._vertexOffsets=h,this._vertexBuffer=m,this._mortonSettings=y}get vertexBufferType(){return this._vertexBufferType}get topologyVector(){return this._topologyVector}get vertexOffsets(){return this._vertexOffsets}get vertexBuffer(){return this._vertexBuffer}*[Symbol.iterator](){const e=Ym(this);let n=0;for(;n<this.numGeometries;)yield{coordinates:e[n],type:this.geometryType(n)},n++}getSimpleEncodedVertex(e){const n=this.vertexOffsets?2*this.vertexOffsets[e]:2*e;return[this.vertexBuffer[n],this.vertexBuffer[n+1]]}getVertex(e){if(this.vertexOffsets&&this.mortonSettings){const h=rp(this.vertexBuffer[this.vertexOffsets[e]],this.mortonSettings.numBits,this.mortonSettings.coordinateShift);return[h.x,h.y]}const n=this.vertexOffsets?2*this.vertexOffsets[e]:2*e;return[this.vertexBuffer[n],this.vertexBuffer[n+1]]}getGeometries(){return Ym(this)}get mortonSettings(){return this._mortonSettings}}class op extends sp{_numGeometries;_geometryType;constructor(e,n,h,m,y,v,E){super(h,m,y,v,E),this._numGeometries=e,this._geometryType=n}geometryType(e){return this._geometryType}get numGeometries(){return this._numGeometries}containsPolygonGeometry(){return this._geometryType===Hi.POLYGON||this._geometryType===Hi.MULTIPOLYGON}containsSingleGeometryType(){return!0}}class lp extends sp{_geometryTypes;constructor(e,n,h,m,y,v){super(e,h,m,y,v),this._geometryTypes=n}geometryType(e){return this._geometryTypes[e]}get numGeometries(){return this._geometryTypes.length}containsPolygonGeometry(){for(let e=0;e<this.numGeometries;e++)if(this.geometryType(e)===Hi.POLYGON||this.geometryType(e)===Hi.MULTIPOLYGON)return!0;return!1}containsSingleGeometryType(){return!1}}class O_{_triangleOffsets;_indexBuffer;_vertexBuffer;_topologyVector;constructor(e,n,h,m){this._triangleOffsets=e,this._indexBuffer=n,this._vertexBuffer=h,this._topologyVector=m}get triangleOffsets(){return this._triangleOffsets}get indexBuffer(){return this._indexBuffer}get vertexBuffer(){return this._vertexBuffer}get topologyVector(){return this._topologyVector}getGeometries(){if(!this._topologyVector)throw new Error("Cannot convert GpuVector to coordinates without topology information");const e=new Array(this.numGeometries),n=this._topologyVector,h=n.partOffsets,m=n.ringOffsets,y=n.geometryOffsets;let v=0,E=1,k=1,P=1;for(let O=0;O<this.numGeometries;O++)switch(this.geometryType(O)){case Hi.POLYGON:{const G=h[E]-h[E-1];E++;const X=[];for(let K=0;K<G;K++){const ae=m[k]-m[k-1];k++;const oe=[];for(let he=0;he<ae;he++){const be=this._vertexBuffer[v++],Ze=this._vertexBuffer[v++];oe.push(new C(be,Ze))}oe.length>0&&oe.push(oe[0]),X.push(oe)}e[O]=X,y&&P++}break;case Hi.MULTIPOLYGON:{const G=y[P]-y[P-1];P++;const X=[];for(let K=0;K<G;K++){const ae=h[E]-h[E-1];E++;for(let oe=0;oe<ae;oe++){const he=m[k]-m[k-1];k++;const be=[];for(let Ze=0;Ze<he;Ze++){const Se=this._vertexBuffer[v++],Ce=this._vertexBuffer[v++];be.push(new C(Se,Ce))}be.length>0&&be.push(be[0]),X.push(be)}}e[O]=X}}return e}[Symbol.iterator](){return null}}function cd(a,e,n,h,m,y){return new Wx(a,e,n,h,m,y)}class Wx extends O_{_numGeometries;_geometryType;constructor(e,n,h,m,y,v){super(h,m,y,v),this._numGeometries=e,this._geometryType=n}geometryType(e){return this._geometryType}get numGeometries(){return this._numGeometries}containsSingleGeometryType(){return!0}}function Qm(a,e,n,h,m){return new B_(a,e,n,h,m)}class B_ extends O_{_geometryTypes;constructor(e,n,h,m,y){super(n,h,m,y),this._geometryTypes=e}geometryType(e){return this._geometryTypes[e]}get numGeometries(){return this._geometryTypes.length}containsSingleGeometryType(){return!1}}function N_(a,e,n,h,m){const y=qs(a,n);let v=null,E=null,k=null,P=null,O=null,G=null,X=null,K=null;if(qu(y,h,a,n)===yi.CONST){const oe=qm(a,n,y,!1);for(let he=0;he<e-1;he++){const be=qs(a,n);switch(be.physicalStreamType){case hs.LENGTH:switch(be.logicalStreamType.lengthType){case Hs.GEOMETRIES:v=Fh(a,n,be);break;case Hs.PARTS:E=Fh(a,n,be);break;case Hs.RINGS:k=Fh(a,n,be);break;case Hs.TRIANGLES:X=Fh(a,n,be)}break;case hs.OFFSET:switch(be.logicalStreamType.offsetType){case Ih.VERTEX:P=Zs(a,n,be,!1);break;case Ih.INDEX:K=Zs(a,n,be,!1)}break;case hs.DATA:Ac.VERTEX===be.logicalStreamType.dictionaryType?O=Zs(a,n,be,!0):(G={numBits:be.numBits,coordinateShift:be.coordinateShift},O=Zs(a,n,be,!1))}}return K!==null?v!=null||E!=null?cd(h,oe,X,K,O,new Zu(v,E,k)):cd(h,oe,X,K,O):G===null?(function(he,be,Ze,Se,Ce){return new op(he,be,fo.VEC_2,Ze,Se,Ce)})(h,oe,new Zu(v,E,k),P,O):(function(he,be,Ze,Se,Ce,Ye){return new op(he,be,fo.MORTON,Ze,Se,Ce,Ye)})(h,oe,new Zu(v,E,k),P,O,G)}const ae=Zs(a,n,y,!1);for(let oe=0;oe<e-1;oe++){const he=qs(a,n);switch(he.physicalStreamType){case hs.LENGTH:switch(he.logicalStreamType.lengthType){case Hs.GEOMETRIES:v=Zs(a,n,he,!1);break;case Hs.PARTS:E=Zs(a,n,he,!1);break;case Hs.RINGS:k=Zs(a,n,he,!1);break;case Hs.TRIANGLES:X=Fh(a,n,he)}break;case hs.OFFSET:switch(he.logicalStreamType.offsetType){case Ih.VERTEX:P=Zs(a,n,he,!1);break;case Ih.INDEX:K=Zs(a,n,he,!1)}break;case hs.DATA:Ac.VERTEX===he.logicalStreamType.dictionaryType?O=Zs(a,n,he,!0):(G={numBits:he.numBits,coordinateShift:he.coordinateShift},O=Zs(a,n,he,!1))}}return K!==null&&E===null?Qm(ae,X,K,O):(v!==null?(v=A0(ae,v,2),E!==null&&k!==null?(E=k0(ae,v,E,!1),k=(function(oe,he,be,Ze){const Se=new Int32Array(be[be.length-1]+1);let Ce=0;Se[0]=Ce;let Ye=1,it=1,At=0;for(let Wt=0;Wt<oe.length;Wt++){const Nt=oe[Wt],rr=he[Wt+1]-he[Wt];if(Nt!==0&&Nt!==3)for(let wr=0;wr<rr;wr++){const ar=be[Ye]-be[Ye-1];Ye++;for(let qt=0;qt<ar;qt++)Ce=Se[it++]=Ce+Ze[At++]}else for(let wr=0;wr<rr;wr++)Se[it++]=++Ce,Ye++}return Se})(ae,v,E,k)):E!==null&&(E=(function(oe,he,be){const Ze=new Int32Array(he[he.length-1]+1);let Se=0;Ze[0]=Se;let Ce=1,Ye=0;for(let it=0;it<oe.length;it++){const At=oe[it],Wt=he[it+1]-he[it];if(At===4||At===1)for(let Nt=0;Nt<Wt;Nt++)Se=Ze[Ce++]=Se+be[Ye++];else for(let Nt=0;Nt<Wt;Nt++)Ze[Ce++]=++Se}return Ze})(ae,v,E))):E!==null&&k!==null?(E=A0(ae,E,1),k=k0(ae,E,k,!0)):E!==null&&(E=A0(ae,E,0)),K!==null?Qm(ae,X,K,O,new Zu(v,E,k)):G===null?(function(oe,he,be,Ze){return new lp(fo.VEC_2,oe,he,be,Ze)})(ae,new Zu(v,E,k),P,O):(function(oe,he,be,Ze,Se){return new lp(fo.MORTON,oe,he,be,Ze,Se)})(ae,new Zu(v,E,k),P,O,G))}function A0(a,e,n){const h=new Int32Array(a.length+1);let m=0;h[0]=m;let y=0;for(let v=0;v<a.length;v++)m=h[v+1]=m+(a[v]>n?e[y++]:1);return h}function k0(a,e,n,h){const m=new Int32Array(e[e.length-1]+1);let y=0;m[0]=y;let v=1,E=0;for(let k=0;k<a.length;k++){const P=a[k],O=e[k+1]-e[k];if(P===5||P===2||h&&(P===4||P===1))for(let G=0;G<O;G++)y=m[v++]=y+n[E++];else for(let G=0;G<O;G++)m[v++]=++y}return m}class j_ extends Dh{dataVector;constructor(e,n,h){super(e,n.getBuffer(),h),this.dataVector=n}getValueFromBuffer(e){return this.dataVector.get(e)}}class U_ extends y0{getValueFromBuffer(e){return this.dataBuffer[e]}}class cp extends Dh{constructor(e,n,h){super(e,BigInt64Array.of(n),h)}getValueFromBuffer(e){return this.dataBuffer[0]}}function up(a,e,n){return V_(a,Math.ceil(e/8),n)}function V_(a,e,n){const h=new Uint8Array(e);let m=0;for(;m<e;){const y=a[n.increment()];if(y<=127){const v=y+3,E=a[n.increment()],k=m+v;h.fill(E,m,k),m=k}else{const v=256-y;for(let E=0;E<v;E++)h[m++]=a[n.increment()]}}return h}const eg=new TextDecoder;function hp(a,e,n){return n-e>=12?eg.decode(a.subarray(e,n)):(function(h,m,y){let v="",E=m;for(;E<y;){const k=h[E];let P,O,G,X=null,K=k>239?4:k>223?3:k>191?2:1;if(E+K>y)break;K===1?k<128&&(X=k):K===2?(P=h[E+1],(192&P)==128&&(X=(31&k)<<6|63&P,X<=127&&(X=null))):K===3?(P=h[E+1],O=h[E+2],(192&P)==128&&(192&O)==128&&(X=(15&k)<<12|(63&P)<<6|63&O,(X<=2047||X>=55296&&X<=57343)&&(X=null))):K===4&&(P=h[E+1],O=h[E+2],G=h[E+3],(192&P)==128&&(192&O)==128&&(192&G)==128&&(X=(15&k)<<18|(63&P)<<12|(63&O)<<6|63&G,(X<=65535||X>=1114112)&&(X=null))),X===null?(X=65533,K=1):X>65535&&(X-=65536,v+=String.fromCharCode(X>>>10&1023|55296),X=56320|1023&X),v+=String.fromCharCode(X),E+=K}return v})(a,e,n)}class ud extends Dh{offsetBuffer;constructor(e,n,h,m){super(e,h,m),this.offsetBuffer=n}}class C0 extends ud{textEncoder;constructor(e,n,h,m){super(e,n,h,m??n.length-1),this.textEncoder=new TextEncoder}getValueFromBuffer(e){return hp(this.dataBuffer,this.offsetBuffer[e],this.offsetBuffer[e+1])}}class bf extends ud{indexBuffer;textEncoder;constructor(e,n,h,m,y){super(e,h,m,y??n.length),this.indexBuffer=n,this.indexBuffer=n,this.textEncoder=new TextEncoder}getValueFromBuffer(e){const n=this.indexBuffer[e];return hp(this.dataBuffer,this.offsetBuffer[n],this.offsetBuffer[n+1])}}class M0 extends ud{indexBuffer;symbolOffsetBuffer;symbolTableBuffer;textEncoder;symbolLengthBuffer;lengthBuffer;decodedDictionary;constructor(e,n,h,m,y,v,E){super(e,h,m,E),this.indexBuffer=n,this.symbolOffsetBuffer=y,this.symbolTableBuffer=v,this.textEncoder=new TextEncoder}getValueFromBuffer(e){this.decodedDictionary==null&&(this.symbolLengthBuffer==null&&(this.symbolLengthBuffer=this.offsetToLengthBuffer(this.symbolOffsetBuffer),this.lengthBuffer=this.offsetToLengthBuffer(this.offsetBuffer)),this.decodedDictionary=(function(h,m,y){const v=[],E=new Array(m.length).fill(0);for(let k=1;k<m.length;k++)E[k]=E[k-1]+m[k-1];for(let k=0;k<y.length;k++)if(y[k]===255)v.push(y[++k]);else{const P=m[y[k]],O=E[y[k]];for(let G=0;G<P;G++)v.push(h[O+G])}return new Uint8Array(v)})(this.symbolTableBuffer,this.symbolLengthBuffer,this.dataBuffer));const n=this.indexBuffer[e];return hp(this.decodedDictionary,this.offsetBuffer[n],this.offsetBuffer[n+1])}offsetToLengthBuffer(e){const n=new Uint32Array(e.length-1);let h=e[0];for(let m=1;m<e.length;m++){const y=e[m];n[m-1]=y-h,h=y}return n}}function Lh(a,e,n,h,m,y){return n.type==="scalarType"?(function(v,E,k,P,O,G){let X=null,K=0;if(v===0)return null;if(G.nullable){const oe=qs(E,k);K=oe.numValues;const he=k.get(),be=up(E,K,k);k.set(he+oe.byteLength),X=new kc(be,oe.numValues)}const ae=X??P;switch(O.physicalType){case 4:case 3:return(function(oe,he,be,Ze,Se){const Ce=qs(oe,he),Ye=qu(Ce,Se,oe,he),it=Ze.physicalType===3;if(Ye===yi.FLAT){const At=Xl(Se)?$m(oe,he,Ce,it,Se):Zs(oe,he,Ce,it);return new v0(be.name,At,Se)}if(Ye===yi.SEQUENCE){const At=Zm(oe,he,Ce);return new Um(be.name,At[0],At[1],Ce.numRleValues)}{const At=qm(oe,he,Ce,it);return new Vm(be.name,At,Se)}})(E,k,G,O,ae);case 9:return(function(oe,he,be,Ze,Se){let Ce=null,Ye=null,it=null,At=null,Wt=null,Nt=null,rr=null,wr=null;for(let ar=0;ar<Ze;ar++){const qt=qs(he,be);if(qt.byteLength!==0)switch(qt.physicalStreamType){case hs.PRESENT:{const Lt=up(he,qt.numValues,be);Nt=new kc(Lt,qt.numValues);break}case hs.OFFSET:Ye=Se!=null||Nt!=null?$m(he,be,qt,!1,Se??Nt):Zs(he,be,qt,!1);break;case hs.LENGTH:{const Lt=Fh(he,be,qt);Hs.DICTIONARY===qt.logicalStreamType.lengthType?Ce=Lt:Hs.SYMBOL===qt.logicalStreamType.lengthType?At=Lt:rr=Lt;break}case hs.DATA:{const Lt=he.subarray(be.get(),be.get()+qt.byteLength);be.add(qt.byteLength);const Pr=qt.logicalStreamType.dictionaryType;Ac.FSST===Pr?Wt=Lt:Ac.SINGLE===Pr||Ac.SHARED===Pr?it=Lt:Ac.NONE===Pr&&(wr=Lt);break}}}return(function(ar,qt,Lt,Pr,Cr,zr,Er){return qt?new M0(ar,Lt,Pr,Cr,zr,qt,Er):null})(oe,Wt,Ye,Ce,it,At,Se??Nt)??(function(ar,qt,Lt,Pr,Cr){return qt?Cr?new bf(ar,Lt,Pr,qt,Cr):new bf(ar,Lt,Pr,qt):null})(oe,it,Ye,Ce,Se??Nt)??(function(ar,qt,Lt,Pr,Cr){if(!qt||!Lt)return null;if(Pr)return Cr?new bf(ar,Pr,qt,Lt,Cr):new bf(ar,Pr,qt,Lt);if(Cr&&Cr.size()!==qt.length-1){const zr=new Int32Array(Cr.size());let Er=0;for(let Zr=0;Zr<Cr.size();Zr++)zr[Zr]=Cr.get(Zr)?Er++:0;return new bf(ar,zr,qt,Lt,Cr)}return Cr?new C0(ar,qt,Lt,Cr):new C0(ar,qt,Lt)})(oe,rr,wr,Ye,Se??Nt)})(G.name,E,k,G.nullable?v-1:v,X);case 0:return(function(oe,he,be,Ze,Se){const Ce=qs(oe,he),Ye=Ce.numValues,it=he.get(),At=Xl(Se)?(function(Nt,rr,wr,ar){const qt=V_(Nt,Math.ceil(rr/8),wr),Lt=new kc(qt,rr),Pr=ar.size(),Cr=new kc(new Uint8Array(Pr),Pr);let zr=0;for(let Er=0;Er<ar.size();Er++){const Zr=!!ar.get(Er)&&Lt.get(zr++);Cr.set(Er,Zr)}return Cr.getBuffer()})(oe,Ye,he,Se):up(oe,Ye,he);he.set(it+Ce.byteLength);const Wt=new kc(At,Ye);return new j_(be.name,Wt,Se)})(E,k,G,0,ae);case 6:case 5:return(function(oe,he,be,Ze,Se){const Ce=qs(oe,he),Ye=qu(Ce,Ze,oe,he),it=Se.physicalType===5;if(Ye===yi.FLAT){const At=Xl(Ze)?(function(Wt,Nt,rr,wr,ar){return(function(qt,Lt,Pr,Cr){switch(Lt.logicalLevelTechnique1){case Sn.DELTA:return Lt.logicalLevelTechnique2===Sn.RLE&&(qt=L_(qt,Lt.runs,Lt.numRleValues)),(function(zr,Er){const Zr=new BigInt64Array(zr.size());let qn=0;zr.get(0)?(Zr[0]=zr.get(0)?Er[0]>>1n^-(1n&Er[0]):0n,qn=1):Zr[0]=0n;let Mn=1;for(;Mn!=Zr.length;++Mn)Zr[Mn]=zr.get(Mn)?Zr[Mn-1]+(Er[qn]>>1n^-(1n&Er[qn++])):Zr[Mn-1];return Zr})(Cr,qt);case Sn.RLE:return(function(zr,Er,Zr,qn){const Mn=Er;return Zr?(function(ei,Ws,Zi){const ti=new BigInt64Array(ei.size());let Va=0;for(let ia=0;ia<Zi;ia++){const di=Number(Ws[ia]);let vi=Ws[ia+Zi];vi=vi>>1n^-(1n&vi);for(let La=Va;La<Va+di;La++)ei.get(La)?ti[La]=vi:(ti[La]=0n,Va++);Va+=di}return ti})(qn,zr,Mn.runs):(function(ei,Ws,Zi){const ti=new BigInt64Array(ei.size());let Va=0;for(let ia=0;ia<Zi;ia++){const di=Number(Ws[ia]),vi=Ws[ia+Zi];for(let La=Va;La<Va+di;La++)ei.get(La)?ti[La]=vi:(ti[La]=0n,Va++);Va+=di}return ti})(qn,zr,Mn.runs)})(qt,Lt,Pr,Cr);case Sn.NONE:return qt=Pr?(function(zr,Er){const Zr=new BigInt64Array(zr.size());let qn=0,Mn=0;for(;Mn!=Zr.length;++Mn)if(zr.get(Mn)){const ei=Er[qn++];Zr[Mn]=ei>>1n^-(1n&ei)}else Zr[Mn]=0n;return Zr})(Cr,qt):(function(zr,Er){const Zr=new BigInt64Array(zr.size());let qn=0,Mn=0;for(;Mn!=Zr.length;++Mn)Zr[Mn]=zr.get(Mn)?Er[qn++]:0n;return Zr})(Cr,qt),qt;default:throw new Error("The specified Logical level technique is not supported")}})(tp(Wt,Nt,rr.numValues),rr,wr,ar)})(oe,he,Ce,it,Ze):od(oe,he,Ce,it);return new ld(be.name,At,Ze)}if(Ye===yi.SEQUENCE){const At=vf(oe,he,Ce);return new Xm(be.name,At[0],At[1],Ce.numRleValues)}{const At=Wm(oe,he,Ce,it);return new cp(be.name,At,Ze)}})(E,k,G,ae,O);case 7:return(function(oe,he,be,Ze){const Se=qs(oe,he),Ce=Xl(Ze)?(function(Ye,it,At,Wt){const Nt=it.get(),rr=Nt+Wt*Float32Array.BYTES_PER_ELEMENT,wr=new Uint8Array(Ye.subarray(Nt,rr)).buffer,ar=new Float32Array(wr);it.set(rr);const qt=At.size(),Lt=new Float32Array(qt);let Pr=0;for(let Cr=0;Cr<qt;Cr++)Lt[Cr]=At.get(Cr)?ar[Pr++]:0;return Lt})(oe,he,Ze,Se.numValues):(function(Ye,it,At){const Wt=it.get(),Nt=Wt+At*Float32Array.BYTES_PER_ELEMENT,rr=new Uint8Array(Ye.subarray(Wt,Nt)).buffer,wr=new Float32Array(rr);return it.set(Nt),wr})(oe,he,Se.numValues);return new U_(be.name,Ce,Ze)})(E,k,G,ae);case 8:return(function(oe,he,be,Ze){const Se=qs(oe,he),Ce=Xl(Ze)?(function(Ye,it,At,Wt){const Nt=it.get(),rr=Nt+Wt*Float64Array.BYTES_PER_ELEMENT,wr=new Uint8Array(Ye.subarray(Nt,rr)).buffer,ar=new Float64Array(wr);it.set(rr);const qt=At.size(),Lt=new Float64Array(qt);let Pr=0;for(let Cr=0;Cr<qt;Cr++)Lt[Cr]=At.get(Cr)?ar[Pr++]:0;return Lt})(oe,he,Ze,Se.numValues):(function(Ye,it,At){const Wt=it.get(),Nt=Wt+At*Float64Array.BYTES_PER_ELEMENT,rr=new Uint8Array(Ye.subarray(Wt,Nt)).buffer,wr=new Float64Array(rr);return it.set(Nt),wr})(oe,he,Se.numValues);return new Nm(be.name,Ce,Ze)})(E,k,G,ae);default:throw new Error(`The specified data type for the field is currently not supported: ${O}`)}})(h,a,e,m,n.scalarType,n):h!=1?null:(function(v,E,k,P){let O=null,G=null,X=null,K=null,ae=!1;for(;!ae;){const Ze=qs(v,E);switch(Ze.physicalStreamType){case hs.LENGTH:Hs.DICTIONARY===Ze.logicalStreamType.lengthType?O=Fh(v,E,Ze):X=Fh(v,E,Ze);break;case hs.DATA:Ac.SINGLE===Ze.logicalStreamType.dictionaryType||Ac.SHARED===Ze.logicalStreamType.dictionaryType?(G=v.subarray(E.get(),E.get()+Ze.byteLength),ae=!0):K=v.subarray(E.get(),E.get()+Ze.byteLength),E.add(Ze.byteLength)}}const oe=k.complexType.children,he=[];let be=0;for(const Ze of oe){const Se=qi(v,E,1)[0];if(Se==0)continue;const Ce=`${k.name}${Ze.name==="default"?"":":"+Ze.name}`;if(Se!==2||Ze.type!=="scalarField"||Ze.scalarField.physicalType!==9)throw new Error("Currently only optional string fields are implemented for a struct.");const Ye=qs(v,E),it=up(v,Ye.numValues,E),At=qs(v,E),Wt=At.decompressedCount!==P?$m(v,E,At,!1,new kc(it,Ye.numValues)):Zs(v,E,At,!1);he[be++]=K?new M0(Ce,Wt,O,G,X,K,new kc(it,Ye.numValues)):new bf(Ce,Wt,O,G,new kc(it,Ye.numValues))}return he})(a,e,n,m)}function Xl(a){return a instanceof kc}function zh(a){if(a.name==="id")return!1;if(a.type==="scalarType"){const e=a.scalarType;if(e.type==="physicalType")switch(e.physicalType){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:default:return!1;case 9:return!0}else if(e.type==="logicalType")return!1}else if(a.type==="complexType"){const e=a.complexType;if(e.type==="physicalType")switch(e.physicalType){case 0:case 1:return!0;default:return!1}}return console.warn("Unexpected column type in hasStreamCount",a),!1}const fp=new TextDecoder;function hd(a,e){const n=qi(a,e,1)[0];if(n===0)return"";const h=e.get(),m=a.subarray(h,h+n);return e.add(n),fp.decode(m)}function Wu(a,e){const n=qi(a,e,1)[0]>>>0,h=!!(4&n),m=!!(2&n),y=qi(a,e,1)[0]>>>0,v={};if(1&n&&(v.nullable=!0),m){const E={};if(h?(E.type="logicalType",E.logicalType=y):(E.type="physicalType",E.physicalType=y),8&n){const k=qi(a,e,1)[0]>>>0;E.children=new Array(k);for(let P=0;P<k;P++)E.children[P]=Wu(a,e)}v.type="complexField",v.complexField=E}else{const E={};h?(E.type="logicalType",E.logicalType=y):(E.type="physicalType",E.physicalType=y),v.type="scalarField",v.scalarField=E}return v}function $x(a,e){const n=qi(a,e,1)[0]>>>0,h=(function(m){switch(m){case 0:case 1:case 2:case 3:{const y={};y.nullable=!!(1&m),y.columnScope=0;const v={};return v.physicalType=m>1?6:4,v.type="physicalType",y.scalarType=v,y.type="scalarType",y}case 4:{const y={nullable:!1,columnScope:0},v={type:"physicalType",physicalType:0};return y.type="complexType",y.complexType=v,y}case 30:{const y={nullable:!1,columnScope:0},v={type:"physicalType",physicalType:1};return y.type="complexType",y.complexType=v,y}default:return(function(y){let v=null;switch(y){case 10:case 11:v=0;break;case 12:case 13:v=1;break;case 14:case 15:v=2;break;case 16:case 17:v=3;break;case 18:case 19:v=4;break;case 20:case 21:v=5;break;case 22:case 23:v=6;break;case 24:case 25:v=7;break;case 26:case 27:v=8;break;case 28:case 29:v=9;break;default:return null}const E={};E.nullable=!!(1&y),E.columnScope=0;const k={type:"physicalType"};return k.physicalType=v,E.type="scalarType",E.scalarType=k,E})(m)}})(n);if(!h)throw new Error(`Unsupported column type code: ${n}`);if((function(m){return m>=10})(n)?h.name=hd(a,e):n>=0&&n<=3?h.name="id":n===4&&(h.name="geometry"),(function(m){return m===30})(n)){const m=qi(a,e,1)[0]>>>0,y=h.complexType;y.children=new Array(m);for(let v=0;v<m;v++)y.children[v]=Wu(a,e)}return h}function G_(a,e){const n={featureTables:[]},h={};h.name=hd(a,e);const m=qi(a,e,1)[0]>>>0,y=qi(a,e,1)[0]>>>0;h.columns=new Array(y);for(let v=0;v<y;v++)h.columns[v]=$x(a,e);return n.featureTables.push(h),[n,m]}function dp(a,e,n,h,m,y,v=!1){const E=e.scalarType.physicalType,k=qu(m,y,a,n);if(E===4)switch(k){case yi.FLAT:{const P=Zs(a,n,m,!1);return new v0(h,P,y)}case yi.SEQUENCE:{const P=Zm(a,n,m);return new Um(h,P[0],P[1],m.numRleValues)}case yi.CONST:{const P=qm(a,n,m,!1);return new Vm(h,P,y)}}else switch(k){case yi.FLAT:{if(v){const O=(function(G,X,K,ae){const oe=(function(he,be,Ze){const Se=new Float64Array(be);for(let Ce=0;Ce<be;Ce++)Se[Ce]=F_(he,Ze);return Se})(G,K.numValues,X);return(function(he,be,Ze){switch(be.logicalLevelTechnique1){case Sn.DELTA:return be.logicalLevelTechnique2===Sn.RLE&&(he=z_(he,be.runs,be.numRleValues)),(function(Se){Se[0]=Se[0]%2==1?(Se[0]+1)/-2:Se[0]/2;const Ce=Se.length/4*4;let Ye=1;if(Ce>=4)for(;Ye<Ce-4;Ye+=4){const it=Se[Ye],At=Se[Ye+1],Wt=Se[Ye+2],Nt=Se[Ye+3];Se[Ye]=(it%2==1?(it+1)/-2:it/2)+Se[Ye-1],Se[Ye+1]=(At%2==1?(At+1)/-2:At/2)+Se[Ye],Se[Ye+2]=(Wt%2==1?(Wt+1)/-2:Wt/2)+Se[Ye+1],Se[Ye+3]=(Nt%2==1?(Nt+1)/-2:Nt/2)+Se[Ye+2]}for(;Ye!=Se.length;++Ye)Se[Ye]=(Se[Ye]%2==1?(Se[Ye]+1)/-2:Se[Ye]/2)+Se[Ye-1]})(he),he;case Sn.RLE:return(function(Se,Ce,Ye){return z_(Se,Ce.runs,Ce.numRleValues)})(he,be);case Sn.NONE:return he;default:throw new Error(`The specified Logical level technique is not supported: ${be.logicalLevelTechnique1}`)}})(oe,K)})(a,n,m);return new Nm(h,O,y)}const P=od(a,n,m,!1);return new ld(h,P,y)}case yi.SEQUENCE:{const P=vf(a,n,m);return new Xm(h,P[0],P[1],m.numRleValues)}case yi.CONST:{const P=Wm(a,n,m,!1);return new cp(h,P,y)}}throw new Error("Vector type not supported for id column.")}class Xx{constructor(e,n){var h;switch(this._featureData=e,this.properties=this._featureData.properties||{},(h=this._featureData.geometry)===null||h===void 0?void 0:h.type){case Hi.POINT:case Hi.MULTIPOINT:this.type=1;break;case Hi.LINESTRING:case Hi.MULTILINESTRING:this.type=2;break;case Hi.POLYGON:case Hi.MULTIPOLYGON:this.type=3;break;default:this.type=0}this.extent=n,this.id=Number(this._featureData.id)}loadGeometry(){const e=[];for(const n of this._featureData.geometry.coordinates){const h=[];for(const m of n)h.push(new C(m.x,m.y));e.push(h)}return e}}class H_{constructor(e){this.features=[],this.featureTable=e,this.name=e.name,this.extent=e.extent,this.version=2,this.features=e.getFeatures(),this.length=this.features.length}feature(e){return new Xx(this.features[e],this.extent)}}class pp{constructor(e){this.layers={};const n=(function(h,m,y=!0){const v=new P_(0),E=[];for(;v.get()<h.length;){const k=qi(h,v,1)[0]>>>0,P=v.get()+k;if(P>h.length)throw new Error(`Block overruns tile: ${P} > ${h.length}`);if(qi(h,v,1)[0]>>>0!=1){v.set(P);continue}const O=G_(h,v),G=O[1],X=O[0].featureTables[0];let K=null,ae=null;const oe=[];let he=0;for(const Ze of X.columns){const Se=Ze.name;if(Se==="id"){let Ce=null;if(Ze.nullable){const it=qs(h,v),At=v.get(),Wt=up(h,it.numValues,v);v.set(At+it.byteLength),Ce=new kc(Wt,it.numValues)}const Ye=qs(h,v);he=Ye.decompressedCount,K=dp(h,Ze,v,Se,Ye,Ce??he,y)}else if(Se==="geometry"){const Ce=qi(h,v,1)[0];if(he===0){const Ye=v.get();he=qs(h,v).decompressedCount,v.set(Ye)}ae=N_(h,Ce,v,he)}else{const Ce=zh(Ze)?qi(h,v,1)[0]:1;if(Ce===0&&Ze.type==="scalarType")continue;const Ye=Lh(h,v,Ze,Ce,he);if(Ye)if(Array.isArray(Ye))for(const it of Ye)oe.push(it);else oe.push(Ye)}}const be=new Rh(X.name,ae,K,oe,G);E.push(be),v.set(P)}return E})(new Uint8Array(e));this.layers=n.reduce(((h,m)=>Object.assign(Object.assign({},h),{[m.name]:new H_(m)})),{})}}class q_{constructor(e,n){this.feature=e,this.type=e.type,this.properties=e.tags?e.tags:{},this.extent=n,"id"in e&&(typeof e.id=="string"?this.id=parseInt(e.id,10):typeof e.id!="number"||isNaN(e.id)||(this.id=e.id))}loadGeometry(){const e=[],n=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const h of n){const m=[];for(const y of h)m.push(new C(y[0],y[1]));e.push(m)}return e}}const mp="_geojsonTileLayer";function D0(a,e){e.writeVarintField(15,a.version||1),e.writeStringField(1,a.name||""),e.writeVarintField(5,a.extent||4096);const n={keys:[],values:[],keycache:{},valuecache:{}};for(let y=0;y<a.length;y++)n.feature=a.feature(y),e.writeMessage(2,R0,n);const h=n.keys;for(const y of h)e.writeStringField(3,y);const m=n.values;for(const y of m)e.writeMessage(4,I0,y)}function R0(a,e){if(!a.feature)return;const n=a.feature;n.id!==void 0&&e.writeVarintField(1,n.id),e.writeMessage(2,Z_,a),e.writeVarintField(3,n.type),e.writeMessage(4,rg,n)}function Z_(a,e){for(const n in a.feature?.properties){let h=a.feature.properties[n],m=a.keycache[n];if(h==null)continue;m===void 0&&(a.keys.push(n),m=a.keys.length-1,a.keycache[n]=m),e.writeVarint(m),typeof h!="string"&&typeof h!="boolean"&&typeof h!="number"&&(h=JSON.stringify(h));const y=typeof h+":"+h;let v=a.valuecache[y];v===void 0&&(a.values.push(h),v=a.values.length-1,a.valuecache[y]=v),e.writeVarint(v)}}function Oh(a,e){return(e<<3)+(7&a)}function tg(a){return a<<1^a>>31}function rg(a,e){const n=a.loadGeometry(),h=a.type;let m=0,y=0;for(const v of n){let E=1;h===1&&(E=v.length),e.writeVarint(Oh(1,E));const k=h===3?v.length-1:v.length;for(let P=0;P<k;P++){P===1&&h!==1&&e.writeVarint(Oh(2,k-1));const O=v[P].x-m,G=v[P].y-y;e.writeVarint(tg(O)),e.writeVarint(tg(G)),m+=O,y+=G}a.type===3&&e.writeVarint(Oh(7,1))}}function I0(a,e){const n=typeof a;n==="string"?e.writeStringField(1,a):n==="boolean"?e.writeBooleanField(7,a):n==="number"&&(a%1!=0?e.writeDoubleField(3,a):a<0?e.writeSVarintField(6,a):e.writeVarintField(5,a))}class ng{constructor(e,n){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Zc(Be,16,0),this.grid3D=new Zc(Be,16,0),this.featureIndexArray=new _e,this.promoteId=n}insert(e,n,h,m,y,v){const E=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,m,y);const k=v?this.grid3D:this.grid;for(let P=0;P<n.length;P++){const O=n[P],G=[1/0,1/0,-1/0,-1/0];for(let X=0;X<O.length;X++){const K=O[X];G[0]=Math.min(G[0],K.x),G[1]=Math.min(G[1],K.y),G[2]=Math.max(G[2],K.x),G[3]=Math.max(G[3],K.y)}G[0]<Be&&G[1]<Be&&G[2]>=0&&G[3]>=0&&k.insert(E,G[0],G[1],G[2],G[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=this.encoding!=="mlt"?new jn(new a0(this.rawTileData)).layers:new pp(this.rawTileData).layers,this.sourceLayerCoder=new Bm(this.vtLayers?Object.keys(this.vtLayers).sort():[mp])),this.vtLayers}query(e,n,h,m){this.loadVTLayers();const y=e.params,v=Be/e.tileSize/e.scale,E=gr(y.filter,y.globalState),k=e.queryGeometry,P=e.queryPadding*v,O=Mh.fromPoints(k),G=this.grid.query(O.minX-P,O.minY-P,O.maxX+P,O.maxY+P),X=Mh.fromPoints(e.cameraQueryGeometry).expandBy(P),K=this.grid3D.query(X.minX,X.minY,X.maxX,X.maxY,((he,be,Ze,Se)=>(function(Ce,Ye,it,At,Wt){for(const rr of Ce)if(Ye<=rr.x&&it<=rr.y&&At>=rr.x&&Wt>=rr.y)return!0;const Nt=[new C(Ye,it),new C(Ye,Wt),new C(At,Wt),new C(At,it)];if(Ce.length>2){for(const rr of Nt)if(Kc(Ce,rr))return!0}for(let rr=0;rr<Ce.length-1;rr++)if(Kg(Ce[rr],Ce[rr+1],Nt))return!0;return!1})(e.cameraQueryGeometry,he-P,be-P,Ze+P,Se+P)));for(const he of K)G.push(he);G.sort(P0);const ae={};let oe;for(let he=0;he<G.length;he++){const be=G[he];if(be===oe)continue;oe=be;const Ze=this.featureIndexArray.get(be);let Se=null;this.loadMatchingFeature(ae,Ze.bucketIndex,Ze.sourceLayerIndex,Ze.featureIndex,E,y.layers,y.availableImages,n,h,m,((Ce,Ye,it)=>(Se||(Se=bc(Ce)),Ye.queryIntersectsFeature({queryGeometry:k,feature:Ce,featureState:it,geometry:Se,zoom:this.z,transform:e.transform,pixelsToTileUnits:v,pixelPosMatrix:e.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:e.getElevation}))))}return ae}loadMatchingFeature(e,n,h,m,y,v,E,k,P,O,G){const X=this.bucketLayerIDs[n];if(v&&!X.some((he=>v.has(he))))return;const K=this.sourceLayerCoder.decode(h),ae=this.vtLayers[K].feature(m);if(y.needGeometry){const he=dl(ae,!0);if(!y.filter(new Jn(this.tileID.overscaledZ),he,this.tileID.canonical))return}else if(!y.filter(new Jn(this.tileID.overscaledZ),ae))return;const oe=this.getId(ae,K);for(let he=0;he<X.length;he++){const be=X[he];if(v&&!v.has(be))continue;const Ze=k[be];if(!Ze)continue;let Se={};oe&&O&&(Se=O.getState(Ze.sourceLayer||mp,oe));const Ce=Zt({},P[be]);Ce.paint=W_(Ce.paint,Ze.paint,ae,Se,E),Ce.layout=W_(Ce.layout,Ze.layout,ae,Se,E);const Ye=!G||G(ae,Ze,Se);if(!Ye)continue;const it=new x0(ae,this.z,this.x,this.y,oe);it.layer=Ce;let At=e[be];At===void 0&&(At=e[be]=[]),At.push({featureIndex:m,feature:it,intersectionZ:Ye})}}lookupSymbolFeatures(e,n,h,m,y,v,E,k){const P={};this.loadVTLayers();const O=gr(y.filterSpec,y.globalState);for(const G of e)this.loadMatchingFeature(P,h,m,G,O,v,E,k,n);return P}hasLayer(e){for(const n of this.bucketLayerIDs)for(const h of n)if(e===h)return!0;return!1}getId(e,n){var h;let m=e.id;return this.promoteId&&(m=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[n]],typeof m=="boolean"&&(m=Number(m)),m===void 0&&(!((h=e.properties)===null||h===void 0)&&h.cluster)&&this.promoteId&&(m=Number(e.properties.cluster_id))),m}}function W_(a,e,n,h,m){return Yt(a,((y,v)=>{const E=e instanceof Mu?e.get(v):null;return E&&E.evaluate?E.evaluate(n,h,m):E}))}function P0(a,e){return e-a}function i(a,e,n,h,m){const y=[];for(let v=0;v<a.length;v++){const E=a[v];let k;for(let P=0;P<E.length-1;P++){let O=E[P],G=E[P+1];O.x<e&&G.x<e||(O.x<e?O=new C(e,O.y+(e-O.x)/(G.x-O.x)*(G.y-O.y))._round():G.x<e&&(G=new C(e,O.y+(e-O.x)/(G.x-O.x)*(G.y-O.y))._round()),O.y<n&&G.y<n||(O.y<n?O=new C(O.x+(n-O.y)/(G.y-O.y)*(G.x-O.x),n)._round():G.y<n&&(G=new C(O.x+(n-O.y)/(G.y-O.y)*(G.x-O.x),n)._round()),O.x>=h&&G.x>=h||(O.x>=h?O=new C(h,O.y+(h-O.x)/(G.x-O.x)*(G.y-O.y))._round():G.x>=h&&(G=new C(h,O.y+(h-O.x)/(G.x-O.x)*(G.y-O.y))._round()),O.y>=m&&G.y>=m||(O.y>=m?O=new C(O.x+(m-O.y)/(G.y-O.y)*(G.x-O.x),m)._round():G.y>=m&&(G=new C(O.x+(m-O.y)/(G.y-O.y)*(G.x-O.x),m)._round()),k&&O.equals(k[k.length-1])||(k=[O],y.push(k)),k.push(G)))))}}return y}function c(a,e,n,h,m){switch(e){case 1:return(function(y,v,E,k){const P=[];for(const O of y)for(const G of O){const X=k===0?G.x:G.y;X>=v&&X<=E&&P.push([G])}return P})(a,n,h,m);case 2:return T(a,n,h,m,!1);case 3:return T(a,n,h,m,!0)}return[]}function g(a,e,n,h,m){const y=h===0?I:L;let v=[];const E=[];for(let O=0;O<a.length-1;O++){const G=a[O],X=a[O+1],K=h===0?G.x:G.y,ae=h===0?X.x:X.y;let oe=!1;K<e?ae>e&&v.push(y(G,X,e)):K>n?ae<n&&v.push(y(G,X,n)):v.push(G),ae<e&&K>=e&&(v.push(y(G,X,e)),oe=!0),ae>n&&K<=n&&(v.push(y(G,X,n)),oe=!0),!m&&oe&&(E.push(v),v=[])}const k=a.length-1,P=h===0?a[k].x:a[k].y;return P>=e&&P<=n&&v.push(a[k]),m&&v.length>0&&!v[0].equals(v[v.length-1])&&v.push(new C(v[0].x,v[0].y)),v.length>0&&E.push(v),E}function T(a,e,n,h,m){const y=[];for(const v of a){const E=g(v,e,n,h,m);E.length>0&&y.push(...E)}return y}function I(a,e,n){return new C(n,a.y+(n-a.x)/(e.x-a.x)*(e.y-a.y))}function L(a,e,n){return new C(a.x+(n-a.y)/(e.y-a.y)*(e.x-a.x),n)}kr("FeatureIndex",ng,{omit:["rawTileData","sourceLayerCoder"]});class ne extends C{constructor(e,n,h,m){super(e,n),this.angle=h,m!==void 0&&(this.segment=m)}clone(){return new ne(this.x,this.y,this.angle,this.segment)}}function Ae(a,e,n,h,m){if(e.segment===void 0||n===0)return!0;let y=e,v=e.segment+1,E=0;for(;E>-n/2;){if(v--,v<0)return!1;E-=a[v].dist(y),y=a[v]}E+=a[v].dist(a[v+1]),v++;const k=[];let P=0;for(;E<n/2;){const O=a[v],G=a[v+1];if(!G)return!1;let X=a[v-1].angleTo(O)-O.angleTo(G);for(X=Math.abs((X+3*Math.PI)%(2*Math.PI)-Math.PI),k.push({distance:E,angleDelta:X}),P+=X;E-k[0].distance>h;)P-=k.shift().angleDelta;if(P>m)return!1;v++,E+=O.dist(G)}return!0}function ct(a){let e=0;for(let n=0;n<a.length-1;n++)e+=a[n].dist(a[n+1]);return e}function zt(a,e,n){return a?.6*e*n:0}function Qt(a,e){return Math.max(a?a.right-a.left:0,e?e.right-e.left:0)}function or(a,e,n,h,m,y){const v=zt(n,m,y),E=Qt(n,h)*y;let k=0;const P=ct(a)/2;for(let O=0;O<a.length-1;O++){const G=a[O],X=a[O+1],K=G.dist(X);if(k+K>P){const ae=(P-k)/K,oe=ca.number(G.x,X.x,ae),he=ca.number(G.y,X.y,ae),be=new ne(oe,he,X.angleTo(G),O);return be._round(),!v||Ae(a,be,E,v,e)?be:void 0}k+=K}}function Ot(a,e,n,h,m,y,v,E,k){const P=zt(h,y,v),O=Qt(h,m),G=O*v,X=a[0].x===0||a[0].x===k||a[0].y===0||a[0].y===k;return e-G<e/4&&(e=G+e/4),Gt(a,X?e/2*E%e:(O/2+2*y)*v*E%e,e,P,n,G,X,!1,k)}function Gt(a,e,n,h,m,y,v,E,k){const P=y/2,O=ct(a);let G=0,X=e-n,K=[];for(let ae=0;ae<a.length-1;ae++){const oe=a[ae],he=a[ae+1],be=oe.dist(he),Ze=he.angleTo(oe);for(;X+n<G+be;){X+=n;const Se=(X-G)/be,Ce=ca.number(oe.x,he.x,Se),Ye=ca.number(oe.y,he.y,Se);if(Ce>=0&&Ce<k&&Ye>=0&&Ye<k&&X-P>=0&&X+P<=O){const it=new ne(Ce,Ye,Ze,ae);it._round(),h&&!Ae(a,it,y,h,m)||K.push(it)}}G+=be}return E||K.length||v||(K=Gt(a,G/2,n,h,m,y,v,!0,k)),K}function Hr(a,e,n,h){const m=[],y=a.image,v=y.pixelRatio,E=y.paddedRect.w-2,k=y.paddedRect.h-2;let P={x1:a.left,y1:a.top,x2:a.right,y2:a.bottom};const O=y.stretchX||[[0,E]],G=y.stretchY||[[0,k]],X=(Lt,Pr)=>Lt+Pr[1]-Pr[0],K=O.reduce(X,0),ae=G.reduce(X,0),oe=E-K,he=k-ae;let be=0,Ze=K,Se=0,Ce=ae,Ye=0,it=oe,At=0,Wt=he;if(y.content&&h){const Lt=y.content,Pr=Lt[2]-Lt[0],Cr=Lt[3]-Lt[1];(y.textFitWidth||y.textFitHeight)&&(P=Hu(a)),be=on(O,0,Lt[0]),Se=on(G,0,Lt[1]),Ze=on(O,Lt[0],Lt[2]),Ce=on(G,Lt[1],Lt[3]),Ye=Lt[0]-be,At=Lt[1]-Se,it=Pr-Ze,Wt=Cr-Ce}const Nt=P.x1,rr=P.y1,wr=P.x2-Nt,ar=P.y2-rr,qt=(Lt,Pr,Cr,zr)=>{const Er=wt(Lt.stretch-be,Ze,wr,Nt),Zr=pt(Lt.fixed-Ye,it,Lt.stretch,K),qn=wt(Pr.stretch-Se,Ce,ar,rr),Mn=pt(Pr.fixed-At,Wt,Pr.stretch,ae),ei=wt(Cr.stretch-be,Ze,wr,Nt),Ws=pt(Cr.fixed-Ye,it,Cr.stretch,K),Zi=wt(zr.stretch-Se,Ce,ar,rr),ti=pt(zr.fixed-At,Wt,zr.stretch,ae),Va=new C(Er,qn),ia=new C(ei,qn),di=new C(ei,Zi),vi=new C(Er,Zi),La=new C(Zr/v,Mn/v),_l=new C(Ws/v,ti/v),$s=e*Math.PI/180;if($s){const ds=Math.sin($s),ii=Math.cos($s),Wi=[ii,-ds,ds,ii];Va._matMult(Wi),ia._matMult(Wi),vi._matMult(Wi),di._matMult(Wi)}const xl=Lt.stretch+Lt.fixed,nu=Pr.stretch+Pr.fixed;return{tl:Va,tr:ia,bl:vi,br:di,tex:{x:y.paddedRect.x+1+xl,y:y.paddedRect.y+1+nu,w:Cr.stretch+Cr.fixed-xl,h:zr.stretch+zr.fixed-nu},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:La,pixelOffsetBR:_l,minFontScaleX:it/v/wr,minFontScaleY:Wt/v/ar,isSDF:n}};if(h&&(y.stretchX||y.stretchY)){const Lt=Ea(O,oe,K),Pr=Ea(G,he,ae);for(let Cr=0;Cr<Lt.length-1;Cr++){const zr=Lt[Cr],Er=Lt[Cr+1];for(let Zr=0;Zr<Pr.length-1;Zr++)m.push(qt(zr,Pr[Zr],Er,Pr[Zr+1]))}}else m.push(qt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:E+1},{fixed:0,stretch:k+1}));return m}function on(a,e,n){let h=0;for(const m of a)h+=Math.max(e,Math.min(n,m[1]))-Math.max(e,Math.min(n,m[0]));return h}function Ea(a,e,n){const h=[{fixed:-1,stretch:0}];for(const[m,y]of a){const v=h[h.length-1];h.push({fixed:m-v.stretch,stretch:v.stretch}),h.push({fixed:m-v.stretch,stretch:v.stretch+(y-m)})}return h.push({fixed:e+1,stretch:n}),h}function wt(a,e,n,h){return a/e*n+h}function pt(a,e,n,h){return a-e*n/h}kr("Anchor",ne);class Ft{constructor(e,n,h,m,y,v,E,k,P,O){var G;if(this.boxStartIndex=e.length,P){let X=v.top,K=v.bottom;const ae=v.collisionPadding;ae&&(X-=ae[1],K+=ae[3]);let oe=K-X;oe>0&&(oe=Math.max(10,oe),this.circleDiameter=oe)}else{const X=!((G=v.image)===null||G===void 0)&&G.content&&(v.image.textFitWidth||v.image.textFitHeight)?Hu(v):{x1:v.left,y1:v.top,x2:v.right,y2:v.bottom};X.y1=X.y1*E-k[0],X.y2=X.y2*E+k[2],X.x1=X.x1*E-k[3],X.x2=X.x2*E+k[1];const K=v.collisionPadding;if(K&&(X.x1-=K[0]*E,X.y1-=K[1]*E,X.x2+=K[2]*E,X.y2+=K[3]*E),O){const ae=new C(X.x1,X.y1),oe=new C(X.x2,X.y1),he=new C(X.x1,X.y2),be=new C(X.x2,X.y2),Ze=O*Math.PI/180;ae._rotate(Ze),oe._rotate(Ze),he._rotate(Ze),be._rotate(Ze),X.x1=Math.min(ae.x,oe.x,he.x,be.x),X.x2=Math.max(ae.x,oe.x,he.x,be.x),X.y1=Math.min(ae.y,oe.y,he.y,be.y),X.y2=Math.max(ae.y,oe.y,he.y,be.y)}e.emplaceBack(n.x,n.y,X.x1,X.y1,X.x2,X.y2,h,m,y)}this.boxEndIndex=e.length}}class nr{constructor(e=[],n=(h,m)=>h<m?-1:h>m?1:0){if(this.data=e,this.length=this.data.length,this.compare=n,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;const e=this.data[0],n=this.data.pop();return--this.length>0&&(this.data[0]=n,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:n,compare:h}=this,m=n[e];for(;e>0;){const y=e-1>>1,v=n[y];if(h(m,v)>=0)break;n[e]=v,e=y}n[e]=m}_down(e){const{data:n,compare:h}=this,m=this.length>>1,y=n[e];for(;e<m;){let v=1+(e<<1);const E=v+1;if(E<this.length&&h(n[E],n[v])<0&&(v=E),h(n[v],y)>=0)break;n[e]=n[v],e=v}n[e]=y}}function nn(a,e=1,n=!1){const h=Mh.fromPoints(a[0]),m=Math.min(h.width(),h.height());let y=m/2;const v=new nr([],aa),{minX:E,minY:k,maxX:P,maxY:O}=h;if(m===0)return new C(E,k);for(let K=E;K<P;K+=m)for(let ae=k;ae<O;ae+=m)v.push(new qr(K+y,ae+y,y,a));let G=(function(K){let ae=0,oe=0,he=0;const be=K[0];for(let Ze=0,Se=be.length,Ce=Se-1;Ze<Se;Ce=Ze++){const Ye=be[Ze],it=be[Ce],At=Ye.x*it.y-it.x*Ye.y;oe+=(Ye.x+it.x)*At,he+=(Ye.y+it.y)*At,ae+=3*At}return new qr(oe/ae,he/ae,0,K)})(a),X=v.length;for(;v.length;){const K=v.pop();(K.d>G.d||!G.d)&&(G=K,n&&console.log("found best %d after %d probes",Math.round(1e4*K.d)/1e4,X)),K.max-G.d<=e||(y=K.h/2,v.push(new qr(K.p.x-y,K.p.y-y,y,a)),v.push(new qr(K.p.x+y,K.p.y-y,y,a)),v.push(new qr(K.p.x-y,K.p.y+y,y,a)),v.push(new qr(K.p.x+y,K.p.y+y,y,a)),X+=4)}return n&&(console.log(`num probes: ${X}`),console.log(`best distance: ${G.d}`)),G.p}function aa(a,e){return e.max-a.max}function qr(a,e,n,h){this.p=new C(a,e),this.h=n,this.d=(function(m,y){let v=!1,E=1/0;for(let k=0;k<y.length;k++){const P=y[k];for(let O=0,G=P.length,X=G-1;O<G;X=O++){const K=P[O],ae=P[X];K.y>m.y!=ae.y>m.y&&m.x<(ae.x-K.x)*(m.y-K.y)/(ae.y-K.y)+K.x&&(v=!v),E=Math.min(E,sm(m,K,ae))}}return(v?1:-1)*Math.sqrt(E)})(this.p,h),this.max=this.d+this.h*Math.SQRT2}var rn;_.aP=void 0,(rn=_.aP||(_.aP={}))[rn.center=1]="center",rn[rn.left=2]="left",rn[rn.right=3]="right",rn[rn.top=4]="top",rn[rn.bottom=5]="bottom",rn[rn["top-left"]=6]="top-left",rn[rn["top-right"]=7]="top-right",rn[rn["bottom-left"]=8]="bottom-left",rn[rn["bottom-right"]=9]="bottom-right";const Bn=Number.POSITIVE_INFINITY;function ea(a,e){return e[1]!==Bn?(function(n,h,m){let y=0,v=0;switch(h=Math.abs(h),m=Math.abs(m),n){case"top-right":case"top-left":case"top":v=m-7;break;case"bottom-right":case"bottom-left":case"bottom":v=7-m}switch(n){case"top-right":case"bottom-right":case"right":y=-h;break;case"top-left":case"bottom-left":case"left":y=h}return[y,v]})(a,e[0],e[1]):(function(n,h){let m=0,y=0;h<0&&(h=0);const v=h/Math.SQRT2;switch(n){case"top-right":case"top-left":y=v-7;break;case"bottom-right":case"bottom-left":y=7-v;break;case"bottom":y=7-h;break;case"top":y=h-7}switch(n){case"top-right":case"bottom-right":m=-v;break;case"top-left":case"bottom-left":m=v;break;case"left":m=h;break;case"right":m=-h}return[m,y]})(a,e[0])}function $u(a,e,n){var h;const m=a.layout,y=(h=m.get("text-variable-anchor-offset"))===null||h===void 0?void 0:h.evaluate(e,{},n);if(y){const E=y.values,k=[];for(let P=0;P<E.length;P+=2){const O=k[P]=E[P],G=E[P+1].map((X=>X*Mi));O.startsWith("top")?G[1]-=7:O.startsWith("bottom")&&(G[1]+=7),k[P+1]=G}return new zn(k)}const v=m.get("text-variable-anchor");if(v){let E;E=a._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[m.get("text-radial-offset").evaluate(e,{},n)*Mi,Bn]:m.get("text-offset").evaluate(e,{},n).map((P=>P*Mi));const k=[];for(const P of v)k.push(P,ea(P,E));return new zn(k)}return null}function ag(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Lw(a,e,n,h,m,y,v,E,k,P,O,G){let X=y.textMaxSize.evaluate(e,{});X===void 0&&(X=v);const K=a.layers[0].layout,ae=K.get("icon-offset").evaluate(e,{},O),oe=I1(n.horizontal),he=v/24,be=a.tilePixelRatio*he,Ze=a.tilePixelRatio*X/24,Se=a.tilePixelRatio*E,Ce=a.tilePixelRatio*K.get("symbol-spacing"),Ye=K.get("text-padding")*a.tilePixelRatio,it=(function(Cr,zr,Er,Zr=1){const qn=Cr.get("icon-padding").evaluate(zr,{},Er),Mn=qn&&qn.values;return[Mn[0]*Zr,Mn[1]*Zr,Mn[2]*Zr,Mn[3]*Zr]})(K,e,O,a.tilePixelRatio),At=K.get("text-max-angle")/180*Math.PI,Wt=K.get("text-rotation-alignment")!=="viewport"&&K.get("symbol-placement")!=="point",Nt=K.get("icon-rotation-alignment")==="map"&&K.get("symbol-placement")!=="point",rr=K.get("symbol-placement"),wr=Ce/2,ar=K.get("icon-text-fit");let qt;h&&ar!=="none"&&(a.allowVerticalPlacement&&n.vertical&&(qt=Sc(h,n.vertical,ar,K.get("icon-text-fit-padding"),ae,he)),oe&&(h=Sc(h,oe,ar,K.get("icon-text-fit-padding"),ae,he)));const Lt=O?G.line.getGranularityForZoomLevel(O.z):1,Pr=(Cr,zr)=>{zr.x<0||zr.x>=Be||zr.y<0||zr.y>=Be||(function(Er,Zr,qn,Mn,ei,Ws,Zi,ti,Va,ia,di,vi,La,_l,$s,xl,nu,ds,ii,Wi,pi,ps,wf,Xu,og){const fd=Er.addToLineVertexArray(Zr,qn);let gp,F0,L0,z0,z1=0,O1=0,B1=0,N1=0,ny=-1,ay=-1;const Tf={};let j1=Ja("");if(Er.allowVerticalPlacement&&Mn.vertical){const po=ti.layout.get("text-rotate").evaluate(pi,{},Xu)+90;L0=new Ft(Va,Zr,ia,di,vi,Mn.vertical,La,_l,$s,po),Zi&&(z0=new Ft(Va,Zr,ia,di,vi,Zi,nu,ds,$s,po))}if(ei){const po=ti.layout.get("icon-rotate").evaluate(pi,{}),Cc=ti.layout.get("icon-text-fit")!=="none",_p=Hr(ei,po,wf,Cc),Ku=Zi?Hr(Zi,po,wf,Cc):void 0;F0=new Ft(Va,Zr,ia,di,vi,ei,nu,ds,!1,po),z1=4*_p.length;const xp=Er.iconSizeData;let Bh=null;xp.kind==="source"?(Bh=[ml*ti.layout.get("icon-size").evaluate(pi,{})],Bh[0]>kh&&se(`${Er.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):xp.kind==="composite"&&(Bh=[ml*ps.compositeIconSizes[0].evaluate(pi,{},Xu),ml*ps.compositeIconSizes[1].evaluate(pi,{},Xu)],(Bh[0]>kh||Bh[1]>kh)&&se(`${Er.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Er.addSymbols(Er.icon,_p,Bh,Wi,ii,pi,_.az.none,Zr,fd.lineStartIndex,fd.lineLength,-1,Xu),ny=Er.icon.placedSymbolArray.length-1,Ku&&(O1=4*Ku.length,Er.addSymbols(Er.icon,Ku,Bh,Wi,ii,pi,_.az.vertical,Zr,fd.lineStartIndex,fd.lineLength,-1,Xu),ay=Er.icon.placedSymbolArray.length-1)}const U1=Object.keys(Mn.horizontal);for(const po of U1){const Cc=Mn.horizontal[po];if(!gp){j1=Ja(Cc.text);const Ku=ti.layout.get("text-rotate").evaluate(pi,{},Xu);gp=new Ft(Va,Zr,ia,di,vi,Cc,La,_l,$s,Ku)}const _p=Cc.positionedLines.length===1;if(B1+=R1(Er,Zr,Cc,Ws,ti,$s,pi,xl,fd,Mn.vertical?_.az.horizontal:_.az.horizontalOnly,_p?U1:[po],Tf,ny,ps,Xu),_p)break}Mn.vertical&&(N1+=R1(Er,Zr,Mn.vertical,Ws,ti,$s,pi,xl,fd,_.az.vertical,["vertical"],Tf,ay,ps,Xu));const Bw=gp?gp.boxStartIndex:Er.collisionBoxArray.length,Nw=gp?gp.boxEndIndex:Er.collisionBoxArray.length,jw=L0?L0.boxStartIndex:Er.collisionBoxArray.length,Uw=L0?L0.boxEndIndex:Er.collisionBoxArray.length,Vw=F0?F0.boxStartIndex:Er.collisionBoxArray.length,Gw=F0?F0.boxEndIndex:Er.collisionBoxArray.length,Hw=z0?z0.boxStartIndex:Er.collisionBoxArray.length,qw=z0?z0.boxEndIndex:Er.collisionBoxArray.length;let Yu=-1;const X_=(po,Cc)=>po&&po.circleDiameter?Math.max(po.circleDiameter,Cc):Cc;Yu=X_(gp,Yu),Yu=X_(L0,Yu),Yu=X_(F0,Yu),Yu=X_(z0,Yu);const V1=Yu>-1?1:0;V1&&(Yu*=og/Mi),Er.glyphOffsetArray.length>=nd.MAX_GLYPHS&&se("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),pi.sortKey!==void 0&&Er.addToSortKeyRanges(Er.symbolInstances.length,pi.sortKey);const Zw=$u(ti,pi,Xu),[Ww,$w]=(function(po,Cc){const _p=po.length,Ku=Cc?.values;if(Ku?.length>0)for(let xp=0;xp<Ku.length;xp+=2){const Bh=Ku[xp+1];po.emplaceBack(_.aP[Ku[xp]],Bh[0],Bh[1])}return[_p,po.length]})(Er.textAnchorOffsets,Zw);Er.symbolInstances.emplaceBack(Zr.x,Zr.y,Tf.right>=0?Tf.right:-1,Tf.center>=0?Tf.center:-1,Tf.left>=0?Tf.left:-1,Tf.vertical||-1,ny,ay,j1,Bw,Nw,jw,Uw,Vw,Gw,Hw,qw,ia,B1,N1,z1,O1,V1,0,La,Yu,Ww,$w)})(a,zr,Cr,n,h,m,qt,a.layers[0],a.collisionBoxArray,e.index,e.sourceLayerIndex,a.index,be,[Ye,Ye,Ye,Ye],Wt,k,Se,it,Nt,ae,e,y,P,O,v)};if(rr==="line")for(const Cr of i(e.geometry,0,0,Be,Be)){const zr=Nu(Cr,Lt),Er=Ot(zr,Ce,At,n.vertical||oe,h,24,Ze,a.overscaling,Be);for(const Zr of Er)oe&&zw(a,oe.text,wr,Zr)||Pr(zr,Zr)}else if(rr==="line-center"){for(const Cr of e.geometry)if(Cr.length>1){const zr=Nu(Cr,Lt),Er=or(zr,At,n.vertical||oe,h,24,Ze);Er&&Pr(zr,Er)}}else if(e.type==="Polygon")for(const Cr of Oc(e.geometry,0)){const zr=nn(Cr,16);Pr(Nu(Cr[0],Lt,!0),new ne(zr.x,zr.y,0))}else if(e.type==="LineString")for(const Cr of e.geometry){const zr=Nu(Cr,Lt);Pr(zr,new ne(zr[0].x,zr[0].y,0))}else if(e.type==="Point")for(const Cr of e.geometry)for(const zr of Cr)Pr([zr],new ne(zr.x,zr.y,0))}function R1(a,e,n,h,m,y,v,E,k,P,O,G,X,K,ae){const oe=(function(Ze,Se,Ce,Ye,it,At,Wt,Nt){const rr=Ye.layout.get("text-rotate").evaluate(At,{})*Math.PI/180,wr=[];for(const ar of Se.positionedLines)for(const qt of ar.positionedGlyphs){if(!qt.rect)continue;const Lt=qt.rect||{};let Pr=4,Cr=!0,zr=1,Er=0;const Zr=(it||Nt)&&qt.vertical,qn=qt.metrics.advance*qt.scale/2;if(Nt&&Se.verticalizable&&(Er=ar.lineOffset/2-(qt.imageName?-(Mi-qt.metrics.width*qt.scale)/2:(qt.scale-1)*Mi)),qt.imageName){const ds=Wt[qt.imageName];Cr=ds.sdf,zr=ds.pixelRatio,Pr=1/zr}const Mn=it?[qt.x+qn,qt.y]:[0,0];let ei=it?[0,0]:[qt.x+qn+Ce[0],qt.y+Ce[1]-Er],Ws=[0,0];Zr&&(Ws=ei,ei=[0,0]);const Zi=qt.metrics.isDoubleResolution?2:1,ti=(qt.metrics.left-Pr)*qt.scale-qn+ei[0],Va=(-qt.metrics.top-Pr)*qt.scale+ei[1],ia=ti+Lt.w/Zi*qt.scale/zr,di=Va+Lt.h/Zi*qt.scale/zr,vi=new C(ti,Va),La=new C(ia,Va),_l=new C(ti,di),$s=new C(ia,di);if(Zr){const ds=new C(-qn,qn- -17),ii=-Math.PI/2,Wi=12-qn,pi=new C(22-Wi,-(qt.imageName?Wi:0)),ps=new C(...Ws);vi._rotateAround(ii,ds)._add(pi)._add(ps),La._rotateAround(ii,ds)._add(pi)._add(ps),_l._rotateAround(ii,ds)._add(pi)._add(ps),$s._rotateAround(ii,ds)._add(pi)._add(ps)}if(rr){const ds=Math.sin(rr),ii=Math.cos(rr),Wi=[ii,-ds,ds,ii];vi._matMult(Wi),La._matMult(Wi),_l._matMult(Wi),$s._matMult(Wi)}const xl=new C(0,0),nu=new C(0,0);wr.push({tl:vi,tr:La,bl:_l,br:$s,tex:Lt,writingMode:Se.writingMode,glyphOffset:Mn,sectionIndex:qt.sectionIndex,isSDF:Cr,pixelOffsetTL:xl,pixelOffsetBR:nu,minFontScaleX:0,minFontScaleY:0})}return wr})(0,n,E,m,y,v,h,a.allowVerticalPlacement),he=a.textSizeData;let be=null;he.kind==="source"?(be=[ml*m.layout.get("text-size").evaluate(v,{})],be[0]>kh&&se(`${a.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):he.kind==="composite"&&(be=[ml*K.compositeTextSizes[0].evaluate(v,{},ae),ml*K.compositeTextSizes[1].evaluate(v,{},ae)],(be[0]>kh||be[1]>kh)&&se(`${a.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),a.addSymbols(a.text,oe,be,E,y,v,P,e,k.lineStartIndex,k.lineLength,X,ae);for(const Ze of O)G[Ze]=a.text.placedSymbolArray.length-1;return 4*oe.length}function I1(a){for(const e in a)return a[e];return null}function zw(a,e,n,h){const m=a.compareText;if(e in m){const y=m[e];for(let v=y.length-1;v>=0;v--)if(h.dist(y[v])<n)return!0}else m[e]=[];return m[e].push(h),!1}const P1=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Yx{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[n,h]=new Uint8Array(e,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");const m=h>>4;if(m!==1)throw new Error(`Got v${m} data when expected v1.`);const y=P1[15&h];if(!y)throw new Error("Unrecognized array type.");const[v]=new Uint16Array(e,2,1),[E]=new Uint32Array(e,4,1);return new Yx(E,v,y,e)}constructor(e,n=64,h=Float64Array,m){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=h,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const y=P1.indexOf(this.ArrayType),v=2*e*this.ArrayType.BYTES_PER_ELEMENT,E=e*this.IndexArrayType.BYTES_PER_ELEMENT,k=(8-E%8)%8;if(y<0)throw new Error(`Unexpected typed array class: ${h}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+E+k,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+v+E+k),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+E+k,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+y]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=e)}add(e,n){const h=this._pos>>1;return this.ids[h]=h,this.coords[this._pos++]=e,this.coords[this._pos++]=n,h}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return Kx(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,n,h,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:v,nodeSize:E}=this,k=[0,y.length-1,0],P=[];for(;k.length;){const O=k.pop()||0,G=k.pop()||0,X=k.pop()||0;if(G-X<=E){for(let he=X;he<=G;he++){const be=v[2*he],Ze=v[2*he+1];be>=e&&be<=h&&Ze>=n&&Ze<=m&&P.push(y[he])}continue}const K=X+G>>1,ae=v[2*K],oe=v[2*K+1];ae>=e&&ae<=h&&oe>=n&&oe<=m&&P.push(y[K]),(O===0?e<=ae:n<=oe)&&(k.push(X),k.push(K-1),k.push(1-O)),(O===0?h>=ae:m>=oe)&&(k.push(K+1),k.push(G),k.push(1-O))}return P}within(e,n,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:y,nodeSize:v}=this,E=[0,m.length-1,0],k=[],P=h*h;for(;E.length;){const O=E.pop()||0,G=E.pop()||0,X=E.pop()||0;if(G-X<=v){for(let he=X;he<=G;he++)L1(y[2*he],y[2*he+1],e,n)<=P&&k.push(m[he]);continue}const K=X+G>>1,ae=y[2*K],oe=y[2*K+1];L1(ae,oe,e,n)<=P&&k.push(m[K]),(O===0?e-h<=ae:n-h<=oe)&&(E.push(X),E.push(K-1),E.push(1-O)),(O===0?e+h>=ae:n+h>=oe)&&(E.push(K+1),E.push(G),E.push(1-O))}return k}}function Kx(a,e,n,h,m,y){if(m-h<=n)return;const v=h+m>>1;F1(a,e,v,h,m,y),Kx(a,e,n,h,v-1,1-y),Kx(a,e,n,v+1,m,1-y)}function F1(a,e,n,h,m,y){for(;m>h;){if(m-h>600){const P=m-h+1,O=n-h+1,G=Math.log(P),X=.5*Math.exp(2*G/3),K=.5*Math.sqrt(G*X*(P-X)/P)*(O-P/2<0?-1:1);F1(a,e,n,Math.max(h,Math.floor(n-O*X/P+K)),Math.min(m,Math.floor(n+(P-O)*X/P+K)),y)}const v=e[2*n+y];let E=h,k=m;for(ig(a,e,h,n),e[2*m+y]>v&&ig(a,e,h,m);E<k;){for(ig(a,e,E,k),E++,k--;e[2*E+y]<v;)E++;for(;e[2*k+y]>v;)k--}e[2*h+y]===v?ig(a,e,h,k):(k++,ig(a,e,k,m)),k<=n&&(h=k+1),n<=k&&(m=k-1)}}function ig(a,e,n,h){Jx(a,n,h),Jx(e,2*n,2*h),Jx(e,2*n+1,2*h+1)}function Jx(a,e,n){const h=a[e];a[e]=a[n],a[n]=h}function L1(a,e,n,h){const m=a-n,y=e-h;return m*m+y*y}var Qx;_.cH=void 0,(Qx=_.cH||(_.cH={})).create="create",Qx.load="load",Qx.fullLoad="fullLoad";let $_=null,sg=[];const ey=1e3/60,ty="loadTime",ry="fullLoadTime",Ow={mark(a){performance.mark(a)},frame(a){const e=a;$_!=null&&sg.push(e-$_),$_=e},clearMetrics(){$_=null,sg=[],performance.clearMeasures(ty),performance.clearMeasures(ry);for(const a in _.cH)performance.clearMarks(_.cH[a])},getPerformanceMetrics(){performance.measure(ty,_.cH.create,_.cH.load),performance.measure(ry,_.cH.create,_.cH.fullLoad);const a=performance.getEntriesByName(ty)[0].duration,e=performance.getEntriesByName(ry)[0].duration,n=sg.length,h=1/(sg.reduce(((y,v)=>y+v),0)/n/1e3),m=sg.filter((y=>y>ey)).reduce(((y,v)=>y+(v-ey)/ey),0);return{loadTime:a,fullLoadTime:e,fps:h,percentDroppedFrames:m/(n+m)*100,totalFrames:n}}};_.$=N,_.A=W,_.B=sl,_.C=Ci,_.D=Rr,_.E=an,_.F=function([a,e,n]){return e+=90,e*=Math.PI/180,n*=Math.PI/180,{x:a*Math.cos(e)*Math.sin(n),y:a*Math.sin(e)*Math.sin(n),z:a*Math.cos(n)}},_.G=ca,_.H=Jn,_.I=da,_.J=Lf,_.K=function(a){if(Ee==null){const e=a.navigator?a.navigator.userAgent:null;Ee=!!a.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Ee},_.L=class{constructor(a,e){this.target=a,this.mapId=e,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new m0((()=>this.process())),this.subscription=lr(this.target,"message",(n=>this.receive(n)),!1),this.globalScope=yt(self)?a:window}registerMessageHandler(a,e){this.messageHandlers[a]=e}unregisterMessageHandler(a){delete this.messageHandlers[a]}sendAsync(a,e){return new Promise(((n,h)=>{const m=Math.round(1e18*Math.random()).toString(36).substring(0,10),y=e?lr(e.signal,"abort",(()=>{y?.unsubscribe(),delete this.resolveRejects[m];const k={id:m,type:"<cancel>",origin:location.origin,targetMapId:a.targetMapId,sourceMapId:this.mapId};this.target.postMessage(k)}),Fm):null;this.resolveRejects[m]={resolve:k=>{y?.unsubscribe(),n(k)},reject:k=>{y?.unsubscribe(),h(k)}};const v=[],E=Object.assign(Object.assign({},a),{id:m,sourceMapId:this.mapId,origin:location.origin,data:ol(a.data,v)});this.target.postMessage(E,{transfer:v})}))}receive(a){const e=a.data,n=e.id;if(!(e.origin!=="file://"&&location.origin!=="file://"&&e.origin!=="resource://android"&&location.origin!=="resource://android"&&e.origin!==location.origin||e.targetMapId&&this.mapId!==e.targetMapId)){if(e.type==="<cancel>"){delete this.tasks[n];const h=this.abortControllers[n];return delete this.abortControllers[n],void(h&&h.abort())}if(yt(self)||e.mustQueue)return this.tasks[n]=e,this.taskQueue.push(n),void this.invoker.trigger();this.processTask(n,e)}}process(){if(this.taskQueue.length===0)return;const a=this.taskQueue.shift(),e=this.tasks[a];delete this.tasks[a],this.taskQueue.length>0&&this.invoker.trigger(),e&&this.processTask(a,e)}processTask(a,e){return s(this,void 0,void 0,(function*(){if(e.type==="<response>"){const m=this.resolveRejects[a];return delete this.resolveRejects[a],m?void(e.error?m.reject(_h(e.error)):m.resolve(_h(e.data))):void 0}if(!this.messageHandlers[e.type])return void this.completeTask(a,new Error(`Could not find a registered handler for ${e.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const n=_h(e.data),h=new AbortController;this.abortControllers[a]=h;try{const m=yield this.messageHandlers[e.type](e.sourceMapId,n,h);this.completeTask(a,null,m)}catch(m){this.completeTask(a,m)}}))}completeTask(a,e,n){const h=[];delete this.abortControllers[a];const m={id:a,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:e?ol(e):null,data:ol(n,h)};this.target.postMessage(m,{transfer:h})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},_.M=lt,_.N=function(){var a=new W(16);return W!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},_.O=function(a,e,n){var h,m,y,v,E,k,P,O,G,X,K,ae,oe=n[0],he=n[1],be=n[2];return e===a?(a[12]=e[0]*oe+e[4]*he+e[8]*be+e[12],a[13]=e[1]*oe+e[5]*he+e[9]*be+e[13],a[14]=e[2]*oe+e[6]*he+e[10]*be+e[14],a[15]=e[3]*oe+e[7]*he+e[11]*be+e[15]):(m=e[1],y=e[2],v=e[3],E=e[4],k=e[5],P=e[6],O=e[7],G=e[8],X=e[9],K=e[10],ae=e[11],a[0]=h=e[0],a[1]=m,a[2]=y,a[3]=v,a[4]=E,a[5]=k,a[6]=P,a[7]=O,a[8]=G,a[9]=X,a[10]=K,a[11]=ae,a[12]=h*oe+E*he+G*be+e[12],a[13]=m*oe+k*he+X*be+e[13],a[14]=y*oe+P*he+K*be+e[14],a[15]=v*oe+O*he+ae*be+e[15]),a},_.P=C,_.Q=function(a,e,n){var h=n[0],m=n[1],y=n[2];return a[0]=e[0]*h,a[1]=e[1]*h,a[2]=e[2]*h,a[3]=e[3]*h,a[4]=e[4]*m,a[5]=e[5]*m,a[6]=e[6]*m,a[7]=e[7]*m,a[8]=e[8]*y,a[9]=e[9]*y,a[10]=e[10]*y,a[11]=e[11]*y,a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15],a},_.R=Gs,_.S=function(a,e,n){var h=e[0],m=e[1],y=e[2],v=e[3],E=e[4],k=e[5],P=e[6],O=e[7],G=e[8],X=e[9],K=e[10],ae=e[11],oe=e[12],he=e[13],be=e[14],Ze=e[15],Se=n[0],Ce=n[1],Ye=n[2],it=n[3];return a[0]=Se*h+Ce*E+Ye*G+it*oe,a[1]=Se*m+Ce*k+Ye*X+it*he,a[2]=Se*y+Ce*P+Ye*K+it*be,a[3]=Se*v+Ce*O+Ye*ae+it*Ze,a[4]=(Se=n[4])*h+(Ce=n[5])*E+(Ye=n[6])*G+(it=n[7])*oe,a[5]=Se*m+Ce*k+Ye*X+it*he,a[6]=Se*y+Ce*P+Ye*K+it*be,a[7]=Se*v+Ce*O+Ye*ae+it*Ze,a[8]=(Se=n[8])*h+(Ce=n[9])*E+(Ye=n[10])*G+(it=n[11])*oe,a[9]=Se*m+Ce*k+Ye*X+it*he,a[10]=Se*y+Ce*P+Ye*K+it*be,a[11]=Se*v+Ce*O+Ye*ae+it*Ze,a[12]=(Se=n[12])*h+(Ce=n[13])*E+(Ye=n[14])*G+(it=n[15])*oe,a[13]=Se*m+Ce*k+Ye*X+it*he,a[14]=Se*y+Ce*P+Ye*K+it*be,a[15]=Se*v+Ce*O+Ye*ae+it*Ze,a},_.T=Zp,_.U=function(a,e){const n={};for(let h=0;h<e.length;h++){const m=e[h];m in a&&(n[m]=a[m])}return n},_.V=tu,_.W=Vt,_.X=Lm,_.Y=M_,_.Z=je,_._=s,_.a=ye,_.a$=Ge,_.a0=Z,_.a1=Kt,_.a2=Bo,_.a3=R_,_.a4=Jd,_.a5=Be,_.a6=function(a,e,n){if(!a)return e||{};if(!e)return a||{};const h=ep(a),m=ep(e);(function(v,E){E.removeAll&&(v.add.clear(),v.update.clear(),v.remove.clear(),E.remove.clear());for(const k of E.remove)v.add.delete(k),v.update.delete(k);for(const[k,P]of E.update){const O=v.update.get(k);O&&(E.update.set(k,Om(O,P)),v.update.delete(k))}})(h,m);const y={};if((h.removeAll||m.removeAll)&&(y.removeAll=!0),y.remove=new Set([...h.remove,...m.remove]),y.add=new Map([...h.add,...m.add]),y.update=new Map([...h.update,...m.update]),y.remove.size&&y.add.size)for(const v of y.add.keys())y.remove.delete(v);return(function(v){const E={};return v.removeAll&&(E.removeAll=v.removeAll),v.remove&&(E.remove=Array.from(v.remove)),v.add&&(E.add=Array.from(v.add.values())),v.update&&(E.update=Array.from(v.update.values())),E})(y)},_.a7=function(a,e){const n=new Map;if(a==null||a.type==null)return n;if(a.type==="Feature"){const h=Qd(a,e);return h==null?void 0:(n.set(h,a),n)}if(a.type==="FeatureCollection"){const h=new Set;for(const m of a.features){const y=Qd(m,e);if(y==null||h.has(y))return;h.add(y),n.set(y,m)}return n}},_.a8=function(a,e,n){var h,m;const y=[];if(e.removeAll)a.clear();else if(e.remove)for(const v of e.remove){const E=a.get(v);E&&(y.push(E.geometry),a.delete(v))}if(e.add)for(const v of e.add){const E=Qd(v,n);if(E==null)continue;const k=a.get(E);k&&y.push(k.geometry),y.push(v.geometry),a.set(E,v)}if(e.update)for(const v of e.update){const E=a.get(v.id);if(!E)continue;const k=!!v.newGeometry,P=v.removeAllProperties||((h=v.removeProperties)===null||h===void 0?void 0:h.length)>0||((m=v.addOrUpdateProperties)===null||m===void 0?void 0:m.length)>0;if(!k&&!P)continue;y.push(E.geometry);const O=Object.assign({},E);if(a.set(v.id,O),k&&(y.push(v.newGeometry),O.geometry=v.newGeometry),P){if(O.properties=v.removeAllProperties?{}:Object.assign({},O.properties||{}),v.removeProperties)for(const G of v.removeProperties)delete O.properties[G];if(v.addOrUpdateProperties)for(const{key:G,value:X}of v.addOrUpdateProperties)O.properties[G]=X}}return y},_.a9=na,_.aA=function(a,{uSize:e,uSizeT:n},{lowerSize:h,upperSize:m}){return a.kind==="source"?h/ml:a.kind==="composite"?ca.number(h/ml,m/ml,n):e},_.aB=function(a,e){var n=e[0],h=e[1],m=e[2],y=e[3],v=e[4],E=e[5],k=e[6],P=e[7],O=e[8],G=e[9],X=e[10],K=e[11],ae=e[12],oe=e[13],he=e[14],be=e[15],Ze=n*E-h*v,Se=n*k-m*v,Ce=n*P-y*v,Ye=h*k-m*E,it=h*P-y*E,At=m*P-y*k,Wt=O*oe-G*ae,Nt=O*he-X*ae,rr=O*be-K*ae,wr=G*he-X*oe,ar=G*be-K*oe,qt=X*be-K*he,Lt=Ze*qt-Se*ar+Ce*wr+Ye*rr-it*Nt+At*Wt;return Lt?(a[0]=(E*qt-k*ar+P*wr)*(Lt=1/Lt),a[1]=(m*ar-h*qt-y*wr)*Lt,a[2]=(oe*At-he*it+be*Ye)*Lt,a[3]=(X*it-G*At-K*Ye)*Lt,a[4]=(k*rr-v*qt-P*Nt)*Lt,a[5]=(n*qt-m*rr+y*Nt)*Lt,a[6]=(he*Ce-ae*At-be*Se)*Lt,a[7]=(O*At-X*Ce+K*Se)*Lt,a[8]=(v*ar-E*rr+P*Wt)*Lt,a[9]=(h*rr-n*ar-y*Wt)*Lt,a[10]=(ae*it-oe*Ce+be*Ze)*Lt,a[11]=(G*Ce-O*it-K*Ze)*Lt,a[12]=(E*Nt-v*wr-k*Wt)*Lt,a[13]=(n*wr-h*Nt+m*Wt)*Lt,a[14]=(oe*Se-ae*Ye-he*Ze)*Lt,a[15]=(O*Ye-G*Se+X*Ze)*Lt,a):null},_.aC=We,_.aD=function(a){var e=a[0],n=a[1];return Math.sqrt(e*e+n*n)},_.aE=function(a){return a[0]=0,a[1]=0,a},_.aF=function(a,e,n){return a[0]=e[0]*n,a[1]=e[1]*n,a},_.aG=Dm,_.aH=le,_.aI=function(a,e,n,h){const m=e.y-a.y,y=e.x-a.x,v=h.y-n.y,E=h.x-n.x,k=v*y-E*m;if(k===0)return null;const P=(E*(a.y-n.y)-v*(a.x-n.x))/k;return new C(a.x+P*y,a.y+P*m)},_.aJ=i,_.aK=ff,_.aL=function(a){let e=1/0,n=1/0,h=-1/0,m=-1/0;for(const y of a)e=Math.min(e,y.x),n=Math.min(n,y.y),h=Math.max(h,y.x),m=Math.max(m,y.y);return[e,n,h,m]},_.aM=Mi,_.aN=Mt,_.aO=function(a,e,n,h,m=!1){if(!n[0]&&!n[1])return[0,0];const y=m?h==="map"?-a.bearingInRadians:0:h==="viewport"?a.bearingInRadians:0;if(y){const v=Math.sin(y),E=Math.cos(y);n=[n[0]*E-n[1]*v,n[0]*v+n[1]*E]}return[m?n[0]:Mt(e,n[0],a.zoom),m?n[1]:Mt(e,n[1],a.zoom)]},_.aQ=u0,_.aR=ag,_.aS=Am,_.aT=Yx,_.aU=Ia,_.aV=Vd,_.aW=Ie,_.aX=br,_.aY=Dt,_.aZ=sr,_.a_=zm,_.aa=Mh,_.ab=25,_.ac=as,_.ad=a=>{const e=window.document.createElement("video");return e.muted=!0,new Promise((n=>{e.onloadstart=()=>{n(e)};for(const h of a){const m=window.document.createElement("source");Ht(h)||(e.crossOrigin="Anonymous"),m.src=h,e.appendChild(m)}}))},_.ae=Xt,_.af=function(){return jt++},_.ag=x,_.ah=nd,_.ai=mp,_.aj=gr,_.ak=dl,_.al=x0,_.am=function(a){const e={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((n,h,m,y)=>{const v=m||y;return e[h]=!v||v.toLowerCase(),""})),e["max-age"]){const n=parseInt(e["max-age"],10);isNaN(n)?delete e["max-age"]:e["max-age"]=n}return e},_.an=bt,_.ao=85.051129,_.ap=pr,_.aq=function(a){return Math.pow(2,a)},_.ar=ge,_.as=D_,_.at=function(a){return Math.log(a)/Math.LN2},_.au=function(a){var e=a[0],n=a[1];return e*e+n*n},_.av=function(a){if(!a.length)return new Set;const e=Math.max(...a.map((k=>k.canonical.z)));let n=1/0,h=-1/0,m=1/0,y=-1/0;const v=[];for(const k of a){const{x:P,y:O,z:G}=k.canonical,X=Math.pow(2,e-G),K=P*X,ae=O*X;v.push({id:k,x:K,y:ae}),K<n&&(n=K),K>h&&(h=K),ae<m&&(m=ae),ae>y&&(y=ae)}const E=new Set;for(const k of v)k.x!==n&&k.x!==h&&k.y!==m&&k.y!==y||E.add(k.id);return E},_.aw=function(a,e){const n=Math.abs(2*a.wrap)-+(a.wrap<0),h=Math.abs(2*e.wrap)-+(e.wrap<0);return a.overscaledZ-e.overscaledZ||h-n||e.canonical.y-a.canonical.y||e.canonical.x-a.canonical.x},_.ax=class{constructor(a,e){this.max=a,this.onRemove=e,this.reset()}reset(){for(const a in this.data)for(const e of this.data[a])e.timeout&&clearTimeout(e.timeout),this.onRemove(e.value);return this.data={},this.order=[],this}add(a,e,n){const h=a.wrapped().key;this.data[h]===void 0&&(this.data[h]=[]);const m={value:e,timeout:void 0};if(n!==void 0&&(m.timeout=setTimeout((()=>{this.remove(a,m)}),n)),this.data[h].push(m),this.order.push(h),this.order.length>this.max){const y=this._getAndRemoveByKey(this.order[0]);y&&this.onRemove(y)}return this}has(a){return a.wrapped().key in this.data}getAndRemove(a){return this.has(a)?this._getAndRemoveByKey(a.wrapped().key):null}_getAndRemoveByKey(a){const e=this.data[a].shift();return e.timeout&&clearTimeout(e.timeout),this.data[a].length===0&&delete this.data[a],this.order.splice(this.order.indexOf(a),1),e.value}getByKey(a){const e=this.data[a];return e?e[0].value:null}get(a){return this.has(a)?this.data[a.wrapped().key][0].value:null}remove(a,e){if(!this.has(a))return this;const n=a.wrapped().key,h=e===void 0?0:this.data[n].indexOf(e),m=this.data[n][h];return this.data[n].splice(h,1),m.timeout&&clearTimeout(m.timeout),this.data[n].length===0&&delete this.data[n],this.onRemove(m.value),this.order.splice(this.order.indexOf(n),1),this}setMaxSize(a){for(this.max=a;this.order.length>this.max;){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}filter(a){const e=[];for(const n in this.data)for(const h of this.data[n])a(h.value)||e.push(h);for(const n of e)this.remove(n.value.tileID,n)}},_.ay=function(a,e){let n=0,h=0;if(a.kind==="constant")h=a.layoutSize;else if(a.kind!=="source"){const{interpolationType:m,minZoom:y,maxZoom:v}=a,E=m?bt(Ii.interpolationFactor(m,e,y,v),0,1):0;a.kind==="camera"?h=ca.number(a.minSize,a.maxSize,E):n=E}return{uSizeT:n,uSize:h}},_.b=Ne,_.b$=fl,_.b0=we,_.b1=function(a){var e=new W(3);return e[0]=a[0],e[1]=a[1],e[2]=a[2],e},_.b2=function(a,e,n){return a[0]=e[0]-n[0],a[1]=e[1]-n[1],a[2]=e[2]-n[2],a},_.b3=function(a,e){var n=e[0],h=e[1],m=e[2],y=n*n+h*h+m*m;return y>0&&(y=1/Math.sqrt(y)),a[0]=e[0]*y,a[1]=e[1]*y,a[2]=e[2]*y,a},_.b4=et,_.b5=function(a,e){return a[0]*e[0]+a[1]*e[1]+a[2]*e[2]},_.b6=function(a,e,n){return a[0]=e[0]*n[0],a[1]=e[1]*n[1],a[2]=e[2]*n[2],a[3]=e[3]*n[3],a},_.b7=ie,_.b8=function(a,e,n){const h=e[0]*n[0]+e[1]*n[1]+e[2]*n[2];return h===0?null:(-(a[0]*n[0]+a[1]*n[1]+a[2]*n[2])-n[3])/h},_.b9=Je,_.bA=function(a,e,n,h){return a[0]=e[0]+n[0]*h,a[1]=e[1]+n[1]*h,a[2]=e[2]+n[2]*h,a},_.bB=tt,_.bC=function(a,e,n){var h=n[0],m=n[1],y=n[2],v=n[3],E=e[0],k=e[1],P=e[2],O=m*P-y*k,G=y*E-h*P,X=h*k-m*E;return a[0]=E+v*(O+=O)+m*(X+=X)-y*(G+=G),a[1]=k+v*G+y*O-h*X,a[2]=P+v*X+h*G-m*O,a},_.bD=function(a,e,n){const h=(function(k){var P=k[3],O=k[4],G=k[5],X=k[6],K=k[7],ae=k[8];return k[0]*(ae*O-G*K)+k[1]*(-ae*P+G*X)+k[2]*(K*P-O*X)})([a[0],a[1],a[2],e[0],e[1],e[2],n[0],n[1],n[2]]);if(h===0)return null;const m=et([],[e[0],e[1],e[2]],[n[0],n[1],n[2]]),y=et([],[n[0],n[1],n[2]],[a[0],a[1],a[2]]),v=et([],[a[0],a[1],a[2]],[e[0],e[1],e[2]]),E=Ge([],m,-a[3]);return we(E,E,Ge([],y,-e[3])),we(E,E,Ge([],v,-n[3])),Ge(E,E,1/h),E},_.bE=g0,_.bF=function(){return new Float64Array(4)},_.bG=function(a,e,n,h){var m=[],y=[];return m[0]=e[0]-n[0],m[1]=e[1]-n[1],m[2]=e[2]-n[2],y[0]=m[0]*Math.cos(h)-m[1]*Math.sin(h),y[1]=m[0]*Math.sin(h)+m[1]*Math.cos(h),y[2]=m[2],a[0]=y[0]+n[0],a[1]=y[1]+n[1],a[2]=y[2]+n[2],a},_.bH=function(a,e,n,h){var m=[],y=[];return m[0]=e[0]-n[0],m[1]=e[1]-n[1],m[2]=e[2]-n[2],y[0]=m[0],y[1]=m[1]*Math.cos(h)-m[2]*Math.sin(h),y[2]=m[1]*Math.sin(h)+m[2]*Math.cos(h),a[0]=y[0]+n[0],a[1]=y[1]+n[1],a[2]=y[2]+n[2],a},_.bI=function(a,e,n,h){var m=[],y=[];return m[0]=e[0]-n[0],m[1]=e[1]-n[1],m[2]=e[2]-n[2],y[0]=m[2]*Math.sin(h)+m[0]*Math.cos(h),y[1]=m[1],y[2]=m[2]*Math.cos(h)-m[0]*Math.sin(h),a[0]=y[0]+n[0],a[1]=y[1]+n[1],a[2]=y[2]+n[2],a},_.bJ=function(a,e,n){var h=Math.sin(n),m=Math.cos(n),y=e[0],v=e[1],E=e[2],k=e[3],P=e[8],O=e[9],G=e[10],X=e[11];return e!==a&&(a[4]=e[4],a[5]=e[5],a[6]=e[6],a[7]=e[7],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15]),a[0]=y*m-P*h,a[1]=v*m-O*h,a[2]=E*m-G*h,a[3]=k*m-X*h,a[8]=y*h+P*m,a[9]=v*h+O*m,a[10]=E*h+G*m,a[11]=k*h+X*m,a},_.bK=function(a,e){const n=me(a,360),h=me(e,360),m=h-n,y=h>n?m-360:m+360;return Math.abs(m)<Math.abs(y)?m:y},_.bL=function(a){return a[0]=0,a[1]=0,a[2]=0,a},_.bM=function(a,e,n,h){const m=Math.sqrt(a*a+e*e),y=Math.sqrt(n*n+h*h);a/=m,e/=m,n/=y,h/=y;const v=Math.acos(a*n+e*h);return-e*n+a*h>0?v:-v},_.bN=function(a,e){const n=me(a,2*Math.PI),h=me(e,2*Math.PI);return Math.min(Math.abs(n-h),Math.abs(n-h+2*Math.PI),Math.abs(n-h-2*Math.PI))},_.bO=function(){const a={},e=xt.$version;for(const n in xt.$root){const h=xt.$root[n];if(h.required){let m=null;m=n==="version"?e:h.type==="array"?[]:{},m!=null&&(a[n]=m)}}return a},_.bP=vt,_.bQ=Bf,_.bR=function a(e,n){if(Array.isArray(e)){if(!Array.isArray(n)||e.length!==n.length)return!1;for(let h=0;h<e.length;h++)if(!a(e[h],n[h]))return!1;return!0}if(typeof e=="object"&&e!==null&&n!==null){if(typeof n!="object"||Object.keys(e).length!==Object.keys(n).length)return!1;for(const h in e)if(!a(e[h],n[h]))return!1;return!0}return e===n},_.bS=function(a){a=a.slice();const e=Object.create(null);for(let n=0;n<a.length;n++)e[a[n].id]=a[n];for(let n=0;n<a.length;n++)"ref"in a[n]&&(a[n]=ya(a[n],e[a[n].ref]));return a},_.bT=function(a,e){if(a.type==="custom")return new Pm(a,e);switch(a.type){case"background":return new Un(a,e);case"circle":return new Gp(a,e);case"color-relief":return new n_(a,e);case"fill":return new l_(a,e);case"fill-extrusion":return new ym(a,e);case"heatmap":return new t_(a,e);case"hillshade":return new Qa(a,e);case"line":return new bm(a,e);case"raster":return new _c(a,e);case"symbol":return new Ch(a,e)}},_.bU=a=>a.type==="raster",_.bV=Qe,_.bW=function(a,e){if(!a)return[{command:"setStyle",args:[e]}];let n=[];try{if(!Mr(a.version,e.version))return[{command:"setStyle",args:[e]}];Mr(a.center,e.center)||n.push({command:"setCenter",args:[e.center]}),Mr(a.state,e.state)||n.push({command:"setGlobalState",args:[e.state]}),Mr(a.centerAltitude,e.centerAltitude)||n.push({command:"setCenterAltitude",args:[e.centerAltitude]}),Mr(a.zoom,e.zoom)||n.push({command:"setZoom",args:[e.zoom]}),Mr(a.bearing,e.bearing)||n.push({command:"setBearing",args:[e.bearing]}),Mr(a.pitch,e.pitch)||n.push({command:"setPitch",args:[e.pitch]}),Mr(a.roll,e.roll)||n.push({command:"setRoll",args:[e.roll]}),Mr(a.sprite,e.sprite)||n.push({command:"setSprite",args:[e.sprite]}),Mr(a.glyphs,e.glyphs)||n.push({command:"setGlyphs",args:[e.glyphs]}),Mr(a.transition,e.transition)||n.push({command:"setTransition",args:[e.transition]}),Mr(a.light,e.light)||n.push({command:"setLight",args:[e.light]}),Mr(a.terrain,e.terrain)||n.push({command:"setTerrain",args:[e.terrain]}),Mr(a.sky,e.sky)||n.push({command:"setSky",args:[e.sky]}),Mr(a.projection,e.projection)||n.push({command:"setProjection",args:[e.projection]});const h={},m=[];(function(v,E,k,P){let O;for(O in E=E||{},v=v||{})Object.prototype.hasOwnProperty.call(v,O)&&(Object.prototype.hasOwnProperty.call(E,O)||Vn(O,k,P));for(O in E)Object.prototype.hasOwnProperty.call(E,O)&&(Object.prototype.hasOwnProperty.call(v,O)?Mr(v[O],E[O])||(v[O].type==="geojson"&&E[O].type==="geojson"&&gn(v,E,O)?Fn(k,{command:"setGeoJSONSourceData",args:[O,E[O].data]}):va(O,E,k,P)):Ga(O,E,k))})(a.sources,e.sources,m,h);const y=[];a.layers&&a.layers.forEach((v=>{"source"in v&&h[v.source]?n.push({command:"removeLayer",args:[v.id]}):y.push(v)})),n=n.concat(m),(function(v,E,k){E=E||[];const P=(v=v||[]).map(Yi),O=E.map(Yi),G=v.reduce(xo,{}),X=E.reduce(xo,{}),K=P.slice(),ae=Object.create(null);let oe,he,be,Ze,Se;for(let Ce=0,Ye=0;Ce<P.length;Ce++)oe=P[Ce],Object.prototype.hasOwnProperty.call(X,oe)?Ye++:(Fn(k,{command:"removeLayer",args:[oe]}),K.splice(K.indexOf(oe,Ye),1));for(let Ce=0,Ye=0;Ce<O.length;Ce++)oe=O[O.length-1-Ce],K[K.length-1-Ce]!==oe&&(Object.prototype.hasOwnProperty.call(G,oe)?(Fn(k,{command:"removeLayer",args:[oe]}),K.splice(K.lastIndexOf(oe,K.length-Ye),1)):Ye++,Ze=K[K.length-Ce],Fn(k,{command:"addLayer",args:[X[oe],Ze]}),K.splice(K.length-Ce,0,oe),ae[oe]=!0);for(let Ce=0;Ce<O.length;Ce++)if(oe=O[Ce],he=G[oe],be=X[oe],!ae[oe]&&!Mr(he,be))if(Mr(he.source,be.source)&&Mr(he["source-layer"],be["source-layer"])&&Mr(he.type,be.type)){for(Se in ga(he.layout,be.layout,k,oe,null,"setLayoutProperty"),ga(he.paint,be.paint,k,oe,null,"setPaintProperty"),Mr(he.filter,be.filter)||Fn(k,{command:"setFilter",args:[oe,be.filter]}),Mr(he.minzoom,be.minzoom)&&Mr(he.maxzoom,be.maxzoom)||Fn(k,{command:"setLayerZoomRange",args:[oe,be.minzoom,be.maxzoom]}),he)Object.prototype.hasOwnProperty.call(he,Se)&&Se!=="layout"&&Se!=="paint"&&Se!=="filter"&&Se!=="metadata"&&Se!=="minzoom"&&Se!=="maxzoom"&&(Se.indexOf("paint.")===0?ga(he[Se],be[Se],k,oe,Se.slice(6),"setPaintProperty"):Mr(he[Se],be[Se])||Fn(k,{command:"setLayerProperty",args:[oe,Se,be[Se]]}));for(Se in be)Object.prototype.hasOwnProperty.call(be,Se)&&!Object.prototype.hasOwnProperty.call(he,Se)&&Se!=="layout"&&Se!=="paint"&&Se!=="filter"&&Se!=="metadata"&&Se!=="minzoom"&&Se!=="maxzoom"&&(Se.indexOf("paint.")===0?ga(he[Se],be[Se],k,oe,Se.slice(6),"setPaintProperty"):Mr(he[Se],be[Se])||Fn(k,{command:"setLayerProperty",args:[oe,Se,be[Se]]}))}else Fn(k,{command:"removeLayer",args:[oe]}),Ze=K[K.lastIndexOf(oe)+1],Fn(k,{command:"addLayer",args:[be,Ze]})})(y,e.layers,n)}catch(h){console.warn("Unable to compute style diff:",h),n=[{command:"setStyle",args:[e]}]}return n},_.bX=function(a){const e=[],n=a.id;return n===void 0&&e.push({message:`layers.${n}: missing required property "id"`}),a.render===void 0&&e.push({message:`layers.${n}: missing required method "render"`}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&e.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),e},_.bY=Yt,_.bZ=jr,_.b_=class extends Us{constructor(a,e){super(a,e),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},_.ba=function(a,e,n){return a[0]=e[0]*n,a[1]=e[1]*n,a[2]=e[2]*n,a[3]=e[3]*n,a},_.bb=function(a,e){return a[0]*e[0]+a[1]*e[1]+a[2]*e[2]+a[3]},_.bc=I_,_.bd=id,_.be=function(a,e,n,h,m){var y=1/Math.tan(e/2);if(a[0]=y/n,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=y,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,m!=null&&m!==1/0){var v=1/(h-m);a[10]=(m+h)*v,a[14]=2*m*h*v}else a[10]=-1,a[14]=-2*h;return a},_.bf=function(a){var e=new W(16);return e[0]=a[0],e[1]=a[1],e[2]=a[2],e[3]=a[3],e[4]=a[4],e[5]=a[5],e[6]=a[6],e[7]=a[7],e[8]=a[8],e[9]=a[9],e[10]=a[10],e[11]=a[11],e[12]=a[12],e[13]=a[13],e[14]=a[14],e[15]=a[15],e},_.bg=function(a,e,n){var h=Math.sin(n),m=Math.cos(n),y=e[0],v=e[1],E=e[2],k=e[3],P=e[4],O=e[5],G=e[6],X=e[7];return e!==a&&(a[8]=e[8],a[9]=e[9],a[10]=e[10],a[11]=e[11],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15]),a[0]=y*m+P*h,a[1]=v*m+O*h,a[2]=E*m+G*h,a[3]=k*m+X*h,a[4]=P*m-y*h,a[5]=O*m-v*h,a[6]=G*m-E*h,a[7]=X*m-k*h,a},_.bh=function(a,e,n){var h=Math.sin(n),m=Math.cos(n),y=e[4],v=e[5],E=e[6],k=e[7],P=e[8],O=e[9],G=e[10],X=e[11];return e!==a&&(a[0]=e[0],a[1]=e[1],a[2]=e[2],a[3]=e[3],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15]),a[4]=y*m+P*h,a[5]=v*m+O*h,a[6]=E*m+G*h,a[7]=k*m+X*h,a[8]=P*m-y*h,a[9]=O*m-v*h,a[10]=G*m-E*h,a[11]=X*m-k*h,a},_.bi=function(){const a=new Float32Array(16);return ge(a),a},_.bj=function(){const a=new Float64Array(16);return ge(a),a},_.bk=function(){return new Float64Array(16)},_.bl=function(a,e,n){const h=new Float64Array(4);return tt(h,a,e-90,n),h},_.bm=function(a,e,n,h){var m,y,v,E,k,P=e[0],O=e[1],G=e[2],X=e[3],K=n[0],ae=n[1],oe=n[2],he=n[3];return(y=P*K+O*ae+G*oe+X*he)<0&&(y=-y,K=-K,ae=-ae,oe=-oe,he=-he),1-y>Y?(m=Math.acos(y),v=Math.sin(m),E=Math.sin((1-h)*m)/v,k=Math.sin(h*m)/v):(E=1-h,k=h),a[0]=E*P+k*K,a[1]=E*O+k*ae,a[2]=E*G+k*oe,a[3]=E*X+k*he,a},_.bn=function(a){const e=new Float64Array(9);(function(y,v){var E=v[0],k=v[1],P=v[2],O=v[3],G=E+E,X=k+k,K=P+P,ae=E*G,oe=k*G,he=k*X,be=P*G,Ze=P*X,Se=P*K,Ce=O*G,Ye=O*X,it=O*K;y[0]=1-he-Se,y[3]=oe-it,y[6]=be+Ye,y[1]=oe+it,y[4]=1-ae-Se,y[7]=Ze-Ce,y[2]=be-Ye,y[5]=Ze+Ce,y[8]=1-ae-he})(e,a);const n=sr(-Math.asin(bt(e[2],-1,1)));let h,m;return Math.hypot(e[5],e[8])<.001?(h=0,m=-sr(Math.atan2(e[3],e[4]))):(h=sr(e[5]===0&&e[8]===0?0:Math.atan2(e[5],e[8])),m=sr(e[1]===0&&e[0]===0?0:Math.atan2(e[1],e[0]))),{roll:h,pitch:n+90,bearing:m}},_.bo=function(a,e){return a.roll==e.roll&&a.pitch==e.pitch&&a.bearing==e.bearing},_.bp=fn,_.bq=Fu,_.br=Fo,_.bs=wc,_.bt=ns,_.bu=re,_.bv=Ve,_.bw=la,_.bx=function(a,e,n,h,m){return re(h,m,bt((a-e)/(n-e),0,1))},_.by=me,_.bz=function(){return new Float64Array(3)},_.c=$e,_.c$=function(a,e,n,h,m){return s(this,void 0,void 0,(function*(){if(Z())try{return yield Kt(a,e,n,h,m)}catch{}return(function(y,v,E,k,P){const O=y.width,G=y.height;Jt&&kt||(Jt=new OffscreenCanvas(O,G),kt=Jt.getContext("2d",{willReadFrequently:!0})),Jt.width=O,Jt.height=G,kt.drawImage(y,0,0,O,G);const X=kt.getImageData(v,E,k,P);return kt.clearRect(0,0,O,G),X.data})(a,e,n,h,m)}))},_.c0=class extends Us{constructor(a,e){super(a,e),this.current=Vs}set(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let e=1;e<16;e++)if(a[e]!==this.current[e]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}},_.c1=wh,_.c2=class extends Us{constructor(a,e){super(a,e),this.current=[0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))}},_.c3=class extends Us{constructor(a,e){super(a,e),this.current=[0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))}},_.c4=de,_.c5=function(a,e){var n=Math.sin(e),h=Math.cos(e);return a[0]=h,a[1]=n,a[2]=0,a[3]=-n,a[4]=h,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},_.c6=function(a,e,n){var h=e[0],m=e[1],y=e[2];return a[0]=h*n[0]+m*n[3]+y*n[6],a[1]=h*n[1]+m*n[4]+y*n[7],a[2]=h*n[2]+m*n[5]+y*n[8],a},_.c7=function(a,e,n,h,m,y,v){var E=1/(e-n),k=1/(h-m),P=1/(y-v);return a[0]=-2*E,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*k,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*P,a[11]=0,a[12]=(e+n)*E,a[13]=(m+h)*k,a[14]=(v+y)*P,a[15]=1,a},_.c8=class extends Us{constructor(a,e){super(a,e),this.current=new Array}set(a){if(a!=this.current){this.current=a;const e=new Float32Array(4*a.length);for(let n=0;n<a.length;n++)e[4*n]=a[n].r,e[4*n+1]=a[n].g,e[4*n+2]=a[n].b,e[4*n+3]=a[n].a;this.gl.uniform4fv(this.location,e)}}},_.c9=class extends Us{constructor(a,e){super(a,e),this.current=new Array}set(a){if(a!=this.current){this.current=a;const e=new Float32Array(a);this.gl.uniform1fv(this.location,e)}}},_.cA=function(a,e){return st[e]&&"touches"in a},_.cB=function(a){return st[a]||fe[a]},_.cC=function(a,e,n){var h=e[0],m=e[1];return a[0]=n[0]*h+n[4]*m+n[12],a[1]=n[1]*h+n[5]*m+n[13],a},_.cD=function(a,e){const{x:n,y:h}=na.fromLngLat(e);return!(a<0||a>25||h<0||h>=1||n<0||n>=1)},_.cE=function(a,e){return a[0]=e[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=e[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=e[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},_.cF=class extends Du{},_.cG=Ow,_.cI=at,_.cJ=function(a,e){$e.REGISTERED_PROTOCOLS[a]=e},_.cK=function(a){delete $e.REGISTERED_PROTOCOLS[a]},_.cL=function(a,e){const n={};for(let m=0;m<a.length;m++){const y=e&&e[a[m].id]||Xr(a[m]);e&&(e[a[m].id]=y);let v=n[y];v||(v=n[y]=[]),v.push(a[m])}const h=[];for(const m in n)h.push(n[m]);return h},_.cM=kr,_.cN=Bm,_.cO=ng,_.cP=o0,_.cQ=function(a){a.bucket.createArrays(),a.bucket.tilePixelRatio=Be/(512*a.bucket.overscaling),a.bucket.compareText={},a.bucket.iconsNeedLinear=!1;const e=a.bucket.layers[0],n=e.layout,h=e._unevaluatedLayout._values,m={layoutIconSize:h["icon-size"].possiblyEvaluate(new Jn(a.bucket.zoom+1),a.canonical),layoutTextSize:h["text-size"].possiblyEvaluate(new Jn(a.bucket.zoom+1),a.canonical),textMaxSize:h["text-size"].possiblyEvaluate(new Jn(18))};if(a.bucket.textSizeData.kind==="composite"){const{minZoom:P,maxZoom:O}=a.bucket.textSizeData;m.compositeTextSizes=[h["text-size"].possiblyEvaluate(new Jn(P),a.canonical),h["text-size"].possiblyEvaluate(new Jn(O),a.canonical)]}if(a.bucket.iconSizeData.kind==="composite"){const{minZoom:P,maxZoom:O}=a.bucket.iconSizeData;m.compositeIconSizes=[h["icon-size"].possiblyEvaluate(new Jn(P),a.canonical),h["icon-size"].possiblyEvaluate(new Jn(O),a.canonical)]}const y=n.get("text-line-height")*Mi,v=n.get("text-rotation-alignment")!=="viewport"&&n.get("symbol-placement")!=="point",E=n.get("text-keep-upright"),k=n.get("text-size");for(const P of a.bucket.features){const O=n.get("text-font").evaluate(P,{},a.canonical).join(","),G=k.evaluate(P,{},a.canonical),X=m.layoutTextSize.evaluate(P,{},a.canonical),K=m.layoutIconSize.evaluate(P,{},a.canonical),ae={horizontal:{},vertical:void 0},oe=P.text;let he,be=[0,0];if(oe){const Ce=oe.toString(),Ye=n.get("text-letter-spacing").evaluate(P,{},a.canonical)*Mi,it=Nf(Ce)?Ye:0,At=n.get("text-anchor").evaluate(P,{},a.canonical),Wt=$u(e,P,a.canonical);if(!Wt){const ar=n.get("text-radial-offset").evaluate(P,{},a.canonical);be=ar?ea(At,[ar*Mi,Bn]):n.get("text-offset").evaluate(P,{},a.canonical).map((qt=>qt*Mi))}let Nt=v?"center":n.get("text-justify").evaluate(P,{},a.canonical);const rr=n.get("symbol-placement")==="point"?n.get("text-max-width").evaluate(P,{},a.canonical)*Mi:1/0,wr=()=>{a.bucket.allowVerticalPlacement&&jl(Ce)&&(ae.vertical=Xd(oe,a.glyphMap,a.glyphPositions,a.imagePositions,O,rr,y,At,"left",it,be,_.az.vertical,!0,X,G))};if(!v&&Wt){const ar=new Set;if(Nt==="auto")for(let Lt=0;Lt<Wt.values.length;Lt+=2)ar.add(ag(Wt.values[Lt]));else ar.add(Nt);let qt=!1;for(const Lt of ar)if(!ae.horizontal[Lt])if(qt)ae.horizontal[Lt]=ae.horizontal[0];else{const Pr=Xd(oe,a.glyphMap,a.glyphPositions,a.imagePositions,O,rr,y,"center",Lt,it,be,_.az.horizontal,!1,X,G);Pr&&(ae.horizontal[Lt]=Pr,qt=Pr.positionedLines.length===1)}wr()}else{Nt==="auto"&&(Nt=ag(At));const ar=Xd(oe,a.glyphMap,a.glyphPositions,a.imagePositions,O,rr,y,At,Nt,it,be,_.az.horizontal,!1,X,G);ar&&(ae.horizontal[Nt]=ar),wr(),jl(Ce)&&v&&E&&(ae.vertical=Xd(oe,a.glyphMap,a.glyphPositions,a.imagePositions,O,rr,y,At,Nt,it,be,_.az.vertical,!1,X,G))}}let Ze=!1;if(P.icon&&P.icon.name){const Ce=a.imageMap[P.icon.name];Ce&&(he=Cm(a.imagePositions[P.icon.name],n.get("icon-offset").evaluate(P,{},a.canonical),n.get("icon-anchor").evaluate(P,{},a.canonical)),Ze=!!Ce.sdf,a.bucket.sdfIcons===void 0?a.bucket.sdfIcons=Ze:a.bucket.sdfIcons!==Ze&&se("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ce.pixelRatio!==a.bucket.pixelRatio||n.get("icon-rotate").constantOr(1)!==0)&&(a.bucket.iconsNeedLinear=!0))}const Se=I1(ae.horizontal)||ae.vertical;a.bucket.iconsInText=!!Se&&Se.iconsInText,(Se||he)&&Lw(a.bucket,P,ae,he,a.imageMap,m,X,K,be,Ze,a.canonical,a.subdivisionGranularity)}a.showCollisionBoxes&&a.bucket.generateCollisionDebugBuffers()},_.cR=pf,_.cS=Sh,_.cT=Yf,_.cU=function(a){const e=new a0;return(function(n,h){for(const m in n.layers)h.writeMessage(3,D0,n.layers[m])})(a,e),e.finish()},_.cV=function(a,e,n,h,m,y){let v=c(a,e,n,m,0);return v=c(v,e,h,y,1),v},_.cW=class{constructor(a){this.maxEntries=a,this.map=new Map}get(a){const e=this.map.get(a);return e!==void 0&&(this.map.delete(a),this.map.set(a,e)),e}set(a,e){if(this.map.has(a))this.map.delete(a);else if(this.map.size>=this.maxEntries){const n=this.map.keys().next().value;this.map.delete(n)}this.map.set(a,e)}clear(){this.map.clear()}},_.cX=jn,_.cY=a0,_.cZ=pp,_.c_=class{constructor(a){this._marks={start:[a.url,"start"].join("#"),end:[a.url,"end"].join("#"),measure:a.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let a=performance.getEntriesByName(this._marks.measure);return a.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),a=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),a}},_.ca=class extends yc{},_.cb=d_,_.cc=class extends Pa{},_.cd=Fd,_.ce=function(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},_.cf=Qc,_.cg=function(a,e,n){var h=e[0],m=e[1],y=e[2],v=n[3]*h+n[7]*m+n[11]*y+n[15];return a[0]=(n[0]*h+n[4]*m+n[8]*y+n[12])/(v=v||1),a[1]=(n[1]*h+n[5]*m+n[9]*y+n[13])/v,a[2]=(n[2]*h+n[6]*m+n[10]*y+n[14])/v,a},_.ch=class extends Ru{},_.ci=class extends t{},_.cj=function(a,e){return a[0]===e[0]&&a[1]===e[1]&&a[2]===e[2]&&a[3]===e[3]&&a[4]===e[4]&&a[5]===e[5]&&a[6]===e[6]&&a[7]===e[7]&&a[8]===e[8]&&a[9]===e[9]&&a[10]===e[10]&&a[11]===e[11]&&a[12]===e[12]&&a[13]===e[13]&&a[14]===e[14]&&a[15]===e[15]},_.ck=function(a,e){var n=a[0],h=a[1],m=a[2],y=a[3],v=a[4],E=a[5],k=a[6],P=a[7],O=a[8],G=a[9],X=a[10],K=a[11],ae=a[12],oe=a[13],he=a[14],be=a[15],Ze=e[0],Se=e[1],Ce=e[2],Ye=e[3],it=e[4],At=e[5],Wt=e[6],Nt=e[7],rr=e[8],wr=e[9],ar=e[10],qt=e[11],Lt=e[12],Pr=e[13],Cr=e[14],zr=e[15];return Math.abs(n-Ze)<=Y*Math.max(1,Math.abs(n),Math.abs(Ze))&&Math.abs(h-Se)<=Y*Math.max(1,Math.abs(h),Math.abs(Se))&&Math.abs(m-Ce)<=Y*Math.max(1,Math.abs(m),Math.abs(Ce))&&Math.abs(y-Ye)<=Y*Math.max(1,Math.abs(y),Math.abs(Ye))&&Math.abs(v-it)<=Y*Math.max(1,Math.abs(v),Math.abs(it))&&Math.abs(E-At)<=Y*Math.max(1,Math.abs(E),Math.abs(At))&&Math.abs(k-Wt)<=Y*Math.max(1,Math.abs(k),Math.abs(Wt))&&Math.abs(P-Nt)<=Y*Math.max(1,Math.abs(P),Math.abs(Nt))&&Math.abs(O-rr)<=Y*Math.max(1,Math.abs(O),Math.abs(rr))&&Math.abs(G-wr)<=Y*Math.max(1,Math.abs(G),Math.abs(wr))&&Math.abs(X-ar)<=Y*Math.max(1,Math.abs(X),Math.abs(ar))&&Math.abs(K-qt)<=Y*Math.max(1,Math.abs(K),Math.abs(qt))&&Math.abs(ae-Lt)<=Y*Math.max(1,Math.abs(ae),Math.abs(Lt))&&Math.abs(oe-Pr)<=Y*Math.max(1,Math.abs(oe),Math.abs(Pr))&&Math.abs(he-Cr)<=Y*Math.max(1,Math.abs(he),Math.abs(Cr))&&Math.abs(be-zr)<=Y*Math.max(1,Math.abs(be),Math.abs(zr))},_.cl=function(a,e){return a[0]=e[0],a[1]=e[1],a[2]=e[2],a[3]=e[3],a[4]=e[4],a[5]=e[5],a[6]=e[6],a[7]=e[7],a[8]=e[8],a[9]=e[9],a[10]=e[10],a[11]=e[11],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15],a},_.cm=a=>a.type==="symbol",_.cn=a=>a.type==="circle",_.co=a=>a.type==="heatmap",_.cp=a=>a.type==="line",_.cq=a=>a.type==="fill",_.cr=a=>a.type==="fill-extrusion",_.cs=a=>a.type==="hillshade",_.ct=a=>a.type==="color-relief",_.cu=a=>a.type==="background",_.cv=a=>a.type==="custom",_.cw=Pe,_.cx=function(a,e,n){const h=$t(e.x-n.x,e.y-n.y),m=$t(a.x-n.x,a.y-n.y),y=Math.atan2(h[0]*m[1]-h[1]*m[0],(function(v,E){return v[0]*E[0]+v[1]*E[1]})(h,m));return sr(y)},_.cy=De,_.cz=function(a,e){return fe[e]&&(a instanceof MouseEvent||a instanceof WheelEvent)},_.d=Ht,_.d0=Zf,_.d1=M,_.d2=class{constructor(a,e){this.layers={[mp]:this},this.name=mp,this.version=e?e.version:1,this.extent=e?e.extent:4096,this.length=a.length,this.features=a}feature(a){return new q_(this.features[a],this.extent)}},_.d3=Jr,_.d4=Co,_.e=Zt,_.f=a=>s(void 0,void 0,void 0,(function*(){if(a.byteLength===0)return createImageBitmap(new ImageData(1,1));const e=new Blob([new Uint8Array(a)],{type:"image/png"});try{return createImageBitmap(e)}catch(n){throw new Error(`Could not load image because of ${n.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),_.g=_t,_.h=a=>new Promise(((e,n)=>{const h=new Image;h.onload=()=>{e(h),URL.revokeObjectURL(h.src),h.onload=null,window.requestAnimationFrame((()=>{h.src=dt}))},h.onerror=()=>n(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const m=new Blob([new Uint8Array(a)],{type:"image/png"});h.src=a.byteLength?URL.createObjectURL(m):dt})),_.i=yt,_.j=(a,e)=>Bt(Zt(a,{type:"json"}),e),_.k=xn,_.l=Gr,_.m=Bt,_.n=(a,e)=>Bt(Zt(a,{type:"arrayBuffer"}),e),_.o=function(a){return new a0(a).readFields(w_,[])},_.p=Em,_.q=function(a){return/[\u02EA\u02EB\u1100-\u11FF\u2E80-\u2FDF\u3000-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(a))},_.r=Pd,_.s=lr,_.t=ni,_.u=xt,_.v=Au,_.w=se,_.x=Uf,_.y=il,_.z=gc})),p("worker",["./shared"],(function(_){class s{constructor(fe,ue){this.keyCache={},fe&&this.replace(fe,ue)}replace(fe,ue){this._layerConfigs={},this._layers={},this.update(fe,[],ue)}update(fe,ue,ye){for(const $e of fe){this._layerConfigs[$e.id]=$e;const _t=this._layers[$e.id]=_.bT($e,ye);_t._featureFilter=_.aj(_t.filter,ye),this.keyCache[$e.id]&&delete this.keyCache[$e.id]}for(const $e of ue)delete this.keyCache[$e],delete this._layerConfigs[$e],delete this._layers[$e];this.familiesBySource={};const je=_.cL(Object.values(this._layerConfigs),this.keyCache);for(const $e of je){const _t=$e.map((Tr=>this._layers[Tr.id])),lt=_t[0];if(lt.isHidden())continue;const at=lt.source||"";let vt=this.familiesBySource[at];vt||(vt=this.familiesBySource[at]={});const Bt=lt.sourceLayer||_.ai;let Ht=vt[Bt];Ht||(Ht=vt[Bt]=[]),Ht.push(_t)}}}class C{constructor(fe){const ue={},ye=[];for(const lt in fe){const at=fe[lt],vt=ue[lt]={};for(const Bt in at){const Ht=at[+Bt];if(!Ht||Ht.bitmap.width===0||Ht.bitmap.height===0)continue;const Tr={x:0,y:0,w:Ht.bitmap.width+2,h:Ht.bitmap.height+2};ye.push(Tr),vt[Bt]={rect:Tr,metrics:Ht.metrics}}}const{w:je,h:$e}=_.p(ye),_t=new _.r({width:je||1,height:$e||1});for(const lt in fe){const at=fe[lt];for(const vt in at){const Bt=at[+vt];if(!Bt||Bt.bitmap.width===0||Bt.bitmap.height===0)continue;const Ht=ue[lt][vt].rect;_.r.copy(Bt.bitmap,_t,{x:0,y:0},{x:Ht.x+1,y:Ht.y+1},Bt.bitmap)}}this.image=_t,this.positions=ue}}_.cM("GlyphAtlas",C);class M{constructor(fe){this.tileID=new _.a2(fe.tileID.overscaledZ,fe.tileID.wrap,fe.tileID.canonical.z,fe.tileID.canonical.x,fe.tileID.canonical.y),this.uid=fe.uid,this.zoom=fe.zoom,this.pixelRatio=fe.pixelRatio,this.tileSize=fe.tileSize,this.source=fe.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=fe.showCollisionBoxes,this.collectResourceTiming=!!fe.collectResourceTiming,this.returnDependencies=!!fe.returnDependencies,this.promoteId=fe.promoteId,this.inFlightDependencies=[]}parse(fe,ue,ye,je,$e){return _._(this,void 0,void 0,(function*(){this.status="parsing",this.data=fe,this.collisionBoxArray=new _.ag;const _t=new _.cN(Object.keys(fe.layers).sort()),lt=new _.cO(this.tileID,this.promoteId);lt.bucketLayerIDs=[];const at={},vt={featureIndex:lt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:ye,subdivisionGranularity:$e},Bt=ue.familiesBySource[this.source];for(const gn in Bt){const ga=fe.layers[gn];if(!ga)continue;ga.version===1&&_.w(`Vector tile source "${this.source}" layer "${gn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Yi=_t.encode(gn),xo=[];for(let Xt=0;Xt<ga.length;Xt++){const xe=ga.feature(Xt),Ue=lt.getId(xe,gn);xo.push({feature:xe,id:Ue,index:Xt,sourceLayerIndex:Yi})}for(const Xt of Bt[gn]){const xe=Xt[0];xe.source!==this.source&&_.w(`layer.source = ${xe.source} does not equal this.source = ${this.source}`),xe.isHidden(this.zoom,!0)||(D(Xt,this.zoom,ye),(at[xe.id]=xe.createBucket({index:lt.bucketLayerIDs.length,layers:Xt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Yi,sourceID:this.source})).populate(xo,vt,this.tileID.canonical),lt.bucketLayerIDs.push(Xt.map((Ue=>Ue.id))))}}const Ht=_.bY(vt.glyphDependencies,(gn=>Object.keys(gn).map(Number)));this.inFlightDependencies.forEach((gn=>gn?.abort())),this.inFlightDependencies=[];let Tr=Promise.resolve({});if(Object.keys(Ht).length){const gn=new AbortController;this.inFlightDependencies.push(gn),Tr=je.sendAsync({type:"GG",data:{stacks:Ht,source:this.source,tileID:this.tileID,type:"glyphs"}},gn)}const hr=Object.keys(vt.iconDependencies);let Gr=Promise.resolve({});if(hr.length){const gn=new AbortController;this.inFlightDependencies.push(gn),Gr=je.sendAsync({type:"GI",data:{icons:hr,source:this.source,tileID:this.tileID,type:"icons"}},gn)}const xn=Object.keys(vt.patternDependencies);let an=Promise.resolve({});if(xn.length){const gn=new AbortController;this.inFlightDependencies.push(gn),an=je.sendAsync({type:"GI",data:{icons:xn,source:this.source,tileID:this.tileID,type:"patterns"}},gn)}const xt=vt.dashDependencies;let Ln=Promise.resolve({});if(Object.keys(xt).length){const gn=new AbortController;this.inFlightDependencies.push(gn),Ln=je.sendAsync({type:"GDA",data:{dashes:xt}},gn)}const[ya,Mr,Fn,Ga]=yield Promise.all([Tr,Gr,an,Ln]),Vn=new C(ya),va=new _.cP(Mr,Fn);for(const gn in at){const ga=at[gn];ga instanceof _.ah?(D(ga.layers,this.zoom,ye),_.cQ({bucket:ga,glyphMap:ya,glyphPositions:Vn.positions,imageMap:Mr,imagePositions:va.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:vt.subdivisionGranularity})):ga.hasDependencies&&(ga instanceof _.cR||ga instanceof _.cS||ga instanceof _.cT)&&(D(ga.layers,this.zoom,ye),ga.addFeatures(vt,this.tileID.canonical,va.patternPositions,Ga))}return this.status="done",{buckets:Object.values(at).filter((gn=>!gn.isEmpty())),featureIndex:lt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Vn.image,imageAtlas:va,dashPositions:Ga,glyphMap:this.returnDependencies?ya:null,iconMap:this.returnDependencies?Mr:null,glyphPositions:this.returnDependencies?Vn.positions:null}}))}}function D(st,fe,ue){const ye=new _.H(fe);for(const je of st)je.recalculate(ye,ue)}class B{constructor(fe,ue,ye,je,$e){this.type=fe,this.properties=ye||{},this.extent=$e,this.pointsArray=ue,this.id=je}loadGeometry(){return this.pointsArray.map((fe=>fe.map((ue=>new _.P(ue.x,ue.y)))))}}class U{constructor(fe,ue,ye){this.version=2,this._myFeatures=fe,this.name=ue,this.length=fe.length,this.extent=ye}feature(fe){return this._myFeatures[fe]}}class j{constructor(){this.layers={}}addLayer(fe){this.layers[fe.name]=fe}}function H(st){let fe=_.cU(st);return fe.byteOffset===0&&fe.byteLength===fe.buffer.byteLength||(fe=new Uint8Array(fe)),{vectorTile:st,rawData:fe.buffer}}function z(st,fe,ue){const{extent:ye}=st,je=Math.pow(2,ue.z-fe.z),$e=(ue.x-fe.x*je)*ye,_t=(ue.y-fe.y*je)*ye,lt=[];for(let at=0;at<st.length;at++){const vt=st.feature(at);let Bt=vt.loadGeometry();for(const Tr of Bt)for(const hr of Tr)hr.x=hr.x*je-$e,hr.y=hr.y*je-_t;const Ht=128;Bt=_.cV(Bt,vt.type,-Ht,-Ht,ye+Ht,ye+Ht),Bt.length!==0&&lt.push(new B(vt.type,Bt,vt.properties,vt.id,ye))}return new U(lt,st.name,ye)}class N{constructor(fe,ue,ye){this.actor=fe,this.layerIndex=ue,this.availableImages=ye,this.fetching={},this.loading={},this.loaded={},this.overzoomedTileResultCache=new _.cW(1e3)}loadVectorTile(fe,ue){return _._(this,void 0,void 0,(function*(){const ye=yield _.n(fe.request,ue);try{return{vectorTile:fe.encoding!=="mlt"?new _.cX(new _.cY(ye.data)):new _.cZ(ye.data),rawData:ye.data,cacheControl:ye.cacheControl,expires:ye.expires}}catch(je){const $e=new Uint8Array(ye.data);let _t=`Unable to parse the tile at ${fe.request.url}, `;throw _t+=$e[0]===31&&$e[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${je.message}`,new Error(_t)}}))}loadTile(fe){return _._(this,void 0,void 0,(function*(){const{uid:ue,overzoomParameters:ye}=fe;ye&&(fe.request=ye.overzoomRequest);const je=!!(fe&&fe.request&&fe.request.collectResourceTiming)&&new _.c_(fe.request),$e=new M(fe);this.loading[ue]=$e;const _t=new AbortController;$e.abort=_t;try{const lt=yield this.loadVectorTile(fe,_t);if(delete this.loading[ue],!lt)return null;if(ye){const Tr=this._getOverzoomTile(fe,lt.vectorTile);lt.rawData=Tr.rawData,lt.vectorTile=Tr.vectorTile}const at=lt.rawData,vt={};lt.expires&&(vt.expires=lt.expires),lt.cacheControl&&(vt.cacheControl=lt.cacheControl);const Bt={};if(je){const Tr=je.finish();Tr&&(Bt.resourceTiming=JSON.parse(JSON.stringify(Tr)))}$e.vectorTile=lt.vectorTile;const Ht=$e.parse(lt.vectorTile,this.layerIndex,this.availableImages,this.actor,fe.subdivisionGranularity);this.loaded[ue]=$e,this.fetching[ue]={rawTileData:at,cacheControl:vt,resourceTiming:Bt};try{const Tr=yield Ht;return _.e({rawTileData:at.slice(0),encoding:fe.encoding},Tr,vt,Bt)}finally{delete this.fetching[ue]}}catch(lt){throw delete this.loading[ue],$e.status="done",this.loaded[ue]=$e,lt}}))}_getOverzoomTile(fe,ue){const{tileID:ye,source:je,overzoomParameters:$e}=fe,{maxZoomTileID:_t}=$e,lt=`${_t.key}_${ye.key}`,at=this.overzoomedTileResultCache.get(lt);if(at)return at;const vt=new j,Bt=this.layerIndex.familiesBySource[je];for(const Tr in Bt){const hr=ue.layers[Tr];if(!hr)continue;const Gr=z(hr,_t,ye.canonical);Gr.length>0&&vt.addLayer(Gr)}const Ht=H(vt);return this.overzoomedTileResultCache.set(lt,Ht),Ht}reloadTile(fe){return _._(this,void 0,void 0,(function*(){const ue=fe.uid;if(!this.loaded||!this.loaded[ue])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const ye=this.loaded[ue];if(ye.showCollisionBoxes=fe.showCollisionBoxes,ye.status==="parsing"){const je=yield ye.parse(ye.vectorTile,this.layerIndex,this.availableImages,this.actor,fe.subdivisionGranularity);let $e;if(this.fetching[ue]){const{rawTileData:_t,cacheControl:lt,resourceTiming:at}=this.fetching[ue];delete this.fetching[ue],$e=_.e({rawTileData:_t.slice(0),encoding:fe.encoding},je,lt,at)}else $e=je;return $e}if(ye.status==="done"&&ye.vectorTile)return ye.parse(ye.vectorTile,this.layerIndex,this.availableImages,this.actor,fe.subdivisionGranularity)}))}abortTile(fe){return _._(this,void 0,void 0,(function*(){const ue=this.loading,ye=fe.uid;ue&&ue[ye]&&ue[ye].abort&&(ue[ye].abort.abort(),delete ue[ye])}))}removeTile(fe){return _._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[fe.uid]&&delete this.loaded[fe.uid]}))}}class Z{constructor(){this.loaded={}}loadTile(fe){return _._(this,void 0,void 0,(function*(){const{uid:ue,encoding:ye,rawImageData:je,redFactor:$e,greenFactor:_t,blueFactor:lt,baseShift:at}=fe,vt=je.width+2,Bt=je.height+2,Ht=_.b(je)?new _.R({width:vt,height:Bt},yield _.c$(je,-1,-1,vt,Bt)):je,Tr=new _.d0(ue,Ht,ye,$e,_t,lt,at);return this.loaded=this.loaded||{},this.loaded[ue]=Tr,Tr}))}removeTile(fe){const ue=this.loaded,ye=fe.uid;ue&&ue[ye]&&delete ue[ye]}}var Y,W,de=(function(){if(W)return Y;function st(ue,ye){if(ue.length!==0){fe(ue[0],ye);for(var je=1;je<ue.length;je++)fe(ue[je],!ye)}}function fe(ue,ye){for(var je=0,$e=0,_t=0,lt=ue.length,at=lt-1;_t<lt;at=_t++){var vt=(ue[_t][0]-ue[at][0])*(ue[at][1]+ue[_t][1]),Bt=je+vt;$e+=Math.abs(je)>=Math.abs(vt)?je-Bt+vt:vt-Bt+je,je=Bt}je+$e>=0!=!!ye&&ue.reverse()}return W=1,Y=function ue(ye,je){var $e,_t=ye&&ye.type;if(_t==="FeatureCollection")for($e=0;$e<ye.features.length;$e++)ue(ye.features[$e],je);else if(_t==="GeometryCollection")for($e=0;$e<ye.geometries.length;$e++)ue(ye.geometries[$e],je);else if(_t==="Feature")ue(ye.geometry,je);else if(_t==="Polygon")st(ye.coordinates,je);else if(_t==="MultiPolygon")for($e=0;$e<ye.coordinates.length;$e++)st(ye.coordinates[$e],je);return ye}})(),ge=_.d1(de);const ve={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:st=>st},ie=Math.fround||(Me=new Float32Array(1),st=>(Me[0]=+st,Me[0]));var Me;class we{constructor(fe){this.options=Object.assign(Object.create(ve),fe),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(fe){const{log:ue,minZoom:ye,maxZoom:je}=this.options;ue&&console.time("total time");const $e=`prepare ${fe.length} points`;ue&&console.time($e),this.points=fe;const _t=[];for(let at=0;at<fe.length;at++){const vt=fe[at];if(!vt.geometry)continue;const[Bt,Ht]=vt.geometry.coordinates,Tr=ie(pe(Bt)),hr=ie(Je(Ht));_t.push(Tr,hr,1/0,at,-1,1),this.options.reduce&&_t.push(0)}let lt=this.trees[je+1]=this._createTree(_t);ue&&console.timeEnd($e);for(let at=je;at>=ye;at--){const vt=+Date.now();lt=this.trees[at]=this._createTree(this._cluster(lt,at)),ue&&console.log("z%d: %d clusters in %dms",at,lt.numItems,+Date.now()-vt)}return ue&&console.timeEnd("total time"),this}getClusters(fe,ue){let ye=((fe[0]+180)%360+360)%360-180;const je=Math.max(-90,Math.min(90,fe[1]));let $e=fe[2]===180?180:((fe[2]+180)%360+360)%360-180;const _t=Math.max(-90,Math.min(90,fe[3]));if(fe[2]-fe[0]>=360)ye=-180,$e=180;else if(ye>$e){const Ht=this.getClusters([ye,je,180,_t],ue),Tr=this.getClusters([-180,je,$e,_t],ue);return Ht.concat(Tr)}const lt=this.trees[this._limitZoom(ue)],at=lt.range(pe(ye),Je(_t),pe($e),Je(je)),vt=lt.data,Bt=[];for(const Ht of at){const Tr=this.stride*Ht;Bt.push(vt[Tr+5]>1?Ge(vt,Tr,this.clusterProps):this.points[vt[Tr+3]])}return Bt}getChildren(fe){const ue=this._getOriginId(fe),ye=this._getOriginZoom(fe),je="No cluster with the specified id.",$e=this.trees[ye];if(!$e)throw new Error(je);const _t=$e.data;if(ue*this.stride>=_t.length)throw new Error(je);const lt=this.options.radius/(this.options.extent*Math.pow(2,ye-1)),at=$e.within(_t[ue*this.stride],_t[ue*this.stride+1],lt),vt=[];for(const Bt of at){const Ht=Bt*this.stride;_t[Ht+4]===fe&&vt.push(_t[Ht+5]>1?Ge(_t,Ht,this.clusterProps):this.points[_t[Ht+3]])}if(vt.length===0)throw new Error(je);return vt}getLeaves(fe,ue,ye){const je=[];return this._appendLeaves(je,fe,ue=ue||10,ye=ye||0,0),je}getTile(fe,ue,ye){const je=this.trees[this._limitZoom(fe)],$e=Math.pow(2,fe),{extent:_t,radius:lt}=this.options,at=lt/_t,vt=(ye-at)/$e,Bt=(ye+1+at)/$e,Ht={features:[]};return this._addTileFeatures(je.range((ue-at)/$e,vt,(ue+1+at)/$e,Bt),je.data,ue,ye,$e,Ht),ue===0&&this._addTileFeatures(je.range(1-at/$e,vt,1,Bt),je.data,$e,ye,$e,Ht),ue===$e-1&&this._addTileFeatures(je.range(0,vt,at/$e,Bt),je.data,-1,ye,$e,Ht),Ht.features.length?Ht:null}getClusterExpansionZoom(fe){let ue=this._getOriginZoom(fe)-1;for(;ue<=this.options.maxZoom;){const ye=this.getChildren(fe);if(ue++,ye.length!==1)break;fe=ye[0].properties.cluster_id}return ue}_appendLeaves(fe,ue,ye,je,$e){const _t=this.getChildren(ue);for(const lt of _t){const at=lt.properties;if(at&&at.cluster?$e+at.point_count<=je?$e+=at.point_count:$e=this._appendLeaves(fe,at.cluster_id,ye,je,$e):$e<je?$e++:fe.push(lt),fe.length===ye)break}return $e}_createTree(fe){const ue=new _.aT(fe.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ye=0;ye<fe.length;ye+=this.stride)ue.add(fe[ye],fe[ye+1]);return ue.finish(),ue.data=fe,ue}_addTileFeatures(fe,ue,ye,je,$e,_t){for(const lt of fe){const at=lt*this.stride,vt=ue[at+5]>1;let Bt,Ht,Tr;if(vt)Bt=et(ue,at,this.clusterProps),Ht=ue[at],Tr=ue[at+1];else{const xn=this.points[ue[at+3]];Bt=xn.properties;const[an,xt]=xn.geometry.coordinates;Ht=pe(an),Tr=Je(xt)}const hr={type:1,geometry:[[Math.round(this.options.extent*(Ht*$e-ye)),Math.round(this.options.extent*(Tr*$e-je))]],tags:Bt};let Gr;Gr=vt||this.options.generateId?ue[at+3]:this.points[ue[at+3]].id,Gr!==void 0&&(hr.id=Gr),_t.features.push(hr)}}_limitZoom(fe){return Math.max(this.options.minZoom,Math.min(Math.floor(+fe),this.options.maxZoom+1))}_cluster(fe,ue){const{radius:ye,extent:je,reduce:$e,minPoints:_t}=this.options,lt=ye/(je*Math.pow(2,ue)),at=fe.data,vt=[],Bt=this.stride;for(let Ht=0;Ht<at.length;Ht+=Bt){if(at[Ht+2]<=ue)continue;at[Ht+2]=ue;const Tr=at[Ht],hr=at[Ht+1],Gr=fe.within(at[Ht],at[Ht+1],lt),xn=at[Ht+5];let an=xn;for(const xt of Gr){const Ln=xt*Bt;at[Ln+2]>ue&&(an+=at[Ln+5])}if(an>xn&&an>=_t){let xt,Ln=Tr*xn,ya=hr*xn,Mr=-1;const Fn=(Ht/Bt<<5)+(ue+1)+this.points.length;for(const Ga of Gr){const Vn=Ga*Bt;if(at[Vn+2]<=ue)continue;at[Vn+2]=ue;const va=at[Vn+5];Ln+=at[Vn]*va,ya+=at[Vn+1]*va,at[Vn+4]=Fn,$e&&(xt||(xt=this._map(at,Ht,!0),Mr=this.clusterProps.length,this.clusterProps.push(xt)),$e(xt,this._map(at,Vn)))}at[Ht+4]=Fn,vt.push(Ln/an,ya/an,1/0,Fn,-1,an),$e&&vt.push(Mr)}else{for(let xt=0;xt<Bt;xt++)vt.push(at[Ht+xt]);if(an>1)for(const xt of Gr){const Ln=xt*Bt;if(!(at[Ln+2]<=ue)){at[Ln+2]=ue;for(let ya=0;ya<Bt;ya++)vt.push(at[Ln+ya])}}}}return vt}_getOriginId(fe){return fe-this.points.length>>5}_getOriginZoom(fe){return(fe-this.points.length)%32}_map(fe,ue,ye){if(fe[ue+5]>1){const _t=this.clusterProps[fe[ue+6]];return ye?Object.assign({},_t):_t}const je=this.points[fe[ue+3]].properties,$e=this.options.map(je);return ye&&$e===je?Object.assign({},$e):$e}}function Ge(st,fe,ue){return{type:"Feature",id:st[fe+3],properties:et(st,fe,ue),geometry:{type:"Point",coordinates:[(ye=st[fe],360*(ye-.5)),le(st[fe+1])]}};var ye}function et(st,fe,ue){const ye=st[fe+5],je=ye>=1e4?`${Math.round(ye/1e3)}k`:ye>=1e3?Math.round(ye/100)/10+"k":ye,$e=st[fe+6],_t=$e===-1?{}:Object.assign({},ue[$e]);return Object.assign(_t,{cluster:!0,cluster_id:st[fe+3],point_count:ye,point_count_abbreviated:je})}function pe(st){return st/360+.5}function Je(st){const fe=Math.sin(st*Math.PI/180),ue=.5-.25*Math.log((1+fe)/(1-fe))/Math.PI;return ue<0?0:ue>1?1:ue}function le(st){const fe=(180-360*st)*Math.PI/180;return 360*Math.atan(Math.exp(fe))/Math.PI-90}function ut(st,fe,ue,ye){let je=ye;const $e=fe+(ue-fe>>1);let _t,lt=ue-fe;const at=st[fe],vt=st[fe+1],Bt=st[ue],Ht=st[ue+1];for(let Tr=fe+3;Tr<ue;Tr+=3){const hr=tt(st[Tr],st[Tr+1],at,vt,Bt,Ht);if(hr>je)_t=Tr,je=hr;else if(hr===je){const Gr=Math.abs(Tr-$e);Gr<lt&&(_t=Tr,lt=Gr)}}je>ye&&(_t-fe>3&&ut(st,fe,_t,ye),st[_t+2]=je,ue-_t>3&&ut(st,_t,ue,ye))}function tt(st,fe,ue,ye,je,$e){let _t=je-ue,lt=$e-ye;if(_t!==0||lt!==0){const at=((st-ue)*_t+(fe-ye)*lt)/(_t*_t+lt*lt);at>1?(ue=je,ye=$e):at>0&&(ue+=_t*at,ye+=lt*at)}return _t=st-ue,lt=fe-ye,_t*_t+lt*lt}function We(st,fe,ue,ye){const je={id:st??null,type:fe,geometry:ue,tags:ye,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(fe==="Point"||fe==="MultiPoint"||fe==="LineString")$t(je,ue);else if(fe==="Polygon")$t(je,ue[0]);else if(fe==="MultiLineString")for(const $e of ue)$t(je,$e);else if(fe==="MultiPolygon")for(const $e of ue)$t(je,$e[0]);return je}function $t(st,fe){for(let ue=0;ue<fe.length;ue+=3)st.minX=Math.min(st.minX,fe[ue]),st.minY=Math.min(st.minY,fe[ue+1]),st.maxX=Math.max(st.maxX,fe[ue]),st.maxY=Math.max(st.maxY,fe[ue+1])}function Be(st,fe,ue,ye){if(!fe.geometry)return;const je=fe.geometry.coordinates;if(je&&je.length===0)return;const $e=fe.geometry.type,_t=Math.pow(ue.tolerance/((1<<ue.maxZoom)*ue.extent),2);let lt=[],at=fe.id;if(ue.promoteId?at=fe.properties[ue.promoteId]:ue.generateId&&(at=ye||0),$e==="Point")Mt(je,lt);else if($e==="MultiPoint")for(const vt of je)Mt(vt,lt);else if($e==="LineString")me(je,lt,_t,!1);else if($e==="MultiLineString"){if(ue.lineMetrics){for(const vt of je)lt=[],me(vt,lt,_t,!1),st.push(We(at,"LineString",lt,fe.properties));return}re(je,lt,_t,!1)}else if($e==="Polygon")re(je,lt,_t,!0);else{if($e!=="MultiPolygon"){if($e==="GeometryCollection"){for(const vt of fe.geometry.geometries)Be(st,{id:at,geometry:vt,properties:fe.properties},ue,ye);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const vt of je){const Bt=[];re(vt,Bt,_t,!0),lt.push(Bt)}}st.push(We(at,$e,lt,fe.properties))}function Mt(st,fe){fe.push(Ve(st[0]),Pe(st[1]),0)}function me(st,fe,ue,ye){let je,$e,_t=0;for(let at=0;at<st.length;at++){const vt=Ve(st[at][0]),Bt=Pe(st[at][1]);fe.push(vt,Bt,0),at>0&&(_t+=ye?(je*Bt-vt*$e)/2:Math.sqrt(Math.pow(vt-je,2)+Math.pow(Bt-$e,2))),je=vt,$e=Bt}const lt=fe.length-3;fe[2]=1,ut(fe,0,lt,ue),fe[lt+2]=1,fe.size=Math.abs(_t),fe.start=0,fe.end=fe.size}function re(st,fe,ue,ye){for(let je=0;je<st.length;je++){const $e=[];me(st[je],$e,ue,ye),fe.push($e)}}function Ve(st){return st/360+.5}function Pe(st){const fe=Math.sin(st*Math.PI/180),ue=.5-.25*Math.log((1+fe)/(1-fe))/Math.PI;return ue<0?0:ue>1?1:ue}function De(st,fe,ue,ye,je,$e,_t,lt){if(ye/=fe,$e>=(ue/=fe)&&_t<ye)return st;if(_t<ue||$e>=ye)return null;const at=[];for(const vt of st){const Bt=vt.geometry;let Ht=vt.type;const Tr=je===0?vt.minX:vt.minY,hr=je===0?vt.maxX:vt.maxY;if(Tr>=ue&&hr<ye){at.push(vt);continue}if(hr<ue||Tr>=ye)continue;let Gr=[];if(Ht==="Point"||Ht==="MultiPoint")bt(Bt,Gr,ue,ye,je);else if(Ht==="LineString")Vt(Bt,Gr,ue,ye,je,!1,lt.lineMetrics);else if(Ht==="MultiLineString")jt(Bt,Gr,ue,ye,je,!1);else if(Ht==="Polygon")jt(Bt,Gr,ue,ye,je,!0);else if(Ht==="MultiPolygon")for(const xn of Bt){const an=[];jt(xn,an,ue,ye,je,!0),an.length&&Gr.push(an)}if(Gr.length){if(lt.lineMetrics&&Ht==="LineString"){for(const xn of Gr)at.push(We(vt.id,Ht,xn,vt.tags));continue}Ht!=="LineString"&&Ht!=="MultiLineString"||(Gr.length===1?(Ht="LineString",Gr=Gr[0]):Ht="MultiLineString"),Ht!=="Point"&&Ht!=="MultiPoint"||(Ht=Gr.length===3?"Point":"MultiPoint"),at.push(We(vt.id,Ht,Gr,vt.tags))}}return at.length?at:null}function bt(st,fe,ue,ye,je){for(let $e=0;$e<st.length;$e+=3){const _t=st[$e+je];_t>=ue&&_t<=ye&&Yt(fe,st[$e],st[$e+1],st[$e+2])}}function Vt(st,fe,ue,ye,je,$e,_t){let lt=Zt(st);const at=je===0?jr:Qe;let vt,Bt,Ht=st.start;for(let an=0;an<st.length-3;an+=3){const xt=st[an],Ln=st[an+1],ya=st[an+2],Mr=st[an+3],Fn=st[an+4],Ga=je===0?xt:Ln,Vn=je===0?Mr:Fn;let va=!1;_t&&(vt=Math.sqrt(Math.pow(xt-Mr,2)+Math.pow(Ln-Fn,2))),Ga<ue?Vn>ue&&(Bt=at(lt,xt,Ln,Mr,Fn,ue),_t&&(lt.start=Ht+vt*Bt)):Ga>ye?Vn<ye&&(Bt=at(lt,xt,Ln,Mr,Fn,ye),_t&&(lt.start=Ht+vt*Bt)):Yt(lt,xt,Ln,ya),Vn<ue&&Ga>=ue&&(Bt=at(lt,xt,Ln,Mr,Fn,ue),va=!0),Vn>ye&&Ga<=ye&&(Bt=at(lt,xt,Ln,Mr,Fn,ye),va=!0),!$e&&va&&(_t&&(lt.end=Ht+vt*Bt),fe.push(lt),lt=Zt(st)),_t&&(Ht+=vt)}let Tr=st.length-3;const hr=st[Tr],Gr=st[Tr+1],xn=je===0?hr:Gr;xn>=ue&&xn<=ye&&Yt(lt,hr,Gr,st[Tr+2]),Tr=lt.length-3,$e&&Tr>=3&&(lt[Tr]!==lt[0]||lt[Tr+1]!==lt[1])&&Yt(lt,lt[0],lt[1],lt[2]),lt.length&&fe.push(lt)}function Zt(st){const fe=[];return fe.size=st.size,fe.start=st.start,fe.end=st.end,fe}function jt(st,fe,ue,ye,je,$e){for(const _t of st)Vt(_t,fe,ue,ye,je,$e,!1)}function Yt(st,fe,ue,ye){st.push(fe,ue,ye)}function jr(st,fe,ue,ye,je,$e){const _t=($e-fe)/(ye-fe);return Yt(st,$e,ue+(je-ue)*_t,1),_t}function Qe(st,fe,ue,ye,je,$e){const _t=($e-ue)/(je-ue);return Yt(st,fe+(ye-fe)*_t,$e,1),_t}function _n(st,fe){const ue=[];for(let ye=0;ye<st.length;ye++){const je=st[ye],$e=je.type;let _t;if($e==="Point"||$e==="MultiPoint"||$e==="LineString")_t=se(je.geometry,fe);else if($e==="MultiLineString"||$e==="Polygon"){_t=[];for(const lt of je.geometry)_t.push(se(lt,fe))}else if($e==="MultiPolygon"){_t=[];for(const lt of je.geometry){const at=[];for(const vt of lt)at.push(se(vt,fe));_t.push(at)}}ue.push(We(je.id,$e,_t,je.tags))}return ue}function se(st,fe){const ue=[];ue.size=st.size,st.start!==void 0&&(ue.start=st.start,ue.end=st.end);for(let ye=0;ye<st.length;ye+=3)ue.push(st[ye]+fe,st[ye+1],st[ye+2]);return ue}function Rt(st,fe){if(st.transformed)return st;const ue=1<<st.z,ye=st.x,je=st.y;for(const $e of st.features){const _t=$e.geometry,lt=$e.type;if($e.geometry=[],lt===1)for(let at=0;at<_t.length;at+=2)$e.geometry.push(yt(_t[at],_t[at+1],fe,ue,ye,je));else for(let at=0;at<_t.length;at++){const vt=[];for(let Bt=0;Bt<_t[at].length;Bt+=2)vt.push(yt(_t[at][Bt],_t[at][Bt+1],fe,ue,ye,je));$e.geometry.push(vt)}}return st.transformed=!0,st}function yt(st,fe,ue,ye,je,$e){return[Math.round(ue*(st*ye-je)),Math.round(ue*(fe*ye-$e))]}function Ee(st,fe,ue,ye,je){const $e=fe===je.maxZoom?0:je.tolerance/((1<<fe)*je.extent),_t={features:[],numPoints:0,numSimplified:0,numFeatures:st.length,source:null,x:ue,y:ye,z:fe,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const lt of st)Ne(_t,lt,$e,je);return _t}function Ne(st,fe,ue,ye){const je=fe.geometry,$e=fe.type,_t=[];if(st.minX=Math.min(st.minX,fe.minX),st.minY=Math.min(st.minY,fe.minY),st.maxX=Math.max(st.maxX,fe.maxX),st.maxY=Math.max(st.maxY,fe.maxY),$e==="Point"||$e==="MultiPoint")for(let lt=0;lt<je.length;lt+=3)_t.push(je[lt],je[lt+1]),st.numPoints++,st.numSimplified++;else if($e==="LineString")dt(_t,je,st,ue,!1,!1);else if($e==="MultiLineString"||$e==="Polygon")for(let lt=0;lt<je.length;lt++)dt(_t,je[lt],st,ue,$e==="Polygon",lt===0);else if($e==="MultiPolygon")for(let lt=0;lt<je.length;lt++){const at=je[lt];for(let vt=0;vt<at.length;vt++)dt(_t,at[vt],st,ue,!0,vt===0)}if(_t.length){let lt=fe.tags||null;if($e==="LineString"&&ye.lineMetrics){lt={};for(const vt in fe.tags)lt[vt]=fe.tags[vt];lt.mapbox_clip_start=je.start/je.size,lt.mapbox_clip_end=je.end/je.size}const at={geometry:_t,type:$e==="Polygon"||$e==="MultiPolygon"?3:$e==="LineString"||$e==="MultiLineString"?2:1,tags:lt};fe.id!==null&&(at.id=fe.id),st.features.push(at)}}function dt(st,fe,ue,ye,je,$e){const _t=ye*ye;if(ye>0&&fe.size<(je?_t:ye))return void(ue.numPoints+=fe.length/3);const lt=[];for(let at=0;at<fe.length;at+=3)(ye===0||fe[at+2]>_t)&&(ue.numSimplified++,lt.push(fe[at],fe[at+1])),ue.numPoints++;je&&(function(at,vt){let Bt=0;for(let Ht=0,Tr=at.length,hr=Tr-2;Ht<Tr;hr=Ht,Ht+=2)Bt+=(at[Ht]-at[hr])*(at[Ht+1]+at[hr+1]);if(Bt>0===vt)for(let Ht=0,Tr=at.length;Ht<Tr/2;Ht+=2){const hr=at[Ht],Gr=at[Ht+1];at[Ht]=at[Tr-2-Ht],at[Ht+1]=at[Tr-1-Ht],at[Tr-2-Ht]=hr,at[Tr-1-Ht]=Gr}})(lt,$e),st.push(lt)}const Kt={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Jt{constructor(fe,ue){const ye=(ue=this.options=(function($e,_t){for(const lt in _t)$e[lt]=_t[lt];return $e})(Object.create(Kt),ue)).debug;if(ye&&console.time("preprocess data"),ue.maxZoom<0||ue.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ue.promoteId&&ue.generateId)throw new Error("promoteId and generateId cannot be used together.");let je=(function($e,_t){const lt=[];if($e.type==="FeatureCollection")for(let at=0;at<$e.features.length;at++)Be(lt,$e.features[at],_t,at);else Be(lt,$e.type==="Feature"?$e:{geometry:$e},_t);return lt})(fe,ue);this.tiles={},this.tileCoords=[],ye&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ue.indexMaxZoom,ue.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),je=(function($e,_t){const lt=_t.buffer/_t.extent;let at=$e;const vt=De($e,1,-1-lt,lt,0,-1,2,_t),Bt=De($e,1,1-lt,2+lt,0,-1,2,_t);return(vt||Bt)&&(at=De($e,1,-lt,1+lt,0,-1,2,_t)||[],vt&&(at=_n(vt,1).concat(at)),Bt&&(at=at.concat(_n(Bt,-1)))),at})(je,ue),je.length&&this.splitTile(je,0,0,0),ye&&(je.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(fe,ue,ye,je,$e,_t,lt){const at=[fe,ue,ye,je],vt=this.options,Bt=vt.debug;for(;at.length;){je=at.pop(),ye=at.pop(),ue=at.pop(),fe=at.pop();const Ht=1<<ue,Tr=kt(ue,ye,je);let hr=this.tiles[Tr];if(!hr&&(Bt>1&&console.time("creation"),hr=this.tiles[Tr]=Ee(fe,ue,ye,je,vt),this.tileCoords.push({z:ue,x:ye,y:je}),Bt)){Bt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ue,ye,je,hr.numFeatures,hr.numPoints,hr.numSimplified),console.timeEnd("creation"));const va=`z${ue}`;this.stats[va]=(this.stats[va]||0)+1,this.total++}if(hr.source=fe,$e==null){if(ue===vt.indexMaxZoom||hr.numPoints<=vt.indexMaxPoints)continue}else{if(ue===vt.maxZoom||ue===$e)continue;if($e!=null){const va=$e-ue;if(ye!==_t>>va||je!==lt>>va)continue}}if(hr.source=null,fe.length===0)continue;Bt>1&&console.time("clipping");const Gr=.5*vt.buffer/vt.extent,xn=.5-Gr,an=.5+Gr,xt=1+Gr;let Ln=null,ya=null,Mr=null,Fn=null,Ga=De(fe,Ht,ye-Gr,ye+an,0,hr.minX,hr.maxX,vt),Vn=De(fe,Ht,ye+xn,ye+xt,0,hr.minX,hr.maxX,vt);fe=null,Ga&&(Ln=De(Ga,Ht,je-Gr,je+an,1,hr.minY,hr.maxY,vt),ya=De(Ga,Ht,je+xn,je+xt,1,hr.minY,hr.maxY,vt),Ga=null),Vn&&(Mr=De(Vn,Ht,je-Gr,je+an,1,hr.minY,hr.maxY,vt),Fn=De(Vn,Ht,je+xn,je+xt,1,hr.minY,hr.maxY,vt),Vn=null),Bt>1&&console.timeEnd("clipping"),at.push(Ln||[],ue+1,2*ye,2*je),at.push(ya||[],ue+1,2*ye,2*je+1),at.push(Mr||[],ue+1,2*ye+1,2*je),at.push(Fn||[],ue+1,2*ye+1,2*je+1)}}getTile(fe,ue,ye){fe=+fe,ue=+ue,ye=+ye;const je=this.options,{extent:$e,debug:_t}=je;if(fe<0||fe>24)return null;const lt=1<<fe,at=kt(fe,ue=ue+lt&lt-1,ye);if(this.tiles[at])return Rt(this.tiles[at],$e);_t>1&&console.log("drilling down to z%d-%d-%d",fe,ue,ye);let vt,Bt=fe,Ht=ue,Tr=ye;for(;!vt&&Bt>0;)Bt--,Ht>>=1,Tr>>=1,vt=this.tiles[kt(Bt,Ht,Tr)];return vt&&vt.source?(_t>1&&(console.log("found parent tile z%d-%d-%d",Bt,Ht,Tr),console.time("drilling down")),this.splitTile(vt.source,Bt,Ht,Tr,fe,ue,ye),_t>1&&console.timeEnd("drilling down"),this.tiles[at]?Rt(this.tiles[at],$e):null):null}}function kt(st,fe,ue){return 32*((1<<st)*ue+fe)+st}class lr extends N{constructor(fe,ue,ye,je=pr){super(fe,ue,ye),this._dataUpdateable=new Map,this._createGeoJSONIndex=je}loadVectorTile(fe,ue){return _._(this,void 0,void 0,(function*(){const ye=fe.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const je=this._geoJSONIndex.getTile(ye.z,ye.x,ye.y);return je?H(new _.d2(je.features,{version:2,extent:_.a5})):null}))}loadData(fe){return _._(this,void 0,void 0,(function*(){var ue;(ue=this._pendingRequest)===null||ue===void 0||ue.abort();const ye=this._startPerformance(fe);this._pendingRequest=new AbortController;try{(!this._pendingData||fe.request||fe.data||fe.dataDiff)&&(this._pendingData=this.loadAndProcessGeoJSON(fe,this._pendingRequest));const je=yield this._pendingData;this._geoJSONIndex=this._createGeoJSONIndex(je,fe),this.loaded={};const $e={};return fe.request&&($e.data=je),this._finishPerformance(ye,fe,$e),$e}catch(je){if(delete this._pendingRequest,_.Z(je))return{abandoned:!0};throw je}}))}_startPerformance(fe){var ue;if(!((ue=fe?.request)===null||ue===void 0)&&ue.collectResourceTiming)return new _.c_(fe.request)}_finishPerformance(fe,ue,ye){if(!fe)return;const je=fe.finish();je&&(ye.resourceTiming={},ye.resourceTiming[ue.source]=JSON.parse(JSON.stringify(je)))}getData(){return _._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(fe){const ue=this.loaded;return ue&&ue[fe.uid]?super.reloadTile(fe):this.loadTile(fe)}loadAndProcessGeoJSON(fe,ue){return _._(this,void 0,void 0,(function*(){let ye;if(fe.request?ye=yield this.loadGeoJSONFromUrl(fe.request,fe.promoteId,ue):fe.data?ye=this._loadGeoJSONFromObject(fe.data,fe.promoteId):fe.dataDiff&&(ye=this._loadGeoJSONFromDiff(fe.dataDiff,fe.promoteId,fe.source)),delete this._pendingRequest,typeof ye!="object")throw new Error(`Input data given to '${fe.source}' is not a valid GeoJSON object.`);return ge(ye,!0),fe.filter&&(ye=this._filterGeoJSON(ye,fe.filter)),ye}))}loadGeoJSONFromUrl(fe,ue,ye){return _._(this,void 0,void 0,(function*(){const je=yield _.j(fe,ye);return this._dataUpdateable=_.a7(je.data,ue),je.data}))}_loadGeoJSONFromObject(fe,ue){return this._dataUpdateable=_.a7(fe,ue),fe}_loadGeoJSONFromDiff(fe,ue,ye){if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${ye}`);_.a8(this._dataUpdateable,fe,ue);const je=Array.from(this._dataUpdateable.values());return this._toFeatureCollection(je)}_filterGeoJSON(fe,ue){const ye=_.d3(ue,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ye.result==="error")throw new Error(ye.value.map(($e=>`${$e.key}: ${$e.message}`)).join(", "));const je=fe.features.filter(($e=>ye.value.evaluate({zoom:0},$e)));return this._toFeatureCollection(je)}_toFeatureCollection(fe){return{type:"FeatureCollection",features:fe}}removeSource(fe){return _._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(fe){return this._geoJSONIndex.getClusterExpansionZoom(fe.clusterId)}getClusterChildren(fe){return this._geoJSONIndex.getChildren(fe.clusterId)}getClusterLeaves(fe){return this._geoJSONIndex.getLeaves(fe.clusterId,fe.limit,fe.offset)}}function pr(st,fe){return fe.cluster?new we((function({superclusterOptions:ue,clusterProperties:ye}){if(!ye||!ue)return ue;const je={},$e={},_t={accumulated:null,zoom:0},lt={properties:null},at=Object.keys(ye);for(const vt of at){const[Bt,Ht]=ye[vt],Tr=_.d3(Ht),hr=_.d3(typeof Bt=="string"?[Bt,["accumulated"],["get",vt]]:Bt);je[vt]=Tr.value,$e[vt]=hr.value}return ue.map=vt=>{lt.properties=vt;const Bt={};for(const Ht of at)Bt[Ht]=je[Ht].evaluate(_t,lt);return Bt},ue.reduce=(vt,Bt)=>{lt.properties=Bt;for(const Ht of at)_t.accumulated=vt[Ht],vt[Ht]=$e[Ht].evaluate(_t,lt)},ue})(fe)).load(st.features):(function(ue,ye){return new Jt(ue,ye)})(st,fe.geojsonVtOptions)}class sr{constructor(fe){this.self=fe,this.actor=new _.L(fe),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(ue,ye)=>{if(this.externalWorkerSourceTypes[ue])throw new Error(`Worker source with name "${ue}" already registered.`);this.externalWorkerSourceTypes[ue]=ye},this.self.addProtocol=_.cJ,this.self.removeProtocol=_.cK,this.self.registerRTLTextPlugin=ue=>{_.d4.setMethods(ue)},this.actor.registerMessageHandler("LDT",((ue,ye)=>this._getDEMWorkerSource(ue,ye.source).loadTile(ye))),this.actor.registerMessageHandler("RDT",((ue,ye)=>_._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(ue,ye.source).removeTile(ye)})))),this.actor.registerMessageHandler("GCEZ",((ue,ye)=>_._(this,void 0,void 0,(function*(){return this._getWorkerSource(ue,ye.type,ye.source).getClusterExpansionZoom(ye)})))),this.actor.registerMessageHandler("GCC",((ue,ye)=>_._(this,void 0,void 0,(function*(){return this._getWorkerSource(ue,ye.type,ye.source).getClusterChildren(ye)})))),this.actor.registerMessageHandler("GCL",((ue,ye)=>_._(this,void 0,void 0,(function*(){return this._getWorkerSource(ue,ye.type,ye.source).getClusterLeaves(ye)})))),this.actor.registerMessageHandler("LD",((ue,ye)=>this._getWorkerSource(ue,ye.type,ye.source).loadData(ye))),this.actor.registerMessageHandler("GD",((ue,ye)=>this._getWorkerSource(ue,ye.type,ye.source).getData())),this.actor.registerMessageHandler("LT",((ue,ye)=>this._getWorkerSource(ue,ye.type,ye.source).loadTile(ye))),this.actor.registerMessageHandler("RT",((ue,ye)=>this._getWorkerSource(ue,ye.type,ye.source).reloadTile(ye))),this.actor.registerMessageHandler("AT",((ue,ye)=>this._getWorkerSource(ue,ye.type,ye.source).abortTile(ye))),this.actor.registerMessageHandler("RMT",((ue,ye)=>this._getWorkerSource(ue,ye.type,ye.source).removeTile(ye))),this.actor.registerMessageHandler("RS",((ue,ye)=>_._(this,void 0,void 0,(function*(){if(!this.workerSources[ue]||!this.workerSources[ue][ye.type]||!this.workerSources[ue][ye.type][ye.source])return;const je=this.workerSources[ue][ye.type][ye.source];delete this.workerSources[ue][ye.type][ye.source],je.removeSource!==void 0&&je.removeSource(ye)})))),this.actor.registerMessageHandler("RM",(ue=>_._(this,void 0,void 0,(function*(){delete this.layerIndexes[ue],delete this.availableImages[ue],delete this.workerSources[ue],delete this.demWorkerSources[ue],this.globalStates.delete(ue)})))),this.actor.registerMessageHandler("SR",((ue,ye)=>_._(this,void 0,void 0,(function*(){this.referrer=ye})))),this.actor.registerMessageHandler("SRPS",((ue,ye)=>this._syncRTLPluginState(ue,ye))),this.actor.registerMessageHandler("IS",((ue,ye)=>_._(this,void 0,void 0,(function*(){this.self.importScripts(ye)})))),this.actor.registerMessageHandler("SI",((ue,ye)=>this._setImages(ue,ye))),this.actor.registerMessageHandler("UL",((ue,ye)=>_._(this,void 0,void 0,(function*(){this._getLayerIndex(ue).update(ye.layers,ye.removedIds,this._getGlobalState(ue))})))),this.actor.registerMessageHandler("UGS",((ue,ye)=>_._(this,void 0,void 0,(function*(){const je=this._getGlobalState(ue);for(const $e in ye)je[$e]=ye[$e]})))),this.actor.registerMessageHandler("SL",((ue,ye)=>_._(this,void 0,void 0,(function*(){this._getLayerIndex(ue).replace(ye,this._getGlobalState(ue))}))))}_getGlobalState(fe){let ue=this.globalStates.get(fe);return ue||(ue={},this.globalStates.set(fe,ue)),ue}_setImages(fe,ue){return _._(this,void 0,void 0,(function*(){this.availableImages[fe]=ue;for(const ye in this.workerSources[fe]){const je=this.workerSources[fe][ye];for(const $e in je)je[$e].availableImages=ue}}))}_syncRTLPluginState(fe,ue){return _._(this,void 0,void 0,(function*(){return yield _.d4.syncState(ue,this.self.importScripts)}))}_getAvailableImages(fe){let ue=this.availableImages[fe];return ue||(ue=[]),ue}_getLayerIndex(fe){let ue=this.layerIndexes[fe];return ue||(ue=this.layerIndexes[fe]=new s),ue}_getWorkerSource(fe,ue,ye){if(this.workerSources[fe]||(this.workerSources[fe]={}),this.workerSources[fe][ue]||(this.workerSources[fe][ue]={}),!this.workerSources[fe][ue][ye]){const je={sendAsync:($e,_t)=>($e.targetMapId=fe,this.actor.sendAsync($e,_t))};switch(ue){case"vector":this.workerSources[fe][ue][ye]=new N(je,this._getLayerIndex(fe),this._getAvailableImages(fe));break;case"geojson":this.workerSources[fe][ue][ye]=new lr(je,this._getLayerIndex(fe),this._getAvailableImages(fe));break;default:this.workerSources[fe][ue][ye]=new this.externalWorkerSourceTypes[ue](je,this._getLayerIndex(fe),this._getAvailableImages(fe))}}return this.workerSources[fe][ue][ye]}_getDEMWorkerSource(fe,ue){return this.demWorkerSources[fe]||(this.demWorkerSources[fe]={}),this.demWorkerSources[fe][ue]||(this.demWorkerSources[fe][ue]=new Z),this.demWorkerSources[fe][ue]}}return _.i(self)&&(self.worker=new sr(self)),sr})),p("index",["exports","./shared"],(function(_,s){var C="5.15.0";function M(){var w=new s.A(4);return s.A!=Float32Array&&(w[1]=0,w[2]=0),w[0]=1,w[3]=1,w}let D,B,U;const j={frame(w,t,o){const d=requestAnimationFrame((S=>{x(),t(S)})),{unsubscribe:x}=s.s(w.signal,"abort",(()=>{x(),cancelAnimationFrame(d),o(new s.a(w.signal.reason))}),!1)},frameAsync(w){return new Promise(((t,o)=>{this.frame(w,t,o)}))},getImageData(w,t=0){return this.getImageCanvasContext(w).getImageData(-t,-t,w.width+2*t,w.height+2*t)},getImageCanvasContext(w){const t=window.document.createElement("canvas"),o=t.getContext("2d",{willReadFrequently:!0});if(!o)throw new Error("failed to create canvas 2d context");return t.width=w.width,t.height=w.height,o.drawImage(w,0,0,w.width,w.height),o},resolveURL:w=>(D||(D=document.createElement("a")),D.href=w,D.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return U!==void 0?U:!!matchMedia&&(B==null&&(B=matchMedia("(prefers-reduced-motion: reduce)")),B.matches)},set prefersReducedMotion(w){U=w}},H=new class{constructor(){this._realTime=typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),this._frozenAt=null}getCurrentTime(){return this._frozenAt!==null?this._frozenAt:this._realTime()}setNow(w){this._frozenAt=w}restoreNow(){this._frozenAt=null}isFrozen(){return this._frozenAt!==null}};function z(){return H.getCurrentTime()}class N{static testProp(t){if(!N.docStyle)return t[0];for(let o=0;o<t.length;o++)if(t[o]in N.docStyle)return t[o];return t[0]}static create(t,o,d){const x=window.document.createElement(t);return o!==void 0&&(x.className=o),d&&d.appendChild(x),x}static createNS(t,o){return window.document.createElementNS(t,o)}static disableDrag(){N.docStyle&&N.selectProp&&(N.userSelect=N.docStyle[N.selectProp],N.docStyle[N.selectProp]="none")}static enableDrag(){N.docStyle&&N.selectProp&&(N.docStyle[N.selectProp]=N.userSelect)}static setTransform(t,o){t.style[N.transformProp]=o}static addEventListener(t,o,d,x={}){t.addEventListener(o,d,"passive"in x?x:x.capture)}static removeEventListener(t,o,d,x={}){t.removeEventListener(o,d,"passive"in x?x:x.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",N.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",N.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",N.suppressClickInternal,!0)}),0)}static getScale(t){const o=t.getBoundingClientRect();return{x:o.width/t.offsetWidth||1,y:o.height/t.offsetHeight||1,boundingClientRect:o}}static getPoint(t,o,d){const x=o.boundingClientRect;return new s.P((d.clientX-x.left)/o.x-t.clientLeft,(d.clientY-x.top)/o.y-t.clientTop)}static mousePos(t,o){const d=N.getScale(t);return N.getPoint(t,d,o)}static touchPos(t,o){const d=[],x=N.getScale(t);for(let S=0;S<o.length;S++)d.push(N.getPoint(t,x,o[S]));return d}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}static sanitize(t){const o=new DOMParser().parseFromString(t,"text/html").body||document.createElement("body"),d=o.querySelectorAll("script");for(const x of d)x.remove();return N.clean(o),o.innerHTML}static isPossiblyDangerous(t,o){const d=o.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(t)||!d.includes("javascript:")&&!d.includes("data:"))||!!t.startsWith("on")||void 0}static clean(t){const o=t.children;for(const d of o)N.removeAttributes(d),N.clean(d)}static removeAttributes(t){for(const{name:o,value:d}of t.attributes)N.isPossiblyDangerous(o,d)&&t.removeAttribute(o)}}N.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,N.selectProp=N.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),N.transformProp=N.testProp(["transform","WebkitTransform"]);const Z={supported:!1,testSupport:function(w){!de&&W&&(ge?ve(w):Y=w)}};let Y,W,de=!1,ge=!1;function ve(w){const t=w.createTexture();w.bindTexture(w.TEXTURE_2D,t);try{if(w.texImage2D(w.TEXTURE_2D,0,w.RGBA,w.RGBA,w.UNSIGNED_BYTE,W),w.isContextLost())return;Z.supported=!0}catch{}w.deleteTexture(t),de=!0}var ie;typeof document<"u"&&(W=document.createElement("img"),W.onload=()=>{Y&&ve(Y),Y=null,ge=!0},W.onerror=()=>{de=!0,Y=null},W.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(w){let t,o,d,x;w.resetRequestQueue=()=>{t=[],o=0,d=0,x={}},w.addThrottleControl=F=>{const V=d++;return x[V]=F,V},w.removeThrottleControl=F=>{delete x[F],A()},w.getImage=(F,V,q=!0)=>new Promise(((te,Q)=>{Z.supported&&(F.headers||(F.headers={}),F.headers.accept="image/webp,*/*"),s.e(F,{type:"image"}),t.push({abortController:V,requestParameters:F,supportImageRefresh:q,state:"queued",onError:ce=>{Q(ce)},onSuccess:ce=>{te(ce)}}),A()}));const S=F=>s._(this,void 0,void 0,(function*(){F.state="running";const{requestParameters:V,supportImageRefresh:q,onError:te,onSuccess:Q,abortController:ce}=F,_e=q===!1&&!s.i(self)&&!s.g(V.url)&&(!V.headers||Object.keys(V.headers).reduce(((Le,qe)=>Le&&qe==="accept"),!0));o++;const Ie=_e?R(V,ce):s.m(V,ce);try{const Le=yield Ie;delete F.abortController,F.state="completed",Le.data instanceof HTMLImageElement||s.b(Le.data)?Q(Le):Le.data&&Q({data:yield(Oe=Le.data,typeof createImageBitmap=="function"?s.f(Oe):s.h(Oe)),cacheControl:Le.cacheControl,expires:Le.expires})}catch(Le){delete F.abortController,te(Le)}finally{o--,A()}var Oe})),A=()=>{const F=(()=>{for(const V of Object.keys(x))if(x[V]())return!0;return!1})()?s.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:s.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let V=o;V<F&&t.length>0;V++){const q=t.shift();q.abortController.signal.aborted?V--:S(q)}},R=(F,V)=>new Promise(((q,te)=>{const Q=new Image,ce=F.url,_e=F.credentials;_e&&_e==="include"?Q.crossOrigin="use-credentials":(_e&&_e==="same-origin"||!s.d(ce))&&(Q.crossOrigin="anonymous"),V.signal.addEventListener("abort",(()=>{Q.src="",te(new s.a(V.signal.reason))})),Q.fetchPriority="high",Q.onload=()=>{Q.onerror=Q.onload=null,q({data:Q})},Q.onerror=()=>{Q.onerror=Q.onload=null,V.signal.aborted||te(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},Q.src=ce}))})(ie||(ie={})),ie.resetRequestQueue();class Me{constructor(t){this._transformRequestFn=t??null}transformRequest(t,o){return this._transformRequestFn&&this._transformRequestFn(t,o)||{url:t}}setTransformRequest(t){this._transformRequestFn=t}}function we(w){const t=[];if(typeof w=="string")t.push({id:"default",url:w});else if(w&&w.length>0){const o=[];for(const{id:d,url:x}of w){const S=`${d}${x}`;o.indexOf(S)===-1&&(o.push(S),t.push({id:d,url:x}))}}return t}function Ge(w,t,o){try{const d=new URL(w);return d.pathname+=`${t}${o}`,d.toString()}catch{throw new Error(`Invalid sprite URL "${w}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function et(w){const{userImage:t}=w;return!!(t&&t.render&&t.render())&&(w.data.replace(new Uint8Array(t.data.buffer)),!0)}class pe extends s.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.R({width:1,height:1}),this.dirty=!0}destroy(){this.atlasTexture&&(this.atlasTexture.destroy(),this.atlasTexture=null);for(const t of Object.keys(this.images))this.removeImage(t);this.patterns={},this.atlasImage=new s.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:o,promiseResolve:d}of this.requestors)d(this._getImagesForIds(o));this.requestors=[]}}getImage(t){const o=this.images[t];if(o&&!o.data&&o.spriteData){const d=o.spriteData;o.data=new s.R({width:d.width,height:d.height},d.context.getImageData(d.x,d.y,d.width,d.height).data),o.spriteData=null}return o}addImage(t,o){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,o)&&(this.images[t]=o)}_validate(t,o){let d=!0;const x=o.data||o.spriteData;return this._validateStretch(o.stretchX,x&&x.width)||(this.fire(new s.k(new Error(`Image "${t}" has invalid "stretchX" value`))),d=!1),this._validateStretch(o.stretchY,x&&x.height)||(this.fire(new s.k(new Error(`Image "${t}" has invalid "stretchY" value`))),d=!1),this._validateContent(o.content,o)||(this.fire(new s.k(new Error(`Image "${t}" has invalid "content" value`))),d=!1),d}_validateStretch(t,o){if(!t)return!0;let d=0;for(const x of t){if(x[0]<d||x[1]<x[0]||o<x[1])return!1;d=x[1]}return!0}_validateContent(t,o){if(!t)return!0;if(t.length!==4)return!1;const d=o.spriteData,x=d&&d.width||o.data.width,S=d&&d.height||o.data.height;return!(t[0]<0||x<t[0]||t[1]<0||S<t[1]||t[2]<0||x<t[2]||t[3]<0||S<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,o,d=!0){const x=this.getImage(t);if(d&&(x.data.width!==o.data.width||x.data.height!==o.data.height))throw new Error(`size mismatch between old image (${x.data.width}x${x.data.height}) and new image (${o.data.width}x${o.data.height}).`);o.version=x.version+1,this.images[t]=o,this.updatedImages[t]=!0}removeImage(t){const o=this.images[t];delete this.images[t],delete this.patterns[t],o.userImage&&o.userImage.onRemove&&o.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t){return new Promise(((o,d)=>{let x=!0;if(!this.isLoaded())for(const S of t)this.images[S]||(x=!1);this.isLoaded()||x?o(this._getImagesForIds(t)):this.requestors.push({ids:t,promiseResolve:o})}))}_getImagesForIds(t){const o={};for(const d of t){let x=this.getImage(d);x||(this.fire(new s.l("styleimagemissing",{id:d})),x=this.getImage(d)),x?o[d]={data:x.data.clone(),pixelRatio:x.pixelRatio,sdf:x.sdf,version:x.version,stretchX:x.stretchX,stretchY:x.stretchY,content:x.content,textFitWidth:x.textFitWidth,textFitHeight:x.textFitHeight,hasRenderCallback:!!(x.userImage&&x.userImage.render)}:s.w(`Image "${d}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return o}getPixelSize(){const{width:t,height:o}=this.atlasImage;return{width:t,height:o}}getPattern(t){const o=this.patterns[t],d=this.getImage(t);if(!d)return null;if(o&&o.position.version===d.version)return o.position;if(o)o.position.version=d.version;else{const x={w:d.data.width+2,h:d.data.height+2,x:0,y:0},S=new s.I(x,d);this.patterns[t]={bin:x,position:S}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const o=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.T(t,this.atlasImage,o.RGBA),this.atlasTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const S in this.patterns)t.push(this.patterns[S].bin);const{w:o,h:d}=s.p(t),x=this.atlasImage;x.resize({width:o||1,height:d||1});for(const S in this.patterns){const{bin:A}=this.patterns[S],R=A.x+1,F=A.y+1,V=this.getImage(S).data,q=V.width,te=V.height;s.R.copy(V,x,{x:0,y:0},{x:R,y:F},{width:q,height:te}),s.R.copy(V,x,{x:0,y:te-1},{x:R,y:F-1},{width:q,height:1}),s.R.copy(V,x,{x:0,y:0},{x:R,y:F+te},{width:q,height:1}),s.R.copy(V,x,{x:q-1,y:0},{x:R-1,y:F},{width:1,height:te}),s.R.copy(V,x,{x:0,y:0},{x:R+q,y:F},{width:1,height:te})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const o of t){if(this.callbackDispatchedThisFrame[o])continue;this.callbackDispatchedThisFrame[o]=!0;const d=this.getImage(o);d||s.w(`Image with ID: "${o}" was not found`),et(d)&&this.updateImage(o,d)}}cloneImages(){const t={};for(const o in this.images){const d=this.images[o];t[o]=Object.assign(Object.assign({},d),{data:d.data?d.data.clone():null})}return t}}const Je=1e20;function le(w,t,o,d,x,S,A,R,F){for(let V=t;V<t+d;V++)ut(w,o*S+V,S,x,A,R,F);for(let V=o;V<o+x;V++)ut(w,V*S+t,1,d,A,R,F)}function ut(w,t,o,d,x,S,A){S[0]=0,A[0]=-Je,A[1]=Je,x[0]=w[t];for(let R=1,F=0,V=0;R<d;R++){x[R]=w[t+R*o];const q=R*R;do{const te=S[F];V=(x[R]-x[te]+q-te*te)/(R-te)/2}while(V<=A[F]&&--F>-1);F++,S[F]=R,A[F]=V,A[F+1]=Je}for(let R=0,F=0;R<d;R++){for(;A[F+1]<R;)F++;const V=S[F],q=R-V;w[t+R*o]=x[V]+q*q}}const tt=s.v.layout_symbol["text-font"].default.join(",");class We{constructor(t,o,d){this.requestManager=t,this.localIdeographFontFamily=o,this.entries={},this.lang=d}setURL(t){this.url=t}getGlyphs(t){return s._(this,void 0,void 0,(function*(){const o=[];for(const S in t)for(const A of t[S])o.push(this._getAndCacheGlyphsPromise(S,A));const d=yield Promise.all(o),x={};for(const{stack:S,id:A,glyph:R}of d)x[S]||(x[S]={}),x[S][A]=R&&{id:R.id,bitmap:R.bitmap.clone(),metrics:R.metrics};return x}))}_getAndCacheGlyphsPromise(t,o){return s._(this,void 0,void 0,(function*(){let d=this.entries[t];d||(d=this.entries[t]={glyphs:{},requests:{},ranges:{}});let x=d.glyphs[o];return x!==void 0?{stack:t,id:o,glyph:x}:!this.url||this._charUsesLocalIdeographFontFamily(o)?(x=d.glyphs[o]=this._drawGlyph(d,t,o),{stack:t,id:o,glyph:x}):yield this._downloadAndCacheRangePromise(t,o)}))}_downloadAndCacheRangePromise(t,o){return s._(this,void 0,void 0,(function*(){const d=this.entries[t],x=Math.floor(o/256);if(d.ranges[x])return{stack:t,id:o,glyph:null};if(!d.requests[x]){const S=We.loadGlyphRange(t,x,this.url,this.requestManager);d.requests[x]=S}try{const S=yield d.requests[x];for(const A in S)d.glyphs[+A]=S[+A];return d.ranges[x]=!0,{stack:t,id:o,glyph:S[o]||null}}catch(S){const A=d.glyphs[o]=this._drawGlyph(d,t,o);return this._warnOnMissingGlyphRange(A,x,o,S),{stack:t,id:o,glyph:A}}}))}_warnOnMissingGlyphRange(t,o,d,x){const S=256*o,A=S+255,R=d.toString(16).padStart(4,"0").toUpperCase();s.w(`Unable to load glyph range ${o}, ${S}-${A}. Rendering codepoint U+${R} locally instead. ${x}`)}_charUsesLocalIdeographFontFamily(t){return!!this.localIdeographFontFamily&&s.q(t)}_drawGlyph(t,o,d){const x=o===tt&&this.localIdeographFontFamily!==""&&this._charUsesLocalIdeographFontFamily(d),S=x?"ideographTinySDF":"tinySDF";t[S]||(t[S]=this._createTinySDF(x?this.localIdeographFontFamily:o));const A=t[S].draw(String.fromCodePoint(d));return{id:d,bitmap:new s.r({width:A.width||60,height:A.height||60},A.data),metrics:{width:A.glyphWidth/2||24,height:A.glyphHeight/2||24,left:A.glyphLeft/2+.5||0,top:A.glyphTop/2-27.5||-8,advance:A.glyphAdvance/2||24,isDoubleResolution:!0}}}_createTinySDF(t){const o=t?t.split(","):[];o.push("sans-serif");const d=o.map((x=>/[-\w]+/.test(x)?x:`'${CSS.escape(x)}'`)).join(",");return new We.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:d,fontWeight:this._fontWeight(o[0]),fontStyle:this._fontStyle(o[0]),lang:this.lang})}_fontStyle(t){return/italic/i.test(t)?"italic":/oblique/i.test(t)?"oblique":"normal"}_fontWeight(t){const o={thin:100,hairline:100,"extra light":200,"ultra light":200,light:300,normal:400,regular:400,medium:500,semibold:600,demibold:600,bold:700,"extra bold":800,"ultra bold":800,black:900,heavy:900,"extra black":950,"ultra black":950};let d;for(const[x,S]of Object.entries(o))new RegExp(`\\b${x}\\b`,"i").test(t)&&(d=`${S}`);return d}destroy(){for(const t in this.entries){const o=this.entries[t];o.tinySDF&&(o.tinySDF=null),o.ideographTinySDF&&(o.ideographTinySDF=null),o.glyphs={},o.requests={},o.ranges={}}this.entries={}}}We.loadGlyphRange=function(w,t,o,d){return s._(this,void 0,void 0,(function*(){const x=256*t,S=x+255,A=d.transformRequest(o.replace("{fontstack}",w).replace("{range}",`${x}-${S}`),"Glyphs"),R=yield s.n(A,new AbortController);if(!R||!R.data)throw new Error(`Could not load glyph range. range: ${t}, ${x}-${S}`);const F={};for(const V of s.o(R.data))F[V.id]=V;return F}))},We.TinySDF=class{constructor({fontSize:w=24,buffer:t=3,radius:o=8,cutoff:d=.25,fontFamily:x="sans-serif",fontWeight:S="normal",fontStyle:A="normal",lang:R=null}={}){this.buffer=t,this.cutoff=d,this.radius=o,this.lang=R;const F=this.size=w+4*t,V=this._createCanvas(F),q=this.ctx=V.getContext("2d",{willReadFrequently:!0});q.font=`${A} ${S} ${w}px ${x}`,q.textBaseline="alphabetic",q.textAlign="left",q.fillStyle="black",this.gridOuter=new Float64Array(F*F),this.gridInner=new Float64Array(F*F),this.f=new Float64Array(F),this.z=new Float64Array(F+1),this.v=new Uint16Array(F)}_createCanvas(w){const t=document.createElement("canvas");return t.width=t.height=w,t}draw(w){const{width:t,actualBoundingBoxAscent:o,actualBoundingBoxDescent:d,actualBoundingBoxLeft:x,actualBoundingBoxRight:S}=this.ctx.measureText(w),A=Math.ceil(o),R=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(S-x))),F=Math.min(this.size-this.buffer,A+Math.ceil(d)),V=R+2*this.buffer,q=F+2*this.buffer,te=Math.max(V*q,0),Q=new Uint8ClampedArray(te),ce={data:Q,width:V,height:q,glyphWidth:R,glyphHeight:F,glyphTop:A,glyphLeft:0,glyphAdvance:t};if(R===0||F===0)return ce;const{ctx:_e,buffer:Ie,gridInner:Oe,gridOuter:Le}=this;this.lang&&(_e.lang=this.lang),_e.clearRect(Ie,Ie,R,F),_e.fillText(w,Ie,Ie+A);const qe=_e.getImageData(Ie,Ie,R,F);Le.fill(Je,0,te),Oe.fill(0,0,te);for(let nt=0;nt<F;nt++)for(let He=0;He<R;He++){const rt=qe.data[4*(nt*R+He)+3]/255;if(rt===0)continue;const ot=(nt+Ie)*V+He+Ie;if(rt===1)Le[ot]=0,Oe[ot]=Je;else{const Xe=.5-rt;Le[ot]=Xe>0?Xe*Xe:0,Oe[ot]=Xe<0?Xe*Xe:0}}le(Le,0,0,V,q,V,this.f,this.v,this.z),le(Oe,Ie,Ie,R,F,V,this.f,this.v,this.z);for(let nt=0;nt<te;nt++){const He=Math.sqrt(Le[nt])-Math.sqrt(Oe[nt]);Q[nt]=Math.round(255-255*(He/this.radius+this.cutoff))}return ce}};class $t{constructor(){this.specification=s.u.light.position}possiblyEvaluate(t,o){return s.F(t.expression.evaluate(o))}interpolate(t,o,d){return{x:s.G.number(t.x,o.x,d),y:s.G.number(t.y,o.y,d),z:s.G.number(t.z,o.z,d)}}}let Be;class Mt extends s.E{constructor(t){super(),Be=Be||new s.t({anchor:new s.D(s.u.light.anchor),position:new $t,color:new s.D(s.u.light.color),intensity:new s.D(s.u.light.intensity)}),this._transitionable=new s.x(Be,void 0),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,o={}){if(!this._validate(s.y,t,o))for(const d in t){const x=t[d];d.endsWith(s.z)?this._transitionable.setTransition(d.slice(0,-s.z.length),x):this._transitionable.setValue(d,x)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,o,d){return(!d||d.validate!==!1)&&s.B(this,t.call(s.C,{value:o,style:{glyphs:!0,sprite:!0},styleSpec:s.u}))}}const me=new s.t({"sky-color":new s.D(s.u.sky["sky-color"]),"horizon-color":new s.D(s.u.sky["horizon-color"]),"fog-color":new s.D(s.u.sky["fog-color"]),"fog-ground-blend":new s.D(s.u.sky["fog-ground-blend"]),"horizon-fog-blend":new s.D(s.u.sky["horizon-fog-blend"]),"sky-horizon-blend":new s.D(s.u.sky["sky-horizon-blend"]),"atmosphere-blend":new s.D(s.u.sky["atmosphere-blend"])});class re extends s.E{constructor(t){super(),this._transitionable=new s.x(me,void 0),this.setSky(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new s.H(0))}setSky(t,o={}){if(!this._validate(s.J,t,o)){t||(t={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const d in t){const x=t[d];d.endsWith(s.z)?this._transitionable.setTransition(d.slice(0,-s.z.length),x):this._transitionable.setValue(d,x)}}}getSky(){return this._transitionable.serialize()}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,o,d={}){return d?.validate!==!1&&s.B(this,t.call(s.C,s.e({value:o,style:{glyphs:!0,sprite:!0},styleSpec:s.u})))}calculateFogBlendOpacity(t){return t<60?0:t<70?(t-60)/10:1}}class Ve{constructor(t,o){this.width=t,this.height=o,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,o){const d=t.join(",")+String(o);return this.dashEntry[d]||(this.dashEntry[d]=this.addDash(t,o)),this.dashEntry[d]}getDashRanges(t,o,d){const x=[];let S=t.length%2==1?-t[t.length-1]*d:0,A=t[0]*d,R=!0;x.push({left:S,right:A,isDash:R,zeroLength:t[0]===0});let F=t[0];for(let V=1;V<t.length;V++){R=!R;const q=t[V];S=F*d,F+=q,A=F*d,x.push({left:S,right:A,isDash:R,zeroLength:q===0})}return x}addRoundDash(t,o,d){const x=o/2;for(let S=-d;S<=d;S++){const A=this.width*(this.nextRow+d+S);let R=0,F=t[R];for(let V=0;V<this.width;V++){V/F.right>1&&(F=t[++R]);const q=Math.abs(V-F.left),te=Math.abs(V-F.right),Q=Math.min(q,te);let ce;const _e=S/d*(x+1);if(F.isDash){const Ie=x-Math.abs(_e);ce=Math.sqrt(Q*Q+Ie*Ie)}else ce=x-Math.sqrt(Q*Q+_e*_e);this.data[A+V]=Math.max(0,Math.min(255,ce+128))}}}addRegularDash(t){for(let R=t.length-1;R>=0;--R){const F=t[R],V=t[R+1];F.zeroLength?t.splice(R,1):V&&V.isDash===F.isDash&&(V.left=F.left,t.splice(R,1))}const o=t[0],d=t[t.length-1];o.isDash===d.isDash&&(o.left=d.left-this.width,d.right=o.right+this.width);const x=this.width*this.nextRow;let S=0,A=t[S];for(let R=0;R<this.width;R++){R/A.right>1&&(A=t[++S]);const F=Math.abs(R-A.left),V=Math.abs(R-A.right),q=Math.min(F,V);this.data[x+R]=Math.max(0,Math.min(255,(A.isDash?q:-q)+128))}}addDash(t,o){const d=o?7:0,x=2*d+1;if(this.nextRow+x>this.height)return s.w("LineAtlas out of space"),null;let S=0;for(let R=0;R<t.length;R++)S+=t[R];if(S!==0){const R=this.width/S,F=this.getDashRanges(t,this.width,R);o?this.addRoundDash(F,R,d):this.addRegularDash(F)}const A={y:this.nextRow+d,height:2*d,width:S};return this.nextRow+=x,this.dirty=!0,A}bind(t){const o=t.gl;this.texture?(o.bindTexture(o.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,o.texSubImage2D(o.TEXTURE_2D,0,0,0,this.width,this.height,o.ALPHA,o.UNSIGNED_BYTE,this.data))):(this.texture=o.createTexture(),o.bindTexture(o.TEXTURE_2D,this.texture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_2D,0,o.ALPHA,this.width,this.height,0,o.ALPHA,o.UNSIGNED_BYTE,this.data))}}const Pe="maplibre_preloaded_worker_pool";class De{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<De.workerCount;)this.workers.push(new Worker(s.c.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach((o=>{o.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[Pe]}numActive(){return Object.keys(this.active).length}}const bt=Math.floor(j.hardwareConcurrency/2);let Vt,Zt;function jt(){return Vt||(Vt=new De),Vt}De.workerCount=s.K(globalThis)?Math.max(Math.min(bt,3),1):1;class Yt{constructor(t,o){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=o;const d=this.workerPool.acquire(o);for(let x=0;x<d.length;x++){const S=new s.L(d[x],o);S.name=`Worker ${x}`,this.actors.push(S)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,o){const d=[];for(const x of this.actors)d.push(x.sendAsync({type:t,data:o}));return Promise.all(d)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach((o=>{o.remove()})),this.actors=[],t&&this.workerPool.release(this.id)}registerMessageHandler(t,o){for(const d of this.actors)d.registerMessageHandler(t,o)}unregisterMessageHandler(t){for(const o of this.actors)o.unregisterMessageHandler(t)}}function jr(){return Zt||(Zt=new Yt(jt(),s.M),Zt.registerMessageHandler("GR",((w,t,o)=>s.m(t,o)))),Zt}function Qe(w,t){const o=s.N();return s.O(o,o,[1,1,0]),s.Q(o,o,[.5*w.width,.5*w.height,1]),w.calculatePosMatrix?s.S(o,o,w.calculatePosMatrix(t.toUnwrapped())):o}function _n(w,t,o,d,x,S,A){var R;const F=(function(Q,ce,_e){if(Q)for(const Ie of Q){const Oe=ce[Ie];if(Oe&&Oe.source===_e&&Oe.type==="fill-extrusion")return!0}else for(const Ie in ce){const Oe=ce[Ie];if(Oe.source===_e&&Oe.type==="fill-extrusion")return!0}return!1})((R=x?.layers)!==null&&R!==void 0?R:null,t,w.id),V=S.maxPitchScaleFactor(),q=w.tilesIn(d,V,F);q.sort(se);const te=[];for(const Q of q)te.push({wrappedTileID:Q.tileID.wrapped().key,queryResults:Q.tile.queryRenderedFeatures(t,o,w.getState(),Q.queryGeometry,Q.cameraQueryGeometry,Q.scale,x,S,V,Qe(S,Q.tileID),A?(ce,_e)=>A(Q.tileID,ce,_e):void 0)});return(function(Q,ce){for(const _e in Q)for(const Ie of Q[_e])Rt(Ie,ce);return Q})((function(Q){const ce={},_e={};for(const Ie of Q){const Oe=Ie.queryResults,Le=Ie.wrappedTileID,qe=_e[Le]=_e[Le]||{};for(const nt in Oe){const He=Oe[nt],rt=qe[nt]=qe[nt]||{},ot=ce[nt]=ce[nt]||[];for(const Xe of He)rt[Xe.featureIndex]||(rt[Xe.featureIndex]=!0,ot.push(Xe))}}return ce})(te),w)}function se(w,t){const o=w.tileID,d=t.tileID;return o.overscaledZ-d.overscaledZ||o.canonical.y-d.canonical.y||o.wrap-d.wrap||o.canonical.x-d.canonical.x}function Rt(w,t){const o=w.feature,d=t.getFeatureState(o.layer["source-layer"],o.id);o.source=o.layer.source,o.layer["source-layer"]&&(o.sourceLayer=o.layer["source-layer"]),o.state=d}function yt(w,t,o){return s._(this,void 0,void 0,(function*(){let d=w;if(w.url?d=(yield s.j(t.transformRequest(w.url,"Source"),o)).data:yield j.frameAsync(o),!d)return null;const x=s.U(s.e(d,w),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in d&&d.vector_layers&&(x.vectorLayerIds=d.vector_layers.map((S=>S.id))),x}))}class Ee{constructor(t,o){t&&(o?this.setSouthWest(t).setNorthEast(o):Array.isArray(t)&&(t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof s.V?new s.V(t.lng,t.lat):s.V.convert(t),this}setSouthWest(t){return this._sw=t instanceof s.V?new s.V(t.lng,t.lat):s.V.convert(t),this}extend(t){const o=this._sw,d=this._ne;let x,S;if(t instanceof s.V)x=t,S=t;else{if(!(t instanceof Ee))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Ee.convert(t)):this.extend(s.V.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(s.V.convert(t)):this;if(x=t._sw,S=t._ne,!x||!S)return this}return o||d?(o.lng=Math.min(x.lng,o.lng),o.lat=Math.min(x.lat,o.lat),d.lng=Math.max(S.lng,d.lng),d.lat=Math.max(S.lat,d.lat)):(this._sw=new s.V(x.lng,x.lat),this._ne=new s.V(S.lng,S.lat)),this}getCenter(){return new s.V((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new s.V(this.getWest(),this.getNorth())}getSouthEast(){return new s.V(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:o,lat:d}=s.V.convert(t);let x=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(x=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=d&&d<=this._ne.lat&&x}intersects(t){if(!((t=Ee.convert(t)).getNorth()>=this.getSouth()&&t.getSouth()<=this.getNorth()))return!1;const o=Math.abs(this.getEast()-this.getWest()),d=Math.abs(t.getEast()-t.getWest());if(o>=360||d>=360)return!0;const x=s.W(this.getWest(),-180,180),S=s.W(this.getEast(),-180,180),A=s.W(t.getWest(),-180,180),R=s.W(t.getEast(),-180,180),F=x>=S,V=A>=R;return!(!F||!V)||(F?R>=x||A<=S:V?S>=A||x<=R:A<=S&&R>=x)}static convert(t){return t instanceof Ee?t:t&&new Ee(t)}static fromLngLat(t,o=0){const d=360*o/40075017,x=d/Math.cos(Math.PI/180*t.lat);return new Ee(new s.V(t.lng-x,t.lat-d),new s.V(t.lng+x,t.lat+d))}adjustAntiMeridian(){const t=new s.V(this._sw.lng,this._sw.lat),o=new s.V(this._ne.lng,this._ne.lat);return new Ee(t,t.lng>o.lng?new s.V(o.lng+360,o.lat):o)}}class Ne{constructor(t,o,d){this.bounds=Ee.convert(this.validateBounds(t)),this.minzoom=o||0,this.maxzoom=d||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const o=Math.pow(2,t.z),d=Math.floor(s.Y(this.bounds.getWest())*o),x=Math.floor(s.X(this.bounds.getNorth())*o),S=Math.ceil(s.Y(this.bounds.getEast())*o),A=Math.ceil(s.X(this.bounds.getSouth())*o);return t.x>=d&&t.x<S&&t.y>=x&&t.y<A}}class dt extends s.E{constructor(t,o,d,x){if(super(),this.id=t,this.dispatcher=d,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.e(this,s.U(o,["url","scheme","tileSize","promoteId","encoding"])),this._options=s.e({type:"vector"},o),this._collectResourceTiming=o.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(x)}load(){return s._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield yt(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.tileManagers[this.id].clearTiles(),t&&(s.e(this,t),t.bounds&&(this.tileBounds=new Ne(t.bounds,this.minzoom,this.maxzoom)),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.l("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this._loaded=!0,s.Z(t)||this.fire(new s.k(t))}}))}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.abort(),t(),this.load()}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return s.e({},this._options)}loadTile(t){return s._(this,void 0,void 0,(function*(){const o=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d={request:this.map._requestManager.transformRequest(o,"Tile"),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,encoding:this.encoding,overzoomParameters:this._getOverzoomParameters(t)};d.request.collectResourceTiming=this._collectResourceTiming;let x="RT";if(t.actor&&t.state!=="expired"){if(t.state==="loading")return new Promise(((S,A)=>{t.reloadPromise={resolve:S,reject:A}}))}else t.actor=this.dispatcher.getActor(),x="LT";t.abortController=new AbortController;try{const S=yield t.actor.sendAsync({type:x,data:d},t.abortController);if(delete t.abortController,t.aborted)return;this._afterTileLoadWorkerResponse(t,S)}catch(S){if(delete t.abortController,t.aborted)return;if(S&&S.status!==404)throw S;this._afterTileLoadWorkerResponse(t,null)}}))}_getOverzoomParameters(t){if(t.tileID.canonical.z<=this.maxzoom||this.map._zoomLevelsToOverscale===void 0)return;const o=t.tileID.scaledTo(this.maxzoom).canonical,d=o.url(this.tiles,this.map.getPixelRatio(),this.scheme);return{maxZoomTileID:o,overzoomRequest:this.map._requestManager.transformRequest(d,"Tile")}}_afterTileLoadWorkerResponse(t,o){if(o&&o.resourceTiming&&(t.resourceTiming=o.resourceTiming),o&&this.map._refreshExpiredTiles&&t.setExpiryData(o),t.loadVectorData(o,this.map.painter),t.reloadPromise){const d=t.reloadPromise;t.reloadPromise=null,this.loadTile(t).then(d.resolve).catch(d.reject)}}abortTile(t){return s._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.actor&&(yield t.actor.sendAsync({type:"AT",data:{uid:t.uid,type:this.type,source:this.id}}))}))}unloadTile(t){return s._(this,void 0,void 0,(function*(){t.unloadVectorData(),t.actor&&(yield t.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class Kt extends s.E{constructor(t,o,d,x){super(),this.id=t,this.dispatcher=d,this.setEventedParent(x),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.e({type:"raster"},o),s.e(this,s.U(o,["url","scheme","tileSize"]))}load(){return s._(this,arguments,void 0,(function*(t=!1){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const o=yield yt(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,o&&(s.e(this,o),o.bounds&&(this.tileBounds=new Ne(o.bounds,this.minzoom,this.maxzoom)),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:t})))}catch(o){this._tileJSONRequest=null,this._loaded=!0,s.Z(o)||this.fire(new s.k(o))}}))}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),t(),this.load(!0)}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}serialize(){return s.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t){return s._(this,void 0,void 0,(function*(){const o=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.abortController=new AbortController;try{const d=yield ie.getImage(this.map._requestManager.transformRequest(o,"Tile"),t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(d&&d.data){this.map._refreshExpiredTiles&&(d.cacheControl||d.expires)&&t.setExpiryData({cacheControl:d.cacheControl,expires:d.expires});const x=this.map.painter.context,S=x.gl,A=d.data;t.texture=this.map.painter.getTileTexture(A.width),t.texture?t.texture.update(A,{useMipmap:!0}):(t.texture=new s.T(x,A,S.RGBA,{useMipmap:!0}),t.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE,S.LINEAR_MIPMAP_NEAREST)),t.state="loaded"}}catch(d){if(delete t.abortController,t.aborted)t.state="unloaded";else if(d)throw t.state="errored",d}}))}abortTile(t){return s._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController)}))}unloadTile(t){return s._(this,void 0,void 0,(function*(){t.texture&&this.map.painter.saveTileTexture(t.texture)}))}hasTransition(){return!1}}class Jt extends Kt{constructor(t,o,d,x){super(t,o,d,x),this.type="raster-dem",this.maxzoom=22,this._options=s.e({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox",this.redFactor=o.redFactor,this.greenFactor=o.greenFactor,this.blueFactor=o.blueFactor,this.baseShift=o.baseShift}loadTile(t){return s._(this,void 0,void 0,(function*(){const o=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d=this.map._requestManager.transformRequest(o,"Tile");t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.abortController=new AbortController;try{const x=yield ie.getImage(d,t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(x&&x.data){const S=x.data;this.map._refreshExpiredTiles&&(x.cacheControl||x.expires)&&t.setExpiryData({cacheControl:x.cacheControl,expires:x.expires});const A=s.b(S)&&s.$()?S:yield this.readImageNow(S),R={type:this.type,uid:t.uid,source:this.id,rawImageData:A,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!t.actor||t.state==="expired"){t.actor=this.dispatcher.getActor();const F=yield t.actor.sendAsync({type:"LDT",data:R});t.dem=F,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded"}}}catch(x){if(delete t.abortController,t.aborted)t.state="unloaded";else if(x)throw t.state="errored",x}}))}readImageNow(t){return s._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&s.a0()){const o=t.width+2,d=t.height+2;try{return new s.R({width:o,height:d},yield s.a1(t,-1,-1,o,d))}catch{}}return j.getImageData(t,1)}))}_getNeighboringTiles(t){const o=t.canonical,d=Math.pow(2,o.z),x=(o.x-1+d)%d,S=o.x===0?t.wrap-1:t.wrap,A=(o.x+1+d)%d,R=o.x+1===d?t.wrap+1:t.wrap,F={};return F[new s.a2(t.overscaledZ,S,o.z,x,o.y).key]={backfilled:!1},F[new s.a2(t.overscaledZ,R,o.z,A,o.y).key]={backfilled:!1},o.y>0&&(F[new s.a2(t.overscaledZ,S,o.z,x,o.y-1).key]={backfilled:!1},F[new s.a2(t.overscaledZ,t.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},F[new s.a2(t.overscaledZ,R,o.z,A,o.y-1).key]={backfilled:!1}),o.y+1<d&&(F[new s.a2(t.overscaledZ,S,o.z,x,o.y+1).key]={backfilled:!1},F[new s.a2(t.overscaledZ,t.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},F[new s.a2(t.overscaledZ,R,o.z,A,o.y+1).key]={backfilled:!1}),F}unloadTile(t){return s._(this,void 0,void 0,(function*(){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&(yield t.actor.sendAsync({type:"RDT",data:{type:this.type,uid:t.uid,source:this.id}}))}))}}function kt(w){return w.type==="GeometryCollection"?w.geometries.map((t=>t.coordinates)).flat(1/0):w.coordinates.flat(1/0)}function lr(w){const t=new Ee;let o;switch(w.type){case"FeatureCollection":o=w.features.map((d=>kt(d.geometry))).flat(1/0);break;case"Feature":o=kt(w.geometry);break;default:o=kt(w)}if(o.length==0)return t;for(let d=0;d<o.length-1;d+=2)t.extend([o[d],o[d+1]]);return t}class pr extends s.E{constructor(t,o,d,x){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:o.data},this.actor=d.getActor(),this.setEventedParent(x),this._data=typeof o.data=="string"?{url:o.data}:{geojson:o.data},this._options=s.e({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId,o.clusterMaxZoom!==void 0&&this.maxzoom<=o.clusterMaxZoom&&s.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${o.clusterMaxZoom}".`),this.workerOptions=s.e({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(o.buffer!==void 0?o.buffer:128),tolerance:this._pixelsToTileUnits(o.tolerance!==void 0?o.tolerance:.375),extent:s.a5,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(o.clusterMaxZoom),minPoints:Math.max(2,o.clusterMinPoints||2),extent:s.a5,radius:this._pixelsToTileUnits(o.clusterRadius||50),log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_hasPendingWorkerUpdate(){return this._pendingWorkerUpdate.data!==void 0||this._pendingWorkerUpdate.diff!==void 0||this._pendingWorkerUpdate.optionsChanged}_pixelsToTileUnits(t){return t*(s.a5/this.tileSize)}_getClusterMaxZoom(t){const o=t?Math.round(t):this.maxzoom-1;return Number.isInteger(t)||t===void 0||s.w(`Integer expected for option 'clusterMaxZoom': provided value "${t}" rounded to "${o}"`),o}load(){return s._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(t){this.map=t,this.load()}setData(t,o){this._data=typeof t=="string"?{url:t}:{geojson:t},this._pendingWorkerUpdate={data:t};const d=this._updateWorkerData();return o?d:this}updateData(t,o){this._pendingWorkerUpdate.diff=s.a6(this._pendingWorkerUpdate.diff,t);const d=this._updateWorkerData();return o?d:this}getData(){return s._(this,void 0,void 0,(function*(){const t=s.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:t})}))}getBounds(){return s._(this,void 0,void 0,(function*(){return lr(yield this.getData())}))}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(t.clusterRadius)),t.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(t.clusterMaxZoom)),this._pendingWorkerUpdate.optionsChanged=!0,this._updateWorkerData(),this}getClusterExpansionZoom(t){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:t,source:this.id}})}getClusterChildren(t){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:t,source:this.id}})}getClusterLeaves(t,o,d){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:t,limit:o,offset:d}})}_updateWorkerData(){return s._(this,void 0,void 0,(function*(){if(this._isUpdatingWorker)return;if(!this._hasPendingWorkerUpdate())return void s.w(`No pending worker updates for GeoJSONSource ${this.id}.`);const{data:t,diff:o}=this._pendingWorkerUpdate,d=s.e({type:this.type},this.workerOptions);t!==void 0?(typeof t=="string"?(d.request=this.map._requestManager.transformRequest(j.resolveURL(t),"Source"),d.request.collectResourceTiming=this._collectResourceTiming):d.data=t,this._pendingWorkerUpdate.data=void 0):o&&(d.dataDiff=o,this._pendingWorkerUpdate.diff=void 0),this._pendingWorkerUpdate.optionsChanged=void 0,this._isUpdatingWorker=!0,this.fire(new s.l("dataloading",{dataType:"source"}));try{const x=yield this.actor.sendAsync({type:"LD",data:d});if(this._isUpdatingWorker=!1,this._removed||x.abandoned)return void this.fire(new s.l("dataabort",{dataType:"source"}));x.data&&(this._data={geojson:x.data});const S=this._applyDiffToSource(o),A=this._getShouldReloadTileOptions(S);let R=null;x.resourceTiming&&x.resourceTiming[this.id]&&(R=x.resourceTiming[this.id].slice(0));const F={dataType:"source"};this._collectResourceTiming&&R&&R.length>0&&s.e(F,{resourceTiming:R}),this.fire(new s.l("data",Object.assign(Object.assign({},F),{sourceDataType:"metadata"}))),this.fire(new s.l("data",Object.assign(Object.assign({},F),{sourceDataType:"content",shouldReloadTileOptions:A})))}catch(x){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new s.l("dataabort",{dataType:"source"}));this.fire(new s.k(x))}finally{this._hasPendingWorkerUpdate()&&this._updateWorkerData()}}))}_applyDiffToSource(t){if(!t)return;const o=typeof this.promoteId=="string"?this.promoteId:void 0;if(!this._data.url&&!this._data.updateable){const x=s.a7(this._data.geojson,o);if(!x)throw new Error(`GeoJSONSource "${this.id}": GeoJSON data is not compatible with updateData`);this._data={updateable:x}}if(!this._data.updateable)return;const d=s.a8(this._data.updateable,t,o);return t.removeAll||this._options.cluster?void 0:d}_getShouldReloadTileOptions(t){if(t)return{affectedBounds:t.filter(Boolean).map((o=>lr(o)))}}shouldReloadTile(t,{affectedBounds:o}){if(t.state==="loading")return!0;if(t.state==="unloaded")return!1;const{buffer:d,extent:x}=this.workerOptions.geojsonVtOptions,S=(function({x:A,y:R,z:F},V=0){const q=s.a3((A-V)/Math.pow(2,F)),te=s.a4((R+1+V)/Math.pow(2,F)),Q=s.a3((A+1+V)/Math.pow(2,F)),ce=s.a4((R-V)/Math.pow(2,F));return new Ee([q,te],[Q,ce])})(t.tileID.canonical,d/x);for(const A of o)if(S.intersects(A))return!0;return!1}loaded(){return!this._isUpdatingWorker&&!this._hasPendingWorkerUpdate()}loadTile(t){return s._(this,void 0,void 0,(function*(){const o=t.actor?"RT":"LT";t.actor=this.actor;const d={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};t.abortController=new AbortController;const x=yield this.actor.sendAsync({type:o,data:d},t.abortController);delete t.abortController,t.unloadVectorData(),t.aborted||t.loadVectorData(x,this.map.painter,o==="RT")}))}abortTile(t){return s._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.aborted=!0}))}unloadTile(t){return s._(this,void 0,void 0,(function*(){t.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return s.e({},this._options,{type:this.type,data:this._data.updateable?{type:"FeatureCollection",features:Array.from(this._data.updateable.values())}:this._data.url||this._data.geojson})}hasTransition(){return!1}}class sr extends s.E{constructor(t,o,d,x){super(),this.flippedWindingOrder=!1,this.id=t,this.dispatcher=d,this.coordinates=o.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(x),this.options=o}load(t){return s._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const o=yield ie.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,o&&o.data&&(this.image=o.data,t&&(this.coordinates=t),this._finishLoading())}catch(o){this._request=null,this._loaded=!0,s.Z(o)||this.fire(new s.k(o))}}))}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=t.url,this.load(t.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(t){this.coordinates=t;const o=t.map(s.a9.fromLngLat);var d;return this.tileID=(function(x){const S=s.aa.fromPoints(x),A=S.width(),R=S.height(),F=Math.max(A,R),V=Math.max(0,Math.floor(-Math.log(F)/Math.LN2)),q=Math.pow(2,V);return new s.ac(V,Math.floor((S.minX+S.maxX)/2*q),Math.floor((S.minY+S.maxY)/2*q))})(o),this.terrainTileRanges=this._getOverlappingTileRanges(o),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=o.map((x=>this.tileID.getTilePoint(x)._round())),this.flippedWindingOrder=((d=this.tileCoords)[1].x-d[0].x)*(d[2].y-d[0].y)-(d[1].y-d[0].y)*(d[2].x-d[0].x)<0,this.fire(new s.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,o=t.gl;this.texture||(this.texture=new s.T(t,this.image,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE));let d=!1;for(const x in this.tiles){const S=this.tiles[x];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture,d=!0)}d&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(t){return s._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={}):t.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(t){const{minX:o,minY:d,maxX:x,maxY:S}=s.aa.fromPoints(t),A={};for(let R=0;R<=s.ab;R++){const F=Math.pow(2,R),V=Math.floor(o*F),q=Math.floor(d*F),te=Math.floor(x*F),Q=Math.floor(S*F);A[R]={minTileX:V,minTileY:q,maxTileX:te,maxTileY:Q}}return A}}class st extends sr{constructor(t,o,d,x){super(t,o,d,x),this.roundZoom=!0,this.type="video",this.options=o}load(){return s._(this,void 0,void 0,(function*(){this._loaded=!1;const t=this.options;this.urls=[];for(const o of t.urls)this.urls.push(this.map._requestManager.transformRequest(o,"Source").url);try{const o=yield s.ad(this.urls);if(this._loaded=!0,!o)return;this.video=o,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(o){this.fire(new s.k(o))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const o=this.video.seekable;t<o.start(0)||t>o.end(0)?this.fire(new s.k(new s.ae(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,o=t.gl;this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new s.T(t,this.video,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE));let d=!1;for(const x in this.tiles){const S=this.tiles[x];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture,d=!0)}d&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class fe extends sr{constructor(t,o,d,x){super(t,o,d,x),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some((S=>!Array.isArray(S)||S.length!==2||S.some((A=>typeof A!="number"))))||this.fire(new s.k(new s.ae(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.k(new s.ae(`sources.${t}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new s.k(new s.ae(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof HTMLCanvasElement||this.fire(new s.k(new s.ae(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.k(new s.ae(`sources.${t}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){return s._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context,d=o.gl;this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):(this.texture=new s.T(o,this.canvas,d.RGBA,{premultiply:!0}),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE));let x=!1;for(const S in this.tiles){const A=this.tiles[S];A.state!=="loaded"&&(A.state="loaded",A.texture=this.texture,x=!0)}x&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",animate:this.animate,canvas:this.options.canvas,coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const ue={},ye=w=>{switch(w){case"geojson":return pr;case"image":return sr;case"raster":return Kt;case"raster-dem":return Jt;case"vector":return dt;case"video":return st;case"canvas":return fe}return ue[w]},je="RTLPluginLoaded";class $e extends s.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=jr()}_syncState(t){return this.status=t,this.dispatcher.broadcast("SRPS",{pluginStatus:t,pluginURL:this.url}).catch((o=>{throw this.status="error",o}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(t){return s._(this,arguments,void 0,(function*(o,d=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=j.resolveURL(o),!this.url)throw new Error(`requested url ${o} is invalid`);if(this.status==="unavailable"){if(!d)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return s._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new s.l(je))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let _t=null;function lt(){return _t||(_t=new $e),_t}var at,vt;(function(w){w[w.Base=0]="Base",w[w.Parent=1]="Parent"})(at||(at={})),(function(w){w[w.Departing=0]="Departing",w[w.Incoming=1]="Incoming"})(vt||(vt={}));class Bt{constructor(t,o){this.timeAdded=0,this.fadeEndTime=0,this.fadeOpacity=1,this.tileID=t,this.uid=s.af(),this.uses=0,this.tileSize=o,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}isRenderable(t){return this.hasData()&&(!this.fadeEndTime||this.fadeOpacity>0)&&(t||!this.holdingForSymbolFade())}setCrossFadeLogic({fadingRole:t,fadingDirection:o,fadingParentID:d,fadeEndTime:x}){this.resetFadeLogic(),this.fadingRole=t,this.fadingDirection=o,this.fadingParentID=d,this.fadeEndTime=x}setSelfFadeLogic(t){this.resetFadeLogic(),this.selfFading=!0,this.fadeEndTime=t}resetFadeLogic(){this.fadingRole=null,this.fadingDirection=null,this.fadingParentID=null,this.selfFading=!1,this.timeAdded=z(),this.fadeEndTime=0,this.fadeOpacity=1}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,o,d){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData,this.latestFeatureIndex.encoding=t.encoding):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData,this.latestFeatureIndex.encoding=this.latestEncoding)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=(function(x,S){const A={};if(!S)return A;for(const R of x){const F=R.layerIds.map((V=>S.getLayer(V))).filter(Boolean);if(F.length!==0){R.layers=F,R.stateDependentLayerIds&&(R.stateDependentLayers=R.stateDependentLayerIds.map((V=>F.filter((q=>q.id===V))[0])));for(const V of F)A[V.id]=R}}return A})(t.buckets,o?.style),this.hasSymbolBuckets=!1;for(const x in this.buckets){const S=this.buckets[x];if(S instanceof s.ah){if(this.hasSymbolBuckets=!0,!d)break;S.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const x in this.buckets){const S=this.buckets[x];if(S instanceof s.ah&&S.hasRTLText){this.hasRTLText=!0,lt().lazyLoad();break}}this.queryPadding=0;for(const x in this.buckets){const S=this.buckets[x];this.queryPadding=Math.max(this.queryPadding,o.style.getLayer(x).queryRadius(S))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),this.dashPositions=t.dashPositions}else this.collisionBoxArray=new s.ag}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const d in this.buckets){const x=this.buckets[d];x.uploadPending()&&x.upload(t)}const o=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new s.T(t,this.imageAtlas.image,o.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new s.T(t,this.glyphAtlasImage,o.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,o,d,x,S,A,R,F,V,q,te){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:x,cameraQueryGeometry:S,scale:A,tileSize:this.tileSize,pixelPosMatrix:q,transform:F,params:R,queryPadding:this.queryPadding*V,getElevation:te},t,o,d):{}}querySourceFeatures(t,o){const d=this.latestFeatureIndex;if(!d||!d.rawTileData)return;const x=d.loadVTLayers(),S=o&&o.sourceLayer?o.sourceLayer:"",A=x[s.ai]||x[S];if(!A)return;const R=s.aj(o?.filter,o?.globalState),{z:F,x:V,y:q}=this.tileID.canonical,te={z:F,x:V,y:q};for(let Q=0;Q<A.length;Q++){const ce=A.feature(Q);if(R.needGeometry){const Oe=s.ak(ce,!0);if(!R.filter(new s.H(this.tileID.overscaledZ),Oe,this.tileID.canonical))continue}else if(!R.filter(new s.H(this.tileID.overscaledZ),ce))continue;const _e=d.getId(ce,S),Ie=new s.al(ce,F,V,q,_e);Ie.tile=te,t.push(Ie)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const o=this.expirationTime;if(t.cacheControl){const d=s.am(t.cacheControl);d["max-age"]&&(this.expirationTime=Date.now()+1e3*d["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const d=Date.now();let x=!1;if(this.expirationTime>d)x=!1;else if(o)if(this.expirationTime<o)x=!0;else{const S=this.expirationTime-o;S?this.expirationTime=d+Math.max(S,3e4):x=!0}else x=!0;x?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,o){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const d=this.latestFeatureIndex.loadVTLayers();for(const x in this.buckets){if(!o.style.hasLayer(x))continue;const S=this.buckets[x],A=S.layers[0].sourceLayer||s.ai,R=d[A],F=t[A];if(!R||!F||Object.keys(F).length===0)continue;S.update(F,R,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});const V=o&&o.style&&o.style.getLayer(x);V&&(this.queryPadding=Math.max(this.queryPadding,V.queryRadius(S)))}}holdingForSymbolFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<z()}clearSymbolFadeHold(){this.symbolFadeHoldUntil=void 0}setSymbolHoldDuration(t){this.symbolFadeHoldUntil=z()+t}setDependencies(t,o){const d={};for(const x of o)d[x]=!0;this.dependencies[t]=d}hasDependency(t,o){for(const d of t){const x=this.dependencies[d];if(x){for(const S of o)if(x[S])return!0}}return!1}}class Ht{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,o,d){const x=String(o);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][x]=this.stateChanges[t][x]||{},s.e(this.stateChanges[t][x],d),this.deletedStates[t]===null){this.deletedStates[t]={};for(const S in this.state[t])S!==x&&(this.deletedStates[t][S]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][x]===null){this.deletedStates[t][x]={};for(const S in this.state[t][x])d[S]||(this.deletedStates[t][x][S]=null)}else for(const S in d)this.deletedStates[t]&&this.deletedStates[t][x]&&this.deletedStates[t][x][S]===null&&delete this.deletedStates[t][x][S]}removeFeatureState(t,o,d){if(this.deletedStates[t]===null)return;const x=String(o);if(this.deletedStates[t]=this.deletedStates[t]||{},d&&o!==void 0)this.deletedStates[t][x]!==null&&(this.deletedStates[t][x]=this.deletedStates[t][x]||{},this.deletedStates[t][x][d]=null);else if(o!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][x])for(d in this.deletedStates[t][x]={},this.stateChanges[t][x])this.deletedStates[t][x][d]=null;else this.deletedStates[t][x]=null;else this.deletedStates[t]=null}getState(t,o){const d=String(o),x=s.e({},(this.state[t]||{})[d],(this.stateChanges[t]||{})[d]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const S=this.deletedStates[t][o];if(S===null)return{};for(const A in S)delete x[A]}return x}initializeTileState(t,o){t.setFeatureState(this.state,o)}coalesceChanges(t,o){const d={};for(const x in this.stateChanges){this.state[x]=this.state[x]||{};const S={};for(const A in this.stateChanges[x])this.state[x][A]||(this.state[x][A]={}),s.e(this.state[x][A],this.stateChanges[x][A]),S[A]=this.state[x][A];d[x]=S}for(const x in this.deletedStates){this.state[x]=this.state[x]||{};const S={};if(this.deletedStates[x]===null)for(const A in this.state[x])S[A]={},this.state[x][A]={};else for(const A in this.deletedStates[x]){if(this.deletedStates[x][A]===null)this.state[x][A]={};else for(const R of Object.keys(this.deletedStates[x][A]))delete this.state[x][A][R];S[A]=this.state[x][A]}d[x]=d[x]||{},s.e(d[x],S)}this.stateChanges={},this.deletedStates={},Object.keys(d).length!==0&&t.setFeatureState(d,o)}}const Tr=89.25;function hr(w,t){const o=s.an(t.lat,-s.ao,s.ao);return new s.P(s.Y(t.lng)*w,s.X(o)*w)}function Gr(w,t){return new s.a9(t.x/w,t.y/w).toLngLat()}function xn(w){return w.cameraToCenterDistance*Math.min(.85*Math.tan(s.ap(90-w.pitch)),Math.tan(s.ap(Tr-w.pitch)))}function an(w,t){const o=w.canonical,d=t/s.aq(o.z),x=o.x+Math.pow(2,o.z)*w.wrap,S=s.ar(new Float64Array(16));return s.O(S,S,[x*d,o.y*d,0]),s.Q(S,S,[d/s.a5,d/s.a5,1]),S}function xt(w,t,o,d,x){const S=s.a9.fromLngLat(w,t),A=x*s.as(1,w.lat),{x:R,y:F,z:V}=Ln(o,d);return new s.a9(S.x+A*-R,S.y+A*-F,S.z+A*-V)}function Ln(w,t){const o=s.ap(w),d=s.ap(t),x=Math.cos(-o),S=Math.sin(o);return{x:S*Math.sin(d),y:-S*Math.cos(d),z:x}}function ya(w,t,o){const d=t.intersectsFrustum(w);if(!o||d===0)return d;const x=t.intersectsPlane(o);return x===0?0:d===2&&x===2?2:1}function Mr(w,t,o){let d=0;const x=(o-t)/10;for(let S=0;S<10;S++)d+=x*Math.pow(Math.cos(t+(S+.5)/10*(o-t)),w);return d}function Fn(w,t){return function(o,d,x,S,A){const R=2*((w-1)/s.at(Math.cos(s.ap(Tr-A))/Math.cos(s.ap(Tr)))-1),F=Math.acos(x/S),V=2*Mr(R-1,0,s.ap(A/2)),q=Math.min(s.ap(Tr),F+s.ap(A/2)),te=Mr(R-1,Math.min(q,F-s.ap(A/2)),q),Q=Math.atan(d/x),ce=Math.hypot(d,x);let _e=o;return _e+=s.at(S/ce/Math.max(.5,Math.cos(s.ap(A/2)))),_e+=R*s.at(Math.cos(Q))/2,_e-=s.at(Math.max(1,te/V/t))/2,_e}}const Ga=Fn(9.314,3);function Vn(w,t){const o=(t.roundZoom?Math.round:Math.floor)(w.zoom+s.at(w.tileSize/t.tileSize));return Math.max(0,o)}function va(w,t){const o=w.getCameraFrustum(),d=w.getClippingPlane(),x=w.screenPointToMercatorCoordinate(w.getCameraPoint()),S=s.a9.fromLngLat(w.center,w.elevation);x.z=S.z+Math.cos(w.pitchInRadians)*w.cameraToCenterDistance/w.worldSize;const A=w.getCoveringTilesDetailsProvider(),R=A.allowVariableZoom(w,t),F=Vn(w,t),V=t.minzoom||0,q=t.maxzoom!==void 0?t.maxzoom:w.maxZoom,te=Math.min(Math.max(0,F),q),Q=Math.pow(2,te),ce=[Q*x.x,Q*x.y,0],_e=[Q*S.x,Q*S.y,0],Ie=Math.hypot(S.x-x.x,S.y-x.y),Oe=Math.abs(S.z-x.z),Le=Math.hypot(Ie,Oe),qe=rt=>({zoom:0,x:0,y:0,wrap:rt,fullyVisible:!1}),nt=[],He=[];if(w.renderWorldCopies&&A.allowWorldCopies())for(let rt=1;rt<=3;rt++)nt.push(qe(-rt)),nt.push(qe(rt));for(nt.push(qe(0));nt.length>0;){const rt=nt.pop(),ot=rt.x,Xe=rt.y;let ft=rt.fullyVisible;const Pt={x:ot,y:Xe,z:rt.zoom},Et=A.getTileBoundingVolume(Pt,rt.wrap,w.elevation,t);if(!ft){const fr=ya(o,Et,d);if(fr===0)continue;ft=fr===2}const Ct=A.distanceToTile2d(x.x,x.y,Pt,Et);let Dt=F;R&&(Dt=(t.calculateTileZoom||Ga)(w.zoom+s.at(w.tileSize/t.tileSize),Ct,Oe,Le,w.fov)),Dt=(t.roundZoom?Math.round:Math.floor)(Dt),Dt=Math.max(0,Dt);const ur=Math.min(Dt,q);if(rt.wrap=A.getWrap(S,Pt,rt.wrap),rt.zoom>=ur){if(rt.zoom<V)continue;const fr=te-rt.zoom,tr=ce[0]-.5-(ot<<fr),br=ce[1]-.5-(Xe<<fr),hn=t.reparseOverscaled?Math.max(rt.zoom,Dt):rt.zoom;He.push({tileID:new s.a2(rt.zoom===q?hn:rt.zoom,rt.wrap,rt.zoom,ot,Xe),distanceSq:s.au([_e[0]-.5-ot,_e[1]-.5-Xe]),tileDistanceToCamera:Math.sqrt(tr*tr+br*br)})}else for(let fr=0;fr<4;fr++)nt.push({zoom:rt.zoom+1,x:(ot<<1)+fr%2,y:(Xe<<1)+(fr>>1),wrap:rt.wrap,fullyVisible:ft})}return He.sort(((rt,ot)=>rt.distanceSq-ot.distanceSq)).map((rt=>rt.tileID))}const gn=s.aa.fromPoints([new s.P(0,0),new s.P(s.a5,s.a5)]);function ga(w){return w==="raster"||w==="image"||w==="video"}function Yi(w,t,o,d,x,S,A){if(!t.hasData())return!1;const{tileID:R,fadingRole:F,fadingDirection:V,fadingParentID:q}=t;if(F===at.Base&&V===vt.Incoming&&q)return o[q.key]=q,!0;const te=Math.max(R.overscaledZ-x,S);for(let Q=R.overscaledZ-1;Q>=te;Q--){const ce=R.scaledTo(Q),_e=w.getLoadedTile(ce);if(_e)return t.setCrossFadeLogic({fadingRole:at.Base,fadingDirection:vt.Incoming,fadingParentID:_e.tileID,fadeEndTime:d+A}),_e.setCrossFadeLogic({fadingRole:at.Parent,fadingDirection:vt.Departing,fadeEndTime:d+A}),o[ce.key]=ce,!0}return!1}function xo(w,t,o,d,x,S){if(!t.hasData())return!1;const A=t.tileID.children(x);let R=Xt(w,t,A,o,d,x,S);if(R)return!0;for(const F of A)Xt(w,t,F.children(x),o,d,x,S)&&(R=!0);return R}function Xt(w,t,o,d,x,S,A){if(o[0].overscaledZ>=S)return!1;let R=!1;for(const F of o){const V=w.getLoadedTile(F);if(!V)continue;const{fadingRole:q,fadingDirection:te,fadingParentID:Q}=V;q===at.Base&&te===vt.Departing&&Q||(V.setCrossFadeLogic({fadingRole:at.Base,fadingDirection:vt.Departing,fadingParentID:t.tileID,fadeEndTime:x+A}),t.setCrossFadeLogic({fadingRole:at.Parent,fadingDirection:vt.Incoming,fadeEndTime:x+A})),d[F.key]=F,R=!0}return R}function xe(w,t,o,d){const x=w.tileID;return!!w.selfFading||!w.hasData()&&!!t.has(x)&&(w.setSelfFadeLogic(o+d),!0)}function Ue(w,t){var o;w.needsHillshadePrepare=!0,w.needsTerrainPrepare=!0;let d=t.tileID.canonical.x-w.tileID.canonical.x;const x=t.tileID.canonical.y-w.tileID.canonical.y,S=Math.pow(2,w.tileID.canonical.z),A=t.tileID.key;d===0&&x===0||Math.abs(x)>1||(Math.abs(d)>1&&(Math.abs(d+S)===1?d+=S:Math.abs(d-S)===1&&(d-=S)),t.dem&&w.dem&&(w.dem.backfillBorder(t.dem,d,x),!((o=w.neighboringTiles)===null||o===void 0)&&o[A]&&(w.neighboringTiles[A].backfilled=!0)))}class Fe{constructor(){this._tiles={}}handleWrapJump(t){const o={};for(const d in this._tiles){const x=this._tiles[d];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+t),o[x.tileID.key]=x}this._tiles=o}setFeatureState(t,o){for(const d in this._tiles)this._tiles[d].setFeatureState(t,o)}getAllTiles(){return Object.values(this._tiles)}getAllIds(t=!1){return t?Object.values(this._tiles).map((o=>o.tileID)).sort(s.aw).map((o=>o.key)):Object.keys(this._tiles)}getTileById(t){return this._tiles[t]}setTile(t,o){this._tiles[t]=o}deleteTileById(t){delete this._tiles[t]}getLoadedTile(t){const o=this.getTileById(t.key);return o?.hasData()?o:null}isIdRenderable(t,o=!1){var d;return(d=this.getTileById(t))===null||d===void 0?void 0:d.isRenderable(o)}getRenderableIds(t=0,o){const d=[];for(const x of this.getAllIds())this.isIdRenderable(x,o)&&d.push(this.getTileById(x));return o?d.sort(((x,S)=>{const A=x.tileID,R=S.tileID,F=new s.P(A.canonical.x,A.canonical.y)._rotate(-t),V=new s.P(R.canonical.x,R.canonical.y)._rotate(-t);return A.overscaledZ-R.overscaledZ||V.y-F.y||V.x-F.x})).map((x=>x.tileID.key)):d.map((x=>x.tileID)).sort(s.aw).map((x=>x.key))}}class Re extends s.E{constructor(t,o,d){super(),this.id=t,this.dispatcher=d,this.on("data",(x=>this._dataHandler(x))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((x,S,A,R)=>{const F=new(ye(S.type))(x,S,A,R);if(F.id!==x)throw new Error(`Expected Source id to be ${x} instead of ${F.id}`);return F})(t,o,d,this),this._inViewTiles=new Fe,this._outOfViewCache=new s.ax(0,(x=>this._unloadTile(x))),this._timers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._rasterFadeDuration=0,this._maxFadingAncestorLevels=5,this._state=new Ht,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){for(const o of this._inViewTiles.getAllTiles())o.unloadVectorData();this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t),this._inViewTiles=new Fe}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t of this._inViewTiles.getAllTiles())if(t.state!=="loaded"&&t.state!=="errored")return!1;return!0}getSource(){return this._source}getState(){return this._state}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,o,d){return s._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(t),this._tileLoaded(t,o,d)}catch(x){t.state="errored",x.status!==404?this._source.fire(new s.k(x,{tile:t})):this.update(this.transform,this.terrain)}}))}_unloadTile(t){this._source.unloadTile&&this._source.unloadTile(t)}_abortTile(t){this._source.abortTile&&this._source.abortTile(t),this._source.fire(new s.l("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._inViewTiles,this.map?this.map.painter:null);for(const o of this._inViewTiles.getAllTiles())o.upload(t),o.prepare(this.map.style.imageManager)}getIds(){return this._inViewTiles.getAllIds(!0)}getRenderableIds(t){var o;return this._inViewTiles.getRenderableIds((o=this.transform)===null||o===void 0?void 0:o.bearingInRadians,t)}hasRenderableParent(t){const o=t.overscaledZ-1;if(o>=this._source.minzoom){const d=this.getLoadedTile(t.scaledTo(o));if(d)return this._inViewTiles.isIdRenderable(d.tileID.key)}return!1}reload(t,o=void 0){if(this._paused)this._shouldReloadOnResume=!0;else{this._outOfViewCache.reset();for(const d of this._inViewTiles.getAllIds()){const x=this._inViewTiles.getTileById(d);o&&!this._source.shouldReloadTile(x,o)||(t?this._reloadTile(d,"expired"):x.state!=="errored"&&this._reloadTile(d,"reloading"))}}}_reloadTile(t,o){return s._(this,void 0,void 0,(function*(){const d=this._inViewTiles.getTileById(t);d&&(d.state!=="loading"&&(d.state=o),yield this._loadTile(d,t,o))}))}_tileLoaded(t,o,d){t.timeAdded=z(),t.selfFading&&(t.fadeEndTime=t.timeAdded+this._rasterFadeDuration),d==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(o,t),this.getSource().type==="raster-dem"&&t.dem&&(function(x,S){var A,R;const F=S.getRenderableIds();for(const V of F){if(!x.neighboringTiles||!x.neighboringTiles[V])continue;const q=S.getTileById(V);x.neighboringTiles[V].backfilled||Ue(x,q),!((R=(A=q.neighboringTiles)===null||A===void 0?void 0:A[x.tileID.key])===null||R===void 0)&&R.backfilled||Ue(q,x)}})(t,this._inViewTiles),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new s.l("data",{dataType:"source",tile:t,coord:t.tileID}))}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._inViewTiles.getTileById(t)}_retainLoadedChildren(t,o){const d=this._getLoadedDescendents(o),x=new Set;for(const S of o){const A=d[S.key];if(!A?.length){x.add(S);continue}const R=S.overscaledZ+Re.maxOverzooming,F=A.filter((te=>te.tileID.overscaledZ<=R));if(!F.length){x.add(S);continue}const V=Math.min(...F.map((te=>te.tileID.overscaledZ))),q=F.filter((te=>te.tileID.overscaledZ===V)).map((te=>te.tileID));for(const te of q)t[te.key]=te;this._areDescendentsComplete(q,V,S.overscaledZ)||x.add(S)}return x}_getLoadedDescendents(t){var o;const d={};for(const x of this._inViewTiles.getAllTiles().filter((S=>S.hasData())))for(const S of t)x.tileID.isChildOf(S)&&(d[o=S.key]||(d[o]=[])).push(x);return d}_areDescendentsComplete(t,o,d){return t.length===1&&t[0].isOverscaled()?t[0].overscaledZ===o:Math.pow(4,o-d)===t.length}getLoadedTile(t){return this._inViewTiles.getLoadedTile(t)}updateCacheSize(t){const o=Math.ceil(t.width/this._source.tileSize)+1,d=Math.ceil(t.height/this._source.tileSize)+1,x=Math.floor(o*d*(this._maxTileCacheZoomLevels===null?s.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),S=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,x):x;this._outOfViewCache.setMaxSize(S)}handleWrapJump(t){const o=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);this._prevLng=t,o&&(this._inViewTiles.handleWrapJump(o),this._resetTileReloadTimers())}update(t,o){if(!this._sourceLoaded||this._paused)return;let d;this.transform=t,this.terrain=o,this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this.used||this.usedForTerrain?this._source.tileID?d=t.getVisibleUnwrappedCoordinates(this._source.tileID).map((F=>new s.a2(F.canonical.z,F.wrap,F.canonical.z,F.canonical.x,F.canonical.y))):(d=va(t,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.type==="vector"&&this.map._zoomLevelsToOverscale!==void 0?t.maxZoom-this.map._zoomLevelsToOverscale:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:o,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(d=d.filter((F=>this._source.hasTile(F))))):d=[],this.usedForTerrain&&(d=this._addTerrainIdealTiles(d));const x=d.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,x&&this.fire(new s.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const S=Vn(t,this._source),A=this._updateRetainedTiles(d,S),R=ga(this._source.type);R&&this._rasterFadeDuration>0&&!o&&(function(F,V,q,te,Q,ce,_e){const Ie=z(),Oe=s.av(V);for(const Le of V){const qe=F.getTileById(Le.key);qe.fadingDirection!==vt.Departing&&qe.fadeOpacity!==0||qe.resetFadeLogic(),Yi(F,qe,q,Ie,te,Q,_e)||xo(F,qe,q,Ie,ce,_e)||xe(qe,Oe,Ie,_e)||qe.resetFadeLogic()}})(this._inViewTiles,d,A,this._maxFadingAncestorLevels,this._source.minzoom,this._source.maxzoom,this._rasterFadeDuration),R?this._cleanUpRasterTiles(A):this._cleanUpVectorTiles(A)}_cleanUpRasterTiles(t){for(const o of this._inViewTiles.getAllIds())t[o]||this._removeTile(o)}_cleanUpVectorTiles(t){for(const o of this._inViewTiles.getAllIds()){const d=this._inViewTiles.getTileById(o);t[o]?d.clearSymbolFadeHold():d.hasSymbolBuckets?d.holdingForSymbolFade()?d.symbolFadeFinished()&&this._removeTile(o):d.setSymbolHoldDuration(this.map._fadeDuration):this._removeTile(o)}}_addTerrainIdealTiles(t){const o=[];for(const d of t)if(d.canonical.z>this._source.minzoom){const x=d.scaledTo(d.canonical.z-1);o.push(x);const S=d.scaledTo(Math.max(this._source.minzoom,Math.min(d.canonical.z,5)));o.push(S)}return t.concat(o)}releaseSymbolFadeTiles(){for(const t of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(t).holdingForSymbolFade()&&this._removeTile(t)}_updateRetainedTiles(t,o){var d;const x=new Set;for(const V of t)this._addTile(V).hasData()||x.add(V);const S=t.reduce(((V,q)=>(V[q.key]=q,V)),{}),A=this._retainLoadedChildren(S,x),R={},F=Math.max(o-Re.maxUnderzooming,this._source.minzoom);for(const V of A){let q=this._inViewTiles.getTileById(V.key),te=q?.wasRequested();for(let Q=V.overscaledZ-1;Q>=F;--Q){const ce=V.scaledTo(Q);if(R[ce.key])break;if(R[ce.key]=!0,q=this.getTile(ce),!q&&te&&(q=this._addTile(ce)),q){const _e=q.hasData();if((_e||!(!((d=this.map)===null||d===void 0)&&d.cancelPendingTileRequestsWhileZooming)||te)&&(S[ce.key]=ce),te=q.wasRequested(),_e)break}}}return S}_addTile(t){let o=this._inViewTiles.getTileById(t.key);if(o)return o;o=this._outOfViewCache.getAndRemove(t),o&&(o.resetFadeLogic(),this._setTileReloadTimer(t.key,o),o.tileID=t,this._state.initializeTileState(o,this.map?this.map.painter:null));const d=o;return o||(o=new Bt(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(o,t.key,o.state)),o.uses++,this._inViewTiles.setTile(t.key,o),d||this._source.fire(new s.l("dataloading",{tile:o,coord:o.tileID,dataType:"source"})),o}_setTileReloadTimer(t,o){this._clearTileReloadTimer(t);const d=o.getExpiryTimeout();d&&(this._timers[t]=setTimeout((()=>{this._reloadTile(t,"expired"),delete this._timers[t]}),d))}_clearTileReloadTimer(t){const o=this._timers[t];o&&(clearTimeout(o),delete this._timers[t])}_resetTileReloadTimers(){for(const t in this._timers)clearTimeout(this._timers[t]),delete this._timers[t];for(const t of this._inViewTiles.getAllIds()){const o=this._inViewTiles.getTileById(t);this._setTileReloadTimer(t,o)}}refreshTiles(t){for(const o of this._inViewTiles.getAllIds()){const d=this._inViewTiles.getTileById(o);(this._inViewTiles.isIdRenderable(o)||d.state=="errored")&&t.some((x=>x.equals(d.tileID.canonical)))&&this._reloadTile(o,"expired")}}_removeTile(t){const o=this._inViewTiles.getTileById(t);o&&(o.uses--,this._inViewTiles.deleteTileById(t),this._clearTileReloadTimer(t),o.uses>0||(o.hasData()&&o.state!=="reloading"?this._outOfViewCache.add(o.tileID,o,o.getExpiryTimeout()):(o.aborted=!0,this._abortTile(o),this._unloadTile(o))))}_dataHandler(t){t.dataType==="source"&&(t.sourceDataType!=="metadata"?t.sourceDataType==="content"&&this._sourceLoaded&&!this._paused&&(this.reload(t.sourceDataChanged,t.shouldReloadTileOptions),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0):this._sourceLoaded=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t of this._inViewTiles.getAllIds())this._removeTile(t);this._outOfViewCache.reset()}tilesIn(t,o,d){const x=[],S=this.transform;if(!S)return x;const A=S.getCoveringTilesDetailsProvider().allowWorldCopies(),R=d?S.getCameraQueryGeometry(t):t,F=ce=>S.screenPointToMercatorCoordinate(ce,this.terrain),V=this.transformBbox(t,F,!A),q=this.transformBbox(R,F,!A),te=this.getIds(),Q=s.aa.fromPoints(q);for(let ce=0;ce<te.length;ce++){const _e=this._inViewTiles.getTileById(te[ce]);if(_e.holdingForSymbolFade())continue;const Ie=A?[_e.tileID]:[_e.tileID.unwrapTo(-1),_e.tileID.unwrapTo(0)],Oe=Math.pow(2,S.zoom-_e.tileID.overscaledZ),Le=o*_e.queryPadding*s.a5/_e.tileSize/Oe;for(const qe of Ie){const nt=Q.map((He=>qe.getTilePoint(new s.a9(He.x,He.y))));if(nt.expandBy(Le),nt.intersects(gn)){const He=V.map((ot=>qe.getTilePoint(ot))),rt=q.map((ot=>qe.getTilePoint(ot)));x.push({tile:_e,tileID:A?qe:qe.unwrapTo(0),queryGeometry:He,cameraQueryGeometry:rt,scale:Oe})}}}return x}transformBbox(t,o,d){let x=t.map(o);if(d){const S=s.aa.fromPoints(t);S.shrinkBy(.001*Math.min(S.width(),S.height()));const A=S.map(o);s.aa.fromPoints(x).covers(A)||(x=x.map((R=>R.x>.5?new s.a9(R.x-1,R.y,R.z):R)))}return x}getVisibleCoordinates(t){const o=this.getRenderableIds(t).map((d=>this._inViewTiles.getTileById(d).tileID));return this.transform&&this.transform.populateCache(o),o}hasTransition(){return!!this._source.hasTransition()||!(!ga(this._source.type)||!(function(t,o){if(o<=0)return!1;const d=z();for(const x of t.getAllTiles())if(x.fadeEndTime>=d)return!0;return!1})(this._inViewTiles,this._rasterFadeDuration))}setRasterFadeDuration(t){this._rasterFadeDuration=t}setFeatureState(t,o,d){this._state.updateState(t=t||s.ai,o,d)}removeFeatureState(t,o,d){this._state.removeFeatureState(t=t||s.ai,o,d)}getFeatureState(t,o){return this._state.getState(t=t||s.ai,o)}setDependencies(t,o,d){const x=this._inViewTiles.getTileById(t);x&&x.setDependencies(o,d)}reloadTilesForDependencies(t,o){for(const d of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(d).hasDependency(t,o)&&this._reloadTile(d,"reloading");this._outOfViewCache.filter((d=>!d.hasDependency(t,o)))}areTilesLoaded(){for(const t of this._inViewTiles.getAllTiles())if(t.state!=="loaded"&&t.state!=="errored")return!1;return!0}}Re.maxUnderzooming=10,Re.maxOverzooming=3;class Te{constructor(t,o){this.reset(t,o)}reset(t,o){this.points=t||[],this._distances=[0];for(let d=1;d<this.points.length;d++)this._distances[d]=this._distances[d-1]+this.points[d].dist(this.points[d-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(o||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=s.an(t,0,1);let o=1,d=this._distances[o];const x=t*this.paddedLength+this.padding;for(;d<x&&o<this._distances.length;)d=this._distances[++o];const S=o-1,A=this._distances[S],R=d-A,F=R>0?(x-A)/R:0;return this.points[S].mult(1-F).add(this.points[o].mult(F))}}function ze(w,t){let o=!0;return w==="always"||w!=="never"&&t!=="never"||(o=!1),o}class mt{constructor(t,o,d){const x=this.boxCells=[],S=this.circleCells=[];this.xCellCount=Math.ceil(t/d),this.yCellCount=Math.ceil(o/d);for(let A=0;A<this.xCellCount*this.yCellCount;A++)x.push([]),S.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=o,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/o,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,o,d,x,S){this._forEachCell(o,d,x,S,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(o),this.bboxes.push(d),this.bboxes.push(x),this.bboxes.push(S)}insertCircle(t,o,d,x){this._forEachCell(o-x,d-x,o+x,d+x,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(o),this.circles.push(d),this.circles.push(x)}_insertBoxCell(t,o,d,x,S,A){this.boxCells[S].push(A)}_insertCircleCell(t,o,d,x,S,A){this.circleCells[S].push(A)}_query(t,o,d,x,S,A,R){if(d<0||t>this.width||x<0||o>this.height)return[];const F=[];if(t<=0&&o<=0&&this.width<=d&&this.height<=x){if(S)return[{key:null,x1:t,y1:o,x2:d,y2:x}];for(let V=0;V<this.boxKeys.length;V++)F.push({key:this.boxKeys[V],x1:this.bboxes[4*V],y1:this.bboxes[4*V+1],x2:this.bboxes[4*V+2],y2:this.bboxes[4*V+3]});for(let V=0;V<this.circleKeys.length;V++){const q=this.circles[3*V],te=this.circles[3*V+1],Q=this.circles[3*V+2];F.push({key:this.circleKeys[V],x1:q-Q,y1:te-Q,x2:q+Q,y2:te+Q})}}else this._forEachCell(t,o,d,x,this._queryCell,F,{hitTest:S,overlapMode:A,seenUids:{box:{},circle:{}}},R);return F}query(t,o,d,x){return this._query(t,o,d,x,!1,null)}hitTest(t,o,d,x,S,A){return this._query(t,o,d,x,!0,S,A).length>0}hitTestCircle(t,o,d,x,S){const A=t-d,R=t+d,F=o-d,V=o+d;if(R<0||A>this.width||V<0||F>this.height)return!1;const q=[];return this._forEachCell(A,F,R,V,this._queryCellCircle,q,{hitTest:!0,overlapMode:x,circle:{x:t,y:o,radius:d},seenUids:{box:{},circle:{}}},S),q.length>0}_queryCell(t,o,d,x,S,A,R,F){const{seenUids:V,hitTest:q,overlapMode:te}=R,Q=this.boxCells[S];if(Q!==null){const _e=this.bboxes;for(const Ie of Q)if(!V.box[Ie]){V.box[Ie]=!0;const Oe=4*Ie,Le=this.boxKeys[Ie];if(t<=_e[Oe+2]&&o<=_e[Oe+3]&&d>=_e[Oe+0]&&x>=_e[Oe+1]&&(!F||F(Le))&&(!q||!ze(te,Le.overlapMode))&&(A.push({key:Le,x1:_e[Oe],y1:_e[Oe+1],x2:_e[Oe+2],y2:_e[Oe+3]}),q))return!0}}const ce=this.circleCells[S];if(ce!==null){const _e=this.circles;for(const Ie of ce)if(!V.circle[Ie]){V.circle[Ie]=!0;const Oe=3*Ie,Le=this.circleKeys[Ie];if(this._circleAndRectCollide(_e[Oe],_e[Oe+1],_e[Oe+2],t,o,d,x)&&(!F||F(Le))&&(!q||!ze(te,Le.overlapMode))){const qe=_e[Oe],nt=_e[Oe+1],He=_e[Oe+2];if(A.push({key:Le,x1:qe-He,y1:nt-He,x2:qe+He,y2:nt+He}),q)return!0}}}return!1}_queryCellCircle(t,o,d,x,S,A,R,F){const{circle:V,seenUids:q,overlapMode:te}=R,Q=this.boxCells[S];if(Q!==null){const _e=this.bboxes;for(const Ie of Q)if(!q.box[Ie]){q.box[Ie]=!0;const Oe=4*Ie,Le=this.boxKeys[Ie];if(this._circleAndRectCollide(V.x,V.y,V.radius,_e[Oe+0],_e[Oe+1],_e[Oe+2],_e[Oe+3])&&(!F||F(Le))&&!ze(te,Le.overlapMode))return A.push(!0),!0}}const ce=this.circleCells[S];if(ce!==null){const _e=this.circles;for(const Ie of ce)if(!q.circle[Ie]){q.circle[Ie]=!0;const Oe=3*Ie,Le=this.circleKeys[Ie];if(this._circlesCollide(_e[Oe],_e[Oe+1],_e[Oe+2],V.x,V.y,V.radius)&&(!F||F(Le))&&!ze(te,Le.overlapMode))return A.push(!0),!0}}}_forEachCell(t,o,d,x,S,A,R,F){const V=this._convertToXCellCoord(t),q=this._convertToYCellCoord(o),te=this._convertToXCellCoord(d),Q=this._convertToYCellCoord(x);for(let ce=V;ce<=te;ce++)for(let _e=q;_e<=Q;_e++)if(S.call(this,t,o,d,x,this.xCellCount*_e+ce,A,R,F))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,o,d,x,S,A){const R=x-t,F=S-o,V=d+A;return V*V>R*R+F*F}_circleAndRectCollide(t,o,d,x,S,A,R){const F=(A-x)/2,V=Math.abs(t-(x+F));if(V>F+d)return!1;const q=(R-S)/2,te=Math.abs(o-(S+q));if(te>q+d)return!1;if(V<=F||te<=q)return!0;const Q=V-F,ce=te-q;return Q*Q+ce*ce<=d*d}}function Ut(w,t,o){const d=s.N();if(!w){const{vecSouth:te,vecEast:Q}=Tt(t),ce=M();ce[0]=Q[0],ce[1]=Q[1],ce[2]=te[0],ce[3]=te[1],x=ce,(q=(A=(S=ce)[0])*(V=S[3])-(F=S[2])*(R=S[1]))&&(x[0]=V*(q=1/q),x[1]=-R*q,x[2]=-F*q,x[3]=A*q),d[0]=ce[0],d[1]=ce[1],d[4]=ce[2],d[5]=ce[3]}var x,S,A,R,F,V,q;return s.Q(d,d,[1/o,1/o,1]),d}function It(w,t,o,d){if(w){const x=s.N();if(!t){const{vecSouth:S,vecEast:A}=Tt(o);x[0]=A[0],x[1]=A[1],x[4]=S[0],x[5]=S[1]}return s.Q(x,x,[d,d,1]),x}return o.pixelsToClipSpaceMatrix}function Tt(w){const t=Math.cos(w.rollInRadians),o=Math.sin(w.rollInRadians),d=Math.cos(w.pitchInRadians),x=Math.cos(w.bearingInRadians),S=Math.sin(w.bearingInRadians),A=s.aC();A[0]=-x*d*o-S*t,A[1]=-S*d*o+x*t;const R=s.aD(A);R<1e-9?s.aE(A):s.aF(A,A,1/R);const F=s.aC();F[0]=x*d*t-S*o,F[1]=S*d*t+x*o;const V=s.aD(F);return V<1e-9?s.aE(F):s.aF(F,F,1/V),{vecEast:F,vecSouth:A}}function gt(w,t,o,d){let x;d?(x=[w,t,d(w,t),1],s.aH(x,x,o)):(x=[w,t,0,1],os(x,x,o));const S=x[3];return{point:new s.P(x[0]/S,x[1]/S),signedDistanceFromCamera:S,isOccluded:!1}}function ir(w,t){return .5+w/t*.5}function vr(w,t){return w.x>=-t[0]&&w.x<=t[0]&&w.y>=-t[1]&&w.y<=t[1]}function Sr(w,t,o,d,x,S,A,R,F,V,q,te,Q){const ce=o?w.textSizeData:w.iconSizeData,_e=s.ay(ce,t.transform.zoom),Ie=[256/t.width*2+1,256/t.height*2+1],Oe=o?w.text.dynamicLayoutVertexArray:w.icon.dynamicLayoutVertexArray;Oe.clear();const Le=w.lineVertexArray,qe=o?w.text.placedSymbolArray:w.icon.placedSymbolArray,nt=t.transform.width/t.transform.height;let He=!1;for(let rt=0;rt<qe.length;rt++){const ot=qe.get(rt);if(ot.hidden||ot.writingMode===s.az.vertical&&!He){ss(ot.numGlyphs,Oe);continue}He=!1;const Xe=new s.P(ot.anchorX,ot.anchorY),ft={getElevation:Q,pitchedLabelPlaneMatrix:d,lineVertexArray:Le,pitchWithMap:S,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:t.transform,tileAnchorPoint:Xe,unwrappedTileID:F,width:V,height:q,translation:te},Pt=xs(ot.anchorX,ot.anchorY,ft);if(!vr(Pt.point,Ie)){ss(ot.numGlyphs,Oe);continue}const Et=ir(t.transform.cameraToCenterDistance,Pt.signedDistanceFromCamera),Ct=s.aA(ce,_e,ot),Dt=S?Ct*t.transform.getPitchedTextCorrection(ot.anchorX,ot.anchorY,F)/Et:Ct*Et,ur=Nr({projectionContext:ft,pitchedLabelPlaneMatrixInverse:x,symbol:ot,fontSize:Dt,flip:!1,keepUpright:A,glyphOffsetArray:w.glyphOffsetArray,dynamicLayoutVertexArray:Oe,aspectRatio:nt,rotateToLine:R});He=ur.useVertical,(ur.notEnoughRoom||He||ur.needsFlipping&&Nr({projectionContext:ft,pitchedLabelPlaneMatrixInverse:x,symbol:ot,fontSize:Dt,flip:!0,keepUpright:A,glyphOffsetArray:w.glyphOffsetArray,dynamicLayoutVertexArray:Oe,aspectRatio:nt,rotateToLine:R}).notEnoughRoom)&&ss(ot.numGlyphs,Oe)}o?w.text.dynamicLayoutVertexBuffer.updateData(Oe):w.icon.dynamicLayoutVertexBuffer.updateData(Oe)}function dr(w,t,o,d,x,S,A,R){const F=S.glyphStartIndex+S.numGlyphs,V=S.lineStartIndex,q=S.lineStartIndex+S.lineLength,te=t.getoffsetX(S.glyphStartIndex),Q=t.getoffsetX(F-1),ce=za(w*te,o,d,x,S.segment,V,q,R,A);if(!ce)return null;const _e=za(w*Q,o,d,x,S.segment,V,q,R,A);return _e?R.projectionCache.anyProjectionOccluded?null:{first:ce,last:_e}:null}function xr(w,t,o,d){return w===s.az.horizontal&&Math.abs(o.y-t.y)>Math.abs(o.x-t.x)*d?{useVertical:!0}:(w===s.az.vertical?t.y<o.y:t.x>o.x)?{needsFlipping:!0}:null}function Nr(w){const{projectionContext:t,pitchedLabelPlaneMatrixInverse:o,symbol:d,fontSize:x,flip:S,keepUpright:A,glyphOffsetArray:R,dynamicLayoutVertexArray:F,aspectRatio:V,rotateToLine:q}=w,te=x/24,Q=d.lineOffsetX*te,ce=d.lineOffsetY*te;let _e;if(d.numGlyphs>1){const Ie=d.glyphStartIndex+d.numGlyphs,Oe=d.lineStartIndex,Le=d.lineStartIndex+d.lineLength,qe=dr(te,R,Q,ce,S,d,q,t);if(!qe)return{notEnoughRoom:!0};const nt=oi(qe.first.point.x,qe.first.point.y,t,o),He=oi(qe.last.point.x,qe.last.point.y,t,o);if(A&&!S){const rt=xr(d.writingMode,nt,He,V);if(rt)return rt}_e=[qe.first];for(let rt=d.glyphStartIndex+1;rt<Ie-1;rt++){const ot=za(te*R.getoffsetX(rt),Q,ce,S,d.segment,Oe,Le,t,q);if(!ot)return{notEnoughRoom:!0};_e.push(ot)}_e.push(qe.last)}else{if(A&&!S){const Oe=tn(t.tileAnchorPoint.x,t.tileAnchorPoint.y,t).point,Le=d.lineStartIndex+d.segment+1,qe=new s.P(t.lineVertexArray.getx(Le),t.lineVertexArray.gety(Le)),nt=tn(qe.x,qe.y,t),He=nt.signedDistanceFromCamera>0?nt.point:Wn(t.tileAnchorPoint,qe,Oe,1,t),rt=oi(Oe.x,Oe.y,t,o),ot=oi(He.x,He.y,t,o),Xe=xr(d.writingMode,rt,ot,V);if(Xe)return Xe}const Ie=za(te*R.getoffsetX(d.glyphStartIndex),Q,ce,S,d.segment,d.lineStartIndex,d.lineStartIndex+d.lineLength,t,q);if(!Ie||t.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};_e=[Ie]}for(const Ie of _e)s.aG(F,Ie.point,Ie.angle);return{}}function Wn(w,t,o,d,x){const S=w.add(w.sub(t)._unit()),A=tn(S.x,S.y,x).point,R=o.sub(A);return o.add(R._mult(d/R.mag()))}function mn(w,t,o){const d=t.projectionCache;if(d.projections[w])return d.projections[w];const x=new s.P(t.lineVertexArray.getx(w),t.lineVertexArray.gety(w)),S=tn(x.x,x.y,t);if(S.signedDistanceFromCamera>0)return d.projections[w]=S.point,d.anyProjectionOccluded=d.anyProjectionOccluded||S.isOccluded,S.point;const A=w-o.direction;return Wn(o.distanceFromAnchor===0?t.tileAnchorPoint:new s.P(t.lineVertexArray.getx(A),t.lineVertexArray.gety(A)),x,o.previousVertex,o.absOffsetX-o.distanceFromAnchor+1,t)}function tn(w,t,o){const d=w+o.translation[0],x=t+o.translation[1];let S;return o.pitchWithMap?(S=gt(d,x,o.pitchedLabelPlaneMatrix,o.getElevation),S.isOccluded=!1):(S=o.transform.projectTileCoordinates(d,x,o.unwrappedTileID,o.getElevation),S.point.x=(.5*S.point.x+.5)*o.width,S.point.y=(.5*-S.point.y+.5)*o.height),S}function oi(w,t,o,d){if(o.pitchWithMap){const x=[w,t,0,1];return s.aH(x,x,d),o.transform.projectTileCoordinates(x[0]/x[3],x[1]/x[3],o.unwrappedTileID,o.getElevation).point}return{x:w/o.width*2-1,y:1-t/o.height*2}}function xs(w,t,o){return o.transform.projectTileCoordinates(w,t,o.unwrappedTileID,o.getElevation)}function li(w,t,o){return w._unit()._perp()._mult(t*o)}function wi(w,t,o,d,x,S,A,R,F){if(R.projectionCache.offsets[w])return R.projectionCache.offsets[w];const V=o.add(t);if(w+F.direction<d||w+F.direction>=x)return R.projectionCache.offsets[w]=V,V;const q=mn(w+F.direction,R,F),te=li(q.sub(o),A,F.direction),Q=o.add(te),ce=q.add(te);return R.projectionCache.offsets[w]=s.aI(S,V,Q,ce)||V,R.projectionCache.offsets[w]}function za(w,t,o,d,x,S,A,R,F){const V=d?w-t:w+t;let q=V>0?1:-1,te=0;d&&(q*=-1,te=Math.PI),q<0&&(te+=Math.PI);let Q,ce=q>0?S+x:S+x+1;R.projectionCache.cachedAnchorPoint?Q=R.projectionCache.cachedAnchorPoint:(Q=tn(R.tileAnchorPoint.x,R.tileAnchorPoint.y,R).point,R.projectionCache.cachedAnchorPoint=Q);let _e,Ie,Oe=Q,Le=Q,qe=0,nt=0;const He=Math.abs(V),rt=[];let ot;for(;qe+nt<=He;){if(ce+=q,ce<S||ce>=A)return null;qe+=nt,Le=Oe,Ie=_e;const Pt={absOffsetX:He,direction:q,distanceFromAnchor:qe,previousVertex:Le};if(Oe=mn(ce,R,Pt),o===0)rt.push(Le),ot=Oe.sub(Le);else{let Et;const Ct=Oe.sub(Le);Et=Ct.mag()===0?li(mn(ce+q,R,Pt).sub(Oe),o,q):li(Ct,o,q),Ie||(Ie=Le.add(Et)),_e=wi(ce,Et,Oe,S,A,Ie,o,R,Pt),rt.push(Ie),ot=_e.sub(Ie)}nt=ot.mag()}const Xe=ot._mult((He-qe)/nt)._add(Ie||Le),ft=te+Math.atan2(Oe.y-Le.y,Oe.x-Le.x);return rt.push(Xe),{point:Xe,angle:F?ft:0,path:rt}}const Ti=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ss(w,t){for(let o=0;o<w;o++){const d=t.length;t.resize(d+4),t.float32.set(Ti,3*d)}}function os(w,t,o){const d=t[0],x=t[1];return w[0]=o[0]*d+o[4]*x+o[12],w[1]=o[1]*d+o[5]*x+o[13],w[3]=o[3]*d+o[7]*x+o[15],w}const Dn=100;class Zh{constructor(t,o=new mt(t.width+200,t.height+200,25),d=new mt(t.width+200,t.height+200,25)){this.transform=t,this.grid=o,this.ignoredGrid=d,this.pitchFactor=Math.cos(t.pitch*Math.PI/180)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+Dn,this.screenBottomBoundary=t.height+Dn,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,o,d,x,S,A,R,F,V,q,te,Q){const ce=this.projectAndGetPerspectiveRatio(t.anchorPointX+F[0],t.anchorPointY+F[1],S,q,Q),_e=d*ce.perspectiveRatio;let Ie;if(A||R)Ie=this._projectCollisionBox(t,_e,x,S,A,R,F,ce,q,te,Q);else{const ot=ce.x+(te?te.x*_e:0),Xe=ce.y+(te?te.y*_e:0);Ie={allPointsOccluded:!1,box:[ot+t.x1*_e,Xe+t.y1*_e,ot+t.x2*_e,Xe+t.y2*_e]}}const[Oe,Le,qe,nt]=Ie.box,He=A?Ie.allPointsOccluded:ce.isOccluded;let rt=He;return rt||(rt=ce.perspectiveRatio<this.perspectiveRatioCutoff),rt||(rt=!this.isInsideGrid(Oe,Le,qe,nt)),rt||o!=="always"&&this.grid.hitTest(Oe,Le,qe,nt,o,V)?{box:[Oe,Le,qe,nt],placeable:!1,offscreen:!1,occluded:He}:{box:[Oe,Le,qe,nt],placeable:!0,offscreen:this.isOffscreen(Oe,Le,qe,nt),occluded:He}}placeCollisionCircles(t,o,d,x,S,A,R,F,V,q,te,Q,ce,_e){const Ie=[],Oe=new s.P(o.anchorX,o.anchorY),Le=this.getPerspectiveRatio(Oe.x,Oe.y,A,_e),qe=(V?S*this.transform.getPitchedTextCorrection(o.anchorX,o.anchorY,A)/Le:S*Le)/s.aM,nt={getElevation:_e,pitchedLabelPlaneMatrix:R,lineVertexArray:d,pitchWithMap:V,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:Oe,unwrappedTileID:A,width:this.transform.width,height:this.transform.height,translation:ce},He=dr(qe,x,o.lineOffsetX*qe,o.lineOffsetY*qe,!1,o,!1,nt);let rt=!1,ot=!1,Xe=!0;if(He){const ft=.5*te*Le+Q,Pt=new s.P(-100,-100),Et=new s.P(this.screenRightBoundary,this.screenBottomBoundary),Ct=new Te,Dt=He.first,ur=He.last;let fr=[];for(let hn=Dt.path.length-1;hn>=1;hn--)fr.push(Dt.path[hn]);for(let hn=1;hn<ur.path.length;hn++)fr.push(ur.path[hn]);const tr=2.5*ft;if(V){const hn=this.projectPathToScreenSpace(fr,nt);fr=hn.some((Xn=>Xn.signedDistanceFromCamera<=0))?[]:hn.map((Xn=>Xn.point))}let br=[];if(fr.length>0){const hn=fr[0].clone(),Xn=fr[0].clone();for(let xa=1;xa<fr.length;xa++)hn.x=Math.min(hn.x,fr[xa].x),hn.y=Math.min(hn.y,fr[xa].y),Xn.x=Math.max(Xn.x,fr[xa].x),Xn.y=Math.max(Xn.y,fr[xa].y);br=hn.x>=Pt.x&&Xn.x<=Et.x&&hn.y>=Pt.y&&Xn.y<=Et.y?[fr]:Xn.x<Pt.x||hn.x>Et.x||Xn.y<Pt.y||hn.y>Et.y?[]:s.aJ([fr],Pt.x,Pt.y,Et.x,Et.y)}for(const hn of br){Ct.reset(hn,.25*ft);let Xn=0;Xn=Ct.length<=.5*ft?1:Math.ceil(Ct.paddedLength/tr)+1;for(let xa=0;xa<Xn;xa++){const ua=xa/Math.max(Xn-1,1),Ca=Ct.lerp(ua),ra=Ca.x+Dn,Ua=Ca.y+Dn;Ie.push(ra,Ua,ft,0);const Ma=ra-ft,Bi=Ua-ft,Ka=ra+ft,Ja=Ua+ft;if(Xe=Xe&&this.isOffscreen(Ma,Bi,Ka,Ja),ot=ot||this.isInsideGrid(Ma,Bi,Ka,Ja),t!=="always"&&this.grid.hitTestCircle(ra,Ua,ft,t,q)&&(rt=!0,!F))return{circles:[],offscreen:!1,collisionDetected:rt}}}}return{circles:!F&&rt||!ot||Le<this.perspectiveRatioCutoff?[]:Ie,offscreen:Xe,collisionDetected:rt}}projectPathToScreenSpace(t,o){const d=(function(x,S){const A=s.N();return s.aB(A,S.pitchedLabelPlaneMatrix),x.map((R=>{const F=gt(R.x,R.y,A,S.getElevation),V=S.transform.projectTileCoordinates(F.point.x,F.point.y,S.unwrappedTileID,S.getElevation);return V.point.x=(.5*V.point.x+.5)*S.width,V.point.y=(.5*-V.point.y+.5)*S.height,V}))})(t,o);return(function(x){let S=0,A=0,R=0,F=0;for(let V=0;V<x.length;V++)x[V].isOccluded?(R=V+1,F=0):(F++,F>A&&(A=F,S=R));return x.slice(S,S+A)})(d)}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const o=[],d=new s.aa;for(const te of t){const Q=new s.P(te.x+Dn,te.y+Dn);d.extend(Q),o.push(Q)}const{minX:x,minY:S,maxX:A,maxY:R}=d,F=this.grid.query(x,S,A,R).concat(this.ignoredGrid.query(x,S,A,R)),V={},q={};for(const te of F){const Q=te.key;if(V[Q.bucketInstanceId]===void 0&&(V[Q.bucketInstanceId]={}),V[Q.bucketInstanceId][Q.featureIndex])continue;const ce=[new s.P(te.x1,te.y1),new s.P(te.x2,te.y1),new s.P(te.x2,te.y2),new s.P(te.x1,te.y2)];s.aK(o,ce)&&(V[Q.bucketInstanceId][Q.featureIndex]=!0,q[Q.bucketInstanceId]===void 0&&(q[Q.bucketInstanceId]=[]),q[Q.bucketInstanceId].push(Q.featureIndex))}return q}insertCollisionBox(t,o,d,x,S,A){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:x,featureIndex:S,collisionGroupID:A,overlapMode:o},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,o,d,x,S,A){const R=d?this.ignoredGrid:this.grid,F={bucketInstanceId:x,featureIndex:S,collisionGroupID:A,overlapMode:o};for(let V=0;V<t.length;V+=4)R.insertCircle(F,t[V],t[V+1],t[V+2])}projectAndGetPerspectiveRatio(t,o,d,x,S){if(S){let A;x?(A=[t,o,x(t,o),1],s.aH(A,A,S)):(A=[t,o,0,1],os(A,A,S));const R=A[3];return{x:(A[0]/R+1)/2*this.transform.width+Dn,y:(-A[1]/R+1)/2*this.transform.height+Dn,perspectiveRatio:.5+this.transform.cameraToCenterDistance/R*.5,isOccluded:!1,signedDistanceFromCamera:R}}{const A=this.transform.projectTileCoordinates(t,o,d,x);return{x:(A.point.x+1)/2*this.transform.width+Dn,y:(1-A.point.y)/2*this.transform.height+Dn,perspectiveRatio:.5+this.transform.cameraToCenterDistance/A.signedDistanceFromCamera*.5,isOccluded:A.isOccluded,signedDistanceFromCamera:A.signedDistanceFromCamera}}}getPerspectiveRatio(t,o,d,x){const S=this.transform.projectTileCoordinates(t,o,d,x);return .5+this.transform.cameraToCenterDistance/S.signedDistanceFromCamera*.5}isOffscreen(t,o,d,x){return d<Dn||t>=this.screenRightBoundary||x<Dn||o>this.screenBottomBoundary}isInsideGrid(t,o,d,x){return d>=0&&t<this.gridRightBoundary&&x>=0&&o<this.gridBottomBoundary}getViewportMatrix(){const t=s.ar([]);return s.O(t,t,[-100,-100,0]),t}_projectCollisionBox(t,o,d,x,S,A,R,F,V,q,te){let Q=1,ce=0,_e=0,Ie=1;const Oe=t.anchorPointX+R[0],Le=t.anchorPointY+R[1];if(A&&!S){const fr=this.projectAndGetPerspectiveRatio(Oe+1,Le,x,V,te),tr=fr.x-F.x,br=Math.atan((fr.y-F.y)/tr)+(tr<0?Math.PI:0),hn=Math.sin(br),Xn=Math.cos(br);Q=Xn,ce=hn,_e=-hn,Ie=Xn}else if(!A&&S){const fr=Tt(this.transform);Q=fr.vecEast[0],ce=fr.vecEast[1],_e=fr.vecSouth[0],Ie=fr.vecSouth[1]}let qe=F.x,nt=F.y,He=o;S&&(qe=Oe,nt=Le,He=Math.pow(2,-(this.transform.zoom-d.overscaledZ)),He*=this.transform.getPitchedTextCorrection(Oe,Le,x),q||(He*=s.an(.5+F.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),q&&(qe+=Q*q.x*He+_e*q.y*He,nt+=ce*q.x*He+Ie*q.y*He);const rt=t.x1*He,ot=t.x2*He,Xe=(rt+ot)/2,ft=t.y1*He,Pt=t.y2*He,Et=(ft+Pt)/2,Ct=[{offsetX:rt,offsetY:ft},{offsetX:Xe,offsetY:ft},{offsetX:ot,offsetY:ft},{offsetX:ot,offsetY:Et},{offsetX:ot,offsetY:Pt},{offsetX:Xe,offsetY:Pt},{offsetX:rt,offsetY:Pt},{offsetX:rt,offsetY:Et}];let Dt=[];for(const{offsetX:fr,offsetY:tr}of Ct)Dt.push(new s.P(qe+Q*fr+_e*tr,nt+ce*fr+Ie*tr));let ur=!1;if(S){const fr=Dt.map((tr=>this.projectAndGetPerspectiveRatio(tr.x,tr.y,x,V,te)));ur=fr.some((tr=>!tr.isOccluded)),Dt=fr.map((tr=>new s.P(tr.x,tr.y)))}else ur=!0;return{box:s.aL(Dt),allPointsOccluded:!ur}}}class hu{constructor(t,o,d,x){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?o:-o))):x&&d?1:0,this.placed=d}isHidden(){return this.opacity===0&&!this.placed}}class Ki{constructor(t,o,d,x,S){this.text=new hu(t?t.text:null,o,d,S),this.icon=new hu(t?t.icon:null,o,x,S)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ih{constructor(t,o,d){this.text=t,this.icon=o,this.skipFade=d}}class Wo{constructor(t,o,d,x,S){this.bucketInstanceId=t,this.featureIndex=o,this.sourceLayerIndex=d,this.bucketIndex=x,this.tileID=S}}class Pf{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const o=++this.maxGroupID;this.collisionGroups[t]={ID:o,predicate:d=>d.collisionGroupID===o}}return this.collisionGroups[t]}}function gi(w,t,o,d,x){const{horizontalAlign:S,verticalAlign:A}=s.aS(w);return new s.P(-(S-.5)*t+d[0]*x,-(A-.5)*o+d[1]*x)}class fu{constructor(t,o,d,x,S){this.transform=t.clone(),this.terrain=o,this.collisionIndex=new Zh(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new Pf(x),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=S,S&&(S.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(t){const o=this.terrain;return o?(d,x)=>o.getElevation(t,d,x):null}getBucketParts(t,o,d,x){const S=d.getBucket(o),A=d.latestFeatureIndex;if(!S||!A||o.id!==S.layerIds[0])return;const R=d.collisionBoxArray,F=S.layers[0].layout,V=S.layers[0].paint,q=Math.pow(2,this.transform.zoom-d.tileID.overscaledZ),te=d.tileSize/s.a5,Q=d.tileID.toUnwrapped(),ce=F.get("text-rotation-alignment")==="map",_e=s.aN(d,1,this.transform.zoom),Ie=s.aO(this.collisionIndex.transform,d,V.get("text-translate"),V.get("text-translate-anchor")),Oe=s.aO(this.collisionIndex.transform,d,V.get("icon-translate"),V.get("icon-translate-anchor")),Le=Ut(ce,this.transform,_e);this.retainedQueryData[S.bucketInstanceId]=new Wo(S.bucketInstanceId,A,S.sourceLayerIndex,S.index,d.tileID);const qe={bucket:S,layout:F,translationText:Ie,translationIcon:Oe,unwrappedTileID:Q,pitchedLabelPlaneMatrix:Le,scale:q,textPixelRatio:te,holdingForFade:d.holdingForSymbolFade(),collisionBoxArray:R,partiallyEvaluatedTextSize:s.ay(S.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(S.sourceID)};if(x)for(const nt of S.sortKeyRanges){const{sortKey:He,symbolInstanceStart:rt,symbolInstanceEnd:ot}=nt;t.push({sortKey:He,symbolInstanceStart:rt,symbolInstanceEnd:ot,parameters:qe})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:S.symbolInstances.length,parameters:qe})}attemptAnchorPlacement(t,o,d,x,S,A,R,F,V,q,te,Q,ce,_e,Ie,Oe,Le,qe,nt,He){const rt=s.aP[t.textAnchor],ot=[t.textOffset0,t.textOffset1],Xe=gi(rt,d,x,ot,S),ft=this.collisionIndex.placeCollisionBox(o,Q,F,V,q,R,A,Oe,te.predicate,nt,Xe,He);if((!qe||this.collisionIndex.placeCollisionBox(qe,Q,F,V,q,R,A,Le,te.predicate,nt,Xe,He).placeable)&&ft.placeable){let Pt;if(this.prevPlacement&&this.prevPlacement.variableOffsets[ce.crossTileID]&&this.prevPlacement.placements[ce.crossTileID]&&this.prevPlacement.placements[ce.crossTileID].text&&(Pt=this.prevPlacement.variableOffsets[ce.crossTileID].anchor),ce.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[ce.crossTileID]={textOffset:ot,width:d,height:x,anchor:rt,textBoxScale:S,prevAnchor:Pt},this.markUsedJustification(_e,rt,ce,Ie),_e.allowVerticalPlacement&&(this.markUsedOrientation(_e,Ie,ce),this.placedOrientations[ce.crossTileID]=Ie),{shift:Xe,placedGlyphBoxes:ft}}}placeLayerBucketPart(t,o,d){const{bucket:x,layout:S,translationText:A,translationIcon:R,unwrappedTileID:F,pitchedLabelPlaneMatrix:V,textPixelRatio:q,holdingForFade:te,collisionBoxArray:Q,partiallyEvaluatedTextSize:ce,collisionGroup:_e}=t.parameters,Ie=S.get("text-optional"),Oe=S.get("icon-optional"),Le=s.aQ(S,"text-overlap","text-allow-overlap"),qe=Le==="always",nt=s.aQ(S,"icon-overlap","icon-allow-overlap"),He=nt==="always",rt=S.get("text-rotation-alignment")==="map",ot=S.get("text-pitch-alignment")==="map",Xe=S.get("icon-text-fit")!=="none",ft=S.get("symbol-z-order")==="viewport-y",Pt=qe&&(He||!x.hasIconData()||Oe),Et=He&&(qe||!x.hasTextData()||Ie);!x.collisionArrays&&Q&&x.deserializeCollisionBoxes(Q);const Ct=this.retainedQueryData[x.bucketInstanceId].tileID,Dt=this._getTerrainElevationFunc(Ct),ur=this.transform.getFastPathSimpleProjectionMatrix(Ct),fr=(tr,br,hn)=>{var Xn,xa;if(o[tr.crossTileID])return;if(te)return void(this.placements[tr.crossTileID]=new ih(!1,!1,!1));let ua=!1,Ca=!1,ra=!0,Ua=null,Ma={box:null,placeable:!1,offscreen:null,occluded:!1},Bi={placeable:!1},Ka=null,Ja=null,Ni=null,ql=0,Zl=0,hl=0;br.textFeatureIndex?ql=br.textFeatureIndex:tr.useRuntimeCollisionCircles&&(ql=tr.featureIndex),br.verticalTextFeatureIndex&&(Zl=br.verticalTextFeatureIndex);const Us=br.textBox;if(Us){const Vs=Qn=>{let ha=s.az.horizontal;if(x.allowVerticalPlacement&&!Qn&&this.prevPlacement){const hi=this.prevPlacement.placedOrientations[tr.crossTileID];hi&&(this.placedOrientations[tr.crossTileID]=hi,ha=hi,this.markUsedOrientation(x,ha,tr))}return ha},lo=(Qn,ha)=>{if(x.allowVerticalPlacement&&tr.numVerticalGlyphVertices>0&&br.verticalTextBox){for(const hi of x.writingModes)if(hi===s.az.vertical?(Ma=ha(),Bi=Ma):Ma=Qn(),Ma&&Ma.placeable)break}else Ma=Qn()},Ro=tr.textAnchorOffsetStartIndex,Io=tr.textAnchorOffsetEndIndex;if(Io===Ro){const Qn=(ha,hi)=>{const xi=this.collisionIndex.placeCollisionBox(ha,Le,q,Ct,F,ot,rt,A,_e.predicate,Dt,void 0,ur);return xi&&xi.placeable&&(this.markUsedOrientation(x,hi,tr),this.placedOrientations[tr.crossTileID]=hi),xi};lo((()=>Qn(Us,s.az.horizontal)),(()=>{const ha=br.verticalTextBox;return x.allowVerticalPlacement&&tr.numVerticalGlyphVertices>0&&ha?Qn(ha,s.az.vertical):{box:null,offscreen:null}})),Vs(Ma&&Ma.placeable)}else{let Qn=s.aP[(xa=(Xn=this.prevPlacement)===null||Xn===void 0?void 0:Xn.variableOffsets[tr.crossTileID])===null||xa===void 0?void 0:xa.anchor];const ha=(xi,Vf,Gf)=>{const Xc=xi.x2-xi.x1,Lp=xi.y2-xi.y1,Yc=tr.textBoxScale,Hf=Xe&&nt==="never"?Vf:null;let vc=null,bc=Le==="never"?1:2,dl="never";Qn&&bc++;for(let qf=0;qf<bc;qf++){for(let uf=Ro;uf<Io;uf++){const hf=x.textAnchorOffsets.get(uf);if(Qn&&hf.textAnchor!==Qn)continue;const ff=this.attemptAnchorPlacement(hf,xi,Xc,Lp,Yc,rt,ot,q,Ct,F,_e,dl,tr,x,Gf,A,R,Hf,Dt);if(ff&&(vc=ff.placedGlyphBoxes,vc&&vc.placeable))return ua=!0,Ua=ff.shift,vc}Qn?Qn=null:dl=Le}return d&&!vc&&(vc={box:this.collisionIndex.placeCollisionBox(Us,"always",q,Ct,F,ot,rt,A,_e.predicate,Dt,void 0,ur).box,offscreen:!1,placeable:!1,occluded:!1}),vc};lo((()=>ha(Us,br.iconBox,s.az.horizontal)),(()=>{const xi=br.verticalTextBox;return x.allowVerticalPlacement&&(!Ma||!Ma.placeable)&&tr.numVerticalGlyphVertices>0&&xi?ha(xi,br.verticalIconBox,s.az.vertical):{box:null,occluded:!0,offscreen:null}})),Ma&&(ua=Ma.placeable,ra=Ma.offscreen);const hi=Vs(Ma&&Ma.placeable);if(!ua&&this.prevPlacement){const xi=this.prevPlacement.variableOffsets[tr.crossTileID];xi&&(this.variableOffsets[tr.crossTileID]=xi,this.markUsedJustification(x,xi.anchor,tr,hi))}}}if(Ka=Ma,ua=Ka&&Ka.placeable,ra=Ka&&Ka.offscreen,tr.useRuntimeCollisionCircles&&tr.centerJustifiedTextSymbolIndex>=0){const Vs=x.text.placedSymbolArray.get(tr.centerJustifiedTextSymbolIndex),lo=s.aA(x.textSizeData,ce,Vs),Ro=S.get("text-padding");Ja=this.collisionIndex.placeCollisionCircles(Le,Vs,x.lineVertexArray,x.glyphOffsetArray,lo,F,V,d,ot,_e.predicate,tr.collisionCircleDiameter,Ro,A,Dt),Ja.circles.length&&Ja.collisionDetected&&!d&&s.w("Collisions detected, but collision boxes are not shown"),ua=qe||Ja.circles.length>0&&!Ja.collisionDetected,ra=ra&&Ja.offscreen}if(br.iconFeatureIndex&&(hl=br.iconFeatureIndex),br.iconBox){const Vs=lo=>this.collisionIndex.placeCollisionBox(lo,nt,q,Ct,F,ot,rt,R,_e.predicate,Dt,Xe&&Ua?Ua:void 0,ur);Bi&&Bi.placeable&&br.verticalIconBox?(Ni=Vs(br.verticalIconBox),Ca=Ni.placeable):(Ni=Vs(br.iconBox),Ca=Ni.placeable),ra=ra&&Ni.offscreen}const Fu=Ie||tr.numHorizontalGlyphVertices===0&&tr.numVerticalGlyphVertices===0,wh=Oe||tr.numIconVertices===0;Fu||wh?wh?Fu||(Ca=Ca&&ua):ua=Ca&&ua:Ca=ua=Ca&&ua;const fl=Ca&&Ni.placeable;if(ua&&Ka.placeable&&this.collisionIndex.insertCollisionBox(Ka.box,Le,S.get("text-ignore-placement"),x.bucketInstanceId,Bi&&Bi.placeable&&Zl?Zl:ql,_e.ID),fl&&this.collisionIndex.insertCollisionBox(Ni.box,nt,S.get("icon-ignore-placement"),x.bucketInstanceId,hl,_e.ID),Ja&&ua&&this.collisionIndex.insertCollisionCircles(Ja.circles,Le,S.get("text-ignore-placement"),x.bucketInstanceId,ql,_e.ID),d&&this.storeCollisionData(x.bucketInstanceId,hn,br,Ka,Ni,Ja),tr.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(x.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[tr.crossTileID]=new ih((ua||Pt)&&!Ka?.occluded,(Ca||Et)&&!Ni?.occluded,ra||x.justReloaded),o[tr.crossTileID]=!0};if(ft){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const tr=x.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let br=tr.length-1;br>=0;--br){const hn=tr[br];fr(x.symbolInstances.get(hn),x.collisionArrays[hn],hn)}}else for(let tr=t.symbolInstanceStart;tr<t.symbolInstanceEnd;tr++)fr(x.symbolInstances.get(tr),x.collisionArrays[tr],tr);x.justReloaded=!1}storeCollisionData(t,o,d,x,S,A){if(d.textBox||d.iconBox){let R,F;this.collisionBoxArrays.has(t)?R=this.collisionBoxArrays.get(t):(R=new Map,this.collisionBoxArrays.set(t,R)),R.has(o)?F=R.get(o):(F={text:null,icon:null},R.set(o,F)),d.textBox&&(F.text=x.box),d.iconBox&&(F.icon=S.box)}if(A){let R=this.collisionCircleArrays[t];R===void 0&&(R=this.collisionCircleArrays[t]=[]);for(let F=0;F<A.circles.length;F+=4)R.push(A.circles[F+0]-Dn),R.push(A.circles[F+1]-Dn),R.push(A.circles[F+2]),R.push(A.collisionDetected?1:0)}}markUsedJustification(t,o,d,x){let S;S=x===s.az.vertical?d.verticalPlacedTextSymbolIndex:{left:d.leftJustifiedTextSymbolIndex,center:d.centerJustifiedTextSymbolIndex,right:d.rightJustifiedTextSymbolIndex}[s.aR(o)];const A=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex,d.verticalPlacedTextSymbolIndex];for(const R of A)R>=0&&(t.text.placedSymbolArray.get(R).crossTileID=S>=0&&R!==S?0:d.crossTileID)}markUsedOrientation(t,o,d){const x=o===s.az.horizontal||o===s.az.horizontalOnly?o:0,S=o===s.az.vertical?o:0,A=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex];for(const R of A)t.text.placedSymbolArray.get(R).placedOrientation=x;d.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(d.verticalPlacedTextSymbolIndex).placedOrientation=S)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const o=this.prevPlacement;let d=!1;this.prevZoomAdjustment=o?o.zoomAdjustment(this.transform.zoom):0;const x=o?o.symbolFadeChange(t):1,S=o?o.opacities:{},A=o?o.variableOffsets:{},R=o?o.placedOrientations:{};for(const F in this.placements){const V=this.placements[F],q=S[F];q?(this.opacities[F]=new Ki(q,x,V.text,V.icon),d=d||V.text!==q.text.placed||V.icon!==q.icon.placed):(this.opacities[F]=new Ki(null,x,V.text,V.icon,V.skipFade),d=d||V.text||V.icon)}for(const F in S){const V=S[F];if(!this.opacities[F]){const q=new Ki(V,x,!1,!1);q.isHidden()||(this.opacities[F]=q,d=d||V.text.placed||V.icon.placed)}}for(const F in A)this.variableOffsets[F]||!this.opacities[F]||this.opacities[F].isHidden()||(this.variableOffsets[F]=A[F]);for(const F in R)this.placedOrientations[F]||!this.opacities[F]||this.opacities[F].isHidden()||(this.placedOrientations[F]=R[F]);if(o&&o.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");d?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=o?o.lastPlacementChangeTime:t)}updateLayerOpacities(t,o){const d={};for(const x of o){const S=x.getBucket(t);S&&x.latestFeatureIndex&&t.id===S.layerIds[0]&&this.updateBucketOpacities(S,x.tileID,d,x.collisionBoxArray)}}updateBucketOpacities(t,o,d,x){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const S=t.layers[0],A=S.layout,R=new Ki(null,0,!1,!1,!0),F=A.get("text-allow-overlap"),V=A.get("icon-allow-overlap"),q=S._unevaluatedLayout.hasValue("text-variable-anchor")||S._unevaluatedLayout.hasValue("text-variable-anchor-offset"),te=A.get("text-rotation-alignment")==="map",Q=A.get("text-pitch-alignment")==="map",ce=A.get("icon-text-fit")!=="none",_e=new Ki(null,0,F&&(V||!t.hasIconData()||A.get("icon-optional")),V&&(F||!t.hasTextData()||A.get("text-optional")),!0);!t.collisionArrays&&x&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(x);const Ie=(Le,qe,nt)=>{for(let He=0;He<qe/4;He++)Le.opacityVertexArray.emplaceBack(nt);Le.hasVisibleVertices=Le.hasVisibleVertices||nt!==yo},Oe=this.collisionBoxArrays.get(t.bucketInstanceId);for(let Le=0;Le<t.symbolInstances.length;Le++){const qe=t.symbolInstances.get(Le),{numHorizontalGlyphVertices:nt,numVerticalGlyphVertices:He,crossTileID:rt}=qe;let ot=this.opacities[rt];d[rt]?ot=R:ot||(ot=_e,this.opacities[rt]=ot),d[rt]=!0;const Xe=qe.numIconVertices>0,ft=this.placedOrientations[qe.crossTileID],Pt=ft===s.az.vertical,Et=ft===s.az.horizontal||ft===s.az.horizontalOnly;if(nt>0||He>0){const Dt=Pc(ot.text);Ie(t.text,nt,Pt?yo:Dt),Ie(t.text,He,Et?yo:Dt);const ur=ot.text.isHidden();[qe.rightJustifiedTextSymbolIndex,qe.centerJustifiedTextSymbolIndex,qe.leftJustifiedTextSymbolIndex].forEach((br=>{br>=0&&(t.text.placedSymbolArray.get(br).hidden=ur||Pt?1:0)})),qe.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(qe.verticalPlacedTextSymbolIndex).hidden=ur||Et?1:0);const fr=this.variableOffsets[qe.crossTileID];fr&&this.markUsedJustification(t,fr.anchor,qe,ft);const tr=this.placedOrientations[qe.crossTileID];tr&&(this.markUsedJustification(t,"left",qe,tr),this.markUsedOrientation(t,tr,qe))}if(Xe){const Dt=Pc(ot.icon),ur=!(ce&&qe.verticalPlacedIconSymbolIndex&&Pt);qe.placedIconSymbolIndex>=0&&(Ie(t.icon,qe.numIconVertices,ur?Dt:yo),t.icon.placedSymbolArray.get(qe.placedIconSymbolIndex).hidden=ot.icon.isHidden()),qe.verticalPlacedIconSymbolIndex>=0&&(Ie(t.icon,qe.numVerticalIconVertices,ur?yo:Dt),t.icon.placedSymbolArray.get(qe.verticalPlacedIconSymbolIndex).hidden=ot.icon.isHidden())}const Ct=Oe&&Oe.has(Le)?Oe.get(Le):{text:null,icon:null};if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const Dt=t.collisionArrays[Le];if(Dt){let ur=new s.P(0,0);if(Dt.textBox||Dt.verticalTextBox){let fr=!0;if(q){const tr=this.variableOffsets[rt];tr?(ur=gi(tr.anchor,tr.width,tr.height,tr.textOffset,tr.textBoxScale),te&&ur._rotate(Q?-this.transform.bearingInRadians:this.transform.bearingInRadians)):fr=!1}if(Dt.textBox||Dt.verticalTextBox){let tr;Dt.textBox&&(tr=Pt),Dt.verticalTextBox&&(tr=Et),Sl(t.textCollisionBox.collisionVertexArray,ot.text.placed,!fr||tr,Ct.text,ur.x,ur.y)}}if(Dt.iconBox||Dt.verticalIconBox){const fr=!!(!Et&&Dt.verticalIconBox);let tr;Dt.iconBox&&(tr=fr),Dt.verticalIconBox&&(tr=!fr),Sl(t.iconCollisionBox.collisionVertexArray,ot.icon.placed,tr,Ct.icon,ce?ur.x:0,ce?ur.y:0)}}}}if(t.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);t.bucketInstanceId in this.collisionCircleArrays&&(t.collisionCircleArray=this.collisionCircleArrays[t.bucketInstanceId],delete this.collisionCircleArrays[t.bucketInstanceId])}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,o){const d=this.zoomAtLastRecencyCheck===o?1-this.zoomAdjustment(o):1;return this.zoomAtLastRecencyCheck=o,this.commitTime+this.fadeDuration*d>t}setStale(){this.stale=!0}}function Sl(w,t,o,d,x,S){d&&d.length!==0||(d=[0,0,0,0]);const A=d[0]-Dn,R=d[1]-Dn,F=d[2]-Dn,V=d[3]-Dn;w.emplaceBack(t?1:0,o?1:0,x||0,S||0,A,R),w.emplaceBack(t?1:0,o?1:0,x||0,S||0,F,R),w.emplaceBack(t?1:0,o?1:0,x||0,S||0,F,V),w.emplaceBack(t?1:0,o?1:0,x||0,S||0,A,V)}const du=Math.pow(2,25),Ms=Math.pow(2,24),Wh=Math.pow(2,17),Jl=Math.pow(2,16),Ks=Math.pow(2,9),sh=Math.pow(2,8),$o=Math.pow(2,1);function Pc(w){if(w.opacity===0&&!w.placed)return 0;if(w.opacity===1&&w.placed)return 4294967295;const t=w.placed?1:0,o=Math.floor(127*w.opacity);return o*du+t*Ms+o*Wh+t*Jl+o*Ks+t*sh+o*$o+t}const yo=0;class Js{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,o,d,x,S){const A=this._bucketParts;for(;this._currentTileIndex<t.length;)if(o.getBucketParts(A,x,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,S())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,A.sort(((R,F)=>R.sortKey-F.sortKey)));this._currentPartIndex<A.length;)if(o.placeLayerBucketPart(A[this._currentPartIndex],this._seenCrossTileIDs,d),this._currentPartIndex++,S())return!0;return!1}}class Ql{constructor(t,o,d,x,S,A,R,F){this.placement=new fu(t,o,A,R,F),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=x,this._showCollisionBoxes=S,this._done=!1}isDone(){return this._done}continuePlacement(t,o,d){const x=z(),S=()=>!this._forceFullPlacement&&z()-x>2;for(;this._currentPlacementIndex>=0;){const A=o[t[this._currentPlacementIndex]],R=this.placement.collisionIndex.transform.zoom;if(A.type==="symbol"&&(!A.minzoom||A.minzoom<=R)&&(!A.maxzoom||A.maxzoom>R)){if(this._inProgressLayer||(this._inProgressLayer=new Js(A)),this._inProgressLayer.continuePlacement(d[A.source],this.placement,this._showCollisionBoxes,A,S))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const fn=512/s.a5/2;class Ds{constructor(t,o,d){this.tileID=t,this.bucketInstanceId=d,this._symbolsByKey={};const x=new Map;for(let S=0;S<o.length;S++){const A=o.get(S),R=A.key,F=x.get(R);F?F.push(A):x.set(R,[A])}for(const[S,A]of x){const R={positions:A.map((F=>({x:Math.floor(F.anchorX*fn),y:Math.floor(F.anchorY*fn)}))),crossTileIDs:A.map((F=>F.crossTileID))};if(R.positions.length>128){const F=new s.aT(R.positions.length,16,Uint16Array);for(const{x:V,y:q}of R.positions)F.add(V,q);F.finish(),delete R.positions,R.index=F}this._symbolsByKey[S]=R}}getScaledCoordinates(t,o){const{x:d,y:x,z:S}=this.tileID.canonical,{x:A,y:R,z:F}=o.canonical,V=fn/Math.pow(2,F-S),q=(R*s.a5+t.anchorY)*V,te=x*s.a5*fn;return{x:Math.floor((A*s.a5+t.anchorX)*V-d*s.a5*fn),y:Math.floor(q-te)}}findMatches(t,o,d){const x=this.tileID.canonical.z<o.canonical.z?1:Math.pow(2,this.tileID.canonical.z-o.canonical.z);for(let S=0;S<t.length;S++){const A=t.get(S);if(A.crossTileID)continue;const R=this._symbolsByKey[A.key];if(!R)continue;const F=this.getScaledCoordinates(A,o);if(R.index){const V=R.index.range(F.x-x,F.y-x,F.x+x,F.y+x).sort();for(const q of V){const te=R.crossTileIDs[q];if(!d[te]){d[te]=!0,A.crossTileID=te;break}}}else if(R.positions)for(let V=0;V<R.positions.length;V++){const q=R.positions[V],te=R.crossTileIDs[V];if(Math.abs(q.x-F.x)<=x&&Math.abs(q.y-F.y)<=x&&!d[te]){d[te]=!0,A.crossTileID=te;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:t})=>t))}}class ec{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class pu{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const o=Math.round((t-this.lng)/360);if(o!==0)for(const d in this.indexes){const x=this.indexes[d],S={};for(const A in x){const R=x[A];R.tileID=R.tileID.unwrapTo(R.tileID.wrap+o),S[R.tileID.key]=R}this.indexes[d]=S}this.lng=t}addBucket(t,o,d){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===o.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let S=0;S<o.symbolInstances.length;S++)o.symbolInstances.get(S).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const x=this.usedCrossTileIDs[t.overscaledZ];for(const S in this.indexes){const A=this.indexes[S];if(Number(S)>t.overscaledZ)for(const R in A){const F=A[R];F.tileID.isChildOf(t)&&F.findMatches(o.symbolInstances,t,x)}else{const R=A[t.scaledTo(Number(S)).key];R&&R.findMatches(o.symbolInstances,t,x)}}for(let S=0;S<o.symbolInstances.length;S++){const A=o.symbolInstances.get(S);A.crossTileID||(A.crossTileID=d.generate(),x[A.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Ds(t,o.symbolInstances,o.bucketInstanceId),!0}removeBucketCrossTileIDs(t,o){for(const d of o.getCrossTileIDsLists())for(const x of d)delete this.usedCrossTileIDs[t][x]}removeStaleBuckets(t){let o=!1;for(const d in this.indexes){const x=this.indexes[d];for(const S in x)t[x[S].bucketInstanceId]||(this.removeBucketCrossTileIDs(d,x[S]),delete x[S],o=!0)}return o}}class ba{constructor(){this.layerIndexes={},this.crossTileIDs=new ec,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,o,d){let x=this.layerIndexes[t.id];x===void 0&&(x=this.layerIndexes[t.id]=new pu);let S=!1;const A={};x.handleWrapJump(d);for(const R of o){const F=R.getBucket(t);F&&t.id===F.layerIds[0]&&(F.bucketInstanceId||(F.bucketInstanceId=++this.maxBucketInstanceId),x.addBucket(R.tileID,F,this.crossTileIDs)&&(S=!0),A[F.bucketInstanceId]=!0)}return x.removeStaleBuckets(A)&&(S=!0),S}pruneUnusedLayers(t){const o={};t.forEach((d=>{o[d]=!0}));for(const d in this.layerIndexes)o[d]||delete this.layerIndexes[d]}}var Ha="void main() {fragColor=vec4(1.0);}";const wa={prelude:Qr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Qr("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Qr("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Qr(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Qr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Qr(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Qr(Ha,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Qr(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Qr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Qr("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Qr("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:Qr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:Qr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Qr(Ha,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Qr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Qr(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Qr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Qr(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Qr(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Qr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Qr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Qr(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Qr(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Qr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Qr(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Qr(`uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0/u_device_pixel_ratio)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),lineGradientSDF:Qr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform sampler2D u_image_dash;uniform float u_mix;uniform lowp float u_lineatlas_width;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);float sdfdist_a=texture(u_image_dash,v_tex_a).a;float sdfdist_b=texture(u_image_dash,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);float dash_alpha=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*dash_alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;out vec2 v_tex_a;out vec2 v_tex_b;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;float texel_height=1.0/u_image_height;float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),raster:Qr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Qr(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Qr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Qr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Qr("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Qr("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Qr("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Qr("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Qr(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Qr("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Qr(w,t){const o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,d=t.match(/in ([\w]+) ([\w]+)/g),x=w.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),A=S?S.concat(x):x,R={};return{fragmentSource:w=w.replace(o,((F,V,q,te,Q)=>(R[Q]=!0,V==="define"?`
#ifndef HAS_UNIFORM_u_${Q}
in ${q} ${te} ${Q};
#else
uniform ${q} ${te} u_${Q};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Q}
    ${q} ${te} ${Q} = u_${Q};
#endif
`))),vertexSource:t=t.replace(o,((F,V,q,te,Q)=>{const ce=te==="float"?"vec2":"vec4",_e=Q.match(/color/)?"color":ce;return R[Q]?V==="define"?`
#ifndef HAS_UNIFORM_u_${Q}
uniform lowp float u_${Q}_t;
in ${q} ${ce} a_${Q};
out ${q} ${te} ${Q};
#else
uniform ${q} ${te} u_${Q};
#endif
`:_e==="vec4"?`
#ifndef HAS_UNIFORM_u_${Q}
    ${Q} = a_${Q};
#else
    ${q} ${te} ${Q} = u_${Q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Q}
    ${Q} = unpack_mix_${_e}(a_${Q}, u_${Q}_t);
#else
    ${q} ${te} ${Q} = u_${Q};
#endif
`:V==="define"?`
#ifndef HAS_UNIFORM_u_${Q}
uniform lowp float u_${Q}_t;
in ${q} ${ce} a_${Q};
#else
uniform ${q} ${te} u_${Q};
#endif
`:_e==="vec4"?`
#ifndef HAS_UNIFORM_u_${Q}
    ${q} ${te} ${Q} = a_${Q};
#else
    ${q} ${te} ${Q} = u_${Q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Q}
    ${q} ${te} ${Q} = unpack_mix_${_e}(a_${Q}, u_${Q}_t);
#else
    ${q} ${te} ${Q} = u_${Q};
#endif
`})),staticAttributes:d,staticUniforms:A}}class Yn{constructor(t,o,d){this.vertexBuffer=t,this.indexBuffer=o,this.segments=d}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var ys=s.aU([{name:"a_pos",type:"Int16",components:2}]);const zn="#define PROJECTION_MERCATOR",Oa="mercator";class la{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Oa}get shaderDefine(){return zn}get shaderPreludeCode(){return wa.projectionMercator}get vertexShaderPreludeCode(){return wa.projectionMercator.vertexSource}get subdivisionGranularity(){return s.aV.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(t){}getMeshFromTileID(t,o,d,x,S){if(this._cachedMesh)return this._cachedMesh;const A=new s.aW;A.emplaceBack(0,0),A.emplaceBack(s.a5,0),A.emplaceBack(0,s.a5),A.emplaceBack(s.a5,s.a5);const R=t.createVertexBuffer(A,ys.members),F=s.aX.simpleSegment(0,0,4,2),V=new s.aY;V.emplaceBack(1,0,2),V.emplaceBack(1,2,3);const q=t.createIndexBuffer(V);return this._cachedMesh=new Yn(R,q,F),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(t){}}class _a{constructor(t=0,o=0,d=0,x=0){if(isNaN(t)||t<0||isNaN(o)||o<0||isNaN(d)||d<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=o,this.left=d,this.right=x}interpolate(t,o,d){return o.top!=null&&t.top!=null&&(this.top=s.G.number(t.top,o.top,d)),o.bottom!=null&&t.bottom!=null&&(this.bottom=s.G.number(t.bottom,o.bottom,d)),o.left!=null&&t.left!=null&&(this.left=s.G.number(t.left,o.left,d)),o.right!=null&&t.right!=null&&(this.right=s.G.number(t.right,o.right,d)),this}getCenter(t,o){const d=s.an((this.left+t-this.right)/2,0,t),x=s.an((this.top+o-this.bottom)/2,0,o);return new s.P(d,x)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new _a(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function vo(w,t){if(!w.renderWorldCopies||w.lngRange)return;const o=t.lng-w.center.lng;t.lng+=o>180?-360:o<-180?360:0}function Rn(w){return Math.max(0,Math.floor(w))}class Si{constructor(t,o){var d;this.applyConstrain=(x,S)=>this._constrainOverride!==null?this._constrainOverride(x,S):this._callbacks.defaultConstrain(x,S),this._callbacks=t,this._tileSize=512,this._renderWorldCopies=o?.renderWorldCopies===void 0||!!o?.renderWorldCopies,this._minZoom=o?.minZoom||0,this._maxZoom=o?.maxZoom||22,this._minPitch=o?.minPitch==null?0:o?.minPitch,this._maxPitch=o?.maxPitch==null?60:o?.maxPitch,this._constrainOverride=(d=o?.constrainOverride)!==null&&d!==void 0?d:null,this.setMaxBounds(),this._width=0,this._height=0,this._center=new s.V(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Rn(this._zoom),this._scale=s.aq(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new _a,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(t,o,d){this._constrainOverride=t.constrainOverride,this._latRange=t.latRange,this._lngRange=t.lngRange,this._width=t.width,this._height=t.height,this._center=t.center,this._elevation=t.elevation,this._minElevationForCurrentTile=t.minElevationForCurrentTile,this._zoom=t.zoom,this._tileZoom=Rn(this._zoom),this._scale=s.aq(this._zoom),this._bearingInRadians=t.bearingInRadians,this._fovInRadians=t.fovInRadians,this._pitchInRadians=t.pitchInRadians,this._rollInRadians=t.rollInRadians,this._unmodified=t.unmodified,this._edgeInsets=new _a(t.padding.top,t.padding.bottom,t.padding.left,t.padding.right),this._minZoom=t.minZoom,this._maxZoom=t.maxZoom,this._minPitch=t.minPitch,this._maxPitch=t.maxPitch,this._renderWorldCopies=t.renderWorldCopies,this._cameraToCenterDistance=t.cameraToCenterDistance,this._nearZ=t.nearZ,this._farZ=t.farZ,this._autoCalculateNearFarZ=!d&&t.autoCalculateNearFarZ,o&&this.constrainInternal(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(t){this._minElevationForCurrentTile=t}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(t){this._minZoom!==t&&(this._minZoom=t,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(t){this._minPitch!==t&&(this._minPitch=t,this.setPitch(Math.max(this.pitch,t)))}get maxPitch(){return this._maxPitch}setMaxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.setPitch(Math.min(this.pitch,t)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get constrainOverride(){return this._constrainOverride}setConstrainOverride(t){t===void 0&&(t=null),this._constrainOverride!==t&&(this._constrainOverride=t,this.constrainInternal(),this._calcMatrices())}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(t){const o=s.W(t,-180,180)*Math.PI/180;var d,x,S,A,R,F,V,q,te;this._bearingInRadians!==o&&(this._unmodified=!1,this._bearingInRadians=o,this._calcMatrices(),this._rotationMatrix=M(),d=this._rotationMatrix,S=-this._bearingInRadians,A=(x=this._rotationMatrix)[0],R=x[1],F=x[2],V=x[3],q=Math.sin(S),te=Math.cos(S),d[0]=A*te+F*q,d[1]=R*te+V*q,d[2]=A*-q+F*te,d[3]=R*-q+V*te)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(t){const o=s.an(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==o&&(this._unmodified=!1,this._pitchInRadians=o,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(t){const o=t/180*Math.PI;this._rollInRadians!==o&&(this._unmodified=!1,this._rollInRadians=o,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return s.aZ(this._fovInRadians)}setFov(t){t=s.an(t,.1,150),this.fov!==t&&(this._unmodified=!1,this._fovInRadians=s.ap(t),this._calcMatrices())}get zoom(){return this._zoom}setZoom(t){const o=this.applyConstrain(this._center,t).zoom;this._zoom!==o&&(this._unmodified=!1,this._zoom=o,this._tileZoom=Math.max(0,Math.floor(o)),this._scale=s.aq(o),this.constrainInternal(),this._calcMatrices())}get center(){return this._center}setCenter(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this.constrainInternal(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(t){t!==this._elevation&&(this._elevation=t,this.constrainInternal(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(t,o){this._autoCalculateNearFarZ=!1,this._nearZ=t,this._farZ=o,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,o,d){this._unmodified=!1,this._edgeInsets.interpolate(t,o,d),this.constrainInternal(),this._calcMatrices()}resize(t,o,d=!0){this._width=t,this._height=o,d&&this.constrainInternal(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Ee([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(t){t?(this._lngRange=[t.getWest(),t.getEast()],this._latRange=[t.getSouth(),t.getNorth()],this.constrainInternal()):(this._lngRange=null,this._latRange=[-s.ao,s.ao])}getCameraQueryGeometry(t,o){if(o.length===1)return[o[0],t];{const{minX:d,minY:x,maxX:S,maxY:A}=s.aa.fromPoints(o).extend(t);return[new s.P(d,x),new s.P(S,x),new s.P(S,A),new s.P(d,A),new s.P(d,x)]}}constrainInternal(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const t=this._unmodified,{center:o,zoom:d}=this.applyConstrain(this.center,this.zoom);this.setCenter(o),this.setZoom(d),this._unmodified=t,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let t=s.ar(new Float64Array(16));s.Q(t,t,[this._width/2,-this._height/2,1]),s.O(t,t,[1,-1,0]),this._clipSpaceToPixelsMatrix=t,t=s.ar(new Float64Array(16)),s.Q(t,t,[1,-1,1]),s.O(t,t,[-1,-1,0]),s.Q(t,t,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=t,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(t,o,d,x){const S=d!==void 0?d:this.bearing,A=x=x!==void 0?x:this.pitch,{distanceToCenter:R,clampedElevation:F}=this._distanceToCenterFromAltElevationPitch(o,this.elevation,A),{x:V,y:q}=Ln(A,S),te=s.a9.fromLngLat(t,o);let Q,ce,_e=s.a_(1,te.y),Ie=0;do{if(Ie+=1,Ie>10)break;ce=R/_e,Q=new s.a9(te.x+V*ce,te.y+q*ce),_e=1/Q.meterInMercatorCoordinateUnits()}while(Math.abs(R-ce*_e)>1e-12);return{center:Q.toLngLat(),elevation:F,zoom:s.at(this.height/2/Math.tan(this.fovInRadians/2)/ce/this.tileSize)}}recalculateZoomAndCenter(t){if(this.elevation-t==0)return;const o=1/this.worldSize,d=s.as(1,this.center.lat)*this.worldSize,x=s.a9.fromLngLat(this.center,this.elevation),S=x.x/o,A=x.y/o,R=x.z/o,F=this.pitch,V=this.bearing,{x:q,y:te,z:Q}=Ln(F,V),ce=this.cameraToCenterDistance,_e=S+ce*-q,Ie=A+ce*-te,Oe=R+ce*Q,{distanceToCenter:Le,clampedElevation:qe}=this._distanceToCenterFromAltElevationPitch(Oe/d,t,F),nt=Le*d,He=new s.a9((_e+q*nt)*o,(Ie+te*nt)*o,0).toLngLat(),rt=s.as(1,He.lat),ot=s.at(this.height/2/Math.tan(this.fovInRadians/2)/Le/rt/this.tileSize);this._elevation=qe,this._center=He,this.setZoom(ot)}_distanceToCenterFromAltElevationPitch(t,o,d){const x=-Math.cos(s.ap(d)),S=t-o;let A,R=o;return x*S>=0||Math.abs(x)<.1?(A=1e4,R=t+A*x):A=-S/x,{distanceToCenter:A,clampedElevation:R}}getCameraPoint(){const t=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.P(t*Math.sin(this.rollInRadians),t*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const t=s.as(1,this.center.lat)*this.worldSize;return xt(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/t).toLngLat()}getMercatorTileCoordinates(t){if(!t)return[0,0,1,1];const o=t.canonical.z>=0?1<<t.canonical.z:Math.pow(2,t.canonical.z);return[t.canonical.x/o,t.canonical.y/o,1/o/s.a5,1/o/s.a5]}}class ri{constructor(t,o){this.min=t,this.max=o,this.center=s.a$([],s.b0([],this.min,this.max),.5)}quadrant(t){const o=[t%2==0,t<2],d=s.b1(this.min),x=s.b1(this.max);for(let S=0;S<o.length;S++)d[S]=o[S]?this.min[S]:this.center[S],x[S]=o[S]?this.center[S]:this.max[S];return x[2]=this.max[2],new ri(d,x)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersectsFrustum(t){let o=!0;for(let d=0;d<t.planes.length;d++){const x=this.intersectsPlane(t.planes[d]);if(x===0)return 0;x===1&&(o=!1)}return o?2:t.aabb.min[0]>this.max[0]||t.aabb.min[1]>this.max[1]||t.aabb.min[2]>this.max[2]||t.aabb.max[0]<this.min[0]||t.aabb.max[1]<this.min[1]||t.aabb.max[2]<this.min[2]?0:1}intersectsPlane(t){let o=t[3],d=t[3];for(let x=0;x<3;x++)t[x]>0?(o+=t[x]*this.min[x],d+=t[x]*this.max[x]):(d+=t[x]*this.min[x],o+=t[x]*this.max[x]);return o>=0?2:d<0?0:1}}class Qs{distanceToTile2d(t,o,d,x){const S=x.distanceX([t,o]),A=x.distanceY([t,o]);return Math.hypot(S,A)}getWrap(t,o,d){return d}getTileBoundingVolume(t,o,d,x){var S,A;let R=0,F=0;if(x?.terrain){const q=new s.a2(t.z,o,t.z,t.x,t.y),te=x.terrain.getMinMaxElevation(q);R=(S=te.minElevation)!==null&&S!==void 0?S:Math.min(0,d),F=(A=te.maxElevation)!==null&&A!==void 0?A:Math.max(0,d)}const V=1<<t.z;return new ri([o+t.x/V,t.y/V,R],[o+(t.x+1)/V,(t.y+1)/V,F])}allowVariableZoom(t,o){const d=t.fov*(Math.abs(Math.cos(t.rollInRadians))*t.height+Math.abs(Math.sin(t.rollInRadians))*t.width)/t.height,x=s.an(78.5-d/2,0,60);return!!o.terrain||t.pitch>x}allowWorldCopies(){return!0}prepareNextFrame(){}}class Ri{constructor(t,o,d){this.points=t,this.planes=o,this.aabb=d}static fromInvProjectionMatrix(t,o=1,d=0,x,S){const A=S?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],R=Math.pow(2,d),F=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((Q=>(function(ce,_e,Ie,Oe){const Le=s.aH([],ce,_e),qe=1/Le[3]/Ie*Oe;return s.b6(Le,Le,[qe,qe,1/Le[3],qe])})(Q,t,o,R)));x&&(function(Q,ce,_e,Ie){const Oe=Ie?4:0,Le=Ie?0:4;let qe=0;const nt=[],He=[];for(let Xe=0;Xe<4;Xe++){const ft=s.b2([],Q[Xe+Le],Q[Xe+Oe]),Pt=s.b7(ft);s.a$(ft,ft,1/Pt),nt.push(Pt),He.push(ft)}for(let Xe=0;Xe<4;Xe++){const ft=s.b8(Q[Xe+Oe],He[Xe],_e);qe=ft!==null&&ft>=0?Math.max(qe,ft):Math.max(qe,nt[Xe])}const rt=(function(Xe,ft){const Pt=s.b2([],Xe[ft[0]],Xe[ft[1]]),Et=s.b2([],Xe[ft[2]],Xe[ft[1]]),Ct=[0,0,0,0];return s.b3(Ct,s.b4([],Pt,Et)),Ct[3]=-s.b5(Ct,Xe[ft[0]]),Ct})(Q,ce),ot=(function(Xe,ft){const Pt=s.b9(Xe),Et=s.ba([],Xe,1/Pt),Ct=s.b2([],ft,s.a$([],Et,s.b5(ft,Et))),Dt=s.b9(Ct);if(Dt>0){const ur=Math.sqrt(1-Et[3]*Et[3]),fr=s.a$([],Et,-Et[3]),tr=s.b0([],fr,s.a$([],Ct,ur/Dt));return s.bb(ft,tr)}return null})(_e,rt);if(ot!==null){const Xe=ot/s.b5(He[0],rt);qe=Math.min(qe,Xe)}for(let Xe=0;Xe<4;Xe++){const ft=Math.min(qe,nt[Xe]);Q[Xe+Le]=[Q[Xe+Oe][0]+He[Xe][0]*ft,Q[Xe+Oe][1]+He[Xe][1]*ft,Q[Xe+Oe][2]+He[Xe][2]*ft,1]}})(F,A[0],x,S);const V=A.map((Q=>{const ce=s.b2([],F[Q[0]],F[Q[1]]),_e=s.b2([],F[Q[2]],F[Q[1]]),Ie=s.b3([],s.b4([],ce,_e)),Oe=-s.b5(Ie,F[Q[1]]);return Ie.concat(Oe)})),q=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],te=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const Q of F)for(let ce=0;ce<3;ce++)q[ce]=Math.min(q[ce],Q[ce]),te[ce]=Math.max(te[ce],Q[ce]);return new Ri(F,V,new ri(q,te))}}class qa{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,o,d){return this._helper.interpolatePadding(t,o,d)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,o,d=!0){this._helper.resize(t,o,d)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}setConstrainOverride(t){this._helper.setConstrainOverride(t)}overrideNearFarZ(t,o){this._helper.overrideNearFarZ(t,o)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t,o){}constructor(t){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this.defaultConstrain=(o,d)=>{d=s.an(+d,this.minZoom,this.maxZoom);const x={center:new s.V(o.lng,o.lat),zoom:d};let S=this._helper._lngRange;if(!this._helper._renderWorldCopies&&S===null){const He=179.9999999999;S=[-He,He]}const A=this.tileSize*s.aq(x.zoom);let R=0,F=A,V=0,q=A,te=0,Q=0;const{x:ce,y:_e}=this.size;if(this._helper._latRange){const He=this._helper._latRange;R=s.X(He[1])*A,F=s.X(He[0])*A,F-R<_e&&(te=_e/(F-R))}S&&(V=s.W(s.Y(S[0])*A,0,A),q=s.W(s.Y(S[1])*A,0,A),q<V&&(q+=A),q-V<ce&&(Q=ce/(q-V)));const{x:Ie,y:Oe}=hr(A,o);let Le,qe;const nt=Math.max(Q||0,te||0);if(nt){const He=new s.P(Q?(q+V)/2:Ie,te?(F+R)/2:Oe);return x.center=Gr(A,He).wrap(),x.zoom+=s.at(nt),x}if(this._helper._latRange){const He=_e/2;Oe-He<R&&(qe=R+He),Oe+He>F&&(qe=F-He)}if(S){const He=(V+q)/2;let rt=Ie;this._helper._renderWorldCopies&&(rt=s.W(Ie,He-A/2,He+A/2));const ot=ce/2;rt-ot<V&&(Le=V+ot),rt+ot>q&&(Le=q-ot)}if(Le!==void 0||qe!==void 0){const He=new s.P(Le??Ie,qe??Oe);x.center=Gr(A,He).wrap()}return x},this.applyConstrain=(o,d)=>this._helper.applyConstrain(o,d),this._helper=new Si({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(o,d)=>this.defaultConstrain(o,d)},t),this._coveringTilesDetailsProvider=new Qs}clone(){const t=new qa;return t.apply(this),t}apply(t,o,d){this._helper.apply(t,o,d)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(t){const o=[new s.bc(0,t)];if(this._helper._renderWorldCopies){const d=this.screenPointToMercatorCoordinate(new s.P(0,0)),x=this.screenPointToMercatorCoordinate(new s.P(this._helper._width,0)),S=this.screenPointToMercatorCoordinate(new s.P(this._helper._width,this._helper._height)),A=this.screenPointToMercatorCoordinate(new s.P(0,this._helper._height)),R=Math.floor(Math.min(d.x,x.x,S.x,A.x)),F=Math.floor(Math.max(d.x,x.x,S.x,A.x)),V=1;for(let q=R-V;q<=F+V;q++)q!==0&&o.push(new s.bc(q,t))}return o}getCameraFrustum(){return Ri.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){const o=this.screenPointToLocation(this.centerPoint,t),d=t?t.getElevationForLngLatZoom(o,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(d)}setLocationAtPoint(t,o){const d=s.as(this.elevation,this.center.lat),x=this.screenPointToMercatorCoordinateAtZ(o,d),S=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,d),A=s.a9.fromLngLat(t),R=new s.a9(A.x-(x.x-S.x),A.y-(x.y-S.y));this.setCenter(R?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(t,o){return o?this.coordinatePoint(s.a9.fromLngLat(t),o.getElevationForLngLat(t,this),this._pixelMatrix3D):this.coordinatePoint(s.a9.fromLngLat(t))}screenPointToLocation(t,o){var d;return(d=this.screenPointToMercatorCoordinate(t,o))===null||d===void 0?void 0:d.toLngLat()}screenPointToMercatorCoordinate(t,o){if(o){const d=o.pointCoordinate(t);if(d!=null)return d}return this.screenPointToMercatorCoordinateAtZ(t)}screenPointToMercatorCoordinateAtZ(t,o){const d=o||0,x=[t.x,t.y,0,1],S=[t.x,t.y,1,1];s.aH(x,x,this._pixelMatrixInverse),s.aH(S,S,this._pixelMatrixInverse);const A=x[3],R=S[3],F=x[1]/A,V=S[1]/R,q=x[2]/A,te=S[2]/R,Q=q===te?0:(d-q)/(te-q);return new s.a9(s.G.number(x[0]/A,S[0]/R,Q)/this.worldSize,s.G.number(F,V,Q)/this.worldSize,d)}coordinatePoint(t,o=0,d=this._pixelMatrix){const x=[t.x*this.worldSize,t.y*this.worldSize,o,1];return s.aH(x,x,d),new s.P(x[0]/x[3],x[1]/x[3])}getBounds(){const t=Math.max(0,this._helper._height/2-xn(this));return new Ee().extend(this.screenPointToLocation(new s.P(0,t))).extend(this.screenPointToLocation(new s.P(this._helper._width,t))).extend(this.screenPointToLocation(new s.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new s.P(0,this._helper._height)))}isPointOnMapSurface(t,o){return o?o.pointCoordinate(t)!=null:t.y>this.height/2-xn(this)}calculatePosMatrix(t,o=!1,d){var x;const S=(x=t.key)!==null&&x!==void 0?x:s.bd(t.wrap,t.canonical.z,t.canonical.z,t.canonical.x,t.canonical.y),A=o?this._alignedPosMatrixCache:this._posMatrixCache;if(A.has(S)){const V=A.get(S);return d?V.f32:V.f64}const R=an(t,this.worldSize);s.S(R,o?this._alignedProjMatrix:this._viewProjMatrix,R);const F={f64:R,f32:new Float32Array(R)};return A.set(S,F),d?F.f32:F.f64}calculateFogMatrix(t){const o=t.key,d=this._fogMatrixCacheF32;if(d.has(o))return d.get(o);const x=an(t,this.worldSize);return s.S(x,this._fogMatrix,x),d.set(o,new Float32Array(x)),d.get(o)}calculateCenterFromCameraLngLatAlt(t,o,d,x){return this._helper.calculateCenterFromCameraLngLatAlt(t,o,d,x)}_calculateNearFarZIfNeeded(t,o,d){if(!this._helper.autoCalculateNearFarZ)return;const x=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),S=t-x*this._helper._pixelPerMeter/Math.cos(o),A=x<0?S:t,R=Math.PI/2+this.pitchInRadians,F=s.ap(this.fov)*(Math.abs(Math.cos(s.ap(this.roll)))*this.height+Math.abs(Math.sin(s.ap(this.roll)))*this.width)/this.height*(.5+d.y/this.height),V=Math.sin(F)*A/Math.sin(s.an(Math.PI-R-F,.01,Math.PI-.01)),q=xn(this),te=Math.atan(q/this._helper.cameraToCenterDistance),Q=s.ap(.75),ce=te>Q?2*te*(.5+d.y/(2*q)):Q,_e=Math.sin(ce)*A/Math.sin(s.an(Math.PI-R-ce,.01,Math.PI-.01)),Ie=Math.min(V,_e);this._helper._farZ=1.01*(Math.cos(Math.PI/2-o)*Ie+A),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const t=this.centerOffset,o=hr(this.worldSize,this.center),d=o.x,x=o.y;this._helper._pixelPerMeter=s.as(1,this.center.lat)*this.worldSize;const S=s.ap(Math.min(this.pitch,Tr)),A=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(S));let R;this._calculateNearFarZIfNeeded(A,S,t),R=new Float64Array(16),s.be(R,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),s.aB(this._invProjMatrix,R),R[8]=2*-t.x/this._helper._width,R[9]=2*t.y/this._helper._height,this._projectionMatrix=s.bf(R),s.Q(R,R,[1,-1,1]),s.O(R,R,[0,0,-this._helper.cameraToCenterDistance]),s.bg(R,R,-this.rollInRadians),s.bh(R,R,this.pitchInRadians),s.bg(R,R,-this.bearingInRadians),s.O(R,R,[-d,-x,0]),this._mercatorMatrix=s.Q([],R,[this.worldSize,this.worldSize,this.worldSize]),s.Q(R,R,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=s.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,R),s.O(R,R,[0,0,-this.elevation]),this._viewProjMatrix=R,this._invViewProjMatrix=s.aB([],R);const F=[0,0,-1,1];s.aH(F,F,this._invViewProjMatrix),this._cameraPosition=[F[0]/F[3],F[1]/F[3],F[2]/F[3]],this._fogMatrix=new Float64Array(16),s.be(this._fogMatrix,this.fovInRadians,this.width/this.height,A,this._helper._farZ),this._fogMatrix[8]=2*-t.x/this.width,this._fogMatrix[9]=2*t.y/this.height,s.Q(this._fogMatrix,this._fogMatrix,[1,-1,1]),s.O(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),s.bg(this._fogMatrix,this._fogMatrix,-this.rollInRadians),s.bh(this._fogMatrix,this._fogMatrix,this.pitchInRadians),s.bg(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),s.O(this._fogMatrix,this._fogMatrix,[-d,-x,0]),s.Q(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),s.O(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=s.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,R);const V=this._helper._width%2/2,q=this._helper._height%2/2,te=Math.cos(this.bearingInRadians),Q=Math.sin(-this.bearingInRadians),ce=d-Math.round(d)+te*V+Q*q,_e=x-Math.round(x)+te*q+Q*V,Ie=new Float64Array(R);if(s.O(Ie,Ie,[ce>.5?ce-1:ce,_e>.5?_e-1:_e,0]),this._alignedProjMatrix=Ie,R=s.aB(new Float64Array(16),this._pixelMatrix),!R)throw new Error("failed to invert matrix");this._pixelMatrixInverse=R,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const t=this.screenPointToMercatorCoordinate(new s.P(0,0)),o=[t.x*this.worldSize,t.y*this.worldSize,0,1];return s.aH(o,o,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const t=s.as(1,this.center.lat)*this.worldSize;return xt(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/t).toLngLat()}lngLatToCameraDepth(t,o){const d=s.a9.fromLngLat(t),x=[d.x*this.worldSize,d.y*this.worldSize,o,1];return s.aH(x,x,this._viewProjMatrix),x[2]/x[3]}getProjectionData(t){const{overscaledTileID:o,aligned:d,applyTerrainMatrix:x}=t,S=this._helper.getMercatorTileCoordinates(o),A=o?this.calculatePosMatrix(o,d,!0):null;let R;return R=o&&o.terrainRttPosMatrix32f&&x?o.terrainRttPosMatrix32f:A||s.bi(),{mainMatrix:R,tileMercatorCoords:S,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:R}}isLocationOccluded(t){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(t,o,d){return 1}transformLightDirection(t){return s.b1(t)}getRayDirectionFromPixel(t){throw new Error("Not implemented.")}projectTileCoordinates(t,o,d,x){const S=this.calculatePosMatrix(d);let A;x?(A=[t,o,x(t,o),1],s.aH(A,A,S)):(A=[t,o,0,1],os(A,A,S));const R=A[3];return{point:new s.P(A[0]/R,A[1]/R),signedDistanceFromCamera:R,isOccluded:!1}}populateCache(t){for(const o of t)this.calculatePosMatrix(o)}getMatrixForModel(t,o){const d=s.a9.fromLngLat(t,o),x=d.meterInMercatorCoordinateUnits(),S=s.bj();return s.O(S,S,[d.x,d.y,d.z]),s.bg(S,S,Math.PI),s.bh(S,S,Math.PI/2),s.Q(S,S,[-x,x,x]),S}getProjectionDataForCustomLayer(t=!0){const o=new s.a2(0,0,0,0,0),d=this.getProjectionData({overscaledTileID:o,applyGlobeMatrix:t}),x=an(o,this.worldSize);s.S(x,this._viewProjMatrix,x),d.tileMercatorCoords=[0,0,1,1];const S=[s.a5,s.a5,this.worldSize/this._helper.pixelsPerMeter],A=s.bk();return s.Q(A,x,S),d.fallbackMatrix=A,d.mainMatrix=A,d}getFastPathSimpleProjectionMatrix(t){return this.calculatePosMatrix(t)}}function Da(){s.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function El(w){if(w.useSlerp)if(w.k<1){const t=s.bl(w.startEulerAngles.roll,w.startEulerAngles.pitch,w.startEulerAngles.bearing),o=s.bl(w.endEulerAngles.roll,w.endEulerAngles.pitch,w.endEulerAngles.bearing),d=new Float64Array(4);s.bm(d,t,o,w.k);const x=s.bn(d);w.tr.setRoll(x.roll),w.tr.setPitch(x.pitch),w.tr.setBearing(x.bearing)}else w.tr.setRoll(w.endEulerAngles.roll),w.tr.setPitch(w.endEulerAngles.pitch),w.tr.setBearing(w.endEulerAngles.bearing);else w.tr.setRoll(s.G.number(w.startEulerAngles.roll,w.endEulerAngles.roll,w.k)),w.tr.setPitch(s.G.number(w.startEulerAngles.pitch,w.endEulerAngles.pitch,w.k)),w.tr.setBearing(s.G.number(w.startEulerAngles.bearing,w.endEulerAngles.bearing,w.k))}function Al(w,t,o,d,x){const S=x.padding,A=hr(x.worldSize,o.getNorthWest()),R=hr(x.worldSize,o.getNorthEast()),F=hr(x.worldSize,o.getSouthEast()),V=hr(x.worldSize,o.getSouthWest()),q=s.ap(-d),te=A.rotate(q),Q=R.rotate(q),ce=F.rotate(q),_e=V.rotate(q),Ie=new s.P(Math.max(te.x,Q.x,_e.x,ce.x),Math.max(te.y,Q.y,_e.y,ce.y)),Oe=new s.P(Math.min(te.x,Q.x,_e.x,ce.x),Math.min(te.y,Q.y,_e.y,ce.y)),Le=Ie.sub(Oe),qe=(x.width-(S.left+S.right+t.left+t.right))/Le.x,nt=(x.height-(S.top+S.bottom+t.top+t.bottom))/Le.y;if(nt<0||qe<0)return void Da();const He=Math.min(s.at(x.scale*Math.min(qe,nt)),w.maxZoom),rt=s.P.convert(w.offset),ot=new s.P((t.left-t.right)/2,(t.top-t.bottom)/2).rotate(s.ap(d)),Xe=rt.add(ot).mult(x.scale/s.aq(He));return{center:Gr(x.worldSize,A.add(F).div(2).sub(Xe)),zoom:He,bearing:d}}class ls{get useGlobeControls(){return!1}handlePanInertia(t,o){const d=t.mag(),x=Math.abs(xn(o));return{easingOffset:t.mult(Math.min(.75*x/d,1)),easingCenter:o.center}}handleMapControlsRollPitchBearingZoom(t,o){t.bearingDelta&&o.setBearing(o.bearing+t.bearingDelta),t.pitchDelta&&o.setPitch(o.pitch+t.pitchDelta),t.rollDelta&&o.setRoll(o.roll+t.rollDelta),t.zoomDelta&&o.setZoom(o.zoom+t.zoomDelta)}handleMapControlsPan(t,o,d){t.around.distSqr(o.centerPoint)<.01||o.setLocationAtPoint(d,t.around)}cameraForBoxAndBearing(t,o,d,x,S){return Al(t,o,d,x,S)}handleJumpToCenterZoom(t,o){t.zoom!==(o.zoom!==void 0?+o.zoom:t.zoom)&&t.setZoom(+o.zoom),o.center!==void 0&&t.setCenter(s.V.convert(o.center))}handleEaseTo(t,o){const d=t.zoom,x=t.padding,S={roll:t.roll,pitch:t.pitch,bearing:t.bearing},A={roll:o.roll===void 0?t.roll:o.roll,pitch:o.pitch===void 0?t.pitch:o.pitch,bearing:o.bearing===void 0?t.bearing:o.bearing},R=o.zoom!==void 0,F=!t.isPaddingEqual(o.padding);let V=!1;const q=R?+o.zoom:t.zoom;let te=t.centerPoint.add(o.offsetAsPoint);const Q=t.screenPointToLocation(te),{center:ce,zoom:_e}=t.applyConstrain(s.V.convert(o.center||Q),q??d);vo(t,ce);const Ie=hr(t.worldSize,Q),Oe=hr(t.worldSize,ce).sub(Ie),Le=s.aq(_e-d);return V=_e!==d,{easeFunc:qe=>{if(V&&t.setZoom(s.G.number(d,_e,qe)),s.bo(S,A)||El({startEulerAngles:S,endEulerAngles:A,tr:t,k:qe,useSlerp:S.roll!=A.roll}),F&&(t.interpolatePadding(x,o.padding,qe),te=t.centerPoint.add(o.offsetAsPoint)),o.around)t.setLocationAtPoint(o.around,o.aroundPoint);else{const nt=s.aq(t.zoom-d),He=_e>d?Math.min(2,Le):Math.max(.5,Le),rt=Math.pow(He,1-qe),ot=Gr(t.worldSize,Ie.add(Oe.mult(qe*rt)).mult(nt));t.setLocationAtPoint(t.renderWorldCopies?ot.wrap():ot,te)}},isZooming:V,elevationCenter:ce}}handleFlyTo(t,o){const d=o.zoom!==void 0,x=t.zoom,S=t.applyConstrain(s.V.convert(o.center||o.locationAtOffset),d?+o.zoom:x),A=S.center,R=S.zoom;vo(t,A);const F=hr(t.worldSize,o.locationAtOffset),V=hr(t.worldSize,A).sub(F),q=V.mag(),te=s.aq(R-x);let Q;if(o.minZoom!==void 0){const ce=Math.min(+o.minZoom,x,R),_e=t.applyConstrain(A,ce).zoom;Q=s.aq(_e-x)}return{easeFunc:(ce,_e,Ie,Oe)=>{t.setZoom(ce===1?R:x+s.at(_e));const Le=ce===1?A:Gr(t.worldSize,F.add(V.mult(Ie)).mult(_e));t.setLocationAtPoint(t.renderWorldCopies?Le.wrap():Le,Oe)},scaleOfZoom:te,targetCenter:A,scaleOfMinZoom:Q,pixelPathLength:q}}}class Zn{constructor(t,o,d){this.blendFunction=t,this.blendColor=o,this.mask=d}}Zn.Replace=[1,0],Zn.disabled=new Zn(Zn.Replace,s.bp.transparent,[!1,!1,!1,!1]),Zn.unblended=new Zn(Zn.Replace,s.bp.transparent,[!0,!0,!0,!0]),Zn.alphaBlended=new Zn([1,771],s.bp.transparent,[!0,!0,!0,!0]);const Xo=2305;class cn{constructor(t,o,d){this.enable=t,this.mode=o,this.frontFace=d}}cn.disabled=new cn(!1,1029,Xo),cn.backCCW=new cn(!0,1029,Xo),cn.frontCCW=new cn(!0,1028,Xo);class sn{constructor(t,o,d){this.func=t,this.mask=o,this.range=d}}sn.ReadOnly=!1,sn.ReadWrite=!0,sn.disabled=new sn(519,sn.ReadOnly,[0,1]);const bo=7680;class bn{constructor(t,o,d,x,S,A){this.test=t,this.ref=o,this.mask=d,this.fail=x,this.depthFail=S,this.pass=A}}bn.disabled=new bn({func:519,mask:0},0,0,bo,bo,bo);const Fc=new WeakMap;function _i(w){var t;if(Fc.has(w))return Fc.get(w);{const o=(t=w.getParameter(w.VERSION))===null||t===void 0?void 0:t.startsWith("WebGL 2.0");return Fc.set(w,o),o}}class Rs{get awaitingQuery(){return!!this._readbackQueue}constructor(t){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=t;const o=t.context,d=o.gl;this._texFormat=d.RGBA,this._texType=d.UNSIGNED_BYTE;const x=new s.aW;x.emplaceBack(-1,-1),x.emplaceBack(2,-1),x.emplaceBack(-1,2);const S=new s.aY;S.emplaceBack(0,1,2),this._fullscreenTriangle=new Yn(o.createVertexBuffer(x,ys.members),o.createIndexBuffer(S),s.aX.simpleSegment(0,0,x.length,S.length)),this._resultBuffer=new Uint8Array(4),o.activeTexture.set(d.TEXTURE1);const A=d.createTexture();d.bindTexture(d.TEXTURE_2D,A),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.NEAREST),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.NEAREST),d.texImage2D(d.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=o.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(A),_i(d)&&(this._pbo=d.createBuffer(),d.bindBuffer(d.PIXEL_PACK_BUFFER,this._pbo),d.bufferData(d.PIXEL_PACK_BUFFER,4,d.STREAM_READ),d.bindBuffer(d.PIXEL_PACK_BUFFER,null))}destroy(){const t=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),t.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(t,o){const d=this._updateCount;return this._readbackQueue?d>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():d>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(t,o),this._updateCount++,this._measuredError}_bindFramebuffer(){const t=this._cachedRenderContext.context,o=t.gl;t.activeTexture.set(o.TEXTURE1),o.bindTexture(o.TEXTURE_2D,this._fbo.colorAttachment.get()),t.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(t,o){const d=this._cachedRenderContext.context,x=d.gl;if(this._bindFramebuffer(),d.viewport.set([0,0,this._texWidth,this._texHeight]),d.clear({color:s.bp.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(d,x.TRIANGLES,sn.disabled,bn.disabled,Zn.unblended,cn.disabled,((S,A)=>({u_input:S,u_output_expected:A}))(t,o),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&_i(x)){x.bindBuffer(x.PIXEL_PACK_BUFFER,this._pbo),x.readBuffer(x.COLOR_ATTACHMENT0),x.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),x.bindBuffer(x.PIXEL_PACK_BUFFER,null);const S=x.fenceSync(x.SYNC_GPU_COMMANDS_COMPLETE,0);x.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:S}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const t=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&_i(t)){const o=t.clientWaitSync(this._readbackQueue.sync,0,0);if(o===t.WAIT_FAILED)return s.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(o===t.TIMEOUT_EXPIRED)return;t.bindBuffer(t.PIXEL_PACK_BUFFER,this._pbo),t.getBufferSubData(t.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),t.bindBuffer(t.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),t.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Rs._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(t){let o=0;return o+=t[0]/256,o+=t[1]/65536,o+=t[2]/16777216,t[3]<127&&(o=-o),o/128}}const Ji=s.a5/128;function oh(w,t){const o=w.granularity!==void 0?Math.max(w.granularity,1):1,d=o+(w.generateBorders?2:0),x=o+(w.extendToNorthPole||w.generateBorders?1:0)+(w.extendToSouthPole||w.generateBorders?1:0),S=d+1,A=x+1,R=w.generateBorders?-1:0,F=w.generateBorders||w.extendToNorthPole?-1:0,V=o+(w.generateBorders?1:0),q=o+(w.generateBorders||w.extendToSouthPole?1:0),te=S*A,Q=d*x*6,ce=S*A>65536;if(ce&&t==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const _e=ce||t==="32bit",Ie=new Int16Array(2*te);let Oe=0;for(let nt=F;nt<=q;nt++)for(let He=R;He<=V;He++){let rt=He/o*s.a5;He===-1&&(rt=-Ji),He===o+1&&(rt=s.a5+Ji);let ot=nt/o*s.a5;nt===-1&&(ot=w.extendToNorthPole?s.br:-Ji),nt===o+1&&(ot=w.extendToSouthPole?s.bs:s.a5+Ji),Ie[Oe++]=rt,Ie[Oe++]=ot}const Le=_e?new Uint32Array(Q):new Uint16Array(Q);let qe=0;for(let nt=0;nt<x;nt++)for(let He=0;He<d;He++){const rt=He+1+nt*S,ot=He+(nt+1)*S,Xe=He+1+(nt+1)*S;Le[qe++]=He+nt*S,Le[qe++]=ot,Le[qe++]=rt,Le[qe++]=rt,Le[qe++]=ot,Le[qe++]=Xe}return{vertices:Ie.buffer.slice(0),indices:Le.buffer.slice(0),uses32bitIndices:_e}}const vs=new s.aV({fill:new s.bt(128,2),line:new s.bt(512,0),tile:new s.bt(128,32),stencil:new s.bt(128,1),circle:3});class tc{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return wa.projectionGlobe}get vertexShaderPreludeCode(){return wa.projectionMercator.vertexSource}get subdivisionGranularity(){return vs}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(t){this._errorMeasurement||(this._errorMeasurement=new Rs(t));const o=s.X(this._errorQueryLatitudeDegrees),d=2*Math.atan(Math.exp(Math.PI-o*Math.PI*2))-.5*Math.PI,x=this._errorMeasurement.updateErrorLoop(o,d),S=z();x!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=x,this._errorMeasurementLastChangeTime=S);const A=Math.min(Math.max((S-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=s.bu(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,s.bv(A))}_getMeshKey(t){return`${t.granularity.toString(36)}_${t.generateBorders?"b":""}${t.extendToNorthPole?"n":""}${t.extendToSouthPole?"s":""}`}getMeshFromTileID(t,o,d,x,S){const A=(S==="stencil"?vs.stencil:vs.tile).getGranularityForZoomLevel(o.z);return this._getMesh(t,{granularity:A,generateBorders:d,extendToNorthPole:o.y===0&&x,extendToSouthPole:o.y===(1<<o.z)-1&&x})}_getMesh(t,o){const d=this._getMeshKey(o);if(d in this._tileMeshCache)return this._tileMeshCache[d];const x=(function(S,A){const R=oh(A,"16bit"),F=s.aW.deserialize({arrayBuffer:R.vertices,length:R.vertices.byteLength/2/2}),V=s.aY.deserialize({arrayBuffer:R.indices,length:R.indices.byteLength/2/3});return new Yn(S.createVertexBuffer(F,ys.members),S.createIndexBuffer(V),s.aX.simpleSegment(0,0,F.length,V.length))})(t,o);return this._tileMeshCache[d]=x,x}recalculate(t){}hasTransition(){const t=z();let o=!1;return o=o||(t-this._errorMeasurementLastChangeTime)/1e3<.7,o=o||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,o}setErrorQueryLatitudeDegrees(t){this._errorQueryLatitudeDegrees=t}}const Lc=new s.t({type:new s.D(s.u.projection.type)});class mu extends s.E{constructor(t){super(),this._transitionable=new s.x(Lc,void 0),this.setProjection(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new s.H(0)),this._mercatorProjection=new la,this._verticalPerspectiveProjection=new tc}get transitionState(){const t=this.properties.get("type");if(typeof t=="string"&&t==="mercator")return 0;if(typeof t=="string"&&t==="vertical-perspective")return 1;if(t instanceof s.bw){if(t.from==="vertical-perspective"&&t.to==="mercator")return 1-t.transition;if(t.from==="mercator"&&t.to==="vertical-perspective")return t.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(t){this._mercatorProjection.updateGPUdependent(t),this._verticalPerspectiveProjection.updateGPUdependent(t)}getMeshFromTileID(t,o,d,x,S){return this.currentProjection.getMeshFromTileID(t,o,d,x,S)}setProjection(t){this._transitionable.setValue("type",t?.type||"mercator")}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}setErrorQueryLatitudeDegrees(t){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(t),this._mercatorProjection.setErrorQueryLatitudeDegrees(t)}}function Ii(w){const t=Yo(w.worldSize,w.center.lat);return 2*Math.PI*t}function ci(w,t,o,d,x){const S=1/(1<<x),A=t/s.a5*S+d*S,R=s.by((w/s.a5*S+o*S)*Math.PI*2+Math.PI,2*Math.PI),F=2*Math.atan(Math.exp(Math.PI-A*Math.PI*2))-.5*Math.PI,V=Math.cos(F),q=new Float64Array(3);return q[0]=Math.sin(R)*V,q[1]=Math.sin(F),q[2]=Math.cos(R)*V,q}function ca(w){return(function(t,o){const d=Math.cos(o),x=new Float64Array(3);return x[0]=Math.sin(t)*d,x[1]=Math.sin(o),x[2]=Math.cos(t)*d,x})(w.lng*Math.PI/180,w.lat*Math.PI/180)}function Yo(w,t){return w/(2*Math.PI)/Math.cos(t*Math.PI/180)}function Ko(w){const t=Math.asin(w[1])/Math.PI*180,o=Math.sqrt(w[0]*w[0]+w[2]*w[2]);if(o>1e-6){const d=w[0]/o,x=Math.acos(w[2]/o),S=(d>0?x:-x)/Math.PI*180;return new s.V(s.W(S,-180,180),t)}return new s.V(0,t)}function gu(w){return Math.cos(w*Math.PI/180)}function Ta(w,t){const o=gu(w),d=gu(t);return s.at(d/o)}function $h(w,t){const o=w.rotate(t.bearingInRadians),d=t.zoom+Ta(t.center.lat,0),x=s.bu(1/gu(t.center.lat),1/gu(Math.min(Math.abs(t.center.lat),60)),s.bx(d,7,3,0,1)),S=360/Ii({worldSize:t.worldSize,center:{lat:t.center.lat}});return new s.V(t.center.lng-o.x*S*x,s.an(t.center.lat+o.y*S,-s.ao,s.ao))}function Gn(w){const t=.5*w,o=Math.sin(t),d=Math.cos(t);return Math.log(o+d)-Math.log(d-o)}function _u(w,t,o,d){const x=w.lat+o*d;if(Math.abs(o)>1){const S=(Math.sign(w.lat+o)!==Math.sign(w.lat)?-Math.abs(w.lat):Math.abs(w.lat))*Math.PI/180,A=Math.abs(w.lat+o)*Math.PI/180,R=Gn(S+d*(A-S)),F=Gn(S),V=Gn(A);return new s.V(w.lng+t*((R-F)/(V-F)),x)}return new s.V(w.lng+t*d,x)}class Kn{constructor(t){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=t}swapBuffers(){if(!this._hadAnyChanges)return;const t=this._cachePrevious;this._cachePrevious=this._cache,this._cache=t,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(t,o,d,x){const S=`${t.z}_${t.x}_${t.y}_${x?.terrain?"t":""}`,A=this._cache.get(S);if(A)return A;const R=this._cachePrevious.get(S);if(R)return this._cache.set(S,R),R;const F=this._boundingVolumeFactory(t,o,d,x);return this._cache.set(S,F),this._hadAnyChanges=!0,F}}class wo{constructor(t,o,d,x){this.min=d,this.max=x,this.points=t,this.planes=o}static fromAabb(t,o){const d=[];for(let x=0;x<8;x++)d.push([1&~x?t[0]:o[0],(x>>1&1)==1?o[1]:t[1],(x>>2&1)==1?o[2]:t[2]]);return new wo(d,[[-1,0,0,o[0]],[1,0,0,-t[0]],[0,-1,0,o[1]],[0,1,0,-t[1]],[0,0,-1,o[2]],[0,0,1,-t[2]]],t,o)}static fromCenterSizeAngles(t,o,d){const x=s.bB([],d[0],d[1],d[2]),S=s.bC([],[o[0],0,0],x),A=s.bC([],[0,o[1],0],x),R=s.bC([],[0,0,o[2]],x),F=[...t],V=[...t];for(let te=0;te<8;te++)for(let Q=0;Q<3;Q++){const ce=t[Q]+S[Q]*(1&~te?-1:1)+A[Q]*((te>>1&1)==1?1:-1)+R[Q]*((te>>2&1)==1?1:-1);F[Q]=Math.min(F[Q],ce),V[Q]=Math.max(V[Q],ce)}const q=[];for(let te=0;te<8;te++){const Q=[...t];s.b0(Q,Q,s.a$([],S,1&~te?-1:1)),s.b0(Q,Q,s.a$([],A,(te>>1&1)==1?1:-1)),s.b0(Q,Q,s.a$([],R,(te>>2&1)==1?1:-1)),q.push(Q)}return new wo(q,[[...S,-s.b5(S,q[0])],[...A,-s.b5(A,q[0])],[...R,-s.b5(R,q[0])],[-S[0],-S[1],-S[2],-s.b5(S,q[7])],[-A[0],-A[1],-A[2],-s.b5(A,q[7])],[-R[0],-R[1],-R[2],-s.b5(R,q[7])]],F,V)}intersectsFrustum(t){let o=!0;const d=this.points.length,x=this.planes.length,S=t.planes.length,A=t.points.length;for(let R=0;R<S;R++){const F=t.planes[R];let V=0;for(let q=0;q<d;q++){const te=this.points[q];F[0]*te[0]+F[1]*te[1]+F[2]*te[2]+F[3]>=0&&V++}if(V===0)return 0;V<d&&(o=!1)}if(o)return 2;for(let R=0;R<x;R++){const F=this.planes[R];let V=0;for(let q=0;q<A;q++){const te=t.points[q];F[0]*te[0]+F[1]*te[1]+F[2]*te[2]+F[3]>=0&&V++}if(V===0)return 0}return 1}intersectsPlane(t){const o=this.points.length;let d=0;for(let x=0;x<o;x++){const S=this.points[x];t[0]*S[0]+t[1]*S[1]+t[2]*S[2]+t[3]>=0&&d++}return d===o?2:d===0?0:1}}function kl(w,t,o){const d=w-t;return d<0?-d:Math.max(0,d-o)}function Cl(w,t,o,d,x){const S=w-o;let A;return A=S<0?Math.min(-S,1+S-x):S>1?Math.min(Math.max(S-x,0),1-S):0,Math.max(A,kl(t,d,x))}class Ml{constructor(){this._boundingVolumeCache=new Kn(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(t,o,d,x){const S=1<<d.z,A=1/S,R=d.x/S,F=d.y/S;let V=2;return V=Math.min(V,Cl(t,o,R,F,A)),V=Math.min(V,Cl(t,o,R+.5,-F-A,A)),V=Math.min(V,Cl(t,o,R+.5,2-F-A,A)),V}getWrap(t,o,d){const x=1<<o.z,S=1/x,A=o.x/x,R=kl(t.x,A,S),F=kl(t.x,A-1,S),V=kl(t.x,A+1,S),q=Math.min(R,F,V);return q===V?1:q===F?-1:0}allowVariableZoom(t,o){return Vn(t,o)>4}allowWorldCopies(){return!1}getTileBoundingVolume(t,o,d,x){return this._boundingVolumeCache.getTileBoundingVolume(t,o,d,x)}_computeTileBoundingVolume(t,o,d,x){var S,A;let R=0,F=0;if(x?.terrain){const V=new s.a2(t.z,o,t.z,t.x,t.y),q=x.terrain.getMinMaxElevation(V);R=(S=q.minElevation)!==null&&S!==void 0?S:Math.min(0,d),F=(A=q.maxElevation)!==null&&A!==void 0?A:Math.max(0,d)}if(R/=s.bE,F/=s.bE,R+=1,F+=1,t.z<=0)return wo.fromAabb([-F,-F,-F],[F,F,F]);if(t.z===1)return wo.fromAabb([t.x===0?-F:0,t.y===0?0:-F,-F],[t.x===0?0:F,t.y===0?F:0,F]);{const V=[ci(0,0,t.x,t.y,t.z),ci(s.a5,0,t.x,t.y,t.z),ci(s.a5,s.a5,t.x,t.y,t.z),ci(0,s.a5,t.x,t.y,t.z)],q=[];for(const Ct of V)q.push(s.a$([],Ct,F));if(F!==R)for(const Ct of V)q.push(s.a$([],Ct,R));t.y===0&&q.push([0,1,0]),t.y===(1<<t.z)-1&&q.push([0,-1,0]);const te=[1,1,1],Q=[-1,-1,-1];for(const Ct of q)for(let Dt=0;Dt<3;Dt++)te[Dt]=Math.min(te[Dt],Ct[Dt]),Q[Dt]=Math.max(Q[Dt],Ct[Dt]);const ce=ci(s.a5/2,s.a5/2,t.x,t.y,t.z),_e=s.b4([],[0,1,0],ce);s.b3(_e,_e);const Ie=s.b4([],ce,_e);s.b3(Ie,Ie);const Oe=s.b4([],V[2],V[1]);s.b3(Oe,Oe);const Le=s.b4([],V[0],V[3]);s.b3(Le,Le),q.push(s.a$([],ce,F)),t.y>=(1<<t.z)/2&&q.push(s.a$([],ci(s.a5/2,0,t.x,t.y,t.z),F)),t.y<(1<<t.z)/2&&q.push(s.a$([],ci(s.a5/2,s.a5,t.x,t.y,t.z),F));const qe=rc(ce,q),nt=rc(Ie,q),He=[-ce[0],-ce[1],-ce[2],qe.max],rt=[ce[0],ce[1],ce[2],-qe.min],ot=[-Ie[0],-Ie[1],-Ie[2],nt.max],Xe=[Ie[0],Ie[1],Ie[2],-nt.min],ft=[...Oe,0],Pt=[...Le,0],Et=[];return t.y===0?Et.push(s.bD(Pt,ft,He),s.bD(Pt,ft,rt)):Et.push(s.bD(ot,ft,He),s.bD(ot,ft,rt),s.bD(ot,Pt,He),s.bD(ot,Pt,rt)),t.y===(1<<t.z)-1?Et.push(s.bD(Pt,ft,He),s.bD(Pt,ft,rt)):Et.push(s.bD(Xe,ft,He),s.bD(Xe,ft,rt),s.bD(Xe,Pt,He),s.bD(Xe,Pt,rt)),new wo(Et,[He,rt,ot,Xe,ft,Pt],te,Q)}}}function rc(w,t){let o=1/0,d=-1/0;for(const x of t){const S=s.b5(w,x);o=Math.min(o,S),d=Math.max(d,S)}return{min:o,max:d}}class Jo{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,o,d){return this._helper.interpolatePadding(t,o,d)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,o){this._helper.resize(t,o)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}setConstrainOverride(t){this._helper.setConstrainOverride(t)}overrideNearFarZ(t,o){this._helper.overrideNearFarZ(t,o)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t){}constructor(t){this._cachedClippingPlane=s.bF(),this._projectionMatrix=s.bj(),this._globeViewProjMatrix32f=s.bi(),this._globeViewProjMatrixNoCorrection=s.bj(),this._globeViewProjMatrixNoCorrectionInverted=s.bj(),this._globeProjMatrixInverted=s.bj(),this._cameraPosition=s.bz(),this._globeLatitudeErrorCorrectionRadians=0,this.defaultConstrain=(o,d)=>{const x=s.an(o.lat,-s.ao,s.ao),S=s.an(+d,this.minZoom+Ta(0,x),this.maxZoom);return{center:new s.V(o.lng,x),zoom:S}},this.applyConstrain=(o,d)=>this._helper.applyConstrain(o,d),this._helper=new Si({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(o,d)=>this.defaultConstrain(o,d)},t),this._coveringTilesDetailsProvider=new Ml}clone(){const t=new Jo;return t.apply(this),t}apply(t,o){this._globeLatitudeErrorCorrectionRadians=o||0,this._helper.apply(t)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const t=s.bz();return t[0]=this._cameraPosition[0],t[1]=this._cameraPosition[1],t[2]=this._cameraPosition[2],t}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(t){const{overscaledTileID:o,applyGlobeMatrix:d}=t,x=this._helper.getMercatorTileCoordinates(o);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:x,clippingPlane:this._cachedClippingPlane,projectionTransition:d?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(t){const o=this.pitchInRadians,d=this.cameraToCenterDistance/t,x=Math.sin(o)*d,S=Math.cos(o)*d+1,A=1/Math.sqrt(x*x+S*S)*1;let R=-x,F=S;const V=Math.sqrt(R*R+F*F);R/=V,F/=V;const q=[0,R,F];s.bG(q,q,[0,0,0],-this.bearingInRadians),s.bH(q,q,[0,0,0],-1*this.center.lat*Math.PI/180),s.bI(q,q,[0,0,0],this.center.lng*Math.PI/180);const te=1/s.b7(q);return s.a$(q,q,te),[...q,-A*te]}isLocationOccluded(t){return!this.isSurfacePointVisible(ca(t))}transformLightDirection(t){const o=this._helper._center.lng*Math.PI/180,d=this._helper._center.lat*Math.PI/180,x=Math.cos(d),S=[Math.sin(o)*x,Math.sin(d),Math.cos(o)*x],A=[S[2],0,-S[0]],R=[0,0,0];s.b4(R,A,S),s.b3(A,A),s.b3(R,R);const F=[0,0,0];return s.b3(F,[A[0]*t[0]+R[0]*t[1]+S[0]*t[2],A[1]*t[0]+R[1]*t[1]+S[1]*t[2],A[2]*t[0]+R[2]*t[1]+S[2]*t[2]]),F}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(t,o,d){const x=(function(R,F,V){const q=1/(1<<V.z);return new s.a9(R/s.a5*q+V.x*q,F/s.a5*q+V.y*q)})(t,o,d.canonical),S=(A=x.y,[s.by(x.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-A*Math.PI*2))-.5*Math.PI]);var A;return this.getCircleRadiusCorrection()/Math.cos(S[1])}projectTileCoordinates(t,o,d,x){const S=d.canonical,A=ci(t,o,S.x,S.y,S.z),R=1+(x?x(t,o):0)/s.bE,F=[A[0]*R,A[1]*R,A[2]*R,1];s.aH(F,F,this._globeViewProjMatrixNoCorrection);const V=this._cachedClippingPlane,q=V[0]*A[0]+V[1]*A[1]+V[2]*A[2]+V[3]<0;return{point:new s.P(F[0]/F[3],F[1]/F[3]),signedDistanceFromCamera:F[3],isOccluded:q}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const t=Yo(this.worldSize,this.center.lat),o=s.bk(),d=s.bk();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*t),s.be(o,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const x=this.centerOffset;o[8]=2*-x.x/this._helper._width,o[9]=2*x.y/this._helper._height,this._projectionMatrix=s.bf(o),this._globeProjMatrixInverted=s.bk(),s.aB(this._globeProjMatrixInverted,o),s.O(o,o,[0,0,-this.cameraToCenterDistance]),s.bg(o,o,this.rollInRadians),s.bh(o,o,-this.pitchInRadians),s.bg(o,o,this.bearingInRadians),s.O(o,o,[0,0,-t]);const S=s.bz();S[0]=t,S[1]=t,S[2]=t,s.bh(d,o,this.center.lat*Math.PI/180),s.bJ(d,d,-this.center.lng*Math.PI/180),s.Q(d,d,S),this._globeViewProjMatrixNoCorrection=d,s.bh(o,o,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),s.bJ(o,o,-this.center.lng*Math.PI/180),s.Q(o,o,S),this._globeViewProjMatrix32f=new Float32Array(o),this._globeViewProjMatrixNoCorrectionInverted=s.bk(),s.aB(this._globeViewProjMatrixNoCorrectionInverted,d);const A=s.bz();this._cameraPosition=s.bz(),this._cameraPosition[2]=this.cameraToCenterDistance/t,s.bG(this._cameraPosition,this._cameraPosition,A,-this.rollInRadians),s.bH(this._cameraPosition,this._cameraPosition,A,this.pitchInRadians),s.bG(this._cameraPosition,this._cameraPosition,A,-this.bearingInRadians),s.b0(this._cameraPosition,this._cameraPosition,[0,0,1]),s.bH(this._cameraPosition,this._cameraPosition,A,-this.center.lat*Math.PI/180),s.bI(this._cameraPosition,this._cameraPosition,A,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(t);const R=s.bf(this._globeViewProjMatrixNoCorrectionInverted);s.Q(R,R,[1,1,-1]),this._cachedFrustum=Ri.fromInvProjectionMatrix(R,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(t){s.w("calculateFogMatrix is not supported on globe projection.");const o=s.bk();return s.ar(o),o}getVisibleUnwrappedCoordinates(t){return[new s.bc(0,t)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){t&&s.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,o){if(!this._globeViewProjMatrixNoCorrection)return 1;const d=ca(t);s.a$(d,d,1+o/s.bE);const x=s.bF();return s.aH(x,[d[0],d[1],d[2],1],this._globeViewProjMatrixNoCorrection),x[2]/x[3]}populateCache(t){}getBounds(){const t=.5*this.width,o=.5*this.height,d=[new s.P(0,0),new s.P(t,0),new s.P(this.width,0),new s.P(this.width,o),new s.P(this.width,this.height),new s.P(t,this.height),new s.P(0,this.height),new s.P(0,o)],x=[];for(const te of d)x.push(this.unprojectScreenPoint(te));let S=0,A=0,R=0,F=0;const V=this.center;for(const te of x){const Q=s.bK(V.lng,te.lng),ce=s.bK(V.lat,te.lat);Q<A&&(A=Q),Q>S&&(S=Q),ce<F&&(F=ce),ce>R&&(R=ce)}const q=[V.lng+A,V.lat+F,V.lng+S,V.lat+R];return this.isSurfacePointOnScreen([0,1,0])&&(q[3]=90,q[0]=-180,q[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(q[1]=-90,q[0]=-180,q[2]=180),new Ee(q)}calculateCenterFromCameraLngLatAlt(t,o,d,x){return this._helper.calculateCenterFromCameraLngLatAlt(t,o,d,x)}setLocationAtPoint(t,o){const d=ca(this.unprojectScreenPoint(o)),x=ca(t),S=s.bz();s.bL(S);const A=s.bz();s.bI(A,d,S,-this.center.lng*Math.PI/180),s.bH(A,A,S,this.center.lat*Math.PI/180);const R=x[0]*x[0]+x[2]*x[2],F=A[0]*A[0];if(R<F)return;const V=Math.sqrt(R-F),q=-V,te=s.bM(x[0],x[2],A[0],V),Q=s.bM(x[0],x[2],A[0],q),ce=s.bz();s.bI(ce,x,S,-te);const _e=s.bM(ce[1],ce[2],A[1],A[2]),Ie=s.bz();s.bI(Ie,x,S,-Q);const Oe=s.bM(Ie[1],Ie[2],A[1],A[2]),Le=.5*Math.PI,qe=_e>=-Le&&_e<=Le,nt=Oe>=-Le&&Oe<=Le;let He,rt;if(qe&&nt){const Pt=this.center.lng*Math.PI/180,Et=this.center.lat*Math.PI/180;s.bN(te,Pt)+s.bN(_e,Et)<s.bN(Q,Pt)+s.bN(Oe,Et)?(He=te,rt=_e):(He=Q,rt=Oe)}else if(qe)He=te,rt=_e;else{if(!nt)return;He=Q,rt=Oe}const ot=He/Math.PI*180,Xe=rt/Math.PI*180,ft=this.center.lat;this.setCenter(new s.V(ot,s.an(Xe,-90,90))),this.setZoom(this.zoom+Ta(ft,this.center.lat))}locationToScreenPoint(t,o){const d=ca(t);if(o){const x=o.getElevationForLngLatZoom(t,this._helper._tileZoom);s.a$(d,d,1+x/s.bE)}return this._projectSurfacePointToScreen(d)}_projectSurfacePointToScreen(t){const o=s.bF();return s.aH(o,[...t,1],this._globeViewProjMatrixNoCorrection),o[0]/=o[3],o[1]/=o[3],new s.P((.5*o[0]+.5)*this.width,(.5*-o[1]+.5)*this.height)}screenPointToMercatorCoordinate(t,o){if(o){const d=o.pointCoordinate(t);if(d)return d}return s.a9.fromLngLat(this.unprojectScreenPoint(t))}screenPointToLocation(t,o){var d;return(d=this.screenPointToMercatorCoordinate(t,o))===null||d===void 0?void 0:d.toLngLat()}isPointOnMapSurface(t,o){const d=this._cameraPosition,x=this.getRayDirectionFromPixel(t);return!!this.rayPlanetIntersection(d,x)}getRayDirectionFromPixel(t){const o=s.bF();o[0]=t.x/this.width*2-1,o[1]=-1*(t.y/this.height*2-1),o[2]=1,o[3]=1,s.aH(o,o,this._globeViewProjMatrixNoCorrectionInverted),o[0]/=o[3],o[1]/=o[3],o[2]/=o[3];const d=s.bz();d[0]=o[0]-this._cameraPosition[0],d[1]=o[1]-this._cameraPosition[1],d[2]=o[2]-this._cameraPosition[2];const x=s.bz();return s.b3(x,d),x}isSurfacePointVisible(t){const o=this._cachedClippingPlane;return o[0]*t[0]+o[1]*t[1]+o[2]*t[2]+o[3]>=0}isSurfacePointOnScreen(t){if(!this.isSurfacePointVisible(t))return!1;const o=s.bF();return s.aH(o,[...t,1],this._globeViewProjMatrixNoCorrection),o[0]/=o[3],o[1]/=o[3],o[2]/=o[3],o[0]>-1&&o[0]<1&&o[1]>-1&&o[1]<1&&o[2]>-1&&o[2]<1}rayPlanetIntersection(t,o){const d=s.b5(t,o),x=s.bz(),S=s.bz();s.a$(S,o,d),s.b2(x,t,S);const A=1-s.b5(x,x);if(A<0)return null;const R=s.b5(t,t)-1,F=-d+(d<0?1:-1)*Math.sqrt(A),V=R/F,q=F;return{tMin:Math.min(V,q),tMax:Math.max(V,q)}}unprojectScreenPoint(t){const o=this._cameraPosition,d=this.getRayDirectionFromPixel(t),x=this.rayPlanetIntersection(o,d);if(x){const q=s.bz();s.b0(q,o,[d[0]*x.tMin,d[1]*x.tMin,d[2]*x.tMin]);const te=s.bz();return s.b3(te,q),Ko(te)}const S=this._cachedClippingPlane,A=S[0]*d[0]+S[1]*d[1]+S[2]*d[2],R=-s.bb(S,o)/A,F=s.bz();if(R>0)s.b0(F,o,[d[0]*R,d[1]*R,d[2]*R]);else{const q=s.bz();s.b0(q,o,[2*d[0],2*d[1],2*d[2]]);const te=s.bb(this._cachedClippingPlane,q);s.b2(F,q,[this._cachedClippingPlane[0]*te,this._cachedClippingPlane[1]*te,this._cachedClippingPlane[2]*te])}const V=(function(q){const te=s.bz();return te[0]=q[0]*-q[3],te[1]=q[1]*-q[3],te[2]=q[2]*-q[3],{center:te,radius:Math.sqrt(1-q[3]*q[3])}})(S);return Ko((function(q,te,Q){const ce=s.bz();s.b2(ce,Q,q);const _e=s.bz();return s.bA(_e,q,ce,te/s.b9(ce)),_e})(V.center,V.radius,F))}getMatrixForModel(t,o){const d=s.V.convert(t),x=1/s.bE,S=s.bj();return s.bJ(S,S,d.lng/180*Math.PI),s.bh(S,S,-d.lat/180*Math.PI),s.O(S,S,[0,0,1+o/s.bE]),s.bh(S,S,.5*Math.PI),s.Q(S,S,[x,x,x]),S}getProjectionDataForCustomLayer(t=!0){const o=this.getProjectionData({overscaledTileID:new s.a2(0,0,0,0,0),applyGlobeMatrix:t});return o.tileMercatorCoords=[0,0,1,1],o}getFastPathSimpleProjectionMatrix(t){}}class nc{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,o,d){return this._helper.interpolatePadding(t,o,d)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,o,d=!0){this._helper.resize(t,o,d)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}setConstrainOverride(t){this._helper.setConstrainOverride(t)}overrideNearFarZ(t,o){this._helper.overrideNearFarZ(t,o)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(t,o){this._globeness=t,this._globeLatitudeErrorCorrectionRadians=o,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(t){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this.defaultConstrain=(o,d)=>this.currentTransform.defaultConstrain(o,d),this.applyConstrain=(o,d)=>this._helper.applyConstrain(o,d),this._helper=new Si({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(o,d)=>this.defaultConstrain(o,d)},t),this._globeness=1,this._mercatorTransform=new qa,this._verticalPerspectiveTransform=new Jo}clone(){const t=new nc;return t._globeness=this._globeness,t._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,t.apply(this),t}apply(t){this._helper.apply(t),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(t){const o=this._mercatorTransform.getProjectionData(t),d=this._verticalPerspectiveTransform.getProjectionData(t);return{mainMatrix:this.isGlobeRendering?d.mainMatrix:o.mainMatrix,clippingPlane:d.clippingPlane,tileMercatorCoords:d.tileMercatorCoords,projectionTransition:t.applyGlobeMatrix?this._globeness:0,fallbackMatrix:o.fallbackMatrix}}isLocationOccluded(t){return this.currentTransform.isLocationOccluded(t)}transformLightDirection(t){return this.currentTransform.transformLightDirection(t)}getPixelScale(){return s.bu(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return s.bu(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(t,o,d){const x=this._mercatorTransform.getPitchedTextCorrection(t,o,d),S=this._verticalPerspectiveTransform.getPitchedTextCorrection(t,o,d);return s.bu(x,S,this._globeness)}projectTileCoordinates(t,o,d,x){return this.currentTransform.projectTileCoordinates(t,o,d,x)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(t){return this.currentTransform.calculateFogMatrix(t)}getVisibleUnwrappedCoordinates(t){return this.currentTransform.getVisibleUnwrappedCoordinates(t)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(t){this._mercatorTransform.recalculateZoomAndCenter(t),this._verticalPerspectiveTransform.recalculateZoomAndCenter(t)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,o){return this.currentTransform.lngLatToCameraDepth(t,o)}populateCache(t){this._mercatorTransform.populateCache(t),this._verticalPerspectiveTransform.populateCache(t)}getBounds(){return this.currentTransform.getBounds()}calculateCenterFromCameraLngLatAlt(t,o,d,x){return this._helper.calculateCenterFromCameraLngLatAlt(t,o,d,x)}setLocationAtPoint(t,o){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(t,o),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(t,o),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(t,o){return this.currentTransform.locationToScreenPoint(t,o)}screenPointToMercatorCoordinate(t,o){return this.currentTransform.screenPointToMercatorCoordinate(t,o)}screenPointToLocation(t,o){return this.currentTransform.screenPointToLocation(t,o)}isPointOnMapSurface(t,o){return this.currentTransform.isPointOnMapSurface(t,o)}getRayDirectionFromPixel(t){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(t)}getMatrixForModel(t,o){return this.currentTransform.getMatrixForModel(t,o)}getProjectionDataForCustomLayer(t=!0){const o=this._mercatorTransform.getProjectionDataForCustomLayer(t);if(!this.isGlobeRendering)return o;const d=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(t);return d.fallbackMatrix=o.mainMatrix,d}getFastPathSimpleProjectionMatrix(t){return this.currentTransform.getFastPathSimpleProjectionMatrix(t)}}class Ra{get useGlobeControls(){return!0}handlePanInertia(t,o){const d=$h(t,o);return Math.abs(d.lng-o.center.lng)>180&&(d.lng=o.center.lng+179.5*Math.sign(d.lng-o.center.lng)),{easingCenter:d,easingOffset:new s.P(0,0)}}handleMapControlsRollPitchBearingZoom(t,o){const d=t.around,x=o.screenPointToLocation(d);t.bearingDelta&&o.setBearing(o.bearing+t.bearingDelta),t.pitchDelta&&o.setPitch(o.pitch+t.pitchDelta),t.rollDelta&&o.setRoll(o.roll+t.rollDelta);const S=o.zoom;t.zoomDelta&&o.setZoom(o.zoom+t.zoomDelta);const A=o.zoom-S;if(A===0)return;const R=s.bK(o.center.lng,x.lng),F=R/(Math.abs(R/180)+1),V=s.bK(o.center.lat,x.lat),q=o.getRayDirectionFromPixel(d),te=o.cameraPosition,Q=-1*s.b5(te,q),ce=s.bz();s.b0(ce,te,[q[0]*Q,q[1]*Q,q[2]*Q]);const _e=s.b7(ce)-1,Ie=Math.exp(.5*-Math.max(_e-.3,0)),Oe=Yo(o.worldSize,o.center.lat)/Math.min(o.width,o.height),Le=s.bx(Oe,.9,.5,1,.25),qe=(1-s.aq(-A))*Math.min(Ie,Le),nt=o.center.lat,He=o.zoom,rt=new s.V(o.center.lng+F*qe,s.an(o.center.lat+V*qe,-s.ao,s.ao));o.setLocationAtPoint(x,d);const ot=o.center,Xe=s.bx(Math.abs(R),45,85,0,1),ft=s.bx(Oe,.75,.35,0,1),Pt=Math.pow(Math.max(Xe,ft),.25),Et=s.bK(ot.lng,rt.lng),Ct=s.bK(ot.lat,rt.lat);o.setCenter(new s.V(ot.lng+Et*Pt,ot.lat+Ct*Pt).wrap()),o.setZoom(He+Ta(nt,o.center.lat))}handleMapControlsPan(t,o,d){if(!t.panDelta)return;const x=o.center.lat,S=o.zoom;o.setCenter($h(t.panDelta,o).wrap()),o.setZoom(S+Ta(x,o.center.lat))}cameraForBoxAndBearing(t,o,d,x,S){const A=Al(t,o,d,x,S),R=o.left/S.width*2-1,F=(S.width-o.right)/S.width*2-1,V=o.top/S.height*-2+1,q=(S.height-o.bottom)/S.height*-2+1,te=s.bK(d.getWest(),d.getEast())<0,Q=te?d.getEast():d.getWest(),ce=te?d.getWest():d.getEast(),_e=Math.max(d.getNorth(),d.getSouth()),Ie=Math.min(d.getNorth(),d.getSouth()),Oe=Q+.5*s.bK(Q,ce),Le=_e+.5*s.bK(_e,Ie),qe=S.clone();qe.setCenter(A.center),qe.setBearing(A.bearing),qe.setPitch(0),qe.setRoll(0),qe.setZoom(A.zoom);const nt=qe.modelViewProjectionMatrix,He=[ca(d.getNorthWest()),ca(d.getNorthEast()),ca(d.getSouthWest()),ca(d.getSouthEast()),ca(new s.V(ce,Le)),ca(new s.V(Q,Le)),ca(new s.V(Oe,_e)),ca(new s.V(Oe,Ie))],rt=ca(A.center);let ot=Number.POSITIVE_INFINITY;for(const Xe of He)R<0&&(ot=Ra.getLesserNonNegativeNonNull(ot,Ra.solveVectorScale(Xe,rt,nt,"x",R))),F>0&&(ot=Ra.getLesserNonNegativeNonNull(ot,Ra.solveVectorScale(Xe,rt,nt,"x",F))),V>0&&(ot=Ra.getLesserNonNegativeNonNull(ot,Ra.solveVectorScale(Xe,rt,nt,"y",V))),q<0&&(ot=Ra.getLesserNonNegativeNonNull(ot,Ra.solveVectorScale(Xe,rt,nt,"y",q)));if(Number.isFinite(ot)&&ot!==0)return A.zoom=qe.zoom+s.at(ot),A;Da()}handleJumpToCenterZoom(t,o){const d=t.center.lat,x=t.applyConstrain(o.center?s.V.convert(o.center):t.center,t.zoom).center;t.setCenter(x.wrap());const S=o.zoom!==void 0?+o.zoom:t.zoom+Ta(d,x.lat);t.zoom!==S&&t.setZoom(S)}handleEaseTo(t,o){const d=t.zoom,x=t.center,S=t.padding,A={roll:t.roll,pitch:t.pitch,bearing:t.bearing},R={roll:o.roll===void 0?t.roll:o.roll,pitch:o.pitch===void 0?t.pitch:o.pitch,bearing:o.bearing===void 0?t.bearing:o.bearing},F=o.zoom!==void 0,V=!t.isPaddingEqual(o.padding);let q=!1;const te=o.center?s.V.convert(o.center):x,Q=t.applyConstrain(te,d).center;vo(t,Q);const ce=t.clone();ce.setCenter(Q),ce.setZoom(F?+o.zoom:d+Ta(x.lat,te.lat)),ce.setBearing(o.bearing);const _e=new s.P(s.an(t.centerPoint.x+o.offsetAsPoint.x,0,t.width),s.an(t.centerPoint.y+o.offsetAsPoint.y,0,t.height));ce.setLocationAtPoint(Q,_e);const Ie=(o.offset&&o.offsetAsPoint.mag())>0?ce.center:Q,Oe=F?+o.zoom:d+Ta(x.lat,Ie.lat),Le=d+Ta(x.lat,0),qe=Oe+Ta(Ie.lat,0),nt=s.bK(x.lng,Ie.lng),He=s.bK(x.lat,Ie.lat),rt=s.aq(qe-Le);return q=Oe!==d,{easeFunc:ot=>{if(s.bo(A,R)||El({startEulerAngles:A,endEulerAngles:R,tr:t,k:ot,useSlerp:A.roll!=R.roll}),V&&t.interpolatePadding(S,o.padding,ot),o.around)s.w("Easing around a point is not supported under globe projection."),t.setLocationAtPoint(o.around,o.aroundPoint);else{const Xe=qe>Le?Math.min(2,rt):Math.max(.5,rt),ft=Math.pow(Xe,1-ot),Pt=_u(x,nt,He,ot*ft);t.setCenter(Pt.wrap())}if(q){const Xe=s.G.number(Le,qe,ot)+Ta(0,t.center.lat);t.setZoom(Xe)}},isZooming:q,elevationCenter:Ie}}handleFlyTo(t,o){const d=o.zoom!==void 0,x=t.center,S=t.zoom,A=t.padding,R=!t.isPaddingEqual(o.padding),F=t.applyConstrain(s.V.convert(o.center||o.locationAtOffset),S).center,V=d?+o.zoom:t.zoom+Ta(t.center.lat,F.lat),q=t.clone();q.setCenter(F),q.setZoom(V),q.setBearing(o.bearing);const te=new s.P(s.an(t.centerPoint.x+o.offsetAsPoint.x,0,t.width),s.an(t.centerPoint.y+o.offsetAsPoint.y,0,t.height));q.setLocationAtPoint(F,te);const Q=q.center;vo(t,Q);const ce=(function(He,rt,ot){const Xe=ca(rt),ft=ca(ot),Pt=s.b5(Xe,ft),Et=Math.acos(Pt),Ct=Ii(He);return Et/(2*Math.PI)*Ct})(t,x,Q),_e=S+Ta(x.lat,0),Ie=V+Ta(Q.lat,0),Oe=s.aq(Ie-_e);let Le;if(typeof o.minZoom=="number"){const He=+o.minZoom+Ta(Q.lat,0),rt=Math.min(He,_e,Ie)+Ta(0,Q.lat),ot=t.applyConstrain(Q,rt).zoom+Ta(Q.lat,0);Le=s.aq(ot-_e)}const qe=s.bK(x.lng,Q.lng),nt=s.bK(x.lat,Q.lat);return{easeFunc:(He,rt,ot,Xe)=>{const ft=_u(x,qe,nt,ot);R&&t.interpolatePadding(A,o.padding,He);const Pt=He===1?Q:ft;t.setCenter(Pt.wrap());const Et=_e+s.at(rt);t.setZoom(He===1?V:Et+Ta(0,Pt.lat))},scaleOfZoom:Oe,targetCenter:Q,scaleOfMinZoom:Le,pixelPathLength:ce}}static solveVectorScale(t,o,d,x,S){const A=x==="x"?[d[0],d[4],d[8],d[12]]:[d[1],d[5],d[9],d[13]],R=[d[3],d[7],d[11],d[15]],F=t[0]*A[0]+t[1]*A[1]+t[2]*A[2],V=t[0]*R[0]+t[1]*R[1]+t[2]*R[2],q=o[0]*A[0]+o[1]*A[1]+o[2]*A[2],te=o[0]*R[0]+o[1]*R[1]+o[2]*R[2];return q+S*V===F+S*te||R[3]*(F-q)+A[3]*(te-V)+F*te==q*V?null:(q+A[3]-S*te-S*R[3])/(q-F-S*te+S*V)}static getLesserNonNegativeNonNull(t,o){return o!==null&&o>=0&&o<t?o:t}}class To{constructor(t){this._globe=t,this._mercatorCameraHelper=new ls,this._verticalPerspectiveCameraHelper=new Ra}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(t,o){return this.currentHelper.handlePanInertia(t,o)}handleMapControlsRollPitchBearingZoom(t,o){return this.currentHelper.handleMapControlsRollPitchBearingZoom(t,o)}handleMapControlsPan(t,o,d){this.currentHelper.handleMapControlsPan(t,o,d)}cameraForBoxAndBearing(t,o,d,x,S){return this.currentHelper.cameraForBoxAndBearing(t,o,d,x,S)}handleJumpToCenterZoom(t,o){this.currentHelper.handleJumpToCenterZoom(t,o)}handleEaseTo(t,o){return this.currentHelper.handleEaseTo(t,o)}handleFlyTo(t,o){return this.currentHelper.handleFlyTo(t,o)}}const ac=(w,t)=>s.B(w,t&&t.filter((o=>o.identifier!=="source.canvas"))),So=s.bO();class eo extends s.E{constructor(t,o={}){var d,x;super(),this._rtlPluginLoaded=()=>{for(const A in this.tileManagers){const R=this.tileManagers[A].getSource().type;R!=="vector"&&R!=="geojson"||this.tileManagers[A].reload()}},this.map=t,this.dispatcher=new Yt(jt(),t._getMapId()),this.dispatcher.registerMessageHandler("GG",((A,R)=>this.getGlyphs(A,R))),this.dispatcher.registerMessageHandler("GI",((A,R)=>this.getImages(A,R))),this.dispatcher.registerMessageHandler("GDA",((A,R)=>this.getDashes(A,R))),this.imageManager=new pe,this.imageManager.setEventedParent(this);const S=((d=t._container)===null||d===void 0?void 0:d.lang)||typeof document<"u"&&((x=document.documentElement)===null||x===void 0?void 0:x.lang)||void 0;this.glyphManager=new We(t._requestManager,o.localIdeographFontFamily,S),this.lineAtlas=new Ve(256,512),this.crossTileSymbolIndex=new ba,this._setInitialValues(),this._resetUpdates(),this.dispatcher.broadcast("SR",s.bP()),lt().on(je,this._rtlPluginLoaded),this.on("data",(A=>{if(A.dataType!=="source"||A.sourceDataType!=="metadata")return;const R=this.tileManagers[A.sourceId];if(!R)return;const F=R.getSource();if(F&&F.vectorLayerIds)for(const V in this._layers){const q=this._layers[V];q.source===F.id&&this._validateLayer(q)}}))}_setInitialValues(){var t;this._spritesImagesIds={},this._layers={},this._order=[],this.tileManagers={},this.zoomHistory=new s.bQ,this._availableImages=[],this._globalState={},this._serializedLayers={},this.stylesheet=null,this.light=null,this.sky=null,this.projection&&(this.projection.destroy(),delete this.projection),this._loaded=!1,this._changed=!1,this._updatedLayers={},this._updatedSources={},this._changedImages={},this._glyphsDidChange=!1,this._updatedPaintProps={},this._layerOrderChanged=!1,this.crossTileSymbolIndex=new(((t=this.crossTileSymbolIndex)===null||t===void 0?void 0:t.constructor)||Object),this.pauseablePlacement=void 0,this.placement=void 0,this.z=0}setGlobalStateProperty(t,o){var d,x,S;this._checkLoaded();const A=o===null?(S=(x=(d=this.stylesheet.state)===null||d===void 0?void 0:d[t])===null||x===void 0?void 0:x.default)!==null&&S!==void 0?S:null:o;if(s.bR(A,this._globalState[t]))return this;this._globalState[t]=A,this._applyGlobalStateChanges([t])}getGlobalState(){return this._globalState}setGlobalState(t){this._checkLoaded();const o=[];for(const d in t)!s.bR(this._globalState[d],t[d].default)&&(o.push(d),this._globalState[d]=t[d].default);this._applyGlobalStateChanges(o)}_applyGlobalStateChanges(t){if(t.length===0)return;const o=new Set,d={};for(const x of t){d[x]=this._globalState[x];for(const S in this._layers){const A=this._layers[S],R=A.getLayoutAffectingGlobalStateRefs(),F=A.getPaintAffectingGlobalStateRefs(),V=A.getVisibilityAffectingGlobalStateRefs();if(R.has(x)&&o.add(A.source),F.has(x))for(const{name:q,value:te}of F.get(x))this._updatePaintProperty(A,q,te);V?.has(x)&&(A.recalculateVisibility(),this._updateLayer(A))}}this.dispatcher.broadcast("UGS",d);for(const x in this.tileManagers)o.has(x)&&(this._reloadSource(x),this._changed=!0)}loadURL(t,o={},d){this.fire(new s.l("dataloading",{dataType:"style"})),o.validate=typeof o.validate!="boolean"||o.validate;const x=this.map._requestManager.transformRequest(t,"Style");this._loadStyleRequest=new AbortController;const S=this._loadStyleRequest;s.j(x,this._loadStyleRequest).then((A=>{this._loadStyleRequest=null,this._load(A.data,o,d)})).catch((A=>{this._loadStyleRequest=null,A&&!S.signal.aborted&&this.fire(new s.k(A))}))}loadJSON(t,o={},d){this.fire(new s.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,j.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,o.validate=o.validate!==!1,this._load(t,o,d)})).catch((()=>{}))}loadEmpty(){this.fire(new s.l("dataloading",{dataType:"style"})),this._load(So,{validate:!1})}_load(t,o,d){var x,S;let A=o.transformStyle?o.transformStyle(d,t):t;if(!o.validate||!ac(this,s.C(A))){A=Object.assign({},A),this._loaded=!0,this.stylesheet=A;for(const R in A.sources)this.addSource(R,A.sources[R],{validate:!1});A.sprite?this._loadSprite(A.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(A.glyphs),this._createLayers(),this.light=new Mt(this.stylesheet.light),this._setProjectionInternal(((x=this.stylesheet.projection)===null||x===void 0?void 0:x.type)||"mercator"),this.sky=new re(this.stylesheet.sky),this.map.setTerrain((S=this.stylesheet.terrain)!==null&&S!==void 0?S:null),this.fire(new s.l("data",{dataType:"style"})),this.fire(new s.l("style.load"))}}_createLayers(){var t,o,d;const x=s.bS(this.stylesheet.layers);this.setGlobalState((t=this.stylesheet.state)!==null&&t!==void 0?t:null),this.dispatcher.broadcast("SL",x),this._order=x.map((S=>S.id)),this._layers={},this._serializedLayers=null;for(const S of x){const A=s.bT(S,this._globalState);if(A.setEventedParent(this,{layer:{id:S.id}}),this._layers[S.id]=A,s.bU(A)&&this.tileManagers[A.source]){const R=(d=(o=S.paint)===null||o===void 0?void 0:o["raster-fade-duration"])!==null&&d!==void 0?d:A.paint.get("raster-fade-duration");this.tileManagers[A.source].setRasterFadeDuration(R)}}}_loadSprite(t,o=!1,d=void 0){this.imageManager.setLoaded(!1);const x=new AbortController;let S;this._spriteRequest=x,(function(A,R,F,V){return s._(this,void 0,void 0,(function*(){const q=we(A),te=F>1?"@2x":"",Q={},ce={};for(const{id:_e,url:Ie}of q){const Oe=R.transformRequest(Ge(Ie,te,".json"),"SpriteJSON");Q[_e]=s.j(Oe,V);const Le=R.transformRequest(Ge(Ie,te,".png"),"SpriteImage");ce[_e]=ie.getImage(Le,V)}return yield Promise.all([...Object.values(Q),...Object.values(ce)]),(function(_e,Ie){return s._(this,void 0,void 0,(function*(){const Oe={};for(const Le in _e){Oe[Le]={};const qe=j.getImageCanvasContext((yield Ie[Le]).data),nt=(yield _e[Le]).data;for(const He in nt){const{width:rt,height:ot,x:Xe,y:ft,sdf:Pt,pixelRatio:Et,stretchX:Ct,stretchY:Dt,content:ur,textFitWidth:fr,textFitHeight:tr}=nt[He];Oe[Le][He]={data:null,pixelRatio:Et,sdf:Pt,stretchX:Ct,stretchY:Dt,content:ur,textFitWidth:fr,textFitHeight:tr,spriteData:{width:rt,height:ot,x:Xe,y:ft,context:qe}}}}return Oe}))})(Q,ce)}))})(t,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((A=>{if(this._spriteRequest=null,A)for(const R in A){this._spritesImagesIds[R]=[];const F=this._spritesImagesIds[R]?this._spritesImagesIds[R].filter((V=>!(V in A))):[];for(const V of F)this.imageManager.removeImage(V),this._changedImages[V]=!0;for(const V in A[R]){const q=R==="default"?V:`${R}:${V}`;this._spritesImagesIds[R].push(q),q in this.imageManager.images?this.imageManager.updateImage(q,A[R][V],!1):this.imageManager.addImage(q,A[R][V]),o&&(this._changedImages[q]=!0)}}})).catch((A=>{this._spriteRequest=null,S=A,x.signal.aborted||this.fire(new s.k(S))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),o&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"})),d&&d(S)}))}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}_validateLayer(t){const o=this.tileManagers[t.source];if(!o)return;const d=t.sourceLayer;if(!d)return;const x=o.getSource();(x.type==="geojson"||x.vectorLayerIds&&x.vectorLayerIds.indexOf(d)===-1)&&this.fire(new s.k(new Error(`Source layer "${d}" does not exist on source "${x.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.tileManagers)if(!this.tileManagers[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t,o=!1){const d=this._serializedAllLayers();if(!t||t.length===0)return Object.values(o?s.bV(d):d);const x=[];for(const S of t)if(d[S]){const A=o?s.bV(d[S]):d[S];x.push(A)}return x}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const o=Object.keys(this._layers);for(const d of o){const x=this._layers[d];x.type!=="custom"&&(t[d]=x.serialize())}return t}hasTransitions(){var t,o,d;if(!((t=this.light)===null||t===void 0)&&t.hasTransition()||!((o=this.sky)===null||o===void 0)&&o.hasTransition()||!((d=this.projection)===null||d===void 0)&&d.hasTransition())return!0;for(const x in this.tileManagers)if(this.tileManagers[x].hasTransition())return!0;for(const x in this._layers)if(this._layers[x].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const o=this._changed;if(o){const x=Object.keys(this._updatedLayers),S=Object.keys(this._removedLayers);(x.length||S.length)&&this._updateWorkerLayers(x,S);for(const A in this._updatedSources){const R=this._updatedSources[A];if(R==="reload")this._reloadSource(A);else{if(R!=="clear")throw new Error(`Invalid action ${R}`);this._clearSource(A)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const A in this._updatedPaintProps)this._layers[A].updateTransitions(t);this.light.updateTransitions(t),this.sky.updateTransitions(t),this._resetUpdates()}const d={};for(const x in this.tileManagers){const S=this.tileManagers[x];d[x]=S.used,S.used=!1}for(const x of this._order){const S=this._layers[x];S.recalculate(t,this._availableImages),!S.isHidden(t.zoom)&&S.source&&(this.tileManagers[S.source].used=!0)}for(const x in d){const S=this.tileManagers[x];!!d[x]!=!!S.used&&S.fire(new s.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:x}))}this.light.recalculate(t),this.sky.recalculate(t),this.projection.recalculate(t),this.z=t.zoom,o&&this.fire(new s.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const o in this.tileManagers)this.tileManagers[o].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.tileManagers)this.tileManagers[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,o){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(t,!1),removedIds:o})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,o={}){var d;this._checkLoaded();const x=this.serialize();if(t=o.transformStyle?o.transformStyle(x,t):t,((d=o.validate)===null||d===void 0||d)&&ac(this,s.C(t)))return!1;(t=s.bV(t)).layers=s.bS(t.layers);const S=s.bW(x,t),A=this._getOperationsToPerform(S);if(A.unimplemented.length>0)throw new Error(`Unimplemented: ${A.unimplemented.join(", ")}.`);if(A.operations.length===0)return!1;for(const R of A.operations)R();return this.stylesheet=t,this._serializedLayers=null,!0}_getOperationsToPerform(t){const o=[],d=[];for(const x of t)switch(x.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":o.push((()=>this.addLayer.apply(this,x.args)));break;case"removeLayer":o.push((()=>this.removeLayer.apply(this,x.args)));break;case"setPaintProperty":o.push((()=>this.setPaintProperty.apply(this,x.args)));break;case"setLayoutProperty":o.push((()=>this.setLayoutProperty.apply(this,x.args)));break;case"setFilter":o.push((()=>this.setFilter.apply(this,x.args)));break;case"addSource":o.push((()=>this.addSource.apply(this,x.args)));break;case"removeSource":o.push((()=>this.removeSource.apply(this,x.args)));break;case"setLayerZoomRange":o.push((()=>this.setLayerZoomRange.apply(this,x.args)));break;case"setLight":o.push((()=>this.setLight.apply(this,x.args)));break;case"setGeoJSONSourceData":o.push((()=>this.setGeoJSONSourceData.apply(this,x.args)));break;case"setGlyphs":o.push((()=>this.setGlyphs.apply(this,x.args)));break;case"setSprite":o.push((()=>this.setSprite.apply(this,x.args)));break;case"setTerrain":o.push((()=>this.map.setTerrain.apply(this,x.args)));break;case"setSky":o.push((()=>this.setSky.apply(this,x.args)));break;case"setProjection":this.setProjection.apply(this,x.args);break;case"setGlobalState":o.push((()=>this.setGlobalState.apply(this,x.args)));break;case"setTransition":o.push((()=>{}));break;default:d.push(x.command)}return{operations:o,unimplemented:d}}addImage(t,o){if(this.getImage(t))return this.fire(new s.k(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,o),this._afterImageUpdated(t)}updateImage(t,o){this.imageManager.updateImage(t,o)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new s.k(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,o,d={}){if(this._checkLoaded(),this.tileManagers[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!o.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(o).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(o.type)>=0&&this._validate(s.C.source,`sources.${t}`,o,null,d))return;this.map&&this.map._collectResourceTiming&&(o.collectResourceTiming=!0);const x=this.tileManagers[t]=new Re(t,o,this.dispatcher);x.style=this,x.setEventedParent(this,(()=>({isSourceLoaded:x.loaded(),source:x.serialize(),sourceId:t}))),x.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.tileManagers[t]===void 0)throw new Error("There is no source with this ID");for(const d in this._layers)if(this._layers[d].source===t)return this.fire(new s.k(new Error(`Source "${t}" cannot be removed while layer "${d}" is using it.`)));const o=this.tileManagers[t];delete this.tileManagers[t],delete this._updatedSources[t],o.fire(new s.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),o.setEventedParent(null),o.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,o){if(this._checkLoaded(),this.tileManagers[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const d=this.tileManagers[t].getSource();if(d.type!=="geojson")throw new Error(`geojsonSource.type is ${d.type}, which is !== 'geojson`);d.setData(o),this._changed=!0}getSource(t){return this.tileManagers[t]&&this.tileManagers[t].getSource()}addLayer(t,o,d={}){this._checkLoaded();const x=t.id;if(this.getLayer(x))return void this.fire(new s.k(new Error(`Layer "${x}" already exists on this map.`)));let S;if(t.type==="custom"){if(ac(this,s.bX(t)))return;S=s.bT(t,this._globalState)}else{if("source"in t&&typeof t.source=="object"&&(this.addSource(x,t.source),t=s.bV(t),t=s.e(t,{source:x})),this._validate(s.C.layer,`layers.${x}`,t,{arrayIndex:-1},d))return;S=s.bT(t,this._globalState),this._validateLayer(S),S.setEventedParent(this,{layer:{id:x}})}const A=o?this._order.indexOf(o):this._order.length;if(o&&A===-1)this.fire(new s.k(new Error(`Cannot add layer "${x}" before non-existing layer "${o}".`)));else{if(this._order.splice(A,0,x),this._layerOrderChanged=!0,this._layers[x]=S,this._removedLayers[x]&&S.source&&S.type!=="custom"){const R=this._removedLayers[x];delete this._removedLayers[x],R.type!==S.type?this._updatedSources[S.source]="clear":(this._updatedSources[S.source]="reload",this.tileManagers[S.source].pause())}this._updateLayer(S),S.onAdd&&S.onAdd(this.map)}}moveLayer(t,o){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new s.k(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===o)return;const d=this._order.indexOf(t);this._order.splice(d,1);const x=o?this._order.indexOf(o):this._order.length;o&&x===-1?this.fire(new s.k(new Error(`Cannot move layer "${t}" before non-existing layer "${o}".`))):(this._order.splice(x,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const o=this._layers[t];if(!o)return void this.fire(new s.k(new Error(`Cannot remove non-existing layer "${t}".`)));o.setEventedParent(null);const d=this._order.indexOf(t);this._order.splice(d,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=o,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],o.onRemove&&o.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,o,d){this._checkLoaded();const x=this.getLayer(t);x?x.minzoom===o&&x.maxzoom===d||(o!=null&&(x.minzoom=o),d!=null&&(x.maxzoom=d),this._updateLayer(x)):this.fire(new s.k(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,o,d={}){this._checkLoaded();const x=this.getLayer(t);if(x){if(!s.bR(x.filter,o))return o==null?(x.setFilter(void 0),void this._updateLayer(x)):void(this._validate(s.C.filter,`layers.${x.id}.filter`,o,null,d)||(x.setFilter(s.bV(o)),this._updateLayer(x)))}else this.fire(new s.k(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return s.bV(this.getLayer(t).filter)}setLayoutProperty(t,o,d,x={}){this._checkLoaded();const S=this.getLayer(t);S?s.bR(S.getLayoutProperty(o),d)||(S.setLayoutProperty(o,d,x),this._updateLayer(S)):this.fire(new s.k(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,o){const d=this.getLayer(t);if(d)return d.getLayoutProperty(o);this.fire(new s.k(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,o,d,x={}){this._checkLoaded();const S=this.getLayer(t);S?s.bR(S.getPaintProperty(o),d)||this._updatePaintProperty(S,o,d,x):this.fire(new s.k(new Error(`Cannot style non-existing layer "${t}".`)))}_updatePaintProperty(t,o,d,x={}){t.setPaintProperty(o,d,x)&&this._updateLayer(t),s.bU(t)&&o==="raster-fade-duration"&&this.tileManagers[t.source].setRasterFadeDuration(d),this._changed=!0,this._updatedPaintProps[t.id]=!0,this._serializedLayers=null}getPaintProperty(t,o){return this.getLayer(t).getPaintProperty(o)}setFeatureState(t,o){this._checkLoaded();const d=t.source,x=t.sourceLayer,S=this.tileManagers[d];if(S===void 0)return void this.fire(new s.k(new Error(`The source '${d}' does not exist in the map's style.`)));const A=S.getSource().type;A==="geojson"&&x?this.fire(new s.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):A!=="vector"||x?(t.id===void 0&&this.fire(new s.k(new Error("The feature id parameter must be provided."))),S.setFeatureState(x,t.id,o)):this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,o){this._checkLoaded();const d=t.source,x=this.tileManagers[d];if(x===void 0)return void this.fire(new s.k(new Error(`The source '${d}' does not exist in the map's style.`)));const S=x.getSource().type,A=S==="vector"?t.sourceLayer:void 0;S!=="vector"||A?o&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new s.k(new Error("A feature id is required to remove its specific state property."))):x.removeFeatureState(A,t.id,o):this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const o=t.source,d=t.sourceLayer,x=this.tileManagers[o];if(x!==void 0)return x.getSource().type!=="vector"||d?(t.id===void 0&&this.fire(new s.k(new Error("The feature id parameter must be provided."))),x.getFeatureState(d,t.id)):void this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new s.k(new Error(`The source '${o}' does not exist in the map's style.`)))}getTransition(){return s.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=s.bY(this.tileManagers,(S=>S.serialize())),o=this._serializeByIds(this._order,!0),d=this.map.getTerrain()||void 0,x=this.stylesheet;return s.bZ({version:x.version,name:x.name,metadata:x.metadata,light:x.light,sky:x.sky,center:x.center,zoom:x.zoom,bearing:x.bearing,pitch:x.pitch,sprite:x.sprite,glyphs:x.glyphs,transition:x.transition,projection:x.projection,sources:t,layers:o,terrain:d},(S=>S!==void 0))}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.tileManagers[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.tileManagers[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const o=A=>this._layers[A].type==="fill-extrusion",d={},x=[];for(let A=this._order.length-1;A>=0;A--){const R=this._order[A];if(o(R)){d[R]=A;for(const F of t){const V=F[R];if(V)for(const q of V)x.push(q)}}}x.sort(((A,R)=>R.intersectionZ-A.intersectionZ));const S=[];for(let A=this._order.length-1;A>=0;A--){const R=this._order[A];if(o(R))for(let F=x.length-1;F>=0;F--){const V=x[F].feature;if(d[V.layer.id]<A)break;S.push(V),x.pop()}else for(const F of t){const V=F[R];if(V)for(const q of V)S.push(q.feature)}}return S}queryRenderedFeatures(t,o,d){o&&o.filter&&this._validate(s.C.filter,"queryRenderedFeatures.filter",o.filter,null,o);const x={};if(o&&o.layers){if(!(Array.isArray(o.layers)||o.layers instanceof Set))return this.fire(new s.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const V of o.layers){const q=this._layers[V];if(!q)return this.fire(new s.k(new Error(`The layer '${V}' does not exist in the map's style and cannot be queried for features.`))),[];x[q.source]=!0}}const S=[];o.availableImages=this._availableImages;const A=this._serializedAllLayers(),R=o.layers instanceof Set?o.layers:Array.isArray(o.layers)?new Set(o.layers):null,F=Object.assign(Object.assign({},o),{layers:R,globalState:this._globalState});for(const V in this.tileManagers)o.layers&&!x[V]||S.push(_n(this.tileManagers[V],this._layers,A,t,F,d,this.map.terrain?(q,te,Q)=>this.map.terrain.getElevation(q,te,Q):void 0));return this.placement&&S.push((function(V,q,te,Q,ce,_e,Ie){const Oe={},Le=_e.queryRenderedSymbols(Q),qe=[];for(const nt of Object.keys(Le).map(Number))qe.push(Ie[nt]);qe.sort(se);for(const nt of qe){const He=nt.featureIndex.lookupSymbolFeatures(Le[nt.bucketInstanceId],q,nt.bucketIndex,nt.sourceLayerIndex,{filterSpec:ce.filter,globalState:ce.globalState},ce.layers,ce.availableImages,V);for(const rt in He){const ot=Oe[rt]=Oe[rt]||[],Xe=He[rt];Xe.sort(((ft,Pt)=>{const Et=nt.featureSortOrder;if(Et){const Ct=Et.indexOf(ft.featureIndex);return Et.indexOf(Pt.featureIndex)-Ct}return Pt.featureIndex-ft.featureIndex}));for(const ft of Xe)ot.push(ft)}}return(function(nt,He,rt){for(const ot in nt)for(const Xe of nt[ot])Rt(Xe,rt[He[ot].source]);return nt})(Oe,V,te)})(this._layers,A,this.tileManagers,t,F,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(S)}querySourceFeatures(t,o){o?.filter&&this._validate(s.C.filter,"querySourceFeatures.filter",o.filter,null,o);const d=this.tileManagers[t];return d?(function(x,S){const A=x.getRenderableIds().map((V=>x.getTileByID(V))),R=[],F={};for(let V=0;V<A.length;V++){const q=A[V],te=q.tileID.canonical.key;F[te]||(F[te]=!0,q.querySourceFeatures(R,S))}return R})(d,o?Object.assign(Object.assign({},o),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(t,o={}){this._checkLoaded();const d=this.light.getLight();let x=!1;for(const A in t)if(!s.bR(t[A],d[A])){x=!0;break}if(!x)return;const S={now:z(),transition:s.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,o),this.light.updateTransitions(S)}getProjection(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.projection}setProjection(t){if(this._checkLoaded(),this.projection){if(this.projection.name===t.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=t,this._setProjectionInternal(t.type)}getSky(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.sky}setSky(t,o={}){this._checkLoaded();const d=this.getSky();let x=!1;if(!t&&!d)return;if(t&&!d)x=!0;else if(!t&&d)x=!0;else for(const A in t)if(!s.bR(t[A],d[A])){x=!0;break}if(!x)return;const S={now:z(),transition:s.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=t,this.sky.setSky(t,o),this.sky.updateTransitions(S)}_setProjectionInternal(t){const o=(function(d,x){const S={constrainOverride:x};if(Array.isArray(d)){const A=new mu({type:d});return{projection:A,transform:new nc(S),cameraHelper:new To(A)}}switch(d){case"mercator":return{projection:new la,transform:new qa(S),cameraHelper:new ls};case"globe":{const A=new mu({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:A,transform:new nc(S),cameraHelper:new To(A)}}case"vertical-perspective":return{projection:new tc,transform:new Jo(S),cameraHelper:new Ra};default:return s.w(`Unknown projection name: ${d}. Falling back to mercator projection.`),{projection:new la,transform:new qa(S),cameraHelper:new ls}}})(t,this.map.transformConstrain);this.projection=o.projection,this.map.migrateProjection(o.transform,o.cameraHelper);for(const d in this.tileManagers)this.tileManagers[d].reload()}_validate(t,o,d,x,S={}){return(!S||S.validate!==!1)&&ac(this,t.call(s.C,s.e({key:o,style:this.serialize(),value:d,styleSpec:s.u},x)))}_remove(t=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),lt().off(je,this._rtlPluginLoaded);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this.tileManagers){const d=this.tileManagers[o];d.setEventedParent(null),d.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),t&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(t)}_clearSource(t){this.tileManagers[t].clearTiles()}_reloadSource(t){this.tileManagers[t].resume(),this.tileManagers[t].reload()}_updateSources(t){for(const o in this.tileManagers)this.tileManagers[o].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.tileManagers)this._reloadSource(t)}_updatePlacement(t,o,d,x,S=!1){let A=!1,R=!1;const F={};for(const V of this._order){const q=this._layers[V];if(q.type!=="symbol")continue;if(!F[q.source]){const Q=this.tileManagers[q.source];F[q.source]=Q.getRenderableIds(!0).map((ce=>Q.getTileByID(ce))).sort(((ce,_e)=>_e.tileID.overscaledZ-ce.tileID.overscaledZ||(ce.tileID.isLessThan(_e.tileID)?-1:1)))}const te=this.crossTileSymbolIndex.addLayer(q,F[q.source],t.center.lng);A=A||te}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((S=S||this._layerOrderChanged||d===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(z(),t.zoom))&&(this.pauseablePlacement=new Ql(t,this.map.terrain,this._order,S,o,d,x,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,F),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(z()),R=!0),A&&this.pauseablePlacement.placement.setStale()),R||A)for(const V of this._order){const q=this._layers[V];q.type==="symbol"&&this.placement.updateLayerOpacities(q,F[q.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(z())}_releaseSymbolFadeTiles(){for(const t in this.tileManagers)this.tileManagers[t].releaseSymbolFadeTiles()}getImages(t,o){return s._(this,void 0,void 0,(function*(){const d=yield this.imageManager.getImages(o.icons);this._updateTilesForChangedImages();const x=this.tileManagers[o.source];return x&&x.setDependencies(o.tileID.key,o.type,o.icons),d}))}getGlyphs(t,o){return s._(this,void 0,void 0,(function*(){const d=yield this.glyphManager.getGlyphs(o.stacks),x=this.tileManagers[o.source];return x&&x.setDependencies(o.tileID.key,o.type,[""]),d}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,o={}){this._checkLoaded(),t&&this._validate(s.C.glyphs,"glyphs",t,null,o)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}getDashes(t,o){return s._(this,void 0,void 0,(function*(){const d={};for(const[x,S]of Object.entries(o.dashes))d[x]=this.lineAtlas.getDash(S.dasharray,S.round);return d}))}addSprite(t,o,d={},x){this._checkLoaded();const S=[{id:t,url:o}],A=[...we(this.stylesheet.sprite),...S];this._validate(s.C.sprite,"sprite",A,null,d)||(this.stylesheet.sprite=A,this._loadSprite(S,!0,x))}removeSprite(t){this._checkLoaded();const o=we(this.stylesheet.sprite);if(o.find((d=>d.id===t))){if(this._spritesImagesIds[t])for(const d of this._spritesImagesIds[t])this.imageManager.removeImage(d),this._changedImages[d]=!0;o.splice(o.findIndex((d=>d.id===t)),1),this.stylesheet.sprite=o.length>0?o:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}else this.fire(new s.k(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return we(this.stylesheet.sprite)}setSprite(t,o={},d){this._checkLoaded(),t&&this._validate(s.C.sprite,"sprite",t,null,o)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,d):(this._unloadSprite(),d&&d(null)))}destroy(){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null);for(const t in this.tileManagers){const o=this.tileManagers[t];o.setEventedParent(null),o.onRemove(this.map)}this.tileManagers={},this.imageManager&&(this.imageManager.setEventedParent(null),this.imageManager.destroy(),this._availableImages=[],this._spritesImagesIds={}),this.glyphManager&&this.glyphManager.destroy();for(const t in this._layers){const o=this._layers[t];o.setEventedParent(null),o.onRemove&&o.onRemove(this.map)}this._setInitialValues(),this.setEventedParent(null),this.dispatcher.unregisterMessageHandler("GG"),this.dispatcher.unregisterMessageHandler("GI"),this.dispatcher.unregisterMessageHandler("GDA"),this.dispatcher.remove(!0),this._listeners={},this._oneTimeListeners={}}}var lh=s.aU([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Dl{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,o,d,x,S,A,R,F,V){this.context=t;let q=this.boundPaintVertexBuffers.length!==x.length;for(let te=0;!q&&te<x.length;te++)this.boundPaintVertexBuffers[te]!==x[te]&&(q=!0);!this.vao||this.boundProgram!==o||this.boundLayoutVertexBuffer!==d||q||this.boundIndexBuffer!==S||this.boundVertexOffset!==A||this.boundDynamicVertexBuffer!==R||this.boundDynamicVertexBuffer2!==F||this.boundDynamicVertexBuffer3!==V?this.freshBind(o,d,x,S,A,R,F,V):(t.bindVertexArray.set(this.vao),R&&R.bind(),S&&S.dynamicDraw&&S.bind(),F&&F.bind(),V&&V.bind())}freshBind(t,o,d,x,S,A,R,F){const V=t.numAttributes,q=this.context,te=q.gl;this.vao&&this.destroy(),this.vao=q.createVertexArray(),q.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=o,this.boundPaintVertexBuffers=d,this.boundIndexBuffer=x,this.boundVertexOffset=S,this.boundDynamicVertexBuffer=A,this.boundDynamicVertexBuffer2=R,this.boundDynamicVertexBuffer3=F,o.enableAttributes(te,t);for(const Q of d)Q.enableAttributes(te,t);A&&A.enableAttributes(te,t),R&&R.enableAttributes(te,t),F&&F.enableAttributes(te,t),o.bind(),o.setVertexAttribPointers(te,t,S);for(const Q of d)Q.bind(),Q.setVertexAttribPointers(te,t,S);A&&(A.bind(),A.setVertexAttribPointers(te,t,S)),x&&x.bind(),R&&(R.bind(),R.setVertexAttribPointers(te,t,S)),F&&(F.bind(),F.setVertexAttribPointers(te,t,S)),q.currentNumAttributes=V}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Xh=(w,t,o,d,x)=>({u_texture:0,u_ele_delta:w,u_fog_matrix:t,u_fog_color:o?o.properties.get("fog-color"):s.bp.white,u_fog_ground_blend:o?o.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:x?0:o?o.calculateFogBlendOpacity(d):0,u_horizon_color:o?o.properties.get("horizon-color"):s.bp.white,u_horizon_fog_blend:o?o.properties.get("horizon-fog-blend"):1,u_is_globe_mode:x?1:0}),Is={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function xu(w){const t=[];for(let o=0;o<w.length;o++){if(w[o]===null)continue;const d=w[o].split(" ");t.push(d.pop())}return t}class Za{constructor(t,o,d,x,S,A,R,F,V=[]){const q=t.gl;this.program=q.createProgram();const te=xu(o.staticAttributes),Q=d?d.getBinderAttributes():[],ce=te.concat(Q),_e=wa.prelude.staticUniforms?xu(wa.prelude.staticUniforms):[],Ie=R.staticUniforms?xu(R.staticUniforms):[],Oe=o.staticUniforms?xu(o.staticUniforms):[],Le=d?d.getBinderUniforms():[],qe=_e.concat(Ie).concat(Oe).concat(Le),nt=[];for(const Et of qe)nt.indexOf(Et)<0&&nt.push(Et);const He=d?d.defines():[];_i(q)&&He.unshift("#version 300 es"),S&&He.push("#define OVERDRAW_INSPECTOR;"),A&&He.push("#define TERRAIN3D;"),F&&He.push(F),V&&He.push(...V);let rt=He.concat(wa.prelude.fragmentSource,R.fragmentSource,o.fragmentSource).join(`
`),ot=He.concat(wa.prelude.vertexSource,R.vertexSource,o.vertexSource).join(`
`);_i(q)||(rt=(function(Et){return Et.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")})(rt),ot=(function(Et){return Et.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")})(ot));const Xe=q.createShader(q.FRAGMENT_SHADER);if(q.isContextLost())return void(this.failedToCreate=!0);if(q.shaderSource(Xe,rt),q.compileShader(Xe),!q.getShaderParameter(Xe,q.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${q.getShaderInfoLog(Xe)}`);q.attachShader(this.program,Xe);const ft=q.createShader(q.VERTEX_SHADER);if(q.isContextLost())return void(this.failedToCreate=!0);if(q.shaderSource(ft,ot),q.compileShader(ft),!q.getShaderParameter(ft,q.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${q.getShaderInfoLog(ft)}`);q.attachShader(this.program,ft),this.attributes={};const Pt={};this.numAttributes=ce.length;for(let Et=0;Et<this.numAttributes;Et++)ce[Et]&&(q.bindAttribLocation(this.program,Et,ce[Et]),this.attributes[ce[Et]]=Et);if(q.linkProgram(this.program),!q.getProgramParameter(this.program,q.LINK_STATUS))throw new Error(`Program failed to link: ${q.getProgramInfoLog(this.program)}`);q.deleteShader(ft),q.deleteShader(Xe);for(let Et=0;Et<nt.length;Et++){const Ct=nt[Et];if(Ct&&!Pt[Ct]){const Dt=q.getUniformLocation(this.program,Ct);Dt&&(Pt[Ct]=Dt)}}this.fixedUniforms=x(t,Pt),this.terrainUniforms=((Et,Ct)=>({u_depth:new s.b_(Et,Ct.u_depth),u_terrain:new s.b_(Et,Ct.u_terrain),u_terrain_dim:new s.bq(Et,Ct.u_terrain_dim),u_terrain_matrix:new s.c0(Et,Ct.u_terrain_matrix),u_terrain_unpack:new s.c1(Et,Ct.u_terrain_unpack),u_terrain_exaggeration:new s.bq(Et,Ct.u_terrain_exaggeration)}))(t,Pt),this.projectionUniforms=((Et,Ct)=>({u_projection_matrix:new s.c0(Et,Ct.u_projection_matrix),u_projection_tile_mercator_coords:new s.c1(Et,Ct.u_projection_tile_mercator_coords),u_projection_clipping_plane:new s.c1(Et,Ct.u_projection_clipping_plane),u_projection_transition:new s.bq(Et,Ct.u_projection_transition),u_projection_fallback_matrix:new s.c0(Et,Ct.u_projection_fallback_matrix)}))(t,Pt),this.binderUniforms=d?d.getUniforms(t,Pt):[]}draw(t,o,d,x,S,A,R,F,V,q,te,Q,ce,_e,Ie,Oe,Le,qe,nt){const He=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(d),t.setStencilMode(x),t.setColorMode(S),t.setCullFace(A),F){t.activeTexture.set(He.TEXTURE2),He.bindTexture(He.TEXTURE_2D,F.depthTexture),t.activeTexture.set(He.TEXTURE3),He.bindTexture(He.TEXTURE_2D,F.texture);for(const ot in this.terrainUniforms)this.terrainUniforms[ot].set(F[ot])}if(V)for(const ot in V)this.projectionUniforms[Is[ot]].set(V[ot]);if(R)for(const ot in this.fixedUniforms)this.fixedUniforms[ot].set(R[ot]);Oe&&Oe.setUniforms(t,this.binderUniforms,_e,{zoom:Ie});let rt=0;switch(o){case He.LINES:rt=2;break;case He.TRIANGLES:rt=3;break;case He.LINE_STRIP:rt=1}for(const ot of ce.get()){const Xe=ot.vaos||(ot.vaos={});(Xe[q]||(Xe[q]=new Dl)).bind(t,this,te,Oe?Oe.getPaintVertexBuffers():[],Q,ot.vertexOffset,Le,qe,nt),He.drawElements(o,ot.primitiveLength*rt,He.UNSIGNED_SHORT,ot.primitiveOffset*rt*2)}}}function Qo(w,t,o){const d=1/s.aN(o,1,t.transform.tileZoom),x=Math.pow(2,o.tileID.overscaledZ),S=o.tileSize*Math.pow(2,t.transform.tileZoom)/x,A=S*(o.tileID.canonical.x+o.tileID.wrap*x),R=S*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[d,w.fromScale,w.toScale],u_fade:w.t,u_pixel_coord_upper:[A>>16,R>>16],u_pixel_coord_lower:[65535&A,65535&R]}}const Aa=(w,t,o,d)=>{const x=w.style.light,S=x.properties.get("position"),A=[S.x,S.y,S.z],R=s.c4();x.properties.get("anchor")==="viewport"&&s.c5(R,w.transform.bearingInRadians),s.c6(A,A,R);const F=w.transform.transformLightDirection(A),V=x.properties.get("color");return{u_lightpos:A,u_lightpos_globe:F,u_lightintensity:x.properties.get("intensity"),u_lightcolor:[V.r,V.g,V.b],u_vertical_gradient:+t,u_opacity:o,u_fill_translate:d}},bs=(w,t,o,d,x,S,A)=>s.e(Aa(w,t,o,d),Qo(S,w,A),{u_height_factor:-Math.pow(2,x.overscaledZ)/A.tileSize/8}),Ps=(w,t,o,d)=>s.e(Qo(t,w,o),{u_fill_translate:d}),Rl=(w,t)=>({u_world:w,u_fill_translate:t}),zc=(w,t,o,d,x)=>s.e(Ps(w,t,o,x),{u_world:d}),Qi=(w,t,o,d,x)=>{const S=w.transform;let A,R,F=0;if(o.paint.get("circle-pitch-alignment")==="map"){const V=s.aN(t,1,S.zoom);A=!0,R=[V,V],F=V/(s.a5*Math.pow(2,t.tileID.overscaledZ))*2*Math.PI*x}else A=!1,R=S.pixelsToGLUnits;return{u_camera_to_center_distance:S.cameraToCenterDistance,u_scale_with_map:+(o.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+A,u_device_pixel_ratio:w.pixelRatio,u_extrude_scale:R,u_globe_extrude_scale:F,u_translate:d}},el=w=>({u_pixel_extrude_scale:[1/w.width,1/w.height]}),Il=w=>({u_viewport_size:[w.width,w.height]}),ic=(w,t=1)=>({u_color:w,u_overlay:0,u_overlay_scale:t}),tl=(w,t,o,d)=>{const x=s.aN(w,1,t)/(s.a5*Math.pow(2,w.tileID.overscaledZ))*2*Math.PI*d;return{u_extrude_scale:s.aN(w,1,t),u_intensity:o,u_globe_extrude_scale:x}},to=(w,t,o,d)=>{const x=s.N();s.c7(x,0,w.width,w.height,0,0,1);const S=w.context.gl;return{u_matrix:x,u_world:[S.drawingBufferWidth,S.drawingBufferHeight],u_image:o,u_color_ramp:d,u_opacity:t.paint.get("heatmap-opacity")}},Oc=(w,t,o)=>{const d=o.paint.get("hillshade-accent-color");let x;switch(o.paint.get("hillshade-method")){case"basic":x=4;break;case"combined":x=1;break;case"igor":x=2;break;case"multidirectional":x=3;break;default:x=0}const S=o.getIlluminationProperties();for(let A=0;A<S.directionRadians.length;A++)o.paint.get("hillshade-illumination-anchor")==="viewport"&&(S.directionRadians[A]+=w.transform.bearingInRadians);return{u_image:0,u_latrange:Pl(0,t.tileID),u_exaggeration:o.paint.get("hillshade-exaggeration"),u_altitudes:S.altitudeRadians,u_azimuths:S.directionRadians,u_accent:d,u_method:x,u_highlights:S.highlightColor,u_shadows:S.shadowColor}},Bc=(w,t)=>{const o=t.stride,d=s.N();return s.c7(d,0,s.a5,-s.a5,0,0,1),s.O(d,d,[0,-s.a5,0]),{u_matrix:d,u_image:1,u_dimension:[o,o],u_zoom:w.overscaledZ,u_unpack:t.getUnpackVector()}};function Pl(w,t){const o=Math.pow(2,t.canonical.z),d=t.canonical.y;return[new s.a9(0,d/o).toLngLat().lat,new s.a9(0,(d+1)/o).toLngLat().lat]}const ch=(w,t,o=0)=>({u_image:0,u_unpack:t.getUnpackVector(),u_dimension:[t.stride,t.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:o,u_opacity:w.paint.get("color-relief-opacity")}),Fs=(w,t,o,d)=>{const x=w.transform;return{u_translation:yu(w,t,o),u_ratio:d/s.aN(t,1,x.zoom),u_device_pixel_ratio:w.pixelRatio,u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]]}},ro=(w,t,o,d,x)=>s.e(Fs(w,t,o,d),{u_image:0,u_image_height:x}),Nc=(w,t,o,d,x)=>{const S=w.transform,A=Ls(t,S);return{u_translation:yu(w,t,o),u_texsize:t.imageAtlasTexture.size,u_ratio:d/s.aN(t,1,S.zoom),u_device_pixel_ratio:w.pixelRatio,u_image:0,u_scale:[A,x.fromScale,x.toScale],u_fade:x.t,u_units_to_pixels:[1/S.pixelsToGLUnits[0],1/S.pixelsToGLUnits[1]]}},es=(w,t,o,d,x)=>{const S=Ls(t,w.transform);return s.e(Fs(w,t,o,d),{u_tileratio:S,u_crossfade_from:x.fromScale,u_crossfade_to:x.toScale,u_image:0,u_mix:x.t,u_lineatlas_width:w.lineAtlas.width,u_lineatlas_height:w.lineAtlas.height})},Fl=(w,t,o,d,x,S)=>{const A=Ls(t,w.transform);return s.e(Fs(w,t,o,d),{u_image:0,u_image_height:S,u_tileratio:A,u_crossfade_from:x.fromScale,u_crossfade_to:x.toScale,u_image_dash:1,u_mix:x.t,u_lineatlas_width:w.lineAtlas.width,u_lineatlas_height:w.lineAtlas.height})};function Ls(w,t){return 1/s.aN(w,1,t.tileZoom)}function yu(w,t,o){return s.aO(w.transform,t,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}const uh=(w,t,o,d,x)=>{return{u_tl_parent:w,u_scale_parent:t,u_buffer_scale:1,u_fade_t:o.mix,u_opacity:o.opacity*d.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:d.paint.get("raster-brightness-min"),u_brightness_high:d.paint.get("raster-brightness-max"),u_saturation_factor:(A=d.paint.get("raster-saturation"),A>0?1-1/(1.001-A):-A),u_contrast_factor:(S=d.paint.get("raster-contrast"),S>0?1/(1-S):1+S),u_spin_weights:vu(d.paint.get("raster-hue-rotate")),u_coords_top:[x[0].x,x[0].y,x[1].x,x[1].y],u_coords_bottom:[x[3].x,x[3].y,x[2].x,x[2].y]};var S,A};function vu(w){w*=Math.PI/180;const t=Math.sin(w),o=Math.cos(w);return[(2*o+1)/3,(-Math.sqrt(3)*t-o+1)/3,(Math.sqrt(3)*t-o+1)/3]}const Ll=(w,t,o,d,x,S,A,R,F,V,q,te,Q)=>{const ce=A.transform;return{u_is_size_zoom_constant:+(w==="constant"||w==="source"),u_is_size_feature_constant:+(w==="constant"||w==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:ce.cameraToCenterDistance,u_pitch:ce.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:ce.width/ce.height,u_fade_change:A.options.fadeDuration?A.symbolFadeChange:1,u_label_plane_matrix:R,u_coord_matrix:F,u_is_text:+q,u_pitch_with_map:+d,u_is_along_line:x,u_is_variable_anchor:S,u_texsize:te,u_texture:0,u_translation:V,u_pitched_scale:Q}},jc=(w,t,o,d,x,S,A,R,F,V,q,te,Q,ce)=>{const _e=A.transform;return s.e(Ll(w,t,o,d,x,S,A,R,F,V,q,te,ce),{u_gamma_scale:d?Math.cos(_e.pitch*Math.PI/180)*_e.cameraToCenterDistance:1,u_device_pixel_ratio:A.pixelRatio,u_is_halo:1})},ws=(w,t,o,d,x,S,A,R,F,V,q,te,Q)=>s.e(jc(w,t,o,d,x,S,A,R,F,V,!0,q,0,Q),{u_texsize_icon:te,u_texture_icon:1}),sc=(w,t)=>({u_opacity:w,u_color:t}),oc=(w,t,o,d,x)=>s.e((function(S,A,R,F){const V=R.imageManager.getPattern(S.from.toString()),q=R.imageManager.getPattern(S.to.toString()),{width:te,height:Q}=R.imageManager.getPixelSize(),ce=Math.pow(2,F.tileID.overscaledZ),_e=F.tileSize*Math.pow(2,R.transform.tileZoom)/ce,Ie=_e*(F.tileID.canonical.x+F.tileID.wrap*ce),Oe=_e*F.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:V.tl,u_pattern_br_a:V.br,u_pattern_tl_b:q.tl,u_pattern_br_b:q.br,u_texsize:[te,Q],u_mix:A.t,u_pattern_size_a:V.displaySize,u_pattern_size_b:q.displaySize,u_scale_a:A.fromScale,u_scale_b:A.toScale,u_tile_units_to_pixels:1/s.aN(F,1,R.transform.tileZoom),u_pixel_coord_upper:[Ie>>16,Oe>>16],u_pixel_coord_lower:[65535&Ie,65535&Oe]}})(o,x,t,d),{u_opacity:w}),bu=(w,t)=>{},wu={fillExtrusion:(w,t)=>({u_lightpos:new s.c2(w,t.u_lightpos),u_lightpos_globe:new s.c2(w,t.u_lightpos_globe),u_lightintensity:new s.bq(w,t.u_lightintensity),u_lightcolor:new s.c2(w,t.u_lightcolor),u_vertical_gradient:new s.bq(w,t.u_vertical_gradient),u_opacity:new s.bq(w,t.u_opacity),u_fill_translate:new s.c3(w,t.u_fill_translate)}),fillExtrusionPattern:(w,t)=>({u_lightpos:new s.c2(w,t.u_lightpos),u_lightpos_globe:new s.c2(w,t.u_lightpos_globe),u_lightintensity:new s.bq(w,t.u_lightintensity),u_lightcolor:new s.c2(w,t.u_lightcolor),u_vertical_gradient:new s.bq(w,t.u_vertical_gradient),u_height_factor:new s.bq(w,t.u_height_factor),u_opacity:new s.bq(w,t.u_opacity),u_fill_translate:new s.c3(w,t.u_fill_translate),u_image:new s.b_(w,t.u_image),u_texsize:new s.c3(w,t.u_texsize),u_pixel_coord_upper:new s.c3(w,t.u_pixel_coord_upper),u_pixel_coord_lower:new s.c3(w,t.u_pixel_coord_lower),u_scale:new s.c2(w,t.u_scale),u_fade:new s.bq(w,t.u_fade)}),fill:(w,t)=>({u_fill_translate:new s.c3(w,t.u_fill_translate)}),fillPattern:(w,t)=>({u_image:new s.b_(w,t.u_image),u_texsize:new s.c3(w,t.u_texsize),u_pixel_coord_upper:new s.c3(w,t.u_pixel_coord_upper),u_pixel_coord_lower:new s.c3(w,t.u_pixel_coord_lower),u_scale:new s.c2(w,t.u_scale),u_fade:new s.bq(w,t.u_fade),u_fill_translate:new s.c3(w,t.u_fill_translate)}),fillOutline:(w,t)=>({u_world:new s.c3(w,t.u_world),u_fill_translate:new s.c3(w,t.u_fill_translate)}),fillOutlinePattern:(w,t)=>({u_world:new s.c3(w,t.u_world),u_image:new s.b_(w,t.u_image),u_texsize:new s.c3(w,t.u_texsize),u_pixel_coord_upper:new s.c3(w,t.u_pixel_coord_upper),u_pixel_coord_lower:new s.c3(w,t.u_pixel_coord_lower),u_scale:new s.c2(w,t.u_scale),u_fade:new s.bq(w,t.u_fade),u_fill_translate:new s.c3(w,t.u_fill_translate)}),circle:(w,t)=>({u_camera_to_center_distance:new s.bq(w,t.u_camera_to_center_distance),u_scale_with_map:new s.b_(w,t.u_scale_with_map),u_pitch_with_map:new s.b_(w,t.u_pitch_with_map),u_extrude_scale:new s.c3(w,t.u_extrude_scale),u_device_pixel_ratio:new s.bq(w,t.u_device_pixel_ratio),u_globe_extrude_scale:new s.bq(w,t.u_globe_extrude_scale),u_translate:new s.c3(w,t.u_translate)}),collisionBox:(w,t)=>({u_pixel_extrude_scale:new s.c3(w,t.u_pixel_extrude_scale)}),collisionCircle:(w,t)=>({u_viewport_size:new s.c3(w,t.u_viewport_size)}),debug:(w,t)=>({u_color:new s.b$(w,t.u_color),u_overlay:new s.b_(w,t.u_overlay),u_overlay_scale:new s.bq(w,t.u_overlay_scale)}),depth:bu,clippingMask:bu,heatmap:(w,t)=>({u_extrude_scale:new s.bq(w,t.u_extrude_scale),u_intensity:new s.bq(w,t.u_intensity),u_globe_extrude_scale:new s.bq(w,t.u_globe_extrude_scale)}),heatmapTexture:(w,t)=>({u_matrix:new s.c0(w,t.u_matrix),u_world:new s.c3(w,t.u_world),u_image:new s.b_(w,t.u_image),u_color_ramp:new s.b_(w,t.u_color_ramp),u_opacity:new s.bq(w,t.u_opacity)}),hillshade:(w,t)=>({u_image:new s.b_(w,t.u_image),u_latrange:new s.c3(w,t.u_latrange),u_exaggeration:new s.bq(w,t.u_exaggeration),u_altitudes:new s.c9(w,t.u_altitudes),u_azimuths:new s.c9(w,t.u_azimuths),u_accent:new s.b$(w,t.u_accent),u_method:new s.b_(w,t.u_method),u_shadows:new s.c8(w,t.u_shadows),u_highlights:new s.c8(w,t.u_highlights)}),hillshadePrepare:(w,t)=>({u_matrix:new s.c0(w,t.u_matrix),u_image:new s.b_(w,t.u_image),u_dimension:new s.c3(w,t.u_dimension),u_zoom:new s.bq(w,t.u_zoom),u_unpack:new s.c1(w,t.u_unpack)}),colorRelief:(w,t)=>({u_image:new s.b_(w,t.u_image),u_unpack:new s.c1(w,t.u_unpack),u_dimension:new s.c3(w,t.u_dimension),u_elevation_stops:new s.b_(w,t.u_elevation_stops),u_color_stops:new s.b_(w,t.u_color_stops),u_color_ramp_size:new s.b_(w,t.u_color_ramp_size),u_opacity:new s.bq(w,t.u_opacity)}),line:(w,t)=>({u_translation:new s.c3(w,t.u_translation),u_ratio:new s.bq(w,t.u_ratio),u_device_pixel_ratio:new s.bq(w,t.u_device_pixel_ratio),u_units_to_pixels:new s.c3(w,t.u_units_to_pixels)}),lineGradient:(w,t)=>({u_translation:new s.c3(w,t.u_translation),u_ratio:new s.bq(w,t.u_ratio),u_device_pixel_ratio:new s.bq(w,t.u_device_pixel_ratio),u_units_to_pixels:new s.c3(w,t.u_units_to_pixels),u_image:new s.b_(w,t.u_image),u_image_height:new s.bq(w,t.u_image_height)}),linePattern:(w,t)=>({u_translation:new s.c3(w,t.u_translation),u_texsize:new s.c3(w,t.u_texsize),u_ratio:new s.bq(w,t.u_ratio),u_device_pixel_ratio:new s.bq(w,t.u_device_pixel_ratio),u_image:new s.b_(w,t.u_image),u_units_to_pixels:new s.c3(w,t.u_units_to_pixels),u_scale:new s.c2(w,t.u_scale),u_fade:new s.bq(w,t.u_fade)}),lineSDF:(w,t)=>({u_translation:new s.c3(w,t.u_translation),u_ratio:new s.bq(w,t.u_ratio),u_device_pixel_ratio:new s.bq(w,t.u_device_pixel_ratio),u_units_to_pixels:new s.c3(w,t.u_units_to_pixels),u_image:new s.b_(w,t.u_image),u_mix:new s.bq(w,t.u_mix),u_tileratio:new s.bq(w,t.u_tileratio),u_crossfade_from:new s.bq(w,t.u_crossfade_from),u_crossfade_to:new s.bq(w,t.u_crossfade_to),u_lineatlas_width:new s.bq(w,t.u_lineatlas_width),u_lineatlas_height:new s.bq(w,t.u_lineatlas_height)}),lineGradientSDF:(w,t)=>({u_translation:new s.c3(w,t.u_translation),u_ratio:new s.bq(w,t.u_ratio),u_device_pixel_ratio:new s.bq(w,t.u_device_pixel_ratio),u_units_to_pixels:new s.c3(w,t.u_units_to_pixels),u_image:new s.b_(w,t.u_image),u_image_height:new s.bq(w,t.u_image_height),u_tileratio:new s.bq(w,t.u_tileratio),u_crossfade_from:new s.bq(w,t.u_crossfade_from),u_crossfade_to:new s.bq(w,t.u_crossfade_to),u_image_dash:new s.b_(w,t.u_image_dash),u_mix:new s.bq(w,t.u_mix),u_lineatlas_width:new s.bq(w,t.u_lineatlas_width),u_lineatlas_height:new s.bq(w,t.u_lineatlas_height)}),raster:(w,t)=>({u_tl_parent:new s.c3(w,t.u_tl_parent),u_scale_parent:new s.bq(w,t.u_scale_parent),u_buffer_scale:new s.bq(w,t.u_buffer_scale),u_fade_t:new s.bq(w,t.u_fade_t),u_opacity:new s.bq(w,t.u_opacity),u_image0:new s.b_(w,t.u_image0),u_image1:new s.b_(w,t.u_image1),u_brightness_low:new s.bq(w,t.u_brightness_low),u_brightness_high:new s.bq(w,t.u_brightness_high),u_saturation_factor:new s.bq(w,t.u_saturation_factor),u_contrast_factor:new s.bq(w,t.u_contrast_factor),u_spin_weights:new s.c2(w,t.u_spin_weights),u_coords_top:new s.c1(w,t.u_coords_top),u_coords_bottom:new s.c1(w,t.u_coords_bottom)}),symbolIcon:(w,t)=>({u_is_size_zoom_constant:new s.b_(w,t.u_is_size_zoom_constant),u_is_size_feature_constant:new s.b_(w,t.u_is_size_feature_constant),u_size_t:new s.bq(w,t.u_size_t),u_size:new s.bq(w,t.u_size),u_camera_to_center_distance:new s.bq(w,t.u_camera_to_center_distance),u_pitch:new s.bq(w,t.u_pitch),u_rotate_symbol:new s.b_(w,t.u_rotate_symbol),u_aspect_ratio:new s.bq(w,t.u_aspect_ratio),u_fade_change:new s.bq(w,t.u_fade_change),u_label_plane_matrix:new s.c0(w,t.u_label_plane_matrix),u_coord_matrix:new s.c0(w,t.u_coord_matrix),u_is_text:new s.b_(w,t.u_is_text),u_pitch_with_map:new s.b_(w,t.u_pitch_with_map),u_is_along_line:new s.b_(w,t.u_is_along_line),u_is_variable_anchor:new s.b_(w,t.u_is_variable_anchor),u_texsize:new s.c3(w,t.u_texsize),u_texture:new s.b_(w,t.u_texture),u_translation:new s.c3(w,t.u_translation),u_pitched_scale:new s.bq(w,t.u_pitched_scale)}),symbolSDF:(w,t)=>({u_is_size_zoom_constant:new s.b_(w,t.u_is_size_zoom_constant),u_is_size_feature_constant:new s.b_(w,t.u_is_size_feature_constant),u_size_t:new s.bq(w,t.u_size_t),u_size:new s.bq(w,t.u_size),u_camera_to_center_distance:new s.bq(w,t.u_camera_to_center_distance),u_pitch:new s.bq(w,t.u_pitch),u_rotate_symbol:new s.b_(w,t.u_rotate_symbol),u_aspect_ratio:new s.bq(w,t.u_aspect_ratio),u_fade_change:new s.bq(w,t.u_fade_change),u_label_plane_matrix:new s.c0(w,t.u_label_plane_matrix),u_coord_matrix:new s.c0(w,t.u_coord_matrix),u_is_text:new s.b_(w,t.u_is_text),u_pitch_with_map:new s.b_(w,t.u_pitch_with_map),u_is_along_line:new s.b_(w,t.u_is_along_line),u_is_variable_anchor:new s.b_(w,t.u_is_variable_anchor),u_texsize:new s.c3(w,t.u_texsize),u_texture:new s.b_(w,t.u_texture),u_gamma_scale:new s.bq(w,t.u_gamma_scale),u_device_pixel_ratio:new s.bq(w,t.u_device_pixel_ratio),u_is_halo:new s.b_(w,t.u_is_halo),u_translation:new s.c3(w,t.u_translation),u_pitched_scale:new s.bq(w,t.u_pitched_scale)}),symbolTextAndIcon:(w,t)=>({u_is_size_zoom_constant:new s.b_(w,t.u_is_size_zoom_constant),u_is_size_feature_constant:new s.b_(w,t.u_is_size_feature_constant),u_size_t:new s.bq(w,t.u_size_t),u_size:new s.bq(w,t.u_size),u_camera_to_center_distance:new s.bq(w,t.u_camera_to_center_distance),u_pitch:new s.bq(w,t.u_pitch),u_rotate_symbol:new s.b_(w,t.u_rotate_symbol),u_aspect_ratio:new s.bq(w,t.u_aspect_ratio),u_fade_change:new s.bq(w,t.u_fade_change),u_label_plane_matrix:new s.c0(w,t.u_label_plane_matrix),u_coord_matrix:new s.c0(w,t.u_coord_matrix),u_is_text:new s.b_(w,t.u_is_text),u_pitch_with_map:new s.b_(w,t.u_pitch_with_map),u_is_along_line:new s.b_(w,t.u_is_along_line),u_is_variable_anchor:new s.b_(w,t.u_is_variable_anchor),u_texsize:new s.c3(w,t.u_texsize),u_texsize_icon:new s.c3(w,t.u_texsize_icon),u_texture:new s.b_(w,t.u_texture),u_texture_icon:new s.b_(w,t.u_texture_icon),u_gamma_scale:new s.bq(w,t.u_gamma_scale),u_device_pixel_ratio:new s.bq(w,t.u_device_pixel_ratio),u_is_halo:new s.b_(w,t.u_is_halo),u_translation:new s.c3(w,t.u_translation),u_pitched_scale:new s.bq(w,t.u_pitched_scale)}),background:(w,t)=>({u_opacity:new s.bq(w,t.u_opacity),u_color:new s.b$(w,t.u_color)}),backgroundPattern:(w,t)=>({u_opacity:new s.bq(w,t.u_opacity),u_image:new s.b_(w,t.u_image),u_pattern_tl_a:new s.c3(w,t.u_pattern_tl_a),u_pattern_br_a:new s.c3(w,t.u_pattern_br_a),u_pattern_tl_b:new s.c3(w,t.u_pattern_tl_b),u_pattern_br_b:new s.c3(w,t.u_pattern_br_b),u_texsize:new s.c3(w,t.u_texsize),u_mix:new s.bq(w,t.u_mix),u_pattern_size_a:new s.c3(w,t.u_pattern_size_a),u_pattern_size_b:new s.c3(w,t.u_pattern_size_b),u_scale_a:new s.bq(w,t.u_scale_a),u_scale_b:new s.bq(w,t.u_scale_b),u_pixel_coord_upper:new s.c3(w,t.u_pixel_coord_upper),u_pixel_coord_lower:new s.c3(w,t.u_pixel_coord_lower),u_tile_units_to_pixels:new s.bq(w,t.u_tile_units_to_pixels)}),terrain:(w,t)=>({u_texture:new s.b_(w,t.u_texture),u_ele_delta:new s.bq(w,t.u_ele_delta),u_fog_matrix:new s.c0(w,t.u_fog_matrix),u_fog_color:new s.b$(w,t.u_fog_color),u_fog_ground_blend:new s.bq(w,t.u_fog_ground_blend),u_fog_ground_blend_opacity:new s.bq(w,t.u_fog_ground_blend_opacity),u_horizon_color:new s.b$(w,t.u_horizon_color),u_horizon_fog_blend:new s.bq(w,t.u_horizon_fog_blend),u_is_globe_mode:new s.bq(w,t.u_is_globe_mode)}),terrainDepth:(w,t)=>({u_ele_delta:new s.bq(w,t.u_ele_delta)}),terrainCoords:(w,t)=>({u_texture:new s.b_(w,t.u_texture),u_terrain_coords_id:new s.bq(w,t.u_terrain_coords_id),u_ele_delta:new s.bq(w,t.u_ele_delta)}),projectionErrorMeasurement:(w,t)=>({u_input:new s.bq(w,t.u_input),u_output_expected:new s.bq(w,t.u_output_expected)}),atmosphere:(w,t)=>({u_sun_pos:new s.c2(w,t.u_sun_pos),u_atmosphere_blend:new s.bq(w,t.u_atmosphere_blend),u_globe_position:new s.c2(w,t.u_globe_position),u_globe_radius:new s.bq(w,t.u_globe_radius),u_inv_proj_matrix:new s.c0(w,t.u_inv_proj_matrix)}),sky:(w,t)=>({u_sky_color:new s.b$(w,t.u_sky_color),u_horizon_color:new s.b$(w,t.u_horizon_color),u_horizon:new s.c3(w,t.u_horizon),u_horizon_normal:new s.c3(w,t.u_horizon_normal),u_sky_horizon_blend:new s.bq(w,t.u_sky_horizon_blend),u_sky_blend:new s.bq(w,t.u_sky_blend)})};class lc{constructor(t,o,d){this.context=t;const x=t.gl;this.buffer=x.createBuffer(),this.dynamicDraw=!!d,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),x.bufferData(x.ELEMENT_ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const o=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),o.bufferSubData(o.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const zl={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Uc{constructor(t,o,d,x){this.length=o.length,this.attributes=d,this.itemSize=o.bytesPerElement,this.dynamicDraw=x,this.context=t;const S=t.gl;this.buffer=S.createBuffer(),t.bindVertexBuffer.set(this.buffer),S.bufferData(S.ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const o=this.context.gl;this.bind(),o.bufferSubData(o.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,o){for(let d=0;d<this.attributes.length;d++){const x=o.attributes[this.attributes[d].name];x!==void 0&&t.enableVertexAttribArray(x)}}setVertexAttribPointers(t,o,d){for(let x=0;x<this.attributes.length;x++){const S=this.attributes[x],A=o.attributes[S.name];A!==void 0&&t.vertexAttribPointer(A,S.components,t[zl[S.type]],!1,this.itemSize,S.offset+this.itemSize*(d||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class En{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Eo extends En{getDefault(){return s.bp.transparent}set(t){const o=this.current;(t.r!==o.r||t.g!==o.g||t.b!==o.b||t.a!==o.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Tu extends En{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class Su extends En{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class hh extends En{getDefault(){return[!0,!0,!0,!0]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||t[2]!==o[2]||t[3]!==o[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class cc extends En{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class Ao extends En{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class uc extends En{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const o=this.current;(t.func!==o.func||t.ref!==o.ref||t.mask!==o.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class Pi extends En{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||t[2]!==o[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class fh extends En{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.STENCIL_TEST):o.disable(o.STENCIL_TEST),this.current=t,this.dirty=!1}}class rl extends En{getDefault(){return[0,1]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class cs extends En{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.DEPTH_TEST):o.disable(o.DEPTH_TEST),this.current=t,this.dirty=!1}}class zs extends En{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class Ei extends En{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.BLEND):o.disable(o.BLEND),this.current=t,this.dirty=!1}}class no extends En{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class hc extends En{getDefault(){return s.bp.transparent}set(t){const o=this.current;(t.r!==o.r||t.g!==o.g||t.b!==o.b||t.a!==o.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class fc extends En{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class Vc extends En{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.CULL_FACE):o.disable(o.CULL_FACE),this.current=t,this.dirty=!1}}class ao extends En{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class Os extends En{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class dh extends En{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class Gc extends En{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class dn extends En{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||t[2]!==o[2]||t[3]!==o[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class ph extends En{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindFramebuffer(o.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class Ts extends En{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindRenderbuffer(o.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class ee extends En{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindTexture(o.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class Ke extends En{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindBuffer(o.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class ht extends En{getDefault(){return null}set(t){const o=this.gl;o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class er extends En{getDefault(){return null}set(t){var o;if(t===this.current&&!this.dirty)return;const d=this.gl;_i(d)?d.bindVertexArray(t):(o=d.getExtension("OES_vertex_array_object"))===null||o===void 0||o.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class St extends En{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class _r extends En{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class Kr extends En{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class un extends En{constructor(t,o){super(t),this.context=t,this.parent=o}getDefault(){return null}}class Jr extends un{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class Or extends un{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Lr extends un{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,t),this.current=t,this.dirty=!1}}const Ur="Framebuffer is not complete";class mr{constructor(t,o,d,x,S){this.context=t,this.width=o,this.height=d;const A=t.gl,R=this.framebuffer=A.createFramebuffer();if(this.colorAttachment=new Jr(t,R),x)this.depthAttachment=S?new Lr(t,R):new Or(t,R);else if(S)throw new Error("Stencil cannot be set without depth");if(A.checkFramebufferStatus(A.FRAMEBUFFER)!==A.FRAMEBUFFER_COMPLETE)throw new Error(Ur)}destroy(){const t=this.context.gl,o=this.colorAttachment.get();if(o&&t.deleteTexture(o),this.depthAttachment){const d=this.depthAttachment.get();d&&t.deleteRenderbuffer(d)}t.deleteFramebuffer(this.framebuffer)}}class Dr{constructor(t){var o,d;if(this.gl=t,this.clearColor=new Eo(this),this.clearDepth=new Tu(this),this.clearStencil=new Su(this),this.colorMask=new hh(this),this.depthMask=new cc(this),this.stencilMask=new Ao(this),this.stencilFunc=new uc(this),this.stencilOp=new Pi(this),this.stencilTest=new fh(this),this.depthRange=new rl(this),this.depthTest=new cs(this),this.depthFunc=new zs(this),this.blend=new Ei(this),this.blendFunc=new no(this),this.blendColor=new hc(this),this.blendEquation=new fc(this),this.cullFace=new Vc(this),this.cullFaceSide=new ao(this),this.frontFace=new Os(this),this.program=new dh(this),this.activeTexture=new Gc(this),this.viewport=new dn(this),this.bindFramebuffer=new ph(this),this.bindRenderbuffer=new Ts(this),this.bindTexture=new ee(this),this.bindVertexBuffer=new Ke(this),this.bindElementBuffer=new ht(this),this.bindVertexArray=new er(this),this.pixelStoreUnpack=new St(this),this.pixelStoreUnpackPremultiplyAlpha=new _r(this),this.pixelStoreUnpackFlipY=new Kr(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),_i(t)){this.HALF_FLOAT=t.HALF_FLOAT;const x=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(o=t.RGBA16F)!==null&&o!==void 0?o:x?.RGBA16F_EXT,this.RGB16F=(d=t.RGB16F)!==null&&d!==void 0?d:x?.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const x=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=x?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,o){return new lc(this,t,o)}createVertexBuffer(t,o,d){return new Uc(this,t,o,d)}createRenderbuffer(t,o,d){const x=this.gl,S=x.createRenderbuffer();return this.bindRenderbuffer.set(S),x.renderbufferStorage(x.RENDERBUFFER,t,o,d),this.bindRenderbuffer.set(null),S}createFramebuffer(t,o,d,x){return new mr(this,t,o,d,x)}clear({color:t,depth:o,stencil:d}){const x=this.gl;let S=0;t&&(S|=x.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(S|=x.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),d!==void 0&&(S|=x.STENCIL_BUFFER_BIT,this.clearStencil.set(d),this.stencilMask.set(255)),x.clear(S)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){s.bR(t.blendFunction,Zn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return _i(this.gl)?this.gl.createVertexArray():(t=this.gl.getExtension("OES_vertex_array_object"))===null||t===void 0?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var o;return _i(this.gl)?this.gl.deleteVertexArray(t):(o=this.gl.getExtension("OES_vertex_array_object"))===null||o===void 0?void 0:o.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}let Ar;function yr(w,t,o,d,x){const S=w.context,A=w.transform,R=S.gl,F=w.useProgram("collisionBox"),V=[];let q=0,te=0;for(let Le=0;Le<d.length;Le++){const qe=d[Le],nt=t.getTile(qe).getBucket(o);if(!nt)continue;const He=x?nt.textCollisionBox:nt.iconCollisionBox,rt=nt.collisionCircleArray;rt.length>0&&(V.push({circleArray:rt,circleOffset:te,coord:qe}),q+=rt.length/4,te=q),He&&F.draw(S,R.LINES,sn.disabled,bn.disabled,w.colorModeForRenderPass(),cn.disabled,el(w.transform),w.style.map.terrain&&w.style.map.terrain.getTerrainData(qe),A.getProjectionData({overscaledTileID:qe,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),o.id,He.layoutVertexBuffer,He.indexBuffer,He.segments,null,w.transform.zoom,null,null,He.collisionVertexBuffer)}if(!x||!V.length)return;const Q=w.useProgram("collisionCircle"),ce=new s.ca;ce.resize(4*q),ce._trim();let _e=0;for(const Le of V)for(let qe=0;qe<Le.circleArray.length/4;qe++){const nt=4*qe,He=Le.circleArray[nt+0],rt=Le.circleArray[nt+1],ot=Le.circleArray[nt+2],Xe=Le.circleArray[nt+3];ce.emplace(_e++,He,rt,ot,Xe,0),ce.emplace(_e++,He,rt,ot,Xe,1),ce.emplace(_e++,He,rt,ot,Xe,2),ce.emplace(_e++,He,rt,ot,Xe,3)}(!Ar||Ar.length<2*q)&&(Ar=(function(Le){const qe=2*Le,nt=new s.cc;nt.resize(qe),nt._trim();for(let He=0;He<qe;He++){const rt=6*He;nt.uint16[rt+0]=4*He+0,nt.uint16[rt+1]=4*He+1,nt.uint16[rt+2]=4*He+2,nt.uint16[rt+3]=4*He+2,nt.uint16[rt+4]=4*He+3,nt.uint16[rt+5]=4*He+0}return nt})(q));const Ie=S.createIndexBuffer(Ar,!0),Oe=S.createVertexBuffer(ce,s.cb.members,!0);for(const Le of V){const qe=Il(w.transform);Q.draw(S,R.TRIANGLES,sn.disabled,bn.disabled,w.colorModeForRenderPass(),cn.disabled,qe,w.style.map.terrain&&w.style.map.terrain.getTerrainData(Le.coord),null,o.id,Oe,Ie,s.aX.simpleSegment(0,2*Le.circleOffset,Le.circleArray.length,Le.circleArray.length/2),null,w.transform.zoom,null,null,null)}Oe.destroy(),Ie.destroy()}const Ir=s.ar(new Float32Array(16));function pn(w,t,o,d,x,S){const{horizontalAlign:A,verticalAlign:R}=s.aS(w);return new s.P((-(A-.5)*t/x+d[0])*S,(-(R-.5)*o/x+d[1])*S)}function gr(w,t,o,d,x,S){const A=t.tileAnchorPoint.add(new s.P(t.translation[0],t.translation[1]));if(t.pitchWithMap){let R=d.mult(S);o||(R=R.rotate(-x));const F=A.add(R);return gt(F.x,F.y,t.pitchedLabelPlaneMatrix,t.getElevation).point}if(o){const R=tn(t.tileAnchorPoint.x+1,t.tileAnchorPoint.y,t).point.sub(w),F=Math.atan(R.y/R.x)+(R.x<0?Math.PI:0);return w.add(d.rotate(F))}return w.add(d)}function Fr(w,t,o,d,x,S,A,R,F,V,q,te){const Q=w.text.placedSymbolArray,ce=w.text.dynamicLayoutVertexArray,_e=w.icon.dynamicLayoutVertexArray,Ie={};ce.clear();for(let Oe=0;Oe<Q.length;Oe++){const Le=Q.get(Oe),qe=Le.hidden||!Le.crossTileID||w.allowVerticalPlacement&&!Le.placedOrientation?null:d[Le.crossTileID];if(qe){const nt=new s.P(Le.anchorX,Le.anchorY),He={getElevation:te,width:x.width,height:x.height,pitchedLabelPlaneMatrix:S,pitchWithMap:o,transform:x,tileAnchorPoint:nt,translation:V,unwrappedTileID:q},rt=o?xs(nt.x,nt.y,He):tn(nt.x,nt.y,He),ot=ir(x.cameraToCenterDistance,rt.signedDistanceFromCamera);let Xe=s.aA(w.textSizeData,R,Le)*ot/s.aM;o&&(Xe*=w.tilePixelRatio/A);const{width:ft,height:Pt,anchor:Et,textOffset:Ct,textBoxScale:Dt}=qe,ur=pn(Et,ft,Pt,Ct,Dt,Xe),fr=x.getPitchedTextCorrection(nt.x+V[0],nt.y+V[1],q),tr=gr(rt.point,He,t,ur,-x.bearingInRadians,fr),br=w.allowVerticalPlacement&&Le.placedOrientation===s.az.vertical?Math.PI/2:0;for(let hn=0;hn<Le.numGlyphs;hn++)s.aG(ce,tr,br);F&&Le.associatedIconIndex>=0&&(Ie[Le.associatedIconIndex]={shiftedAnchor:tr,angle:br})}else ss(Le.numGlyphs,ce)}if(F){_e.clear();const Oe=w.icon.placedSymbolArray;for(let Le=0;Le<Oe.length;Le++){const qe=Oe.get(Le);if(qe.hidden)ss(qe.numGlyphs,_e);else{const nt=Ie[Le];if(nt)for(let He=0;He<qe.numGlyphs;He++)s.aG(_e,nt.shiftedAnchor,nt.angle);else ss(qe.numGlyphs,_e)}}w.icon.dynamicLayoutVertexBuffer.updateData(_e)}w.text.dynamicLayoutVertexBuffer.updateData(ce)}function yn(w,t,o){return o.iconsInText&&t?"symbolTextAndIcon":w?"symbolSDF":"symbolIcon"}function Wr(w,t,o,d,x,S,A,R,F,V,q,te,Q){const ce=w.context,_e=ce.gl,Ie=w.transform,Oe=R==="map",Le=F==="map",qe=R!=="viewport"&&o.layout.get("symbol-placement")!=="point",nt=Oe&&!Le&&!qe,He=!o.layout.get("symbol-sort-key").isConstant();let rt=!1;const ot=w.getDepthModeForSublayer(0,sn.ReadOnly),Xe=o._unevaluatedLayout.hasValue("text-variable-anchor")||o._unevaluatedLayout.hasValue("text-variable-anchor-offset"),ft=[],Pt=Ie.getCircleRadiusCorrection();for(const Et of d){const Ct=t.getTile(Et),Dt=Ct.getBucket(o);if(!Dt)continue;const ur=x?Dt.text:Dt.icon;if(!ur||!ur.segments.get().length||!ur.hasVisibleVertices)continue;const fr=ur.programConfigurations.get(o.id),tr=x||Dt.sdfIcons,br=x?Dt.textSizeData:Dt.iconSizeData,hn=Le||Ie.pitch!==0,Xn=w.useProgram(yn(tr,x,Dt),fr),xa=s.ay(br,Ie.zoom),ua=w.style.map.terrain&&w.style.map.terrain.getTerrainData(Et);let Ca,ra,Ua,Ma,Bi=[0,0],Ka=null;if(x)ra=Ct.glyphAtlasTexture,Ua=_e.LINEAR,Ca=Ct.glyphAtlasTexture.size,Dt.iconsInText&&(Bi=Ct.imageAtlasTexture.size,Ka=Ct.imageAtlasTexture,Ma=hn||w.options.rotating||w.options.zooming||br.kind==="composite"||br.kind==="camera"?_e.LINEAR:_e.NEAREST);else{const Qn=o.layout.get("icon-size").constantOr(0)!==1||Dt.iconsNeedLinear;ra=Ct.imageAtlasTexture,Ua=tr||w.options.rotating||w.options.zooming||Qn||hn?_e.LINEAR:_e.NEAREST,Ca=Ct.imageAtlasTexture.size}const Ja=s.aN(Ct,1,w.transform.zoom),Ni=Ut(Oe,w.transform,Ja),ql=s.N();s.aB(ql,Ni);const Zl=It(Le,Oe,w.transform,Ja),hl=s.aO(Ie,Ct,S,A),Us=Ie.getProjectionData({overscaledTileID:Et,applyGlobeMatrix:!Q,applyTerrainMatrix:!0}),Fu=Xe&&Dt.hasTextData(),wh=o.layout.get("icon-text-fit")!=="none"&&Fu&&Dt.hasIconData();if(qe){const Qn=w.style.map.terrain?(hi,xi)=>w.style.map.terrain.getElevation(Et,hi,xi):null,ha=o.layout.get("text-rotation-alignment")==="map";Sr(Dt,w,x,Ni,ql,Le,V,ha,Et.toUnwrapped(),Ie.width,Ie.height,hl,Qn)}const fl=x&&Xe||wh,Vs=qe||fl?Ir:Le?Ni:w.transform.clipSpaceToPixelsMatrix,lo=tr&&o.paint.get(x?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Ro;Ro=tr?Dt.iconsInText?ws(br.kind,xa,nt,Le,qe,fl,w,Vs,Zl,hl,Ca,Bi,Pt):jc(br.kind,xa,nt,Le,qe,fl,w,Vs,Zl,hl,x,Ca,0,Pt):Ll(br.kind,xa,nt,Le,qe,fl,w,Vs,Zl,hl,x,Ca,Pt);const Io={program:Xn,buffers:ur,uniformValues:Ro,projectionData:Us,atlasTexture:ra,atlasTextureIcon:Ka,atlasInterpolation:Ua,atlasInterpolationIcon:Ma,isSDF:tr,hasHalo:lo};if(He&&Dt.canOverlap){rt=!0;const Qn=ur.segments.get();for(const ha of Qn)ft.push({segments:new s.aX([ha]),sortKey:ha.sortKey,state:Io,terrainData:ua})}else ft.push({segments:ur.segments,sortKey:0,state:Io,terrainData:ua})}rt&&ft.sort(((Et,Ct)=>Et.sortKey-Ct.sortKey));for(const Et of ft){const Ct=Et.state;if(ce.activeTexture.set(_e.TEXTURE0),Ct.atlasTexture.bind(Ct.atlasInterpolation,_e.CLAMP_TO_EDGE),Ct.atlasTextureIcon&&(ce.activeTexture.set(_e.TEXTURE1),Ct.atlasTextureIcon&&Ct.atlasTextureIcon.bind(Ct.atlasInterpolationIcon,_e.CLAMP_TO_EDGE)),Ct.isSDF){const Dt=Ct.uniformValues;Ct.hasHalo&&(Dt.u_is_halo=1,ln(Ct.buffers,Et.segments,o,w,Ct.program,ot,q,te,Dt,Ct.projectionData,Et.terrainData)),Dt.u_is_halo=0}ln(Ct.buffers,Et.segments,o,w,Ct.program,ot,q,te,Ct.uniformValues,Ct.projectionData,Et.terrainData)}}function ln(w,t,o,d,x,S,A,R,F,V,q){const te=d.context;x.draw(te,te.gl.TRIANGLES,S,A,R,cn.backCCW,F,q,V,o.id,w.layoutVertexBuffer,w.indexBuffer,t,o.paint,d.transform.zoom,w.programConfigurations.get(o.id),w.dynamicLayoutVertexBuffer,w.opacityVertexBuffer)}function Vr(w,t,o,d,x){const S=w.context,A=S.gl,R=bn.disabled,F=new Zn([A.ONE,A.ONE],s.bp.transparent,[!0,!0,!0,!0]),V=t.getBucket(o);if(!V)return;const q=d.key;let te=o.heatmapFbos.get(q);te||(te=$r(S,t.tileSize,t.tileSize),o.heatmapFbos.set(q,te)),S.bindFramebuffer.set(te.framebuffer),S.viewport.set([0,0,t.tileSize,t.tileSize]),S.clear({color:s.bp.transparent});const Q=V.programConfigurations.get(o.id),ce=w.useProgram("heatmap",Q,!x),_e=w.transform.getProjectionData({overscaledTileID:t.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Ie=w.style.map.terrain.getTerrainData(d);ce.draw(S,A.TRIANGLES,sn.disabled,R,F,cn.disabled,tl(t,w.transform.zoom,o.paint.get("heatmap-intensity"),1),Ie,_e,o.id,V.layoutVertexBuffer,V.indexBuffer,V.segments,o.paint,w.transform.zoom,Q)}function en(w,t,o,d,x){const S=w.context,A=S.gl,R=w.transform;S.setColorMode(w.colorModeForRenderPass());const F=Yr(S,t),V=o.key,q=t.heatmapFbos.get(V);if(!q)return;S.activeTexture.set(A.TEXTURE0),A.bindTexture(A.TEXTURE_2D,q.colorAttachment.get()),S.activeTexture.set(A.TEXTURE1),F.bind(A.LINEAR,A.CLAMP_TO_EDGE);const te=R.getProjectionData({overscaledTileID:o,applyTerrainMatrix:x,applyGlobeMatrix:!d});w.useProgram("heatmapTexture").draw(S,A.TRIANGLES,sn.disabled,bn.disabled,w.colorModeForRenderPass(),cn.disabled,to(w,t,0,1),null,te,t.id,w.rasterBoundsBuffer,w.quadTriangleIndexBuffer,w.rasterBoundsSegments,t.paint,R.zoom),q.destroy(),t.heatmapFbos.delete(V)}function $r(w,t,o){var d,x;const S=w.gl,A=S.createTexture();S.bindTexture(S.TEXTURE_2D,A),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_S,S.CLAMP_TO_EDGE),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_T,S.CLAMP_TO_EDGE),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_MIN_FILTER,S.LINEAR),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_MAG_FILTER,S.LINEAR);const R=(d=w.HALF_FLOAT)!==null&&d!==void 0?d:S.UNSIGNED_BYTE,F=(x=w.RGBA16F)!==null&&x!==void 0?x:S.RGBA;S.texImage2D(S.TEXTURE_2D,0,F,t,o,0,S.RGBA,R,null);const V=w.createFramebuffer(t,o,!1,!1);return V.colorAttachment.set(A),V}function Yr(w,t){return t.colorRampTexture||(t.colorRampTexture=new s.T(w,t.colorRamp,w.gl.RGBA)),t.colorRampTexture}function Xr(w,t,o,d,x,S,A,R){let F=256;if(x.stepInterpolant){const V=t.getSource().maxzoom,q=A.canonical.z===V?Math.ceil(1<<w.transform.maxZoom-A.canonical.z):1;F=s.an(s.ce(S.maxLineLength/s.a5*1024*q),256,o.maxTextureSize)}return R.gradient=s.cf({expression:x.gradientExpression(),evaluationKey:"lineProgress",resolution:F,image:R.gradient||void 0,clips:S.lineClipsArray}),R.texture?R.texture.update(R.gradient):R.texture=new s.T(o,R.gradient,d.RGBA),R.version=x.gradientVersion,R.texture}function On(w,t,o,d,x){w.activeTexture.set(t.TEXTURE0),o.imageAtlasTexture.bind(t.LINEAR,t.CLAMP_TO_EDGE),d.updatePaintBuffers(x)}function Cn(w,t,o,d,x,S){(x||w.lineAtlas.dirty)&&(t.activeTexture.set(o.TEXTURE0),w.lineAtlas.bind(t)),d.updatePaintBuffers(S)}function Wa(w,t,o,d,x,S,A){const R=S.gradients[x.id];let F=R.texture;x.gradientVersion!==R.version&&(F=Xr(w,t,o,d,x,S,A,R)),o.activeTexture.set(d.TEXTURE0),F.bind(x.stepInterpolant?d.NEAREST:d.LINEAR,d.CLAMP_TO_EDGE)}function $a(w,t,o,d,x,S,A,R,F){const V=S.gradients[x.id];let q=V.texture;x.gradientVersion!==V.version&&(q=Xr(w,t,o,d,x,S,A,V)),o.activeTexture.set(d.TEXTURE0),q.bind(x.stepInterpolant?d.NEAREST:d.LINEAR,d.CLAMP_TO_EDGE),o.activeTexture.set(d.TEXTURE1),w.lineAtlas.bind(o),R.updatePaintBuffers(F)}function nl(w,t,o,d,x){if(!o||!d||!d.imageAtlas)return;const S=d.imageAtlas.patternPositions;let A=S[o.to.toString()],R=S[o.from.toString()];if(!A&&R&&(A=R),!R&&A&&(R=A),!A||!R){const F=x.getPaintProperty(t);A=S[F],R=S[F]}A&&R&&w.setConstantPatternPositions(A,R)}function Fi(w,t,o,d,x,S,A,R){const F=w.context.gl,V="fill-pattern",q=o.paint.get(V),te=q&&q.constantOr(1),Q=o.getCrossfadeParameters();let ce,_e,Ie,Oe,Le;const qe=w.transform,nt=o.paint.get("fill-translate"),He=o.paint.get("fill-translate-anchor");A?(_e=te&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ce=F.LINES):(_e=te?"fillPattern":"fill",ce=F.TRIANGLES);const rt=q.constantOr(null);for(const ot of d){const Xe=t.getTile(ot);if(te&&!Xe.patternsLoaded())continue;const ft=Xe.getBucket(o);if(!ft)continue;const Pt=ft.programConfigurations.get(o.id),Et=w.useProgram(_e,Pt),Ct=w.style.map.terrain&&w.style.map.terrain.getTerrainData(ot);te&&(w.context.activeTexture.set(F.TEXTURE0),Xe.imageAtlasTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),Pt.updatePaintBuffers(Q)),nl(Pt,V,rt,Xe,o);const Dt=qe.getProjectionData({overscaledTileID:ot,applyGlobeMatrix:!R,applyTerrainMatrix:!0}),ur=s.aO(qe,Xe,nt,He);if(A){Oe=ft.indexBuffer2,Le=ft.segments2;const tr=[F.drawingBufferWidth,F.drawingBufferHeight];Ie=_e==="fillOutlinePattern"&&te?zc(w,Q,Xe,tr,ur):Rl(tr,ur)}else Oe=ft.indexBuffer,Le=ft.segments,Ie=te?Ps(w,Q,Xe,ur):{u_fill_translate:ur};const fr=w.stencilModeForClipping(ot);Et.draw(w.context,ce,x,fr,S,cn.backCCW,Ie,Ct,Dt,o.id,ft.layoutVertexBuffer,Oe,Le,o.paint,w.transform.zoom,Pt)}}function Li(w,t,o,d,x,S,A,R){const F=w.context,V=F.gl,q="fill-extrusion-pattern",te=o.paint.get(q),Q=te.constantOr(1),ce=o.getCrossfadeParameters(),_e=o.paint.get("fill-extrusion-opacity"),Ie=te.constantOr(null),Oe=w.transform;for(const Le of d){const qe=t.getTile(Le),nt=qe.getBucket(o);if(!nt)continue;const He=w.style.map.terrain&&w.style.map.terrain.getTerrainData(Le),rt=nt.programConfigurations.get(o.id),ot=w.useProgram(Q?"fillExtrusionPattern":"fillExtrusion",rt);Q&&(w.context.activeTexture.set(V.TEXTURE0),qe.imageAtlasTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE),rt.updatePaintBuffers(ce));const Xe=Oe.getProjectionData({overscaledTileID:Le,applyGlobeMatrix:!R,applyTerrainMatrix:!0});nl(rt,q,Ie,qe,o);const ft=s.aO(Oe,qe,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),Pt=o.paint.get("fill-extrusion-vertical-gradient"),Et=Q?bs(w,Pt,_e,ft,Le,ce,qe):Aa(w,Pt,_e,ft);ot.draw(F,F.gl.TRIANGLES,x,S,A,cn.backCCW,Et,He,Xe,o.id,nt.layoutVertexBuffer,nt.indexBuffer,nt.segments,o.paint,w.transform.zoom,rt,w.style.map.terrain&&nt.centroidVertexBuffer)}}function Bs(w,t,o,d,x,S,A,R,F){var V;const q=w.style.projection,te=w.context,Q=w.transform,ce=te.gl,_e=[`#define NUM_ILLUMINATION_SOURCES ${o.paint.get("hillshade-highlight-color").values.length}`],Ie=w.useProgram("hillshade",null,!1,_e),Oe=!w.options.moving;for(const Le of d){const qe=t.getTile(Le),nt=qe.fbo;if(!nt)continue;const He=q.getMeshFromTileID(te,Le.canonical,R,!0,"raster"),rt=(V=w.style.map.terrain)===null||V===void 0?void 0:V.getTerrainData(Le);te.activeTexture.set(ce.TEXTURE0),ce.bindTexture(ce.TEXTURE_2D,nt.colorAttachment.get());const ot=Q.getProjectionData({overscaledTileID:Le,aligned:Oe,applyGlobeMatrix:!F,applyTerrainMatrix:!0});Ie.draw(te,ce.TRIANGLES,S,x[Le.overscaledZ],A,cn.backCCW,Oc(w,qe,o),rt,ot,o.id,He.vertexBuffer,He.indexBuffer,He.segments)}}function io(w,t,o,d,x,S,A,R,F){var V;const q=w.style.projection,te=w.context,Q=w.transform,ce=te.gl,_e=w.useProgram("colorRelief"),Ie=!w.options.moving;let Oe=!0,Le=0;for(const qe of d){const nt=t.getTile(qe),He=nt.dem;if(Oe){const Et=ce.getParameter(ce.MAX_TEXTURE_SIZE),{elevationTexture:Ct,colorTexture:Dt}=o.getColorRampTextures(te,Et,He.getUnpackVector());te.activeTexture.set(ce.TEXTURE1),Ct.bind(ce.NEAREST,ce.CLAMP_TO_EDGE),te.activeTexture.set(ce.TEXTURE4),Dt.bind(ce.LINEAR,ce.CLAMP_TO_EDGE),Oe=!1,Le=Ct.size[0]}if(!He||!He.data)continue;const rt=He.stride,ot=He.getPixels();if(te.activeTexture.set(ce.TEXTURE0),te.pixelStoreUnpackPremultiplyAlpha.set(!1),nt.demTexture=nt.demTexture||w.getTileTexture(rt),nt.demTexture){const Et=nt.demTexture;Et.update(ot,{premultiply:!1}),Et.bind(ce.LINEAR,ce.CLAMP_TO_EDGE)}else nt.demTexture=new s.T(te,ot,ce.RGBA,{premultiply:!1}),nt.demTexture.bind(ce.LINEAR,ce.CLAMP_TO_EDGE);const Xe=q.getMeshFromTileID(te,qe.canonical,R,!0,"raster"),ft=(V=w.style.map.terrain)===null||V===void 0?void 0:V.getTerrainData(qe),Pt=Q.getProjectionData({overscaledTileID:qe,aligned:Ie,applyGlobeMatrix:!F,applyTerrainMatrix:!0});_e.draw(te,ce.TRIANGLES,S,x[qe.overscaledZ],A,cn.backCCW,ch(o,nt.dem,Le),ft,Pt,o.id,Xe.vertexBuffer,Xe.indexBuffer,Xe.segments)}}const so=[new s.P(0,0),new s.P(s.a5,0),new s.P(s.a5,s.a5),new s.P(0,s.a5)];function Ba(w,t,o,d,x,S,A,R,F=!1,V=!1){const q=d[d.length-1].overscaledZ,te=w.context,Q=te.gl,ce=w.useProgram("raster"),_e=w.transform,Ie=w.style.projection,Oe=w.colorModeForRenderPass(),Le=!w.options.moving,qe=o.paint.get("raster-opacity"),nt=o.paint.get("raster-resampling"),He=o.paint.get("raster-fade-duration"),rt=!!w.style.map.terrain;for(const ot of d){const Xe=w.getDepthModeForSublayer(ot.overscaledZ-q,qe===1?sn.ReadWrite:sn.ReadOnly,Q.LESS),ft=t.getTile(ot),Pt=nt==="nearest"?Q.NEAREST:Q.LINEAR;te.activeTexture.set(Q.TEXTURE0),ft.texture.bind(Pt,Q.CLAMP_TO_EDGE,Q.LINEAR_MIPMAP_NEAREST),te.activeTexture.set(Q.TEXTURE1);const{parentTile:Et,parentScaleBy:Ct,parentTopLeft:Dt,fadeValues:ur}=Ai(ft,t,He,rt);ft.fadeOpacity=ur.tileOpacity,Et?(Et.fadeOpacity=ur.parentTileOpacity,Et.texture.bind(Pt,Q.CLAMP_TO_EDGE,Q.LINEAR_MIPMAP_NEAREST)):ft.texture.bind(Pt,Q.CLAMP_TO_EDGE,Q.LINEAR_MIPMAP_NEAREST),ft.texture.useMipmap&&te.extTextureFilterAnisotropic&&w.transform.pitch>20&&Q.texParameterf(Q.TEXTURE_2D,te.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,te.extTextureFilterAnisotropicMax);const fr=w.style.map.terrain&&w.style.map.terrain.getTerrainData(ot),tr=_e.getProjectionData({overscaledTileID:ot,aligned:Le,applyGlobeMatrix:!V,applyTerrainMatrix:!0}),br=uh(Dt,Ct,ur.fadeMix,o,R),hn=Ie.getMeshFromTileID(te,ot.canonical,S,A,"raster");ce.draw(te,Q.TRIANGLES,Xe,x?x[ot.overscaledZ]:bn.disabled,Oe,F?cn.frontCCW:cn.backCCW,br,fr,tr,o.id,hn.vertexBuffer,hn.indexBuffer,hn.segments)}}function Ai(w,t,o,d){const x={parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:{tileOpacity:1,parentTileOpacity:1,fadeMix:{opacity:1,mix:0}}};if(o===0||d)return x;if(w.fadingParentID){const S=t.getLoadedTile(w.fadingParentID);if(!S)return x;const A=Math.pow(2,S.tileID.overscaledZ-w.tileID.overscaledZ),R=[w.tileID.canonical.x*A%1,w.tileID.canonical.y*A%1],F=(function(V,q,te){const Q=z(),ce=(Q-q.timeAdded)/te,_e=V.fadingDirection===vt.Incoming,Ie=s.an((Q-V.timeAdded)/te,0,1),Oe=s.an(1-ce,0,1),Le=_e?Ie:Oe;return{tileOpacity:Le,parentTileOpacity:_e?Oe:Ie,fadeMix:{opacity:1,mix:1-Le}}})(w,S,o);return{parentTile:S,parentScaleBy:A,parentTopLeft:R,fadeValues:F}}if(w.selfFading){const S=(function(A,R){const F=(z()-A.timeAdded)/R,V=s.an(F,0,1);return{tileOpacity:V,fadeMix:{opacity:V,mix:0}}})(w,o);return{parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:S}}return x}const zi=new s.bp(1,0,0,1),ui=new s.bp(0,1,0,1),Ol=new s.bp(0,0,1,1),mh=new s.bp(1,0,1,1),us=new s.bp(0,1,1,1);function dc(w,t,o,d){Xa(w,0,t+o/2,w.transform.width,o,d)}function al(w,t,o,d){Xa(w,t-o/2,0,o,w.transform.height,d)}function Xa(w,t,o,d,x,S){const A=w.context,R=A.gl;R.enable(R.SCISSOR_TEST),R.scissor(t*w.pixelRatio,o*w.pixelRatio,d*w.pixelRatio,x*w.pixelRatio),A.clear({color:S}),R.disable(R.SCISSOR_TEST)}function Eu(w,t,o){const d=w.context,x=d.gl,S=w.useProgram("debug"),A=sn.disabled,R=bn.disabled,F=w.colorModeForRenderPass(),V="$debug",q=w.style.map.terrain&&w.style.map.terrain.getTerrainData(o);d.activeTexture.set(x.TEXTURE0);const te=t.getTileByID(o.key).latestRawTileData,Q=Math.floor((te&&te.byteLength||0)/1024),ce=t.getTile(o).tileSize,_e=512/Math.min(ce,512)*(o.overscaledZ/w.transform.zoom)*.5;let Ie=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(Ie+=` => ${o.overscaledZ}`),(function(Le,qe){Le.initDebugOverlayCanvas();const nt=Le.debugOverlayCanvas,He=Le.context.gl,rt=Le.debugOverlayCanvas.getContext("2d");rt.clearRect(0,0,nt.width,nt.height),rt.shadowColor="white",rt.shadowBlur=2,rt.lineWidth=1.5,rt.strokeStyle="white",rt.textBaseline="top",rt.font="bold 36px Open Sans, sans-serif",rt.fillText(qe,5,5),rt.strokeText(qe,5,5),Le.debugOverlayTexture.update(nt),Le.debugOverlayTexture.bind(He.LINEAR,He.CLAMP_TO_EDGE)})(w,`${Ie} ${Q}kB`);const Oe=w.transform.getProjectionData({overscaledTileID:o,applyGlobeMatrix:!0,applyTerrainMatrix:!0});S.draw(d,x.TRIANGLES,A,R,Zn.alphaBlended,cn.disabled,ic(s.bp.transparent,_e),null,Oe,V,w.debugBuffer,w.quadTriangleIndexBuffer,w.debugSegments),S.draw(d,x.LINE_STRIP,A,R,F,cn.disabled,ic(s.bp.red),q,Oe,V,w.debugBuffer,w.tileBorderIndexBuffer,w.debugSegments)}function gh(w,t,o,d){const{isRenderingGlobe:x}=d,S=w.context,A=S.gl,R=w.transform,F=w.colorModeForRenderPass(),V=w.getDepthModeFor3D(),q=w.useProgram("terrain");S.bindFramebuffer.set(null),S.viewport.set([0,0,w.width,w.height]);for(const te of o){const Q=t.getTerrainMesh(te.tileID),ce=w.renderToTexture.getTexture(te),_e=t.getTerrainData(te.tileID);S.activeTexture.set(A.TEXTURE0),A.bindTexture(A.TEXTURE_2D,ce.texture);const Ie=t.getMeshFrameDelta(R.zoom),Oe=R.calculateFogMatrix(te.tileID.toUnwrapped()),Le=Xh(Ie,Oe,w.style.sky,R.pitch,x),qe=R.getProjectionData({overscaledTileID:te.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});q.draw(S,A.TRIANGLES,V,bn.disabled,F,cn.backCCW,Le,_e,qe,"terrain",Q.vertexBuffer,Q.indexBuffer,Q.segments)}}function Hc(w,t){if(!t.mesh){const o=new s.aW;o.emplaceBack(-1,-1),o.emplaceBack(1,-1),o.emplaceBack(1,1),o.emplaceBack(-1,1);const d=new s.aY;d.emplaceBack(0,1,2),d.emplaceBack(0,2,3),t.mesh=new Yn(w.createVertexBuffer(o,ys.members),w.createIndexBuffer(d),s.aX.simpleSegment(0,0,o.length,d.length))}return t.mesh}class Yh{constructor(t,o){this.context=new Dr(t),this.transform=o,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:s.ar(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Re.maxOverzooming+Re.maxUnderzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ba}resize(t,o,d){if(this.width=Math.floor(t*d),this.height=Math.floor(o*d),this.pixelRatio=d,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const x of this.style._order)this.style._layers[x].resize()}setup(){const t=this.context,o=new s.aW;o.emplaceBack(0,0),o.emplaceBack(s.a5,0),o.emplaceBack(0,s.a5),o.emplaceBack(s.a5,s.a5),this.tileExtentBuffer=t.createVertexBuffer(o,ys.members),this.tileExtentSegments=s.aX.simpleSegment(0,0,4,2);const d=new s.aW;d.emplaceBack(0,0),d.emplaceBack(s.a5,0),d.emplaceBack(0,s.a5),d.emplaceBack(s.a5,s.a5),this.debugBuffer=t.createVertexBuffer(d,ys.members),this.debugSegments=s.aX.simpleSegment(0,0,4,5);const x=new s.ch;x.emplaceBack(0,0,0,0),x.emplaceBack(s.a5,0,s.a5,0),x.emplaceBack(0,s.a5,0,s.a5),x.emplaceBack(s.a5,s.a5,s.a5,s.a5),this.rasterBoundsBuffer=t.createVertexBuffer(x,lh.members),this.rasterBoundsSegments=s.aX.simpleSegment(0,0,4,2);const S=new s.aW;S.emplaceBack(0,0),S.emplaceBack(s.a5,0),S.emplaceBack(0,s.a5),S.emplaceBack(s.a5,s.a5),this.rasterBoundsBufferPosOnly=t.createVertexBuffer(S,ys.members),this.rasterBoundsSegmentsPosOnly=s.aX.simpleSegment(0,0,4,5);const A=new s.aW;A.emplaceBack(0,0),A.emplaceBack(1,0),A.emplaceBack(0,1),A.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(A,ys.members),this.viewportSegments=s.aX.simpleSegment(0,0,4,2);const R=new s.ci;R.emplaceBack(0),R.emplaceBack(1),R.emplaceBack(3),R.emplaceBack(2),R.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(R);const F=new s.aY;F.emplaceBack(1,0,2),F.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(F);const V=this.context.gl;this.stencilClearMode=new bn({func:V.ALWAYS,mask:0},0,255,V.ZERO,V.ZERO,V.ZERO),this.tileExtentMesh=new Yn(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const t=this.context,o=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const d=s.N();s.c7(d,0,this.width,this.height,0,0,1),s.Q(d,d,[o.drawingBufferWidth,o.drawingBufferHeight,0]);const x={mainMatrix:d,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:d};this.useProgram("clippingMask",null,!0).draw(t,o.TRIANGLES,sn.disabled,this.stencilClearMode,Zn.disabled,cn.disabled,null,null,x,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,o,d){if(this.currentStencilSource===t.source||!t.isTileClipped()||!o||!o.length)return;this.currentStencilSource=t.source,this.nextStencilID+o.length>256&&this.clearStencil();const x=this.context;x.setColorMode(Zn.disabled),x.setDepthMode(sn.disabled);const S={};for(const A of o)S[A.key]=this.nextStencilID++;this._renderTileMasks(S,o,d,!0),this._renderTileMasks(S,o,d,!1),this._tileClippingMaskIDs=S}_renderTileMasks(t,o,d,x){const S=this.context,A=S.gl,R=this.style.projection,F=this.transform,V=this.useProgram("clippingMask");for(const q of o){const te=t[q.key],Q=this.style.map.terrain&&this.style.map.terrain.getTerrainData(q),ce=R.getMeshFromTileID(this.context,q.canonical,x,!0,"stencil"),_e=F.getProjectionData({overscaledTileID:q,applyGlobeMatrix:!d,applyTerrainMatrix:!0});V.draw(S,A.TRIANGLES,sn.disabled,new bn({func:A.ALWAYS,mask:0},te,255,A.KEEP,A.KEEP,A.REPLACE),Zn.disabled,d?cn.disabled:cn.backCCW,null,Q,_e,"$clipping",ce.vertexBuffer,ce.indexBuffer,ce.segments)}}_renderTilesDepthBuffer(){const t=this.context,o=t.gl,d=this.style.projection,x=this.transform,S=this.useProgram("depth"),A=this.getDepthModeFor3D(),R=va(x,{tileSize:x.tileSize});for(const F of R){const V=this.style.map.terrain&&this.style.map.terrain.getTerrainData(F),q=d.getMeshFromTileID(this.context,F.canonical,!0,!0,"raster"),te=x.getProjectionData({overscaledTileID:F,applyGlobeMatrix:!0,applyTerrainMatrix:!0});S.draw(t,o.TRIANGLES,A,bn.disabled,Zn.disabled,cn.backCCW,null,V,te,"$clipping",q.vertexBuffer,q.indexBuffer,q.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,o=this.context.gl;return new bn({func:o.NOTEQUAL,mask:255},t,255,o.KEEP,o.KEEP,o.REPLACE)}stencilModeForClipping(t){const o=this.context.gl;return new bn({func:o.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,o.KEEP,o.KEEP,o.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(t){const o=this.context.gl,d=t.sort(((A,R)=>R.overscaledZ-A.overscaledZ)),x=d[d.length-1].overscaledZ,S=d[0].overscaledZ-x+1;if(S>1){this.currentStencilSource=void 0,this.nextStencilID+S>256&&this.clearStencil();const A={};for(let R=0;R<S;R++)A[R+x]=new bn({func:o.GEQUAL,mask:255},R+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=S,[A,d]}return[{[x]:bn.disabled},d]}stencilConfigForOverlapTwoPass(t){const o=this.context.gl,d=t.sort(((A,R)=>R.overscaledZ-A.overscaledZ)),x=d[d.length-1].overscaledZ,S=d[0].overscaledZ-x+1;if(this.clearStencil(),S>1){const A={},R={};for(let F=0;F<S;F++)A[F+x]=new bn({func:o.GREATER,mask:255},S+1+F,255,o.KEEP,o.KEEP,o.REPLACE),R[F+x]=new bn({func:o.GREATER,mask:255},1+F,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID=2*S+1,[A,R,d]}return this.nextStencilID=3,[{[x]:new bn({func:o.GREATER,mask:255},2,255,o.KEEP,o.KEEP,o.REPLACE)},{[x]:new bn({func:o.GREATER,mask:255},1,255,o.KEEP,o.KEEP,o.REPLACE)},d]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new Zn([t.CONSTANT_COLOR,t.ONE],new s.bp(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Zn.unblended:Zn.alphaBlended}getDepthModeForSublayer(t,o,d){if(!this.opaquePassEnabledForLayer())return sn.disabled;const x=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new sn(d||this.context.gl.LEQUAL,o,[x,x])}getDepthModeFor3D(){return new sn(this.context.gl.LEQUAL,sn.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,o){var d,x;this.style=t,this.options=o,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(z()),this.imageManager.beginFrame();const S=this.style._order,A=this.style.tileManagers,R={},F={},V={},q={isRenderingToTexture:!1,isRenderingGlobe:((d=t.projection)===null||d===void 0?void 0:d.transitionState)>0};for(const Q in A){const ce=A[Q];ce.used&&ce.prepare(this.context),R[Q]=ce.getVisibleCoordinates(!1),F[Q]=R[Q].slice().reverse(),V[Q]=ce.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let Q=0;Q<S.length;Q++)if(this.style._layers[S[Q]].is3D()){this.opaquePassCutoff=Q;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const Q of S){const ce=this.style._layers[Q];if(!ce.hasOffscreenPass()||ce.isHidden(this.transform.zoom))continue;const _e=F[ce.source];(ce.type==="custom"||_e.length)&&this.renderLayer(this,A[ce.source],ce,_e,q)}if((x=this.style.projection)===null||x===void 0||x.updateGPUdependent({context:this.context,useProgram:Q=>this.useProgram(Q)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:o.showOverdrawInspector?s.bp.black:s.bp.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(Q,ce){const _e=Q.context,Ie=_e.gl,Oe=((ot,Xe,ft)=>{const Pt=Math.cos(Xe.rollInRadians),Et=Math.sin(Xe.rollInRadians),Ct=xn(Xe),Dt=Xe.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:ot.properties.get("sky-color"),u_horizon_color:ot.properties.get("horizon-color"),u_horizon:[(Xe.width/2-Ct*Et)*ft,(Xe.height/2+Ct*Pt)*ft],u_horizon_normal:[-Et,Pt],u_sky_horizon_blend:ot.properties.get("sky-horizon-blend")*Xe.height/2*ft,u_sky_blend:Dt}})(ce,Q.style.map.transform,Q.pixelRatio),Le=new sn(Ie.LEQUAL,sn.ReadWrite,[0,1]),qe=bn.disabled,nt=Q.colorModeForRenderPass(),He=Q.useProgram("sky"),rt=Hc(_e,ce);He.draw(_e,Ie.TRIANGLES,Le,qe,nt,cn.disabled,Oe,null,void 0,"sky",rt.vertexBuffer,rt.indexBuffer,rt.segments)})(this,this.style.sky),this._showOverdrawInspector=o.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=S.length-1;this.currentLayer>=0;this.currentLayer--){const Q=this.style._layers[S[this.currentLayer]],ce=A[Q.source],_e=R[Q.source];this._renderTileClippingMasks(Q,_e,!1),this.renderLayer(this,ce,Q,_e,q)}this.renderPass="translucent";let te=!1;for(this.currentLayer=0;this.currentLayer<S.length;this.currentLayer++){const Q=this.style._layers[S[this.currentLayer]],ce=A[Q.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(Q,q))continue;this.opaquePassEnabledForLayer()||te||(te=!0,q.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const _e=(Q.type==="symbol"?V:F)[Q.source];this._renderTileClippingMasks(Q,R[Q.source],!!this.renderToTexture),this.renderLayer(this,ce,Q,_e,q)}if(q.isRenderingGlobe&&(function(Q,ce,_e){const Ie=Q.context,Oe=Ie.gl,Le=Q.useProgram("atmosphere"),qe=new sn(Oe.LEQUAL,sn.ReadOnly,[0,1]),nt=Q.transform,He=(function(Dt,ur){const fr=Dt.properties.get("position"),tr=[-fr.x,-fr.y,-fr.z],br=s.ar(new Float64Array(16));return Dt.properties.get("anchor")==="map"&&(s.bg(br,br,ur.rollInRadians),s.bh(br,br,-ur.pitchInRadians),s.bg(br,br,ur.bearingInRadians),s.bh(br,br,ur.center.lat*Math.PI/180),s.bJ(br,br,-ur.center.lng*Math.PI/180)),s.cg(tr,tr,br),tr})(_e,Q.transform),rt=nt.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ot=ce.properties.get("atmosphere-blend")*rt.projectionTransition;if(ot===0)return;const Xe=Yo(nt.worldSize,nt.center.lat),ft=nt.inverseProjectionMatrix,Pt=new Float64Array(4);Pt[3]=1,s.aH(Pt,Pt,nt.modelViewProjectionMatrix),Pt[0]/=Pt[3],Pt[1]/=Pt[3],Pt[2]/=Pt[3],Pt[3]=1,s.aH(Pt,Pt,ft),Pt[0]/=Pt[3],Pt[1]/=Pt[3],Pt[2]/=Pt[3],Pt[3]=1;const Et=((Dt,ur,fr,tr,br)=>({u_sun_pos:Dt,u_atmosphere_blend:ur,u_globe_position:fr,u_globe_radius:tr,u_inv_proj_matrix:br}))(He,ot,[Pt[0],Pt[1],Pt[2]],Xe,ft),Ct=Hc(Ie,ce);Le.draw(Ie,Oe.TRIANGLES,qe,bn.disabled,Zn.alphaBlended,cn.disabled,Et,null,null,"atmosphere",Ct.vertexBuffer,Ct.indexBuffer,Ct.segments)})(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const Q=(function(ce,_e){let Ie=null;const Oe=Object.values(ce._layers).flatMap((He=>He.source&&!He.isHidden(_e)?[ce.tileManagers[He.source]]:[])),Le=Oe.filter((He=>He.getSource().type==="vector")),qe=Oe.filter((He=>He.getSource().type!=="vector")),nt=He=>{(!Ie||Ie.getSource().maxzoom<He.getSource().maxzoom)&&(Ie=He)};return Le.forEach((He=>nt(He))),Ie||qe.forEach((He=>nt(He))),Ie})(this.style,this.transform.zoom);Q&&(function(ce,_e,Ie){for(let Oe=0;Oe<Ie.length;Oe++)Eu(ce,_e,Ie[Oe])})(this,Q,Q.getVisibleCoordinates())}this.options.showPadding&&(function(Q){const ce=Q.transform.padding;dc(Q,Q.transform.height-(ce.top||0),3,zi),dc(Q,ce.bottom||0,3,ui),al(Q,ce.left||0,3,Ol),al(Q,Q.transform.width-(ce.right||0),3,mh);const _e=Q.transform.centerPoint;(function(Ie,Oe,Le,qe){Xa(Ie,Oe-1,Le-10,2,20,qe),Xa(Ie,Oe-10,Le-1,20,2,qe)})(Q,_e.x,Q.transform.height-_e.y,us)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(t){if(!this.style||!this.style.map||!this.style.map.terrain)return;const o=this.terrainFacilitator.matrix,d=this.transform.modelViewProjectionMatrix;let x=this.terrainFacilitator.dirty;x||(x=t?!s.cj(o,d):!s.ck(o,d)),x||(x=this.style.map.terrain.tileManager.anyTilesAfterTime(this.terrainFacilitator.renderTime)),x&&(s.cl(o,d),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(S,A){const R=S.context,F=R.gl,V=S.transform,q=Zn.unblended,te=new sn(F.LEQUAL,sn.ReadWrite,[0,1]),Q=A.tileManager.getRenderableTiles(),ce=S.useProgram("terrainDepth");R.bindFramebuffer.set(A.getFramebuffer("depth").framebuffer),R.viewport.set([0,0,S.width/devicePixelRatio,S.height/devicePixelRatio]),R.clear({color:s.bp.transparent,depth:1});for(const _e of Q){const Ie=A.getTerrainMesh(_e.tileID),Oe=A.getTerrainData(_e.tileID),Le=V.getProjectionData({overscaledTileID:_e.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),qe={u_ele_delta:A.getMeshFrameDelta(V.zoom)};ce.draw(R,F.TRIANGLES,te,bn.disabled,q,cn.backCCW,qe,Oe,Le,"terrain",Ie.vertexBuffer,Ie.indexBuffer,Ie.segments)}R.bindFramebuffer.set(null),R.viewport.set([0,0,S.width,S.height])})(this,this.style.map.terrain),(function(S,A){const R=S.context,F=R.gl,V=S.transform,q=Zn.unblended,te=new sn(F.LEQUAL,sn.ReadWrite,[0,1]),Q=A.getCoordsTexture(),ce=A.tileManager.getRenderableTiles(),_e=S.useProgram("terrainCoords");R.bindFramebuffer.set(A.getFramebuffer("coords").framebuffer),R.viewport.set([0,0,S.width/devicePixelRatio,S.height/devicePixelRatio]),R.clear({color:s.bp.transparent,depth:1}),A.coordsIndex=[];for(const Ie of ce){const Oe=A.getTerrainMesh(Ie.tileID),Le=A.getTerrainData(Ie.tileID);R.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,Q.texture);const qe={u_terrain_coords_id:(255-A.coordsIndex.length)/255,u_texture:0,u_ele_delta:A.getMeshFrameDelta(V.zoom)},nt=V.getProjectionData({overscaledTileID:Ie.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});_e.draw(R,F.TRIANGLES,te,bn.disabled,q,cn.backCCW,qe,Le,nt,"terrain",Oe.vertexBuffer,Oe.indexBuffer,Oe.segments),A.coordsIndex.push(Ie.tileID.key)}R.bindFramebuffer.set(null),R.viewport.set([0,0,S.width,S.height])})(this,this.style.map.terrain))}renderLayer(t,o,d,x,S){d.isHidden(this.transform.zoom)||(d.type==="background"||d.type==="custom"||(x||[]).length)&&(this.id=d.id,s.cm(d)?(function(A,R,F,V,q,te){if(A.renderPass!=="translucent")return;const{isRenderingToTexture:Q}=te,ce=bn.disabled,_e=A.colorModeForRenderPass();(F._unevaluatedLayout.hasValue("text-variable-anchor")||F._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(Ie,Oe,Le,qe,nt,He,rt,ot,Xe){const ft=Oe.transform,Pt=Oe.style.map.terrain,Et=nt==="map",Ct=He==="map";for(const Dt of Ie){const ur=qe.getTile(Dt),fr=ur.getBucket(Le);if(!fr||!fr.text||!fr.text.segments.get().length)continue;const tr=s.ay(fr.textSizeData,ft.zoom),br=s.aN(ur,1,Oe.transform.zoom),hn=Ut(Et,Oe.transform,br),Xn=Le.layout.get("icon-text-fit")!=="none"&&fr.hasIconData();if(tr){const xa=Math.pow(2,ft.zoom-ur.tileID.overscaledZ),ua=Pt?(Ca,ra)=>Pt.getElevation(Dt,Ca,ra):null;Fr(fr,Et,Ct,Xe,ft,hn,xa,tr,Xn,s.aO(ft,ur,rt,ot),Dt.toUnwrapped(),ua)}}})(V,A,F,R,F.layout.get("text-rotation-alignment"),F.layout.get("text-pitch-alignment"),F.paint.get("text-translate"),F.paint.get("text-translate-anchor"),q),F.paint.get("icon-opacity").constantOr(1)!==0&&Wr(A,R,F,V,!1,F.paint.get("icon-translate"),F.paint.get("icon-translate-anchor"),F.layout.get("icon-rotation-alignment"),F.layout.get("icon-pitch-alignment"),F.layout.get("icon-keep-upright"),ce,_e,Q),F.paint.get("text-opacity").constantOr(1)!==0&&Wr(A,R,F,V,!0,F.paint.get("text-translate"),F.paint.get("text-translate-anchor"),F.layout.get("text-rotation-alignment"),F.layout.get("text-pitch-alignment"),F.layout.get("text-keep-upright"),ce,_e,Q),R.map.showCollisionBoxes&&(yr(A,R,F,V,!0),yr(A,R,F,V,!1))})(t,o,d,x,this.style.placement.variableOffsets,S):s.cn(d)?(function(A,R,F,V,q){if(A.renderPass!=="translucent")return;const{isRenderingToTexture:te}=q,Q=F.paint.get("circle-opacity"),ce=F.paint.get("circle-stroke-width"),_e=F.paint.get("circle-stroke-opacity"),Ie=!F.layout.get("circle-sort-key").isConstant();if(Q.constantOr(1)===0&&(ce.constantOr(1)===0||_e.constantOr(1)===0))return;const Oe=A.context,Le=Oe.gl,qe=A.transform,nt=A.getDepthModeForSublayer(0,sn.ReadOnly),He=bn.disabled,rt=A.colorModeForRenderPass(),ot=[],Xe=qe.getCircleRadiusCorrection();for(let ft=0;ft<V.length;ft++){const Pt=V[ft],Et=R.getTile(Pt),Ct=Et.getBucket(F);if(!Ct)continue;const Dt=F.paint.get("circle-translate"),ur=F.paint.get("circle-translate-anchor"),fr=s.aO(qe,Et,Dt,ur),tr=Ct.programConfigurations.get(F.id),br=A.useProgram("circle",tr),hn=Ct.layoutVertexBuffer,Xn=Ct.indexBuffer,xa=A.style.map.terrain&&A.style.map.terrain.getTerrainData(Pt),ua={programConfiguration:tr,program:br,layoutVertexBuffer:hn,indexBuffer:Xn,uniformValues:Qi(A,Et,F,fr,Xe),terrainData:xa,projectionData:qe.getProjectionData({overscaledTileID:Pt,applyGlobeMatrix:!te,applyTerrainMatrix:!0})};if(Ie){const Ca=Ct.segments.get();for(const ra of Ca)ot.push({segments:new s.aX([ra]),sortKey:ra.sortKey,state:ua})}else ot.push({segments:Ct.segments,sortKey:0,state:ua})}Ie&&ot.sort(((ft,Pt)=>ft.sortKey-Pt.sortKey));for(const ft of ot){const{programConfiguration:Pt,program:Et,layoutVertexBuffer:Ct,indexBuffer:Dt,uniformValues:ur,terrainData:fr,projectionData:tr}=ft.state;Et.draw(Oe,Le.TRIANGLES,nt,He,rt,cn.backCCW,ur,fr,tr,F.id,Ct,Dt,ft.segments,F.paint,A.transform.zoom,Pt)}})(t,o,d,x,S):s.co(d)?(function(A,R,F,V,q){if(F.paint.get("heatmap-opacity")===0)return;const te=A.context,{isRenderingToTexture:Q,isRenderingGlobe:ce}=q;if(A.style.map.terrain){for(const _e of V){const Ie=R.getTile(_e);R.hasRenderableParent(_e)||(A.renderPass==="offscreen"?Vr(A,Ie,F,_e,ce):A.renderPass==="translucent"&&en(A,F,_e,Q,ce))}te.viewport.set([0,0,A.width,A.height])}else A.renderPass==="offscreen"?(function(_e,Ie,Oe,Le){const qe=_e.context,nt=qe.gl,He=_e.transform,rt=bn.disabled,ot=new Zn([nt.ONE,nt.ONE],s.bp.transparent,[!0,!0,!0,!0]);(function(Xe,ft,Pt){const Et=Xe.gl;Xe.activeTexture.set(Et.TEXTURE1),Xe.viewport.set([0,0,ft.width/4,ft.height/4]);let Ct=Pt.heatmapFbos.get(s.cd);Ct?(Et.bindTexture(Et.TEXTURE_2D,Ct.colorAttachment.get()),Xe.bindFramebuffer.set(Ct.framebuffer)):(Ct=$r(Xe,ft.width/4,ft.height/4),Pt.heatmapFbos.set(s.cd,Ct))})(qe,_e,Oe),qe.clear({color:s.bp.transparent});for(let Xe=0;Xe<Le.length;Xe++){const ft=Le[Xe];if(Ie.hasRenderableParent(ft))continue;const Pt=Ie.getTile(ft),Et=Pt.getBucket(Oe);if(!Et)continue;const Ct=Et.programConfigurations.get(Oe.id),Dt=_e.useProgram("heatmap",Ct),ur=He.getProjectionData({overscaledTileID:ft,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),fr=He.getCircleRadiusCorrection();Dt.draw(qe,nt.TRIANGLES,sn.disabled,rt,ot,cn.backCCW,tl(Pt,He.zoom,Oe.paint.get("heatmap-intensity"),fr),null,ur,Oe.id,Et.layoutVertexBuffer,Et.indexBuffer,Et.segments,Oe.paint,He.zoom,Ct)}qe.viewport.set([0,0,_e.width,_e.height])})(A,R,F,V):A.renderPass==="translucent"&&(function(_e,Ie){const Oe=_e.context,Le=Oe.gl;Oe.setColorMode(_e.colorModeForRenderPass());const qe=Ie.heatmapFbos.get(s.cd);qe&&(Oe.activeTexture.set(Le.TEXTURE0),Le.bindTexture(Le.TEXTURE_2D,qe.colorAttachment.get()),Oe.activeTexture.set(Le.TEXTURE1),Yr(Oe,Ie).bind(Le.LINEAR,Le.CLAMP_TO_EDGE),_e.useProgram("heatmapTexture").draw(Oe,Le.TRIANGLES,sn.disabled,bn.disabled,_e.colorModeForRenderPass(),cn.disabled,to(_e,Ie,0,1),null,null,Ie.id,_e.viewportBuffer,_e.quadTriangleIndexBuffer,_e.viewportSegments,Ie.paint,_e.transform.zoom))})(A,F)})(t,o,d,x,S):s.cp(d)?(function(A,R,F,V,q){if(A.renderPass!=="translucent")return;const{isRenderingToTexture:te}=q,Q=F.paint.get("line-opacity"),ce=F.paint.get("line-width");if(Q.constantOr(1)===0||ce.constantOr(1)===0)return;const _e=A.getDepthModeForSublayer(0,sn.ReadOnly),Ie=A.colorModeForRenderPass(),Oe=F.paint.get("line-dasharray"),Le=Oe.constantOr(1),qe=F.paint.get("line-pattern"),nt=qe.constantOr(1),He=F.paint.get("line-gradient"),rt=F.getCrossfadeParameters();let ot;ot=nt?"linePattern":Le&&He?"lineGradientSDF":Le?"lineSDF":He?"lineGradient":"line";const Xe=A.context,ft=Xe.gl,Pt=A.transform;let Et=!0;for(const Ct of V){const Dt=R.getTile(Ct);if(nt&&!Dt.patternsLoaded())continue;const ur=Dt.getBucket(F);if(!ur)continue;const fr=ur.programConfigurations.get(F.id),tr=A.context.program.get(),br=A.useProgram(ot,fr),hn=Et||br.program!==tr,Xn=A.style.map.terrain&&A.style.map.terrain.getTerrainData(Ct),xa=qe.constantOr(null),ua=Oe&&Oe.constantOr(null);if(xa&&Dt.imageAtlas){const Bi=Dt.imageAtlas,Ka=Bi.patternPositions[xa.to.toString()],Ja=Bi.patternPositions[xa.from.toString()];Ka&&Ja&&fr.setConstantPatternPositions(Ka,Ja)}else if(ua){const Bi=F.layout.get("line-cap")==="round",Ka=A.lineAtlas.getDash(ua.to,Bi),Ja=A.lineAtlas.getDash(ua.from,Bi);fr.setConstantDashPositions(Ka,Ja)}const Ca=Pt.getProjectionData({overscaledTileID:Ct,applyGlobeMatrix:!te,applyTerrainMatrix:!0}),ra=Pt.getPixelScale();let Ua;nt?(Ua=Nc(A,Dt,F,ra,rt),On(Xe,ft,Dt,fr,rt)):Le&&He?(Ua=Fl(A,Dt,F,ra,rt,ur.lineClipsArray.length),$a(A,R,Xe,ft,F,ur,Ct,fr,rt)):Le?(Ua=es(A,Dt,F,ra,rt),Cn(A,Xe,ft,fr,hn,rt)):He?(Ua=ro(A,Dt,F,ra,ur.lineClipsArray.length),Wa(A,R,Xe,ft,F,ur,Ct)):Ua=Fs(A,Dt,F,ra);const Ma=A.stencilModeForClipping(Ct);br.draw(Xe,ft.TRIANGLES,_e,Ma,Ie,cn.disabled,Ua,Xn,Ca,F.id,ur.layoutVertexBuffer,ur.indexBuffer,ur.segments,F.paint,A.transform.zoom,fr,ur.layoutVertexBuffer2),Et=!1}})(t,o,d,x,S):s.cq(d)?(function(A,R,F,V,q){const te=F.paint.get("fill-color"),Q=F.paint.get("fill-opacity");if(Q.constantOr(1)===0)return;const{isRenderingToTexture:ce}=q,_e=A.colorModeForRenderPass(),Ie=F.paint.get("fill-pattern"),Oe=A.opaquePassEnabledForLayer()&&!Ie.constantOr(1)&&te.constantOr(s.bp.transparent).a===1&&Q.constantOr(0)===1?"opaque":"translucent";if(A.renderPass===Oe){const Le=A.getDepthModeForSublayer(1,A.renderPass==="opaque"?sn.ReadWrite:sn.ReadOnly);Fi(A,R,F,V,Le,_e,!1,ce)}if(A.renderPass==="translucent"&&F.paint.get("fill-antialias")){const Le=A.getDepthModeForSublayer(F.getPaintProperty("fill-outline-color")?2:0,sn.ReadOnly);Fi(A,R,F,V,Le,_e,!0,ce)}})(t,o,d,x,S):s.cr(d)?(function(A,R,F,V,q){const te=F.paint.get("fill-extrusion-opacity");if(te===0)return;const{isRenderingToTexture:Q}=q;if(A.renderPass==="translucent"){const ce=new sn(A.context.gl.LEQUAL,sn.ReadWrite,A.depthRangeFor3D);if(te!==1||F.paint.get("fill-extrusion-pattern").constantOr(1))Li(A,R,F,V,ce,bn.disabled,Zn.disabled,Q),Li(A,R,F,V,ce,A.stencilModeFor3D(),A.colorModeForRenderPass(),Q);else{const _e=A.colorModeForRenderPass();Li(A,R,F,V,ce,bn.disabled,_e,Q)}}})(t,o,d,x,S):s.cs(d)?(function(A,R,F,V,q){if(A.renderPass!=="offscreen"&&A.renderPass!=="translucent")return;const{isRenderingToTexture:te}=q,Q=A.context,ce=A.style.projection.useSubdivision,_e=A.getDepthModeForSublayer(0,sn.ReadOnly),Ie=A.colorModeForRenderPass();if(A.renderPass==="offscreen")(function(Oe,Le,qe,nt,He,rt,ot){const Xe=Oe.context,ft=Xe.gl;for(const Pt of qe){const Et=Le.getTile(Pt),Ct=Et.dem;if(!Ct||!Ct.data||!Et.needsHillshadePrepare)continue;const Dt=Ct.dim,ur=Ct.stride,fr=Ct.getPixels();if(Xe.activeTexture.set(ft.TEXTURE1),Xe.pixelStoreUnpackPremultiplyAlpha.set(!1),Et.demTexture=Et.demTexture||Oe.getTileTexture(ur),Et.demTexture){const br=Et.demTexture;br.update(fr,{premultiply:!1}),br.bind(ft.NEAREST,ft.CLAMP_TO_EDGE)}else Et.demTexture=new s.T(Xe,fr,ft.RGBA,{premultiply:!1}),Et.demTexture.bind(ft.NEAREST,ft.CLAMP_TO_EDGE);Xe.activeTexture.set(ft.TEXTURE0);let tr=Et.fbo;if(!tr){const br=new s.T(Xe,{width:Dt,height:Dt,data:null},ft.RGBA);br.bind(ft.LINEAR,ft.CLAMP_TO_EDGE),tr=Et.fbo=Xe.createFramebuffer(Dt,Dt,!0,!1),tr.colorAttachment.set(br.texture)}Xe.bindFramebuffer.set(tr.framebuffer),Xe.viewport.set([0,0,Dt,Dt]),Oe.useProgram("hillshadePrepare").draw(Xe,ft.TRIANGLES,He,rt,ot,cn.disabled,Bc(Et.tileID,Ct),null,null,nt.id,Oe.rasterBoundsBuffer,Oe.quadTriangleIndexBuffer,Oe.rasterBoundsSegments),Et.needsHillshadePrepare=!1}})(A,R,V,F,_e,bn.disabled,Ie),Q.viewport.set([0,0,A.width,A.height]);else if(A.renderPass==="translucent")if(ce){const[Oe,Le,qe]=A.stencilConfigForOverlapTwoPass(V);Bs(A,R,F,qe,Oe,_e,Ie,!1,te),Bs(A,R,F,qe,Le,_e,Ie,!0,te)}else{const[Oe,Le]=A.getStencilConfigForOverlapAndUpdateStencilID(V);Bs(A,R,F,Le,Oe,_e,Ie,!1,te)}})(t,o,d,x,S):s.ct(d)?(function(A,R,F,V,q){if(A.renderPass!=="translucent"||!V.length)return;const{isRenderingToTexture:te}=q,Q=A.style.projection.useSubdivision,ce=A.getDepthModeForSublayer(0,sn.ReadOnly),_e=A.colorModeForRenderPass();if(Q){const[Ie,Oe,Le]=A.stencilConfigForOverlapTwoPass(V);io(A,R,F,Le,Ie,ce,_e,!1,te),io(A,R,F,Le,Oe,ce,_e,!0,te)}else{const[Ie,Oe]=A.getStencilConfigForOverlapAndUpdateStencilID(V);io(A,R,F,Oe,Ie,ce,_e,!1,te)}})(t,o,d,x,S):s.bU(d)?(function(A,R,F,V,q){if(A.renderPass!=="translucent"||F.paint.get("raster-opacity")===0||!V.length)return;const{isRenderingToTexture:te}=q,Q=R.getSource(),ce=A.style.projection.useSubdivision;if(Q instanceof sr)Ba(A,R,F,V,null,!1,!1,Q.tileCoords,Q.flippedWindingOrder,te);else if(ce){const[_e,Ie,Oe]=A.stencilConfigForOverlapTwoPass(V);Ba(A,R,F,Oe,_e,!1,!0,so,!1,te),Ba(A,R,F,Oe,Ie,!0,!0,so,!1,te)}else{const[_e,Ie]=A.getStencilConfigForOverlapAndUpdateStencilID(V);Ba(A,R,F,Ie,_e,!1,!0,so,!1,te)}})(t,o,d,x,S):s.cu(d)?(function(A,R,F,V,q){const te=F.paint.get("background-color"),Q=F.paint.get("background-opacity");if(Q===0)return;const{isRenderingToTexture:ce}=q,_e=A.context,Ie=_e.gl,Oe=A.style.projection,Le=A.transform,qe=Le.tileSize,nt=F.paint.get("background-pattern");if(A.isPatternMissing(nt))return;const He=!nt&&te.a===1&&Q===1&&A.opaquePassEnabledForLayer()?"opaque":"translucent";if(A.renderPass!==He)return;const rt=bn.disabled,ot=A.getDepthModeForSublayer(0,He==="opaque"?sn.ReadWrite:sn.ReadOnly),Xe=A.colorModeForRenderPass(),ft=A.useProgram(nt?"backgroundPattern":"background"),Pt=V||va(Le,{tileSize:qe,terrain:A.style.map.terrain});nt&&(_e.activeTexture.set(Ie.TEXTURE0),A.imageManager.bind(A.context));const Et=F.getCrossfadeParameters();for(const Ct of Pt){const Dt=Le.getProjectionData({overscaledTileID:Ct,applyGlobeMatrix:!ce,applyTerrainMatrix:!0}),ur=nt?oc(Q,A,nt,{tileID:Ct,tileSize:qe},Et):sc(Q,te),fr=A.style.map.terrain&&A.style.map.terrain.getTerrainData(Ct),tr=Oe.getMeshFromTileID(_e,Ct.canonical,!1,!0,"raster");ft.draw(_e,Ie.TRIANGLES,ot,rt,Xe,cn.backCCW,ur,fr,Dt,F.id,tr.vertexBuffer,tr.indexBuffer,tr.segments)}})(t,0,d,x,S):s.cv(d)&&(function(A,R,F,V){const{isRenderingGlobe:q}=V,te=A.context,Q=F.implementation,ce=A.style.projection,_e=A.transform,Ie=_e.getProjectionDataForCustomLayer(q),Oe={farZ:_e.farZ,nearZ:_e.nearZ,fov:_e.fov*Math.PI/180,modelViewProjectionMatrix:_e.modelViewProjectionMatrix,projectionMatrix:_e.projectionMatrix,shaderData:{variantName:ce.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${ce.shaderPreludeCode.vertexSource}`,define:ce.shaderDefine},defaultProjectionData:Ie},Le=Q.renderingMode?Q.renderingMode:"2d";if(A.renderPass==="offscreen"){const qe=Q.prerender;qe&&(A.setCustomLayerDefaults(),te.setColorMode(A.colorModeForRenderPass()),qe.call(Q,te.gl,Oe),te.setDirty(),A.setBaseState())}else if(A.renderPass==="translucent"){A.setCustomLayerDefaults(),te.setColorMode(A.colorModeForRenderPass()),te.setStencilMode(bn.disabled);const qe=Le==="3d"?A.getDepthModeFor3D():A.getDepthModeForSublayer(0,sn.ReadOnly);te.setDepthMode(qe),Q.render(te.gl,Oe),te.setDirty(),A.setBaseState(),te.bindFramebuffer.set(null)}})(t,0,d,S))}saveTileTexture(t){const o=this._tileTextures[t.size[0]];o?o.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const o=this._tileTextures[t];return o&&o.length>0?o.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const o=this.imageManager.getPattern(t.from.toString()),d=this.imageManager.getPattern(t.to.toString());return!o||!d}useProgram(t,o,d=!1,x=[]){this.cache=this.cache||{};const S=!!this.style.map.terrain,A=this.style.projection,R=d?wa.projectionMercator:A.shaderPreludeCode,F=d?zn:A.shaderDefine,V=t+(o?o.cacheKey:"")+`/${d?Oa:A.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(S?"/terrain":"")+(x?`/${x.join("/")}`:"");return this.cache[V]||(this.cache[V]=new Za(this.context,wa[t],o,wu[t],this._showOverdrawInspector,S,R,F,x)),this.cache[V]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){var t,o;if(this._tileTextures){for(const d in this._tileTextures){const x=this._tileTextures[d];if(x)for(const S of x)S.destroy()}this._tileTextures={}}if(this.tileExtentBuffer&&this.tileExtentBuffer.destroy(),this.debugBuffer&&this.debugBuffer.destroy(),this.rasterBoundsBuffer&&this.rasterBoundsBuffer.destroy(),this.rasterBoundsBufferPosOnly&&this.rasterBoundsBufferPosOnly.destroy(),this.viewportBuffer&&this.viewportBuffer.destroy(),this.tileBorderIndexBuffer&&this.tileBorderIndexBuffer.destroy(),this.quadTriangleIndexBuffer&&this.quadTriangleIndexBuffer.destroy(),this.tileExtentMesh&&((t=this.tileExtentMesh.vertexBuffer)===null||t===void 0||t.destroy()),this.tileExtentMesh&&((o=this.tileExtentMesh.indexBuffer)===null||o===void 0||o.destroy()),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.cache){for(const d in this.cache){const x=this.cache[d];x&&x.program&&this.context.gl.deleteProgram(x.program)}this.cache={}}this.context&&this.context.setDefault()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:o}=this.context.gl;return this.width!==t||this.height!==o}}function Kh(w,t){let o,d=!1,x=null,S=null;const A=()=>{x=null,d&&(w.apply(S,o),x=setTimeout(A,t),d=!1)};return(...R)=>(d=!0,S=this,o=R,x||A(),x)}class Na{constructor(t){this._getCurrentHash=()=>{const o=window.location.hash.replace("#","");if(this._hashName){let d;return o.split("&").map((x=>x.split("="))).forEach((x=>{x[0]===this._hashName&&(d=x)})),(d&&d[1]||"").split("/")}return o.split("/")},this._onHashChange=()=>{const o=this._getCurrentHash();if(!this._isValidHash(o))return!1;const d=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(o[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+o[2],+o[1]],zoom:+o[0],bearing:d,pitch:+(o[4]||0)}),!0},this._updateHashUnthrottled=()=>{const o=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,o)},this._removeHash=()=>{const o=this._getCurrentHash();if(o.length===0)return;const d=o.join("/");let x=d;x.split("&").length>0&&(x=x.split("&")[0]),this._hashName&&(x=`${this._hashName}=${d}`);let S=window.location.hash.replace(x,"");S.startsWith("#&")?S=S.slice(0,1)+S.slice(2):S==="#"&&(S="");let A=window.location.href.replace(/(#.+)?$/,S);A=A.replace("&&","&"),window.history.replaceState(window.history.state,null,A)},this._updateHash=Kh(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(t){const o=this._map.getCenter(),d=Math.round(100*this._map.getZoom())/100,x=Math.ceil((d*Math.LN2+Math.log(512/360/.5))/Math.LN10),S=Math.pow(10,x),A=Math.round(o.lng*S)/S,R=Math.round(o.lat*S)/S,F=this._map.getBearing(),V=this._map.getPitch();let q="";if(q+=t?`/${A}/${R}/${d}`:`${d}/${R}/${A}`,(F||V)&&(q+="/"+Math.round(10*F)/10),V&&(q+=`/${Math.round(V)}`),this._hashName){const te=this._hashName;let Q=!1;const ce=window.location.hash.slice(1).split("&").map((_e=>{const Ie=_e.split("=")[0];return Ie===te?(Q=!0,`${Ie}=${q}`):_e})).filter((_e=>_e));return Q||ce.push(`${te}=${q}`),`#${ce.join("&")}`}return`#${q}`}_isValidHash(t){if(t.length<3||t.some(isNaN))return!1;try{new s.V(+t[2],+t[1])}catch{return!1}const o=+t[0],d=+(t[3]||0),x=+(t[4]||0);return o>=this._map.getMinZoom()&&o<=this._map.getMaxZoom()&&d>=-180&&d<=180&&x>=this._map.getMinPitch()&&x<=this._map.getMaxPitch()}}const Ns={linearity:.3,easing:s.cw(0,0,.3,1)},pc=s.e({deceleration:2500,maxSpeed:1400},Ns),Oi=s.e({deceleration:20,maxSpeed:1400},Ns),Ss=s.e({deceleration:1e3,maxSpeed:360},Ns),Bl=s.e({deceleration:1e3,maxSpeed:90},Ns),ki=s.e({deceleration:1e3,maxSpeed:360},Ns);class Ff{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:z(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,o=z();for(;t.length>0&&o-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const o={zoom:0,bearing:0,pitch:0,roll:0,pan:new s.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:S}of this._inertiaBuffer)o.zoom+=S.zoomDelta||0,o.bearing+=S.bearingDelta||0,o.pitch+=S.pitchDelta||0,o.roll+=S.rollDelta||0,S.panDelta&&o.pan._add(S.panDelta),S.around&&(o.around=S.around),S.pinchAround&&(o.pinchAround=S.pinchAround);const d=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,x={};if(o.pan.mag()){const S=Au(o.pan.mag(),d,s.e({},pc,t||{})),A=o.pan.mult(S.amount/o.pan.mag()),R=this._map.cameraHelper.handlePanInertia(A,this._map.transform);x.center=R.easingCenter,x.offset=R.easingOffset,qc(x,S)}if(o.zoom){const S=Au(o.zoom,d,Oi);x.zoom=this._map.transform.zoom+S.amount,qc(x,S)}if(o.bearing){const S=Au(o.bearing,d,Ss);x.bearing=this._map.transform.bearing+s.an(S.amount,-179,179),qc(x,S)}if(o.pitch){const S=Au(o.pitch,d,Bl);x.pitch=this._map.transform.pitch+S.amount,qc(x,S)}if(o.roll){const S=Au(o.roll,d,ki);x.roll=this._map.transform.roll+s.an(S.amount,-179,179),qc(x,S)}if(x.zoom||x.bearing){const S=o.pinchAround===void 0?o.around:o.pinchAround;x.around=S?this._map.unproject(S):this._map.getCenter()}return this.clear(),s.e(x,{noMoveStart:!0})}}function qc(w,t){(!w.duration||w.duration<t.duration)&&(w.duration=t.duration,w.easing=t.easing)}function Au(w,t,o){const{maxSpeed:d,linearity:x,deceleration:S}=o,A=s.an(w*x/(t/1e3),-d,d),R=Math.abs(A)/(S*x);return{easing:o.easing,duration:1e3*R,amount:A*(R/2)}}class Ci extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,o,d,x={}){d=d instanceof MouseEvent?d:new MouseEvent(t,d);const S=N.mousePos(o.getCanvas(),d),A=o.unproject(S);super(t,s.e({point:S,lngLat:A,originalEvent:d},x)),this._defaultPrevented=!1,this.target=o}}class il extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,o,d){const x=t==="touchend"?d.changedTouches:d.touches,S=N.touchPos(o.getCanvasContainer(),x),A=S.map((F=>o.unproject(F))),R=S.reduce(((F,V,q,te)=>F.add(V.div(te.length))),new s.P(0,0));super(t,{points:S,point:R,lngLats:A,lngLat:o.unproject(R),originalEvent:d}),this._defaultPrevented=!1}}class Lf extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,o,d){super(t,{originalEvent:d}),this._defaultPrevented=!1}}class zf{constructor(t,o){this._map=t,this._clickTolerance=o.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new Lf(t.type,this._map,t))}mousedown(t,o){return this._mousedownPos=o,this._firePreventable(new Ci(t.type,this._map,t))}mouseup(t){this._map.fire(new Ci(t.type,this._map,t))}click(t,o){this._mousedownPos&&this._mousedownPos.dist(o)>=this._clickTolerance||this._map.fire(new Ci(t.type,this._map,t))}dblclick(t){return this._firePreventable(new Ci(t.type,this._map,t))}mouseover(t){this._map.fire(new Ci(t.type,this._map,t))}mouseout(t){this._map.fire(new Ci(t.type,this._map,t))}touchstart(t){return this._firePreventable(new il(t.type,this._map,t))}touchmove(t){this._map.fire(new il(t.type,this._map,t))}touchend(t){this._map.fire(new il(t.type,this._map,t))}touchcancel(t){this._map.fire(new il(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Fp{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new Ci(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ci("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new Ci(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class sl{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.screenPointToLocation(s.P.convert(t),this._map.terrain)}}class Zc{constructor(t,o){this._map=t,this._tr=new sl(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=o.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,o){this.isEnabled()&&t.shiftKey&&t.button===0&&(N.disableDrag(),this._startPos=this._lastPos=o,this._active=!0)}mousemoveWindow(t,o){if(!this._active)return;const d=o;if(this._lastPos.equals(d)||!this._box&&d.dist(this._startPos)<this._clickTolerance)return;const x=this._startPos;this._lastPos=d,this._box||(this._box=N.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const S=Math.min(x.x,d.x),A=Math.max(x.x,d.x),R=Math.min(x.y,d.y),F=Math.max(x.y,d.y);N.setTransform(this._box,`translate(${S}px,${R}px)`),this._box.style.width=A-S+"px",this._box.style.height=F-R+"px"}mouseupWindow(t,o){if(!this._active||t.button!==0)return;const d=this._startPos,x=o;if(this.reset(),N.suppressClick(),d.x!==x.x||d.y!==x.y)return this._map.fire(new s.l("boxzoomend",{originalEvent:t})),{cameraAnimation:S=>S.fitScreenCoordinates(d,x,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(N.remove(this._box),this._box=null),N.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,o){return this._map.fire(new s.l(t,{originalEvent:o}))}}function js(w,t){if(w.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${w.length}, points ${t.length}`);const o={};for(let d=0;d<w.length;d++)o[w[d].identifier]=t[d];return o}class kr{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,o,d){(this.centroid||d.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),d.length===this.numTouches&&(this.centroid=(function(x){const S=new s.P(0,0);for(const A of x)S._add(A);return S.div(x.length)})(o),this.touches=js(d,o)))}touchmove(t,o,d){if(this.aborted||!this.centroid)return;const x=js(d,o);for(const S in this.touches){const A=x[S];(!A||A.dist(this.touches[S])>30)&&(this.aborted=!0)}}touchend(t,o,d){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),d.length===0){const x=!this.aborted&&this.centroid;if(this.reset(),x)return x}}}class Jh{constructor(t){this.singleTap=new kr(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,o,d){this.singleTap.touchstart(t,o,d)}touchmove(t,o,d){this.singleTap.touchmove(t,o,d)}touchend(t,o,d){const x=this.singleTap.touchend(t,o,d);if(x){const S=t.timeStamp-this.lastTime<500,A=!this.lastTap||this.lastTap.dist(x)<30;if(S&&A||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=x,this.count===this.numTaps)return this.reset(),x}}}class Of{constructor(t){this._tr=new sl(t),this._zoomIn=new Jh({numTouches:1,numTaps:2}),this._zoomOut=new Jh({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,o,d){this._zoomIn.touchstart(t,o,d),this._zoomOut.touchstart(t,o,d)}touchmove(t,o,d){this._zoomIn.touchmove(t,o,d),this._zoomOut.touchmove(t,o,d)}touchend(t,o,d){const x=this._zoomIn.touchend(t,o,d),S=this._zoomOut.touchend(t,o,d),A=this._tr;return x?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:R=>R.easeTo({duration:300,zoom:A.zoom+1,around:A.unproject(x)},{originalEvent:t})}):S?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:R=>R.easeTo({duration:300,zoom:A.zoom-1,around:A.unproject(S)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ko{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const o=this._moveFunction(...t);if(o.bearingDelta||o.pitchDelta||o.rollDelta||o.around||o.panDelta)return this._active=!0,o}dragStart(t,o){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=Array.isArray(o)?o[0]:o,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,o){if(!this.isEnabled())return;const d=this._lastPoint;if(!d)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const x=Array.isArray(o)?o[0]:o;return!this._moved&&x.dist(d)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=x,this._move(d,x))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&N.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const ol=0,_h=2,Bf={[ol]:1,[_h]:2};class Nl{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const o=N.mouseButton(t);this._eventButton=o}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!(function(o,d){const x=Bf[d];return o.buttons===void 0||(o.buttons&x)!==x})(t,this._eventButton)}isValidEndEvent(t){return N.mouseButton(t)===this._eventButton}}class ku{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return t.targetTouches.length===1}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}class Qh{constructor(t=new Nl({checkCorrectEvent:()=>!0}),o=new ku){this.mouseMoveStateManager=t,this.oneFingerTouchMoveStateManager=o}_executeRelevantHandler(t,o,d){return t instanceof MouseEvent?o(t):typeof TouchEvent<"u"&&t instanceof TouchEvent?d(t):void 0}startMove(t){this._executeRelevantHandler(t,(o=>this.mouseMoveStateManager.startMove(o)),(o=>this.oneFingerTouchMoveStateManager.startMove(o)))}endMove(t){this._executeRelevantHandler(t,(o=>this.mouseMoveStateManager.endMove(o)),(o=>this.oneFingerTouchMoveStateManager.endMove(o)))}isValidStartEvent(t){return this._executeRelevantHandler(t,(o=>this.mouseMoveStateManager.isValidStartEvent(o)),(o=>this.oneFingerTouchMoveStateManager.isValidStartEvent(o)))}isValidMoveEvent(t){return this._executeRelevantHandler(t,(o=>this.mouseMoveStateManager.isValidMoveEvent(o)),(o=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(o)))}isValidEndEvent(t){return this._executeRelevantHandler(t,(o=>this.mouseMoveStateManager.isValidEndEvent(o)),(o=>this.oneFingerTouchMoveStateManager.isValidEndEvent(o)))}}const jl=w=>{w.mousedown=w.dragStart,w.mousemoveWindow=w.dragMove,w.mouseup=w.dragEnd,w.contextmenu=t=>{t.preventDefault()}};class Nf{constructor(t,o){this._clickTolerance=t.clickTolerance||1,this._map=o,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new s.P(0,0)}_shouldBePrevented(t){return t<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(t,o,d){return this._calculateTransform(t,o,d)}touchmove(t,o,d){if(this._active){if(!this._shouldBePrevented(d.length))return t.preventDefault(),this._calculateTransform(t,o,d);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",t)}}touchend(t,o,d){this._calculateTransform(t,o,d),this._active&&this._shouldBePrevented(d.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,o,d){d.length>0&&(this._active=!0);const x=js(d,o),S=new s.P(0,0),A=new s.P(0,0);let R=0;for(const V in x){const q=x[V],te=this._touches[V];te&&(S._add(q),A._add(q.sub(te)),R++,x[V]=q)}if(this._touches=x,this._shouldBePrevented(R)||!A.mag())return;const F=A.div(R);return this._sum._add(F),this._sum.mag()<this._clickTolerance?void 0:{around:S.div(R),panDelta:F}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ef{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,o,d){this._firstTwoTouches||d.length<2||(this._firstTwoTouches=[d[0].identifier,d[1].identifier],this._start([o[0],o[1]]))}touchmove(t,o,d){if(!this._firstTwoTouches)return;t.preventDefault();const[x,S]=this._firstTwoTouches,A=Ul(d,o,x),R=Ul(d,o,S);if(!A||!R)return;const F=this._aroundCenter?null:A.add(R).div(2);return this._move([A,R],F,t)}touchend(t,o,d){if(!this._firstTwoTouches)return;const[x,S]=this._firstTwoTouches,A=Ul(d,o,x),R=Ul(d,o,S);A&&R||(this._active&&N.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Ul(w,t,o){for(let d=0;d<w.length;d++)if(w[d].identifier===o)return t[d]}function Ad(w,t){return Math.log(w/t)/Math.LN2}class Vl extends ef{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,o){const d=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Ad(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ad(this._distance,d),pinchAround:o}}}function jf(w,t){return 180*w.angleWith(t)/Math.PI}class tf extends ef{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,o,d){const x=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:jf(this._vector,x),pinchAround:o}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const o=25/(Math.PI*this._minDiameter)*360,d=jf(t,this._startVector);return Math.abs(d)<o}}function Gl(w){return Math.abs(w.y)>Math.abs(w.x)}class mc extends ef{constructor(t){super(),this._currentTouchCount=0,this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,o,d){super.touchstart(t,o,d),this._currentTouchCount=d.length}_start(t){this._lastPoints=t,Gl(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,o,d){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const x=t[0].sub(this._lastPoints[0]),S=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(x,S,d.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(x.y+S.y)/2*-.5}):void 0}gestureBeginsVertically(t,o,d){if(this._valid!==void 0)return this._valid;const x=t.mag()>=2,S=o.mag()>=2;if(!x&&!S)return;if(!x||!S)return this._firstMove===void 0&&(this._firstMove=d),d-this._firstMove<100&&void 0;const A=t.y>0==o.y>0;return Gl(t)&&Gl(o)&&A}}const Co={panStep:100,bearingStep:15,pitchStep:10};class Jn{constructor(t){this._tr=new sl(t);const o=Co;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let o=0,d=0,x=0,S=0,A=0;switch(t.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:t.shiftKey?d=-1:(t.preventDefault(),S=-1);break;case 39:t.shiftKey?d=1:(t.preventDefault(),S=1);break;case 38:t.shiftKey?x=1:(t.preventDefault(),A=-1);break;case 40:t.shiftKey?x=-1:(t.preventDefault(),A=1);break;default:return}return this._rotationDisabled&&(d=0,x=0),{cameraAnimation:R=>{const F=this._tr;R.easeTo({duration:300,easeId:"keyboardHandler",easing:kd,zoom:o?Math.round(F.zoom)+o*(t.shiftKey?2:1):F.zoom,bearing:F.bearing+d*this._bearingStep,pitch:F.pitch+x*this._pitchStep,offset:[-S*this._panStep,-A*this._panStep],center:F.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function kd(w){return w*(2-w)}const gc=4.000244140625,Wc=1/450;class rf{constructor(t,o){this._onTimeout=d=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(d)},this._map=t,this._tr=new sl(t),this._triggerRenderFrame=o,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Wc}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(t){return!!this._map.cooperativeGestures.isEnabled()&&!(t.ctrlKey||this._map.cooperativeGestures.isBypassed(t))}wheel(t){if(!this.isEnabled())return;if(this._shouldBePrevented(t))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",t);let o=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const d=z(),x=d-(this._lastWheelEventTime||0);this._lastWheelEventTime=d,o!==0&&o%gc==0?this._type="wheel":o!==0&&Math.abs(o)<4?this._type="trackpad":x>400?(this._type=null,this._lastValue=o,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(x*o)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,o+=this._lastValue)),t.shiftKey&&o&&(o/=4),this._type&&(this._lastWheelEvent=t,this._delta-=o,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const o=N.mousePos(this._map.getCanvas(),t),d=this._tr;this._aroundPoint=this._aroundCenter?d.transform.locationToScreenPoint(s.V.convert(d.center)):o,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const R=t.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=R),typeof this._targetZoom=="number"&&(this._targetZoom+=R)}if(this._delta!==0){const R=this._type==="wheel"&&Math.abs(this._delta)>gc?this._wheelZoomRate:this._defaultZoomRate;let F=2/(1+Math.exp(-Math.abs(this._delta*R)));this._delta<0&&F!==0&&(F=1/F);const V=typeof this._targetZoom!="number"?t.scale:s.aq(this._targetZoom);this._targetZoom=t.applyConstrain(t.getCameraLngLat(),s.at(V*F)).zoom,this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const o=typeof this._targetZoom!="number"?t.zoom:this._targetZoom,d=this._startZoom,x=this._easing;let S,A=!1;if(this._type==="wheel"&&d&&x){const R=z()-this._lastWheelEventTime,F=Math.min((R+5)/200,1),V=x(F);S=s.G.number(d,o,V),F<1?this._frameId||(this._frameId=!0):A=!0}else S=o,A=!0;return this._active=!0,A&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout}),200)),this._lastExpectedZoom=S,{noInertia:!0,needsRenderFrame:!A,zoomDelta:S-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let o=s.cy;if(this._prevEase){const d=this._prevEase,x=(z()-d.start)/d.duration,S=d.easing(x+.01)-d.easing(x),A=.27/Math.sqrt(S*S+1e-4)*.01,R=Math.sqrt(.0729-A*A);o=s.cw(A,R,.25,1)}return this._prevEase={start:z(),duration:t,easing:o},o}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Uf{constructor(t,o){this._clickZoom=t,this._tapZoom=o}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Cu{constructor(t){this._tr=new sl(t),this.reset()}reset(){this._active=!1}dblclick(t,o){return t.preventDefault(),{cameraAnimation:d=>{d.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(o)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class nf{constructor(){this._tap=new Jh({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,o,d){if(!this._swipePoint)if(this._tapTime){const x=o[0],S=t.timeStamp-this._tapTime<500,A=this._tapPoint.dist(x)<30;S&&A?d.length>0&&(this._swipePoint=x,this._swipeTouch=d[0].identifier):this.reset()}else this._tap.touchstart(t,o,d)}touchmove(t,o,d){if(this._tapTime){if(this._swipePoint){if(d[0].identifier!==this._swipeTouch)return;const x=o[0],S=x.y-this._swipePoint.y;return this._swipePoint=x,t.preventDefault(),this._active=!0,{zoomDelta:S/128}}}else this._tap.touchmove(t,o,d)}touchend(t,o,d){if(this._tapTime)this._swipePoint&&d.length===0&&this.reset();else{const x=this._tap.touchend(t,o,d);x&&(this._tapTime=t.timeStamp,this._tapPoint=x)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Cd{constructor(t,o,d){this._el=t,this._mousePan=o,this._touchPan=d}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class oo{constructor(t,o,d,x){this._pitchWithRotate=t.pitchWithRotate,this._rollEnabled=t.rollEnabled,this._mouseRotate=o,this._mousePitch=d,this._mouseRoll=x}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Mu{constructor(t,o,d,x){this._el=t,this._touchZoom=o,this._touchRotate=d,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Rr{constructor(t,o){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=t,this._options=o,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const t=this._map.getCanvasContainer();t.classList.add("maplibregl-cooperative-gestures"),this._container=N.create("div","maplibregl-cooperative-gesture-screen",t);let o=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(o=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const d=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),x=document.createElement("div");x.className="maplibregl-desktop-message",x.textContent=o,this._container.appendChild(x);const S=document.createElement("div");S.className="maplibregl-mobile-message",S.textContent=d,this._container.appendChild(S),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(N.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(t){return t[this._bypassKey]}notifyGestureBlocked(t,o){this._enabled&&(this._map.fire(new s.l("cooperativegestureprevented",{gestureType:t,originalEvent:o})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const Br=w=>w.zoom||w.drag||w.roll||w.pitch||w.rotate;class Mo extends s.l{}function xh(w){return w.panDelta&&w.panDelta.mag()||w.zoomDelta||w.bearingDelta||w.pitchDelta||w.rollDelta}class af{constructor(t,o){this.handleWindowEvent=x=>{this.handleEvent(x,`${x.type}Window`)},this.handleEvent=(x,S)=>{if(x.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const A=x.type==="renderFrame"?void 0:x,R={needsRenderFrame:!1},F={},V={};for(const{handlerName:Q,handler:ce,allowed:_e}of this._handlers){if(!ce.isEnabled())continue;let Ie;if(this._blockedByActive(V,_e,Q))ce.reset();else if(ce[S||x.type]){if(s.cz(x,S||x.type)){const Oe=N.mousePos(this._map.getCanvas(),x);Ie=ce[S||x.type](x,Oe)}else if(s.cA(x,S||x.type)){const Oe=this._getMapTouches(x.touches),Le=N.touchPos(this._map.getCanvas(),Oe);Ie=ce[S||x.type](x,Le,Oe)}else s.cB(S||x.type)||(Ie=ce[S||x.type](x));this.mergeHandlerResult(R,F,Ie,Q,A),Ie&&Ie.needsRenderFrame&&this._triggerRenderFrame()}(Ie||ce.isActive())&&(V[Q]=ce)}const q={};for(const Q in this._previousActiveHandlers)V[Q]||(q[Q]=A);this._previousActiveHandlers=V,(Object.keys(q).length||xh(R))&&(this._changes.push([R,F,q]),this._triggerRenderFrame()),(Object.keys(V).length||xh(R))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:te}=R;te&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],te(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ff(t),this._bearingSnap=o.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(o);const d=this._el;this._listeners=[[d,"touchstart",{passive:!0}],[d,"touchmove",{passive:!1}],[d,"touchend",void 0],[d,"touchcancel",void 0],[d,"mousedown",void 0],[d,"mousemove",void 0],[d,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[d,"mouseover",void 0],[d,"mouseout",void 0],[d,"dblclick",void 0],[d,"click",void 0],[d,"keydown",{capture:!1}],[d,"keyup",void 0],[d,"wheel",{passive:!1}],[d,"contextmenu",void 0],[window,"blur",void 0]];for(const[x,S,A]of this._listeners)N.addEventListener(x,S,x===document?this.handleWindowEvent:this.handleEvent,A)}destroy(){for(const[t,o,d]of this._listeners)N.removeEventListener(t,o,t===document?this.handleWindowEvent:this.handleEvent,d)}_addDefaultHandlers(t){const o=this._map,d=o.getCanvasContainer();this._add("mapEvent",new zf(o,t));const x=o.boxZoom=new Zc(o,t);this._add("boxZoom",x),t.interactive&&t.boxZoom&&x.enable();const S=o.cooperativeGestures=new Rr(o,t.cooperativeGestures);this._add("cooperativeGestures",S),t.cooperativeGestures&&S.enable();const A=new Of(o),R=new Cu(o);o.doubleClickZoom=new Uf(R,A),this._add("tapZoom",A),this._add("clickZoom",R),t.interactive&&t.doubleClickZoom&&o.doubleClickZoom.enable();const F=new nf;this._add("tapDragZoom",F);const V=o.touchPitch=new mc(o);this._add("touchPitch",V),t.interactive&&t.touchPitch&&o.touchPitch.enable(t.touchPitch);const q=()=>o.project(o.getCenter()),te=(function({enable:He,clickTolerance:rt,aroundCenter:ot=!0,minPixelCenterThreshold:Xe=100,rotateDegreesPerPixelMoved:ft=.8},Pt){const Et=new Nl({checkCorrectEvent:Ct=>N.mouseButton(Ct)===0&&Ct.ctrlKey||N.mouseButton(Ct)===2&&!Ct.ctrlKey});return new ko({clickTolerance:rt,move:(Ct,Dt)=>{const ur=Pt();if(ot&&Math.abs(ur.y-Ct.y)>Xe)return{bearingDelta:s.cx(new s.P(Ct.x,Dt.y),Dt,ur)};let fr=(Dt.x-Ct.x)*ft;return ot&&Dt.y<ur.y&&(fr=-fr),{bearingDelta:fr}},moveStateManager:Et,enable:He,assignEvents:jl})})(t,q),Q=(function({enable:He,clickTolerance:rt,pitchDegreesPerPixelMoved:ot=-.5}){const Xe=new Nl({checkCorrectEvent:ft=>N.mouseButton(ft)===0&&ft.ctrlKey||N.mouseButton(ft)===2});return new ko({clickTolerance:rt,move:(ft,Pt)=>({pitchDelta:(Pt.y-ft.y)*ot}),moveStateManager:Xe,enable:He,assignEvents:jl})})(t),ce=(function({enable:He,clickTolerance:rt,rollDegreesPerPixelMoved:ot=.3},Xe){const ft=new Nl({checkCorrectEvent:Pt=>N.mouseButton(Pt)===2&&Pt.ctrlKey});return new ko({clickTolerance:rt,move:(Pt,Et)=>{const Ct=Xe();let Dt=(Et.x-Pt.x)*ot;return Et.y<Ct.y&&(Dt=-Dt),{rollDelta:Dt}},moveStateManager:ft,enable:He,assignEvents:jl})})(t,q);o.dragRotate=new oo(t,te,Q,ce),this._add("mouseRotate",te,["mousePitch"]),this._add("mousePitch",Q,["mouseRotate","mouseRoll"]),this._add("mouseRoll",ce,["mousePitch"]),t.interactive&&t.dragRotate&&o.dragRotate.enable();const _e=(function({enable:He,clickTolerance:rt}){const ot=new Nl({checkCorrectEvent:Xe=>N.mouseButton(Xe)===0&&!Xe.ctrlKey});return new ko({clickTolerance:rt,move:(Xe,ft)=>({around:ft,panDelta:ft.sub(Xe)}),activateOnStart:!0,moveStateManager:ot,enable:He,assignEvents:jl})})(t),Ie=new Nf(t,o);o.dragPan=new Cd(d,_e,Ie),this._add("mousePan",_e),this._add("touchPan",Ie,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&o.dragPan.enable(t.dragPan);const Oe=new tf,Le=new Vl;o.touchZoomRotate=new Mu(d,Le,Oe,F),this._add("touchRotate",Oe,["touchPan","touchZoom"]),this._add("touchZoom",Le,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&o.touchZoomRotate.enable(t.touchZoomRotate),this._add("blockableMapEvent",new Fp(o));const qe=o.scrollZoom=new rf(o,(()=>this._triggerRenderFrame()));this._add("scrollZoom",qe,["mousePan"]),t.interactive&&t.scrollZoom&&o.scrollZoom.enable(t.scrollZoom);const nt=o.keyboard=new Jn(o);this._add("keyboard",nt),t.interactive&&t.keyboard&&o.keyboard.enable()}_add(t,o,d){this._handlers.push({handlerName:t,handler:o,allowed:d}),this._handlersById[t]=o}stop(t){if(!this._updatingCamera){for(const{handler:o}of this._handlers)o.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Br(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,o,d){for(const x in t)if(x!==d&&(!o||o.indexOf(x)<0))return!0;return!1}_getMapTouches(t){const o=[];for(const d of t)this._el.contains(d.target)&&o.push(d);return o}mergeHandlerResult(t,o,d,x,S){if(!d)return;s.e(t,d);const A={handlerName:x,originalEvent:d.originalEvent||S};d.zoomDelta!==void 0&&(o.zoom=A),d.panDelta!==void 0&&(o.drag=A),d.rollDelta!==void 0&&(o.roll=A),d.pitchDelta!==void 0&&(o.pitch=A),d.bearingDelta!==void 0&&(o.rotate=A)}_applyChanges(){const t={},o={},d={};for(const[x,S,A]of this._changes)x.panDelta&&(t.panDelta=(t.panDelta||new s.P(0,0))._add(x.panDelta)),x.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+x.zoomDelta),x.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+x.bearingDelta),x.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+x.pitchDelta),x.rollDelta&&(t.rollDelta=(t.rollDelta||0)+x.rollDelta),x.around!==void 0&&(t.around=x.around),x.pinchAround!==void 0&&(t.pinchAround=x.pinchAround),x.noInertia&&(t.noInertia=x.noInertia),s.e(o,S),s.e(d,A);this._updateMapTransform(t,o,d),this._changes=[]}_updateMapTransform(t,o,d){const x=this._map,S=x._getTransformForUpdate(),A=x.terrain;if(!(xh(t)||A&&this._terrainMovement))return this._fireEvents(o,d,!0);x._stop(!0);let{panDelta:R,zoomDelta:F,bearingDelta:V,pitchDelta:q,rollDelta:te,around:Q,pinchAround:ce}=t;ce!==void 0&&(Q=ce),Q=Q||x.transform.centerPoint,A&&!S.isPointOnMapSurface(Q)&&(Q=S.centerPoint);const _e={panDelta:R,zoomDelta:F,rollDelta:te,pitchDelta:q,bearingDelta:V,around:Q};this._map.cameraHelper.useGlobeControls&&!S.isPointOnMapSurface(Q)&&(Q=S.centerPoint);const Ie=Q.distSqr(S.centerPoint)<.01?S.center:S.screenPointToLocation(R?Q.sub(R):Q);this._handleMapControls({terrain:A,tr:S,deltasForHelper:_e,preZoomAroundLoc:Ie,combinedEventsInProgress:o,panDelta:R}),x._applyUpdatedTransform(S),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(o,d,!0)}_handleMapControls({terrain:t,tr:o,deltasForHelper:d,preZoomAroundLoc:x,combinedEventsInProgress:S,panDelta:A}){const R=this._map.cameraHelper;if(R.handleMapControlsRollPitchBearingZoom(d,o),t)return R.useGlobeControls?(this._terrainMovement||!S.drag&&!S.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void R.handleMapControlsPan(d,o,x)):this._terrainMovement||!S.drag&&!S.zoom?void(S.drag&&this._terrainMovement&&A?o.setCenter(o.screenPointToLocation(o.centerPoint.sub(A))):R.handleMapControlsPan(d,o,x)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void R.handleMapControlsPan(d,o,x));R.handleMapControlsPan(d,o,x)}_fireEvents(t,o,d){const x=Br(this._eventsInProgress),S=Br(t),A={};for(const te in t){const{originalEvent:Q}=t[te];this._eventsInProgress[te]||(A[`${te}start`]=Q),this._eventsInProgress[te]=t[te]}!x&&S&&this._fireEvent("movestart",S.originalEvent);for(const te in A)this._fireEvent(te,A[te]);S&&this._fireEvent("move",S.originalEvent);for(const te in t){const{originalEvent:Q}=t[te];this._fireEvent(te,Q)}const R={};let F;for(const te in this._eventsInProgress){const{handlerName:Q,originalEvent:ce}=this._eventsInProgress[te];this._handlersById[Q].isActive()||(delete this._eventsInProgress[te],F=o[Q]||ce,R[`${te}end`]=F)}for(const te in R)this._fireEvent(te,R[te]);const V=Br(this._eventsInProgress),q=(x||S)&&!V;if(q&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const te=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&te.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(te)}if(d&&q){this._updatingCamera=!0;const te=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Q=ce=>ce!==0&&-this._bearingSnap<ce&&ce<this._bearingSnap;!te||!te.essential&&j.prefersReducedMotion?(this._map.fire(new s.l("moveend",{originalEvent:F})),Q(this._map.getBearing())&&this._map.resetNorth()):(Q(te.bearing||this._map.getBearing())&&(te.bearing=0),te.freezeElevation=!0,this._map.easeTo(te,{originalEvent:F})),this._updatingCamera=!1}}_fireEvent(t,o){this._map.fire(new s.l(t,o?{originalEvent:o}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((t=>{delete this._frameId,this.handleEvent(new Mo("renderFrame",{timeStamp:t})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class ni extends s.E{constructor(t,o,d){super(),this._renderFrameCallback=()=>{const x=Math.min((z()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(x)),x<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=d.bearingSnap,this.cameraHelper=o,this.on("moveend",(()=>{delete this._requestedCameraState}))}migrateProjection(t,o){t.apply(this.transform),this.transform=t,this.cameraHelper=o}getCenter(){return new s.V(this.transform.center.lng,this.transform.center.lat)}setCenter(t,o){return this.jumpTo({center:t},o)}getCenterElevation(){return this.transform.elevation}setCenterElevation(t,o){return this.jumpTo({elevation:t},o),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(t){this._centerClampedToGround=t}panBy(t,o,d){return t=s.P.convert(t).mult(-1),this.panTo(this.transform.center,s.e({offset:t},o),d)}panTo(t,o,d){return this.easeTo(s.e({center:t},o),d)}getZoom(){return this.transform.zoom}setZoom(t,o){return this.jumpTo({zoom:t},o),this}zoomTo(t,o,d){return this.easeTo(s.e({zoom:t},o),d)}zoomIn(t,o){return this.zoomTo(this.getZoom()+1,t,o),this}zoomOut(t,o){return this.zoomTo(this.getZoom()-1,t,o),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(t,o){return t!=this.transform.fov&&(this.transform.setFov(t),this.fire(new s.l("movestart",o)).fire(new s.l("move",o)).fire(new s.l("moveend",o))),this}getBearing(){return this.transform.bearing}setBearing(t,o){return this.jumpTo({bearing:t},o),this}getPadding(){return this.transform.padding}setPadding(t,o){return this.jumpTo({padding:t},o),this}rotateTo(t,o,d){return this.easeTo(s.e({bearing:t},o),d)}resetNorth(t,o){return this.rotateTo(0,s.e({duration:1e3},t),o),this}resetNorthPitch(t,o){return this.easeTo(s.e({bearing:0,pitch:0,roll:0,duration:1e3},t),o),this}snapToNorth(t,o){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,o):this}getPitch(){return this.transform.pitch}setPitch(t,o){return this.jumpTo({pitch:t},o),this}getRoll(){return this.transform.roll}setRoll(t,o){return this.jumpTo({roll:t},o),this}cameraForBounds(t,o){t=Ee.convert(t).adjustAntiMeridian();const d=o&&o.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),d,o)}_cameraForBoxAndBearing(t,o,d,x){const S={top:0,bottom:0,right:0,left:0};if(typeof(x=s.e({padding:S,offset:[0,0],maxZoom:this.transform.maxZoom},x)).padding=="number"){const V=x.padding;x.padding={top:V,bottom:V,right:V,left:V}}const A=s.e(S,x.padding);x.padding=A;const R=this.transform,F=new Ee(t,o);return this.cameraHelper.cameraForBoxAndBearing(x,A,F,d,R)}fitBounds(t,o,d){return this._fitInternal(this.cameraForBounds(t,o),o,d)}fitScreenCoordinates(t,o,d,x,S){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(s.P.convert(t)),this.transform.screenPointToLocation(s.P.convert(o)),d,x),x,S)}_fitInternal(t,o,d){return t?(delete(o=s.e(t,o)).padding,o.linear?this.easeTo(o,d):this.flyTo(o,d)):this}jumpTo(t,o){this.stop();const d=this._getTransformForUpdate();let x=!1,S=!1,A=!1;const R=d.zoom;this.cameraHelper.handleJumpToCenterZoom(d,t);const F=d.zoom!==R;return"elevation"in t&&d.elevation!==+t.elevation&&d.setElevation(+t.elevation),"bearing"in t&&d.bearing!==+t.bearing&&(x=!0,d.setBearing(+t.bearing)),"pitch"in t&&d.pitch!==+t.pitch&&(S=!0,d.setPitch(+t.pitch)),"roll"in t&&d.roll!==+t.roll&&(A=!0,d.setRoll(+t.roll)),t.padding==null||d.isPaddingEqual(t.padding)||d.setPadding(t.padding),this._applyUpdatedTransform(d),this.fire(new s.l("movestart",o)).fire(new s.l("move",o)),F&&this.fire(new s.l("zoomstart",o)).fire(new s.l("zoom",o)).fire(new s.l("zoomend",o)),x&&this.fire(new s.l("rotatestart",o)).fire(new s.l("rotate",o)).fire(new s.l("rotateend",o)),S&&this.fire(new s.l("pitchstart",o)).fire(new s.l("pitch",o)).fire(new s.l("pitchend",o)),A&&this.fire(new s.l("rollstart",o)).fire(new s.l("roll",o)).fire(new s.l("rollend",o)),this.fire(new s.l("moveend",o))}calculateCameraOptionsFromTo(t,o,d,x=0){const S=s.a9.fromLngLat(t,o),A=s.a9.fromLngLat(d,x),R=A.x-S.x,F=A.y-S.y,V=A.z-S.z,q=Math.hypot(R,F,V);if(q===0)throw new Error("Can't calculate camera options with same From and To");const te=Math.hypot(R,F),Q=s.at(this.transform.cameraToCenterDistance/q/this.transform.tileSize),ce=180*Math.atan2(R,-F)/Math.PI;let _e=180*Math.acos(te/q)/Math.PI;return _e=V<0?90-_e:90+_e,{center:A.toLngLat(),elevation:x,zoom:Q,pitch:_e,bearing:ce}}calculateCameraOptionsFromCameraLngLatAltRotation(t,o,d,x,S){const A=this.transform.calculateCenterFromCameraLngLatAlt(t,o,d,x);return{center:A.center,elevation:A.elevation,zoom:A.zoom,bearing:d,pitch:x,roll:S}}easeTo(t,o){this._stop(!1,t.easeId),((t=s.e({offset:[0,0],duration:500,easing:s.cy},t)).animate===!1||!t.essential&&j.prefersReducedMotion)&&(t.duration=0);const d=this._getTransformForUpdate(),x=this.getBearing(),S=d.pitch,A=d.roll,R="bearing"in t?this._normalizeBearing(t.bearing,x):x,F="pitch"in t?+t.pitch:S,V="roll"in t?this._normalizeBearing(t.roll,A):A,q="padding"in t?t.padding:d.padding,te=s.P.convert(t.offset);let Q,ce;t.around&&(Q=s.V.convert(t.around),ce=d.locationToScreenPoint(Q));const _e={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},Ie=this.cameraHelper.handleEaseTo(d,{bearing:R,pitch:F,roll:V,padding:q,around:Q,aroundPoint:ce,offsetAsPoint:te,offset:t.offset,zoom:t.zoom,center:t.center});return this._rotating=this._rotating||x!==R,this._pitching=this._pitching||F!==S,this._rolling=this._rolling||V!==A,this._padding=!d.isPaddingEqual(q),this._zooming=this._zooming||Ie.isZooming,this._easeId=t.easeId,this._prepareEase(o,t.noMoveStart,_e),this.terrain&&this._prepareElevation(Ie.elevationCenter),this._ease((Oe=>{Ie.easeFunc(Oe),this.terrain&&!t.freezeElevation&&this._updateElevation(Oe),this._applyUpdatedTransform(d),this._fireMoveEvents(o)}),(Oe=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(o,Oe)}),t),this}_prepareEase(t,o,d={}){this._moving=!0,o||d.moving||this.fire(new s.l("movestart",t)),this._zooming&&!d.zooming&&this.fire(new s.l("zoomstart",t)),this._rotating&&!d.rotating&&this.fire(new s.l("rotatestart",t)),this._pitching&&!d.pitching&&this.fire(new s.l("pitchstart",t)),this._rolling&&!d.rolling&&this.fire(new s.l("rollstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const o=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&o!==this._elevationTarget){const d=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(d-(o-(d*t+this._elevationStart))/(1-t)),this._elevationTarget=o}this.transform.setElevation(s.G.number(this._elevationStart,this._elevationTarget,t))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(t){if(!this.terrain&&t.elevation>=0&&t.pitch<=90)return{};const o=t.getCameraLngLat(),d=t.getCameraAltitude(),x=this.terrain?this.terrain.getElevationForLngLatZoom(o,t.zoom):0;if(d<x){const S=this.calculateCameraOptionsFromTo(o,x,t.center,t.elevation);return{pitch:S.pitch,zoom:S.zoom}}return{}}_applyUpdatedTransform(t){const o=[];if(o.push((x=>this._elevateCameraIfInsideTerrain(x))),this.transformCameraUpdate&&o.push((x=>this.transformCameraUpdate(x))),!o.length)return;const d=t.clone();for(const x of o){const S=d.clone(),{center:A,zoom:R,roll:F,pitch:V,bearing:q,elevation:te}=x(S);A&&S.setCenter(A),te!==void 0&&S.setElevation(te),R!==void 0&&S.setZoom(R),F!==void 0&&S.setRoll(F),V!==void 0&&S.setPitch(V),q!==void 0&&S.setBearing(q),d.apply(S)}this.transform.apply(d)}_fireMoveEvents(t){this.fire(new s.l("move",t)),this._zooming&&this.fire(new s.l("zoom",t)),this._rotating&&this.fire(new s.l("rotate",t)),this._pitching&&this.fire(new s.l("pitch",t)),this._rolling&&this.fire(new s.l("roll",t))}_afterEase(t,o){if(this._easeId&&o&&this._easeId===o)return;delete this._easeId;const d=this._zooming,x=this._rotating,S=this._pitching,A=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,d&&this.fire(new s.l("zoomend",t)),x&&this.fire(new s.l("rotateend",t)),S&&this.fire(new s.l("pitchend",t)),A&&this.fire(new s.l("rollend",t)),this.fire(new s.l("moveend",t))}flyTo(t,o){if(!t.essential&&j.prefersReducedMotion){const Dt=s.U(t,["center","zoom","bearing","pitch","roll","elevation","padding"]);return this.jumpTo(Dt,o)}this.stop(),t=s.e({offset:[0,0],speed:1.2,curve:1.42,easing:s.cy},t);const d=this._getTransformForUpdate(),x=d.bearing,S=d.pitch,A=d.roll,R=d.padding,F="bearing"in t?this._normalizeBearing(t.bearing,x):x,V="pitch"in t?+t.pitch:S,q="roll"in t?this._normalizeBearing(t.roll,A):A,te="padding"in t?t.padding:d.padding,Q=s.P.convert(t.offset);let ce=d.centerPoint.add(Q);const _e=d.screenPointToLocation(ce),Ie=this.cameraHelper.handleFlyTo(d,{bearing:F,pitch:V,roll:q,padding:te,locationAtOffset:_e,offsetAsPoint:Q,center:t.center,minZoom:t.minZoom,zoom:t.zoom});let Oe=t.curve;const Le=Math.max(d.width,d.height),qe=Le/Ie.scaleOfZoom,nt=Ie.pixelPathLength;typeof Ie.scaleOfMinZoom=="number"&&(Oe=Math.sqrt(Le/Ie.scaleOfMinZoom/nt*2));const He=Oe*Oe;function rt(Dt){const ur=(qe*qe-Le*Le+(Dt?-1:1)*He*He*nt*nt)/(2*(Dt?qe:Le)*He*nt);return Math.log(Math.sqrt(ur*ur+1)-ur)}function ot(Dt){return(Math.exp(Dt)-Math.exp(-Dt))/2}function Xe(Dt){return(Math.exp(Dt)+Math.exp(-Dt))/2}const ft=rt(!1);let Pt=function(Dt){return Xe(ft)/Xe(ft+Oe*Dt)},Et=function(Dt){return Le*((Xe(ft)*(ot(ur=ft+Oe*Dt)/Xe(ur))-ot(ft))/He)/nt;var ur},Ct=(rt(!0)-ft)/Oe;if(Math.abs(nt)<2e-6||!isFinite(Ct)){if(Math.abs(Le-qe)<1e-6)return this.easeTo(t,o);const Dt=qe<Le?-1:1;Ct=Math.abs(Math.log(qe/Le))/Oe,Et=()=>0,Pt=ur=>Math.exp(Dt*Oe*ur)}return t.duration="duration"in t?+t.duration:1e3*Ct/("screenSpeed"in t?+t.screenSpeed/Oe:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=x!==F,this._pitching=V!==S,this._rolling=q!==A,this._padding=!d.isPaddingEqual(te),this._prepareEase(o,!1),this.terrain&&this._prepareElevation(Ie.targetCenter),this._ease((Dt=>{const ur=Dt*Ct,fr=1/Pt(ur),tr=Et(ur);this._rotating&&d.setBearing(s.G.number(x,F,Dt)),this._pitching&&d.setPitch(s.G.number(S,V,Dt)),this._rolling&&d.setRoll(s.G.number(A,q,Dt)),this._padding&&(d.interpolatePadding(R,te,Dt),ce=d.centerPoint.add(Q)),Ie.easeFunc(Dt,fr,tr,ce),this.terrain&&!t.freezeElevation&&this._updateElevation(Dt),this._applyUpdatedTransform(d),this._fireMoveEvents(o)}),(()=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(o)}),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,o){var d;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const x=this._onEaseEnd;delete this._onEaseEnd,x.call(this,o)}return t||(d=this.handlers)===null||d===void 0||d.stop(!1),this}_ease(t,o,d){d.animate===!1||d.duration===0?(t(1),o()):(this._easeStart=z(),this._easeOptions=d,this._onEaseFrame=t,this._onEaseEnd=o,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,o){t=s.W(t,-180,180);const d=Math.abs(t-o);return Math.abs(t-360-o)<d&&(t-=360),Math.abs(t+360-o)<d&&(t+=360),t}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLat(s.V.convert(t),this.transform):null}}const ja={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Ya{constructor(t=ja){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=o=>{!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"&&o.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options.compact,this._container=N.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=N.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=N.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){N.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,o){const d=this._map._getUIString(`AttributionControl.${o}`);t.title=d,t.setAttribute("aria-label",d)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map((x=>typeof x!="string"?"":x))):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const x=this._map.style.stylesheet;this.styleOwner=x.owner,this.styleId=x.id}const o=this._map.style.tileManagers;for(const x in o){const S=o[x];if(S.used||S.usedForTerrain){const A=S.getSource();A.attribution&&t.indexOf(A.attribution)<0&&t.push(A.attribution)}}t=t.filter((x=>String(x).trim())),t.sort(((x,S)=>x.length-S.length)),t=t.filter(((x,S)=>{for(let A=S+1;A<t.length;A++)if(t[A].indexOf(x)>=0)return!1;return!0}));const d=t.join(" | ");d!==this._attribHTML&&(this._attribHTML=d,t.length?(this._innerContainer.innerHTML=N.sanitize(d),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class sf{constructor(t={}){this._updateCompact=()=>{const o=this._container.children;if(o.length){const d=o[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&d.classList.add("maplibregl-compact"):d.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=N.create("div","maplibregl-ctrl");const o=N.create("a","maplibregl-ctrl-logo");return o.target="_blank",o.rel="noopener nofollow",o.href="https://maplibre.org/",o.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),o.setAttribute("rel","noopener nofollow"),this._container.appendChild(o),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){N.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class _c{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const o=++this._id;return this._queue.push({callback:t,id:o,cancelled:!1}),o}remove(t){const o=this._currentlyRunning,d=o?this._queue.concat(o):this._queue;for(const x of d)if(x.id===t)return void(x.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const o=this._currentlyRunning=this._queue;this._queue=[];for(const d of o)if(!d.cancelled&&(d.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Tn=s.aU([{name:"a_pos3d",type:"Int16",components:3}]);class $n extends s.E{constructor(t){super(),this._lastTilesetChange=z(),this.tileManager=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=t._source.tileSize*2**this.deltaZoom,t.usedForTerrain=!0,t.tileSize=this.tileSize}destruct(){this.tileManager.usedForTerrain=!1,this.tileManager.tileSize=null}getSource(){return this.tileManager._source}update(t,o){this.tileManager.update(t,o),this._renderableTilesKeys=[];const d={};for(const x of va(t,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:o,calculateTileZoom:this.tileManager._source.calculateTileZoom}))d[x.key]=!0,this._renderableTilesKeys.push(x.key),this._tiles[x.key]||(x.terrainRttPosMatrix32f=new Float64Array(16),s.c7(x.terrainRttPosMatrix32f,0,s.a5,s.a5,0,0,1),this._tiles[x.key]=new Bt(x,this.tileSize),this._lastTilesetChange=z());for(const x in this._tiles)d[x]||delete this._tiles[x]}freeRtt(t){for(const o in this._tiles){const d=this._tiles[o];(!t||d.tileID.equals(t)||d.tileID.isChildOf(t)||t.isChildOf(d.tileID))&&(d.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((t=>this.getTileByID(t)))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t,o){return o?this._getTerrainCoordsForTileRanges(t,o):this._getTerrainCoordsForRegularTile(t)}_getTerrainCoordsForRegularTile(t){const o={};for(const d of this._renderableTilesKeys){const x=this._tiles[d].tileID,S=t.clone(),A=s.bk();if(x.canonical.equals(t.canonical))s.c7(A,0,s.a5,s.a5,0,0,1);else if(x.canonical.isChildOf(t.canonical)){const R=x.canonical.z-t.canonical.z,F=x.canonical.x-(x.canonical.x>>R<<R),V=x.canonical.y-(x.canonical.y>>R<<R),q=s.a5>>R;s.c7(A,0,q,q,0,0,1),s.O(A,A,[-F*q,-V*q,0])}else{if(!t.canonical.isChildOf(x.canonical))continue;{const R=t.canonical.z-x.canonical.z,F=t.canonical.x-(t.canonical.x>>R<<R),V=t.canonical.y-(t.canonical.y>>R<<R),q=s.a5>>R;s.c7(A,0,s.a5,s.a5,0,0,1),s.O(A,A,[F*q,V*q,0]),s.Q(A,A,[1/2**R,1/2**R,0])}}S.terrainRttPosMatrix32f=new Float32Array(A),o[d]=S}return o}_getTerrainCoordsForTileRanges(t,o){const d={};for(const x of this._renderableTilesKeys){const S=this._tiles[x].tileID;if(!this._isWithinTileRanges(S,o))continue;const A=t.clone(),R=s.bk();if(S.canonical.z===t.canonical.z){const F=t.canonical.x-S.canonical.x,V=t.canonical.y-S.canonical.y;s.c7(R,0,s.a5,s.a5,0,0,1),s.O(R,R,[F*s.a5,V*s.a5,0])}else if(S.canonical.z>t.canonical.z){const F=S.canonical.z-t.canonical.z,V=S.canonical.x-(S.canonical.x>>F<<F),q=S.canonical.y-(S.canonical.y>>F<<F),te=t.canonical.x-(S.canonical.x>>F),Q=t.canonical.y-(S.canonical.y>>F),ce=s.a5>>F;s.c7(R,0,ce,ce,0,0,1),s.O(R,R,[-V*ce+te*s.a5,-q*ce+Q*s.a5,0])}else{const F=t.canonical.z-S.canonical.z,V=t.canonical.x-(t.canonical.x>>F<<F),q=t.canonical.y-(t.canonical.y>>F<<F),te=(t.canonical.x>>F)-S.canonical.x,Q=(t.canonical.y>>F)-S.canonical.y,ce=s.a5<<F;s.c7(R,0,ce,ce,0,0,1),s.O(R,R,[V*s.a5+te*ce,q*s.a5+Q*ce,0])}A.terrainRttPosMatrix32f=new Float32Array(R),d[x]=A}return d}getSourceTile(t,o){const d=this.tileManager._source;let x=t.overscaledZ-this.deltaZoom;if(x>d.maxzoom&&(x=d.maxzoom),x<d.minzoom)return;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(x).key);let S=this.findTileInCaches(this._sourceTileCache[t.key]);if(!S?.dem&&o)for(;x>=d.minzoom&&!S?.dem;)S=this.findTileInCaches(t.scaledTo(x--).key);return S}findTileInCaches(t){let o=this.tileManager.getTileByID(t);return o||(o=this.tileManager._outOfViewCache.getByKey(t),o)}anyTilesAfterTime(t=Date.now()){return this._lastTilesetChange>=t}_isWithinTileRanges(t,o){return o[t.canonical.z]&&t.canonical.x>=o[t.canonical.z].minTileX&&t.canonical.x<=o[t.canonical.z].maxTileX&&t.canonical.y>=o[t.canonical.z].minTileY&&t.canonical.y<=o[t.canonical.z].maxTileY}}class wn{constructor(t,o,d){this._meshCache={},this.painter=t,this.tileManager=new $n(o),this.options=d,this.exaggeration=typeof d.exaggeration=="number"?d.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,o,d,x=s.a5){var S;if(!(o>=0&&o<x&&d>=0&&d<x))return 0;const A=this.getTerrainData(t),R=(S=A.tile)===null||S===void 0?void 0:S.dem;if(!R)return 0;const F=s.cC([],[o/x*s.a5,d/x*s.a5],A.u_terrain_matrix),V=[F[0]*R.dim,F[1]*R.dim],q=Math.floor(V[0]),te=Math.floor(V[1]),Q=V[0]-q,ce=V[1]-te;return R.get(q,te)*(1-Q)*(1-ce)+R.get(q+1,te)*Q*(1-ce)+R.get(q,te+1)*(1-Q)*ce+R.get(q+1,te+1)*Q*ce}getElevationForLngLatZoom(t,o){if(!s.cD(o,t.wrap()))return 0;const{tileID:d,mercatorX:x,mercatorY:S}=this._getOverscaledTileIDFromLngLatZoom(t,o);return this.getElevation(d,x%s.a5,S%s.a5,s.a5)}getElevationForLngLat(t,o){const d=va(o,{maxzoom:this.tileManager.maxzoom,minzoom:this.tileManager.minzoom,tileSize:512,terrain:this});let x=0;for(const S of d)S.canonical.z>x&&(x=Math.min(S.canonical.z,this.tileManager.maxzoom));return this.getElevationForLngLatZoom(t,x)}getElevation(t,o,d,x=s.a5){return this.getDEMElevation(t,o,d,x)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const x=this.painter.context,S=new s.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new s.T(x,S,x.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new s.T(x,new s.R({width:1,height:1}),x.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(x.gl.NEAREST,x.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=s.ar([])}const o=this.tileManager.getSourceTile(t,!0);if(o&&o.dem&&(!o.demTexture||o.needsTerrainPrepare)){const x=this.painter.context;o.demTexture=this.painter.getTileTexture(o.dem.stride),o.demTexture?o.demTexture.update(o.dem.getPixels(),{premultiply:!1}):o.demTexture=new s.T(x,o.dem.getPixels(),x.gl.RGBA,{premultiply:!1}),o.demTexture.bind(x.gl.NEAREST,x.gl.CLAMP_TO_EDGE),o.needsTerrainPrepare=!1}const d=o&&o.toString()+o.tileID.key+t.key;if(d&&!this._demMatrixCache[d]){const x=this.tileManager.getSource().maxzoom;let S=t.canonical.z-o.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=x?S=t.canonical.z-x:s.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const A=t.canonical.x-(t.canonical.x>>S<<S),R=t.canonical.y-(t.canonical.y>>S<<S),F=s.cE(new Float64Array(16),[1/(s.a5<<S),1/(s.a5<<S),0]);s.O(F,F,[A*s.a5,R*s.a5,0]),this._demMatrixCache[t.key]={matrix:F,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:o&&o.dem&&o.dem.dim||1,u_terrain_matrix:d?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:o&&o.dem&&o.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(o&&o.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:o}}getFramebuffer(t){const o=this.painter,d=o.width/devicePixelRatio,x=o.height/devicePixelRatio;return!this._fbo||this._fbo.width===d&&this._fbo.height===x||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new s.T(o.context,{width:d,height:x,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new s.T(o.context,{width:d,height:x,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=o.context.createFramebuffer(d,x,!0,!1),this._fbo.depthAttachment.set(o.context.createRenderbuffer(o.context.gl.DEPTH_COMPONENT16,d,x))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const o=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let S=0,A=0;S<this._coordsTextureSize;S++)for(let R=0;R<this._coordsTextureSize;R++,A+=4)o[A+0]=255&R,o[A+1]=255&S,o[A+2]=R>>8<<4|S>>8,o[A+3]=0;const d=new s.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(o.buffer)),x=new s.T(t,d,t.gl.RGBA,{premultiply:!1});return x.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=x,x}pointCoordinate(t){this.painter.maybeDrawDepthAndCoords(!0);const o=new Uint8Array(4),d=this.painter.context,x=d.gl,S=Math.round(t.x*this.painter.pixelRatio/devicePixelRatio),A=Math.round(t.y*this.painter.pixelRatio/devicePixelRatio),R=Math.round(this.painter.height/devicePixelRatio);d.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),x.readPixels(S,R-A-1,1,1,x.RGBA,x.UNSIGNED_BYTE,o),d.bindFramebuffer.set(null);const F=o[0]+(o[2]>>4<<8),V=o[1]+((15&o[2])<<8),q=this.coordsIndex[255-o[3]],te=q&&this.tileManager.getTileByID(q);if(!te)return null;const Q=this._coordsTextureSize,ce=(1<<te.tileID.canonical.z)*Q;return new s.a9((te.tileID.canonical.x*Q+F)/ce+te.tileID.wrap,(te.tileID.canonical.y*Q+V)/ce,this.getElevation(te.tileID,F,V,Q))}depthAtPoint(t){const o=new Uint8Array(4),d=this.painter.context,x=d.gl;return d.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),x.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,x.RGBA,x.UNSIGNED_BYTE,o),d.bindFramebuffer.set(null),(o[0]/16777216+o[1]/65536+o[2]/256+o[3])/256}getTerrainMesh(t){var o;const d=((o=this.painter.style.projection)===null||o===void 0?void 0:o.transitionState)>0,x=d&&t.canonical.y===0,S=d&&t.canonical.y===(1<<t.canonical.z)-1,A=`m_${x?"n":""}_${S?"s":""}`;if(this._meshCache[A])return this._meshCache[A];const R=this.painter.context,F=new s.cF,V=new s.aY,q=this.meshSize,te=s.a5/q,Q=q*q;for(let Xe=0;Xe<=q;Xe++)for(let ft=0;ft<=q;ft++)F.emplaceBack(ft*te,Xe*te,0);for(let Xe=0;Xe<Q;Xe+=q+1)for(let ft=0;ft<q;ft++)V.emplaceBack(ft+Xe,q+ft+Xe+1,q+ft+Xe+2),V.emplaceBack(ft+Xe,q+ft+Xe+2,ft+Xe+1);const ce=F.length,_e=ce+(q+1),Ie=(q+1)*q,Oe=x?s.br:0,Le=x?0:1,qe=S?s.bs:s.a5,nt=S?0:1;for(let Xe=0;Xe<=q;Xe++)F.emplaceBack(Xe*te,Oe,Le);for(let Xe=0;Xe<=q;Xe++)F.emplaceBack(Xe*te,qe,nt);for(let Xe=0;Xe<q;Xe++)V.emplaceBack(Ie+Xe,_e+Xe,_e+Xe+1),V.emplaceBack(Ie+Xe,_e+Xe+1,Ie+Xe+1),V.emplaceBack(0+Xe,ce+Xe+1,ce+Xe),V.emplaceBack(0+Xe,0+Xe+1,ce+Xe+1);const He=F.length,rt=He+2*(q+1);for(const Xe of[0,1])for(let ft=0;ft<=q;ft++)for(const Pt of[0,1])F.emplaceBack(Xe*s.a5,ft*te,Pt);for(let Xe=0;Xe<2*q;Xe+=2)V.emplaceBack(He+Xe,He+Xe+1,He+Xe+3),V.emplaceBack(He+Xe,He+Xe+3,He+Xe+2),V.emplaceBack(rt+Xe,rt+Xe+3,rt+Xe+1),V.emplaceBack(rt+Xe,rt+Xe+2,rt+Xe+3);const ot=new Yn(R.createVertexBuffer(F,Tn.members),R.createIndexBuffer(V),s.aX.simpleSegment(0,0,F.length,V.length));return this._meshCache[A]=ot,ot}getMeshFrameDelta(t){return 2*Math.PI*s.bE/Math.pow(2,Math.max(t,0))/5}getMinTileElevationForLngLatZoom(t,o){var d;if(!s.cD(o,t.wrap()))return 0;const{tileID:x}=this._getOverscaledTileIDFromLngLatZoom(t,o);return(d=this.getMinMaxElevation(x).minElevation)!==null&&d!==void 0?d:0}getMinMaxElevation(t){const o=this.getTerrainData(t).tile,d={minElevation:null,maxElevation:null};return o&&o.dem&&(d.minElevation=o.dem.min*this.exaggeration,d.maxElevation=o.dem.max*this.exaggeration),d}_getOverscaledTileIDFromLngLatZoom(t,o){const d=s.a9.fromLngLat(t.wrap()),x=(1<<o)*s.a5,S=d.x*x,A=d.y*x,R=Math.floor(S/s.a5),F=Math.floor(A/s.a5);return{tileID:new s.a2(o,0,o,R,F),mercatorX:S,mercatorY:A}}}class Ia{constructor(t,o,d){this._context=t,this._size=o,this._tileSize=d,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const o=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),d=new s.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return d.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),o.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),o.colorAttachment.set(d.texture),{id:t,fbo:o,texture:d,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((o=>t.id!==o)),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const o of this._recentlyUsed)if(!this._objects[o].inUse)return this._objects[o];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((t=>!t.inUse))===!1}}const Do={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class ll{constructor(t,o){this.painter=t,this.terrain=o,this.pool=new Ia(t.context,30,o.tileManager.tileSize*o.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,o){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.tileManager.getRenderableTiles(),this._renderableLayerIds=t._order.filter((d=>!t._layers[d].isHidden(o))),this._coordsAscending={};for(const d in t.tileManagers){this._coordsAscending[d]={};const x=t.tileManagers[d].getVisibleCoordinates(),S=t.tileManagers[d].getSource(),A=S instanceof sr?S.terrainTileRanges:null;for(const R of x){const F=this.terrain.tileManager.getTerrainCoords(R,A);for(const V in F)this._coordsAscending[d][V]||(this._coordsAscending[d][V]=[]),this._coordsAscending[d][V].push(F[V])}}this._coordsAscendingStr={};for(const d of t._order){const x=t._layers[d],S=x.source;if(Do[x.type]&&!this._coordsAscendingStr[S]){this._coordsAscendingStr[S]={};for(const A in this._coordsAscending[S])this._coordsAscendingStr[S][A]=this._coordsAscending[S][A].map((R=>R.key)).sort().join()}}for(const d of this._renderableTiles)for(const x in this._coordsAscendingStr){const S=this._coordsAscendingStr[x][d.tileID.key];S&&S!==d.rttCoords[x]&&(d.rtt=[])}}renderLayer(t,o){if(t.isHidden(this.painter.transform.zoom))return!1;const d=Object.assign(Object.assign({},o),{isRenderingToTexture:!0}),x=t.type,S=this.painter,A=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(Do[x]&&(this._prevType&&Do[this._prevType]||this._stacks.push([]),this._prevType=x,this._stacks[this._stacks.length-1].push(t.id),!A))return!0;if(Do[this._prevType]||Do[x]&&A){this._prevType=x;const R=this._stacks.length-1,F=this._stacks[R]||[];for(const V of this._renderableTiles){if(this.pool.isFull()&&(gh(this.painter,this.terrain,this._rttTiles,d),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(V),V.rtt[R]){const te=this.pool.getObjectForId(V.rtt[R].id);if(te.stamp===V.rtt[R].stamp){this.pool.useObject(te);continue}}const q=this.pool.getOrCreateFreeObject();this.pool.useObject(q),this.pool.stampObject(q),V.rtt[R]={id:q.id,stamp:q.stamp},S.context.bindFramebuffer.set(q.fbo.framebuffer),S.context.clear({color:s.bp.transparent,stencil:0}),S.currentStencilSource=void 0;for(let te=0;te<F.length;te++){const Q=S.style._layers[F[te]],ce=Q.source?this._coordsAscending[Q.source][V.tileID.key]:[V.tileID];S.context.viewport.set([0,0,q.fbo.width,q.fbo.height]),S._renderTileClippingMasks(Q,ce,!0),S.renderLayer(S,S.style.tileManagers[Q.source],Q,ce,d),Q.source&&(V.rttCoords[Q.source]=this._coordsAscendingStr[Q.source][V.tileID.key])}}return gh(this.painter,this.terrain,this._rttTiles,d),this._rttTiles=[],this.pool.freeAllObjects(),Do[x]}return!1}}const Du={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Ru=C,xc={hash:!1,interactive:!0,bearingSnap:7,attributionControl:ja,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:s.c.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,transformConstrain:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,reduceMotion:void 0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0,experimentalZoomLevelsToOverscale:void 0},Md={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class ka{constructor(t,o,d=!1){this.mousedown=S=>{this.startMove(S,N.mousePos(this.element,S)),N.addEventListener(window,"mousemove",this.mousemove),N.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=S=>{this.move(S,N.mousePos(this.element,S))},this.mouseup=S=>{this._rotatePitchHandler.dragEnd(S),this.offTemp()},this.touchstart=S=>{S.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=N.touchPos(this.element,S.targetTouches)[0],this.startMove(S,this._startPos),N.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),N.addEventListener(window,"touchend",this.touchend))},this.touchmove=S=>{S.targetTouches.length!==1?this.reset():(this._lastPos=N.touchPos(this.element,S.targetTouches)[0],this.move(S,this._lastPos))},this.touchend=S=>{S.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=o;const x=new Qh;this._rotatePitchHandler=new ko({clickTolerance:3,move:(S,A)=>{const R=o.getBoundingClientRect(),F=new s.P((R.bottom-R.top)/2,(R.right-R.left)/2);return{bearingDelta:s.cx(new s.P(S.x,A.y),A,F),pitchDelta:d?-.5*(A.y-S.y):void 0}},moveStateManager:x,enable:!0,assignEvents:()=>{}}),this.map=t,N.addEventListener(o,"mousedown",this.mousedown),N.addEventListener(o,"touchstart",this.touchstart,{passive:!1}),N.addEventListener(o,"touchcancel",this.reset)}startMove(t,o){this._rotatePitchHandler.dragStart(t,o),N.disableDrag()}move(t,o){const d=this.map,{bearingDelta:x,pitchDelta:S}=this._rotatePitchHandler.dragMove(t,o)||{};x&&d.setBearing(d.getBearing()+x),S&&d.setPitch(d.getPitch()+S)}off(){const t=this.element;N.removeEventListener(t,"mousedown",this.mousedown),N.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),N.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),N.removeEventListener(window,"touchend",this.touchend),N.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){N.enableDrag(),N.removeEventListener(window,"mousemove",this.mousemove),N.removeEventListener(window,"mouseup",this.mouseup),N.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),N.removeEventListener(window,"touchend",this.touchend)}}let cl;function yh(w,t,o,d=!1){if(d||!o.getCoveringTilesDetailsProvider().allowWorldCopies())return w?.wrap();const x=new s.V(w.lng,w.lat);if(w=new s.V(w.lng,w.lat),t){const S=new s.V(w.lng-360,w.lat),A=new s.V(w.lng+360,w.lat),R=o.locationToScreenPoint(w).distSqr(t);o.locationToScreenPoint(S).distSqr(t)<R?w=S:o.locationToScreenPoint(A).distSqr(t)<R&&(w=A)}for(;Math.abs(w.lng-o.center.lng)>180;){const S=o.locationToScreenPoint(w);if(S.x>=0&&S.y>=0&&S.x<=o.width&&S.y<=o.height)break;w.lng>o.center.lng?w.lng-=360:w.lng+=360}return w.lng!==x.lng&&o.isPointOnMapSurface(o.locationToScreenPoint(w))?w:x}const vh={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function of(w,t,o){const d=w.classList;for(const x in vh)d.remove(`maplibregl-${o}-anchor-${x}`);d.add(`maplibregl-${o}-anchor-${t}`)}class lf extends s.E{constructor(t){if(super(),this._onKeyPress=o=>{const d=o.code,x=o.charCode||o.keyCode;d!=="Space"&&d!=="Enter"&&x!==32&&x!==13||this.togglePopup()},this._onMapClick=o=>{const d=o.originalEvent.target,x=this._element;this._popup&&(d===x||x.contains(d))&&this.togglePopup()},this._update=o=>{if(!this._map)return;const d=this._map.loaded()&&!this._map.isMoving();(o?.type==="terrain"||o?.type==="render"&&!d)&&this._map.once("render",this._update),this._lngLat=yh(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let x="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?x=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(x=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let S="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?S="rotateX(0deg)":this._pitchAlignment==="map"&&(S=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||o&&o.type!=="moveend"||(this._pos=this._pos.round()),N.setTransform(this._element,`${vh[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${S} ${x}`),j.frameAsync(new AbortController).then((()=>{this._updateOpacity(o&&o.type==="moveend")})).catch((()=>{}))},this._onMove=o=>{if(!this._isDragging){const d=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=d}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.l("dragstart"))),this.fire(new s.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new s.l("dragend")),this._state="inactive"},this._addDragHandler=o=>{this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._subpixelPositioning=t&&t.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,this.setOpacity(t?.opacity,t?.opacityWhenCovered),t&&t.element)this._element=t.element,this._offset=s.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=N.create("div");const o=N.createNS("http://www.w3.org/2000/svg","svg"),d=41,x=27;o.setAttributeNS(null,"display","block"),o.setAttributeNS(null,"height",`${d}px`),o.setAttributeNS(null,"width",`${x}px`),o.setAttributeNS(null,"viewBox",`0 0 ${x} ${d}`);const S=N.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"stroke","none"),S.setAttributeNS(null,"stroke-width","1"),S.setAttributeNS(null,"fill","none"),S.setAttributeNS(null,"fill-rule","evenodd");const A=N.createNS("http://www.w3.org/2000/svg","g");A.setAttributeNS(null,"fill-rule","nonzero");const R=N.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"transform","translate(3.0, 29.0)"),R.setAttributeNS(null,"fill","#000000");const F=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Le of F){const qe=N.createNS("http://www.w3.org/2000/svg","ellipse");qe.setAttributeNS(null,"opacity","0.04"),qe.setAttributeNS(null,"cx","10.5"),qe.setAttributeNS(null,"cy","5.80029008"),qe.setAttributeNS(null,"rx",Le.rx),qe.setAttributeNS(null,"ry",Le.ry),R.appendChild(qe)}const V=N.createNS("http://www.w3.org/2000/svg","g");V.setAttributeNS(null,"fill",this._color);const q=N.createNS("http://www.w3.org/2000/svg","path");q.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),V.appendChild(q);const te=N.createNS("http://www.w3.org/2000/svg","g");te.setAttributeNS(null,"opacity","0.25"),te.setAttributeNS(null,"fill","#000000");const Q=N.createNS("http://www.w3.org/2000/svg","path");Q.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),te.appendChild(Q);const ce=N.createNS("http://www.w3.org/2000/svg","g");ce.setAttributeNS(null,"transform","translate(6.0, 7.0)"),ce.setAttributeNS(null,"fill","#FFFFFF");const _e=N.createNS("http://www.w3.org/2000/svg","g");_e.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Ie=N.createNS("http://www.w3.org/2000/svg","circle");Ie.setAttributeNS(null,"fill","#000000"),Ie.setAttributeNS(null,"opacity","0.25"),Ie.setAttributeNS(null,"cx","5.5"),Ie.setAttributeNS(null,"cy","5.5"),Ie.setAttributeNS(null,"r","5.4999962");const Oe=N.createNS("http://www.w3.org/2000/svg","circle");Oe.setAttributeNS(null,"fill","#FFFFFF"),Oe.setAttributeNS(null,"cx","5.5"),Oe.setAttributeNS(null,"cy","5.5"),Oe.setAttributeNS(null,"r","5.4999962"),_e.appendChild(Ie),_e.appendChild(Oe),A.appendChild(R),A.appendChild(V),A.appendChild(te),A.appendChild(ce),A.appendChild(_e),o.appendChild(A),o.setAttributeNS(null,"height",d*this._scale+"px"),o.setAttributeNS(null,"width",x*this._scale+"px"),this._element.appendChild(o),this._offset=s.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(o=>{o.preventDefault()})),this._element.addEventListener("mousedown",(o=>{o.preventDefault()})),of(this._element,this._anchor,"marker"),t&&t.className)for(const o of t.className.split(" "))this._element.classList.add(o);this._popup=null}addTo(t){return this.remove(),this._map=t,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",t._getUIString("Marker.Title")),this._element.hasAttribute("role")||this._element.setAttribute("role","button"),t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),t.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),N.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=s.V.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const x=Math.abs(13.5)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[x,-1*(38.1-13.5+x)],"bottom-right":[-x,-1*(38.1-13.5+x)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(t){return this._subpixelPositioning=t,this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:t?(t.isOpen()?t.remove():(t.setLngLat(this._lngLat),t.addTo(this._map)),this):this}_updateOpacity(t=!1){var o,d;const x=(o=this._map)===null||o===void 0?void 0:o.terrain,S=this._map.transform.isLocationOccluded(this._lngLat);if(!x||S){const ce=S?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==ce&&(this._element.style.opacity=ce))}if(t)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const A=this._map,R=A.terrain.depthAtPoint(this._pos),F=A.terrain.getElevationForLngLat(this._lngLat,A.transform);if(A.transform.lngLatToCameraDepth(this._lngLat,F)-R<.006)return void(this._element.style.opacity=this._opacity);const V=-this._offset.y/A.transform.pixelsPerMeter,q=Math.sin(A.getPitch()*Math.PI/180)*V,te=A.terrain.depthAtPoint(new s.P(this._pos.x,this._pos.y-this._offset.y)),Q=A.transform.lngLatToCameraDepth(this._lngLat,F+q)-te>.006;!((d=this._popup)===null||d===void 0)&&d.isOpen()&&Q&&this._popup.remove(),this._element.style.opacity=Q?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(t){return this._offset=s.P.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(t,o){return(this._opacity===void 0||t===void 0&&o===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),t!==void 0&&(this._opacity=t),o!==void 0&&(this._opacityWhenCovered=o),this._map&&this._updateOpacity(!0),this}}const cf={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let $c=0,yc=!1;const ts={maxWidth:100,unit:"metric"};function Pa(w,t,o){const d=o&&o.maxWidth||100,x=w._container.clientHeight/2,S=w._container.clientWidth/2,A=w.unproject([S-d/2,x]),R=w.unproject([S+d/2,x]),F=Math.round(w.project(R).x-w.project(A).x),V=Math.min(d,F,w._container.clientWidth),q=A.distanceTo(R);if(o&&o.unit==="imperial"){const te=3.2808*q;te>5280?Hl(t,V,te/5280,w._getUIString("ScaleControl.Miles")):Hl(t,V,te,w._getUIString("ScaleControl.Feet"))}else o&&o.unit==="nautical"?Hl(t,V,q/1852,w._getUIString("ScaleControl.NauticalMiles")):q>=1e3?Hl(t,V,q/1e3,w._getUIString("ScaleControl.Kilometers")):Hl(t,V,q,w._getUIString("ScaleControl.Meters"))}function Hl(w,t,o,d){const x=(function(S){const A=Math.pow(10,`${Math.floor(S)}`.length-1);let R=S/A;return R=R>=10?10:R>=5?5:R>=3?3:R>=2?2:R>=1?1:(function(F){const V=Math.pow(10,Math.ceil(-Math.log(F)/Math.LN10));return Math.round(F*V)/V})(R),A*R})(o);w.style.width=t*(x/o)+"px",w.innerHTML=`${x}&nbsp;${d}`}const Iu={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Pu=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function bh(w){if(w){if(typeof w=="number"){const t=Math.round(Math.abs(w)/Math.SQRT2);return{center:new s.P(0,0),top:new s.P(0,w),"top-left":new s.P(t,t),"top-right":new s.P(-t,t),bottom:new s.P(0,-w),"bottom-left":new s.P(t,-t),"bottom-right":new s.P(-t,-t),left:new s.P(w,0),right:new s.P(-w,0)}}if(w instanceof s.P||Array.isArray(w)){const t=s.P.convert(w);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:s.P.convert(w.center||[0,0]),top:s.P.convert(w.top||[0,0]),"top-left":s.P.convert(w["top-left"]||[0,0]),"top-right":s.P.convert(w["top-right"]||[0,0]),bottom:s.P.convert(w.bottom||[0,0]),"bottom-left":s.P.convert(w["bottom-left"]||[0,0]),"bottom-right":s.P.convert(w["bottom-right"]||[0,0]),left:s.P.convert(w.left||[0,0]),right:s.P.convert(w.right||[0,0])}}return bh(new s.P(0,0))}const ul=C;_.AJAXError=s.cI,_.Event=s.l,_.Evented=s.E,_.LngLat=s.V,_.MercatorCoordinate=s.a9,_.Point=s.P,_.addProtocol=s.cJ,_.config=s.c,_.removeProtocol=s.cK,_.AttributionControl=Ya,_.BoxZoomHandler=Zc,_.CanvasSource=fe,_.CooperativeGesturesHandler=Rr,_.DoubleClickZoomHandler=Uf,_.DragPanHandler=Cd,_.DragRotateHandler=oo,_.EdgeInsets=_a,_.FullscreenControl=class extends s.E{constructor(w={}){super(),this._onFullscreenChange=()=>{var t;let o=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((t=o?.shadowRoot)===null||t===void 0)&&t.fullscreenElement;)o=o.shadowRoot.fullscreenElement;o===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,w&&w.container&&(w.container instanceof HTMLElement?this._container=w.container:s.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(w){return this._map=w,this._container||(this._container=this._map.getContainer()),this._controlContainer=N.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){N.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const w=this._fullscreenButton=N.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);N.create("span","maplibregl-ctrl-icon",w).setAttribute("aria-hidden","true"),w.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const w=this._getTitle();this._fullscreenButton.setAttribute("aria-label",w),this._fullscreenButton.title=w}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new s.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new s.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},_.GeoJSONSource=pr,_.GeolocateControl=class extends s.E{constructor(w){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new s.l("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new s.l("geolocate",t)),this._finish()}},this._updateCamera=t=>{const o=new s.V(t.coords.longitude,t.coords.latitude),d=t.coords.accuracy,x=this._map.getBearing(),S=s.e({bearing:x},this.options.fitBoundsOptions),A=Ee.fromLngLat(o,d);this._map.fitBounds(A,S,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const o=new s.V(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=t.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=t=>{if(this._map){if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&yc)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new s.l("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this._geolocateButton=N.create("button","maplibregl-ctrl-geolocate",this._container),N.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=t=>{if(this._map){if(t===!1){s.w("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=N.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new lf({element:this._dotElement}),this._circleElement=N.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new lf({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(o=>{const d=o?.[0]instanceof ResizeObserverEntry;o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||d||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new s.l("trackuserlocationend")),this.fire(new s.l("userlocationlostfocus")))}))}},this.options=s.e({},cf,w)}onAdd(w){return this._map=w,this._container=N.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return s._(this,arguments,void 0,(function*(t=!1){if(cl!==void 0&&!t)return cl;if(window.navigator.permissions===void 0)return cl=!!window.navigator.geolocation,cl;try{cl=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{cl=!!window.navigator.geolocation}return cl}))})().then((t=>this._finishSetupUI(t))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),N.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,$c=0,yc=!1}_isOutOfMapMaxBounds(w){const t=this._map.getMaxBounds(),o=w.coords;return t&&(o.longitude<t.getWest()||o.longitude>t.getEast()||o.latitude<t.getSouth()||o.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":case"BACKGROUND_ERROR":case"OFF":case void 0:break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const w=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&w))return;const t=this._map.project(w),o=this._map.unproject([t.x+100,t.y]),d=w.distanceTo(o)/100,x=2*this._accuracy/d;this._circleElement.style.width=`${x.toFixed(2)}px`,this._circleElement.style.height=`${x.toFixed(2)}px`}trigger(){if(!this._setup)return s.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":$c--,yc=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new s.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.l("trackuserlocationstart")),this.fire(new s.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let w;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),$c++,$c>1?(w={maximumAge:6e5,timeout:0},yc=!0):(w=this.options.positionOptions,yc=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,w)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},_.GlobeControl=class{constructor(){this._toggleProjection=()=>{var w;const t=(w=this._map.getProjection())===null||w===void 0?void 0:w.type;this._map.setProjection(t!=="mercator"&&t?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var w;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((w=this._map.getProjection())===null||w===void 0?void 0:w.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(w){return this._map=w,this._container=N.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=N.create("button","maplibregl-ctrl-globe",this._container),N.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){N.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},_.Hash=Na,_.ImageSource=sr,_.KeyboardHandler=Jn,_.LngLatBounds=Ee,_.LogoControl=sf,_.Map=class extends ni{constructor(w){var t,o;s.cG.mark(s.cH.create);const d=Object.assign(Object.assign(Object.assign({},xc),w),{canvasContextAttributes:Object.assign(Object.assign({},xc.canvasContextAttributes),w.canvasContextAttributes)});if(d.minZoom!=null&&d.maxZoom!=null&&d.minZoom>d.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(d.minPitch!=null&&d.maxPitch!=null&&d.minPitch>d.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(d.minPitch!=null&&d.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(d.maxPitch!=null&&d.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const x=new qa,S=new ls;if(d.minZoom!==void 0&&x.setMinZoom(d.minZoom),d.maxZoom!==void 0&&x.setMaxZoom(d.maxZoom),d.minPitch!==void 0&&x.setMinPitch(d.minPitch),d.maxPitch!==void 0&&x.setMaxPitch(d.maxPitch),d.renderWorldCopies!==void 0&&x.setRenderWorldCopies(d.renderWorldCopies),d.transformConstrain!==null&&x.setConstrainOverride(d.transformConstrain),super(x,S,{bearingSnap:d.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new _c,this._controls=[],this._mapId=s.af(),this._lostContextStyle={style:null,images:null},this._contextLost=R=>{R.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.painter.destroy();for(const F of Object.values(this.style._layers))if(F.type==="custom"&&console.warn(`Custom layer with id '${F.id}' cannot be restored after WebGL context loss. You will need to re-add it manually after context restoration.`),F._listeners)for(const[V]of Object.entries(F._listeners))console.warn(`Custom layer with id '${F.id}' had event listeners for event '${V}' which cannot be restored after WebGL context loss. You will need to re-add them manually after context restoration.`);this._lostContextStyle=this._getStyleAndImages(),this.style.destroy(),this.style=null,this.fire(new s.l("webglcontextlost",{originalEvent:R}))},this._contextRestored=R=>{this._lostContextStyle.style&&this.setStyle(this._lostContextStyle.style,{diff:!1}),this._lostContextStyle.images&&(this.style.imageManager.images=this._lostContextStyle.images),this._setupPainter(),this.resize(),this._update(),this.fire(new s.l("webglcontextrestored",{originalEvent:R}))},this._onMapScroll=R=>{if(R.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=d.interactive,this._maxTileCacheSize=d.maxTileCacheSize,this._maxTileCacheZoomLevels=d.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},d.canvasContextAttributes),this._trackResize=d.trackResize===!0,this._bearingSnap=d.bearingSnap,this._centerClampedToGround=d.centerClampedToGround,this._refreshExpiredTiles=d.refreshExpiredTiles===!0,this._fadeDuration=d.fadeDuration,this._crossSourceCollisions=d.crossSourceCollisions===!0,this._collectResourceTiming=d.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Du),d.locale),this._clickTolerance=d.clickTolerance,this._overridePixelRatio=d.pixelRatio,this._maxCanvasSize=d.maxCanvasSize,this._zoomLevelsToOverscale=d.experimentalZoomLevelsToOverscale,this.transformCameraUpdate=d.transformCameraUpdate,this.transformConstrain=d.transformConstrain,this.cancelPendingTileRequestsWhileZooming=d.cancelPendingTileRequestsWhileZooming===!0,d.reduceMotion!==void 0&&(j.prefersReducedMotion=d.reduceMotion),this._imageQueueHandle=ie.addThrottleControl((()=>this.isMoving())),this._requestManager=new Me(d.transformRequest),typeof d.container=="string"){if(this._container=document.getElementById(d.container),!this._container)throw new Error(`Container '${d.container}' not found.`)}else{if(!(d.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=d.container}if(d.maxBounds&&this.setMaxBounds(d.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let R=!1;const F=Kh((V=>{this._trackResize&&!this._removed&&(this.resize(V),this.redraw())}),50);this._resizeObserver=new ResizeObserver((V=>{R?F(V):R=!0})),this._resizeObserver.observe(this._container)}this.handlers=new af(this,d),this._hash=d.hash&&new Na(typeof d.hash=="string"&&d.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:d.center,elevation:d.elevation,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch,roll:d.roll}),d.bounds&&(this.resize(),this.fitBounds(d.bounds,s.e({},d.fitBoundsOptions,{duration:0}))));const A=typeof d.style=="string"||((o=(t=d.style)===null||t===void 0?void 0:t.projection)===null||o===void 0?void 0:o.type)!=="globe";this.resize(null,A),this._localIdeographFontFamily=d.localIdeographFontFamily,this._validateStyle=d.validateStyle,d.style&&this.setStyle(d.style,{localIdeographFontFamily:d.localIdeographFontFamily}),d.attributionControl&&this.addControl(new Ya(typeof d.attributionControl=="boolean"?void 0:d.attributionControl)),d.maplibreLogo&&this.addControl(new sf,d.logoPosition),this.on("style.load",(()=>{if(A||this._resizeTransform(),this.transform.unmodified){const R=s.U(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(R)}})),this.on("data",(R=>{this._update(R.dataType==="style"),this.fire(new s.l(`${R.dataType}data`,R))})),this.on("dataloading",(R=>{this.fire(new s.l(`${R.dataType}dataloading`,R))})),this.on("dataabort",(R=>{this.fire(new s.l("sourcedataabort",R))}))}_getMapId(){return this._mapId}setGlobalStateProperty(w,t){return this.style.setGlobalStateProperty(w,t),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(w,t){if(t===void 0&&(t=w.getDefaultPosition?w.getDefaultPosition():"top-right"),!w||!w.onAdd)return this.fire(new s.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const o=w.onAdd(this);this._controls.push(w);const d=this._controlPositions[t];return t.indexOf("bottom")!==-1?d.insertBefore(o,d.firstChild):d.appendChild(o),this}removeControl(w){if(!w||!w.onRemove)return this.fire(new s.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(w);return t>-1&&this._controls.splice(t,1),w.onRemove(this),this}hasControl(w){return this._controls.indexOf(w)>-1}coveringTiles(w){return va(this.transform,w)}calculateCameraOptionsFromTo(w,t,o,d){return d==null&&this.terrain&&(d=this.terrain.getElevationForLngLat(o,this.transform)),super.calculateCameraOptionsFromTo(w,t,o,d)}resize(w,t=!0){const[o,d]=this._containerDimensions(),x=this._getClampedPixelRatio(o,d);if(this._resizeCanvas(o,d,x),this.painter.resize(o,d,x),this.painter.overLimit()){const A=this.painter.context.gl;this._maxCanvasSize=[A.drawingBufferWidth,A.drawingBufferHeight];const R=this._getClampedPixelRatio(o,d);this._resizeCanvas(o,d,R),this.painter.resize(o,d,R)}this._resizeTransform(t);const S=!this._moving;return S&&(this.stop(),this.fire(new s.l("movestart",w)).fire(new s.l("move",w))),this.fire(new s.l("resize",w)),S&&this.fire(new s.l("moveend",w)),this}_resizeTransform(w=!0){var t;const[o,d]=this._containerDimensions();this.transform.resize(o,d,w),(t=this._requestedCameraState)===null||t===void 0||t.resize(o,d,w)}_getClampedPixelRatio(w,t){const{0:o,1:d}=this._maxCanvasSize,x=this.getPixelRatio(),S=w*x,A=t*x;return Math.min(S>o?o/S:1,A>d?d/A:1)*x}getPixelRatio(){var w;return(w=this._overridePixelRatio)!==null&&w!==void 0?w:devicePixelRatio}setPixelRatio(w){this._overridePixelRatio=w,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(w){return this.transform.setMaxBounds(Ee.convert(w)),this._update()}setMinZoom(w){if((w=w??-2)>=-2&&w<=this.transform.maxZoom){const t=this._getTransformForUpdate();return t.setMinZoom(w),this._applyUpdatedTransform(t),this._update(),this}throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(w){if((w=w??22)>=this.transform.minZoom){const t=this._getTransformForUpdate();return t.setMaxZoom(w),this._applyUpdatedTransform(t),this._update(),this}throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(w){if((w=w??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(w>=0&&w<=this.transform.maxPitch)return this.transform.setMinPitch(w),this._update(),this.getPitch()<w&&this.setPitch(w),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(w){if((w=w??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(w>=this.transform.minPitch)return this.transform.setMaxPitch(w),this._update(),this.getPitch()>w&&this.setPitch(w),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(w){return this.transform.setRenderWorldCopies(w),this._update()}setTransformConstrain(w){return this.transform.setConstrainOverride(w),this._update()}project(w){return this.transform.locationToScreenPoint(s.V.convert(w),this.style&&this.terrain)}unproject(w){return this.transform.screenPointToLocation(s.P.convert(w),this.terrain)}isMoving(){var w;return this._moving||((w=this.handlers)===null||w===void 0?void 0:w.isMoving())}isZooming(){var w;return this._zooming||((w=this.handlers)===null||w===void 0?void 0:w.isZooming())}isRotating(){var w;return this._rotating||((w=this.handlers)===null||w===void 0?void 0:w.isRotating())}_createDelegatedListener(w,t,o){if(w==="mouseenter"||w==="mouseover"){let d=!1;return{layers:t,listener:o,delegates:{mousemove:S=>{const A=t.filter((F=>this.getLayer(F))),R=A.length!==0?this.queryRenderedFeatures(S.point,{layers:A}):[];R.length?d||(d=!0,o.call(this,new Ci(w,this,S.originalEvent,{features:R}))):d=!1},mouseout:()=>{d=!1}}}}if(w==="mouseleave"||w==="mouseout"){let d=!1;return{layers:t,listener:o,delegates:{mousemove:A=>{const R=t.filter((F=>this.getLayer(F)));(R.length!==0?this.queryRenderedFeatures(A.point,{layers:R}):[]).length?d=!0:d&&(d=!1,o.call(this,new Ci(w,this,A.originalEvent)))},mouseout:A=>{d&&(d=!1,o.call(this,new Ci(w,this,A.originalEvent)))}}}}{const d=x=>{const S=t.filter((R=>this.getLayer(R))),A=S.length!==0?this.queryRenderedFeatures(x.point,{layers:S}):[];A.length&&(x.features=A,o.call(this,x),delete x.features)};return{layers:t,listener:o,delegates:{[w]:d}}}}_saveDelegatedListener(w,t){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[w]=this._delegatedListeners[w]||[],this._delegatedListeners[w].push(t)}_removeDelegatedListener(w,t,o){if(!this._delegatedListeners||!this._delegatedListeners[w])return;const d=this._delegatedListeners[w];for(let x=0;x<d.length;x++){const S=d[x];if(S.listener===o&&S.layers.length===t.length&&S.layers.every((A=>t.includes(A)))){for(const A in S.delegates)this.off(A,S.delegates[A]);return void d.splice(x,1)}}}on(w,t,o){if(o===void 0)return super.on(w,t);const d=typeof t=="string"?[t]:t,x=this._createDelegatedListener(w,d,o);this._saveDelegatedListener(w,x);for(const S in x.delegates)this.on(S,x.delegates[S]);return{unsubscribe:()=>{this._removeDelegatedListener(w,d,o)}}}once(w,t,o){if(o===void 0)return super.once(w,t);const d=typeof t=="string"?[t]:t,x=this._createDelegatedListener(w,d,o);for(const S in x.delegates){const A=x.delegates[S];x.delegates[S]=(...R)=>{this._removeDelegatedListener(w,d,o),A(...R)}}this._saveDelegatedListener(w,x);for(const S in x.delegates)this.once(S,x.delegates[S]);return this}off(w,t,o){return o===void 0?super.off(w,t):(this._removeDelegatedListener(w,typeof t=="string"?[t]:t,o),this)}queryRenderedFeatures(w,t){if(!this.style)return[];let o;const d=w instanceof s.P||Array.isArray(w),x=d?w:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(d?{}:w)||{},x instanceof s.P||typeof x[0]=="number")o=[s.P.convert(x)];else{const S=s.P.convert(x[0]),A=s.P.convert(x[1]);o=[S,new s.P(A.x,S.y),A,new s.P(S.x,A.y),S]}return this.style.queryRenderedFeatures(o,t,this.transform)}querySourceFeatures(w,t){return this.style.querySourceFeatures(w,t)}setStyle(w,t){return(t=s.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&w?(this._diffStyle(w,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(w,t))}setTransformRequest(w){return this._requestManager.setTransformRequest(w),this}_getUIString(w){const t=this._locale[w];if(t==null)throw new Error(`Missing UI string '${w}'`);return t}_updateStyle(w,t){var o,d;if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(w,t)));const x=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!w)),w?(this.style=new eo(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof w=="string"?this.style.loadURL(w,t,x):this.style.loadJSON(w,t,x),this):((d=(o=this.style)===null||o===void 0?void 0:o.projection)===null||d===void 0||d.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new eo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(w,t){if(typeof w=="string"){const o=this._requestManager.transformRequest(w,"Style");s.j(o,new AbortController).then((d=>{this._updateDiff(d.data,t)})).catch((d=>{d&&this.fire(new s.k(d))}))}else typeof w=="object"&&this._updateDiff(w,t)}_updateDiff(w,t){try{this.style.setState(w,t)&&this._update(!0)}catch(o){s.w(`Unable to perform style diff: ${o.message||o.error||o}.  Rebuilding the style from scratch.`),this._updateStyle(w,t)}}getStyle(){if(this.style)return this.style.serialize()}_getStyleAndImages(){return this.style?{style:this.style.serialize(),images:this.style.imageManager.cloneImages()}:{style:null,images:{}}}isStyleLoaded(){return this.style?this.style.loaded():s.w("There is no style added to the map.")}addSource(w,t){return this._lazyInitEmptyStyle(),this.style.addSource(w,t),this._update(!0)}isSourceLoaded(w){const t=this.style&&this.style.tileManagers[w];if(t!==void 0)return t.loaded();this.fire(new s.k(new Error(`There is no tile manager with ID '${w}'`)))}setTerrain(w){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),w){const t=this.style.tileManagers[w.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${w.source}`);this.terrain===null&&t.reload();for(const o in this.style._layers){const d=this.style._layers[o];d.type==="hillshade"&&d.source===w.source&&s.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),d.type==="color-relief"&&d.source===w.source&&s.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new wn(this.painter,t,w),this.painter.renderToTexture=new ll(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=o=>{var d;o.dataType==="style"?this.terrain.tileManager.freeRtt():o.dataType==="source"&&o.tile&&(o.sourceId!==w.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((d=o.source)===null||d===void 0?void 0:d.type)==="image"?this.terrain.tileManager.freeRtt():this.terrain.tileManager.freeRtt(o.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.tileManager.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new s.l("terrain",{terrain:w})),this}getTerrain(){var w,t;return(t=(w=this.terrain)===null||w===void 0?void 0:w.options)!==null&&t!==void 0?t:null}areTilesLoaded(){const w=this.style&&this.style.tileManagers;for(const t of Object.values(w))if(!t.areTilesLoaded())return!1;return!0}removeSource(w){return this.style.removeSource(w),this._update(!0)}getSource(w){return this.style.getSource(w)}setSourceTileLodParams(w,t,o){if(o){const d=this.getSource(o);if(!d)throw new Error(`There is no source with ID "${o}", cannot set LOD parameters`);d.calculateTileZoom=Fn(Math.max(1,w),Math.max(1,t))}else for(const d in this.style.tileManagers)this.style.tileManagers[d].getSource().calculateTileZoom=Fn(Math.max(1,w),Math.max(1,t));return this._update(!0),this}refreshTiles(w,t){const o=this.style.tileManagers[w];if(!o)throw new Error(`There is no tile manager with ID "${w}", cannot refresh tile`);t===void 0?o.reload(!0):o.refreshTiles(t.map((d=>new s.ac(d.z,d.x,d.y))))}addImage(w,t,o={}){const{pixelRatio:d=1,sdf:x=!1,stretchX:S,stretchY:A,content:R,textFitWidth:F,textFitHeight:V}=o;if(this._lazyInitEmptyStyle(),!(t instanceof HTMLImageElement||s.b(t))){if(t.width===void 0||t.height===void 0)return this.fire(new s.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:q,height:te,data:Q}=t,ce=t;return this.style.addImage(w,{data:new s.R({width:q,height:te},new Uint8Array(Q)),pixelRatio:d,stretchX:S,stretchY:A,content:R,textFitWidth:F,textFitHeight:V,sdf:x,version:0,userImage:ce}),ce.onAdd&&ce.onAdd(this,w),this}}{const{width:q,height:te,data:Q}=j.getImageData(t);this.style.addImage(w,{data:new s.R({width:q,height:te},Q),pixelRatio:d,stretchX:S,stretchY:A,content:R,textFitWidth:F,textFitHeight:V,sdf:x,version:0})}}updateImage(w,t){const o=this.style.getImage(w);if(!o)return this.fire(new s.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const d=t instanceof HTMLImageElement||s.b(t)?j.getImageData(t):t,{width:x,height:S,data:A}=d;if(x===void 0||S===void 0)return this.fire(new s.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(x!==o.data.width||S!==o.data.height)return this.fire(new s.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const R=!(t instanceof HTMLImageElement||s.b(t));return o.data.replace(A,R),this.style.updateImage(w,o),this}getImage(w){return this.style.getImage(w)}hasImage(w){return w?!!this.style.getImage(w):(this.fire(new s.k(new Error("Missing required image id"))),!1)}removeImage(w){this.style.removeImage(w)}loadImage(w){return ie.getImage(this._requestManager.transformRequest(w,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(w,t){return this._lazyInitEmptyStyle(),this.style.addLayer(w,t),this._update(!0)}moveLayer(w,t){return this.style.moveLayer(w,t),this._update(!0)}removeLayer(w){return this.style.removeLayer(w),this._update(!0)}getLayer(w){return this.style.getLayer(w)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(w,t,o){return this.style.setLayerZoomRange(w,t,o),this._update(!0)}setFilter(w,t,o={}){return this.style.setFilter(w,t,o),this._update(!0)}getFilter(w){return this.style.getFilter(w)}setPaintProperty(w,t,o,d={}){return this.style.setPaintProperty(w,t,o,d),this._update(!0)}getPaintProperty(w,t){return this.style.getPaintProperty(w,t)}setLayoutProperty(w,t,o,d={}){return this.style.setLayoutProperty(w,t,o,d),this._update(!0)}getLayoutProperty(w,t){return this.style.getLayoutProperty(w,t)}setGlyphs(w,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(w,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(w,t,o={}){return this._lazyInitEmptyStyle(),this.style.addSprite(w,t,o,(d=>{d||this._update(!0)})),this}removeSprite(w){return this._lazyInitEmptyStyle(),this.style.removeSprite(w),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(w,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(w,t,(o=>{o||this._update(!0)})),this}setLight(w,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(w,t),this._update(!0)}getLight(){return this.style.getLight()}setSky(w,t={}){return this._lazyInitEmptyStyle(),this.style.setSky(w,t),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(w,t){return this.style.setFeatureState(w,t),this._update()}removeFeatureState(w,t){return this.style.removeFeatureState(w,t),this._update()}getFeatureState(w){return this.style.getFeatureState(w)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let w=0,t=0;return this._container&&(w=this._container.clientWidth||400,t=this._container.clientHeight||300),[w,t]}_setupContainer(){const w=this._container;w.classList.add("maplibregl-map");const t=this._canvasContainer=N.create("div","maplibregl-canvas-container",w);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=N.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const o=this._containerDimensions(),d=this._getClampedPixelRatio(o[0],o[1]);this._resizeCanvas(o[0],o[1],d);const x=this._controlContainer=N.create("div","maplibregl-control-container",w),S=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((A=>{S[A]=N.create("div",`maplibregl-ctrl-${A} `,x)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(w,t,o){this._canvas.width=Math.floor(o*w),this._canvas.height=Math.floor(o*t),this._canvas.style.width=`${w}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const w=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let t=null;this._canvas.addEventListener("webglcontextcreationerror",(d=>{t={requestedAttributes:w},d&&(t.statusMessage=d.statusMessage,t.type=d.type)}),{once:!0});let o=null;if(o=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,w):this._canvas.getContext("webgl2",w)||this._canvas.getContext("webgl",w),!o){const d="Failed to initialize WebGL";throw t?(t.message=d,new Error(JSON.stringify(t))):new Error(d)}this.painter=new Yh(o,this.transform),Z.testSupport(o)}migrateProjection(w,t){super.migrateProjection(w,t),this.painter.transform=w,this.fire(new s.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(w){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||w,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(w){return this._update(),this._renderTaskQueue.add(w)}_cancelRenderFrame(w){this._renderTaskQueue.remove(w)}_render(w){var t,o,d,x,S;const A=this._idleTriggered?this._fadeDuration:0,R=((t=this.style.projection)===null||t===void 0?void 0:t.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(w),this._removed)return;let F=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const te=this.transform.zoom,Q=z();this.style.zoomHistory.update(te,Q);const ce=new s.H(te,{now:Q,fadeDuration:A,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),_e=ce.crossFadingFactor();_e===1&&_e===this._crossFadingFactor||(F=!0,this._crossFadingFactor=_e),this.style.update(ce)}const V=((o=this.style.projection)===null||o===void 0?void 0:o.transitionState)>0!==R;(d=this.style.projection)===null||d===void 0||d.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((x=this.style.projection)===null||x===void 0?void 0:x.transitionState,(S=this.style.projection)===null||S===void 0?void 0:S.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||V)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.tileManager.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,A,this._crossSourceCollisions,V),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:A,showPadding:this.showPadding}),this.fire(new s.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,s.cG.mark(s.cH.load),this.fire(new s.l("load"))),this.style&&(this.style.hasTransitions()||F)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const q=this._sourcesDirty||this._styleDirty||this._placementDirty;return q||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new s.l("idle")),!this._loaded||this._fullyLoaded||q||(this._fullyLoaded=!0,s.cG.mark(s.cH.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var w;this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),ie.removeThrottleControl(this._imageQueueHandle),(w=this._resizeObserver)===null||w===void 0||w.disconnect();const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t?.loseContext&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),N.remove(this._canvasContainer),N.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),s.cG.clearMetrics(),this._removed=!0,this.fire(new s.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,j.frame(this._frameRequest,(w=>{s.cG.frame(w),this._frameRequest=null;try{this._render(w)}catch(t){if(!s.Z(t)&&!(function(o){return o.message===Ur})(t))throw t}}),(()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(w){this._showTileBoundaries!==w&&(this._showTileBoundaries=w,this._update())}get showPadding(){return!!this._showPadding}set showPadding(w){this._showPadding!==w&&(this._showPadding=w,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(w){this._showCollisionBoxes!==w&&(this._showCollisionBoxes=w,w?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(w){this._showOverdrawInspector!==w&&(this._showOverdrawInspector=w,this._update())}get repaint(){return!!this._repaint}set repaint(w){this._repaint!==w&&(this._repaint=w,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(w){this._vertices=w,this._update()}get version(){return Ru}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(w){return this._lazyInitEmptyStyle(),this.style.setProjection(w),this._update(!0)}},_.MapMouseEvent=Ci,_.MapTouchEvent=il,_.MapWheelEvent=Lf,_.Marker=lf,_.NavigationControl=class{constructor(w){this._updateZoomButtons=()=>{const t=this._map.getZoom(),o=t===this._map.getMaxZoom(),d=t===this._map.getMinZoom();this._zoomInButton.disabled=o,this._zoomOutButton.disabled=d,this._zoomInButton.setAttribute("aria-disabled",o.toString()),this._zoomOutButton.setAttribute("aria-disabled",d.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(t,o)=>{const d=this._map._getUIString(`NavigationControl.${o}`);t.title=d,t.setAttribute("aria-label",d)},this.options=s.e({},Md,w),this._container=N.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(t=>this._map.zoomIn({},{originalEvent:t}))),N.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(t=>this._map.zoomOut({},{originalEvent:t}))),N.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})})),this._compassIcon=N.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(w){return this._map=w,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ka(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){N.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(w,t){const o=N.create("button",w,this._container);return o.type="button",o.addEventListener("click",t),o}},_.Popup=class extends s.E{constructor(w){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&N.remove(this._content),this._container&&(N.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new s.l("close"))),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=N.create("div","maplibregl-popup",this._map.getContainer()),this._tip=N.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const A of this.options.className.split(" "))this._container.classList.add(A);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=yh(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!t)return;const o=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationToScreenPoint(this._lngLat));let d=this.options.anchor;const x=bh(this.options.offset);if(!d){const A=this._container.offsetWidth,R=this._container.offsetHeight;let F;F=o.y+x.bottom.y<R?["top"]:o.y>this._map.transform.height-R?["bottom"]:[],o.x<A/2?F.push("left"):o.x>this._map.transform.width-A/2&&F.push("right"),d=F.length===0?"bottom":F.join("-")}let S=o.add(x[d]);this.options.subpixelPositioning||(S=S.round()),N.setTransform(this._container,`${vh[d]} translate(${S.x}px,${S.y}px)`),of(this._container,d,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=s.e(Object.create(Iu),w)}addTo(w){return this._map&&this.remove(),this._map=w,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new s.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(w){return this._lngLat=s.V.convert(w),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(w){return this.setDOMContent(document.createTextNode(w))}setHTML(w){const t=document.createDocumentFragment(),o=document.createElement("body");let d;for(o.innerHTML=w;d=o.firstChild,d;)t.appendChild(d);return this.setDOMContent(t)}getMaxWidth(){var w;return(w=this._container)===null||w===void 0?void 0:w.style.maxWidth}setMaxWidth(w){return this.options.maxWidth=w,this._update(),this}setDOMContent(w){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=N.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(w),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(w){return this._container&&this._container.classList.add(w),this}removeClassName(w){return this._container&&this._container.classList.remove(w),this}setOffset(w){return this.options.offset=w,this._update(),this}toggleClassName(w){if(this._container)return this._container.classList.toggle(w)}setSubpixelPositioning(w){this.options.subpixelPositioning=w}_createCloseButton(){this.options.closeButton&&(this._closeButton=N.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const w=this._container.querySelector(Pu);w&&w.focus()}},_.RasterDEMTileSource=Jt,_.RasterTileSource=Kt,_.ScaleControl=class{constructor(w){this._onMove=()=>{Pa(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,Pa(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},ts),w)}getDefaultPosition(){return"bottom-left"}onAdd(w){return this._map=w,this._container=N.create("div","maplibregl-ctrl maplibregl-ctrl-scale",w.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){N.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},_.ScrollZoomHandler=rf,_.Style=eo,_.TerrainControl=class{constructor(w){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=w}onAdd(w){return this._map=w,this._container=N.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=N.create("button","maplibregl-ctrl-terrain",this._container),N.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){N.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},_.TwoFingersTouchPitchHandler=mc,_.TwoFingersTouchRotateHandler=tf,_.TwoFingersTouchZoomHandler=Vl,_.TwoFingersTouchZoomRotateHandler=Mu,_.VectorTileSource=dt,_.VideoSource=st,_.addSourceType=(w,t)=>s._(void 0,void 0,void 0,(function*(){if(ye(w))throw new Error(`A source type called "${w}" already exists.`);((o,d)=>{ue[o]=d})(w,t)})),_.clearPrewarmedResources=function(){const w=Vt;w&&(w.isPreloaded()&&w.numActive()===1?(w.release(Pe),Vt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},_.createTileMesh=oh,_.getMaxParallelImageRequests=function(){return s.c.MAX_PARALLEL_IMAGE_REQUESTS},_.getRTLTextPluginStatus=function(){return lt().getRTLTextPluginStatus()},_.getVersion=function(){return ul},_.getWorkerCount=function(){return De.workerCount},_.getWorkerUrl=function(){return s.c.WORKER_URL},_.importScriptInWorkers=function(w){return jr().broadcast("IS",w)},_.isTimeFrozen=function(){return H.isFrozen()},_.now=z,_.prewarm=function(){jt().acquire(Pe)},_.restoreNow=function(){H.restoreNow()},_.setMaxParallelImageRequests=function(w){s.c.MAX_PARALLEL_IMAGE_REQUESTS=w},_.setNow=function(w){H.setNow(w)},_.setRTLTextPlugin=function(w,t){return lt().setRTLTextPlugin(w,t)},_.setWorkerCount=function(w){De.workerCount=w},_.setWorkerUrl=function(w){s.c.WORKER_URL=w}}));var b=l;return b}))})(gx)),gx.exports}var ZD=qD();const H0=Fx(ZD);function fb(r){return(r||"scenario").trim().replace(/[\\/:*?"<>|]+/g,"-").replace(/\s+/g,"_").slice(0,80)||"scenario"}function WD(r){const u={...r,vizConfig:[{key:"speedScore",label:"",desc:" ",color:"#3B82F6"},{key:"economyScore",label:"",desc:"  ",color:"#F59E0B"},{key:"scenicScore",label:"",desc:"  ",color:"#22C55E"},{key:"commScore",label:"",desc:"  ",color:"#A855F7"}],colors:{routePalette:{A:"#3B82F6",B:"#F59E0B",C:"#A855F7"},routeSelected:"#1E4ED8",routeRegular:"#8CCBFF",traffic:"#FF0022",toll:"#FFE100",comm:{fill:"rgba(170,60,255,0.28)",outline:"rgba(170,60,255,0.65)"},parks:{fill:"#00FF66",outline:"transparent",opacity:.95}}},l=JSON.stringify(u);return`<!doctype html>
<html lang="he" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>${String(r.scenarioName).replace(/</g,"&lt;")}</title>
<style>
  /* GLOBAL FONT RESET - STRICT ARIAL */
  * { box-sizing: border-box; user-select: none; font-family: Arial, sans-serif !important; }
  html, body { height: 100%; margin: 0; background: #0b0f17; color: #e8eefc; overflow: hidden; font-size: 14px; }

  .root { height: 100%; display: flex; flex-direction: column; gap: 8px; padding: 8px; }
  
  /* Shared Panel Style */
  .panel { 
      border: 1px solid rgba(255,255,255,0.12); 
      background: rgba(11,15,23,0.95); 
      box-shadow: 0 4px 12px rgba(0,0,0,0.4); 
      border-radius: 8px; 
  }

  .top { flex: 1; min-height: 0; display: flex; gap: 8px; direction: ltr; }

  /* Map Panel */
  .mapPanel { flex: 1; min-width: 0; position: relative; overflow: hidden; background: #000; }
  #mapStage { position: absolute; left: 0; top: 0; transform-origin: 0 0; touch-action: none; will-change: transform; }
  #baseImg { display: block; pointer-events: none; }
  #overlaySvg { position: absolute; left: 0; top: 0; width: 100%; height: 100%; pointer-events: auto; }

  .ctrlCol { position: absolute; left: 10px; top: 10px; display: flex; flex-direction: column; gap: 6px; z-index: 10; }
  
  .ctrlBtn, .filterBtn { 
      width: 40px; height: 40px; 
      border-radius: 8px; 
      border: 1px solid rgba(255,255,255,0.2); 
      background: rgba(15,23,42,0.9); 
      color: white; cursor: pointer; 
      display: flex; align-items: center; justify-content: center; 
      transition: all 0.1s; 
  }
  .ctrlBtn:hover, .filterBtn:hover { background: rgba(255,255,255,0.1); }
  .ctrlBtn svg, .filterBtn svg { width: 20px; height: 20px; fill: none; stroke: currentColor; stroke-width: 2; }

  .filterBtn { position: absolute; left: 10px; bottom: 10px; z-index: 20; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
  .filterBtn.has-active::after { 
      content: ""; position: absolute; top: 6px; right: 6px; 
      width: 8px; height: 8px; background: #F59E0B; 
      border-radius: 50%; border: 1px solid #1e293b;
  }

  .mapLegend { position: absolute; right: 10px; bottom: 10px; padding: 10px; width: 140px; direction: rtl; text-align: right; pointer-events: none; z-index: 15; font-size: 14px; }
  .legRow { display: flex; align-items: center; gap: 8px; margin-bottom: 5px; }
  .legLine { width: 24px; height: 3px; border-radius: 1px; }

  /* Task Panel */
  .taskPanel {font-family: Arial, sans-serif; width: 430px; max-width: 40%; display: flex; flex-direction: column; gap: 12px; padding: 16px; direction: rtl; text-align: right; overflow-y: auto; }
  .h { font-weight: 700; font-size: 24px; color: #fff; margin-bottom: 4px; }
  .muted { font-size: 20px; opacity: 0.8; line-height: 1.5; white-space: pre-wrap; }
  .sep { height: 1px; background: rgba(255,255,255,0.1); margin: 4px 0; }
  
  .recBox { 
      background: rgba(59,130,246,0.15); 
      border: 1px solid rgba(59,130,246,0.4); 
      padding: 12px 16px; 
      border-radius: 8px; 
      display: flex; 
      justify-content: space-between; 
      align-items: center;
      font-family: Arial, sans-serif !important;
  }
  .recLabel { font-size: 20px !important; font-weight: normal; color: #e8eefc; }
  .recVal { font-family: Arial, sans-serif !important; font-size: 20px !important; font-weight: 800; color: #60A5FA; }

  .btnPrimary { width: 100%; padding: 14px; background: #2563EB; color: white; border: none; border-radius: 8px; font-size: 20px; font-weight: 700; cursor: pointer; margin-top: auto; }
  .btnPrimary:hover { background: #1D4ED8; }

  /* Bottom Panel Layout - RTL */
  .bottom { height: 260px; display: flex; gap: 8px; direction: rtl; }
  
  /* 1. GANTT PANEL (Rightmost) */
  .ganttPanel { 
      width: 38%; 
      min-width: 320px; 
      padding: 12px; 
      direction: rtl; 
      display: flex; 
      flex-direction: column; 
  }

  /* 2. VIZ PANEL (Center) */
  .vizPanel { 
      flex: 1; 
      padding: 12px; 
      direction: rtl; 
      overflow: hidden; 
      display: flex; 
      flex-direction: column; 
  }

  /* 3. LEGEND PANEL (Leftmost) */
  .legendPanel { 
      width: 190px; 
      padding: 12px; 
      display: flex; 
      flex-direction: column; 
      justify-content: flex-start; 
      direction: rtl; 
      overflow-y: auto; 
  }
  .legItem { margin-bottom: 12px; display: flex; align-items: flex-start; gap: 8px; }
  .legColorBox { width: 14px; height: 14px; margin-top: 3px; border-radius: 3px; flex-shrink: 0; }
  .legContent { display: flex; flex-direction: column; font-family: Arial !important;}
  .legTitle { font-weight: 800; font-size: 14px; font-family: Arial !important;}
  .legDesc { font-size: 12px; opacity: 0.7; margin-top: 2px; font-family: Arial !important;}

  /* Viz Container inside Panel */
  #viz-container {
    width: 100%;
    height: 100%;
    overflow: hidden;
    box-sizing: border-box;
    border: 2px solid #3B82F6; 
    background: rgba(255, 255, 255, 0.02);
    border-radius: 8px; 
    padding: 10px;
    display: flex;
    flex-direction: column;
    position: relative;
  }
  
  .viz-headers-row {
      display: flex; width: 100%; margin-bottom: 8px; padding-bottom: 6px;
      border-bottom: 1px solid rgba(255,255,255,0.1);
  }
  .viz-header-item {
      flex: 1; text-align: center; font-weight: bold; font-size: 13px; color: #cbd5e1;
      display: flex; align-items: center; justify-content: center; gap: 6px;
  }

  /* Heatmap - Fixed Column Width Logic */
  .heatmap-table { width: 100%; height: 100%; border-collapse: collapse; table-layout: fixed; }
  
  /* Force fixed width on first column, let others flex */
  .heatmap-table th:first-child, 
  .heatmap-table td:first-child { 
      width: 90px; /* Fixed narrow width */
      max-width: 90px;
      padding-left: 4px; 
      text-align: right !important; 
      white-space: nowrap;
  }
  
  .heatmap-table th { padding-bottom: 6px; text-align: center; vertical-align: bottom; }
  .heatmap-table td { border-bottom: 1px solid rgba(255,255,255,0.1); }
  
  .heatmap-cell { 
      text-align: center; vertical-align: middle; 
      color: #fff; font-weight: 900; font-size: 15px;
      text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000, 0 0 5px rgba(0,0,0,0.8);
      margin: 2px; border-radius: 4px; height: 100%;
  }
  .heatmap-table td > div { height: 85%; width: 92%; margin: 0 auto; display:flex; align-items:center; justify-content:center; border-radius:4px; }
  .segment-badge {
      display: inline-block; width: 20px; height: 20px; line-height: 20px;
      border-radius: 50%; background-color: #1E4ED8; color: white; text-align: center; font-weight: bold; font-size: 11px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.3);
  }

  /* Stacked Bars */
  .stacked-wrapper { display: flex; width: 100%; height: 100%; align-items: flex-end; }
  .stacked-col-container { flex: 1; height: 100%; display: flex; flex-direction: column; justify-content: flex-end; align-items: center; padding: 0 10px; }
  .stacked-bar { width: 60%; display: flex; flex-direction: column-reverse; border-radius: 4px 4px 0 0; overflow: hidden; background: rgba(255,255,255,0.05); }
  .stack-segment { width: 100%; position: relative; border-top: 1px solid rgba(255,255,255,0.2); overflow: visible !important; box-sizing: border-box; }
  .stack-label { position: absolute; top: 50%; left: 0; right: 0; transform: translateY(-50%); text-align: center; color: white; font-weight: bold; font-size: 11px; text-shadow: 0 1px 3px rgba(0,0,0,0.9), 0 0 2px black; white-space: nowrap; pointer-events: none; display: flex; align-items: center; justify-content: center; gap: 4px; }

  /* Radar */
  .radar-wrapper { display: flex; width: 100%; height: 100%; align-items: center; justify-content: space-around; direction: rtl; }
  .radar-chart { 
      position: relative; flex: 1; height: 100%; 
      display: flex; flex-direction: column; align-items: center; justify-content: center; 
  }
  .radar-badge-corner { position: absolute; top: 5px; right: 10px; z-index: 10; display:flex; align-items:center; gap:6px; font-weight:bold; font-size:12px; color:#ddd; }

  /* Gantt Styles */
  .ganttScroll { 
      flex: 1; 
      overflow-y: auto; 
      overflow-x: hidden; 
      padding-left: 0; 
      padding-right: 4px;
      direction: rtl; 
  }
  
  .ganttRow { 
      display: flex; align-items: center; height: 42px; margin-bottom: 10px; 
      cursor: pointer; transition: 0.1s; 
      border-radius: 6px; border: 1px solid transparent; 
      position: relative; 
      margin-left: 4px; 
  }
  .ganttRow:hover { background: rgba(255,255,255,0.05); }
  
  .ganttRow.active { 
      background: rgba(59,130,246,0.2); 
      border: 2px solid #3B82F6; 
      box-shadow: inset 0 0 10px rgba(59,130,246,0.3);
  }

  .gLabel { width: 60px; font-weight: 700; font-size: 14px; }
  .gTrackContainer { flex: 1; height: 28px; position: relative; background: rgba(255,255,255,0.1); border-radius: 4px; overflow: hidden; }
  .gBar { height: 100%; position: absolute; right: 0; top: 0; bottom: 0; border-radius: 4px; overflow: hidden; direction: rtl; display: flex; }
  .gSeg { height: 100%; flex-shrink: 0; display: flex; align-items: center; justify-content: center; font-size: 13px; font-weight: 900; color: #000; background: #8CCBFF; border-left: 3px solid #000; box-sizing: border-box; }
  .gSeg:last-child { border-left: none; }
  .gAxis { position: relative; height: 20px; margin-top: 4px; border-top: 1px solid rgba(255,255,255,0.1); margin-right: 60px; direction: ltr; }

  /* Modals */
  .backdrop { position: fixed; inset: 0; background: rgba(0,0,0,0.6); display: none; align-items: center; justify-content: center; z-index: 9999; backdrop-filter: blur(2px); }
  .backdrop.show { display: flex; }
  .modal { background: #1b1b1c; border: 1px solid #334155; width: 400px; max-width: 90%; padding: 20px; border-radius: 12px; text-align: center; direction: rtl; box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.5); }
  .modalBtns { display: flex; gap: 10px; margin-top: 20px; justify-content: center; }
  .mBtn { padding: 10px 20px; border-radius: 6px; cursor: pointer; border: none; font-weight: 700; flex:1; }
  .mBtn.yes { background: #2563EB; color: white; }
  .mBtn.no { background: rgba(255,255,255,0.1); color: white; }
  .filterRow { display: flex; justify-content: space-between; align-items: center; padding: 10px; border-bottom: 1px solid rgba(255,255,255,0.1); }
  .eyeBtn { background: none; border: none; color: white; cursor: pointer; opacity: 0.7; display:flex; align-items:center; gap:4px; }
  .eyeBtn.on { opacity: 1; color: #60A5FA; }
  /* ---     (/) --- */
            /* ---      --- */
            
            /* 1.     -   */
            div.maplibregl-ctrl-group {
                background: #ffffff !important;
                border: 1px solid #ccc !important;
                box-shadow: 0 1px 2px rgba(0,0,0,0.1) !important;
                opacity: 1 !important;
            }

            /* 2.   -   */
            div.maplibregl-ctrl-group button {
                background: #ffffff !important; /*  -background  */
                opacity: 1 !important;
                border: 0 !important;
                border-bottom: 1px solid #ddd !important;
                transition: none !important; /*    */
                cursor: pointer !important;
            }
            
            /*      */
            div.maplibregl-ctrl-group button:last-child {
                border-bottom: 0 !important;
            }

            /* 3.  HOVER -     */
            div.maplibregl-ctrl-group button:hover {
                background: #cccccc !important;
                opacity: 1 !important;
            }

            /* 4.  (/) -   */
            .maplibregl-ctrl-icon, 
            div.maplibregl-ctrl-group button span {
                filter: grayscale(100%) brightness(0) !important; /*    */
                opacity: 1 !important;
                background-color: transparent !important; /*      */
            }
</style>
</head>
<body>

<div class="root">
  <div class="top">
    <div class="mapPanel panel">
      <div id="mapStage">
        <img id="baseImg" draggable="false" />
        <svg id="overlaySvg"></svg>
      </div>

      <div class="ctrlCol">
        <button class="ctrlBtn" id="zoomIn" title=" "><svg viewBox="0 0 24 24"><path d="M12 5v14M5 12h14"/></svg></button>
        <button class="ctrlBtn" id="fitView" title=" "><svg viewBox="0 0 24 24"><path d="M4 4h16v16H4zM8 8h8v8H8z"/></svg></button>
        <button class="ctrlBtn" id="zoomOut" title=" "><svg viewBox="0 0 24 24"><path d="M5 12h14"/></svg></button>
      </div>

      <button class="filterBtn" id="openFilter" title="">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="12 2 2 7 12 12 22 7 12 2"></polygon><polyline points="2 17 12 22 22 17"></polyline><polyline points="2 12 12 17 22 12"></polyline></svg>
      </button>

      <div class="mapLegend panel">
        <div style="font-weight:700; margin-bottom:8px; opacity:0.9"> </div>
        <div class="legRow"><div class="legLine" style="background:#8CCBFF"></div><span></span></div>
        <div class="legRow"><div class="legLine" style="background:#1E4ED8"></div><span> </span></div>
        <div class="legRow"><div class="legLine" style="border-top:3px dashed #FF0022; height:0"></div><span></span></div>
       <div class="legRow">
           <div style="width:24px; position:relative; height:12px; display:flex; align-items:center; justify-content:center">
           
             <div style="position:absolute; top:0; width:100%; height:2px; background:#FFE100"></div>
             <div style="position:absolute; bottom:0; width:100%; height:2px; background:#FFE100"></div>
             
             <div style="width:14px; height:14px; background:#FFE100; border:1px solid rgba(0,0,0,0.7); border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:10px; font-weight:700; color:#000; position:absolute; z-index:5; font-family:Arial, sans-serif;"></div>
           </div>
           <span></span>
        </div>
        <div class="legRow"><div style="width:12px; height:12px; background:rgba(170,60,255,0.4); border:1px solid #A855F7; border-radius:50%"></div><span></span></div>
        <div class="legRow"><div style="width:16px; height:10px; background:#00FF66; opacity:0.7"></div><span></span></div>
      </div>
    </div>

    <div class="taskPanel panel">
      <div class="h"></div>
      <div class="muted" id="taskText"></div>
      <div class="muted" id="requirementsText" style="font-weight:900; margin-top:8px; display:none; font-size:24px; font-family: Arial !important, sans-serif !important"></div>
      <div class="sep"></div>
      <div class="recBox">
        <div class="recLabel"> </div>
        <div class="recVal" id="recRoute" style= "font-size:20px; font-family: Arial !important"></div>
      </div>
      <div style="font-size:12px; margin-top:4px; opacity:0.8; margin-right:20px">       (   //).</div>
      
      <div class="sep"></div>
      <div style="display:flex; justify-content:space-between; align-items:center; font-weight:700">
        <span style="font-size:20px; margin-right:20px"> :</span>
        <span id="pickedDisplay" style="font-size:20px; color:#60A5FA; margin-left:18px"></span>
      </div>
      <button class="btnPrimary" id="submitBtn"> </button>
    </div>
  </div>

  <div class="bottom">
    <div class="ganttPanel panel">
         <div class="h" style="font-size:14px; margin-bottom:10px">  ()</div>
         <div id="ganttContainer" class="ganttScroll"></div>
         <div id="ganttAxis" class="gAxis"></div>
    </div>

    <div class="vizPanel panel">
         <div id="viz-container"></div>
    </div>

    <div class="legendPanel panel">
      <div class="h" style="font-size:14px; margin-bottom:12px"> </div>
      <div id="vizLegendContent"></div>
    </div>
  </div>
</div>

<div class="backdrop" id="filterModal">
  <div class="modal" style="width:320px">
    <div class="h"> </div>
    <div style="margin:15px 0; display:flex; gap:10px; justify-content:center">
        <button id="showAll" class="eyeBtn on" style="font-size:12px; border:1px solid #555; padding:6px 12px; border-radius:4px"> </button>
        <button id="hideAll" class="eyeBtn" style="font-size:12px; border:1px solid #555; padding:6px 12px; border-radius:4px"> </button>
    </div>
    <div id="filterList" style="text-align:right"></div>
    <div style="margin-top:20px">
        <button class="mBtn no" id="closeFilter"></button>
    </div>
  </div>
</div>

<div class="backdrop" id="confirmModal">
  <div class="modal">
    <div class="h" style="font-size:18px; margin-bottom:10px"> </div>
    <p id="confirmText" style="margin-bottom:20px; font-size:16px"></p>
    <div id="confirmWarning" style="background:rgba(245,158,11,0.2); color:#FCD34D; padding:10px; border-radius:6px; margin-bottom:20px; display:none; font-size:14px; border:1px solid rgba(245,158,11,0.4)">
         :     .
    </div>
    <div class="modalBtns">
      <button class="mBtn yes" id="doConfirm">,  </button>
      <button class="mBtn no" id="cancelConfirm"></button>
    </div>
  </div>
</div>

<script>
const DATA = ${l};
let scale = 1, pan = {x: 0, y: 0}, picked = DATA.recommendedRoute || 'A';
let filters = { routes: true, traffic: true, toll: true, comm: true, parks: true };

const els = {
    mapPanel: document.querySelector('.mapPanel'), 
    mapStage: document.getElementById('mapStage'),
    baseImg: document.getElementById('baseImg'),
    svg: document.getElementById('overlaySvg'),
    taskText: document.getElementById('taskText'),
    requirementsText: document.getElementById('requirementsText'),
    recRoute: document.getElementById('recRoute'),
    pickedDisplay: document.getElementById('pickedDisplay'),
    vizContainer: document.getElementById('viz-container'),
    vizLegend: document.getElementById('vizLegendContent'),
    gantt: document.getElementById('ganttContainer'),
    gAxis: document.getElementById('ganttAxis'),
    filterBtn: document.getElementById('openFilter'),
    filterList: document.getElementById('filterList'),
    confirmText: document.getElementById('confirmText'),
    confirmWarn: document.getElementById('confirmWarning')
};

// Init Legend
DATA.vizConfig.forEach(c => {
    const row = document.createElement('div');
    row.className = 'legItem';
    row.innerHTML = '<div class="legColorBox" style="background:'+c.color+'"></div>' + 
                    '<div class="legContent"><div class="legTitle">'+c.label+'</div><div class="legDesc">'+c.desc+'</div></div>';
    els.vizLegend.appendChild(row);
});

// Init Map Image
els.baseImg.src = DATA.baseMapDataUrl;
els.baseImg.onload = () => {
    const w = els.baseImg.naturalWidth || DATA.mapView.width;
    const h = els.baseImg.naturalHeight || DATA.mapView.height;
    els.mapStage.style.width = w + 'px';
    els.mapStage.style.height = h + 'px';
    els.svg.setAttribute('viewBox', \`0 0 \${w} \${h}\`);
    updateTransform();
};
if (els.baseImg.complete && els.baseImg.naturalWidth > 0) els.baseImg.onload();

els.taskText.textContent = DATA.taskText;
if (els.requirementsText) {
  const t = String(DATA.requirementsText || '').trim();
  if (t) { els.requirementsText.style.display = 'block'; els.requirementsText.textContent = t; }
}

els.recRoute.textContent = ' ' + heb(DATA.recommendedRoute);

// Projection Helpers
function project(ll) {
    const merc = (lon, lat) => {
        const x = (lon + 180) / 360;
        const sin = Math.sin(lat * Math.PI / 180);
        const y = (0.5 - Math.log((1 + sin) / (1 - sin)) / (4 * Math.PI));
        return { x, y };
    };
    const c = merc(DATA.mapView.center[0], DATA.mapView.center[1]);
    const p = merc(ll[0], ll[1]);
    const worldSize = Math.pow(2, DATA.mapView.zoom) * 512;
    return {
        x: DATA.mapView.width / 2 + (p.x - c.x) * worldSize,
        y: DATA.mapView.height / 2 + (p.y - c.y) * worldSize
    };
}
function heb(id) { return id === 'A' ? '' : id === 'B' ? '' : ''; }

function getTickLine(p1, p2, p3, len) {
    let vx1 = p2.x - p1.x, vy1 = p2.y - p1.y;
    let vx2 = p3.x - p2.x, vy2 = p3.y - p2.y;
    const l1 = Math.hypot(vx1, vy1) || 1;
    const l2 = Math.hypot(vx2, vy2) || 1;
    vx1/=l1; vy1/=l1; vx2/=l2; vy2/=l2;
    let bx = vx1 + vx2, by = vy1 + vy2;
    const bl = Math.hypot(bx, by);
    if(bl < 1e-5) { bx = -vy1; by = vx1; } else { bx/=bl; by/=bl; }
    const nx = -by, ny = bx;
    return [{x: p2.x - nx*len, y: p2.y - ny*len}, {x: p2.x + nx*len, y: p2.y + ny*len}];
}

function getOffsetPath(coords, offsetPx) {
    if(coords.length < 2) return '';
    let d = '';
    for(let i=0; i<coords.length; i++) {
        const curr = project(coords[i]);
        const next = coords[i+1] ? project(coords[i+1]) : null;
        let dx, dy;
        if (next) { dx = next.x - curr.x; dy = next.y - curr.y; } 
        else { dx = curr.x - project(coords[i-1]).x; dy = curr.y - project(coords[i-1]).y; }
        const len = Math.hypot(dx, dy) || 1;
        const nx = -dy/len, ny = dx/len;
        d += (i===0 ? 'M' : 'L') + (curr.x + nx * offsetPx).toFixed(1) + ',' + (curr.y + ny * offsetPx).toFixed(1) + ' ';
    }
    return d;
}

// Drawing Map
// Drawing Map
function drawMap() {
    els.svg.innerHTML = '';
    
    //   (Groups)  
    const gParks = g('gp');       //  ( )
    const gComm = g('gc');        //  ( ,  )
    const gToll = g('gt');        //  ( )
    const gRoutesHalo = g('grh'); //   
    const gRoutes = g('gr');      //  
    const gTraffic = g('gtr');    //  ( )
    const gTollIco = g('gti');    //   
    const gSegs = g('gs');        //   (1, 2, 3)
    const gOver = g('go');        //   (, /)

    //      -Z (   -  )
    //  : gComm      -gRoutes
    els.svg.append(gParks, gComm, gToll, gRoutesHalo, gRoutes, gTraffic, gTollIco, gSegs, gOver);

    //   (Purple Zones)
    if(filters.comm) DATA.catCommZones.forEach(z => gComm.appendChild(mkPoly(z.ring, DATA.colors.comm.fill, DATA.colors.comm.outline)));
    
    //  
    if(filters.parks) DATA.manualParks.forEach(p => gParks.appendChild(mkPoly(p.ring, DATA.colors.parks.fill, DATA.colors.parks.outline)));
    
    //   (   )
    if(filters.toll) DATA.catTollSegs.forEach(seg => {
         const shadow = mkPath(seg.coords, 'rgba(0,0,0,0.35)', 10);
         gToll.appendChild(shadow);

         const p1 = document.createElementNS('http://www.w3.org/2000/svg','path');
         p1.setAttribute('d', getOffsetPath(seg.coords, 3)); 
         p1.setAttribute('stroke', DATA.colors.toll); 
         p1.setAttribute('stroke-width', 2); 
         p1.setAttribute('fill', 'none');
         
         const p2 = document.createElementNS('http://www.w3.org/2000/svg','path');
         p2.setAttribute('d', getOffsetPath(seg.coords, -3)); 
         p2.setAttribute('stroke', DATA.colors.toll); 
         p2.setAttribute('stroke-width', 2); 
         p2.setAttribute('fill', 'none');
         
         gToll.append(p1, p2);
    });

    //  
    if(filters.routes) {
        const routeKeys = ['A', 'B', 'C'].sort((a,b) => a === picked ? 1 : -1);
        
        routeKeys.forEach(rid => {
            const pts = DATA.routes[rid];
            if(!pts) return;
            const isSel = rid === picked;
            const color = isSel ? DATA.colors.routeSelected : DATA.colors.routeRegular;
            
            // Halo (   )
            gRoutesHalo.appendChild(mkPath(pts, 'rgba(0,0,0,0.3)', isSel ? 10 : 8));
            
            //  
            const line = mkPath(pts, color, isSel ? 6 : 5);
            line.style.cursor = 'pointer'; 
            line.onclick = (e) => { e.stopPropagation(); selectRoute(rid); };
            gRoutes.appendChild(line);
            
            //     
            const hit = mkPath(pts, 'transparent', 20);
            hit.style.cursor = 'pointer'; 
            hit.onclick = (e) => { e.stopPropagation(); selectRoute(rid); };
            gRoutes.appendChild(hit);

            //     
            if(isSel) {
                const proj = pts.map(project);
                const total = getPathLen(proj);
                [0.33, 0.66].forEach(f => {
                    const {p, idx} = getPointAtFrac(proj, total, f);
                    if(p && idx>0 && idx<proj.length-1) {
                         const lg = getTickLine(proj[idx-1], p, proj[idx+1], 10);
                         const l = document.createElementNS('http://www.w3.org/2000/svg','line');
                         l.setAttribute('x1', lg[0].x); l.setAttribute('y1', lg[0].y);
                         l.setAttribute('x2', lg[1].x); l.setAttribute('y2', lg[1].y);
                         l.setAttribute('stroke', '#000'); l.setAttribute('stroke-width', 2);
                         gSegs.appendChild(l);
                    }
                });
                [0.16, 0.5, 0.83].forEach((f,i) => {
                    const {p} = getPointAtFrac(proj, total, f);
                    if(p) {
                         const g = document.createElementNS('http://www.w3.org/2000/svg','g');
                         g.append(circle(p.x, p.y, 9, color, '#fff'), text(p.x, p.y+4, String(i+1), 11, '#fff'));
                         gSegs.appendChild(g);
                    }
                });
            }
        });
        
        // ' ()
        if(DATA.badges) DATA.badges.forEach(b => {
             const isSel = b.id === picked;
             const p = project(b.coord);
             const col = isSel ? DATA.colors.routeSelected : DATA.colors.routeRegular;
             const g = document.createElementNS('http://www.w3.org/2000/svg','g');
             g.style.cursor = 'pointer'; g.onclick = (e) => { e.stopPropagation(); selectRoute(b.id); };
             const rect = document.createElementNS('http://www.w3.org/2000/svg','rect');
             rect.setAttribute('x', p.x-40); rect.setAttribute('y', p.y-13); rect.setAttribute('width', 80); rect.setAttribute('height', 26);
             rect.setAttribute('rx', 7); rect.setAttribute('fill', col); rect.setAttribute('stroke', 'rgba(0,0,0,0.3)');
             const label = (b.label ? String(b.label) : (' ' + heb(b.id)));
             const t = text(p.x, p.y+6, label, 13, isSel ? '#fff' : '#000'); t.setAttribute('font-weight','900');
             g.append(rect, t);
             gOver.appendChild(g);
        });
    }

    //   (      )
    if(filters.traffic) DATA.catTrafficSegs.forEach(s => {
        const p = mkPath(s.coords, DATA.colors.traffic, 5); p.setAttribute('stroke-dasharray', '5,5'); gTraffic.appendChild(p);
    });

    //   
    if(filters.toll) DATA.catTollLabels.forEach(l => {
        const p = project(l.coord);
        const g = document.createElementNS('http://www.w3.org/2000/svg','g');
        g.append(circle(p.x, p.y, 7, DATA.colors.toll, '#000'), text(p.x, p.y+3, '', 10, '#000'));
        gTollIco.appendChild(g);
    });

    //  
    if(DATA.start) { const p = project(DATA.start); gOver.append(circle(p.x, p.y, 7, '#fff', '#000'), drawLabel(p.x, p.y-20, '')); }
    if(DATA.end) { 
        const p = project(DATA.end); 
        const g = document.createElementNS('http://www.w3.org/2000/svg','g');
        g.innerHTML = '<path transform="translate('+(p.x-10)+','+(p.y-22)+') scale(0.85)" d="M12 0c-6.6 0-12 5.4-12 12 0 8 12 24 12 24s12-16 12-24c0-6.6-5.4-12-12-12zm0 16c-2.2 0-4-1.8-4-4s1.8-4 4-4 4 1.8 4 4-1.8 4-4 4z" fill="#d11111" stroke="#000" stroke-width="1"/>';
        gOver.append(g, drawLabel(p.x, p.y-30, ''));
    }
}

// Map SVG Helpers
function g(id){ const e = document.createElementNS('http://www.w3.org/2000/svg','g'); e.id=id; return e; }
function mkPath(c,col,w){
    const d=c.map((pt,i)=>(i==0?'M':'L')+project(pt).x+','+project(pt).y).join(' ');
    const p=document.createElementNS('http://www.w3.org/2000/svg','path');
    p.setAttribute('d',d); p.setAttribute('stroke',col); p.setAttribute('stroke-width',w); p.setAttribute('fill','none'); p.setAttribute('stroke-linecap','round'); p.setAttribute('stroke-linejoin','round');
    return p;
}
function mkPoly(r,f,s){
    const pts=r.map(pt=>project(pt).x+','+project(pt).y).join(' ');
    const p=document.createElementNS('http://www.w3.org/2000/svg','polygon');
    p.setAttribute('points',pts); p.setAttribute('fill',f); p.setAttribute('stroke',s); p.setAttribute('stroke-width',2);
    return p;
}
function circle(x,y,r,f,s){
    const c=document.createElementNS('http://www.w3.org/2000/svg','circle');
    c.setAttribute('cx',x); c.setAttribute('cy',y); c.setAttribute('r',r); c.setAttribute('fill',f); c.setAttribute('stroke',s);
    return c;
}
function text(x,y,t,sz,f){
    const el=document.createElementNS('http://www.w3.org/2000/svg','text');
    el.setAttribute('x',x); el.setAttribute('y',y); el.setAttribute('text-anchor','middle'); el.setAttribute('font-size',sz); el.setAttribute('fill',f); el.setAttribute('font-family','Arial'); el.textContent=t;
    return el;
}
function drawLabel(x,y,txt){
    const g=document.createElementNS('http://www.w3.org/2000/svg','g');
    const w=txt.length*7+10, h=18;
    const r=document.createElementNS('http://www.w3.org/2000/svg','rect');
    r.setAttribute('x',x-w/2); r.setAttribute('y',y-h/2); r.setAttribute('width',w); r.setAttribute('height',h); r.setAttribute('rx',4); r.setAttribute('fill','rgba(0,0,0,0.8)');
    const t=text(x,y+4,txt,11,'#fff'); t.setAttribute('font-weight','bold');
    g.append(r,t); return g;
}
function getPathLen(pts){ let l=0; for(let i=1;i<pts.length;i++) l+=Math.hypot(pts[i].x-pts[i-1].x, pts[i].y-pts[i-1].y); return l; }
function getPointAtFrac(pts,total,frac){
    const tg=total*frac; let d=0;
    for(let i=1;i<pts.length;i++){
        const dist=Math.hypot(pts[i].x-pts[i-1].x, pts[i].y-pts[i-1].y);
        if(d+dist>=tg){ const t=(tg-d)/dist; return {p:{x:pts[i-1].x+(pts[i].x-pts[i-1].x)*t, y:pts[i-1].y+(pts[i].y-pts[i-1].y)*t}, idx:i}; }
        d+=dist;
    }
    return {p:pts[pts.length-1], idx:pts.length-1};
}

// --- VISUALIZATION LOGIC ---
function renderVizContainer() {
    const container = els.vizContainer;
    container.innerHTML = '';
    
    const vizType = DATA.vizType; 
    const segments = (DATA.routeScores || []).filter(s => s.route === picked).sort((a,b) => a.segment - b.segment);
    const cats = DATA.vizConfig; 

    if (!segments.length) {
        container.innerHTML = '<div style="text-align:center; opacity:0.6; margin-top:20px"> </div>';
        return;
    }

    if (vizType === 'HEATMAP') {
        const table = document.createElement('table'); table.className = 'heatmap-table';
        const thead = document.createElement('thead');
        const hRow = document.createElement('tr');
        hRow.appendChild(document.createElement('th')); 
        segments.forEach(seg => {
            const th = document.createElement('th');
            th.innerHTML = '<span style="font-size:12px; color:#cbd5e1; margin-left:4px"></span><span class="segment-badge">' + seg.segment + '</span>';
            hRow.appendChild(th);
        });
        thead.appendChild(hRow); table.appendChild(thead);
        const tbody = document.createElement('tbody');
        
        cats.forEach(c => {
            const tr = document.createElement('tr');
            const tdName = document.createElement('td');
            // Left aligned as requested
            tdName.style.textAlign = 'left'; 
            tdName.style.padding = '4px'; 
            tdName.style.color='#ddd';
            tdName.innerHTML = '<span style="display:inline-block;width:10px;height:10px;border-radius:50%;margin-left:6px;background:' + c.color + '"></span>' + c.label;
            tr.appendChild(tdName);
            
            segments.forEach(seg => {
                const td = document.createElement('td');
                //     
                //const val = seg[c.key] || 0;
                //const lightness = 15 + (val * 0.65); 
                //const bg = 'hsl(220, 25%, ' + lightness + '%)';
                //td.innerHTML = '<div style="background:'+bg+'" class="heatmap-cell">'+Math.round(val)+'</div>';
                //      
                const val = seg[c.key] || 0;
                //  : 0 =  (Hue 0), 100 =  (Hue 120)
                const hue = Math.round(val * 1.2); 
                const bg = 'hsl(' + hue + ', 75%, 35%)'; //       
                td.innerHTML = '<div style="background:'+bg+'; color:white;" class="heatmap-cell">'+Math.round(val)+'</div>';
                tr.appendChild(td);
            });
            tbody.appendChild(tr);
        });
        table.appendChild(tbody);
        container.appendChild(table);

    } else if (vizType === 'STACKED') {
        const headerRow = document.createElement('div'); headerRow.className = 'viz-headers-row';
        segments.forEach(seg => {
            const el = document.createElement('div'); el.className = 'viz-header-item';
            el.innerHTML = ' <span class="segment-badge">' + seg.segment + '</span>';
            headerRow.appendChild(el);
        });
        container.appendChild(headerRow);

        const maxPossible = cats.length * 100; 
        const wrapper = document.createElement('div'); wrapper.className = 'stacked-wrapper';
        segments.forEach(seg => {
            const colCont = document.createElement('div'); colCont.className = 'stacked-col-container';
            const bar = document.createElement('div'); bar.className = 'stacked-bar';
            
            let currentTotal = 0;
            cats.forEach(c => currentTotal += (seg[c.key] || 0));
            const barHeightPct = Math.min(100, (currentTotal / maxPossible) * 100);
            bar.style.height = barHeightPct + '%';
            
            cats.forEach(c => {
                const val = seg[c.key] || 0;
                if(val > 0) {
                   const item = document.createElement('div');
                   item.className = 'stack-segment';
                   item.style.backgroundColor = c.color;
                   const segH = (val / currentTotal) * 100;
                   item.style.height = segH + '%';
                   
                   // :    ( -10%),    -Z   
                   if (segH < 10) item.style.zIndex = '10';
                   else item.style.zIndex = '1';

                   //     
                   const lbl = document.createElement('div');
                   lbl.className = 'stack-label';
                   lbl.innerHTML = '<span>' + c.label + '</span><span>' + Math.round(val) + '</span>';
                   
                   item.appendChild(lbl);
                   bar.appendChild(item);
                }
            });
            colCont.appendChild(bar);
            wrapper.appendChild(colCont);
        });
        container.appendChild(wrapper);

} else if (vizType === 'RADAR') {
        const wrapper = document.createElement('div'); wrapper.className = 'radar-wrapper';
        
        segments.forEach((seg, idx) => {
             const chartDiv = document.createElement('div'); chartDiv.className = 'radar-chart';
             
             //  
             if (idx > 0) {
                 chartDiv.style.borderRight = '1px solid rgba(255,255,255,0.15)';
             }

             const badge = document.createElement('div');
             badge.className = 'radar-badge-corner';
             badge.innerHTML = ' <span class="segment-badge">' + seg.segment + '</span>';
             chartDiv.appendChild(badge);

             const size = 260; 
             // 1.  -Padding      
             const padding = 180; 
             const totalSize = size + padding * 2;
             
             const cx = totalSize/2, cy = totalSize/2, r = size * 0.9;
             const labelR = r + 25; 
             
             const svgNS = "http://www.w3.org/2000/svg";
             const svg = document.createElementNS(svgNS, "svg");
             svg.setAttribute("width", "100%"); svg.setAttribute("height", "100%");
             svg.setAttribute("viewBox", "0 0 "+totalSize+" "+totalSize);
             svg.style.overflow = "visible"; 
             
             //  
             [0.25, 0.5, 0.75, 1].forEach(k => {
                 const c = document.createElementNS(svgNS, "circle");
                 c.setAttribute("cx", cx); c.setAttribute("cy", cy); c.setAttribute("r", r*k);
                 c.setAttribute("fill", "none"); 
                 c.setAttribute("stroke", "rgba(255,255,255,0.40)");
                 c.setAttribute("stroke-width", k===1 ? "2" : "1");
                 svg.appendChild(c);
             });
             
             let pts = [];
             const angleStep = (Math.PI * 2) / cats.length;
             
             cats.forEach((c, i) => {
                 const val = (seg[c.key] || 0) / 100;
                 const ang = i * angleStep - Math.PI/2;
                 
                 const x = cx + Math.cos(ang) * (r * val);
                 const y = cy + Math.sin(ang) * (r * val);
                 pts.push(x + ',' + y);
                 
                 const lx = cx + Math.cos(ang) * r;
                 const ly = cy + Math.sin(ang) * r;
                 const line = document.createElementNS(svgNS, "line");
                 line.setAttribute("x1", cx); line.setAttribute("y1", cy);
                 line.setAttribute("x2", lx); line.setAttribute("y2", ly);
                 line.setAttribute("stroke", "rgba(255,255,255,0.4)");
                 svg.appendChild(line);

                 // ---    ---
                 
                 const isSide = Math.abs(Math.cos(ang)) > 0.1; 
                 const isRight = Math.cos(ang) > 0; // 
                 const isLeft = Math.cos(ang) < 0;  // 

                 //  
                 let lblX = cx + Math.cos(ang) * labelR;
                 let lblY = cy + Math.sin(ang) * labelR;

                 // 2.    (85px)     
                 if (isSide) {
                     lblX += isRight ? 85 : -85;
                 } else {
                     lblY += Math.sin(ang) * 15;
                 }

                 const gLbl = document.createElementNS(svgNS, "g");
                 
                 // 3.   -150  ( 110)
                 const rectW = 200; 
                 const rectH = 50; //    
                 const rect = document.createElementNS(svgNS, "rect");
                 
                 //     
                 rect.setAttribute("x", lblX - rectW/2);
                 rect.setAttribute("y", lblY - rectH/2);
                 rect.setAttribute("width", rectW); rect.setAttribute("height", rectH);
                 rect.setAttribute("rx", rectH/2); 
                 rect.setAttribute("fill", c.color);
                 rect.setAttribute("filter", "drop-shadow(0px 2px 2px rgba(0,0,0,0.25))");
                 
                 // 
                 const textEl = document.createElementNS(svgNS, "text");
                 textEl.setAttribute("x", lblX); 
                 textEl.setAttribute("y", lblY + 1); //    
                 textEl.setAttribute("text-anchor", "middle");
                 textEl.setAttribute("dominant-baseline", "middle"); 
                 textEl.setAttribute("fill", "#fff");
                 
                 //  
                 textEl.setAttribute("style", "font-family: Arial, sans-serif; font-weight: 900; font-size: 40px !important; paint-order: stroke fill; stroke: rgba(0,0,0,0.8); stroke-width: 3px; stroke-linecap: round; stroke-linejoin: round;");
                 
                 textEl.textContent = c.label + " " + Math.round(seg[c.key]||0);

                 gLbl.appendChild(rect);
                 gLbl.appendChild(textEl);
                 svg.appendChild(gLbl);
             });
             
             const poly = document.createElementNS(svgNS, "polygon");
             poly.setAttribute("points", pts.join(' '));
             poly.setAttribute("fill", DATA.colors.routeSelected);
             poly.setAttribute("fill-opacity", "0.4");
             poly.setAttribute("stroke", DATA.colors.routeSelected);
             poly.setAttribute("stroke-width", "3");
             svg.appendChild(poly);
             
             chartDiv.appendChild(svg);
             wrapper.appendChild(chartDiv);
        });
        
        container.appendChild(wrapper);
    }
}

// Gantt Logic
function renderGantt() {
    const c = els.gantt, ax = els.gAxis;
    c.innerHTML = ''; ax.innerHTML = '';
    const scores = DATA.routeScores || [];
    let maxT = 0;
    ['A','B','C'].forEach(rid => {
        const segs = scores.filter(x => x.route === rid);
        const t = segs.reduce((a,b) => a + (b.timeS || 0), 0);
        if(t > maxT) maxT = t;
    });
    if (maxT === 0) maxT = 1;

    const mins = Math.ceil(maxT/60);
    for(let i=0; i<=mins; i++){
        const pos = (i*60/maxT)*100; if(pos > 100) break;
        const tk = document.createElement('div');
        tk.style.position='absolute'; tk.style.right=pos+'%'; tk.style.transform='translateX(50%)'; tk.textContent=i;
        const ln = document.createElement('div');
        ln.style.position='absolute'; ln.style.right=pos+'%'; ln.style.height='4px'; ln.style.width='1px'; ln.style.background='#555'; ln.style.top='-4px';
        ax.append(ln, tk);
    }

    ['A','B','C'].forEach(rid => {
        const segs = scores.filter(s => s.route === rid).sort((a,b) => a.segment - b.segment);
        const total = segs.reduce((a,b) => a + (b.timeS || 0), 0) || 1;
        const row = document.createElement('div');
        row.className = 'ganttRow' + (rid === picked ? ' active' : '');
        row.onclick = () => { picked=rid; selectRoute(rid); };
        const lbl = document.createElement('div'); lbl.className = 'gLabel'; lbl.textContent = ' ' + heb(rid);
        const trk = document.createElement('div'); trk.className = 'gTrackContainer';
        const bar = document.createElement('div'); bar.className = 'gBar'; bar.style.width = (total / maxT * 100) + '%';
        segs.forEach(s => {
            const el = document.createElement('div'); el.className = 'gSeg';
            const pct = ((s.timeS || 0) / total * 100); el.style.width = pct + '%';
            el.textContent = s.segment;
            bar.appendChild(el);
        });
        trk.appendChild(bar); row.append(lbl, trk); c.appendChild(row);
    });
}

function selectRoute(id) {
    picked = id;
    els.pickedDisplay.textContent = ' ' + heb(id);
    renderVizContainer();
    renderGantt(); 
    drawMap();
}

// FIXED DRIFT-FREE ZOOM LOGIC
els.mapStage.addEventListener('wheel', e => {
    e.preventDefault();
    const rect = els.mapPanel.getBoundingClientRect();
    const mx = e.clientX - rect.left;
    const my = e.clientY - rect.top;
    
    const factor = e.deltaY < 0 ? 1.1 : 0.9;
    const newScale = Math.max(1, Math.min(5, scale * factor));
    
    pan.x = mx - (mx - pan.x) * (newScale / scale);
    pan.y = my - (my - pan.y) * (newScale / scale);
    
    scale = newScale;
    updateTransform();
}, {passive:false});

els.mapStage.onmousedown = e => {
    e.preventDefault();
    const s = {x: e.clientX-pan.x, y: e.clientY-pan.y};
    const mv = m => { pan.x = m.clientX-s.x; pan.y = m.clientY-s.y; updateTransform(); };
    const up = () => { window.removeEventListener('mousemove',mv); window.removeEventListener('mouseup',up); };
    window.addEventListener('mousemove',mv); window.addEventListener('mouseup',up);
};

// Center Zoom logic
function zoomCenter(f) {
    const w = els.mapPanel.offsetWidth, h = els.mapPanel.offsetHeight;
    const cx = w/2, cy = h/2;
    const newScale = Math.max(1, Math.min(5, scale * f));
    pan.x = cx - (cx - pan.x) * (newScale / scale);
    pan.y = cy - (cy - pan.y) * (newScale / scale);
    scale = newScale;
    updateTransform();
}

document.getElementById('zoomIn').onclick = () => zoomCenter(1.2);
document.getElementById('zoomOut').onclick = () => zoomCenter(1/1.2);
document.getElementById('fitView').onclick = () => { scale=1; pan={x:0,y:0}; updateTransform(); };

function updateTransform(){
    const w = els.mapPanel.offsetWidth, h = els.mapPanel.offsetHeight;
    const sw = w*scale, sh = h*scale;
    if(pan.x > 0) pan.x = 0; if(pan.x < w - sw) pan.x = w - sw;
    if(pan.y > 0) pan.y = 0; if(pan.y < h - sh) pan.y = h - sh;
    els.mapStage.style.transform = \`translate(\${pan.x}px, \${pan.y}px) scale(\${scale})\`;
}

document.getElementById('submitBtn').onclick = () => {
    els.confirmText.textContent = '  '+heb(picked)+'.   ?';
    els.confirmWarn.style.display = picked!==DATA.recommendedRoute ? 'block':'none';
    document.getElementById('confirmModal').classList.add('show');
};
document.getElementById('cancelConfirm').onclick = () => document.getElementById('confirmModal').classList.remove('show');
document.getElementById('doConfirm').onclick = () => { alert(' !'); document.getElementById('confirmModal').classList.remove('show'); };

// Filters
els.filterBtn.onclick = () => {
    els.filterList.innerHTML = '';
    const hasActive = Object.values(filters).some(x=>!x);
    els.filterBtn.classList.toggle('has-active', hasActive);
    
    [{k:'routes',l:''},{k:'traffic',l:''},{k:'toll',l:''},{k:'comm',l:''}/*,{k:'parks',l:''}*/].forEach(it=>{
        const div = document.createElement('div'); div.className='filterRow';
        div.innerHTML = \`<span>\${it.l}</span><button class="eyeBtn\${filters[it.k]?' on':''}" onclick="filters['\${it.k}']=!filters['\${it.k}']; drawMap(); this.classList.toggle('on'); document.getElementById('openFilter').classList.toggle('has-active', Object.values(filters).some(x=>!x))"><svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M1 12s4-7 11-7 11 7-4 7-11 7S1 12 1 12z"/><circle cx="12" cy="12" r="3"/></svg></button>\`;
        els.filterList.appendChild(div);
    });
    document.getElementById('filterModal').classList.add('show');
};
document.getElementById('closeFilter').onclick = () => document.getElementById('filterModal').classList.remove('show');
document.getElementById('showAll').onclick = () => { for(let k in filters)filters[k]=true; drawMap(); els.filterBtn.click(); };
document.getElementById('hideAll').onclick = () => { for(let k in filters)filters[k]=false; drawMap(); els.filterBtn.click(); };

// Initial Render
selectRoute(picked);
try { drawMap(); } catch(e){}

<\/script>
</body>
</html>`}const Aw="3IYmgQ2XRtJQCLYAdMs6",$D=`https://api.maptiler.com/maps/streets-v2/style.json?key=${Aw}`,XD=`https://api.maptiler.com/tiles/satellite-v2/{z}/{x}/{y}.jpg?key=${Aw}`,K0="#8CCBFF",Ux=.42,kw=.22,Uh="#1E4ED8",C1=.92,db=9,YD=.35,M1="#00FF66",D1=.95,Rx="rgba(0,90,50,0.9)";function Cw(r){const u=String(r?.id??"").toLowerCase(),l=String(r?.type??""),f=String(r?.["source-layer"]??"").toLowerCase();return(u.includes("park")||u.includes("leisure")||u.includes("garden")||u.includes("wood")||u.includes("forest")||f.includes("park")||f.includes("landcover"))&&(l==="fill"||l==="line")}function pb(r){const u=r.getStyle()?.layers??[];for(const l of u)if(l?.id&&typeof l.id=="string"&&Cw(l))try{if(l.type==="fill"){r.setPaintProperty(l.id,"fill-color",M1),r.setPaintProperty(l.id,"fill-opacity",D1);try{r.setPaintProperty(l.id,"fill-outline-color",Rx)}catch{}}else l.type==="line"&&(r.setPaintProperty(l.id,"line-color",Rx),r.setPaintProperty(l.id,"line-width",1.6),r.setPaintProperty(l.id,"line-opacity",.9))}catch{}}const qy="#FF0022",$0="#FFE100",KD="",Mw="rgba(170,60,255,0.28)",Dw="rgba(170,60,255,0.65)",xg=200,yg=60,Ix=2,JD=xg/Ix,QD=yg/Ix;function J0(r,u){const f=j=>j*Math.PI/180,[p,b]=r,[_,s]=u,C=f(s-b),M=f(_-p),D=Math.sin(C/2),B=Math.sin(M/2),U=D*D+Math.cos(f(b))*Math.cos(f(s))*B*B;return 2*6371e3*Math.asin(Math.min(1,Math.sqrt(U)))}function _d(r){let u=0;for(let l=1;l<r.length;l++)u+=J0(r[l-1],r[l]);return u}function ox(r){return Number.isFinite(r)?r<1e3?`${Math.round(r)} m`:`${(r/1e3).toFixed(2)} km`:""}function eR(){const r=window;if(r.__rtlPluginSet)return;const u=H0.getRTLTextPluginStatus,l=H0.setRTLTextPlugin;if(typeof u!="function"||typeof l!="function")return;const f=u();if(f==="loaded"||f==="loading"){r.__rtlPluginSet=!0;return}try{l("https://unpkg.com/@mapbox/mapbox-gl-rtl-text@0.2.3/mapbox-gl-rtl-text.js",()=>{},!0),r.__rtlPluginSet=!0}catch{r.__rtlPluginSet=!0}}async function vg(r){if(r.length<2)return null;const l=`https://router.project-osrm.org/route/v1/driving/${r.map(([f,p])=>`${f},${p}`).join(";")}?overview=full&geometries=geojson`;try{const f=await fetch(l);if(!f.ok)return null;const b=(await f.json())?.routes?.[0]?.geometry?.coordinates;return!Array.isArray(b)||b.length<2?null:b}catch{return null}}function In(r,u){return{type:"FeatureCollection",features:r.map((l,f)=>({type:"Feature",properties:u?.[f]??{},geometry:{type:"Point",coordinates:l}}))}}function pa(r){return r.length<2?{type:"FeatureCollection",features:[]}:{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:r}}]}}function mi(r){return{type:"FeatureCollection",features:r.filter(u=>u.coords.length>=2).map(u=>({type:"Feature",properties:u.props??{},geometry:{type:"LineString",coordinates:u.coords}}))}}function B0(r){return{type:"FeatureCollection",features:r.map(u=>({type:"Feature",geometry:{type:"Polygon",coordinates:[u.coords]},properties:u.props??{}}))}}function cr(r,u,l){const f=r.getSource(u);f&&f.setData(l)}function tR(r){const f=(r.getStyle()?.layers??[]).find(p=>p.type==="symbol"&&p?.layout?.["text-font"])?.layout?.["text-font"]??["Noto Sans Regular","Roboto Regular"];return Array.isArray(f)&&f.length?f.map(b=>b.includes("Italic")?b.replace("Italic","Regular"):b):f}function rR(r){if(r.hasImage("end-pin"))return;const u=48,l=document.createElement("canvas");l.width=u,l.height=u;const f=l.getContext("2d");if(!f)return;f.clearRect(0,0,u,u),f.save(),f.translate(u/2,u/2),f.beginPath(),f.ellipse(0,16,10,4,0,0,Math.PI*2),f.fillStyle="rgba(0,0,0,0.22)",f.fill(),f.beginPath(),f.moveTo(0,18),f.bezierCurveTo(10,10,14,3,14,-4),f.arc(0,-4,14,0,Math.PI,!0),f.bezierCurveTo(-14,3,-10,10,0,18),f.closePath(),f.fillStyle="#e11d48",f.fill(),f.beginPath(),f.arc(0,-4,5.2,0,Math.PI*2),f.fillStyle="#ffffff",f.fill(),f.restore();const p=f.getImageData(0,0,u,u);r.addImage("end-pin",{width:u,height:u,data:p.data},{pixelRatio:2})}function nR(r){if(r.hasImage("label-bg"))return;const u=140,l=44,f=document.createElement("canvas");f.width=u,f.height=l;const p=f.getContext("2d");if(!p)return;p.clearRect(0,0,u,l),p.fillStyle="rgba(255,255,255,0.80)",p.strokeStyle="rgba(0,0,0,0.18)",p.lineWidth=2;const b=12;p.beginPath(),p.moveTo(b,0),p.lineTo(u-b,0),p.quadraticCurveTo(u,0,u,b),p.lineTo(u,l-b),p.quadraticCurveTo(u,l,u-b,l),p.lineTo(b,l),p.quadraticCurveTo(0,l,0,l-b),p.lineTo(0,b),p.quadraticCurveTo(0,0,b,0),p.closePath(),p.fill(),p.stroke();const _=p.getImageData(0,0,u,l);r.addImage("label-bg",{width:u,height:l,data:_.data},{pixelRatio:2})}function Px(r){const u=r.replace("#","").trim();if(u.length!==6)return null;const l=parseInt(u.slice(0,2),16),f=parseInt(u.slice(2,4),16),p=parseInt(u.slice(4,6),16);return[l,f,p].every(b=>Number.isFinite(b))?{r:l,g:f,b:p}:null}function aR(r){const u=(p,b,_,s)=>{const C=document.createElement("canvas");C.width=_,C.height=s;const M=C.getContext("2d");if(!M)return null;const D=14,B=8,U=B,j=B,H=_-B*2,z=s-B*2;return M.clearRect(0,0,_,s),M.beginPath(),M.moveTo(U+D,j),M.lineTo(U+H-D,j),M.quadraticCurveTo(U+H,j,U+H,j+D),M.lineTo(U+H,j+z-D),M.quadraticCurveTo(U+H,j+z,U+H-D,j+z),M.lineTo(U+D,j+z),M.quadraticCurveTo(U,j+z,U,j+z-D),M.lineTo(U,j+D),M.quadraticCurveTo(U,j,U+D,j),M.closePath(),M.fillStyle=p,M.fill(),M.lineWidth=2,M.strokeStyle=b,M.stroke(),M.getImageData(0,0,_,s)},l=Px(K0)??{r:140,g:203,b:255},f=Px(Uh)??{r:30,g:78,b:216};if(!r.hasImage("route-badge")){const p=u(`rgba(${l.r},${l.g},${l.b},${Ux})`,"rgba(0,0,0,0.18)",xg,yg);p&&r.addImage("route-badge",{width:xg,height:yg,data:p.data},{pixelRatio:Ix})}if(!r.hasImage("route-badge-selected")){const p=u(`rgba(${f.r},${f.g},${f.b},${C1})`,"rgba(0,0,0,0.18)",xg,yg);p&&r.addImage("route-badge-selected",{width:xg,height:yg,data:p.data},{pixelRatio:Ix})}}function pd(r,u,l){const f=r.getStyle();if(f?.layers){for(const p of f.layers)if(p?.id&&u(p))try{r.setLayoutProperty(p.id,"visibility",l?"visible":"none")}catch{}}}function Xg(r){return r.startsWith("measure-")||r.startsWith("single-")||r.startsWith("start-")||r.startsWith("end-")||r.startsWith("triple-")||r.startsWith("edit-")}function mb(r){const u=r.type,l=String(r.id||"").toLowerCase();return u==="symbol"&&!Xg(String(r.id||""))&&(l.includes("label")||l.includes("place")||l.includes("poi")||l.includes("name"))}function lx(r){const u=String(r.id||"").toLowerCase();return!Xg(String(r.id||""))&&(u.includes("poi")||u.includes("pois"))}function Zy(r){const u=String(r.id||"").toLowerCase(),l=r.type,f=String(r["source-layer"]||"").toLowerCase(),p=u.includes("road")||u.includes("street")||u.includes("highway")||u.includes("transport")||f.includes("transport")||f.includes("road");return!Xg(String(r.id||""))&&l==="line"&&p}function iR(r,u){const l=r.getStyle(),p=(Array.isArray(l?.layers)?l.layers:[]).filter(H=>Zy(H)).map(H=>String(H.id||"")).filter(H=>H.length>0);if(!p.length)return[];const b=r.project([u.west,u.north]),_=r.project([u.east,u.south]),s=Math.min(b.x,_.x),C=Math.max(b.x,_.x),M=Math.min(b.y,_.y),D=Math.max(b.y,_.y);let B=[];try{B=r.queryRenderedFeatures([[s,M],[C,D]],{layers:p.slice(0,30)})}catch{B=[]}const U=[],j=new Set;for(const H of B){const z=H?.geometry;if(!z)continue;const N=z.type,Z=Y=>{if(!Array.isArray(Y)||Y.length<2)return;const W=Y,de=W[0],ge=W[W.length-1],ve=`${de[0].toFixed(5)},${de[1].toFixed(5)}-${ge[0].toFixed(5)},${ge[1].toFixed(5)}`;j.has(ve)||_d(W)<80||(j.add(ve),U.push(W))};if(N==="LineString")Z(z.coordinates);else if(N==="MultiLineString"){const Y=z.coordinates;if(Array.isArray(Y))for(const W of Y)Z(W)}if(U.length>=80)break}return U}function gb(r){const u=String(r.id||"").toLowerCase();return!Xg(String(r.id||""))&&(u.includes("transit")||u.includes("rail")||u.includes("subway")||u.includes("train"))}function _b(r,u,l){const f=r.getStyle();if(f?.layers)for(const p of f.layers){if(p.type!=="symbol")continue;const b=String(p.id||"");if(Xg(b))continue;const _=r.getLayoutProperty(b,"text-field");l.current[b]===void 0&&(l.current[b]=_);let s;u==="he"?s=["coalesce",["get","name:he"],["get","name"],["get","name:en"]]:u==="en"?s=["coalesce",["get","name:en"],["get","name"],["get","name:he"]]:s=["coalesce",["get","name"],["get","name:en"],["get","name:he"]];try{r.setLayoutProperty(b,"text-field",s)}catch{}}}function am(){return 111132.92}function im(r){return 111412.84*Math.cos(r*Math.PI/180)}function N0(r,u,l){const f=r[1],p=l/am(),b=u/(im(f)||1);return[r[0]+b,r[1]+p]}function yp(){return Math.random()}function Mc(r,u){return r+(u-r)*yp()}function xb(r,u){return Math.floor(Mc(r,u+1))}function sR(r){const u=r.flat();if(!u.length)return null;let l=u[0][0],f=u[0][0],p=u[0][1],b=u[0][1];for(const _ of u)l=Math.min(l,_[0]),f=Math.max(f,_[0]),p=Math.min(p,_[1]),b=Math.max(b,_[1]);return{west:l,south:p,east:f,north:b}}function oR(r,u=.1){const l=r.east-r.west,f=r.north-r.south;return{west:r.west-l*u,east:r.east+l*u,south:r.south-f*u,north:r.north+f*u}}function lR(r){return[Mc(r.west,r.east),Mc(r.south,r.north)]}function cx(r,u,l){if(r.length<2)return r.slice();const f=ou(r),p=f[f.length-1]||1,b=Math.max(0,Math.min(p,Math.min(u,l))),_=Math.max(0,Math.min(p,Math.max(u,l))),s=[];s.push(Yl(r,f,b));for(let C=0;C<f.length;C++)f[C]>b&&f[C]<_&&s.push(r[C]);return s.push(Yl(r,f,_)),s}function _x(r,u){if(r.length<2)return[];const l=ou(r),f=l[l.length-1]||0;if(f<=0)return[];const p=[];for(let b=0;b<=f;b+=u)p.push(Yl(r,l,b));return p}function Ey(r,u,l=64){const f=r[1],p=im(f),b=am(),_=[];for(let s=0;s<=l;s++){const C=s/l*Math.PI*2,M=Math.cos(C)*u,D=Math.sin(C)*u;_.push([r[0]+M/(p||1),r[1]+D/b])}return _}function ou(r){const u=[0];for(let l=1;l<r.length;l++)u[l]=u[l-1]+J0(r[l-1],r[l]);return u}function Rw(r){const u=r.length,l=new Array(u).fill(0);for(let f=1;f<u-1;f++){const p=r[f-1],b=r[f],_=r[f+1],s=im(b[1]),C=am(),M=(b[0]-p[0])*s,D=(b[1]-p[1])*C,B=(_[0]-b[0])*s,U=(_[1]-b[1])*C,j=Math.hypot(M,D)||1,H=Math.hypot(B,U)||1,z=M/j*(B/H)+D/j*(U/H),N=Math.max(-1,Math.min(1,z)),Y=Math.acos(N)*180/Math.PI;l[f]=Y}return l}function xx(r){const u=r.length;if(u<4){const ie=Math.max(1,Math.floor(u/3)),Me=Math.max(ie+1,Math.floor(2*u/3));return{i1:ie,i2:Math.min(u-2,Me)}}const l=ou(r),f=l[l.length-1]||1,p=f/3,b=2*f/3,_=Rw(r),s=.18,C=.48,M=f*s,D=f*C,B=[];for(let ie=1;ie<u-1;ie++)B.push(ie);const U=[...B].filter(ie=>_[ie]>=12).sort((ie,Me)=>_[Me]-_[ie]).slice(0,24),j=ie=>{let Me=1,we=1/0;for(let Ge=1;Ge<u-1;Ge++){const et=Math.abs(l[Ge]-ie);et<we&&(we=et,Me=Ge)}return Me},H=j(p),z=j(b),N=Array.from(new Set([...U,H,z])).filter(ie=>ie>=1&&ie<=u-2).slice(0,30);let Z=null;const Y=(ie,Me)=>{const we=l[ie]-l[0],Ge=l[Me]-l[ie],et=f-l[Me];if(we<M||Ge<M||et<M||we>D||Ge>D||et>D)return-1/0;const pe=(_[ie]||0)+(_[Me]||0),Je=1-Math.abs(l[ie]-p)/f+(1-Math.abs(l[Me]-b)/f),le=1-(Math.max(we,Ge,et)-Math.min(we,Ge,et))/f;return pe*1+Je*60+le*80};for(let ie=0;ie<N.length;ie++)for(let Me=ie+1;Me<N.length;Me++){const we=N[ie],Ge=N[Me];if(Ge<=we)continue;const et=Y(we,Ge);Number.isFinite(et)&&(!Z||et>Z.score)&&(Z={i1:we,i2:Ge,score:et})}if(Z)return{i1:Z.i1,i2:Z.i2};let W=H,de=z;de<=W&&(de=Math.min(u-2,W+1));const ge=(ie,Me)=>{for(;ie<u-2&&l[ie]<Me;)ie++;return Math.min(u-2,ie)},ve=(ie,Me)=>{for(;ie>1&&l[ie]>Me;)ie--;return Math.max(1,ie)};return l[W]<M&&(W=ge(W,M)),l[de]-l[W]<M&&(de=ge(de,l[W]+M)),f-l[de]<M&&(de=ve(de,f-M)),de<=W&&(de=Math.min(u-2,W+1)),{i1:W,i2:de}}function Yl(r,u,l){const f=r.length;if(f===0)return[0,0];if(l<=0)return r[0];const p=u[u.length-1]||1;if(l>=p)return r[f-1];let b=1;for(;b<f&&u[b]<l;)b++;const _=Math.max(0,b-1),s=Math.min(f-1,b),C=u[_],M=u[s],D=M===C?0:(l-C)/(M-C),B=r[_],U=r[s];return[B[0]+(U[0]-B[0])*D,B[1]+(U[1]-B[1])*D]}function Ay(r,u){const l=im((r[1]+u[1])/2),f=am(),p=(u[0]-r[0])*l,b=(u[1]-r[1])*f,_=Math.hypot(p,b)||1;return{ux:p/_,uy:b/_}}function cR(r,u,l){try{const f=r.project(u),p=r.project(l),b=p.x-f.x,_=p.y-f.y;if(b===0&&_===0)return u;const s=JD/2,C=QD/2,M=b!==0?s/Math.abs(b):1/0,D=_!==0?C/Math.abs(_):1/0,B=Math.min(M,D),U=f.x+b*B,j=f.y+_*B,H=r.unproject([U,j]);return[H.lng,H.lat]}catch{return u}}function Sf(r){const u=s=>{r.getSource(s)||r.addSource(s,{type:"geojson",data:{type:"FeatureCollection",features:[]}})};u("measure-points"),u("measure-line"),u("manual-parks"),u("manual-park-draft-line"),u("manual-park-draft-points"),u("manual-park-preview-line"),u("single-points"),u("single-line"),u("start-end"),u("triple-a"),u("triple-b"),u("triple-c"),u("triple-badge-points"),u("triple-badge-lines"),u("triple-seg-points"),u("triple-seg-ticks"),u("edit-junctions"),u("cat-traffic"),u("cat-toll"),u("cat-toll-labels"),u("cat-comm");const l=tR(r);try{rR(r),nR(r),aR(r)}catch{}r.getLayer("measure-line")||r.addLayer({id:"measure-line",type:"line",source:"measure-line",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#0b1220","line-width":4,"line-opacity":.85}}),r.getLayer("measure-points")||r.addLayer({id:"measure-points",type:"circle",source:"measure-points",paint:{"circle-radius":5,"circle-color":"#0b1220","circle-stroke-width":2,"circle-stroke-color":"#fff"}}),r.getLayer("manual-parks-fill")||r.addLayer({id:"manual-parks-fill",type:"fill",source:"manual-parks",paint:{"fill-color":M1,"fill-opacity":D1,"fill-outline-color":Rx}}),r.getLayer("manual-park-draft-line-layer")||r.addLayer({id:"manual-park-draft-line-layer",type:"line",source:"manual-park-draft-line",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#2ecc71","line-width":2.5,"line-opacity":0}}),r.getLayer("manual-park-preview-line-layer")||r.addLayer({id:"manual-park-preview-line-layer",type:"line",source:"manual-park-preview-line",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#2ecc71","line-width":2,"line-opacity":0,"line-dasharray":[1.5,1.5]}}),r.getLayer("manual-park-draft-points-layer")||r.addLayer({id:"manual-park-draft-points-layer",type:"circle",source:"manual-park-draft-points",paint:{"circle-radius":4.5,"circle-color":"#2ecc71","circle-stroke-width":2,"circle-stroke-color":"#0b1220"}});const f=(s,C,M)=>{const D=`${C}-outline`;r.getLayer(D)||r.addLayer({id:D,type:"line",source:s,layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#0b1220","line-width":M+2,"line-opacity":kw}}),r.getLayer(C)||r.addLayer({id:C,type:"line",source:s,layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":K0,"line-width":M,"line-opacity":Ux}})};f("single-line","single-line",6),r.getLayer("single-points")||r.addLayer({id:"single-points",type:"circle",source:"single-points",paint:{"circle-radius":5,"circle-color":K0,"circle-stroke-width":2,"circle-stroke-color":"#fff","circle-opacity":.95}}),f("triple-a","triple-a",7),f("triple-b","triple-b",7),f("triple-c","triple-c",7),r.getLayer("cat-comm-fill")||r.addLayer({id:"cat-comm-fill",type:"fill",source:"cat-comm",paint:{"fill-color":Mw,"fill-opacity":.5}},"triple-a-outline"),r.getLayer("cat-comm-outline")||r.addLayer({id:"cat-comm-outline",type:"line",source:"cat-comm",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":Dw,"line-width":1,"line-opacity":.8}},"triple-a-outline"),r.getLayer("cat-traffic-glow")||r.addLayer({id:"cat-traffic-glow",type:"line",source:"cat-traffic",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":qy,"line-width":7,"line-opacity":.28,"line-blur":1.2}}),r.getLayer("cat-traffic")||r.addLayer({id:"cat-traffic",type:"line",source:"cat-traffic",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":qy,"line-width":3,"line-opacity":.95,"line-dasharray":[2,2]}}),r.getLayer("cat-toll-shadow")||r.addLayer({id:"cat-toll-shadow",type:"line",source:"cat-toll",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#000000","line-width":12,"line-opacity":.35,"line-blur":4}}),r.getLayer("cat-toll-left")||r.addLayer({id:"cat-toll-left",type:"line",source:"cat-toll",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":$0,"line-width":4,"line-opacity":.95,"line-offset":7}}),r.getLayer("cat-toll-right")||r.addLayer({id:"cat-toll-right",type:"line",source:"cat-toll",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":$0,"line-width":4,"line-opacity":.95,"line-offset":-7}}),r.getLayer("cat-toll-label-bg")||r.addLayer({id:"cat-toll-label-bg",type:"circle",source:"cat-toll-labels",paint:{"circle-radius":7,"circle-color":$0,"circle-opacity":.95,"circle-stroke-color":"#000000","circle-stroke-opacity":.85,"circle-stroke-width":1}}),r.getLayer("cat-toll-label-text")||r.addLayer({id:"cat-toll-label-text",type:"symbol",source:"cat-toll-labels",layout:{"text-field":KD,"text-font":l,"text-size":14,"text-allow-overlap":!0,"text-ignore-placement":!0,"text-offset":["case",["==",["get","side"],"left"],["literal",[-1.1,0]],["literal",[1.1,0]]]},paint:{"text-color":"#0b1220","text-halo-color":"#ffffff","text-halo-width":.8}}),r.getLayer("start-circle")||r.addLayer({id:"start-circle",type:"circle",source:"start-end",filter:["==",["get","kind"],"start"],paint:{"circle-radius":11,"circle-color":"#ffffff","circle-stroke-width":4,"circle-stroke-color":"#0b1220","circle-opacity":1}}),r.getLayer("end-pin")||r.addLayer({id:"end-pin",type:"symbol",source:"start-end",filter:["==",["get","kind"],"end"],layout:{"icon-image":"end-pin","icon-size":1.55,"icon-anchor":"bottom","icon-allow-overlap":!0,"icon-ignore-placement":!0}});const p=(s,C,M)=>{r.getLayer(s)||r.addLayer({id:s,type:"symbol",source:"start-end",filter:C,layout:{"icon-image":"label-bg","icon-size":1,"icon-anchor":"center","icon-offset":M,"icon-allow-overlap":!0,"icon-ignore-placement":!0}})};p("start-label-bg",["==",["get","kind"],"start"],[0,-36]),p("end-label-bg",["==",["get","kind"],"end"],[0,-44]);const b=(s,C,M)=>{r.getLayer(s)||r.addLayer({id:s,type:"symbol",source:"start-end",filter:C,layout:{"symbol-placement":"point","text-field":["to-string",["get","label"]],"text-font":l,"text-size":16,"text-anchor":"center","text-offset":M,"text-allow-overlap":!0,"text-ignore-placement":!0,"text-optional":!0},paint:{"text-color":"#0b1220","text-halo-color":"#ffffff","text-halo-width":1.5,"text-opacity":1}})};b("start-label",["==",["get","kind"],"start"],[0,-2.1]),b("end-label",["==",["get","kind"],"end"],[0,-2.6]),r.getLayer("triple-badge-lines")||r.addLayer({id:"triple-badge-lines",type:"line",source:"triple-badge-lines",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#0b1220","line-width":2,"line-opacity":.35}}),r.getLayer("triple-badges")||r.addLayer({id:"triple-badges",type:"symbol",source:"triple-badge-points",layout:{"icon-image":"route-badge","icon-size":1,"icon-anchor":"center","icon-allow-overlap":!0,"icon-ignore-placement":!0}}),r.getLayer("triple-badge-text")||r.addLayer({id:"triple-badge-text",type:"symbol",source:"triple-badge-points",layout:{"text-field":["to-string",["get","label"]],"text-font":["Arial"],"text-size":14,"text-anchor":"center","text-max-width":999,"text-justify":"center","text-allow-overlap":!0,"text-ignore-placement":!0,"text-optional":!0,"text-offset":[0,-.05]},paint:{"text-color":"#0b1220","text-halo-color":"#ffffff","text-halo-width":1.2,"text-opacity":1}}),r.getLayer("triple-seg-ticks")||r.addLayer({id:"triple-seg-ticks",type:"line",source:"triple-seg-ticks",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#0b1220","line-width":6,"line-opacity":.7}}),r.getLayer("triple-seg-circles")||r.addLayer({id:"triple-seg-circles",type:"circle",source:"triple-seg-points",paint:{"circle-radius":10,"circle-color":Uh,"circle-opacity":.95,"circle-stroke-width":2,"circle-stroke-color":"#ffffff"}}),r.getLayer("triple-seg-text")||r.addLayer({id:"triple-seg-text",type:"symbol",source:"triple-seg-points",layout:{"text-field":["to-string",["get","label"]],"text-font":l,"text-size":14,"text-anchor":"center","text-allow-overlap":!0,"text-ignore-placement":!0,"text-optional":!0},paint:{"text-color":"#ffffff","text-halo-color":"rgba(0,0,0,0.25)","text-halo-width":1,"text-opacity":1}}),r.getLayer("edit-junction-circles")||r.addLayer({id:"edit-junction-circles",type:"circle",source:"edit-junctions",paint:{"circle-radius":8,"circle-color":["case",["==",["get","disabled"],!0],"rgba(255,255,255,0.25)","rgba(32,99,244,0.95)"],"circle-stroke-width":2,"circle-stroke-color":"#ffffff","circle-opacity":.95}}),r.getLayer("edit-junction-text")||r.addLayer({id:"edit-junction-text",type:"symbol",source:"edit-junctions",layout:{"text-field":["to-string",["get","label"]],"text-font":l,"text-size":11,"text-anchor":"center","text-allow-overlap":!0,"text-ignore-placement":!0,"text-optional":!0},paint:{"text-color":"#0b1220","text-halo-color":"#ffffff","text-halo-width":1,"text-opacity":1}});const _=s=>{try{r.moveLayer(s)}catch{}};_("triple-badge-lines"),_("triple-badges"),_("triple-badge-text"),_("triple-seg-ticks"),_("triple-seg-circles"),_("triple-seg-text"),_("edit-junction-circles"),_("edit-junction-text"),_("start-label-bg"),_("end-label-bg"),_("start-label"),_("end-label"),_("start-circle"),_("end-pin")}function ux(r){return r.length?r[Math.floor(r.length/2)]??r[0]:[0,0]}function hg(r,u,l=.06){const f=u.getWest(),p=u.getEast(),b=u.getSouth(),_=u.getNorth(),s=(p-f)*l,C=(_-b)*l,M=Math.min(p-s,Math.max(f+s,r[0])),D=Math.min(_-C,Math.max(b+C,r[1]));return[M,D]}function ky(r,u){const l=r[0]-u[0],f=r[1]-u[1];return Math.sqrt(l*l+f*f)}const uR=["A","B","C"];function hR(r){return r==="A"?" ":r==="B"?" ":" "}function yb(r){return In(r.map(u=>u.coord),r.map(u=>({id:u.id,label:u.label?u.label:hR(u.id)})))}function Cy(r,u,l){const f=new Map(l.map(p=>[p.id,p.coord]));return mi(u.map(p=>{const b=f.get(p.id),_=cR(r,b,p.coord);return{coords:[p.coord,_],props:{id:p.id}}}))}function fR(r){if(!r||r.length<3)return[];const u=ou(r),l=u[u.length-1]||1,f=Rw(r),p=20,_=l*.1,s=[];for(let D=1;D<r.length-1;D++){const B=f[D]||0;B>=p&&s.push({i:D,a:B})}s.sort((D,B)=>B.a-D.a);const C=[];for(const D of s){if(C.length>=14)break;const B=u[D.i];C.some(j=>Math.abs(u[j]-B)<_)||C.push(D.i)}const M=D=>{const B=l*D;let U=1,j=1/0;for(let H=1;H<r.length-1;H++){const z=Math.abs(u[H]-B);z<j&&(j=z,U=H)}C.includes(U)||C.push(U)};return C.length<5&&(M(.25),M(.5),M(.75)),C.sort((D,B)=>u[D]-u[B]),C.map((D,B)=>({id:`J${B+1}_${D}`,coord:r[D],idx:B+1,dist:u[D],angle:f[D]||0}))}function dR(r,u){const l=new Set,f=[];for(const p of r){const b=u(p);l.has(b)||(l.add(b),f.push(p))}return f}function pR(r,u=10){if(r.length<=u)return r;const l=_d(r);if(!Number.isFinite(l)||l<=0)return[r[0],r[r.length-1]];const f=200,p=ou(r),b=[r[0]];let _=f;for(let s=1;s<r.length-1&&(p[s]>=_&&(b.push(r[s]),_+=f),!(b.length>=u-1));s++);return b.push(r[r.length-1]),dR(b,s=>`${s[0].toFixed(6)},${s[1].toFixed(6)}`)}function My(r,u,l){const f=u.map(b=>b.coord),p=u.map(b=>({jid:b.id,label:b.idx,disabled:l.has(b.id)}));cr(r,"edit-junctions",In(f,p))}async function mR(r,u,l){if(!r||r.length<2)return r;const f=u.filter(C=>!l.has(C.id)),p=[r[0],...f.map(C=>C.coord),r[r.length-1]],b=pR(p,10),_=await vg(b);return _&&_.length>=2?_:b}function j0(r,u){const l=["A","B","C"],f=p=>p==="A"?"triple-a":p==="B"?"triple-b":"triple-c";for(const p of l){const b=f(p),_=`${b}-outline`,s=p===u;try{r.setPaintProperty(b,"line-color",s?Uh:K0),r.setPaintProperty(b,"line-opacity",s?C1:Ux),r.setPaintProperty(b,"line-width",s?db:7)}catch{}try{r.setPaintProperty(_,"line-opacity",s?YD:kw),r.setPaintProperty(_,"line-width",s?db+2:9)}catch{}}}function fg(r,u){const l=r.getLayer("cat-traffic")?"cat-traffic":r.getLayer("triple-badge-lines")?"triple-badge-lines":void 0,f=b=>b==="A"?"triple-a":b==="B"?"triple-b":"triple-c",p=["A","B","C"].filter(b=>b!==u).concat([u]);for(const b of p){const _=f(b),s=`${_}-outline`;try{l?r.moveLayer(s,l):r.moveLayer(s)}catch{}try{l?r.moveLayer(_,l):r.moveLayer(_)}catch{}}}function hx(r,u){try{r.setLayoutProperty("triple-badges","icon-image",["case",["==",["get","id"],u],"route-badge-selected","route-badge"])}catch{}try{r.setPaintProperty("triple-badge-text","text-color",["case",["==",["get","id"],u],"#ffffff","#0b1220"])}catch{}}function th(r){return Math.max(0,Math.min(1,r))}function gR(r,u,l){const f=(r[1]+u[1]+l[1])/3,p=im(f),b=am(),_=0,s=0,C=(l[0]-u[0])*p,M=(l[1]-u[1])*b,D=(r[0]-u[0])*p,B=(r[1]-u[1])*b,U=C*C+M*M;if(U<=1e-9)return Math.hypot(D-_,B-s);const j=Math.max(0,Math.min(1,(D*C+B*M)/U)),H=j*C,z=j*M;return Math.hypot(D-H,B-z)}function Iw(r,u){if(u.length<2)return 1/0;let l=1/0;for(let f=0;f<u.length-1;f++){const p=gR(r,u[f],u[f+1]);if(p<l&&(l=p),l<=.5)return l}return l}function _R(r,u){let l=!1;const f=r[0],p=r[1];for(let b=0,_=u.length-1;b<u.length;_=b++){const s=u[b][0],C=u[b][1],M=u[_][0],D=u[_][1];C>p!=D>p&&f<(M-s)*(p-C)/(D-C+1e-12)+s&&(l=!l)}return l}function xR(r){return r.length<2||r[0][0]===r[r.length-1][0]&&r[0][1]===r[r.length-1][1]?r:[...r,r[0]]}function yR(r,u,l){for(const f of u){const p=f.ring;if(p.length<3)continue;if(_R(r,p))return!0;const b=xR(p);if(Iw(r,b)<=l)return!0}return!1}function bd(r,u){return{x:r[0]*im(u),y:r[1]*am()}}function Pw(r,u,l,f){const p=(D,B,U)=>(B.x-D.x)*(U.y-D.y)-(B.y-D.y)*(U.x-D.x),b=(D,B,U)=>Math.min(D.x,U.x)-1e-9<=B.x&&B.x<=Math.max(D.x,U.x)+1e-9&&Math.min(D.y,U.y)-1e-9<=B.y&&B.y<=Math.max(D.y,U.y)+1e-9,_=p(r,u,l),s=p(r,u,f),C=p(l,f,r),M=p(l,f,u);return _===0&&b(r,l,u)||s===0&&b(r,f,u)||C===0&&b(l,r,f)||M===0&&b(l,u,f)?!0:_>0!=s>0&&C>0!=M>0}function vR(r,u){if(r.length<2)return!1;const l=(r[0][1]+u[1])/2,f=bd(r[r.length-1],l),p=bd(u,l);for(let b=0;b<r.length-2;b++){const _=bd(r[b],l),s=bd(r[b+1],l);if(Pw(f,p,_,s))return!0}return!1}function bR(r){if(r.length<3)return!0;const u=r.reduce((p,b)=>p+b[1],0)/r.length,l=bd(r[r.length-1],u),f=bd(r[0],u);for(let p=1;p<r.length-2;p++){const b=bd(r[p],u),_=bd(r[p+1],u);if(Pw(l,f,b,_))return!0}return!1}function wR(r){if(!r.length)return[0,0];let u=0,l=0;for(const f of r)u+=f[0],l+=f[1];return[u/r.length,l/r.length]}function vb(r,u,l){for(const f of u)if(Iw(r,f)<=l)return!0;return!1}function TR(r){if(!r.length)return[0,0];let u=0,l=0;for(const f of r)u+=f[0],l+=f[1];return[u/r.length,l/r.length]}function SR(r,u){for(const l of u){const f=TR(l.ring);if(J0(r,f)<=l.radiusM)return!0}return!1}function bb(r){return(r.getStyle()?.layers??[]).filter(l=>l?.type==="fill"&&Cw(l)).map(l=>l.id)}function ER(r){const{i1:u,i2:l}=xx(r),f=r.slice(0,u+1),p=r.slice(u,l+1),b=r.slice(l);return[f,p,b]}function dg(r,u,l,f,p,b){const _=["A","B","C"],s=l.map(z=>z.coords),C=f.map(z=>z.coords),M=30,D=10,B=M*1e3/3600,U=D*1e3/3600,j=60;function H(z,N,Z){let Y=_x(Z,j);if(Y.length<2){const Mt=Z[0],me=Z[Z.length-1];Y=Mt&&me?[Mt,me]:[]}let W=0,de=0,ge=0,ve=0,ie=0;for(let Mt=0;Mt<Y.length-1;Mt++){const me=Y[Mt],re=Y[Mt+1],Ve=[(me[0]+re[0])/2,(me[1]+re[1])/2],Pe=J0(me,re);W+=Pe;const De=vb(Ve,s,12),bt=vb(Ve,C,12),Vt=SR(Ve,p),Zt=yR(Ve,b,20);De&&(de+=Pe),bt&&(ge+=Pe),Vt&&(ve+=Pe),Zt&&(ie+=Pe)}const Me=W>0?W:_d(Z),we=W>0?th(de/W):0,Ge=W>0?th(ge/W):0,et=W>0?th(ve/W):0,pe=W>0?th(ie/W):0,Je=Me*we,le=Math.max(0,Me-Je),ut=Je/U+le/B,tt=100-70*we,We=100*(1-Ge),$t=100*pe,Be=30+70*et;return{route:z,segment:N,lengthM:Me,timeS:ut,speedScore:tt,economyScore:We,scenicScore:$t,commScore:Be,fracTraffic:we,fracToll:Ge,fracScenic:pe,fracComm:et}}return _.map(z=>{const N=u[z]??[];if(N.length<2)return{route:z,segments:[],totalLengthM:0,totalTimeS:0};const[Z,Y,W]=ER(N),de=[H(z,1,Z),H(z,2,Y),H(z,3,W)],ge=de.reduce((ie,Me)=>ie+Me.lengthM,0),ve=de.reduce((ie,Me)=>ie+Me.timeS,0);return{route:z,segments:de,totalLengthM:ge,totalTimeS:ve}})}function Fw(r){return r==="A"?"":r==="B"?"":""}function Wy(r){const u=Math.max(0,Math.round(r)),l=Math.floor(u/60),f=u%60;return`${l}:${String(f).padStart(2,"0")}`}const md=[{key:"speedScore",label:"",color:"#3B82F6"},{key:"economyScore",label:"",color:"#F59E0B"},{key:"scenicScore",label:"",color:"#A855F7"},{key:"commScore",label:"",color:"#22C55E"}];function wb(r){const u=Px(r);return u&&(.2126*u.r+.7152*u.g+.0722*u.b)/255<.55?"white":"#0b0f17"}function AR(r,u,l){const f=th(l),p=Math.round(r.r+(u.r-r.r)*f),b=Math.round(r.g+(u.g-r.g)*f),_=Math.round(r.b+(u.b-r.b)*f);return`rgb(${p},${b},${_})`}function $y({n:r}){return J.jsx("span",{style:{width:22,height:22,borderRadius:999,background:Uh,color:"white",display:"inline-flex",alignItems:"center",justifyContent:"center",fontWeight:950,fontSize:12,boxShadow:"0 1px 6px rgba(0,0,0,0.25)",border:"1px solid rgba(255,255,255,0.25)"},children:r})}function kR({n:r}){return J.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:7,justifyContent:"center"},children:[J.jsx("span",{style:{fontWeight:900,opacity:.9},children:""}),J.jsx($y,{n:r})]})}function Dy(r){const{routeScores:u,selectedRoute:l,onSelectRoute:f,title:p}=r,b=ke.useMemo(()=>{const _=new Map;for(const s of u)_.set(s.route,s);return _},[u]);return J.jsxs("div",{style:{border:"1px solid rgba(255,255,255,0.10)",borderRadius:14,padding:12,background:"rgba(255,255,255,0.04)",height:"fit-content"},children:[J.jsx("div",{style:{fontWeight:950,marginBottom:10,opacity:.9},children:p??" "}),J.jsx("div",{style:{display:"flex",flexDirection:"column",gap:10},children:["A","B","C"].map(_=>{const s=b.get(_),C=_===l;return J.jsxs("div",{onClick:()=>f(_),style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:10,cursor:"pointer",padding:"8px 10px",borderRadius:14,border:C?`3px solid ${Uh}`:"1px solid rgba(255,255,255,0.12)",background:C?"rgba(30,78,216,0.12)":"rgba(0,0,0,0.0)"},title:"   ",children:[J.jsxs("div",{style:{fontWeight:950},children:[" ",Fw(_)]}),J.jsx("div",{style:{opacity:.85,fontWeight:900,fontSize:12},children:s?Wy(s.totalTimeS):"--:--"})]},_)})})]})}function CR(r){const{open:u,onClose:l,routeScores:f,selectedRoute:p,onSelectRoute:b}=r,[_,s]=ke.useState("times"),C=ke.useMemo(()=>{const Z=new Map;for(const Y of f)Z.set(Y.route,Y);return Z},[f]),M=C.get(p)??f[0];if(ke.useEffect(()=>{u||s("times")},[u]),!u)return null;const D=Z=>J.jsxs("div",{style:{border:"1px solid rgba(255,255,255,0.10)",borderRadius:16,padding:14,background:"rgba(255,255,255,0.04)"},children:[J.jsx("div",{style:{fontWeight:950,fontSize:15,textAlign:"right"},children:Z.title}),Z.subtitle?J.jsx("div",{style:{marginTop:6,fontSize:12,opacity:.82,textAlign:"right"},children:Z.subtitle}):null,J.jsx("div",{style:{marginTop:12},children:Z.children})]}),B=Z=>J.jsx("button",{onClick:Z.onClick,title:Z.title,style:{border:Z.active?`2px solid ${Uh}`:"1px solid rgba(255,255,255,0.12)",borderRadius:999,padding:"8px 12px",background:Z.active?"rgba(140,203,255,0.18)":"rgba(255,255,255,0.06)",color:"#e8eefc",cursor:"pointer",fontWeight:900,fontSize:13,lineHeight:1},children:Z.children}),U=()=>J.jsx("div",{style:{padding:12,opacity:.85,lineHeight:1.5},children:"   .    ."}),j=()=>{if(!f.length)return J.jsx(U,{});const Z=Math.max(1,...f.map(ve=>ve.totalTimeS||0)),Y=Math.max(1,Math.ceil(Z/60)),de=[1,2,3,5,10,15,20,30,60].find(ve=>Math.ceil(Y/ve)<=6)??1,ge=Array.from({length:Math.floor(Y/de)+1},(ve,ie)=>ie*de);return ge[ge.length-1]!==Y&&ge.push(Y),J.jsxs(D,{title:" ",subtitle:"    .      .",children:[J.jsx("div",{style:{display:"flex",flexDirection:"column",gap:10},children:["A","B","C"].map(ve=>{const ie=C.get(ve);if(!ie)return null;const Me=ve===p,we=20;let Ge=0;return J.jsxs("div",{onClick:()=>b(ve),style:{display:"grid",gridTemplateColumns:"84px 1fr 72px",gap:10,alignItems:"center",cursor:"pointer",padding:"8px 10px",borderRadius:14,border:Me?`3px solid ${Uh}`:"1px solid rgba(255,255,255,0.10)",background:Me?"rgba(30,78,216,0.10)":"transparent"},title:"   ",children:[J.jsxs("div",{style:{fontWeight:950,fontSize:14,textAlign:"right"},children:[" ",Fw(ve)]}),J.jsx("div",{style:{position:"relative",height:we,borderRadius:10,overflow:"hidden",border:"1px solid rgba(255,255,255,0.14)",background:"rgba(0,0,0,0.10)"},children:ie.segments.map(et=>{const pe=th(et.timeS/Z)*100,Je=th(Ge/Z)*100;Ge+=et.timeS;const le=pe>=4;return J.jsx("div",{style:{position:"absolute",right:`${Je}%`,width:`${pe}%`,top:0,bottom:0,background:Me?Uh:K0,opacity:Me?C1:Math.min(.75,Ux+.18),display:"flex",alignItems:"center",justifyContent:"center",fontWeight:950,color:"white",fontSize:13,textShadow:"0 1px 2px rgba(0,0,0,0.40)",borderLeft:"3px solid rgba(255,255,255,0.70)",boxSizing:"border-box"},title:` ${et.segment}: ${Wy(et.timeS)}`,children:le?String(et.segment):""},et.segment)})}),J.jsx("div",{style:{textAlign:"left",fontWeight:900,fontSize:13},children:Wy(ie.totalTimeS)})]},ve)})}),J.jsx("div",{style:{marginTop:12},children:J.jsxs("div",{style:{display:"grid",gridTemplateColumns:"84px 1fr 72px",gap:10,alignItems:"center"},children:[J.jsx("div",{}),J.jsxs("div",{style:{position:"relative",height:26},children:[J.jsx("div",{style:{position:"absolute",insetInlineStart:0,insetInlineEnd:0,top:12,height:2,background:"rgba(255,255,255,0.20)"}}),ge.map(ve=>{const ie=ve*60,Me=th(ie/Z)*100;return J.jsxs("div",{style:{position:"absolute",right:`${Me}%`,top:0,transform:"translateX(50%)",textAlign:"center",whiteSpace:"nowrap"},children:[J.jsx("div",{style:{width:2,height:10,background:"rgba(255,255,255,0.28)",margin:"0 auto"}}),J.jsx("div",{style:{fontSize:11,opacity:.88,marginTop:4},children:ve})]},ve)})]}),J.jsx("div",{})]})})]})},H=()=>{const Z=M?.segments??[];if(!Z.length)return J.jsx(U,{});const Y=240,W=md.length*100;return J.jsx(D,{title:" ",subtitle:"   ( ,   100%).",children:J.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 220px",gap:14,alignItems:"start"},children:[J.jsx("div",{style:{overflowX:"auto"},children:J.jsx("div",{style:{display:"flex",gap:14,alignItems:"flex-end",paddingBottom:6},children:Z.map(de=>{let ge=0;return J.jsxs("div",{style:{width:180,textAlign:"center"},children:[J.jsx("div",{style:{height:Y,position:"relative",border:"1px solid rgba(255,255,255,0.12)",borderRadius:0,overflow:"hidden",background:"rgba(0,0,0,0.10)"},children:md.map(ve=>{const ie=Math.max(0,Math.min(100,Number(de[ve.key]??0))),Me=ie/W*Y,we=ge;ge+=Me;const Ge=Me<24;return J.jsx("div",{style:{position:"absolute",left:0,right:0,bottom:we,height:Me,background:ve.color,opacity:.95,borderTop:"1px solid rgba(255,255,255,0.2)",zIndex:Ge?10:1,overflow:"visible",boxSizing:"border-box"},title:`${ve.label}: ${Math.round(ie)}`,children:J.jsxs("div",{style:{position:"absolute",top:"50%",left:0,right:0,transform:"translateY(-50%)",display:"flex",alignItems:"center",justifyContent:"center",gap:6,whiteSpace:"nowrap",pointerEvents:"none",color:"#ffffff",textShadow:"0 1px 3px rgba(0,0,0,0.9), 0 0 2px rgba(0,0,0,0.8)",fontWeight:950,fontSize:12,padding:"0 4px"},children:[J.jsx("span",{style:{opacity:1},children:ve.label}),J.jsx("span",{children:Math.round(ie)})]})},ve.key)})}),J.jsx("div",{style:{marginTop:10,fontWeight:950},children:J.jsx(kR,{n:de.segment})})]},de.segment)})})}),J.jsx(Dy,{routeScores:f,selectedRoute:p,onSelectRoute:b})]})})},z=()=>{const Y=(M?.segments??[]).slice(0,3);if(!Y.length)return J.jsx(U,{});const W=240,de=W/2,ge=W/2,ve=86,ie=(we,Ge)=>{const et=-Math.PI/2+we*2*Math.PI/md.length;return{x:de+Math.cos(et)*ve*Ge,y:ge+Math.sin(et)*ve*Ge}},Me=we=>md.map((Ge,et)=>{const pe=th(Number(we[Ge.key]??0)/100),Je=ie(et,pe);return`${Je.x},${Je.y}`}).join(" ");return J.jsx(D,{title:" ",subtitle:"3  ( 13).     .",children:J.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 220px",gap:14,alignItems:"start"},children:[J.jsx("div",{style:{display:"flex",gap:16,flexWrap:"wrap",justifyContent:"space-evenly"},children:Y.map(we=>J.jsxs("div",{style:{width:300,border:"1px solid rgba(255,255,255,0.10)",borderRadius:16,padding:12,background:"rgba(0,0,0,0.06)"},children:[J.jsx("div",{style:{fontWeight:950,marginBottom:8,textAlign:"right"},children:J.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:8},children:[J.jsx("span",{style:{fontWeight:950},children:""}),J.jsx($y,{n:we.segment})]})}),J.jsxs("svg",{width:W,height:W,style:{display:"block",margin:"0 auto"},children:[[.25,.5,.75,1].map(Ge=>J.jsx("circle",{cx:de,cy:ge,r:ve*Ge,fill:"none",stroke:Ge===1?"rgba(255,255,255,0.30)":"rgba(255,255,255,0.14)",strokeWidth:Ge===1?1.6:1},Ge)),md.map((Ge,et)=>{const pe=ie(et,1);return J.jsx("line",{x1:de,y1:ge,x2:pe.x,y2:pe.y,stroke:"rgba(255,255,255,0.20)"},Ge.key)}),J.jsx("polygon",{points:Me(we),fill:Uh,fillOpacity:.2,stroke:Uh,strokeWidth:2}),md.map((Ge,et)=>{const pe=ie(et,1.18),Je=Math.round(Number(we[Ge.key]??0)),le=Ge.color,ut=wb(le);return J.jsx("foreignObject",{x:pe.x-55,y:pe.y-13,width:110,height:26,children:J.jsxs("div",{style:{width:"110px",height:"26px",display:"flex",alignItems:"center",justifyContent:"center",gap:6,background:le,color:ut,borderRadius:999,fontSize:11,fontWeight:950,boxShadow:"0 1px 6px rgba(0,0,0,0.25)",border:"1px solid rgba(255,255,255,0.20)",whiteSpace:"nowrap",paddingInline:8,boxSizing:"border-box"},children:[J.jsx("span",{children:Ge.label}),J.jsx("span",{style:{opacity:.95},children:Je})]})},Ge.key)})]})]},we.segment))}),J.jsx(Dy,{routeScores:f,selectedRoute:p,onSelectRoute:b})]})})},N=()=>{const Z=M?.segments??[];if(!Z.length)return J.jsx(U,{});const Y=Px(K0)??{r:140,g:203,b:255},W={r:255,g:255,b:255},de=ve=>{const Me=.12+.42*th((ve??0)/100);return AR(W,Y,Me)},ge=96;return J.jsx(D,{title:" ",subtitle:"    .    (   ).",children:J.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 220px",gap:14,alignItems:"start"},children:[J.jsx("div",{style:{overflowX:"auto"},children:J.jsxs("table",{style:{width:"max-content",borderCollapse:"separate",borderSpacing:6,direction:"rtl"},children:[J.jsx("thead",{children:J.jsxs("tr",{children:[J.jsx("th",{style:{textAlign:"right",fontSize:12,opacity:.9,padding:2,width:78},children:""}),md.map(ve=>J.jsx("th",{style:{textAlign:"center",fontSize:12,padding:2,width:ge},children:J.jsx("div",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",gap:6,background:ve.color,color:wb(ve.color),borderRadius:999,padding:"4px 10px",fontWeight:950,border:"1px solid rgba(255,255,255,0.20)",boxShadow:"0 1px 6px rgba(0,0,0,0.18)",whiteSpace:"nowrap"},children:ve.label})},ve.key))]})}),J.jsx("tbody",{children:Z.map(ve=>J.jsxs("tr",{children:[J.jsx("td",{style:{padding:2,textAlign:"right",width:78},children:J.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8},children:[J.jsx("span",{style:{fontWeight:900,opacity:.9},children:""}),J.jsx($y,{n:ve.segment})]})}),md.map(ie=>{const Me=Math.round(Number(ve[ie.key]??0));return J.jsx("td",{style:{padding:2,width:ge},children:J.jsx("div",{style:{background:de(Me),borderRadius:10,padding:"8px 6px",textAlign:"center",fontWeight:950,color:"rgba(8,10,14,0.92)",border:"1px solid rgba(0,0,0,0.10)"},title:`${ie.label}: ${Me}`,children:Me})},ie.key)})]},ve.segment))})]})}),J.jsx(Dy,{routeScores:f,selectedRoute:p,onSelectRoute:b})]})})};return J.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.60)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",padding:16},onClick:l,children:J.jsxs("div",{style:{width:"min(1080px, 96vw)",maxHeight:"92vh",overflow:"auto",borderRadius:18,background:"#0b0f17",color:"#e8eefc",border:"1px solid rgba(255,255,255,0.10)",boxShadow:"0 24px 60px rgba(0,0,0,0.45)"},onClick:Z=>Z.stopPropagation(),children:[J.jsxs("div",{style:{padding:14,display:"flex",justifyContent:"space-between",alignItems:"center",gap:10},children:[J.jsx("div",{style:{fontWeight:950,fontSize:16},children:""}),J.jsx("button",{onClick:l,style:{padding:"8px 12px",borderRadius:10,border:"1px solid rgba(255,255,255,0.14)",background:"rgba(255,255,255,0.06)",color:"white",cursor:"pointer",fontWeight:900},children:""})]}),J.jsxs("div",{style:{padding:"10px 14px",borderBottom:"1px solid rgba(255,255,255,0.10)",display:"flex",gap:10,flexWrap:"wrap"},children:[J.jsx(B,{active:_==="times",onClick:()=>s("times"),children:" "}),J.jsx(B,{active:_==="bars",onClick:()=>s("bars"),children:" "}),J.jsx(B,{active:_==="radar",onClick:()=>s("radar"),children:" "}),J.jsx(B,{active:_==="heatmap",onClick:()=>s("heatmap"),children:" "})]}),J.jsxs("div",{style:{padding:14,overflow:"auto",display:"flex",flexDirection:"column",gap:14},children:[_==="times"&&J.jsx(j,{}),_==="bars"&&J.jsx(H,{}),_==="radar"&&J.jsx(z,{}),_==="heatmap"&&J.jsx(N,{})]})]})})}function Tb(r){return r*r}function Ry(r,u){return Tb(r[0]-u[0])+Tb(r[1]-u[1])}function MR(r,u,l){const f=Ry(u,l);if(f===0)return Ry(r,u);let p=((r[0]-u[0])*(l[0]-u[0])+(r[1]-u[1])*(l[1]-u[1]))/f;return p=Math.max(0,Math.min(1,p)),Ry(r,[u[0]+p*(l[0]-u[0]),u[1]+p*(l[1]-u[1])])}function DR(r,u,l){return Math.sqrt(MR(r,u,l))}function RR(r,u){let l=Number.MAX_VALUE;for(let f=0;f<u.length-1;f++){const p=DR(r,u[f],u[f+1]);p<l&&(l=p)}return l}function IR(){const r=ke.useRef(null),u=ke.useRef(null),[l,f]=ke.useState(0),[p,b]=ke.useState(.5),[_,s]=ke.useState(2),[C,M]=ke.useState(!0),[D,B]=ke.useState("he"),U=ke.useRef({}),[j,H]=ke.useState(!0),[z,N]=ke.useState(!0),[Z,Y]=ke.useState(!0),[W,de]=ke.useState(!0),[ge,ve]=ke.useState("vector"),[ie,Me]=ke.useState("TRIPLE"),we=ke.useRef("TRIPLE");ke.useEffect(()=>{we.current=ie},[ie]);const[Ge,et]=ke.useState(!1),pe=ke.useRef(!1);ke.useEffect(()=>{pe.current=Ge},[Ge]),ke.useEffect(()=>{ie!=="TRIPLE"&&et(!1)},[ie]);const[Je,le]=ke.useState(!1),[ut,tt]=ke.useState(!0),[We,$t]=ke.useState(!0),[Be,Mt]=ke.useState(!0),[me,re]=ke.useState(.35),[Ve,Pe]=ke.useState(3),[De,bt]=ke.useState(50),[Vt,Zt]=ke.useState(600),[jt,Yt]=ke.useState(.35),[jr,Qe]=ke.useState(2),[_n,se]=ke.useState(80),[Rt,yt]=ke.useState(700),[Ee,Ne]=ke.useState(.35),[dt,Kt]=ke.useState(2),[Jt,kt]=ke.useState(200),[lr,pr]=ke.useState(600),[sr,st]=ke.useState(.35),[fe,ue]=ke.useState([]),[ye,je]=ke.useState([]),[$e,_t]=ke.useState([]),lt=ke.useCallback(ee=>{const Ke=[];for(const ht of ee)_x(ht.coords,250).forEach((St,_r)=>Ke.push({coord:St,side:_r%2===0?"left":"right"}));return Ke},[]);ke.useEffect(()=>{const ee=u.current;if(!ee||!ee.isStyleLoaded())return;if(ee.getSource("satellite-source")||ee.addSource("satellite-source",{type:"raster",tiles:[XD],tileSize:512}),!ee.getLayer("satellite-layer")){const St=ee.getStyle().layers||[];let _r;for(const Kr of St)if(Kr.type!=="background"){_r=Kr.id;break}ee.addLayer({id:"satellite-layer",type:"raster",source:"satellite-source",paint:{"raster-opacity":0,"raster-fade-duration":300}},_r)}const Ke=ge==="satellite",ht=Ke?0:1;ee.setPaintProperty("satellite-layer","raster-opacity",Ke?1:0);const er=ee.getStyle();er&&er.layers&&er.layers.forEach(St=>{if(!(St.id==="satellite-layer"||St.id.startsWith("triple-")||St.id.startsWith("single-")||St.id.startsWith("measure-")||St.id.startsWith("manual-")||St.id.startsWith("cat-")||St.id.startsWith("start-")||St.id.startsWith("end-")||St.id.startsWith("edit-"))){if(St.type==="background")ee.setPaintProperty(St.id,"background-opacity",ht);else if((St.type==="fill"||St.type==="fill-extrusion")&&!St.id.includes("road")&&!St.id.includes("transit")){const _r=St.type==="fill"?"fill-opacity":"fill-extrusion-opacity";ee.setPaintProperty(St.id,_r,ht)}if(St.type==="symbol")try{Ke?(ee.setPaintProperty(St.id,"text-color","#ffffff"),ee.setPaintProperty(St.id,"text-halo-color","#000000"),ee.setPaintProperty(St.id,"text-halo-width",1.5)):ee.setPaintProperty(St.id,"text-halo-width",1)}catch{}}})},[ge]),ke.useEffect(()=>{_t(lt(ye))},[ye]);const[at,vt]=ke.useState([]),Bt=ke.useRef(fe),Ht=ke.useRef(ye),Tr=ke.useRef(at);ke.useEffect(()=>{Bt.current=fe},[fe]),ke.useEffect(()=>{Ht.current=ye},[ye]),ke.useEffect(()=>{Tr.current=at},[at]),ke.useEffect(()=>{const ee=u.current;ee&&cr(ee,"cat-traffic",mi(fe.map(Ke=>({coords:Ke.coords,props:{id:Ke.id}}))))},[fe]),ke.useEffect(()=>{const ee=u.current;ee&&cr(ee,"cat-toll",mi(ye.map(Ke=>({coords:Ke.coords,props:{id:Ke.id}}))))},[ye]),ke.useEffect(()=>{const ee=u.current;ee&&cr(ee,"cat-toll-labels",In($e.map(Ke=>Ke.coord),$e.map(Ke=>({label:"",side:Ke.side}))))},[$e]),ke.useEffect(()=>{const ee=u.current;ee&&cr(ee,"cat-comm",B0(at.map(Ke=>({coords:Ke.ring,props:{id:Ke.id,radiusM:Ke.radiusM}}))))},[at]);const[hr,Gr]=ke.useState([]),[xn,an]=ke.useState(!1),[xt,Ln]=ke.useState(null),ya=ke.useRef(null),Mr=ke.useCallback(ee=>{Ln(ee),ya.current&&window.clearTimeout(ya.current),ya.current=window.setTimeout(()=>Ln(null),2200)},[]),Fn=["","","",""],Ga=[" "," 1"," 2"," 3"],Vn=["High","Medium","Low"],va=["Elimination","Weighted","Lexicographic"],[gn,ga]=ke.useState(""),[Yi,xo]=ke.useState(" "),[Xt,xe]=ke.useState("None"),[Ue,Fe]=ke.useState(!1),[Re,Te]=ke.useState(""),[ze,mt]=ke.useState(3),[Ut,It]=ke.useState("Medium"),[Tt,gt]=ke.useState("Elimination"),[ir,vr]=ke.useState(3),[Sr,dr]=ke.useState(2),[xr,Nr]=ke.useState(1),Wn=ke.useCallback(()=>{if(!hr||hr.length===0){alert("  . /   ' '   .");return}const ee=";",Ke=gr=>{const Fr=gr==null?"":String(gr),yn=Fr.includes('"')||Fr.includes(`
`)||Fr.includes("\r")||Fr.includes(ee),Wr=Fr.replace(/"/g,'""');return yn?`"${Wr}"`:Wr},ht=(gr,Fr=2)=>{const yn=typeof gr=="number"&&Number.isFinite(gr)?gr:NaN;return Number.isFinite(yn)?Fr===0?String(Math.round(yn)):yn.toFixed(Fr):""},er=gr=>{const Fr=gr.reduce((Wr,ln)=>Wr+(Number.isFinite(ln.w)?ln.w:0),0);return Fr<=0?0:gr.reduce((Wr,ln)=>Wr+(Number.isFinite(ln.w)?ln.w:0)*(Number.isFinite(ln.v)?ln.v:0),0)/Fr},St=["","","_","_","_","_0_100","_0_100","_0_100","_0_100","_0_100","","_share","_share","_share","_share"],_r={A:1,B:2,C:3},Kr=[...hr].sort((gr,Fr)=>(_r[gr.route]??99)-(_r[Fr.route]??99)),un={1:{min:1/0,max:-1/0},2:{min:1/0,max:-1/0},3:{min:1/0,max:-1/0}};Kr.forEach(gr=>{gr.segments.forEach(Fr=>{const yn=Fr.segment,Wr=Number(Fr.timeS??0);Number.isFinite(Wr)&&(un[yn].min=Math.min(un[yn].min,Wr),un[yn].max=Math.max(un[yn].max,Wr))})});const Jr=(gr,Fr)=>{const yn=un[gr].min,Wr=un[gr].max;if(!Number.isFinite(yn)||!Number.isFinite(Wr)||Wr<=yn+1e-6)return 100;const ln=(Wr-Fr)/(Wr-yn);return Math.max(0,Math.min(100,ln*100))},Or=(gr,Fr)=>{switch(Fr){case"":return Number(gr.speedScore??0);case"":return Number(gr.economyScore??0);case"":return Number(gr.scenicScore??0);case"":return Number(gr.commScore??0);default:return 0}},Lr=Tt==="Weighted"?`${gn}${ir}${Xt!=="None"?` + ${Xt}${Sr}`:""} + ${xr}`:"",Ur=gr=>{const Fr=Jr(gr.segment,Number(gr.timeS??0));if(Tt!=="Weighted"){const Yr=Number(gr.speedScore??0),Xr=Number(gr.economyScore??0),On=Number(gr.scenicScore??0),Cn=Number(gr.commScore??0);return Math.round((Yr+Xr+On+Cn)/4)}const yn=Or(gr,gn),Wr=Xt==="None"?0:Or(gr,Xt),ln=Number(ir??0),Vr=Xt==="None"?0:Number(Sr??0),en=Number(xr??0),$r=Math.max(1e-6,ln+Vr+en);return Math.round((ln*yn+Vr*Wr+en*Fr)/$r)},mr=[];mr.push(St.map(Ke).join(ee)),Kr.forEach(gr=>{const Fr=gr.segments;Fr.forEach(Xr=>{const On=` ${Xr.segment}`;mr.push([gr.route,On,ht(Xr.lengthM,0),ht(Xr.timeS,0),ht(Xr.timeS/60,2),ht(Xr.speedScore,2),ht(Xr.economyScore,2),ht(Xr.scenicScore,2),ht(Xr.commScore,2),ht(Ur(Xr),0),Lr,ht(Xr.fracTraffic,3),ht(Xr.fracToll,3),ht(Xr.fracScenic,3),ht(Xr.fracComm,3)].map(Ke).join(ee))});const yn=Fr.reduce((Xr,On)=>Xr+(typeof On.lengthM=="number"?On.lengthM:0),0),Wr=Fr.reduce((Xr,On)=>Xr+(typeof On.timeS=="number"?On.timeS:0),0),ln=er(Fr.map(Xr=>({w:Number(Xr.lengthM)||0,v:Number(Xr.speedScore)||0}))),Vr=er(Fr.map(Xr=>({w:Number(Xr.lengthM)||0,v:Number(Xr.economyScore)||0}))),en=er(Fr.map(Xr=>({w:Number(Xr.lengthM)||0,v:Number(Xr.scenicScore)||0}))),$r=er(Fr.map(Xr=>({w:Number(Xr.lengthM)||0,v:Number(Xr.commScore)||0}))),Yr=er(Fr.map(Xr=>({w:Number(Xr.lengthM)||0,v:Number(Ur(Xr))||0})));mr.push([gr.route,'"',ht(yn,0),ht(Wr,0),ht(Wr/60,2),ht(ln,2),ht(Vr,2),ht(en,2),ht($r,2),ht(Yr,0),Lr,"","","",""].map(Ke).join(ee))});const Dr="\uFEFF"+mr.join(`
`),Ar=new Blob([Dr],{type:"text/csv;charset=utf-8;"}),yr=URL.createObjectURL(Ar),Ir=document.createElement("a");Ir.href=yr;const pn=new Date().toISOString().slice(0,19).replace(/[:T]/g,"-");Ir.download=`geovis_results_${pn}.csv`,document.body.appendChild(Ir),Ir.click(),Ir.remove(),URL.revokeObjectURL(yr)},[hr]),[mn,tn]=ke.useState(.8),[oi,xs]=ke.useState(""),[li,wi]=ke.useState("Auto"),[za,Ti]=ke.useState(null),[ss,os]=ke.useState("");ke.useRef("");const Dn="GeoVisLab_DebugLog.json",[Zh,hu]=ke.useState(!1),[Ki,ih]=ke.useState(()=>`Scenario_${new Date().toISOString().slice(0,10)}_${Date.now()}`),[Wo,Pf]=ke.useState("     .         ."),[gi,fu]=ke.useState(""),[Sl,du]=ke.useState("STACKED"),[Ms,Wh]=ke.useState("A"),[Jl,Ks]=ke.useState("downloads"),[sh,$o]=ke.useState(null),[Pc,yo]=ke.useState("Downloads"),[Js,Ql]=ke.useState(""),[fn,Ds]=ke.useState(!1),[ec,pu]=ke.useState(!0),[ba,Ha]=ke.useState(!0),[wa,Qr]=ke.useState(!1),[Yn,ys]=ke.useState(!1),[zn,Oa]=ke.useState([]),la=ke.useRef([]);ke.useEffect(()=>{la.current=zn},[zn]);const _a=ke.useRef({}),vo=ke.useRef(1),[Rn,Si]=ke.useState(!1),[ri,Qs]=ke.useState(!1),Ri=ke.useRef(!1);ke.useEffect(()=>{Ri.current=ri},[ri]);const[qa,Da]=ke.useState(null),El=ke.useRef(null);ke.useEffect(()=>{El.current=qa},[qa]);const[Al,ls]=ke.useState([]),Zn=ke.useRef([]);ke.useEffect(()=>{Zn.current=Al},[Al]);const[Xo,cn]=ke.useState(null),sn=ke.useRef(null);ke.useEffect(()=>{sn.current=Xo},[Xo]);const[bo,bn]=ke.useState(null),Fc=ke.useRef(null);ke.useEffect(()=>{Fc.current=bo},[bo]);const _i=ke.useRef(!1);ke.useEffect(()=>{_i.current=Rn},[Rn]);const[Rs,Ji]=ke.useState([]),oh=ke.useRef([]);ke.useEffect(()=>{oh.current=Rs},[Rs]);const vs=ke.useRef(null);ke.useEffect(()=>{if(bu(),!u.current)return;const Ke=new Set(zn.map(ht=>ht.id));for(const ht of Object.keys(_a.current))if(!Ke.has(ht)){try{_a.current[ht].remove()}catch{}delete _a.current[ht]}for(const ht of zn)_a.current[ht.id]||En(ht);Uc()},[zn,bu,En,Uc]),ke.useEffect(()=>{wu()},[Rs,wu]),ke.useEffect(()=>{const ee=u.current;if(!ee)return;const Ke=ba?"visible":"none";for(const ht of["manual-parks-fill","manual-parks-outline","manual-park-draft-line-layer","manual-park-draft-points-layer","manual-park-preview-line-layer"])if(ee.getLayer(ht))try{ee.setLayoutProperty(ht,"visibility",Ke)}catch{}Uc()},[ba,Uc]),ke.useEffect(()=>{const ee=u.current;if(!ee)return;const Ke=ec?"visible":"none";for(const ht of tc.current)if(ee.getLayer(ht))try{ee.setLayoutProperty(ht,"visibility",Ke)}catch{}},[ec]),ke.useEffect(()=>{const ee=Ke=>{const ht=_i.current,er=El.current;if(!(!ht&&!er)){if(Ke.key==="Escape"){Ke.preventDefault(),ht&&(Ji([]),vs.current=null,Si(!1)),er&&(ls([]),cn(null),Da(null)),bn(null);return}(Ke.key==="Delete"||Ke.key==="Backspace")&&(Ke.preventDefault(),ht&&Ji(St=>St.slice(0,Math.max(0,St.length-1))),er&&(er==="comm"?cn(null):ls(St=>St.slice(0,Math.max(0,St.length-1)))))}};return window.addEventListener("keydown",ee),()=>window.removeEventListener("keydown",ee)},[]),ke.useEffect(()=>{const ee=u.current;if(!ee)return;const Ke=ht=>{if(Rn)ee.getCanvas().style.cursor="crosshair";else if(ri)if(ht&&ht.point){const er=ee.queryRenderedFeatures(ht.point,{layers:tc.current});ee.getCanvas().style.cursor=er.length>0?"copy":"default"}else ee.getCanvas().style.cursor="default";else ee.getCanvas().style.cursor=""};return ri?ee.on("mousemove",Ke):(Ke(),ee.off("mousemove",Ke)),()=>{ee.off("mousemove",Ke)}},[Rn,ri]);const tc=ke.useRef([]),[Lc,mu]=ke.useState([]),Ii=ke.useMemo(()=>_d(Lc),[Lc]),[ci,ca]=ke.useState([]),[Yo,Ko]=ke.useState([]),[gu,Ta]=ke.useState(!1),$h=ke.useMemo(()=>_d(Yo.length?Yo:ci),[Yo,ci]),[Gn,_u]=ke.useState(null),[Kn,wo]=ke.useState(null),[kl,Cl]=ke.useState(.35),[Ml,rc]=ke.useState(!1),[Jo,nc]=ke.useState(0),[Ra,To]=ke.useState([]),[ac,So]=ke.useState([]),eo=ke.useRef([]),lh=ke.useRef([]);ke.useEffect(()=>{eo.current=Ra},[Ra]),ke.useEffect(()=>{lh.current=ac},[ac]);const Dl=ke.useMemo(()=>!!Gn&&!!Kn,[Gn,Kn]),Xh=ke.useMemo(()=>!(j&&z&&Z&&W&&ec&&ba&&ut&&We&&Be),[j,z,Z,W,ec,ba,ut,We,Be]),Is=ke.useRef(null),xu=ke.useRef(null);ke.useEffect(()=>{Is.current=Gn,xu.current=Kn},[Gn,Kn]);const[Za,Qo]=ke.useState("A"),Aa=ke.useRef({A:[],B:[],C:[]}),[bs,Ps]=ke.useState(!1),Rl=ke.useRef(!1);ke.useEffect(()=>{Rl.current=bs},[bs]);const zc=ke.useRef("A");ke.useEffect(()=>{zc.current=Za},[Za]);const Qi=ke.useRef({A:[],B:[],C:[]}),[el,Il]=ke.useState([]),ic=ke.useRef([]);ke.useEffect(()=>{ic.current=el},[el]);const[tl,to]=ke.useState(new Set),Oc=ke.useRef(new Set);ke.useEffect(()=>{Oc.current=tl},[tl]);const[Bc,Pl]=ke.useState([]),ch=ke.useRef([]);ke.useEffect(()=>{ch.current=Bc},[Bc]);const[Fs,ro]=ke.useState(-1),Nc=ke.useRef(-1);ke.useEffect(()=>{Nc.current=Fs},[Fs]);const es=ke.useRef(()=>{}),Fl=ke.useRef(()=>{}),Ls=ke.useRef(()=>{}),yu=ke.useRef(()=>{}),uh=ke.useCallback(ee=>{const Ke=u.current;if(!Ke||!Ke.isStyleLoaded())return;try{Sf(Ke)}catch{}const ht=Aa.current.A,er=Aa.current.B,St=Aa.current.C,_r=sR([ht,er,St]);if(!_r)return;const Kr=oR(_r,.12),un=iR(Ke,Kr),Jr=un.length>0,Or=Math.max(0,Math.min(1,ee??me)),Lr=(Vr,en,$r)=>Math.max(en,Math.min($r,Math.round(Vr))),Ur=(Vr,en,$r)=>{const Yr=Math.max(0,Math.min(1,en*Or)),Xr=(yp()*2-1)*Vr*Yr;return Lr(Vr+Xr,0,$r)},mr=()=>{const Vr=xb(0,2);return Vr===0?ht:Vr===1?er:St},Dr=Jr?Math.max(0,Math.min(.92,.35+.5*Or)):0,Ar=()=>Jr&&yp()<Dr?un[xb(0,un.length-1)]:mr(),yr=Ur(Ve,jt,8),Ir=[];for(let Vr=0;Vr<yr;Vr++){const en=Ar();if(en.length<2)continue;const $r=ou(en),Yr=$r[$r.length-1]||0;if(Yr<60)continue;const Xr=Math.max(0,Math.min(1,jt*Or)),On=Mc(De,Vt),Cn=Math.max(50,Math.min(2e3,On*(1+(yp()*2-1)*.6*Xr))),Wa=Mc(0,Math.max(0,Yr-Cn)),$a=cx(en,Wa,Wa+Cn);Ir.push({id:`traffic_${Vr}_${Date.now()}`,coords:$a})}const pn=Ur(jr,Ee,6),gr=[],Fr=[];for(let Vr=0;Vr<pn;Vr++){const en=Ar();if(en.length<2)continue;const $r=ou(en),Yr=$r[$r.length-1]||0;if(Yr<60)continue;const Xr=Math.max(0,Math.min(1,Ee*Or)),On=Mc(_n,Rt),Cn=Math.max(50,Math.min(2e3,On*(1+(yp()*2-1)*.6*Xr))),Wa=Mc(0,Math.max(0,Yr-Cn)),$a=cx(en,Wa,Wa+Cn);gr.push({id:`toll_${Vr}_${Date.now()}`,coords:$a});const nl=_x($a,250);for(const Fi of nl)Fr.push({coord:Fi,side:yp()<.5?"left":"right"})}const yn=Ur(dt,sr,3),Wr=[];for(let Vr=0;Vr<yn;Vr++){const en=Math.max(0,Math.min(1,sr*Or)),$r=Mc(Jt,lr),Xr=Math.max(100,Math.min(1e3,$r*(1+(yp()*2-1)*.7*en)))/2,On=lR(Kr),Cn=Ey(On,Xr);Wr.push({id:`comm_${Vr}_${Date.now()}`,ring:Cn,radiusM:Xr})}cr(Ke,"cat-traffic",mi(Ir.map(Vr=>({coords:Vr.coords,props:{id:Vr.id}})))),cr(Ke,"cat-toll",mi(gr.map(Vr=>({coords:Vr.coords,props:{id:Vr.id}})))),cr(Ke,"cat-toll-labels",In(Fr.map(Vr=>Vr.coord),Fr.map(Vr=>({side:Vr.side})))),cr(Ke,"cat-comm",B0(Wr.map(Vr=>({coords:Vr.ring,props:{id:Vr.id}}))));try{Sf(Ke)}catch{}ue(Ir),je(gr),_t(Fr),vt(Wr);const ln=u.current;if(ln){const Vr=dg(ln,Aa.current,Ir,gr,Wr,la.current);Gr(Vr),an(!1)}},[me,Ve,De,Vt,jt,jr,_n,Rt,Ee,dt,Jt,lr,sr]),vu=ee=>{switch(ee){case" 1":return[0];case" 2":return[1];case" 3":return[2];default:return[0,1,2]}},Ll=(ee,Ke)=>{switch(Ke){case"":return ee.speedScore;case"":return ee.economyScore;case"":return ee.scenicScore;case"":return Math.round(100*th(ee.fracComm));default:return 0}},jc=ee=>ee.length?ee.reduce((Ke,ht)=>Ke+ht,0)/ee.length:0,ws=ke.useCallback(()=>{const ee=u.current,Ke=Aa.current;if(!ee||!Ke.A.length||!Ke.B.length||!Ke.C.length)return;const ht=dg(ee,Ke,[],[],[],la.current),er=[...ht].sort((mr,Dr)=>mr.totalTimeS-Dr.totalTimeS),St=er[1]?.route||er[0]?.route||"A",_r=li==="Auto"?St:li,Kr=uR.filter(mr=>mr!==_r),un=[...Kr].sort((mr,Dr)=>{const Ar=ht.find(Ir=>Ir.route===mr)?.totalTimeS??0,yr=ht.find(Ir=>Ir.route===Dr)?.totalTimeS??0;return Ar-yr});un[0]||Kr[0],un[1]||Kr[1];const Jr=dg(ee,Ke,Bt.current,Ht.current,Tr.current,la.current),Or=Jr.map(mr=>{const Ar=vu(Yi).map(Ir=>Ll(mr.segments[Ir],gn)),yr=jc(Ar);return{rid:mr.route,totalTimeS:mr.totalTimeS,primaryScore:yr,rawStats:mr}});let Lr=_r,Ur="";if(Tt==="Elimination"){const mr=mn*100,Dr=Or.filter(Ar=>Ar.primaryScore>=mr);if(Dr.length>0){Dr.sort((yr,Ir)=>yr.totalTimeS-Ir.totalTimeS),Lr=Dr[0].rid;const Ar=Or.length-Dr.length;Ur=` ${Math.round(mr)}: ${Ar} .  ${Lr} (  : ${(Dr[0].totalTimeS/60).toFixed(1)} ').`}else Or.sort((Ar,yr)=>yr.primaryScore-Ar.primaryScore),Lr=Or[0].rid,Ur=`:       ${Math.round(mr)}.  ${Lr}     (${Math.round(Or[0].primaryScore)}).`}else{const mr=Jr.map(gr=>gr.totalTimeS),Dr=Math.min(...mr),Ar=Math.max(...mr),yr=gr=>Ar<=Dr+1e-6?100:(Ar-gr)/(Ar-Dr)*100,Ir=vu(Yi),pn=[];for(const gr of Jr){const Fr=gr.route,yn=Ir.map(On=>Ll(gr.segments[On],gn)),Wr=Ir.map(On=>Ll(gr.segments[On],Xt)),ln=jc(yn),Vr=jc(Wr),en=yr(gr.totalTimeS),$r=Ue?Ll(gr.segments[ze-1],Re):0;let Yr=0,Xr="";Tt==="Lexicographic"?(Yr=(Ue?$r*1e4:0)+ln*100+Vr*10+en*1,Xr="Lex"):(Yr=ir*ln+Sr*Vr+xr*en+(Ue?ir*$r:0),Xr="W"),pn.push({rid:Fr,score:Yr,note:Xr})}pn.sort((gr,Fr)=>Fr.score-gr.score),Lr=pn[0].rid,Ur=`: ${_r}  : ${Tt}  : ${Lr}`}Ti(Lr),os(Ur),Qo(Lr),Qo(Lr)},[u,Aa,gn,Yi,Xt,Ue,Re,ze,Ut,Tt,ir,Sr,xr,mn,li,ue,je,_t,vt,Oa,Gr,an,Ti,os,Qo]);ke.useEffect(()=>{if(eR(),!r.current||u.current)return;const ee=new H0.Map({container:r.current,style:$D,center:[34.7818,32.0853],zoom:13.8});return ee.on("styleimagemissing",Ke=>{const ht=(Ke?.id??"").toString(),er=new Uint8Array([0,0,0,0]);try{if(ht.trim()===""){ee.hasImage(" ")||ee.addImage(" ",{width:1,height:1,data:er});return}ee.hasImage(ht)||ee.addImage(ht,{width:1,height:1,data:er})}catch{}}),ee.addControl(new H0.NavigationControl,"top-left"),ee.addControl(new H0.ScaleControl({unit:"metric"}),"bottom-left"),ee.on("load",()=>{Sf(ee),cr(ee,"measure-points",In([])),cr(ee,"measure-line",pa([])),cr(ee,"single-points",In([])),cr(ee,"single-line",pa([])),cr(ee,"start-end",In([])),cr(ee,"triple-a",pa([])),cr(ee,"triple-b",pa([])),cr(ee,"triple-c",pa([])),cr(ee,"triple-badge-points",In([])),cr(ee,"triple-badge-lines",mi([])),cr(ee,"triple-seg-points",In([])),cr(ee,"triple-seg-ticks",mi([])),cr(ee,"edit-junctions",In([])),cr(ee,"cat-traffic",mi([])),cr(ee,"cat-toll",mi([])),cr(ee,"cat-toll-labels",In([])),cr(ee,"cat-comm",B0([]));try{Sf(ee)}catch{}ue([]),je([]),_t([]),vt([]),le(!1),cr(ee,"cat-traffic",mi([])),cr(ee,"cat-toll",mi([])),cr(ee,"cat-toll-labels",In([])),cr(ee,"cat-comm",B0([]));try{Sf(ee)}catch{}if(_b(ee,D,U),pd(ee,Zy,j),pd(ee,gb,z),pd(ee,Ke=>mb(Ke)&&!lx(Ke),Z),pd(ee,lx,W),j0(ee,Za),hx(ee,Za),fg(ee,Za),pb(ee),tc.current=bb(ee),f(Ke=>Ke+1),!ee.__badgeDragAttached){ee.__badgeDragAttached=!0;let Ke=null;const ht=_r=>{const Kr=ee.getCanvas();Kr.style.cursor=_r},er=_r=>{const Kr=lh.current;cr(ee,"triple-badge-points",yb(_r)),Kr.length&&cr(ee,"triple-badge-lines",Cy(ee,Kr,_r))};ee.on("mousemove",_r=>{const Kr=ee.queryRenderedFeatures(_r.point,{layers:["triple-badges","triple-badge-text"]});if(Ke){ht("grabbing");return}ht(Kr.length?"grab":"")}),ee.on("mousedown",_r=>{if(_i.current)return;const Jr=ee.queryRenderedFeatures(_r.point,{layers:["triple-badges","triple-badge-text"]})?.[0]?.properties?.id??null;if(Jr){Qo(Jr),zc.current=Jr;try{j0(ee,Jr)}catch{}try{hx(ee,Jr)}catch{}try{fg(ee,Jr)}catch{}Ke=Jr;try{ee.dragPan.disable()}catch{}ht("grabbing"),_r.preventDefault()}}),ee.on("mousemove",_r=>{if(!Ke)return;const Kr=ee.getBounds(),un=[_r.lngLat.lng,_r.lngLat.lat],Jr=hg(un,Kr,.08),Lr=eo.current.map(Ur=>Ur.id===Ke?{...Ur,coord:Jr}:Ur);To(Lr),er(Lr)});const St=()=>{if(Ke){Ke=null;try{ee.dragPan.enable()}catch{}ht("")}};ee.on("mouseup",St),ee.on("mouseleave",St),ee.on("touchend",St)}}),ee.on("style.load",()=>{try{Sf(ee)}catch{}try{pb(ee)}catch{}tc.current=bb(ee),f(Ke=>Ke+1)}),ee.on("click",Ke=>{const ht=[Ke.lngLat.lng,Ke.lngLat.lat];if(Ri.current){const Jr=ee.queryRenderedFeatures(Ke.point,{layers:tc.current});if(Jr.length>0){const Or=Jr[0];let Lr=[];if(Or.geometry.type==="Polygon"?Lr=Or.geometry.coordinates[0]:Or.geometry.type==="MultiPolygon"&&(Lr=Or.geometry.coordinates[0][0]),Lr&&Lr.length>3){const Ur=Lr.map(yr=>[yr[0],yr[1]]),mr=Ur[0],Dr=Ur[Ur.length-1];Math.abs(mr[0]-Dr[0])<1e-6&&Math.abs(mr[1]-Dr[1])<1e-6&&Ur.pop();const Ar={id:`mp_picked_${Date.now()}`,ring:Ur};Oa(yr=>[...yr,Ar]),En(Ar),Mr("    !"),Qs(!1)}else Mr("     .")}else Mr("    .");return}if(_i.current){Eo(ht);return}const er=Fc.current;if(er){const Jr=u.current;if(!Jr)return;const Or=Ke.point,Lr=[[Or.x-6,Or.y-6],[Or.x+6,Or.y+6]],Ur=er==="traffic"?["cat-traffic"]:er==="toll"?["cat-toll-left","cat-toll-right"]:er==="comm"?["cat-comm-fill"]:er==="park"?["manual-parks-fill"]:[],mr=Ur.length?Jr.queryRenderedFeatures(Lr,{layers:Ur}):[],Dr=mr&&mr[0]&&mr[0].properties?.id||"";if(!Dr){Mr("   .     .");return}er==="traffic"?(ue(Ar=>Ar.filter(yr=>yr.id!==Dr)),Mr("  .")):er==="toll"?(je(Ar=>Ar.filter(yr=>yr.id!==Dr)),Mr("  .")):er==="comm"?(vt(Ar=>Ar.filter(yr=>yr.id!==Dr)),Mr("  .")):er==="park"&&(Oa(Ar=>Ar.filter(yr=>yr.id!==Dr)),Mr(" ."));return}const St=El.current;if(St){const Jr=u.current;if(!Jr)return;if(St==="comm"){if(!sn.current)cn(ht),Mr(" .     .");else{const Ur=sn.current,mr=J0(Ur,ht);if(mr<20){Mr("  .     .");return}const Dr=Ey(Ur,mr),Ar=`comm_manual_${Date.now()}`;vt(yr=>[...yr,{id:Ar,ring:Dr,radiusM:mr}]),cn(null),Da(null),Mr("  .")}return}const Lr=(()=>{const Ur=Ke.point,mr=25,Dr=[[Ur.x-mr,Ur.y-mr],[Ur.x+mr,Ur.y+mr]],Ar=Jr.queryRenderedFeatures(Dr,{});let yr=null,Ir=1/0;for(const pn of Ar){const gr=pn.geometry;if(!gr)continue;const Fr=gr.type;if(Fr!=="LineString"&&Fr!=="MultiLineString")continue;const yn=Fr==="LineString"?gr.coordinates:(gr.coordinates||[]).flat(1);for(const Wr of yn){if(!Array.isArray(Wr)||Wr.length<2)continue;const ln=Jr.project({lng:Wr[0],lat:Wr[1]}),Vr=ln.x-Ur.x,en=ln.y-Ur.y,$r=Vr*Vr+en*en;$r<Ir&&(Ir=$r,yr=[Wr[0],Wr[1]])}}return Ir<=mr*mr?yr:null})();if(!Lr){Mr("      .    .");return}ls(Ur=>[...Ur,Lr]);return}const _r=we.current;if(_r==="TRIPLE"&&Rl.current){const Jr=ee.queryRenderedFeatures(Ke.point,{layers:["edit-junction-circles","edit-junction-text"]}),Or=Jr&&Jr[0],Lr=Or&&Or.properties?.jid;if(Lr){es.current(Lr);return}}if(_r==="MEASURE"){mu(Jr=>[...Jr,ht]);return}if(_r==="SINGLE"){ca(Jr=>[...Jr,ht]);return}if(!pe.current)return;const Kr=Is.current,un=xu.current;if(!Kr){_u(ht),wo(null);return}if(!un){wo(ht),et(!1);return}_u(ht),wo(null)}),ee.on("mousemove",Ke=>{_i.current&&(vs.current=[Ke.lngLat.lng,Ke.lngLat.lat],wu())}),ee.on("dblclick",Ke=>{const ht=El.current;if(ht==="traffic"||ht==="toll"){Ke.preventDefault();const er=Zn.current;if(!er||er.length<2){Mr("  2    .");return}const St=`${ht}_manual_${Date.now()}`;ht==="traffic"?(ue(_r=>[..._r,{id:St,coords:er}]),Mr("  .")):(je(_r=>[..._r,{id:St,coords:er}]),Mr("  .")),ls([]),Da(null);return}if(_i.current){Ke.preventDefault();try{Tu(),wu()}catch{}}}),u.current=ee,()=>{ee.remove(),u.current=null}},[]),ke.useEffect(()=>{const ee=u.current;!ee||!ee.isStyleLoaded()||_b(ee,D,U)},[D]),ke.useEffect(()=>{const ee=u.current;!ee||!ee.isStyleLoaded()||(pd(ee,Zy,j),pd(ee,gb,z),pd(ee,Ke=>mb(Ke)&&!lx(Ke),Z),pd(ee,lx,W))},[j,z,Z,W]),ke.useEffect(()=>{const ee=u.current;if(!ee||!ee.isStyleLoaded())return;try{Sf(ee)}catch{}const Ke=(St,_r)=>{if(ee.getLayer(St))try{ee.setLayoutProperty(St,"visibility",_r?"visible":"none")}catch{}};Ke("cat-traffic",ut),Ke("cat-traffic-glow",ut);const ht=We;Ke("cat-toll-shadow",ht),Ke("cat-toll-left",ht),Ke("cat-toll-right",ht),Ke("cat-toll-label-bg",ht),Ke("cat-toll-label-text",ht);const er=Be;Ke("cat-comm-fill",er),Ke("cat-comm-outline",er)},[ut,We,Be]),ke.useEffect(()=>{const ee=u.current;ee&&ee.getSource("measure-points")&&(cr(ee,"measure-points",In(Lc)),cr(ee,"measure-line",pa(Lc)))},[Lc]),ke.useEffect(()=>{const ee=u.current;ee&&ee.getSource("single-points")&&cr(ee,"single-points",In(ci))},[ci]),ke.useEffect(()=>{const ee=u.current;if(!ee||!ee.getSource("single-line"))return;if(ci.length<2){Ko([]),cr(ee,"single-line",pa([]));return}let Ke=!1;return(async()=>{Ta(!0);const ht=await vg(ci);Ke||(ht&&ht.length>=2?(Ko(ht),cr(ee,"single-line",pa(ht))):(Ko([]),cr(ee,"single-line",pa(ci))),Ta(!1))})(),()=>{Ke=!0,Ta(!1)}},[ci]),ke.useEffect(()=>{const ee=u.current;if(!ee||!ee.getSource("start-end"))return;const Ke=[],ht=[];Gn&&(Ke.push(Gn),ht.push({kind:"start",label:""})),Kn&&(Ke.push(Kn),ht.push({kind:"end",label:""})),cr(ee,"start-end",In(Ke,ht))},[Gn,Kn]),ke.useEffect(()=>{const ee=u.current;if(ee&&ee.isStyleLoaded()&&ee.getSource("triple-a")){if(Aa.current={A:[],B:[],C:[]},Qi.current={A:[],B:[],C:[]},Ps(!1),Il([]),to(new Set),Pl([]),ro(-1),!Gn||!Kn){cr(ee,"triple-a",pa([])),cr(ee,"triple-b",pa([])),cr(ee,"triple-c",pa([])),cr(ee,"triple-badge-points",In([])),cr(ee,"triple-badge-lines",mi([])),cr(ee,"triple-seg-points",In([])),cr(ee,"triple-seg-ticks",mi([])),cr(ee,"edit-junctions",In([])),To([]),So([]);return}cr(ee,"triple-a",pa([])),cr(ee,"triple-b",pa([])),cr(ee,"triple-c",pa([])),cr(ee,"triple-badge-points",In([])),cr(ee,"triple-badge-lines",mi([])),cr(ee,"triple-seg-points",In([])),cr(ee,"triple-seg-ticks",mi([])),cr(ee,"edit-junctions",In([])),To([]),So([])}},[Gn,Kn]),ke.useEffect(()=>{const ee=u.current;if(!ee||!Gn||!Kn||!ee.getSource("triple-a")||Jo<=0)return;Qo("A");let Ke=!1;return(async()=>{rc(!0);const ht=ee.getBounds(),er=Math.abs(ht.getEast()-ht.getWest()),St=Math.abs(ht.getNorth()-ht.getSouth()),_r=(.06+kl*.1)*Math.min(er,St),Kr=Kn[0]-Gn[0],un=Kn[1]-Gn[1],Jr=-un,Or=Kr,Lr=Math.sqrt(Jr*Jr+Or*Or)||1,Ur=Jr/Lr,mr=Or/Lr,Dr=Math.sqrt(Kr*Kr+un*un)||1,Ar=Kr/Dr,yr=un/Dr,Ir=[(Gn[0]+Kn[0])/2,(Gn[1]+Kn[1])/2],pn=[Ir[0]+Ur*_r,Ir[1]+mr*_r],gr=[Ir[0]-Ur*_r,Ir[1]-mr*_r],Fr=await vg([Gn,Kn]),yn=await vg([Gn,pn,Kn]),Wr=await vg([Gn,gr,Kn]);if(Ke)return;const ln=Fr??[Gn,Kn],Vr=yn??[Gn,pn,Kn],en=Wr??[Gn,gr,Kn];Aa.current={A:ln,B:Vr,C:en},Qi.current={A:ln,B:Vr,C:en},Ps(!1),Il([]),to(new Set),Pl([]),ro(-1),cr(ee,"edit-junctions",In([])),Qi.current={A:ln,B:Vr,C:en},Ps(!1),Il([]),to(new Set),Pl([]),ro(-1),cr(ee,"edit-junctions",In([])),cr(ee,"triple-a",pa(ln)),cr(ee,"triple-b",pa(Vr)),cr(ee,"triple-c",pa(en));const $r=ux(ln),Yr=ux(Vr),Xr=ux(en),On=[{id:"A",coord:$r},{id:"B",coord:Yr},{id:"C",coord:Xr}];So(On);const Cn=_r*.17,Wa=_r*.17,$a=(Ai,zi,ui)=>{let Ol=[Ai[0]+Ur*Cn*zi+Ar*Wa*ui,Ai[1]+mr*Cn*zi+yr*Wa*ui];return Ol=hg(Ol,ht,.07),Ol};let nl=$a($r,1,.8),Fi=$a(Yr,-1,.8),Li=$a(Xr,1,-.8);const Bs=_r*.45,io=(Ai,zi)=>[Ai[0]+Ur*Cn*.45*zi,Ai[1]+mr*Cn*.45*zi];ky(nl,Fi)<Bs&&(Fi=hg(io(Fi,-1),ht,.07)),ky(nl,Li)<Bs&&(Li=hg(io(Li,1),ht,.07)),ky(Fi,Li)<Bs&&(Li=hg(io(Li,1.4),ht,.07));const so=[{id:"A",label:" ",coord:nl},{id:"B",label:" ",coord:Fi},{id:"C",label:" ",coord:Li}];To(so),cr(ee,"triple-badge-points",yb(so)),cr(ee,"triple-badge-lines",Cy(ee,On,so)),Qo("A"),j0(ee,"A");const Ba=ln;if(!Ba||Ba.length<2)cr(ee,"triple-seg-points",In([])),cr(ee,"triple-seg-ticks",mi([])),cr(ee,"edit-junctions",In([]));else{const{i1:Ai,i2:zi}=xx(Ba),ui=ou(Ba),Ol=ui[ui.length-1]||1,mh=0,us=ui[Ai],dc=ui[zi],al=Ol,Xa=Yl(Ba,ui,(mh+us)/2),Eu=Yl(Ba,ui,(us+dc)/2),gh=Yl(Ba,ui,(dc+al)/2),Hc=50,Yh=Ns=>{const pc=Ba[Ns],Oi=Ba[Math.max(0,Ns-1)],Ss=Ba[Math.min(Ba.length-1,Ns+1)],Bl=Ay(Oi,Ss),ki=-Bl.uy,Ff=Bl.ux,qc=N0(pc,ki*(Hc/2),Ff*(Hc/2)),Au=N0(pc,-ki*(Hc/2),-Ff*(Hc/2));return[qc,Au]},Kh=Yh(Ai),Na=Yh(zi);cr(ee,"triple-seg-points",In([Xa,Eu,gh],[{label:"1"},{label:"2"},{label:"3"}])),cr(ee,"triple-seg-ticks",mi([{coords:Kh},{coords:Na}]))}rc(!1),le(!0),uh()})(),()=>{Ke=!0,rc(!1)}},[Jo]),ke.useEffect(()=>{const ee=u.current;if(!ee||!ee.isStyleLoaded())return;j0(ee,Za),hx(ee,Za),fg(ee,Za);const Ke=Aa.current,ht=Za==="A"?Ke.A:Za==="B"?Ke.B:Ke.C;if(!ht||ht.length<2){cr(ee,"triple-seg-points",In([])),cr(ee,"triple-seg-ticks",mi([])),cr(ee,"edit-junctions",In([]));return}const{i1:er,i2:St}=xx(ht),_r=ou(ht),Kr=_r[_r.length-1]||1,un=0,Jr=_r[er],Or=_r[St],Lr=Kr,Ur=Yl(ht,_r,(un+Jr)/2),mr=Yl(ht,_r,(Jr+Or)/2),Dr=Yl(ht,_r,(Or+Lr)/2),Ar=50,yr=gr=>{const Fr=ht[gr],yn=ht[Math.max(0,gr-1)],Wr=ht[Math.min(ht.length-1,gr+1)],ln=Ay(yn,Wr),Vr=-ln.uy,en=ln.ux,$r=N0(Fr,Vr*(Ar/2),en*(Ar/2)),Yr=N0(Fr,-Vr*(Ar/2),-en*(Ar/2));return[$r,Yr]},Ir=yr(er),pn=yr(St);cr(ee,"triple-seg-points",In([Ur,mr,Dr],[{label:"1"},{label:"2"},{label:"3"}])),cr(ee,"triple-seg-ticks",mi([{coords:Ir},{coords:pn}]))},[Za,Jo]);const sc=()=>mu([]),oc=()=>{ca([]),Ko([])};function bu(){const ee=u.current;if(!ee)return;const Ke=la.current.filter(ht=>ht.ring.length>=3).map(ht=>({type:"Feature",properties:{id:ht.id},geometry:{type:"Polygon",coordinates:[[...ht.ring,ht.ring[0]]]}}));cr(ee,"manual-parks",{type:"FeatureCollection",features:Ke})}function wu(){const ee=u.current;if(!ee)return;const Ke=oh.current;cr(ee,"manual-park-draft-points",In(Ke)),Ke.length>=2?cr(ee,"manual-park-draft-line",pa(Ke)):cr(ee,"manual-park-draft-line",pa([])),_i.current&&Ke.length>=1&&vs.current?cr(ee,"manual-park-preview-line",pa([Ke[Ke.length-1],vs.current])):cr(ee,"manual-park-preview-line",pa([]))}const lc=ke.useCallback(ee=>{Oa(ht=>ht.filter(er=>er.id!==ee));const Ke=_a.current[ee];if(Ke){try{Ke.remove()}catch{}delete _a.current[ee]}},[]),zl=ke.useCallback(()=>{Oa([]);for(const Ke of Object.keys(_a.current))try{_a.current[Ke].remove()}catch{}_a.current={},Si(!1),Ji([]),vs.current=null;const ee=u.current;ee&&(cr(ee,"manual-parks",B0([])),cr(ee,"manual-park-draft-line",pa([])),cr(ee,"manual-park-draft-points",In([])),cr(ee,"manual-park-preview-line",pa([])))},[]);function Uc(){const ee=ba;for(const Ke of Object.keys(_a.current)){const ht=_a.current[Ke]?.getElement();ht&&(ht.style.display=ee?"block":"none")}}function En(ee){const Ke=u.current;if(!Ke)return;const ht=_a.current[ee.id];if(ht){try{ht.remove()}catch{}delete _a.current[ee.id]}const er=wR(ee.ring),St=document.createElement("button");St.type="button",St.textContent="",St.title=" ",St.style.width="22px",St.style.height="22px",St.style.borderRadius="999px",St.style.border="1px solid rgba(255,255,255,0.65)",St.style.background="rgba(10,14,22,0.95)",St.style.color="white",St.style.fontSize="16px",St.style.lineHeight="18px",St.style.cursor="pointer",St.style.boxShadow="0 2px 10px rgba(0,0,0,0.35)",St.style.display=ba?"block":"none",St.addEventListener("click",Kr=>{Kr.preventDefault(),Kr.stopPropagation(),lc(ee.id)});const _r=new H0.Marker({element:St,anchor:"center"}).setLngLat(er).addTo(Ke);_a.current[ee.id]=_r}const Eo=ke.useCallback(ee=>{Ji(Ke=>Ke.length>0&&J0(Ke[Ke.length-1],ee)<2||vR(Ke,ee)?Ke:[...Ke,ee])},[]),Tu=ke.useCallback(()=>{const ee=oh.current;if(ee.length<3||bR(ee))return;const ht={id:`mp-${Date.now()}-${vo.current++}`,ring:ee};Oa(er=>[...er,ht]),En(ht),Ji([]),vs.current=null,Si(!1)},[En]),Su=()=>{zl(),_u(null),wo(null),To([]),So([]),Aa.current={A:[],B:[],C:[]},Qi.current={A:[],B:[],C:[]},Ps(!1),Il([]),to(new Set),Pl([]),ro(-1);const ee=u.current;if(ee){cr(ee,"triple-a",pa([])),cr(ee,"triple-b",pa([])),cr(ee,"triple-c",pa([])),cr(ee,"triple-badge-points",In([])),cr(ee,"triple-badge-lines",mi([])),cr(ee,"triple-seg-points",In([])),cr(ee,"triple-seg-ticks",mi([])),cr(ee,"edit-junctions",In([])),cr(ee,"cat-traffic",mi([])),cr(ee,"cat-toll",mi([])),cr(ee,"cat-toll-labels",In([])),cr(ee,"cat-comm",B0([]));try{Sf(ee)}catch{}ue([]),je([]),_t([]),vt([]),le(!1),et(!1)}},hh=()=>{try{oc()}catch{}try{sc()}catch{}try{Su()}catch{}},cc=ee=>ee==="A"?"triple-a":ee==="B"?"triple-b":"triple-c",Ao=ke.useCallback((ee,Ke)=>{if(!Ke||Ke.length<2){cr(ee,"triple-seg-points",In([])),cr(ee,"triple-seg-ticks",mi([])),cr(ee,"edit-junctions",In([]));return}const{i1:ht,i2:er}=xx(Ke),St=ou(Ke),_r=St[St.length-1]||1,Kr=0,un=St[ht],Jr=St[er],Or=_r,Lr=Yl(Ke,St,(Kr+un)/2),Ur=Yl(Ke,St,(un+Jr)/2),mr=Yl(Ke,St,(Jr+Or)/2),Dr=50,Ar=pn=>{const gr=Ke[pn],Fr=Ke[Math.max(0,pn-1)],yn=Ke[Math.min(Ke.length-1,pn+1)],Wr=Ay(Fr,yn),ln=-Wr.uy,Vr=Wr.ux,en=N0(gr,ln*(Dr/2),Vr*(Dr/2)),$r=N0(gr,-ln*(Dr/2),-Vr*(Dr/2));return[en,$r]},yr=Ar(ht),Ir=Ar(er);cr(ee,"triple-seg-points",In([Lr,Ur,mr],[{label:"1"},{label:"2"},{label:"3"}])),cr(ee,"triple-seg-ticks",mi([{coords:yr},{coords:Ir}]))},[]),uc=ke.useCallback(ee=>{Qo(ee),zc.current=ee;const Ke=u.current;if(!Ke||!Ke.isStyleLoaded())return;try{j0(Ke,ee)}catch{}try{hx(Ke,ee)}catch{}try{fg(Ke,ee)}catch{}const ht=Aa.current,er=ee==="A"?ht.A:ee==="B"?ht.B:ht.C;try{Ao(Ke,er??[])}catch{}},[Ao]),Pi=ke.useCallback((ee,Ke,ht)=>{cr(ee,cc(Ke),pa(ht));const er=ux(ht),St=lh.current.map(Kr=>Kr.id===Ke?{...Kr,coord:er}:Kr);So(St);const _r=eo.current;St.length&&_r.length&&cr(ee,"triple-badge-lines",Cy(ee,St,_r)),fg(ee,Ke)},[]),fh=ke.useCallback(ee=>{const Ke=Nc.current,ht=Ke+1;Pl(er=>[...er.slice(0,Ke+1),new Set(ee)]),ro(ht)},[]),rl=ke.useCallback(async ee=>{const Ke=u.current;if(!Ke||!Ke.isStyleLoaded())return;const ht=zc.current,er=Qi.current[ht],St=ic.current;My(Ke,St,ee);const _r=await mR(er,St,ee);Aa.current[ht]=_r,Pi(Ke,ht,_r),Ao(Ke,_r)},[Ao,Pi]),cs=ke.useCallback(ee=>{if(!Rl.current)return;const Ke=Oc.current,ht=new Set(Ke);ht.has(ee)?ht.delete(ee):ht.add(ee),to(ht),fh(ht),rl(ht)},[rl,fh]),zs=ke.useCallback(()=>{const ee=Nc.current;if(ee<=0)return;const Ke=ee-1,ht=ch.current[Ke]??new Set;ro(Ke),to(new Set(ht)),rl(new Set(ht))},[rl]),Ei=ke.useCallback(()=>{const ee=Nc.current,Ke=ch.current;if(ee<0||ee>=Ke.length-1)return;const ht=ee+1,er=Ke[ht]??new Set;ro(ht),to(new Set(er)),rl(new Set(er))},[rl]),no=ke.useCallback(()=>{const ee=u.current;if(!ee||!ee.isStyleLoaded())return;const Ke=zc.current,ht=Qi.current[Ke];if(!ht||ht.length<2)return;Aa.current[Ke]=ht,Pi(ee,Ke,ht);const er=new Set;to(er),Pl([er]),ro(0),My(ee,ic.current,er),Ao(ee,ht)},[Ao,Pi]);ke.useEffect(()=>{es.current=cs,Fl.current=zs,Ls.current=Ei,yu.current=no},[cs,zs,Ei,no]),ke.useEffect(()=>{const ee=u.current;if(!ee)return;let Ke=!1;const ht=()=>{if(Ke)return;try{Sf(ee)}catch{}if(!bs){cr(ee,"edit-junctions",In([]));return}const er=Za,St=Qi.current[er];if(!St||St.length<2){Il([]),cr(ee,"edit-junctions",In([]));return}const _r=fR(St);Il(_r);const Kr=new Set;to(Kr),Pl([Kr]),ro(0),My(ee,_r,Kr)};if(!ee.isStyleLoaded()){const er=()=>ht();try{ee.once("idle",er)}catch{}try{ee.once("load",er)}catch{}return()=>{Ke=!0;try{ee.off("idle",er)}catch{}try{ee.off("load",er)}catch{}}}return ht(),()=>{Ke=!0}},[bs,Za,Jo,l]);const hc=ke.useCallback(async()=>{const ee=window.showDirectoryPicker;if(!ee){alert("      .     (Downloads)."),Ks("downloads"),$o(null),yo("Downloads");return}try{const Ke=await ee({mode:"readwrite"});Ke&&($o(Ke),Ks("directory"),yo(String(Ke.name||"Selected folder")))}catch{}},[]),fc=ke.useCallback(()=>{Ks("downloads"),$o(null),yo("Downloads")},[]),Vc=ke.useCallback((ee,Ke)=>{const ht=new Blob([ee],{type:"text/html;charset=utf-8"}),er=URL.createObjectURL(ht),St=document.createElement("a");St.href=er,St.download=Ke,document.body.appendChild(St),St.click(),St.remove(),URL.revokeObjectURL(er)},[]),ao=ke.useCallback((ee,Ke)=>{const ht=URL.createObjectURL(Ke),er=document.createElement("a");er.href=ht,er.download=ee,document.body.appendChild(er),er.click(),er.remove(),URL.revokeObjectURL(ht)},[]),Os=ke.useCallback(()=>{const ee=u.current,Ke=ee?.getCenter?ee.getCenter():null,ht=ee?.getCanvas?ee.getCanvas():null,er={version:"GeoVisLab DebugLog v1",createdAt:new Date().toISOString(),scenarioName:Ki,taskText:Wo,recommendedRoute:Ms,vizType:Sl,mapView:ee?{center:Ke?[Ke.lng,Ke.lat]:null,zoom:ee.getZoom?ee.getZoom():null,bearing:ee.getBearing?ee.getBearing():null,pitch:ee.getPitch?ee.getPitch():null,width:ht?.width??null,height:ht?.height??null}:null,start:Gn,end:Kn,selectedRoute:Za,routes:Aa.current,routeScores:hr,spatial:{traffic:fe,toll:{segments:ye,labels:$e},comm:at,parks:zn},taskParams:{taskPrimaryCat:gn,taskPrimaryScope:Yi,taskSecondaryCat:Xt,taskLocalEnabled:Ue,taskLocalCat:Re,taskLocalSegment:ze,taskDifficulty:Ut,taskMode:Tt,taskWPrimary:ir,taskWSecondary:Sr,taskWTime:xr,taskGateMinFrac:mn,taskTieBreaker:oi,taskFavorRoute:li,taskWinnerRoute:za,taskWinnerNote:ss},generation:{catGlobalDiversity:me,catTrafficCount:Ve,catTrafficLenMin:De,catTrafficLenMax:Vt,catTrafficDiv:jt,catTollCount:jr,catTollLenMin:_n,catTollLenMax:Rt,catTollDiv:Ee,catCommCount:dt,catCommDiaMin:Jt,catCommDiaMax:lr,catCommDiv:sr}},St=new Blob([JSON.stringify(er,null,2)],{type:"application/json;charset=utf-8;"});ao(Dn,St),Mr(` : ${Dn}`)},[Dn,ao,Ki,Wo,gi,Ms,Sl,Gn,Kn,Za,hr,fe,ye,$e,at,zn,gn,Yi,Xt,Ue,Re,ze,Ut,Tt,ir,Sr,xr,mn,oi,li,za,ss,me,Ve,De,Vt,jt,jr,_n,Rt,Ee,dt,Jt,lr,sr,Mr]),dh=ke.useRef(null),Gc=ke.useCallback(()=>{const ee=u.current;if(!ee)return;const Ke=ee.getCenter(),ht={center:{lng:Ke.lng,lat:Ke.lat},zoom:ee.getZoom(),pitch:ee.getPitch(),bearing:ee.getBearing()},er={version:1,meta:{name:Ki||"Untitled Scenario",createdAt:new Date().toISOString()},mapState:ht,routes:{start:Gn,end:Kn,tripleLines:Aa.current,routeScores:hr,selectedRoute:Za},entities:{traffic:Bt.current,toll:Ht.current,comm:Tr.current,parks:la.current},task:{primaryCat:gn,primaryScope:Yi,secondaryCat:Xt,localEnabled:Ue,localCat:Re,localSegment:ze,difficulty:Ut,mode:Tt,wPrimary:ir,wSecondary:Sr,wTime:xr,gateMinFrac:mn,tieBreaker:oi,favorRoute:li,winnerRoute:za,winnerNote:ss},config:{diversity:kl,scatterDensity:p,targetTimeGap:_,keepManualEntities:C,lang:D}},St=new Blob([JSON.stringify(er,null,2)],{type:"application/json"}),_r=`Scenario_${fb(Ki)}_${new Date().toISOString().slice(0,10)}.json`;ao(_r,St),Mr("  !")},[Ki,Gn,Kn,hr,Za,gn,Yi,Xt,Ue,Re,ze,Ut,Tt,ir,Sr,xr,mn,oi,li,za,ss,kl,p,_,C,D,ao,Mr]),dn=ke.useCallback(ee=>{const Ke=ee.target.files?.[0];if(!Ke)return;const ht=new FileReader;ht.onload=async er=>{try{const St=JSON.parse(er.target?.result);if(!St.version||!St.mapState){alert("     .");return}mu([]),ca([]),Ko([]),Me("TRIPLE"),Pl([]),ro(-1),Ps(!1);const _r=u.current;_r&&(_r.jumpTo({center:[St.mapState.center.lng,St.mapState.center.lat],zoom:St.mapState.zoom,pitch:St.mapState.pitch,bearing:St.mapState.bearing}),cr(_r,"measure-points",In([])),cr(_r,"measure-line",pa([])),cr(_r,"single-points",In([])),cr(_r,"single-line",pa([]))),ih(St.meta.name),Cl(St.config.diversity),b(St.config.scatterDensity),s(St.config.targetTimeGap),M(St.config.keepManualEntities),B(St.config.lang),ga(St.task.primaryCat),xo(St.task.primaryScope),xe(St.task.secondaryCat),Fe(St.task.localEnabled),Te(St.task.localCat),mt(St.task.localSegment),It(St.task.difficulty),gt(St.task.mode),vr(St.task.wPrimary),dr(St.task.wSecondary),Nr(St.task.wTime),tn(St.task.gateMinFrac),xs(St.task.tieBreaker),wi(St.task.favorRoute),Ti(St.task.winnerRoute),os(St.task.winnerNote),ue(St.entities.traffic||[]),je(St.entities.toll||[]);const Kr=[];(St.entities.toll||[]).forEach(un=>{_x(un.coords,250).forEach((Or,Lr)=>Kr.push({coord:Or,side:Lr%2===0?"left":"right"}))}),_t(Kr),vt(St.entities.comm||[]),Oa(St.entities.parks||[]),Aa.current=St.routes.tripleLines,Qi.current=St.routes.tripleLines,_u(St.routes.start),wo(St.routes.end),Gr(St.routes.routeScores||[]),Qo(St.routes.selectedRoute||"A"),le(!0),et(!1),setTimeout(()=>{_r&&(cr(_r,"triple-a",pa(St.routes.tripleLines.A)),cr(_r,"triple-b",pa(St.routes.tripleLines.B)),cr(_r,"triple-c",pa(St.routes.tripleLines.C)),j0(_r,St.routes.selectedRoute||"A"),nc(un=>un+.001),Mr(` : ${St.meta.name}`))},150)}catch(St){console.error(St),alert("  .    JSON   .")}},ht.readAsText(Ke),ee.target.value=""},[u,Gn,Kn,Za,Mr]),ph=ke.useCallback(async()=>{const ee=u.current;if(!ee){alert("   .");return}const Ke=["triple-a","triple-b","triple-c","triple-a-outline","triple-b-outline","triple-c-outline","triple-badge-lines","triple-badges","triple-badge-text","triple-seg-ticks","triple-seg-circles","triple-seg-text","cat-traffic","cat-traffic-glow","cat-toll","cat-toll-label-bg","cat-toll-label-text","cat-comm-fill","cat-comm-outline","manual-parks-fill","manual-parks-outline","start-circle","end-pin","start-label-bg","end-label-bg","start-label","end-label"],ht=new Map;for(const yr of Ke)try{ee.getLayer(yr)&&ht.set(yr,ee.getLayoutProperty(yr,"visibility"))}catch{}for(const yr of Ke)try{ee.getLayer(yr)&&ee.setLayoutProperty(yr,"visibility","none")}catch{}await new Promise(yr=>{try{ee.once("idle",()=>yr()),ee.triggerRepaint()}catch{yr()}});let er="";try{er=ee.getCanvas().toDataURL("image/png")}catch{er=""}er&&er.length<2e3&&(er="");for(const yr of Ke)try{if(ee.getLayer(yr)){const Ir=ht.has(yr)?ht.get(yr):"visible";ee.setLayoutProperty(yr,"visibility",Ir??"visible")}}catch{}let St=ee.getCanvas(),_r=St.width,Kr=St.height;const un=ee.getCenter(),Jr={center:[un.lng,un.lat],zoom:ee.getZoom(),bearing:0,pitch:0,width:_r,height:Kr},Or=yr=>{const Ir=Aa.current?.[yr];return Array.isArray(Ir)?Ir:[]},Lr={A:Or("A"),B:Or("B"),C:Or("C")},Ur=WD({scenarioName:Ki,taskText:Wo,requirementsText:gi,recommendedRoute:Ms,vizType:Sl,baseMapDataUrl:er,mapView:Jr,start:Gn,end:Kn,routes:Lr,manualParks:la.current||[],catTrafficSegs:fe,catTollSegs:ye,catTollLabels:$e,catCommZones:at,routeScores:hr.flatMap(yr=>yr.segments),badges:eo.current}),mr=new Date().toISOString().replace(/[:.]/g,"-"),Dr=`${fb(Ki)}_${mr}.html`;try{if(Jl==="directory"&&sh){const pn=await(await sh.getFileHandle(Dr,{create:!0})).createWritable();await pn.write(Ur),await pn.close();const gr=`${Pc}/${Dr}`;Ql(gr),alert(`   : ${gr}`);return}}catch{}Vc(Ur,Dr);const Ar=`Downloads/${Dr}`;Ql(Ar),alert(`   : ${Ar}`)},[at,$e,ye,fe,Vc,Kn,sh,Ms,Jl,Pc,Ki,Wo,gi,Sl,hr,Gn]),Ts=ke.useCallback(()=>{if(!u.current)return;const Ke=Aa.current;if(!Ke.A.length||!Ke.B.length||!Ke.C.length){alert("   ( 1)   .");return}const ht=C?Bt.current.filter(Ir=>Ir.id.includes("manual")):[],er=C?Ht.current.filter(Ir=>Ir.id.includes("manual")):[],St=C?Tr.current.filter(Ir=>Ir.id.includes("manual")):[],_r=[...ht],Kr=[...er],un=[...St],Jr=["A","B","C"],Or=Jr.map(Ir=>({id:Ir,len:_d(Ke[Ir]),line:Ke[Ir]}));Or.sort((Ir,pn)=>Ir.len-pn.len);const Lr=Or[0],Ur=Or.slice(1);if(p>.1){const gr=Lr.len;let Fr=-1;const yn=gn===""?"toll":"traffic";for(let Wr=0;Wr<gr;Wr+=50){const ln=ou(Lr.line),Vr=Yl(Lr.line,ln,Wr);let en=!0;for(const $r of Ur)if(RR(Vr,$r.line)<8e-4){en=!1;break}if(en)Fr===-1&&(Fr=Wr);else if(Fr!==-1){if(Wr-Fr>250){const Xr={coords:cx(Lr.line,Fr,Wr),id:`auto_smart_${yn}_${Lr.id}_${Wr}`};yn==="traffic"?_r.push(Xr):Kr.push(Xr)}Fr=-1}}}const mr=Math.max(0,Math.round(p*4)),Dr=800,Ar=2500,yr=Ir=>{const pn=Ke[Ir],gr=_d(pn);if(gr<Dr+500)return null;const Fr=Mc(Dr,Math.min(gr*.4,Ar)),yn=Mc(gr*.1,gr*.9-Fr);return cx(pn,yn,yn+Fr)};if(p>.1)for(let Ir=0;Ir<mr;Ir++){const pn=Jr[Math.floor(Math.random()*3)],gr=Ke[pn],Fr=_d(gr),yn=Yl(gr,ou(gr),Mc(Fr*.1,Fr*.9));un.push({id:`auto_comm_${pn}_${Ir}`,ring:Ey(yn,Mc(400,800)),radiusM:Mc(400,800)});const Wr=Jr[Math.floor(Math.random()*3)],ln=yr(Wr);ln&&(Math.random()>.5?_r.push({coords:ln,id:`auto_filler_traffic_${Wr}_${Ir}`}):Kr.push({coords:ln,id:`auto_filler_toll_${Wr}_${Ir}`}))}ue(_r),je(Kr),_t(lt(Kr)),vt(un),an(!1),Gr([]),Mr(":    ( +  + ).")},[u,Aa,gn,p,C,lt,Mr]);return ke.useEffect(()=>{xn&&(an(!1),Gr([]))},[fe,ye,at,zn,gn,Tt,ir,Gn,Kn]),J.jsxs("div",{style:{display:"flex",width:"100vw",height:"100vh",overflow:"hidden"},children:[J.jsx("style",{children:`
                * {
                    font-family: "Arial", sans-serif !important;
                }
            `}),J.jsxs("div",{style:{flex:1,position:"relative"},children:[J.jsx("div",{ref:r,style:{width:"100%",height:"100%"}}),J.jsxs("div",{style:{position:"absolute",right:10,bottom:40,background:"rgba(11,15,23,0.78)",border:"1px solid rgba(255,255,255,0.12)",borderRadius:12,padding:"10px 12px",color:"#e8eefc",fontFamily:"Arial, sans-serif",fontSize:12,lineHeight:1.25,backdropFilter:"blur(6px)",minWidth:165,pointerEvents:"none",direction:"rtl",textAlign:"right"},children:[J.jsx("div",{style:{fontWeight:900,marginBottom:8,opacity:.95},children:""}),J.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:7},children:[J.jsx("div",{style:{width:34,height:0,borderTop:`4px dashed ${qy}`,filter:"drop-shadow(0 0 2px rgba(255,0,34,0.55))"}}),J.jsx("div",{style:{fontWeight:700},children:" "})]}),J.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:7},children:[J.jsxs("div",{style:{width:34,height:10,position:"relative"},children:[J.jsx("div",{style:{position:"absolute",left:0,right:0,top:1,borderTop:`3px solid ${$0}`}}),J.jsx("div",{style:{position:"absolute",left:0,right:0,bottom:1,borderTop:`3px solid ${$0}`}})]}),J.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[J.jsx("span",{style:{fontWeight:700},children:" "}),J.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:18,height:18,borderRadius:999,background:$0,border:"1px solid rgba(11,18,32,0.9)",color:"#0b1220",fontWeight:900},children:""})]})]}),J.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:7},children:[J.jsx("div",{style:{width:18,height:18,borderRadius:999,background:Mw,border:`2px solid ${Dw}`}}),J.jsx("div",{style:{fontWeight:700},children:" "})]}),J.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[J.jsx("div",{style:{width:18,height:12,borderRadius:4,background:M1,border:`2px solid ${Rx}`,opacity:D1}}),J.jsx("div",{style:{fontWeight:700},children:" ()"})]})]}),xn&&J.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.58)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center",padding:16,direction:"rtl"},onMouseDown:()=>an(!1),children:J.jsxs("div",{style:{width:1100,maxWidth:"96vw",background:"rgba(10, 14, 22, 0.98)",border:"1px solid rgba(255,255,255,0.15)",borderRadius:14,boxShadow:"0 18px 46px rgba(0,0,0,0.55)",overflow:"hidden",color:"white"},onMouseDown:ee=>ee.stopPropagation(),children:[J.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px 12px",borderBottom:"1px solid rgba(255,255,255,0.12)",background:"rgba(10, 14, 22, 0.98)"},children:[J.jsx("div",{style:{fontWeight:900,fontSize:16},children:""}),J.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[J.jsx("button",{onClick:Wn,disabled:!hr||hr.length===0,title:!hr||hr.length===0?"  ":"    CSV",style:{padding:"8px 12px",borderRadius:10,border:"1px solid rgba(255,255,255,0.18)",background:!hr||hr.length===0?"rgba(255,255,255,0.03)":"rgba(255,255,255,0.10)",color:"white",cursor:!hr||hr.length===0?"not-allowed":"pointer",opacity:!hr||hr.length===0?.55:1,fontWeight:900},children:" CSV"}),J.jsx("button",{onClick:()=>an(!1),style:{padding:"8px 12px",borderRadius:10,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(255,255,255,0.06)",color:"white",cursor:"pointer",fontWeight:900},children:""})]})]}),J.jsx("div",{style:{padding:12,maxHeight:"82vh",overflow:"auto"},children:(()=>{const ee=mr=>(mr/1e3).toFixed(2),Ke=mr=>(mr/60).toFixed(1),ht=mr=>Math.round(mr),er=(mr,Dr)=>{switch(Dr){case"":return Number(mr?.speedScore??0);case"":return Number(mr?.economyScore??0);case"":return Number(mr?.scenicScore??0);case"":return Number(mr?.commScore??0);default:return 0}},St={1:{min:1/0,max:-1/0},2:{min:1/0,max:-1/0},3:{min:1/0,max:-1/0}};(hr||[]).forEach(mr=>{(mr.segments||[]).forEach(Dr=>{const Ar=Number(Dr.segment);if(Ar===1||Ar===2||Ar===3){const yr=Number(Dr.timeS??0);Number.isFinite(yr)&&(St[Ar].min=Math.min(St[Ar].min,yr),St[Ar].max=Math.max(St[Ar].max,yr))}})});const _r=(mr,Dr)=>{const Ar=St[mr].min,yr=St[mr].max;if(!Number.isFinite(Ar)||!Number.isFinite(yr)||yr<=Ar+1e-6)return 100;const Ir=(yr-Dr)/(yr-Ar);return Math.max(0,Math.min(100,Ir*100))},Kr=Tt==="Weighted"?`${gn}${ir}${Xt!=="None"?` + ${Xt}${Sr}`:""} + ${xr}`:"",un=mr=>{const Dr=Number(mr.segment),Ar=_r(Dr,Number(mr.timeS??0));if(Tt!=="Weighted"){const ln=Number(mr.speedScore??0),Vr=Number(mr.economyScore??0),en=Number(mr.scenicScore??0),$r=Number(mr.commScore??0);return Math.round((ln+Vr+en+$r)/4)}const yr=er(mr,gn),Ir=Xt==="None"?0:er(mr,Xt),pn=Number(ir??0),gr=Xt==="None"?0:Number(Sr??0),Fr=Number(xr??0),yn=Math.max(1e-6,pn+gr+Fr),Wr=(pn*yr+gr*Ir+Fr*Ar)/yn;return Math.round(Wr)},Jr=mr=>{const Dr=Array.isArray(mr.segments)?mr.segments:[];if(!Dr.length)return 0;const Ar=Dr.reduce((Ir,pn)=>Ir+Number(pn.lengthM??0),0)||Dr.length,yr=Dr.reduce((Ir,pn)=>Ir+(Number(pn.lengthM??0)||1)*un(pn),0);return Math.round(yr/Ar)},Or={textAlign:"right",padding:"8px 8px",borderBottom:"1px solid rgba(255,255,255,0.15)",fontWeight:900,whiteSpace:"nowrap"},Lr={padding:"8px 8px",borderBottom:"1px solid rgba(255,255,255,0.08)",textAlign:"right"},Ur={borderLeft:"2px solid rgba(255,255,255,0.22)"};return J.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12,tableLayout:"fixed"},children:[J.jsxs("colgroup",{children:[J.jsx("col",{style:{width:90}}),J.jsx("col",{style:{width:95}}),J.jsx("col",{style:{width:90}}),J.jsx("col",{style:{width:90}}),J.jsx("col",{style:{width:90}}),J.jsx("col",{style:{width:90}}),J.jsx("col",{style:{width:90}}),J.jsx("col",{style:{width:160}}),J.jsx("col",{style:{width:95}})]}),J.jsx("thead",{children:J.jsxs("tr",{style:{background:"rgba(255,255,255,0.04)"},children:[J.jsx("th",{style:Or,children:""}),J.jsx("th",{style:Or,children:" ()"}),J.jsx("th",{style:Or,children:" ()"}),J.jsx("th",{style:{...Or,...Ur,background:"rgba(59,130,246,0.10)"},children:""}),J.jsx("th",{style:{...Or,background:"rgba(245,158,11,0.10)"},children:""}),J.jsx("th",{style:{...Or,background:"rgba(34,197,94,0.10)"},children:""}),J.jsx("th",{style:{...Or,background:"rgba(170,60,255,0.10)"},children:""}),J.jsx("th",{style:{...Or,...Ur},children:""}),J.jsx("th",{style:Or,children:""})]})}),J.jsx("tbody",{children:(hr||[]).map(mr=>J.jsxs(ke.Fragment,{children:[J.jsx("tr",{children:J.jsxs("td",{colSpan:9,style:{padding:"10px 8px",fontWeight:900,borderBottom:"1px solid rgba(255,255,255,0.10)",background:"rgba(255,255,255,0.03)"},children:[" ",mr.route]})}),(mr.segments||[]).map(Dr=>J.jsxs("tr",{children:[J.jsxs("td",{style:Lr,children:[" ",Dr.segment]}),J.jsx("td",{style:Lr,children:ee(Number(Dr.lengthM??0))}),J.jsx("td",{style:Lr,children:Ke(Number(Dr.timeS??0))}),J.jsx("td",{style:{...Lr,...Ur},children:ht(Number(Dr.speedScore??0))}),J.jsx("td",{style:Lr,children:ht(Number(Dr.economyScore??0))}),J.jsx("td",{style:Lr,children:ht(Number(Dr.scenicScore??0))}),J.jsx("td",{style:Lr,children:ht(Number(Dr.commScore??0))}),J.jsx("td",{style:{...Lr,...Ur,fontSize:11,opacity:.95},children:Kr}),J.jsx("td",{style:{...Lr,fontWeight:900},children:un(Dr)})]},`${mr.route}-${Dr.segment}`)),J.jsxs("tr",{style:{background:"rgba(255,255,255,0.05)"},children:[J.jsx("td",{style:{...Lr,fontWeight:900},children:""}),J.jsx("td",{style:{...Lr,fontWeight:900},children:ee(Number(mr.totalLengthM??0))}),J.jsx("td",{style:{...Lr,fontWeight:900},children:Ke(Number(mr.totalTimeS??0))}),J.jsx("td",{style:{...Lr,...Ur,fontWeight:900},children:""}),J.jsx("td",{style:{...Lr,fontWeight:900},children:""}),J.jsx("td",{style:{...Lr,fontWeight:900},children:""}),J.jsx("td",{style:{...Lr,fontWeight:900},children:""}),J.jsx("td",{style:{...Lr,...Ur,fontWeight:900},children:""}),J.jsx("td",{style:{...Lr,fontWeight:900},children:Jr(mr)})]})]},mr.route))})]})})()})]})})]}),J.jsxs("div",{style:{width:420,background:"#0b0f17",color:"#e8eefc",padding:16,borderLeft:"1px solid rgba(255,255,255,0.08)",fontFamily:"Arial, sans-serif",direction:"rtl",overflowY:"auto"},children:[J.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:[J.jsx("div",{style:{fontWeight:900,fontSize:18},children:"GeoVis Lab"}),J.jsxs("div",{children:[J.jsx("input",{type:"file",ref:dh,style:{display:"none"},accept:".json",onChange:dn}),J.jsx("button",{onClick:()=>dh.current?.click(),title:"   (JSON)",style:{background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.2)",borderRadius:6,color:"#e8eefc",cursor:"pointer",padding:"4px 8px",display:"flex",alignItems:"center",justifyContent:"center"},children:J.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[J.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),J.jsx("polyline",{points:"7 10 12 15 17 10"}),J.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]})})]})]}),J.jsxs("div",{style:{background:"rgba(255,255,255,0.06)",borderRadius:12,padding:12,marginBottom:12},children:[J.jsx("div",{style:{fontWeight:900,marginBottom:10},children:" "}),J.jsxs("div",{style:{marginBottom:10},children:[J.jsx("div",{style:{fontWeight:800,marginBottom:6},children:" "}),J.jsxs("div",{style:{display:"flex",background:"rgba(0,0,0,0.3)",borderRadius:8,padding:4},children:[J.jsx("button",{onClick:()=>ve("vector"),style:{flex:1,padding:"6px",borderRadius:6,border:"none",cursor:"pointer",background:ge==="vector"?"rgba(255,255,255,0.2)":"transparent",color:ge==="vector"?"white":"rgba(255,255,255,0.5)",fontWeight:900},children:""}),J.jsx("button",{onClick:()=>ve("satellite"),style:{flex:1,padding:"6px",borderRadius:6,border:"none",cursor:"pointer",background:ge==="satellite"?"rgba(34, 197, 94, 0.25)":"transparent",color:ge==="satellite"?"#4ade80":"rgba(255,255,255,0.5)",fontWeight:900},children:""})]})]}),J.jsxs("div",{style:{display:"flex",gap:10,alignItems:"flex-end"},children:[J.jsxs("div",{style:{flex:1,minWidth:0},children:[J.jsx("div",{style:{fontWeight:800,marginBottom:6},children:" "}),J.jsxs("select",{value:D,onChange:ee=>B(ee.target.value),style:{width:"100%",padding:"10px 12px",borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:"rgba(255,255,255,0.06)",color:"#e8eefc",fontWeight:800,outline:"none",direction:"rtl"},children:[J.jsx("option",{value:"he",children:""}),J.jsx("option",{value:"en",children:"English"})]})]}),J.jsxs("button",{onClick:()=>Qr(!0),style:{padding:"10px 12px",borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:"rgba(255,255,255,0.06)",color:"#e8eefc",cursor:"pointer",fontWeight:900,whiteSpace:"nowrap",display:"flex",alignItems:"center",gap:8},title:Xh?" / ":"  ",children:[" ",Xh&&J.jsx("span",{style:{width:10,height:10,borderRadius:999,background:"#F59E0B",display:"inline-block"}})]})]}),J.jsx("div",{style:{fontSize:12,opacity:.75,marginTop:8,lineHeight:1.35},children:":        ."})]}),wa&&J.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.55)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",padding:16,fontFamily:"Arial, sans-serif",direction:"rtl"},onMouseDown:()=>Qr(!1),children:J.jsxs("div",{style:{width:520,maxWidth:"100%",maxHeight:"90vh",overflow:"auto",background:"#0b0f17",border:"1px solid rgba(255,255,255,0.15)",borderRadius:14,boxShadow:"0 16px 40px rgba(0,0,0,0.45)",padding:14},onMouseDown:ee=>ee.stopPropagation(),children:[J.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:10,marginBottom:10},children:[J.jsx("div",{style:{fontWeight:900,fontSize:16},children:" "}),J.jsx("button",{onClick:()=>Qr(!1),style:{border:"1px solid rgba(255,255,255,0.15)",background:"rgba(255,255,255,0.06)",color:"#e8eefc",borderRadius:10,padding:"8px 10px",cursor:"pointer",fontWeight:900},title:"",children:""})]}),J.jsx("div",{style:{fontWeight:900,marginBottom:8},children:" "}),J.jsx("div",{style:{display:"grid",gap:8},children:[{key:"roads",label:"",v:j,set:H},{key:"transit",label:"",v:z,set:N},{key:"labels",label:"",v:Z,set:Y},{key:"poi",label:" ",v:W,set:de}].map(ee=>J.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,cursor:"pointer"},children:[J.jsx("input",{type:"checkbox",checked:ee.v,onChange:Ke=>ee.set(Ke.target.checked)}),J.jsx("span",{style:{fontWeight:800},children:ee.label})]},ee.key))}),J.jsxs("div",{style:{marginTop:12,paddingTop:12,borderTop:"1px solid rgba(255,255,255,0.12)"},children:[J.jsx("div",{style:{fontWeight:900,marginBottom:8},children:" "}),J.jsx("div",{style:{fontSize:12,opacity:.8,marginBottom:10},children:"/    (   3 )."}),J.jsx("div",{style:{display:"grid",gap:8},children:[{key:"traffic",label:" ",v:ut,set:tt,disabled:!Je},{key:"toll",label:" ",v:We,set:$t,disabled:!Je},{key:"comm",label:" ",v:Be,set:Mt,disabled:!Je},{key:"baseParks",label:" ",v:ec,set:pu,disabled:!1},{key:"manualParks",label:" ",v:ba,set:Ha,disabled:!1}].map(ee=>J.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,cursor:ee.disabled?"not-allowed":"pointer",opacity:ee.disabled?.6:1},children:[J.jsx("input",{type:"checkbox",checked:ee.v,disabled:ee.disabled,onChange:Ke=>ee.set(Ke.target.checked)}),J.jsx("span",{style:{fontWeight:800},children:ee.label})]},ee.key))})]})]})}),J.jsxs("div",{style:{background:"rgba(255,255,255,0.06)",borderRadius:12,padding:12,marginBottom:12},children:[J.jsx("div",{style:{fontWeight:900,marginBottom:10},children:"  "}),J.jsx("div",{style:{display:"flex",background:"rgba(0,0,0,0.25)",borderRadius:10,padding:4,gap:4,margin:"0 auto 12px auto"},children:[{id:"TRIPLE",label:"3 "},{id:"SINGLE",label:" "},{id:"MEASURE",label:""}].map(ee=>{const Ke=ee.id==="TRIPLE"?ie==="TRIPLE":ie===ee.id,ht=ee.id==="TRIPLE"&&Ge;return J.jsx("button",{onClick:()=>{ee.id==="TRIPLE"?ie!=="TRIPLE"?(Me("TRIPLE"),et(!0)):et(er=>!er):(Me(ee.id),et(!1))},style:{flex:1,padding:"8px 0",borderRadius:8,border:"none",background:Ke?ht?"rgba(59, 130, 246, 0.9)":"rgba(255,255,255,0.15)":"transparent",color:Ke?"#fff":"rgba(255,255,255,0.6)",cursor:"pointer",fontWeight:Ke?800:600,fontSize:13},children:ee.label},ee.id)})}),J.jsxs("div",{style:{paddingTop:10,borderTop:"1px solid rgba(255,255,255,0.1)"},children:[ie==="TRIPLE"&&J.jsxs("div",{style:{fontSize:13,opacity:.9},children:[" : ",J.jsx("b",{children:Ge?"":""})," ( =, =).",Gn&&Kn&&J.jsx("div",{style:{color:"#4ade80",fontWeight:700,marginTop:4},children:"  ."})]}),ie==="SINGLE"&&J.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:13},children:[J.jsxs("span",{children:[": ",J.jsx("b",{children:ci.length}),", : ",J.jsx("b",{children:ox($h)})]}),J.jsx("button",{onClick:oc,style:{padding:"2px 8px",borderRadius:4,background:"rgba(255,255,255,0.1)",color:"white",border:"none",cursor:"pointer"},children:""})]}),ie==="MEASURE"&&J.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:13},children:[J.jsxs("span",{children:[" : ",J.jsx("b",{children:ox(Ii)})]}),J.jsx("button",{onClick:sc,style:{padding:"2px 8px",borderRadius:4,background:"rgba(255,255,255,0.1)",color:"white",border:"none",cursor:"pointer"},children:""})]})]})]}),ie==="TRIPLE"&&J.jsxs(J.Fragment,{children:[J.jsxs("div",{style:{background:"rgba(255,255,255,0.06)",borderRadius:12,padding:12,marginBottom:12},children:[J.jsx("div",{style:{fontWeight:900,marginBottom:6},children:" 1:  "}),J.jsx("div",{style:{fontWeight:800,marginBottom:8},children:""}),J.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[J.jsx("input",{type:"range",min:0,max:1,step:.01,value:kl,onChange:ee=>Cl(parseFloat(ee.target.value)),style:{flex:1}}),J.jsx("input",{type:"number",min:0,max:100,value:Math.round(kl*100),onChange:ee=>{const Ke=Math.max(0,Math.min(100,Number(ee.target.value||0)));Cl(Ke/100)},style:{width:80,padding:"8px 10px",borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:"rgba(255,255,255,0.06)",color:"#e8eefc",fontWeight:900,direction:"ltr"},title:" "})]}),J.jsxs("div",{style:{display:"flex",gap:10,marginTop:12},children:[J.jsx("button",{onClick:()=>nc(ee=>ee+1),disabled:!Dl||Ml,style:{flex:1,padding:"10px 12px",borderRadius:12,border:"1px solid rgba(255,255,255,0.15)",background:Dl?"rgba(140,203,255,0.22)":"rgba(255,255,255,0.06)",color:"#e8eefc",cursor:Dl?"pointer":"not-allowed",fontWeight:900,opacity:Ml?.75:1},title:Dl?" ":"     ",children:Ml?"":""}),J.jsx("button",{onClick:hh,style:{flex:1,padding:"10px 12px",borderRadius:12,border:"1px solid rgba(255,255,255,0.15)",background:"transparent",color:"#e8eefc",cursor:"pointer",fontWeight:900},title:"   /",children:""})]}),J.jsxs("div",{style:{fontSize:12,opacity:.75,marginTop:10,lineHeight:1.35},children:["   ",J.jsx("b",{children:""}),"  (A/B/C)  ."]})]}),J.jsxs("div",{style:{background:"rgba(255,255,255,0.06)",borderRadius:12,padding:12,marginBottom:12},children:[J.jsx("div",{style:{fontWeight:900,marginBottom:6},children:" 2:  "}),J.jsx("div",{style:{fontSize:12,opacity:.8,marginBottom:10},children:"  (1/2/3 + )    ."}),J.jsx("div",{style:{fontWeight:800,marginBottom:8},children:" "}),J.jsx("div",{style:{display:"flex",gap:10,marginBottom:4},children:[{id:"A",label:" "},{id:"B",label:" "},{id:"C",label:" "}].map(ee=>J.jsx("button",{onClick:()=>uc(ee.id),style:{flex:1,padding:"10px 12px",borderRadius:12,border:"1px solid rgba(255,255,255,0.15)",background:Za===ee.id?"rgba(30,78,216,0.22)":"transparent",color:"#e8eefc",cursor:"pointer",fontWeight:900},title:"       ",children:ee.label},ee.id))})]}),J.jsxs("div",{style:{background:"rgba(255,255,255,0.06)",borderRadius:12,padding:12,marginBottom:12},children:[J.jsx("div",{style:{fontWeight:900,marginBottom:6},children:" 3:  "}),J.jsxs("div",{style:{display:"flex",gap:10,marginBottom:12},children:[J.jsx("button",{onClick:()=>{Qi.current.A.length>=2&&Qi.current.B.length>=2&&Qi.current.C.length>=2&&Ps(Ke=>!Ke)},disabled:Ml,style:{flex:1,padding:"10px 12px",borderRadius:12,border:"1px solid rgba(255,255,255,0.15)",background:bs?"rgba(255,255,255,0.12)":"transparent",color:"#e8eefc",cursor:Ml?"not-allowed":"pointer",fontWeight:900,opacity:Ml?.7:1},title:" :      / ",children:bs?" ":" "}),J.jsx("button",{onClick:no,disabled:!bs,style:{flex:1,padding:"10px 12px",borderRadius:12,border:"1px solid rgba(255,255,255,0.15)",background:"transparent",color:"#e8eefc",cursor:bs?"pointer":"not-allowed",fontWeight:900,opacity:bs?1:.6},title:"     ",children:"  "})]}),bs&&J.jsxs(J.Fragment,{children:[J.jsx("div",{style:{fontSize:12,opacity:.8,marginBottom:10,lineHeight:1.4},children:" :     .    / ,        ."}),J.jsxs("div",{style:{display:"flex",gap:10,marginBottom:2},children:[J.jsx("button",{onClick:zs,disabled:Fs<=0,style:{flex:1,padding:"10px 12px",borderRadius:12,border:"1px solid rgba(255,255,255,0.15)",background:"transparent",color:"#e8eefc",cursor:Fs<=0?"not-allowed":"pointer",fontWeight:900,opacity:Fs<=0?.55:1},title:"  ",children:""}),J.jsx("button",{onClick:Ei,disabled:Fs>=Bc.length-1,style:{flex:1,padding:"10px 12px",borderRadius:12,border:"1px solid rgba(255,255,255,0.15)",background:"transparent",color:"#e8eefc",cursor:Fs>=Bc.length-1?"not-allowed":"pointer",fontWeight:900,opacity:Fs>=Bc.length-1?.55:1},title:" ( )",children:""})]})]})]}),J.jsxs("div",{style:{background:"rgba(255,255,255,0.06)",borderRadius:12,padding:12,marginBottom:12},children:[J.jsx("div",{style:{fontWeight:900,marginBottom:4},children:" 4:    "}),J.jsxs("div",{style:{fontSize:13,opacity:.85,marginBottom:12,lineHeight:1.4},children:["     .",J.jsx("br",{}),": ",J.jsx("b",{children:fe.length})," , ",J.jsx("b",{children:ye.length})," , ",J.jsx("b",{children:at.length})," , ",J.jsx("b",{children:zn.length})," ."]}),J.jsx("div",{style:{display:"flex",flexDirection:"column",gap:0},children:[{key:"traffic",title:" "},{key:"toll",title:" "},{key:"comm",title:""},{key:"park",title:""}].map((ee,Ke,ht)=>J.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px 0",borderBottom:Ke<ht.length-1?"1px solid rgba(255,255,255,0.1)":"none"},children:[J.jsx("div",{style:{fontWeight:800,fontSize:14},children:ee.title}),J.jsxs("div",{style:{display:"flex",gap:8},children:[J.jsx("button",{onClick:()=>{if(bn(null),ls([]),cn(null),ee.key!=="park"&&Qs(!1),ee.key==="park"){Da(null),Qs(!1);const er=!Rn;Si(er),er&&(Ji([]),vs.current=null,Mr("  :   , - ."));return}Si(!1),Da(ee.key),Mr(ee.key==="comm"?" :   .":" :    .")},style:{padding:"6px 10px",borderRadius:8,border:"1px solid rgba(255,255,255,0.15)",background:ee.key==="park"&&Rn?"rgba(46,204,113,0.25)":"rgba(17, 134, 255, 0.2)",color:"white",fontSize:13,fontWeight:700,cursor:"pointer"},children:ee.key==="park"&&Rn?"":""}),ee.key==="park"&&J.jsx("button",{onClick:()=>{const er=!ri;Qs(er),Si(!1),bn(null),Da(null),er&&Mr("       .")},style:{padding:"6px 10px",borderRadius:8,border:"1px solid rgba(255,255,255,0.15)",background:ri?"rgba(245, 158, 11, 0.4)":"rgba(255,255,255,0.05)",color:"white",fontSize:13,fontWeight:700,cursor:"pointer"},title:"      ",children:ri?"":""}),J.jsx("button",{onClick:()=>{Da(null),ls([]),cn(null),Si(!1),Qs(!1),bn(er=>er===ee.key?null:ee.key),Mr(" :    .")},style:{padding:"6px 10px",borderRadius:8,border:"1px solid rgba(255,255,255,0.15)",background:bo===ee.key?"rgba(255, 80, 80, 0.4)":"rgba(255,255,255,0.05)",color:"white",fontSize:13,fontWeight:700,cursor:"pointer"},children:bo===ee.key?"":""})]})]},ee.key))}),J.jsxs("div",{style:{marginTop:12,paddingTop:12,borderTop:"1px solid rgba(255,255,255,0.15)",display:"flex",gap:10},children:[J.jsx("button",{onClick:()=>{window.confirm("     ?")&&(ue([]),je([]),vt([]),Oa([]),Da(null),bn(null),ls([]),cn(null),Si(!1),Mr("  ."))},style:{flex:1,padding:"8px",borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:"rgba(255, 80, 80, 0.15)",color:"#ffcccc",fontSize:13,fontWeight:700,cursor:"pointer"},children:" "}),J.jsx("button",{onClick:()=>{Da(null),bn(null),ls([]),cn(null),Si(!1),Mr("  .")},style:{flex:1,padding:"8px",borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:"rgba(255,255,255,0.05)",color:"white",fontSize:13,fontWeight:700,cursor:"pointer"},children:" "})]})]}),J.jsxs("div",{children:[J.jsxs("div",{style:{background:"rgba(255,255,255,0.06)",borderRadius:12,padding:12,marginBottom:12},children:[J.jsx("div",{style:{fontWeight:900,marginBottom:8},children:" 5:     "}),J.jsxs("div",{style:{fontSize:13,opacity:.92,lineHeight:1.45},children:["      (/).",J.jsx("b",{children:"      "}),'       5.      6 ("").']}),J.jsxs("div",{style:{display:"grid",gridTemplateColumns:"minmax(0,1fr) minmax(0,1fr)",gap:10,marginTop:10},children:[J.jsxs("div",{children:[J.jsx("div",{style:{fontSize:12,opacity:.85,marginBottom:4},children:" "}),J.jsx("select",{value:gn,onChange:ee=>ga(ee.target.value),style:{width:"100%",padding:8,borderRadius:10,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(0,0,0,0.25)",color:"white"},children:Fn.map(ee=>J.jsx("option",{value:ee,children:ee},ee))})]}),J.jsxs("div",{children:[J.jsx("div",{style:{fontSize:12,opacity:.85,marginBottom:4},children:"  "}),J.jsx("select",{value:Yi,onChange:ee=>xo(ee.target.value),style:{width:"100%",padding:8,borderRadius:10,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(0,0,0,0.25)",color:"white"},children:Ga.map(ee=>J.jsx("option",{value:ee,children:ee},ee))})]}),J.jsxs("div",{children:[J.jsx("div",{style:{fontSize:12,opacity:.85,marginBottom:4},children:"  ()"}),J.jsxs("select",{value:Xt,onChange:ee=>xe(ee.target.value),style:{width:"100%",padding:8,borderRadius:10,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(0,0,0,0.25)",color:"white"},children:[J.jsx("option",{value:"None",children:"None"}),Fn.map(ee=>J.jsx("option",{value:ee,children:ee},ee))]})]}),J.jsxs("div",{children:[J.jsx("div",{style:{fontSize:12,opacity:.85,marginBottom:4},children:" "}),J.jsxs("select",{value:oi,onChange:ee=>xs(ee.target.value),style:{width:"100%",padding:8,borderRadius:10,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(0,0,0,0.25)",color:"white"},children:[J.jsx("option",{value:"",children:"  "}),J.jsx("option",{value:"",children:" ()"})]})]})]}),J.jsxs("div",{style:{display:"grid",gridTemplateColumns:"minmax(0,1fr) minmax(0,1fr)",gap:10,marginTop:10},children:[J.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[J.jsx("input",{type:"checkbox",checked:Ue,onChange:ee=>Fe(ee.target.checked)}),J.jsx("div",{style:{fontSize:13,whiteSpace:"nowrap"},children:"   ( )"})]}),J.jsx("div",{}),J.jsxs("div",{style:{opacity:Ue?1:.5},children:[J.jsx("div",{style:{fontSize:12,opacity:.85,marginBottom:4},children:" "}),J.jsx("select",{disabled:!Ue,value:Re,onChange:ee=>Te(ee.target.value),style:{width:"100%",padding:8,borderRadius:10,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(0,0,0,0.25)",color:"white"},children:Fn.map(ee=>J.jsx("option",{value:ee,children:ee},ee))})]}),J.jsxs("div",{style:{opacity:Ue?1:.5},children:[J.jsx("div",{style:{fontSize:12,opacity:.85,marginBottom:4},children:" "}),J.jsxs("select",{disabled:!Ue,value:ze,onChange:ee=>mt(parseInt(ee.target.value,10)),style:{width:"100%",padding:8,borderRadius:10,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(0,0,0,0.25)",color:"white"},children:[J.jsx("option",{value:1,children:" 1"}),J.jsx("option",{value:2,children:" 2"}),J.jsx("option",{value:3,children:" 3"})]})]})]}),J.jsxs("div",{style:{display:"grid",gridTemplateColumns:"minmax(0,1fr) minmax(0,1fr)",gap:10,marginTop:10},children:[J.jsxs("div",{children:[J.jsx("div",{style:{fontSize:12,opacity:.85,marginBottom:4},children:"Desired discriminability"}),J.jsx("select",{value:Ut,onChange:ee=>It(ee.target.value),style:{width:"100%",padding:8,borderRadius:10,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(0,0,0,0.25)",color:"white"},children:Vn.map(ee=>J.jsx("option",{value:ee,children:ee},ee))})]}),J.jsxs("div",{children:[J.jsx("div",{style:{fontSize:12,opacity:.85,marginBottom:4},children:"Scoring mode"}),J.jsx("select",{value:Tt,onChange:ee=>gt(ee.target.value),style:{width:"100%",padding:8,borderRadius:10,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(0,0,0,0.25)",color:"white"},children:va.map(ee=>J.jsx("option",{value:ee,children:ee},ee))})]})]}),J.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:10,marginTop:10,alignItems:"end"},children:[J.jsxs("div",{children:[J.jsx("div",{style:{fontSize:12,opacity:.85,marginBottom:4},children:" "}),J.jsx("input",{type:"number",value:ir,onChange:ee=>vr(parseFloat(ee.target.value||"0")),style:{width:"80%",padding:8,borderRadius:10,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(0,0,0,0.25)",color:"white"}})]}),J.jsxs("div",{children:[J.jsx("div",{style:{fontSize:12,opacity:.85,marginBottom:4},children:" "}),J.jsx("input",{type:"number",value:Sr,onChange:ee=>dr(parseFloat(ee.target.value||"0")),style:{width:"80%",padding:8,borderRadius:10,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(0,0,0,0.25)",color:"white"}})]}),J.jsxs("div",{children:[J.jsx("div",{style:{fontSize:12,opacity:.85,marginBottom:4},children:" "}),J.jsx("input",{type:"number",value:xr,onChange:ee=>Nr(parseFloat(ee.target.value||"0")),style:{width:"80%",padding:8,borderRadius:10,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(0,0,0,0.25)",color:"white"}})]})]}),J.jsxs("div",{style:{display:"grid",gridTemplateColumns:"minmax(0,1fr) minmax(0,1fr)",gap:10,marginTop:10},children:[J.jsxs("div",{children:[J.jsx("div",{style:{fontSize:12,opacity:.85,marginBottom:4},children:"Gate threshold (0..1)"}),J.jsx("input",{type:"number",step:.1,min:0,max:1,value:mn,onChange:ee=>tn(parseFloat(ee.target.value||"0")),style:{width:"80%",padding:8,borderRadius:10,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(0,0,0,0.25)",color:"white"}})]}),J.jsxs("div",{children:[J.jsx("div",{style:{fontSize:12,opacity:.85,marginBottom:4},children:"  ()"}),J.jsxs("select",{value:li,onChange:ee=>wi(ee.target.value),style:{width:"80%",padding:8,borderRadius:10,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(0,0,0,0.25)",color:"white"},children:[J.jsx("option",{value:"Auto",children:"Auto"}),J.jsx("option",{value:"A",children:"A"}),J.jsx("option",{value:"B",children:"B"}),J.jsx("option",{value:"C",children:"C"})]})]})]})]}),J.jsxs("div",{style:{marginTop:10,marginBottom:10,padding:"12px 10px",background:"rgba(255,255,255,0.03)",borderRadius:10,border:"1px rgba(255,255,255,0.15)",width:"100%",boxSizing:"border-box"},children:[J.jsx("div",{style:{fontWeight:800,fontSize:13,marginBottom:12,color:"#cbd5e1"},children:"  "}),J.jsxs("div",{style:{marginBottom:10},children:[J.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:12,marginBottom:4},children:[J.jsx("span",{style:{opacity:.8},children:"  ()"}),J.jsx("span",{style:{fontWeight:700},children:p})]}),J.jsx("input",{type:"range",min:0,max:1,step:.1,value:p,onChange:ee=>b(parseFloat(ee.target.value)),style:{width:"100%",cursor:"pointer",height:6}})]}),J.jsxs("div",{style:{marginBottom:12},children:[J.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:12,marginBottom:4},children:[J.jsx("span",{style:{opacity:.8},children:"    "}),J.jsx("input",{type:"number",value:_,onChange:ee=>s(Number(ee.target.value)),style:{width:40,background:"rgba(0,0,0,0.3)",border:"1px solid #555",color:"white",borderRadius:4,textAlign:"center",fontSize:12}})]}),J.jsx("div",{style:{fontSize:10,opacity:.5},children:". ( =   ,   )"})]}),J.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:12},children:[J.jsx("input",{type:"checkbox",id:"chkKeepManual",checked:C,onChange:ee=>M(ee.target.checked),style:{cursor:"pointer"}}),J.jsx("label",{htmlFor:"chkKeepManual",style:{fontSize:12,cursor:"pointer",opacity:.8},children:"  "})]}),J.jsx("button",{onClick:Ts,disabled:!Je,style:{width:"100%",padding:"10px",borderRadius:8,border:"1px solid rgba(147, 51, 234, 0.4)",background:Je?"rgba(147, 51, 234, 0.15)":"rgba(255,255,255,0.05)",color:"#e8eefc",cursor:Je?"pointer":"not-allowed",fontWeight:800,fontSize:14,transition:"all 0.2s"},children:"    "})]}),J.jsxs("div",{style:{background:"rgba(255,255,255,0.06)",borderRadius:12,padding:12,marginBottom:20},children:[J.jsx("div",{style:{fontWeight:900,marginBottom:6},children:" 6:  "}),J.jsx("div",{style:{fontSize:13,opacity:.85,marginBottom:12},children:"  .      ."}),J.jsxs("div",{style:{display:"flex",gap:10,marginBottom:12},children:[J.jsx("button",{onClick:()=>{const ee=u.current;if(ee){const Ke=dg(ee,Aa.current,fe,ye,at,la.current);Gr(Ke),setTimeout(()=>ws(),50)}an(!xn)},disabled:!Je,style:{flex:1,padding:"10px",borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:xn?"rgba(34, 197, 94, 0.2)":"rgba(255,255,255,0.06)",color:xn?"#4ade80":"#e8eefc",cursor:Je?"pointer":"not-allowed",fontWeight:900,fontSize:14,transition:"all 0.2s"},children:xn?" ":" "}),J.jsx("button",{onClick:()=>{if(hr.length===0){const ee=u.current;if(ee){const Ke=dg(ee,Aa.current,fe,ye,at,la.current);Gr(Ke),setTimeout(()=>ws(),50)}}Ds(!0)},disabled:!Je,style:{flex:.4,padding:"10px",borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:"rgba(255,255,255,0.04)",color:"#e8eefc",cursor:Je?"pointer":"not-allowed",fontWeight:900,fontSize:14,opacity:Je?1:.5},children:" "})]}),za&&J.jsxs("div",{style:{padding:"10px",borderRadius:8,background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",marginBottom:12,animation:"fadeIn 0.5s ease-out"},children:[J.jsxs("div",{style:{fontWeight:900,color:"#4ade80",fontSize:14,marginBottom:2},children:[" :  ",za==="A"?"":za==="B"?"":""]}),J.jsx("div",{style:{fontSize:11,opacity:.8},children:ss})]}),xn&&hr.length>0&&J.jsxs("div",{style:{marginTop:0,paddingTop:12,borderTop:"1px solid rgba(255,255,255,0.1)",animation:"fadeIn 0.3s ease-in-out"},children:[J.jsx("div",{style:{overflowX:"auto"},children:J.jsxs("table",{style:{width:"100%",fontSize:11,borderCollapse:"collapse",textAlign:"right"},children:[J.jsx("thead",{children:J.jsxs("tr",{style:{color:"#94a3b8"},children:[J.jsx("th",{style:{padding:4},children:""}),J.jsx("th",{style:{padding:4},children:'"'}),J.jsx("th",{style:{padding:4},children:""}),J.jsx("th",{style:{padding:4},children:""})]})}),J.jsx("tbody",{children:hr.map(ee=>J.jsxs("tr",{style:{borderTop:"1px solid rgba(255,255,255,0.05)"},children:[J.jsx("td",{style:{padding:"6px 4px",fontWeight:800},children:ee.route==="A"?"":ee.route==="B"?"":""}),J.jsx("td",{style:{padding:4},children:(ee.totalLengthM/1e3).toFixed(1)}),J.jsx("td",{style:{padding:4,color:"#fbbf24",fontWeight:700},children:(ee.totalTimeS/60).toFixed(0)}),J.jsx("td",{style:{padding:4},children:Math.round((ee.segments.reduce((Ke,ht)=>Ke+ht.speedScore,0)/3+ee.segments.reduce((Ke,ht)=>Ke+ht.economyScore,0)/3)/2)})]},ee.route))})]})}),J.jsx("div",{style:{marginTop:8,fontSize:11,opacity:.5,textAlign:"center"},children:' ,   " CSV" .'})]})]})]}),Yn&&J.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.55)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center",padding:16,fontFamily:"Arial, sans-serif",direction:"rtl"},onMouseDown:()=>ys(!1),children:J.jsxs("div",{style:{width:720,maxWidth:"100%",maxHeight:"90vh",overflow:"auto",background:"#0b0f17",border:"1px solid rgba(255,255,255,0.15)",borderRadius:14,boxShadow:"0 16px 40px rgba(0,0,0,0.45)",padding:14},onMouseDown:ee=>ee.stopPropagation(),children:[J.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:10,marginBottom:10},children:[J.jsx("div",{style:{fontWeight:900,fontSize:16},children:"   "}),J.jsx("button",{onClick:()=>ys(!1),style:{border:"1px solid rgba(255,255,255,0.15)",background:"rgba(255,255,255,0.06)",color:"#e8eefc",borderRadius:10,padding:"8px 10px",cursor:"pointer",fontWeight:900},title:"",children:""})]}),J.jsxs("div",{style:{fontSize:12,opacity:.8,marginBottom:10},children:["  ,     ",J.jsx("b",{children:" "}),".     . : ",J.jsx("b",{children:fe.length})," , ",J.jsx("b",{children:ye.length})," , ",J.jsx("b",{children:at.length}),"  , ",J.jsx("b",{children:zn.length})," ."]}),J.jsxs("div",{style:{marginTop:12,paddingTop:10,borderTop:"1px solid rgba(255,255,255,0.12)"},children:[J.jsx("div",{style:{fontWeight:800,marginBottom:8,textAlign:"right"},children:" "}),J.jsx("button",{onClick:()=>{const ee=!Rn;Si(ee),ee?(Ji([]),vs.current=null):(Ji([]),vs.current=null)},disabled:!Je,style:{width:"100%",padding:"10px 12px",marginTop:6,borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:Rn?"rgba(46,204,113,0.25)":"rgba(255,255,255,0.06)",color:"#e8eefc",cursor:Je?"pointer":"not-allowed",textAlign:"right",fontWeight:900},title:Je?Rn?"   (  , ESC )":"   ":"      ",children:Rn?" ":" "}),J.jsx("button",{onClick:()=>zl(),disabled:zn.length===0&&Rs.length===0,style:{width:"100%",padding:"10px 12px",marginTop:8,borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:"rgba(255,255,255,0.06)",color:"#e8eefc",cursor:zn.length===0&&Rs.length===0?"not-allowed":"pointer",textAlign:"right",fontWeight:900},children:"  "}),Rn&&J.jsx("div",{style:{marginTop:8,fontSize:12,opacity:.85,textAlign:"right",lineHeight:1.5},children:":    :    Delete:    ESC: "})]})]})})]}),ie==="SINGLE"&&J.jsxs("div",{style:{background:"rgba(255,255,255,0.06)",borderRadius:12,padding:12,marginBottom:12},children:[J.jsx("div",{style:{fontWeight:900,marginBottom:6},children:" "}),J.jsx("div",{style:{fontSize:13,opacity:.85,marginBottom:10},children:"   waypoint.    OSRM.      (fallback)."}),gu&&J.jsx("div",{style:{marginTop:10,fontSize:13,fontWeight:900},children:" "}),J.jsxs("div",{style:{marginTop:10,fontSize:13},children:["Waypoints: ",J.jsx("b",{children:ci.length})]}),J.jsxs("div",{style:{marginTop:6,fontSize:13},children:[" : ",J.jsx("b",{children:ox($h)})]}),J.jsx("button",{onClick:oc,style:{marginTop:10,width:"100%",padding:"10px 12px",borderRadius:12,border:"1px solid rgba(255,255,255,0.15)",background:"transparent",color:"#e8eefc",cursor:"pointer",fontWeight:900},children:"  "})]}),ie==="MEASURE"&&J.jsxs("div",{style:{background:"rgba(255,255,255,0.06)",borderRadius:12,padding:12,marginBottom:12},children:[J.jsx("div",{style:{fontWeight:900,marginBottom:6},children:""}),J.jsx("div",{style:{fontSize:13,opacity:.85,marginBottom:10},children:"    ( )."}),J.jsxs("div",{style:{fontSize:13},children:[": ",J.jsx("b",{children:Lc.length})]}),J.jsxs("div",{style:{marginTop:6,fontSize:13},children:[": ",J.jsx("b",{children:ox(Ii)})]}),J.jsx("button",{onClick:sc,style:{marginTop:10,width:"100%",padding:"10px 12px",borderRadius:12,border:"1px solid rgba(255,255,255,0.15)",background:"transparent",color:"#e8eefc",cursor:"pointer",fontWeight:900},children:" "})]}),J.jsxs("div",{style:{background:"rgba(255,255,255,0.06)",borderRadius:12,padding:12,marginBottom:12},children:[J.jsx("div",{style:{fontWeight:900,marginBottom:6},children:" "}),J.jsxs("div",{style:{fontSize:13,opacity:.85,marginBottom:10,lineHeight:1.45},children:["  ",J.jsx("b",{children:"HTML"}),"     ( +   +  )."]}),J.jsx("button",{onClick:()=>{Wh(za||"A"),hu(!0)},style:{width:"100%",padding:"10px 12px",borderRadius:12,border:"1px solid rgba(255,255,255,0.15)",background:"rgba(140,203,255,0.18)",color:"#e8eefc",cursor:"pointer",fontWeight:900,textAlign:"center",fontFamily:"Arial, sans-serif "},children:"  "}),Js&&J.jsxs("div",{style:{marginTop:10,fontSize:12,opacity:.8,lineHeight:1.4},children:[" : ",J.jsx("b",{children:Js})]})]}),Zh&&J.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,fontFamily:"Arial, sans-serif"},onMouseDown:()=>hu(!1),children:J.jsxs("div",{style:{width:720,maxWidth:"92vw",maxHeight:"92vh",overflowY:"auto",overflowX:"hidden",background:"#0b0f17",border:"1px solid rgba(255,255,255,0.14)",borderRadius:16,padding:14,direction:"rtl"},onMouseDown:ee=>ee.stopPropagation(),children:[J.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12,marginBottom:12},children:[J.jsx("div",{style:{fontWeight:900,fontSize:16},children:"  "}),J.jsx("button",{onClick:()=>hu(!1),style:{padding:"8px 10px",borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:"rgba(255,255,255,0.06)",color:"#e8eefc",cursor:"pointer",fontWeight:900},children:""})]}),J.jsxs("div",{style:{display:"grid",gap:12},children:[J.jsxs("div",{children:[J.jsx("div",{style:{fontWeight:800,marginBottom:6},children:" "}),J.jsx("input",{maxLength:120,value:Ki,onChange:ee=>ih(ee.target.value),style:{width:"96%",padding:"10px 12px",borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:"rgba(0,0,0,0.25)",color:"#e8eefc",outline:"none",fontFamily:"Arial, sans-serif",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}})]}),J.jsxs("div",{children:[J.jsx("div",{style:{fontWeight:800,marginBottom:6},children:" "}),J.jsx("textarea",{maxLength:1200,value:Wo,onChange:ee=>Pf(ee.target.value),rows:4,style:{width:"96%",padding:"10px 12px",borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:"rgba(0,0,0,0.25)",color:"#e8eefc",outline:"none",resize:"vertical",fontFamily:"Arial, sans-serif",lineHeight:1.4}})]}),J.jsxs("div",{children:[J.jsx("div",{style:{fontWeight:800,marginBottom:6},children:" ( )"}),J.jsx("textarea",{maxLength:1200,value:gi,onChange:ee=>fu(ee.target.value),rows:3,placeholder:"  /        ()",style:{width:"96%",padding:"10px 12px",borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:"rgba(0,0,0,0.25)",color:"#e8eefc",outline:"none",resize:"vertical",fontFamily:"Arial, sans-serif",lineHeight:1.4}})]}),J.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[J.jsxs("div",{style:{flex:1,minWidth:220},children:[J.jsx("div",{style:{fontWeight:800,marginBottom:6},children:" "}),J.jsxs("select",{value:Sl,onChange:ee=>du(ee.target.value),style:{width:"100%",padding:"10px 12px",borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:"rgba(0,0,0,0.25)",color:"#e8eefc",outline:"none",fontFamily:"Arial, sans-serif"},children:[J.jsx("option",{value:"STACKED",style:{background:"#1e293b",color:"#e8eefc"},children:"  "}),J.jsx("option",{value:"RADAR",style:{background:"#1e293b",color:"#e8eefc"},children:" "}),J.jsx("option",{value:"HEATMAP",style:{background:"#1e293b",color:"#e8eefc"},children:"  "})]})]}),J.jsxs("div",{style:{flex:1,minWidth:220},children:[J.jsx("div",{style:{fontWeight:800,marginBottom:6},children:" "}),J.jsxs("select",{value:Ms,onChange:ee=>Wh(ee.target.value),style:{width:"100%",padding:"10px 12px",borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:"rgba(0,0,0,0.25)",color:"#e8eefc",outline:"none",fontFamily:"Arial, sans-serif"},children:[J.jsx("option",{value:"A",style:{background:"#1e293b",color:"#e8eefc"},children:" "}),J.jsx("option",{value:"B",style:{background:"#1e293b",color:"#e8eefc"},children:" "}),J.jsx("option",{value:"C",style:{background:"#1e293b",color:"#e8eefc"},children:" "})]})]})]}),J.jsxs("div",{children:[J.jsx("div",{style:{fontWeight:800,marginBottom:6},children:" "}),J.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:10,alignItems:"center",padding:"10px 12px",borderRadius:10,border:"1px solid rgba(255,255,255,0.12)",background:"rgba(255,255,255,0.04)"},children:[J.jsx("div",{style:{minWidth:0},children:J.jsx("input",{value:Pc,onChange:ee=>yo(ee.target.value),style:{width:"90%",padding:"10px 12px",borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:"rgba(0,0,0,0.25)",color:"#e8eefc",outline:"none",fontFamily:"Arial, sans-serif"},placeholder:"C\\\\Users\\\\...\\\\Downloads"})}),J.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap"},children:[J.jsx("button",{onClick:hc,style:{padding:"8px 10px",borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:"rgba(255,255,255,0.06)",color:"#e8eefc",cursor:"pointer",fontWeight:900,fontFamily:"Arial, sans-serif"},children:" "}),J.jsx("button",{onClick:fc,style:{padding:"8px 10px",borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:"transparent",color:"#e8eefc",cursor:"pointer",fontWeight:900,fontFamily:"Arial, sans-serif"},children:" "})]})]}),J.jsx("div",{style:{marginTop:8,fontSize:12,opacity:.75,lineHeight:1.4},children:":           .   /   ,     ( )   Downloads."})]}),J.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",marginTop:2},children:[J.jsx("button",{onClick:()=>{ph()},style:{flex:1,minWidth:180,padding:"10px 12px",borderRadius:12,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(140,203,255,0.18)",color:"#e8eefc",cursor:"pointer",fontWeight:900,fontFamily:"Arial, sans-serif"},children:"   (HTML)"}),J.jsxs("button",{onClick:Gc,disabled:!Je,style:{flex:1,minWidth:180,padding:"10px 12px",borderRadius:12,border:"1px solid rgba(255,255,255,0.18)",background:Je?"rgba(34, 197, 94, 0.2)":"rgba(255,255,255,0.05)",color:Je?"#4ade80":"rgba(255,255,255,0.4)",cursor:Je?"pointer":"not-allowed",fontWeight:900,fontFamily:"Arial, sans-serif",display:"flex",alignItems:"center",justifyContent:"center",gap:6},title:"     ",children:[J.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[J.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),J.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),J.jsx("polyline",{points:"7 3 7 8 15 8"})]}),"   (JSON)"]}),J.jsx("button",{onClick:()=>hu(!1),style:{flex:.5,minWidth:100,padding:"10px 12px",borderRadius:12,border:"1px solid rgba(255,255,255,0.18)",background:"transparent",color:"#e8eefc",cursor:"pointer",fontWeight:900,fontFamily:"Arial, sans-serif"},children:""})]}),Js&&J.jsxs("div",{style:{marginTop:2,fontSize:12,opacity:.85},children:[" : ",J.jsx("b",{children:Js})]})]})]})}),fn&&hr.length>0&&J.jsx(CR,{open:fn,onClose:()=>Ds(!1),routeScores:hr,selectedRoute:Za,onSelectRoute:uc}),xt&&J.jsx("div",{style:{position:"fixed",left:"50%",bottom:18,transform:"translateX(-50%)",background:"rgba(0,0,0,0.8)",color:"white",padding:"10px 14px",borderRadius:14,border:"1px solid rgba(255,255,255,0.18)",zIndex:2e4,maxWidth:"92vw",fontFamily:"Arial, sans-serif",direction:"rtl",textAlign:"center"},children:xt}),J.jsx("div",{style:{fontSize:12,opacity:.65},children:":   //       ."}),J.jsx("button",{onClick:()=>Os(),title:"  (JSON)",style:{position:"fixed",bottom:12,left:"50%",transform:"translateX(-50%)",zIndex:10001,padding:"10px 14px",borderRadius:999,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(140,203,255,0.22)",color:"#e8eefc",fontFamily:"Arial, sans-serif",fontWeight:800,cursor:"pointer",boxShadow:"0 8px 22px rgba(0,0,0,0.32)",backdropFilter:"blur(8px)",WebkitBackdropFilter:"blur(8px)"},children:" (JSON)"})]})]})}const PR=()=>{const[r,u]=ke.useState([]),[l,f]=ke.useState(!1),[p,b]=ke.useState([]),_=M=>b(D=>[`${new Date().toLocaleTimeString()}: ${M}`,...D]),s=M=>{if(M.target.files){const D=Array.from(M.target.files).filter(B=>B.name.toLowerCase().endsWith(".json"));u(D),_(` ${D.length}  JSON.`)}},C=async()=>{if(r.length===0){alert("     JSON ");return}f(!0);const M=new Tw;let D=1;try{const B=await fetch("/template.html");if(!B.ok)throw new Error("   template.html  public");const U=await B.text();if(!U.includes("/* DATA_INJECTION_POINT */"))throw new Error("   /* DATA_INJECTION_POINT */ .    template.html");const j=r.sort((z,N)=>z.name.localeCompare(N.name));for(const z of j){const N=await z.text();let Z;try{Z=JSON.parse(N)}catch{_(`  JSON  ${z.name}`);continue}const Y=`SCN_${String(D).padStart(3,"0")}`,W=[{type:"T",label:"Technical"},{type:"R",label:"Realism"},{type:"S",label:"Schematic"}];for(const de of W){const ge={scenarioName:Y,originalFileName:z.name,vizType:de.type,mapState:Z.mapState,routes:Z.routes,entities:Z.entities,task:Z.task,meta:Z.meta},ie=`const DATA = ${JSON.stringify(ge,null,2)};`;let Me=U.replace("/* DATA_INJECTION_POINT */",ie);Me=Me.replace(/<title>.*?<\/title>/,`<title>${Y}</title>`),M.file(`${Y}_${de.type}.html`,Me)}_(`: ${Y} (${z.name})`),D++}const H=await M.generateAsync({type:"blob"});Sw.saveAs(H,"Batch_Scenarios_Output.zip"),_("  !  .")}catch(B){console.error(B),_(`: ${B.message}`)}finally{f(!1)}};return J.jsxs("div",{style:{padding:"20px",direction:"rtl",color:"#e2e8f0",maxWidth:"800px",margin:"0 auto"},children:[J.jsx("h2",{style:{borderBottom:"2px solid #2563EB",paddingBottom:"10px"},children:"  "}),J.jsxs("div",{style:{marginTop:"20px",background:"#1e293b",padding:"20px",borderRadius:"8px"},children:[J.jsxs("div",{style:{background:"#334155",padding:"10px",borderRadius:"4px",marginBottom:"15px",fontSize:"14px",borderRight:"4px solid #F59E0B"},children:[J.jsx("b",{children:" :"}),"   ",J.jsx("code",{children:"template.html"}),"   ",J.jsx("code",{children:"public"})," ."]}),J.jsxs("div",{style:{marginBottom:"20px"},children:[J.jsx("label",{style:{display:"block",marginBottom:"8px"},children:"    JSON:"}),J.jsx("input",{type:"file",webkitdirectory:"true",multiple:!0,onChange:s,style:{width:"100%",padding:"10px",background:"#0f172a",border:"1px solid #334155",borderRadius:"4px",color:"white"}})]}),J.jsx("button",{onClick:C,disabled:l||r.length===0,style:{width:"100%",padding:"15px",background:l?"#475569":"#2563EB",color:"white",fontWeight:"bold",border:"none",borderRadius:"8px",cursor:l?"not-allowed":"pointer"},children:l?"...":"   ZIP"}),J.jsx("div",{style:{marginTop:"20px",background:"#0f172a",padding:"10px",borderRadius:"4px",height:"200px",overflowY:"auto",fontFamily:"monospace",fontSize:"12px",border:"1px solid #334155"},children:p.map((M,D)=>J.jsx("div",{children:M},D))})]})]})};function FR(){const[r,u]=ke.useState(!1),l=()=>u(!r),f=()=>u(!1);return J.jsxs("div",{style:{height:"100vh",display:"flex",flexDirection:"column",background:"#0b0f17",color:"#e2e8f0",fontFamily:"Arial, sans-serif"},children:[J.jsxs("header",{style:{height:"40px",display:"flex",alignItems:"center",padding:"0 15px",background:"#1e293b",borderBottom:"1px solid #334155",flexShrink:0,position:"relative",zIndex:1e3,direction:"rtl"},children:[J.jsx("button",{onClick:l,style:{background:"transparent",border:"none",color:"#fff",fontSize:"24px",cursor:"pointer",padding:"0",lineHeight:"1",marginLeft:"15px"},title:" ",children:""}),J.jsx("h1",{style:{margin:0,fontSize:"18px",fontWeight:"bold",letterSpacing:"1px"},children:"GeoVisLab"}),r&&J.jsxs(J.Fragment,{children:[J.jsx("div",{onClick:f,style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:1001}}),J.jsxs("nav",{style:{position:"absolute",top:"45px",right:"10px",width:"270px",background:"#334155",border:"1px solid #475569",borderRadius:"8px",boxShadow:"0 10px 25px rgba(0,0,0,0.5)",display:"flex",flexDirection:"column",zIndex:1002,overflow:"hidden",direction:"rtl"},children:[J.jsx(V0,{to:"/",onClick:f,style:{padding:"15px",color:"white",textDecoration:"none",borderBottom:"1px solid #475569",transition:"background 0.2s",textAlign:"right"},onMouseOver:p=>p.currentTarget.style.background="#475569",onMouseOut:p=>p.currentTarget.style.background="transparent",children:"  "}),J.jsx(V0,{to:"/manage-exports",onClick:f,style:{padding:"15px",color:"white",textDecoration:"none",borderBottom:"1px solid #475569",textAlign:"right"},onMouseOver:p=>p.currentTarget.style.background="#475569",onMouseOut:p=>p.currentTarget.style.background="transparent",children:"   "}),J.jsx(V0,{to:"/batch-generator",onClick:f,style:{padding:"15px",color:"white",textDecoration:"none",borderBottom:"1px solid #475569",textAlign:"right"},onMouseOver:p=>p.currentTarget.style.background="#475569",onMouseOut:p=>p.currentTarget.style.background="transparent",children:"   (JSON to HTML)"}),J.jsx(V0,{to:"/https://www.youtube.com/results?search_query=rick+roll+1000+hours",onClick:f,style:{padding:"15px",color:"white",textDecoration:"none"},onMouseOver:p=>p.currentTarget.style.background="#475569",onMouseOut:p=>p.currentTarget.style.background="transparent",children:" "})]})]})]}),J.jsx("main",{style:{flex:1,overflow:"hidden",position:"relative"},children:J.jsxs(aS,{children:[J.jsx(fx,{path:"/",element:J.jsx(IR,{})}),J.jsx(fx,{path:"/manage-exports",element:J.jsx(GD,{})}),J.jsx(fx,{path:"/batch-generator",element:J.jsx(PR,{})})]})})]})}sT.createRoot(document.getElementById("root")).render(J.jsx(Jw.StrictMode,{children:J.jsx(CS,{children:J.jsx(FR,{})})}));
