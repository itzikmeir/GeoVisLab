(function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))f(p);new MutationObserver(p=>{for(const b of p)if(b.type==="childList")for(const _ of b.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&f(_)}).observe(document,{childList:!0,subtree:!0});function l(p){const b={};return p.integrity&&(b.integrity=p.integrity),p.referrerPolicy&&(b.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?b.credentials="include":p.crossOrigin==="anonymous"?b.credentials="omit":b.credentials="same-origin",b}function f(p){if(p.ep)return;p.ep=!0;const b=l(p);fetch(p.href,b)}})();var xd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Fx(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var iy={exports:{}},cg={};var G1;function Xw(){if(G1)return cg;G1=1;var r=Symbol.for("react.transitional.element"),u=Symbol.for("react.fragment");function l(f,p,b){var _=null;if(b!==void 0&&(_=""+b),p.key!==void 0&&(_=""+p.key),"key"in p){b={};for(var s in p)s!=="key"&&(b[s]=p[s])}else b=p;return p=b.ref,{$$typeof:r,type:f,key:_,ref:p!==void 0?p:null,props:b}}return cg.Fragment=u,cg.jsx=l,cg.jsxs=l,cg}var H1;function Yw(){return H1||(H1=1,iy.exports=Xw()),iy.exports}var Y=Yw(),sy={exports:{}},Mn={};var q1;function Kw(){if(q1)return Mn;q1=1;var r=Symbol.for("react.transitional.element"),u=Symbol.for("react.portal"),l=Symbol.for("react.fragment"),f=Symbol.for("react.strict_mode"),p=Symbol.for("react.profiler"),b=Symbol.for("react.consumer"),_=Symbol.for("react.context"),s=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),M=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),B=Symbol.for("react.activity"),U=Symbol.iterator;function j(me){return me===null||typeof me!="object"?null:(me=U&&me[U]||me["@@iterator"],typeof me=="function"?me:null)}var H={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},O=Object.assign,N={};function Z(me,ne,Ue){this.props=me,this.context=ne,this.refs=N,this.updater=Ue||H}Z.prototype.isReactComponent={},Z.prototype.setState=function(me,ne){if(typeof me!="object"&&typeof me!="function"&&me!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,me,ne,"setState")},Z.prototype.forceUpdate=function(me){this.updater.enqueueForceUpdate(this,me,"forceUpdate")};function J(){}J.prototype=Z.prototype;function X(me,ne,Ue){this.props=me,this.context=ne,this.refs=N,this.updater=Ue||H}var pe=X.prototype=new J;pe.constructor=X,O(pe,Z.prototype),pe.isPureReactComponent=!0;var ge=Array.isArray;function ve(){}var re={H:null,A:null,T:null,S:null},Ce=Object.prototype.hasOwnProperty;function xe(me,ne,Ue){var Fe=Ue.ref;return{$$typeof:r,type:me,key:ne,ref:Fe!==void 0?Fe:null,props:Ue}}function Ge(me,ne){return xe(me.type,ne,me.props)}function $e(me){return typeof me=="object"&&me!==null&&me.$$typeof===r}function de(me){var ne={"=":"=0",":":"=2"};return"$"+me.replace(/[=:]/g,function(Ue){return ne[Ue]})}var nt=/\/+/g;function le(me,ne){return typeof me=="object"&&me!==null&&me.key!=null?de(""+me.key):ne.toString(36)}function ct(me){switch(me.status){case"fulfilled":return me.value;case"rejected":throw me.reason;default:switch(typeof me.status=="string"?me.then(ve,ve):(me.status="pending",me.then(function(ne){me.status==="pending"&&(me.status="fulfilled",me.value=ne)},function(ne){me.status==="pending"&&(me.status="rejected",me.reason=ne)})),me.status){case"fulfilled":return me.value;case"rejected":throw me.reason}}throw me}function et(me,ne,Ue,Fe,Re){var bt=typeof me;(bt==="undefined"||bt==="boolean")&&(me=null);var Gt=!1;if(me===null)Gt=!0;else switch(bt){case"bigint":case"string":case"number":Gt=!0;break;case"object":switch(me.$$typeof){case r:case u:Gt=!0;break;case D:return Gt=me._init,et(Gt(me._payload),ne,Ue,Fe,Re)}}if(Gt)return Re=Re(me),Gt=Fe===""?"."+le(me,0):Fe,ge(Re)?(Ue="",Gt!=null&&(Ue=Gt.replace(nt,"$&/")+"/"),et(Re,ne,Ue,"",function(Yt){return Yt})):Re!=null&&($e(Re)&&(Re=Ge(Re,Ue+(Re.key==null||me&&me.key===Re.key?"":(""+Re.key).replace(nt,"$&/")+"/")+Gt)),ne.push(Re)),1;Gt=0;var Vt=Fe===""?".":Fe+":";if(ge(me))for(var Bt=0;Bt<me.length;Bt++)Fe=me[Bt],bt=Vt+le(Fe,Bt),Gt+=et(Fe,ne,Ue,bt,Re);else if(Bt=j(me),typeof Bt=="function")for(me=Bt.call(me),Bt=0;!(Fe=me.next()).done;)Fe=Fe.value,bt=Vt+le(Fe,Bt++),Gt+=et(Fe,ne,Ue,bt,Re);else if(bt==="object"){if(typeof me.then=="function")return et(ct(me),ne,Ue,Fe,Re);throw ne=String(me),Error("Objects are not valid as a React child (found: "+(ne==="[object Object]"?"object with keys {"+Object.keys(me).join(", ")+"}":ne)+"). If you meant to render a collection of children, use an array instead.")}return Gt}function He(me,ne,Ue){if(me==null)return me;var Fe=[],Re=0;return et(me,Fe,"","",function(bt){return ne.call(Ue,bt,Re++)}),Fe}function $t(me){if(me._status===-1){var ne=me._result;ne=ne(),ne.then(function(Ue){(me._status===0||me._status===-1)&&(me._status=1,me._result=Ue)},function(Ue){(me._status===0||me._status===-1)&&(me._status=2,me._result=Ue)}),me._status===-1&&(me._status=0,me._result=ne)}if(me._status===1)return me._result.default;throw me._result}var Oe=typeof reportError=="function"?reportError:function(me){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ne=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof me=="object"&&me!==null&&typeof me.message=="string"?String(me.message):String(me),error:me});if(!window.dispatchEvent(ne))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",me);return}console.error(me)},It={map:He,forEach:function(me,ne,Ue){He(me,function(){ne.apply(this,arguments)},Ue)},count:function(me){var ne=0;return He(me,function(){ne++}),ne},toArray:function(me){return He(me,function(ne){return ne})||[]},only:function(me){if(!$e(me))throw Error("React.Children.only expected to receive a single React element child.");return me}};return Mn.Activity=B,Mn.Children=It,Mn.Component=Z,Mn.Fragment=l,Mn.Profiler=p,Mn.PureComponent=X,Mn.StrictMode=f,Mn.Suspense=C,Mn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=re,Mn.__COMPILER_RUNTIME={__proto__:null,c:function(me){return re.H.useMemoCache(me)}},Mn.cache=function(me){return function(){return me.apply(null,arguments)}},Mn.cacheSignal=function(){return null},Mn.cloneElement=function(me,ne,Ue){if(me==null)throw Error("The argument must be a React element, but you passed "+me+".");var Fe=O({},me.props),Re=me.key;if(ne!=null)for(bt in ne.key!==void 0&&(Re=""+ne.key),ne)!Ce.call(ne,bt)||bt==="key"||bt==="__self"||bt==="__source"||bt==="ref"&&ne.ref===void 0||(Fe[bt]=ne[bt]);var bt=arguments.length-2;if(bt===1)Fe.children=Ue;else if(1<bt){for(var Gt=Array(bt),Vt=0;Vt<bt;Vt++)Gt[Vt]=arguments[Vt+2];Fe.children=Gt}return xe(me.type,Re,Fe)},Mn.createContext=function(me){return me={$$typeof:_,_currentValue:me,_currentValue2:me,_threadCount:0,Provider:null,Consumer:null},me.Provider=me,me.Consumer={$$typeof:b,_context:me},me},Mn.createElement=function(me,ne,Ue){var Fe,Re={},bt=null;if(ne!=null)for(Fe in ne.key!==void 0&&(bt=""+ne.key),ne)Ce.call(ne,Fe)&&Fe!=="key"&&Fe!=="__self"&&Fe!=="__source"&&(Re[Fe]=ne[Fe]);var Gt=arguments.length-2;if(Gt===1)Re.children=Ue;else if(1<Gt){for(var Vt=Array(Gt),Bt=0;Bt<Gt;Bt++)Vt[Bt]=arguments[Bt+2];Re.children=Vt}if(me&&me.defaultProps)for(Fe in Gt=me.defaultProps,Gt)Re[Fe]===void 0&&(Re[Fe]=Gt[Fe]);return xe(me,bt,Re)},Mn.createRef=function(){return{current:null}},Mn.forwardRef=function(me){return{$$typeof:s,render:me}},Mn.isValidElement=$e,Mn.lazy=function(me){return{$$typeof:D,_payload:{_status:-1,_result:me},_init:$t}},Mn.memo=function(me,ne){return{$$typeof:M,type:me,compare:ne===void 0?null:ne}},Mn.startTransition=function(me){var ne=re.T,Ue={};re.T=Ue;try{var Fe=me(),Re=re.S;Re!==null&&Re(Ue,Fe),typeof Fe=="object"&&Fe!==null&&typeof Fe.then=="function"&&Fe.then(ve,Oe)}catch(bt){Oe(bt)}finally{ne!==null&&Ue.types!==null&&(ne.types=Ue.types),re.T=ne}},Mn.unstable_useCacheRefresh=function(){return re.H.useCacheRefresh()},Mn.use=function(me){return re.H.use(me)},Mn.useActionState=function(me,ne,Ue){return re.H.useActionState(me,ne,Ue)},Mn.useCallback=function(me,ne){return re.H.useCallback(me,ne)},Mn.useContext=function(me){return re.H.useContext(me)},Mn.useDebugValue=function(){},Mn.useDeferredValue=function(me,ne){return re.H.useDeferredValue(me,ne)},Mn.useEffect=function(me,ne){return re.H.useEffect(me,ne)},Mn.useEffectEvent=function(me){return re.H.useEffectEvent(me)},Mn.useId=function(){return re.H.useId()},Mn.useImperativeHandle=function(me,ne,Ue){return re.H.useImperativeHandle(me,ne,Ue)},Mn.useInsertionEffect=function(me,ne){return re.H.useInsertionEffect(me,ne)},Mn.useLayoutEffect=function(me,ne){return re.H.useLayoutEffect(me,ne)},Mn.useMemo=function(me,ne){return re.H.useMemo(me,ne)},Mn.useOptimistic=function(me,ne){return re.H.useOptimistic(me,ne)},Mn.useReducer=function(me,ne,Ue){return re.H.useReducer(me,ne,Ue)},Mn.useRef=function(me){return re.H.useRef(me)},Mn.useState=function(me){return re.H.useState(me)},Mn.useSyncExternalStore=function(me,ne,Ue){return re.H.useSyncExternalStore(me,ne,Ue)},Mn.useTransition=function(){return re.H.useTransition()},Mn.version="19.2.3",Mn}var Z1;function Xy(){return Z1||(Z1=1,sy.exports=Kw()),sy.exports}var ke=Xy();const Jw=Fx(ke);var oy={exports:{}},ug={},ly={exports:{}},cy={};var W1;function Qw(){return W1||(W1=1,(function(r){function u(et,He){var $t=et.length;et.push(He);e:for(;0<$t;){var Oe=$t-1>>>1,It=et[Oe];if(0<p(It,He))et[Oe]=He,et[$t]=It,$t=Oe;else break e}}function l(et){return et.length===0?null:et[0]}function f(et){if(et.length===0)return null;var He=et[0],$t=et.pop();if($t!==He){et[0]=$t;e:for(var Oe=0,It=et.length,me=It>>>1;Oe<me;){var ne=2*(Oe+1)-1,Ue=et[ne],Fe=ne+1,Re=et[Fe];if(0>p(Ue,$t))Fe<It&&0>p(Re,Ue)?(et[Oe]=Re,et[Fe]=$t,Oe=Fe):(et[Oe]=Ue,et[ne]=$t,Oe=ne);else if(Fe<It&&0>p(Re,$t))et[Oe]=Re,et[Fe]=$t,Oe=Fe;else break e}}return He}function p(et,He){var $t=et.sortIndex-He.sortIndex;return $t!==0?$t:et.id-He.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var b=performance;r.unstable_now=function(){return b.now()}}else{var _=Date,s=_.now();r.unstable_now=function(){return _.now()-s}}var C=[],M=[],D=1,B=null,U=3,j=!1,H=!1,O=!1,N=!1,Z=typeof setTimeout=="function"?setTimeout:null,J=typeof clearTimeout=="function"?clearTimeout:null,X=typeof setImmediate<"u"?setImmediate:null;function pe(et){for(var He=l(M);He!==null;){if(He.callback===null)f(M);else if(He.startTime<=et)f(M),He.sortIndex=He.expirationTime,u(C,He);else break;He=l(M)}}function ge(et){if(O=!1,pe(et),!H)if(l(C)!==null)H=!0,ve||(ve=!0,de());else{var He=l(M);He!==null&&ct(ge,He.startTime-et)}}var ve=!1,re=-1,Ce=5,xe=-1;function Ge(){return N?!0:!(r.unstable_now()-xe<Ce)}function $e(){if(N=!1,ve){var et=r.unstable_now();xe=et;var He=!0;try{e:{H=!1,O&&(O=!1,J(re),re=-1),j=!0;var $t=U;try{t:{for(pe(et),B=l(C);B!==null&&!(B.expirationTime>et&&Ge());){var Oe=B.callback;if(typeof Oe=="function"){B.callback=null,U=B.priorityLevel;var It=Oe(B.expirationTime<=et);if(et=r.unstable_now(),typeof It=="function"){B.callback=It,pe(et),He=!0;break t}B===l(C)&&f(C),pe(et)}else f(C);B=l(C)}if(B!==null)He=!0;else{var me=l(M);me!==null&&ct(ge,me.startTime-et),He=!1}}break e}finally{B=null,U=$t,j=!1}He=void 0}}finally{He?de():ve=!1}}}var de;if(typeof X=="function")de=function(){X($e)};else if(typeof MessageChannel<"u"){var nt=new MessageChannel,le=nt.port2;nt.port1.onmessage=$e,de=function(){le.postMessage(null)}}else de=function(){Z($e,0)};function ct(et,He){re=Z(function(){et(r.unstable_now())},He)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(et){et.callback=null},r.unstable_forceFrameRate=function(et){0>et||125<et?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ce=0<et?Math.floor(1e3/et):5},r.unstable_getCurrentPriorityLevel=function(){return U},r.unstable_next=function(et){switch(U){case 1:case 2:case 3:var He=3;break;default:He=U}var $t=U;U=He;try{return et()}finally{U=$t}},r.unstable_requestPaint=function(){N=!0},r.unstable_runWithPriority=function(et,He){switch(et){case 1:case 2:case 3:case 4:case 5:break;default:et=3}var $t=U;U=et;try{return He()}finally{U=$t}},r.unstable_scheduleCallback=function(et,He,$t){var Oe=r.unstable_now();switch(typeof $t=="object"&&$t!==null?($t=$t.delay,$t=typeof $t=="number"&&0<$t?Oe+$t:Oe):$t=Oe,et){case 1:var It=-1;break;case 2:It=250;break;case 5:It=1073741823;break;case 4:It=1e4;break;default:It=5e3}return It=$t+It,et={id:D++,callback:He,priorityLevel:et,startTime:$t,expirationTime:It,sortIndex:-1},$t>Oe?(et.sortIndex=$t,u(M,et),l(C)===null&&et===l(M)&&(O?(J(re),re=-1):O=!0,ct(ge,$t-Oe))):(et.sortIndex=It,u(C,et),H||j||(H=!0,ve||(ve=!0,de()))),et},r.unstable_shouldYield=Ge,r.unstable_wrapCallback=function(et){var He=U;return function(){var $t=U;U=He;try{return et.apply(this,arguments)}finally{U=$t}}}})(cy)),cy}var $1;function eT(){return $1||($1=1,ly.exports=Qw()),ly.exports}var uy={exports:{}},Bo={};var X1;function tT(){if(X1)return Bo;X1=1;var r=Xy();function u(C){var M="https://react.dev/errors/"+C;if(1<arguments.length){M+="?args[]="+encodeURIComponent(arguments[1]);for(var D=2;D<arguments.length;D++)M+="&args[]="+encodeURIComponent(arguments[D])}return"Minified React error #"+C+"; visit "+M+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(){}var f={d:{f:l,r:function(){throw Error(u(522))},D:l,C:l,L:l,m:l,X:l,S:l,M:l},p:0,findDOMNode:null},p=Symbol.for("react.portal");function b(C,M,D){var B=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:p,key:B==null?null:""+B,children:C,containerInfo:M,implementation:D}}var _=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function s(C,M){if(C==="font")return"";if(typeof M=="string")return M==="use-credentials"?M:""}return Bo.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=f,Bo.createPortal=function(C,M){var D=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!M||M.nodeType!==1&&M.nodeType!==9&&M.nodeType!==11)throw Error(u(299));return b(C,M,null,D)},Bo.flushSync=function(C){var M=_.T,D=f.p;try{if(_.T=null,f.p=2,C)return C()}finally{_.T=M,f.p=D,f.d.f()}},Bo.preconnect=function(C,M){typeof C=="string"&&(M?(M=M.crossOrigin,M=typeof M=="string"?M==="use-credentials"?M:"":void 0):M=null,f.d.C(C,M))},Bo.prefetchDNS=function(C){typeof C=="string"&&f.d.D(C)},Bo.preinit=function(C,M){if(typeof C=="string"&&M&&typeof M.as=="string"){var D=M.as,B=s(D,M.crossOrigin),U=typeof M.integrity=="string"?M.integrity:void 0,j=typeof M.fetchPriority=="string"?M.fetchPriority:void 0;D==="style"?f.d.S(C,typeof M.precedence=="string"?M.precedence:void 0,{crossOrigin:B,integrity:U,fetchPriority:j}):D==="script"&&f.d.X(C,{crossOrigin:B,integrity:U,fetchPriority:j,nonce:typeof M.nonce=="string"?M.nonce:void 0})}},Bo.preinitModule=function(C,M){if(typeof C=="string")if(typeof M=="object"&&M!==null){if(M.as==null||M.as==="script"){var D=s(M.as,M.crossOrigin);f.d.M(C,{crossOrigin:D,integrity:typeof M.integrity=="string"?M.integrity:void 0,nonce:typeof M.nonce=="string"?M.nonce:void 0})}}else M==null&&f.d.M(C)},Bo.preload=function(C,M){if(typeof C=="string"&&typeof M=="object"&&M!==null&&typeof M.as=="string"){var D=M.as,B=s(D,M.crossOrigin);f.d.L(C,D,{crossOrigin:B,integrity:typeof M.integrity=="string"?M.integrity:void 0,nonce:typeof M.nonce=="string"?M.nonce:void 0,type:typeof M.type=="string"?M.type:void 0,fetchPriority:typeof M.fetchPriority=="string"?M.fetchPriority:void 0,referrerPolicy:typeof M.referrerPolicy=="string"?M.referrerPolicy:void 0,imageSrcSet:typeof M.imageSrcSet=="string"?M.imageSrcSet:void 0,imageSizes:typeof M.imageSizes=="string"?M.imageSizes:void 0,media:typeof M.media=="string"?M.media:void 0})}},Bo.preloadModule=function(C,M){if(typeof C=="string")if(M){var D=s(M.as,M.crossOrigin);f.d.m(C,{as:typeof M.as=="string"&&M.as!=="script"?M.as:void 0,crossOrigin:D,integrity:typeof M.integrity=="string"?M.integrity:void 0})}else f.d.m(C)},Bo.requestFormReset=function(C){f.d.r(C)},Bo.unstable_batchedUpdates=function(C,M){return C(M)},Bo.useFormState=function(C,M,D){return _.H.useFormState(C,M,D)},Bo.useFormStatus=function(){return _.H.useHostTransitionStatus()},Bo.version="19.2.3",Bo}var Y1;function rT(){if(Y1)return uy.exports;Y1=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(u){console.error(u)}}return r(),uy.exports=tT(),uy.exports}var K1;function nT(){if(K1)return ug;K1=1;var r=eT(),u=Xy(),l=rT();function f(i){var c="https://react.dev/errors/"+i;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)c+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+i+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function p(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function b(i){var c=i,g=i;if(i.alternate)for(;c.return;)c=c.return;else{i=c;do c=i,(c.flags&4098)!==0&&(g=c.return),i=c.return;while(i)}return c.tag===3?g:null}function _(i){if(i.tag===13){var c=i.memoizedState;if(c===null&&(i=i.alternate,i!==null&&(c=i.memoizedState)),c!==null)return c.dehydrated}return null}function s(i){if(i.tag===31){var c=i.memoizedState;if(c===null&&(i=i.alternate,i!==null&&(c=i.memoizedState)),c!==null)return c.dehydrated}return null}function C(i){if(b(i)!==i)throw Error(f(188))}function M(i){var c=i.alternate;if(!c){if(c=b(i),c===null)throw Error(f(188));return c!==i?null:i}for(var g=i,T=c;;){var I=g.return;if(I===null)break;var L=I.alternate;if(L===null){if(T=I.return,T!==null){g=T;continue}break}if(I.child===L.child){for(L=I.child;L;){if(L===g)return C(I),i;if(L===T)return C(I),c;L=L.sibling}throw Error(f(188))}if(g.return!==T.return)g=I,T=L;else{for(var ae=!1,Ae=I.child;Ae;){if(Ae===g){ae=!0,g=I,T=L;break}if(Ae===T){ae=!0,T=I,g=L;break}Ae=Ae.sibling}if(!ae){for(Ae=L.child;Ae;){if(Ae===g){ae=!0,g=L,T=I;break}if(Ae===T){ae=!0,T=L,g=I;break}Ae=Ae.sibling}if(!ae)throw Error(f(189))}}if(g.alternate!==T)throw Error(f(190))}if(g.tag!==3)throw Error(f(188));return g.stateNode.current===g?i:c}function D(i){var c=i.tag;if(c===5||c===26||c===27||c===6)return i;for(i=i.child;i!==null;){if(c=D(i),c!==null)return c;i=i.sibling}return null}var B=Object.assign,U=Symbol.for("react.element"),j=Symbol.for("react.transitional.element"),H=Symbol.for("react.portal"),O=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),Z=Symbol.for("react.profiler"),J=Symbol.for("react.consumer"),X=Symbol.for("react.context"),pe=Symbol.for("react.forward_ref"),ge=Symbol.for("react.suspense"),ve=Symbol.for("react.suspense_list"),re=Symbol.for("react.memo"),Ce=Symbol.for("react.lazy"),xe=Symbol.for("react.activity"),Ge=Symbol.for("react.memo_cache_sentinel"),$e=Symbol.iterator;function de(i){return i===null||typeof i!="object"?null:(i=$e&&i[$e]||i["@@iterator"],typeof i=="function"?i:null)}var nt=Symbol.for("react.client.reference");function le(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===nt?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case O:return"Fragment";case Z:return"Profiler";case N:return"StrictMode";case ge:return"Suspense";case ve:return"SuspenseList";case xe:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case H:return"Portal";case X:return i.displayName||"Context";case J:return(i._context.displayName||"Context")+".Consumer";case pe:var c=i.render;return i=i.displayName,i||(i=c.displayName||c.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case re:return c=i.displayName||null,c!==null?c:le(i.type)||"Memo";case Ce:c=i._payload,i=i._init;try{return le(i(c))}catch{}}return null}var ct=Array.isArray,et=u.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,He=l.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$t={pending:!1,data:null,method:null,action:null},Oe=[],It=-1;function me(i){return{current:i}}function ne(i){0>It||(i.current=Oe[It],Oe[It]=null,It--)}function Ue(i,c){It++,Oe[It]=i.current,i.current=c}var Fe=me(null),Re=me(null),bt=me(null),Gt=me(null);function Vt(i,c){switch(Ue(bt,c),Ue(Re,i),Ue(Fe,null),c.nodeType){case 9:case 11:i=(i=c.documentElement)&&(i=i.namespaceURI)?kh(i):0;break;default:if(i=c.tagName,c=c.namespaceURI)c=kh(c),i=Nm(c,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}ne(Fe),Ue(Fe,i)}function Bt(){ne(Fe),ne(Re),ne(bt)}function Yt(i){i.memoizedState!==null&&Ue(Gt,i);var c=Fe.current,g=Nm(c,i.type);c!==g&&(Ue(Re,i),Ue(Fe,g))}function Or(i){Re.current===i&&(ne(Fe),ne(Re)),Gt.current===i&&(ne(Gt),cd._currentValue=$t)}var Ye,pn;function se(i){if(Ye===void 0)try{throw Error()}catch(g){var c=g.stack.trim().match(/\n( *(at )?)/);Ye=c&&c[1]||"",pn=-1<g.stack.indexOf(`
    at`)?" (<anonymous>)":-1<g.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ye+i+pn}var Mt=!1;function yt(i,c){if(!i||Mt)return"";Mt=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var T={DetermineComponentFrameRoot:function(){try{if(c){var sr=function(){throw Error()};if(Object.defineProperty(sr.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(sr,[])}catch(qt){var Ot=qt}Reflect.construct(i,[],sr)}else{try{sr.call()}catch(qt){Ot=qt}i.call(sr.prototype)}}else{try{throw Error()}catch(qt){Ot=qt}(sr=i())&&typeof sr.catch=="function"&&sr.catch(function(){})}}catch(qt){if(qt&&Ot&&typeof qt.stack=="string")return[qt.stack,Ot.stack]}return[null,null]}};T.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var I=Object.getOwnPropertyDescriptor(T.DetermineComponentFrameRoot,"name");I&&I.configurable&&Object.defineProperty(T.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var L=T.DetermineComponentFrameRoot(),ae=L[0],Ae=L[1];if(ae&&Ae){var ut=ae.split(`
`),Lt=Ae.split(`
`);for(I=T=0;T<ut.length&&!ut[T].includes("DetermineComponentFrameRoot");)T++;for(;I<Lt.length&&!Lt[I].includes("DetermineComponentFrameRoot");)I++;if(T===ut.length||I===Lt.length)for(T=ut.length-1,I=Lt.length-1;1<=T&&0<=I&&ut[T]!==Lt[I];)I--;for(;1<=T&&0<=I;T--,I--)if(ut[T]!==Lt[I]){if(T!==1||I!==1)do if(T--,I--,0>I||ut[T]!==Lt[I]){var er=`
`+ut[T].replace(" at new "," at ");return i.displayName&&er.includes("<anonymous>")&&(er=er.replace("<anonymous>",i.displayName)),er}while(1<=T&&0<=I);break}}}finally{Mt=!1,Error.prepareStackTrace=g}return(g=i?i.displayName||i.name:"")?se(g):""}function Ee(i,c){switch(i.tag){case 26:case 27:case 5:return se(i.type);case 16:return se("Lazy");case 13:return i.child!==c&&c!==null?se("Suspense Fallback"):se("Suspense");case 19:return se("SuspenseList");case 0:case 15:return yt(i.type,!1);case 11:return yt(i.type.render,!1);case 1:return yt(i.type,!0);case 31:return se("Activity");default:return""}}function Ne(i){try{var c="",g=null;do c+=Ee(i,g),g=i,i=i.return;while(i);return c}catch(T){return`
Error generating stack: `+T.message+`
`+T.stack}}var pt=Object.prototype.hasOwnProperty,Jt=r.unstable_scheduleCallback,Kt=r.unstable_cancelCallback,Et=r.unstable_shouldYield,lr=r.unstable_requestPaint,pr=r.unstable_now,ir=r.unstable_getCurrentPriorityLevel,st=r.unstable_ImmediatePriority,fe=r.unstable_UserBlockingPriority,he=r.unstable_NormalPriority,we=r.unstable_LowPriority,Ve=r.unstable_IdlePriority,Xe=r.log,xt=r.unstable_setDisableYieldValue,ot=null,it=null;function vt(i){if(typeof Xe=="function"&&xt(i),it&&typeof it.setStrictMode=="function")try{it.setStrictMode(ot,i)}catch{}}var zt=Math.clz32?Math.clz32:kr,Wt=Math.log,mr=Math.LN2;function kr(i){return i>>>=0,i===0?32:31-(Wt(i)/mr|0)|0}var Kr=256,yn=262144,hn=4194304;function ht(i){var c=i&42;if(c!==0)return c;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function En(i,c,g){var T=i.pendingLanes;if(T===0)return 0;var I=0,L=i.suspendedLanes,ae=i.pingedLanes;i=i.warmLanes;var Ae=T&134217727;return Ae!==0?(T=Ae&~L,T!==0?I=ht(T):(ae&=Ae,ae!==0?I=ht(ae):g||(g=Ae&~i,g!==0&&(I=ht(g))))):(Ae=T&~L,Ae!==0?I=ht(Ae):ae!==0?I=ht(ae):g||(g=T&~i,g!==0&&(I=ht(g)))),I===0?0:c!==0&&c!==I&&(c&L)===0&&(L=I&-I,g=c&-c,L>=g||L===32&&(g&4194048)!==0)?c:I}function Kn(i,c){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&c)===0}function Qr(i,c){switch(i){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ln(){var i=hn;return hn<<=1,(hn&62914560)===0&&(hn=4194304),i}function Ba(i){for(var c=[],g=0;31>g;g++)c.push(i);return c}function zn(i,c){i.pendingLanes|=c,c!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function tn(i,c,g,T,I,L){var ae=i.pendingLanes;i.pendingLanes=g,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=g,i.entangledLanes&=g,i.errorRecoveryDisabledLanes&=g,i.shellSuspendCounter=0;var Ae=i.entanglements,ut=i.expirationTimes,Lt=i.hiddenUpdates;for(g=ae&~g;0<g;){var er=31-zt(g),sr=1<<er;Ae[er]=0,ut[er]=-1;var Ot=Lt[er];if(Ot!==null)for(Lt[er]=null,er=0;er<Ot.length;er++){var qt=Ot[er];qt!==null&&(qt.lane&=-536870913)}g&=~sr}T!==0&&Bn(i,T,0),L!==0&&I===0&&i.tag!==0&&(i.suspendedLanes|=L&~(ae&~c))}function Bn(i,c,g){i.pendingLanes|=c,i.suspendedLanes&=~c;var T=31-zt(c);i.entangledLanes|=c,i.entanglements[T]=i.entanglements[T]|1073741824|g&261930}function ba(i,c){var g=i.entangledLanes|=c;for(i=i.entanglements;g;){var T=31-zt(g),I=1<<T;I&c|i[T]&c&&(i[T]|=c),g&=~I}}function El(i,c){var g=c&-c;return g=(g&42)!==0?1:Zo(g),(g&(i.suspendedLanes|c))!==0?0:g}function Zo(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Qt(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function ye(){var i=He.p;return i!==0?i:(i=window.event,i===void 0?32:xf(i.type))}function je(i,c){var g=He.p;try{return He.p=i,c()}finally{He.p=g}}var Le=Math.random().toString(36).slice(2),Me="__reactFiber$"+Le,Te="__reactProps$"+Le,Pe="__reactContainer$"+Le,gt="__reactEvents$"+Le,jt="__reactListeners$"+Le,Dt="__reactHandles$"+Le,At="__reactResources$"+Le,_t="__reactMarker$"+Le;function or(i){delete i[Me],delete i[Te],delete i[gt],delete i[jt],delete i[Dt]}function yr(i){var c=i[Me];if(c)return c;for(var g=i.parentNode;g;){if(c=g[Pe]||g[Me]){if(g=c.alternate,c.child!==null||g!==null&&g.child!==null)for(i=tp(i);i!==null;){if(g=i[Me])return g;i=tp(i)}return c}i=g,g=i.parentNode}return null}function vr(i){if(i=i[Me]||i[Pe]){var c=i.tag;if(c===5||c===6||c===13||c===31||c===26||c===27||c===3)return i}return null}function fr(i){var c=i.tag;if(c===5||c===26||c===27||c===6)return i.stateNode;throw Error(f(33))}function _r(i){var c=i[At];return c||(c=i[At]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function Ur(i){i[_t]=!0}var Tn=new Set,vn={};function Zr(i,c){Mi(i,c),Mi(i+"Capture",c)}function Mi(i,c){for(vn[i]=c,i=0;i<c.length;i++)Tn.add(c[i])}var Fs=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),pi={},bi={};function oi(i){return pt.call(bi,i)?!0:pt.call(pi,i)?!1:Fs.test(i)?bi[i]=!0:(pi[i]=!0,!1)}function Di(i,c,g){if(oi(c))if(g===null)i.removeAttribute(c);else{switch(typeof g){case"undefined":case"function":case"symbol":i.removeAttribute(c);return;case"boolean":var T=c.toLowerCase().slice(0,5);if(T!=="data-"&&T!=="aria-"){i.removeAttribute(c);return}}i.setAttribute(c,""+g)}}function wi(i,c,g){if(g===null)i.removeAttribute(c);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(c);return}i.setAttribute(c,""+g)}}function bs(i,c,g,T){if(T===null)i.removeAttribute(g);else{switch(typeof T){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(g);return}i.setAttributeNS(c,g,""+T)}}function bn(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function lu(i){var c=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function kc(i,c,g){var T=Object.getOwnPropertyDescriptor(i.constructor.prototype,c);if(!i.hasOwnProperty(c)&&typeof T<"u"&&typeof T.get=="function"&&typeof T.set=="function"){var I=T.get,L=T.set;return Object.defineProperty(i,c,{configurable:!0,get:function(){return I.call(this)},set:function(ae){g=""+ae,L.call(this,ae)}}),Object.defineProperty(i,c,{enumerable:T.enumerable}),{getValue:function(){return g},setValue:function(ae){g=""+ae},stopTracking:function(){i._valueTracker=null,delete i[c]}}}}function Wo(i){if(!i._valueTracker){var c=lu(i)?"checked":"value";i._valueTracker=kc(i,c,""+i[c])}}function cu(i){if(!i)return!1;var c=i._valueTracker;if(!c)return!0;var g=c.getValue(),T="";return i&&(T=lu(i)?i.checked?"true":"false":i.value),i=T,i!==g?(c.setValue(i),!0):!1}function uu(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var Cc=/[\n"\\]/g;function Na(i){return i.replace(Cc,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function Mc(i,c,g,T,I,L,ae,Ae){i.name="",ae!=null&&typeof ae!="function"&&typeof ae!="symbol"&&typeof ae!="boolean"?i.type=ae:i.removeAttribute("type"),c!=null?ae==="number"?(c===0&&i.value===""||i.value!=c)&&(i.value=""+bn(c)):i.value!==""+bn(c)&&(i.value=""+bn(c)):ae!=="submit"&&ae!=="reset"||i.removeAttribute("value"),c!=null?hu(i,ae,bn(c)):g!=null?hu(i,ae,bn(g)):T!=null&&i.removeAttribute("value"),I==null&&L!=null&&(i.defaultChecked=!!L),I!=null&&(i.checked=I&&typeof I!="function"&&typeof I!="symbol"),Ae!=null&&typeof Ae!="function"&&typeof Ae!="symbol"&&typeof Ae!="boolean"?i.name=""+bn(Ae):i.removeAttribute("name")}function Wl(i,c,g,T,I,L,ae,Ae){if(L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"&&(i.type=L),c!=null||g!=null){if(!(L!=="submit"&&L!=="reset"||c!=null)){Wo(i);return}g=g!=null?""+bn(g):"",c=c!=null?""+bn(c):g,Ae||c===i.value||(i.value=c),i.defaultValue=c}T=T??I,T=typeof T!="function"&&typeof T!="symbol"&&!!T,i.checked=Ae?i.checked:!!T,i.defaultChecked=!!T,ae!=null&&typeof ae!="function"&&typeof ae!="symbol"&&typeof ae!="boolean"&&(i.name=ae),Wo(i)}function hu(i,c,g){c==="number"&&uu(i.ownerDocument)===i||i.defaultValue===""+g||(i.defaultValue=""+g)}function mo(i,c,g,T){if(i=i.options,c){c={};for(var I=0;I<g.length;I++)c["$"+g[I]]=!0;for(g=0;g<i.length;g++)I=c.hasOwnProperty("$"+i[g].value),i[g].selected!==I&&(i[g].selected=I),I&&T&&(i[g].defaultSelected=!0)}else{for(g=""+bn(g),c=null,I=0;I<i.length;I++){if(i[I].value===g){i[I].selected=!0,T&&(i[I].defaultSelected=!0);return}c!==null||i[I].disabled||(c=i[I])}c!==null&&(c.selected=!0)}}function Df(i,c,g){if(c!=null&&(c=""+bn(c),c!==i.value&&(i.value=c),g==null)){i.defaultValue!==c&&(i.defaultValue=c);return}i.defaultValue=g!=null?""+bn(g):""}function $o(i,c,g,T){if(c==null){if(T!=null){if(g!=null)throw Error(f(92));if(ct(T)){if(1<T.length)throw Error(f(93));T=T[0]}g=T}g==null&&(g=""),c=g}g=bn(c),i.defaultValue=g,T=i.textContent,T===g&&T!==""&&T!==null&&(i.value=T),Wo(i)}function go(i,c){if(c){var g=i.firstChild;if(g&&g===i.lastChild&&g.nodeType===3){g.nodeValue=c;return}}i.textContent=c}var Rf=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Xo(i,c,g){var T=c.indexOf("--")===0;g==null||typeof g=="boolean"||g===""?T?i.setProperty(c,""):c==="float"?i.cssFloat="":i[c]="":T?i.setProperty(c,g):typeof g!="number"||g===0||Rf.has(c)?c==="float"?i.cssFloat=g:i[c]=(""+g).trim():i[c]=g+"px"}function fu(i,c,g){if(c!=null&&typeof c!="object")throw Error(f(62));if(i=i.style,g!=null){for(var T in g)!g.hasOwnProperty(T)||c!=null&&c.hasOwnProperty(T)||(T.indexOf("--")===0?i.setProperty(T,""):T==="float"?i.cssFloat="":i[T]="");for(var I in c)T=c[I],c.hasOwnProperty(I)&&g[I]!==T&&Xo(i,I,T)}else for(var L in c)c.hasOwnProperty(L)&&Xo(i,L,c[L])}function Yo(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Al=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ko=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ln(i){return Ko.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function _o(){}var nh=null;function Dc(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Ma=null,qa=null;function Hn(i){var c=vr(i);if(c&&(i=c.stateNode)){var g=i[Te]||null;e:switch(i=c.stateNode,c.type){case"input":if(Mc(i,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name),c=g.name,g.type==="radio"&&c!=null){for(g=i;g.parentNode;)g=g.parentNode;for(g=g.querySelectorAll('input[name="'+Na(""+c)+'"][type="radio"]'),c=0;c<g.length;c++){var T=g[c];if(T!==i&&T.form===i.form){var I=T[Te]||null;if(!I)throw Error(f(90));Mc(T,I.value,I.defaultValue,I.defaultValue,I.checked,I.defaultChecked,I.type,I.name)}}for(c=0;c<g.length;c++)T=g[c],T.form===i.form&&cu(T)}break e;case"textarea":Df(i,g.value,g.defaultValue);break e;case"select":c=g.value,c!=null&&mo(i,!!g.multiple,c,!1)}}}var en=!1;function Jn(i,c,g){if(en)return i(c,g);en=!0;try{var T=i(c);return T}finally{if(en=!1,(Ma!==null||qa!==null)&&(Wd(),Ma&&(c=Ma,i=qa,qa=Ma=null,Hn(c),i)))for(c=0;c<i.length;c++)Hn(i[c])}}function os(i,c){var g=i.stateNode;if(g===null)return null;var T=g[Te]||null;if(T===null)return null;g=T[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(T=!T.disabled)||(i=i.type,T=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!T;break e;default:i=!1}if(i)return null;if(g&&typeof g!="function")throw Error(f(231,c,typeof g));return g}var Da=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ri=!1;if(Da)try{var $n={};Object.defineProperty($n,"passive",{get:function(){Ri=!0}}),window.addEventListener("test",$n,$n),window.removeEventListener("test",$n,$n)}catch{Ri=!1}var ei=null,mi=null,kn=null;function kl(){if(kn)return kn;var i,c=mi,g=c.length,T,I="value"in ei?ei.value:ei.textContent,L=I.length;for(i=0;i<g&&c[i]===I[i];i++);var ae=g-i;for(T=1;T<=ae&&c[g-T]===I[L-T];T++);return kn=I.slice(i,1<T?1-T:void 0)}function Ea(i){var c=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&c===13&&(i=13)):i=c,i===10&&(i=13),32<=i||i===13?i:0}function Ii(){return!0}function ja(){return!1}function Ra(i){function c(g,T,I,L,ae){this._reactName=g,this._targetInst=I,this.type=T,this.nativeEvent=L,this.target=ae,this.currentTarget=null;for(var Ae in i)i.hasOwnProperty(Ae)&&(g=i[Ae],this[Ae]=g?g(L):L[Ae]);return this.isDefaultPrevented=(L.defaultPrevented!=null?L.defaultPrevented:L.returnValue===!1)?Ii:ja,this.isPropagationStopped=ja,this}return B(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():typeof g.returnValue!="unknown"&&(g.returnValue=!1),this.isDefaultPrevented=Ii)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():typeof g.cancelBubble!="unknown"&&(g.cancelBubble=!0),this.isPropagationStopped=Ii)},persist:function(){},isPersistent:Ii}),c}var Pi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Rc=Ra(Pi),Ki=B({},Pi,{view:0,detail:0}),xo=Ra(Ki),qn,Ji,_n,cn=B({},Ki,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xl,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==_n&&(_n&&i.type==="mousemove"?(qn=i.screenX-_n.screenX,Ji=i.screenY-_n.screenY):Ji=qn=0,_n=i),qn)},movementY:function(i){return"movementY"in i?i.movementY:Ji}}),ls=Ra(cn),Cn=B({},cn,{dataTransfer:0}),Cl=Ra(Cn),Ti=B({},Ki,{relatedTarget:0}),Jo=Ra(Ti),cs=B({},Pi,{animationName:0,elapsedTime:0,pseudoElement:0}),Ic=Ra(cs),Ls=B({},Pi,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),du=Ra(Ls),Qo=B({},Pi,{data:0}),$l=Ra(Qo),ti={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},zs={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ya={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Fi(i){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(i):(i=ya[i])?!!c[i]:!1}function Xl(){return Fi}var Yl=B({},Ki,{key:function(i){if(i.key){var c=ti[i.key]||i.key;if(c!=="Unidentified")return c}return i.type==="keypress"?(i=Ea(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?zs[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xl,charCode:function(i){return i.type==="keypress"?Ea(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Ea(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),ua=Ra(Yl),If=B({},cn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Pc=Ra(If),Hh=B({},Ki,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xl}),na=Ra(Hh),el=B({},Pi,{propertyName:0,elapsedTime:0,pseudoElement:0}),Zn=Ra(el),yo=B({},cn,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Kl=Ra(yo),Jl=B({},Pi,{newState:0,oldState:0}),Js=Ra(Jl),Ml=[9,13,27,32],wa=Da&&"CompositionEvent"in window,Ql=null;Da&&"documentMode"in document&&(Ql=document.documentMode);var ec=Da&&"TextEvent"in window&&!Ql,vo=Da&&(!wa||Ql&&8<Ql&&11>=Ql),tl=" ",Fc=!1;function rl(i,c){switch(i){case"keyup":return Ml.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ah(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var us=!1;function pu(i,c){switch(i){case"compositionend":return ah(c);case"keypress":return c.which!==32?null:(Fc=!0,tl);case"textInput":return i=c.data,i===tl&&Fc?null:i;default:return null}}function qh(i,c){if(us)return i==="compositionend"||!wa&&rl(i,c)?(i=kl(),kn=mi=ei=null,us=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return vo&&c.locale!=="ko"?null:c.data;default:return null}}var Zh={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ia(i){var c=i&&i.nodeName&&i.nodeName.toLowerCase();return c==="input"?!!Zh[i.type]:c==="textarea"}function Qs(i,c,g,T){Ma?qa?qa.push(T):qa=[T]:Ma=T,c=Kd(c,"onChange"),0<c.length&&(g=new Rc("onChange","change",null,g,T),i.push({event:g,listeners:c}))}var ha=null,Qi=null;function tc(i){C_(i,0)}function rc(i){var c=fr(i);if(cu(c))return i}function Os(i,c){if(i==="change")return c}var ws=!1;if(Da){var Lc;if(Da){var Ts="oninput"in document;if(!Ts){var mu=document.createElement("div");mu.setAttribute("oninput","return;"),Ts=typeof mu.oninput=="function"}Lc=Ts}else Lc=!1;ws=Lc&&(!document.documentMode||9<document.documentMode)}function zc(){ha&&(ha.detachEvent("onpropertychange",bo),Qi=ha=null)}function bo(i){if(i.propertyName==="value"&&rc(Qi)){var c=[];Qs(c,Qi,i,Dc(i)),Jn(tc,c)}}function Pf(i,c,g){i==="focusin"?(zc(),ha=c,Qi=g,ha.attachEvent("onpropertychange",bo)):i==="focusout"&&zc()}function Oc(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return rc(Qi)}function Bs(i,c){if(i==="click")return rc(c)}function ih(i,c){if(i==="input"||i==="change")return rc(c)}function wo(i,c){return i===c&&(i!==0||1/i===1/c)||i!==i&&c!==c}var Pa=typeof Object.is=="function"?Object.is:wo;function eo(i,c){if(Pa(i,c))return!0;if(typeof i!="object"||i===null||typeof c!="object"||c===null)return!1;var g=Object.keys(i),T=Object.keys(c);if(g.length!==T.length)return!1;for(T=0;T<g.length;T++){var I=g[T];if(!pt.call(c,I)||!Pa(i[I],c[I]))return!1}return!0}function Ss(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function gu(i,c){var g=Ss(i);i=0;for(var T;g;){if(g.nodeType===3){if(T=i+g.textContent.length,i<=c&&T>=c)return{node:g,offset:c-i};i=T}e:{for(;g;){if(g.nextSibling){g=g.nextSibling;break e}g=g.parentNode}g=void 0}g=Ss(g)}}function sh(i,c){return i&&c?i===c?!0:i&&i.nodeType===3?!1:c&&c.nodeType===3?sh(i,c.parentNode):"contains"in i?i.contains(c):i.compareDocumentPosition?!!(i.compareDocumentPosition(c)&16):!1:!1}function oh(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var c=uu(i.document);c instanceof i.HTMLIFrameElement;){try{var g=typeof c.contentWindow.location.href=="string"}catch{g=!1}if(g)i=c.contentWindow;else break;c=uu(i.document)}return c}function _u(i){var c=i&&i.nodeName&&i.nodeName.toLowerCase();return c&&(c==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||c==="textarea"||i.contentEditable==="true")}var xu=Da&&"documentMode"in document&&11>=document.documentMode,es=null,nc=null,Bc=null,Nc=!1;function lh(i,c,g){var T=g.window===g?g.document:g.nodeType===9?g:g.ownerDocument;Nc||es==null||es!==uu(T)||(T=es,"selectionStart"in T&&_u(T)?T={start:T.selectionStart,end:T.selectionEnd}:(T=(T.ownerDocument&&T.ownerDocument.defaultView||window).getSelection(),T={anchorNode:T.anchorNode,anchorOffset:T.anchorOffset,focusNode:T.focusNode,focusOffset:T.focusOffset}),Bc&&eo(Bc,T)||(Bc=T,T=Kd(nc,"onSelect"),0<T.length&&(c=new Rc("onSelect","select",null,c,g),i.push({event:c,listeners:T}),c.target=es)))}function Dl(i,c){var g={};return g[i.toLowerCase()]=c.toLowerCase(),g["Webkit"+i]="webkit"+c,g["Moz"+i]="moz"+c,g}var To={animationend:Dl("Animation","AnimationEnd"),animationiteration:Dl("Animation","AnimationIteration"),animationstart:Dl("Animation","AnimationStart"),transitionrun:Dl("Transition","TransitionRun"),transitionstart:Dl("Transition","TransitionStart"),transitioncancel:Dl("Transition","TransitionCancel"),transitionend:Dl("Transition","TransitionEnd")},Wh={},Fn={};Da&&(Fn=document.createElement("div").style,"AnimationEvent"in window||(delete To.animationend.animation,delete To.animationiteration.animation,delete To.animationstart.animation),"TransitionEvent"in window||delete To.transitionend.transition);function Es(i){if(Wh[i])return Wh[i];if(!To[i])return i;var c=To[i],g;for(g in c)if(c.hasOwnProperty(g)&&g in Fn)return Wh[i]=c[g];return i}var nl=Es("animationend"),yu=Es("animationiteration"),ch=Es("animationstart"),ac=Es("transitionrun"),vu=Es("transitionstart"),jc=Es("transitioncancel"),gi=Es("transitionend"),uh=new Map,ic="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ic.push("scrollEnd");function hs(i,c){uh.set(i,c),Zr(c,[i])}var ts=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},Li=[],to=0,al=0;function il(){for(var i=to,c=al=to=0;c<i;){var g=Li[c];Li[c++]=null;var T=Li[c];Li[c++]=null;var I=Li[c];Li[c++]=null;var L=Li[c];if(Li[c++]=null,T!==null&&I!==null){var ae=T.pending;ae===null?I.next=I:(I.next=ae.next,ae.next=I),T.pending=I}L!==0&&Uc(g,I,L)}}function bu(i,c,g,T){Li[to++]=i,Li[to++]=c,Li[to++]=g,Li[to++]=T,al|=T,i.lanes|=T,i=i.alternate,i!==null&&(i.lanes|=T)}function Rl(i,c,g,T){return bu(i,c,g,T),Vc(i)}function Ns(i,c){return bu(i,null,null,c),Vc(i)}function Uc(i,c,g){i.lanes|=g;var T=i.alternate;T!==null&&(T.lanes|=g);for(var I=!1,L=i.return;L!==null;)L.childLanes|=g,T=L.alternate,T!==null&&(T.childLanes|=g),L.tag===22&&(i=L.stateNode,i===null||i._visibility&1||(I=!0)),i=L,L=L.return;return i.tag===3?(L=i.stateNode,I&&c!==null&&(I=31-zt(g),i=L.hiddenUpdates,T=i[I],T===null?i[I]=[c]:T.push(c),c.lane=g|536870912),L):null}function Vc(i){if(50<Zd)throw Zd=0,Tm=null,Error(f(185));for(var c=i.return;c!==null;)i=c,c=i.return;return i.tag===3?i.stateNode:null}var dn={};function hh(i,c,g,T){this.tag=i,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=T,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function As(i,c,g,T){return new hh(i,c,g,T)}function fh(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Q(i,c){var g=i.alternate;return g===null?(g=As(i.tag,c,i.key,i.mode),g.elementType=i.elementType,g.type=i.type,g.stateNode=i.stateNode,g.alternate=i,i.alternate=g):(g.pendingProps=c,g.type=i.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=i.flags&65011712,g.childLanes=i.childLanes,g.lanes=i.lanes,g.child=i.child,g.memoizedProps=i.memoizedProps,g.memoizedState=i.memoizedState,g.updateQueue=i.updateQueue,c=i.dependencies,g.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},g.sibling=i.sibling,g.index=i.index,g.ref=i.ref,g.refCleanup=i.refCleanup,g}function Qe(i,c){i.flags&=65011714;var g=i.alternate;return g===null?(i.childLanes=0,i.lanes=c,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=g.childLanes,i.lanes=g.lanes,i.child=g.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=g.memoizedProps,i.memoizedState=g.memoizedState,i.updateQueue=g.updateQueue,i.type=g.type,c=g.dependencies,i.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),i}function ft(i,c,g,T,I,L){var ae=0;if(T=i,typeof i=="function")fh(i)&&(ae=1);else if(typeof i=="string")ae=E0(i,g,Fe.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case xe:return i=As(31,g,c,I),i.elementType=xe,i.lanes=L,i;case O:return Ht(g.children,I,L,c);case N:ae=8,I|=24;break;case Z:return i=As(12,g,c,I|2),i.elementType=Z,i.lanes=L,i;case ge:return i=As(13,g,c,I),i.elementType=ge,i.lanes=L,i;case ve:return i=As(19,g,c,I),i.elementType=ve,i.lanes=L,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case X:ae=10;break e;case J:ae=9;break e;case pe:ae=11;break e;case re:ae=14;break e;case Ce:ae=16,T=null;break e}ae=29,g=Error(f(130,i===null?"null":typeof i,"")),T=null}return c=As(ae,g,c,I),c.elementType=i,c.type=T,c.lanes=L,c}function Ht(i,c,g,T){return i=As(7,i,T,c),i.lanes=g,i}function Nt(i,c,g){return i=As(6,i,null,c),i.lanes=g,i}function gr(i){var c=As(18,null,null,0);return c.stateNode=i,c}function Jr(i,c,g){return c=As(4,i.children!==null?i.children:[],i.key,c),c.lanes=g,c.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},c}var mn=new WeakMap;function Vr(i,c){if(typeof i=="object"&&i!==null){var g=mn.get(i);return g!==void 0?g:(c={value:i,source:c,stack:Ne(c)},mn.set(i,c),c)}return{value:i,source:c,stack:Ne(c)}}var Hr=[],Pr=0,Wr=null,dr=0,Tr=[],Dr=0,zr=null,Fr=1,sn="";function xr(i,c){Hr[Pr++]=dr,Hr[Pr++]=Wr,Wr=i,dr=c}function Sr(i,c,g){Tr[Dr++]=Fr,Tr[Dr++]=sn,Tr[Dr++]=zr,zr=i;var T=Fr;i=sn;var I=32-zt(T)-1;T&=~(1<<I),g+=1;var L=32-zt(c)+I;if(30<L){var ae=I-I%5;L=(T&(1<<ae)-1).toString(32),T>>=ae,I-=ae,Fr=1<<32-zt(c)+I|g<<I|T,sn=L+i}else Fr=1<<L|g<<I|T,sn=i}function nn(i){i.return!==null&&(xr(i,1),Sr(i,1,0))}function qr(i){for(;i===Wr;)Wr=Hr[--Pr],Hr[Pr]=null,dr=Hr[--Pr],Hr[Pr]=null;for(;i===zr;)zr=Tr[--Dr],Tr[Dr]=null,sn=Tr[--Dr],Tr[Dr]=null,Fr=Tr[--Dr],Tr[Dr]=null}function un(i,c){Tr[Dr++]=Fr,Tr[Dr++]=sn,Tr[Dr++]=zr,Fr=c.id,sn=c.overflow,zr=i}var Er=null,Br=null,Nr=!1,Wn=null,Gr=!1,gn=Error(f(519));function fa(i){var c=Error(f(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ro(Vr(c,i)),gn}function Za(i){var c=i.stateNode,g=i.type,T=i.memoizedProps;switch(c[Me]=i,c[Te]=T,g){case"dialog":Un("cancel",c),Un("close",c);break;case"iframe":case"object":case"embed":Un("load",c);break;case"video":case"audio":for(g=0;g<Ah.length;g++)Un(Ah[g],c);break;case"source":Un("error",c);break;case"img":case"image":case"link":Un("error",c),Un("load",c);break;case"details":Un("toggle",c);break;case"input":Un("invalid",c),Wl(c,T.value,T.defaultValue,T.checked,T.defaultChecked,T.type,T.name,!0);break;case"select":Un("invalid",c);break;case"textarea":Un("invalid",c),$o(c,T.value,T.defaultValue,T.children)}g=T.children,typeof g!="string"&&typeof g!="number"&&typeof g!="bigint"||c.textContent===""+g||T.suppressHydrationWarning===!0||Om(c.textContent,g)?(T.popover!=null&&(Un("beforetoggle",c),Un("toggle",c)),T.onScroll!=null&&Un("scroll",c),T.onScrollEnd!=null&&Un("scrollend",c),T.onClick!=null&&(c.onclick=_o),c=!0):c=!1,c||fa(i,!0)}function js(i){for(Er=i.return;Er;)switch(Er.tag){case 5:case 31:case 13:Gr=!1;return;case 27:case 3:Gr=!0;return;default:Er=Er.return}}function fs(i){if(i!==Er)return!1;if(!Nr)return js(i),Nr=!0,!1;var c=i.tag,g;if((g=c!==3&&c!==27)&&((g=c===5)&&(g=i.type,g=!(g!=="form"&&g!=="button")||x0(i.type,i.memoizedProps)),g=!g),g&&Br&&fa(i),js(i),c===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(f(317));Br=Zi(i)}else if(c===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(f(317));Br=Zi(i)}else c===27?(c=Br,Mh(i.type)?(i=co,co=null,Br=i):Br=c):Br=Er?_l(i.stateNode.nextSibling):null;return!0}function zi(){Br=Er=null,Nr=!1}function Oi(){var i=Wn;return i!==null&&(Fo===null?Fo=i:Fo.push.apply(Fo,i),Wn=null),i}function ro(i){Wn===null?Wn=[i]:Wn.push(i)}var no=me(null),ds=null,ri=null;function Bi(i,c,g){Ue(no,c._currentValue),c._currentValue=g}function Si(i){i._currentValue=no.current,ne(no)}function ks(i,c,g){for(;i!==null;){var T=i.alternate;if((i.childLanes&c)!==c?(i.childLanes|=c,T!==null&&(T.childLanes|=c)):T!==null&&(T.childLanes&c)!==c&&(T.childLanes|=c),i===g)break;i=i.return}}function Il(i,c,g,T){var I=i.child;for(I!==null&&(I.return=i);I!==null;){var L=I.dependencies;if(L!==null){var ae=I.child;L=L.firstContext;e:for(;L!==null;){var Ae=L;L=I;for(var ut=0;ut<c.length;ut++)if(Ae.context===c[ut]){L.lanes|=g,Ae=L.alternate,Ae!==null&&(Ae.lanes|=g),ks(L.return,g,i),T||(ae=null);break e}L=Ae.next}}else if(I.tag===18){if(ae=I.return,ae===null)throw Error(f(341));ae.lanes|=g,L=ae.alternate,L!==null&&(L.lanes|=g),ks(ae,g,i),ae=null}else ae=I.child;if(ae!==null)ae.return=I;else for(ae=I;ae!==null;){if(ae===i){ae=null;break}if(I=ae.sibling,I!==null){I.return=ae.return,ae=I;break}ae=ae.return}I=ae}}function Cs(i,c,g,T){i=null;for(var I=c,L=!1;I!==null;){if(!L){if((I.flags&524288)!==0)L=!0;else if((I.flags&262144)!==0)break}if(I.tag===10){var ae=I.alternate;if(ae===null)throw Error(f(387));if(ae=ae.memoizedProps,ae!==null){var Ae=I.type;Pa(I.pendingProps.value,ae.value)||(i!==null?i.push(Ae):i=[Ae])}}else if(I===Gt.current){if(ae=I.alternate,ae===null)throw Error(f(387));ae.memoizedState.memoizedState!==I.memoizedState.memoizedState&&(i!==null?i.push(cd):i=[cd])}I=I.return}i!==null&&Il(c,i,g,T),c.flags|=262144}function sc(i){for(i=i.firstContext;i!==null;){if(!Pa(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function So(i){ds=i,ri=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Wa(i){return dh(ds,i)}function wu(i,c){return ds===null&&So(i),dh(i,c)}function dh(i,c){var g=c._currentValue;if(c={context:c,memoizedValue:g,next:null},ri===null){if(i===null)throw Error(f(308));ri=c,i.dependencies={lanes:0,firstContext:c},i.flags|=524288}else ri=ri.next=c;return g}var $h=typeof AbortController<"u"?AbortController:function(){var i=[],c=this.signal={aborted:!1,addEventListener:function(g,T){i.push(T)}};this.abort=function(){c.aborted=!0,i.forEach(function(g){return g()})}},Tu=r.unstable_scheduleCallback,ph=r.unstable_NormalPriority,Ua={$$typeof:X,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Eo(){return{controller:new $h,data:new Map,refCount:0}}function Pl(i){i.refCount--,i.refCount===0&&Tu(ph,function(){i.controller.abort()})}var Ei=null,Ms=0,oc=0,Ai=null;function Ff(i,c){if(Ei===null){var g=Ei=[];Ms=0,oc=Im(),Ai={status:"pending",value:void 0,then:function(T){g.push(T)}}}return Ms++,c.then(lc,lc),c}function lc(){if(--Ms===0&&Ei!==null){Ai!==null&&(Ai.status="fulfilled");var i=Ei;Ei=null,oc=0,Ai=null;for(var c=0;c<i.length;c++)(0,i[c])()}}function Su(i,c){var g=[],T={status:"pending",value:null,reason:null,then:function(I){g.push(I)}};return i.then(function(){T.status="fulfilled",T.value=c;for(var I=0;I<g.length;I++)(0,g[I])(c)},function(I){for(T.status="rejected",T.reason=I,I=0;I<g.length;I++)(0,g[I])(void 0)}),T}var li=et.S;et.S=function(i,c){h_=pr(),typeof c=="object"&&c!==null&&typeof c.then=="function"&&Ff(i,c),li!==null&&li(i,c)};var sl=me(null);function Lf(){var i=sl.current;return i!==null?i:za.pooledCache}function zf(i,c){c===null?Ue(sl,sl.current):Ue(sl,c.pool)}function Fp(){var i=Lf();return i===null?null:{parent:Ua._currentValue,pool:i}}var ol=Error(f(460)),Gc=Error(f(474)),Us=Error(f(542)),Cr={then:function(){}};function Xh(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Of(i,c,g){switch(g=i[g],g===void 0?i.push(c):g!==c&&(c.then(_o,_o),c=g),c.status){case"fulfilled":return c.value;case"rejected":throw i=c.reason,Bf(i),i;default:if(typeof c.status=="string")c.then(_o,_o);else{if(i=za,i!==null&&100<i.shellSuspendCounter)throw Error(f(482));i=c,i.status="pending",i.then(function(T){if(c.status==="pending"){var I=c;I.status="fulfilled",I.value=T}},function(T){if(c.status==="pending"){var I=c;I.status="rejected",I.reason=T}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw i=c.reason,Bf(i),i}throw ll=c,ol}}function Ao(i){try{var c=i._init;return c(i._payload)}catch(g){throw g!==null&&typeof g=="object"&&typeof g.then=="function"?(ll=g,ol):g}}var ll=null;function mh(){if(ll===null)throw Error(f(459));var i=ll;return ll=null,i}function Bf(i){if(i===ol||i===Us)throw Error(f(483))}var Fl=null,Eu=0;function Yh(i){var c=Eu;return Eu+=1,Fl===null&&(Fl=[]),Of(Fl,i,c)}function Ll(i,c){c=c.props.ref,i.ref=c!==void 0?c:null}function Nf(i,c){throw c.$$typeof===U?Error(f(525)):(i=Object.prototype.toString.call(c),Error(f(31,i==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":i)))}function Kh(i){function c(wt,mt){if(i){var Pt=wt.deletions;Pt===null?(wt.deletions=[mt],wt.flags|=16):Pt.push(mt)}}function g(wt,mt){if(!i)return null;for(;mt!==null;)c(wt,mt),mt=mt.sibling;return null}function T(wt){for(var mt=new Map;wt!==null;)wt.key!==null?mt.set(wt.key,wt):mt.set(wt.index,wt),wt=wt.sibling;return mt}function I(wt,mt){return wt=Q(wt,mt),wt.index=0,wt.sibling=null,wt}function L(wt,mt,Pt){return wt.index=Pt,i?(Pt=wt.alternate,Pt!==null?(Pt=Pt.index,Pt<mt?(wt.flags|=67108866,mt):Pt):(wt.flags|=67108866,mt)):(wt.flags|=1048576,mt)}function ae(wt){return i&&wt.alternate===null&&(wt.flags|=67108866),wt}function Ae(wt,mt,Pt,nr){return mt===null||mt.tag!==6?(mt=Nt(Pt,wt.mode,nr),mt.return=wt,mt):(mt=I(mt,Pt),mt.return=wt,mt)}function ut(wt,mt,Pt,nr){var an=Pt.type;return an===O?er(wt,mt,Pt.props.children,nr,Pt.key):mt!==null&&(mt.elementType===an||typeof an=="object"&&an!==null&&an.$$typeof===Ce&&Ao(an)===mt.type)?(mt=I(mt,Pt.props),Ll(mt,Pt),mt.return=wt,mt):(mt=ft(Pt.type,Pt.key,Pt.props,null,wt.mode,nr),Ll(mt,Pt),mt.return=wt,mt)}function Lt(wt,mt,Pt,nr){return mt===null||mt.tag!==4||mt.stateNode.containerInfo!==Pt.containerInfo||mt.stateNode.implementation!==Pt.implementation?(mt=Jr(Pt,wt.mode,nr),mt.return=wt,mt):(mt=I(mt,Pt.children||[]),mt.return=wt,mt)}function er(wt,mt,Pt,nr,an){return mt===null||mt.tag!==7?(mt=Ht(Pt,wt.mode,nr,an),mt.return=wt,mt):(mt=I(mt,Pt),mt.return=wt,mt)}function sr(wt,mt,Pt){if(typeof mt=="string"&&mt!==""||typeof mt=="number"||typeof mt=="bigint")return mt=Nt(""+mt,wt.mode,Pt),mt.return=wt,mt;if(typeof mt=="object"&&mt!==null){switch(mt.$$typeof){case j:return Pt=ft(mt.type,mt.key,mt.props,null,wt.mode,Pt),Ll(Pt,mt),Pt.return=wt,Pt;case H:return mt=Jr(mt,wt.mode,Pt),mt.return=wt,mt;case Ce:return mt=Ao(mt),sr(wt,mt,Pt)}if(ct(mt)||de(mt))return mt=Ht(mt,wt.mode,Pt,null),mt.return=wt,mt;if(typeof mt.then=="function")return sr(wt,Yh(mt),Pt);if(mt.$$typeof===X)return sr(wt,wu(wt,mt),Pt);Nf(wt,mt)}return null}function Ot(wt,mt,Pt,nr){var an=mt!==null?mt.key:null;if(typeof Pt=="string"&&Pt!==""||typeof Pt=="number"||typeof Pt=="bigint")return an!==null?null:Ae(wt,mt,""+Pt,nr);if(typeof Pt=="object"&&Pt!==null){switch(Pt.$$typeof){case j:return Pt.key===an?ut(wt,mt,Pt,nr):null;case H:return Pt.key===an?Lt(wt,mt,Pt,nr):null;case Ce:return Pt=Ao(Pt),Ot(wt,mt,Pt,nr)}if(ct(Pt)||de(Pt))return an!==null?null:er(wt,mt,Pt,nr,null);if(typeof Pt.then=="function")return Ot(wt,mt,Yh(Pt),nr);if(Pt.$$typeof===X)return Ot(wt,mt,wu(wt,Pt),nr);Nf(wt,Pt)}return null}function qt(wt,mt,Pt,nr,an){if(typeof nr=="string"&&nr!==""||typeof nr=="number"||typeof nr=="bigint")return wt=wt.get(Pt)||null,Ae(mt,wt,""+nr,an);if(typeof nr=="object"&&nr!==null){switch(nr.$$typeof){case j:return wt=wt.get(nr.key===null?Pt:nr.key)||null,ut(mt,wt,nr,an);case H:return wt=wt.get(nr.key===null?Pt:nr.key)||null,Lt(mt,wt,nr,an);case Ce:return nr=Ao(nr),qt(wt,mt,Pt,nr,an)}if(ct(nr)||de(nr))return wt=wt.get(Pt)||null,er(mt,wt,nr,an,null);if(typeof nr.then=="function")return qt(wt,mt,Pt,Yh(nr),an);if(nr.$$typeof===X)return qt(wt,mt,Pt,wu(mt,nr),an);Nf(mt,nr)}return null}function $r(wt,mt,Pt,nr){for(var an=null,sa=null,Xr=mt,rn=mt=0,On=null;Xr!==null&&rn<Pt.length;rn++){Xr.index>rn?(On=Xr,Xr=null):On=Xr.sibling;var ta=Ot(wt,Xr,Pt[rn],nr);if(ta===null){Xr===null&&(Xr=On);break}i&&Xr&&ta.alternate===null&&c(wt,Xr),mt=L(ta,mt,rn),sa===null?an=ta:sa.sibling=ta,sa=ta,Xr=On}if(rn===Pt.length)return g(wt,Xr),Nr&&xr(wt,rn),an;if(Xr===null){for(;rn<Pt.length;rn++)Xr=sr(wt,Pt[rn],nr),Xr!==null&&(mt=L(Xr,mt,rn),sa===null?an=Xr:sa.sibling=Xr,sa=Xr);return Nr&&xr(wt,rn),an}for(Xr=T(Xr);rn<Pt.length;rn++)On=qt(Xr,wt,rn,Pt[rn],nr),On!==null&&(i&&On.alternate!==null&&Xr.delete(On.key===null?rn:On.key),mt=L(On,mt,rn),sa===null?an=On:sa.sibling=On,sa=On);return i&&Xr.forEach(function(Zu){return c(wt,Zu)}),Nr&&xr(wt,rn),an}function on(wt,mt,Pt,nr){if(Pt==null)throw Error(f(151));for(var an=null,sa=null,Xr=mt,rn=mt=0,On=null,ta=Pt.next();Xr!==null&&!ta.done;rn++,ta=Pt.next()){Xr.index>rn?(On=Xr,Xr=null):On=Xr.sibling;var Zu=Ot(wt,Xr,ta.value,nr);if(Zu===null){Xr===null&&(Xr=On);break}i&&Xr&&Zu.alternate===null&&c(wt,Xr),mt=L(Zu,mt,rn),sa===null?an=Zu:sa.sibling=Zu,sa=Zu,Xr=On}if(ta.done)return g(wt,Xr),Nr&&xr(wt,rn),an;if(Xr===null){for(;!ta.done;rn++,ta=Pt.next())ta=sr(wt,ta.value,nr),ta!==null&&(mt=L(ta,mt,rn),sa===null?an=ta:sa.sibling=ta,sa=ta);return Nr&&xr(wt,rn),an}for(Xr=T(Xr);!ta.done;rn++,ta=Pt.next())ta=qt(Xr,wt,rn,ta.value,nr),ta!==null&&(i&&ta.alternate!==null&&Xr.delete(ta.key===null?rn:ta.key),mt=L(ta,mt,rn),sa===null?an=ta:sa.sibling=ta,sa=ta);return i&&Xr.forEach(function(ig){return c(wt,ig)}),Nr&&xr(wt,rn),an}function Sa(wt,mt,Pt,nr){if(typeof Pt=="object"&&Pt!==null&&Pt.type===O&&Pt.key===null&&(Pt=Pt.props.children),typeof Pt=="object"&&Pt!==null){switch(Pt.$$typeof){case j:e:{for(var an=Pt.key;mt!==null;){if(mt.key===an){if(an=Pt.type,an===O){if(mt.tag===7){g(wt,mt.sibling),nr=I(mt,Pt.props.children),nr.return=wt,wt=nr;break e}}else if(mt.elementType===an||typeof an=="object"&&an!==null&&an.$$typeof===Ce&&Ao(an)===mt.type){g(wt,mt.sibling),nr=I(mt,Pt.props),Ll(nr,Pt),nr.return=wt,wt=nr;break e}g(wt,mt);break}else c(wt,mt);mt=mt.sibling}Pt.type===O?(nr=Ht(Pt.props.children,wt.mode,nr,Pt.key),nr.return=wt,wt=nr):(nr=ft(Pt.type,Pt.key,Pt.props,null,wt.mode,nr),Ll(nr,Pt),nr.return=wt,wt=nr)}return ae(wt);case H:e:{for(an=Pt.key;mt!==null;){if(mt.key===an)if(mt.tag===4&&mt.stateNode.containerInfo===Pt.containerInfo&&mt.stateNode.implementation===Pt.implementation){g(wt,mt.sibling),nr=I(mt,Pt.children||[]),nr.return=wt,wt=nr;break e}else{g(wt,mt);break}else c(wt,mt);mt=mt.sibling}nr=Jr(Pt,wt.mode,nr),nr.return=wt,wt=nr}return ae(wt);case Ce:return Pt=Ao(Pt),Sa(wt,mt,Pt,nr)}if(ct(Pt))return $r(wt,mt,Pt,nr);if(de(Pt)){if(an=de(Pt),typeof an!="function")throw Error(f(150));return Pt=an.call(Pt),on(wt,mt,Pt,nr)}if(typeof Pt.then=="function")return Sa(wt,mt,Yh(Pt),nr);if(Pt.$$typeof===X)return Sa(wt,mt,wu(wt,Pt),nr);Nf(wt,Pt)}return typeof Pt=="string"&&Pt!==""||typeof Pt=="number"||typeof Pt=="bigint"?(Pt=""+Pt,mt!==null&&mt.tag===6?(g(wt,mt.sibling),nr=I(mt,Pt),nr.return=wt,wt=nr):(g(wt,mt),nr=Nt(Pt,wt.mode,nr),nr.return=wt,wt=nr),ae(wt)):g(wt,mt)}return function(wt,mt,Pt,nr){try{Eu=0;var an=Sa(wt,mt,Pt,nr);return Fl=null,an}catch(Xr){if(Xr===ol||Xr===Us)throw Xr;var sa=As(29,Xr,null,wt.mode);return sa.lanes=nr,sa.return=wt,sa}}}var zl=Kh(!0),Ad=Kh(!1),Ol=!1;function jf(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Jh(i,c){i=i.updateQueue,c.updateQueue===i&&(c.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Bl(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function cc(i,c,g){var T=i.updateQueue;if(T===null)return null;if(T=T.shared,(ma&2)!==0){var I=T.pending;return I===null?c.next=c:(c.next=I.next,I.next=c),T.pending=c,c=Vc(i),Uc(i,null,g),c}return bu(i,T,c,g),Vc(i)}function ko(i,c,g){if(c=c.updateQueue,c!==null&&(c=c.shared,(g&4194048)!==0)){var T=c.lanes;T&=i.pendingLanes,g|=T,c.lanes=g,ba(i,g)}}function Qn(i,c){var g=i.updateQueue,T=i.alternate;if(T!==null&&(T=T.updateQueue,g===T)){var I=null,L=null;if(g=g.firstBaseUpdate,g!==null){do{var ae={lane:g.lane,tag:g.tag,payload:g.payload,callback:null,next:null};L===null?I=L=ae:L=L.next=ae,g=g.next}while(g!==null);L===null?I=L=c:L=L.next=c}else I=L=c;g={baseState:T.baseState,firstBaseUpdate:I,lastBaseUpdate:L,shared:T.shared,callbacks:T.callbacks},i.updateQueue=g;return}i=g.lastBaseUpdate,i===null?g.firstBaseUpdate=c:i.next=c,g.lastBaseUpdate=c}var kd=!1;function uc(){if(kd){var i=Ai;if(i!==null)throw i}}function Hc(i,c,g,T){kd=!1;var I=i.updateQueue;Ol=!1;var L=I.firstBaseUpdate,ae=I.lastBaseUpdate,Ae=I.shared.pending;if(Ae!==null){I.shared.pending=null;var ut=Ae,Lt=ut.next;ut.next=null,ae===null?L=Lt:ae.next=Lt,ae=ut;var er=i.alternate;er!==null&&(er=er.updateQueue,Ae=er.lastBaseUpdate,Ae!==ae&&(Ae===null?er.firstBaseUpdate=Lt:Ae.next=Lt,er.lastBaseUpdate=ut))}if(L!==null){var sr=I.baseState;ae=0,er=Lt=ut=null,Ae=L;do{var Ot=Ae.lane&-536870913,qt=Ot!==Ae.lane;if(qt?(jn&Ot)===Ot:(T&Ot)===Ot){Ot!==0&&Ot===oc&&(kd=!0),er!==null&&(er=er.next={lane:0,tag:Ae.tag,payload:Ae.payload,callback:null,next:null});e:{var $r=i,on=Ae;Ot=c;var Sa=g;switch(on.tag){case 1:if($r=on.payload,typeof $r=="function"){sr=$r.call(Sa,sr,Ot);break e}sr=$r;break e;case 3:$r.flags=$r.flags&-65537|128;case 0:if($r=on.payload,Ot=typeof $r=="function"?$r.call(Sa,sr,Ot):$r,Ot==null)break e;sr=B({},sr,Ot);break e;case 2:Ol=!0}}Ot=Ae.callback,Ot!==null&&(i.flags|=64,qt&&(i.flags|=8192),qt=I.callbacks,qt===null?I.callbacks=[Ot]:qt.push(Ot))}else qt={lane:Ot,tag:Ae.tag,payload:Ae.payload,callback:Ae.callback,next:null},er===null?(Lt=er=qt,ut=sr):er=er.next=qt,ae|=Ot;if(Ae=Ae.next,Ae===null){if(Ae=I.shared.pending,Ae===null)break;qt=Ae,Ae=qt.next,qt.next=null,I.lastBaseUpdate=qt,I.shared.pending=null}}while(!0);er===null&&(ut=sr),I.baseState=ut,I.firstBaseUpdate=Lt,I.lastBaseUpdate=er,L===null&&(I.shared.lanes=0),Nu|=ae,i.lanes=ae,i.memoizedState=sr}}function Qh(i,c){if(typeof i!="function")throw Error(f(191,i));i.call(c)}function Uf(i,c){var g=i.callbacks;if(g!==null)for(i.callbacks=null,i=0;i<g.length;i++)Qh(g[i],c)}var Au=me(null),ef=me(0);function Cd(i,c){i=Bu,Ue(ef,i),Ue(Au,c),Bu=i|c.baseLanes}function ao(){Ue(ef,Bu),Ue(Au,Au.current)}function ku(){Bu=ef.current,ne(Au),ne(ef)}var Rr=me(null),jr=null;function Co(i){var c=i.alternate;Ue($a,$a.current&1),Ue(Rr,i),jr===null&&(c===null||Au.current!==null||c.memoizedState!==null)&&(jr=i)}function gh(i){Ue($a,$a.current),Ue(Rr,i),jr===null&&(jr=i)}function tf(i){i.tag===22?(Ue($a,$a.current),Ue(Rr,i),jr===null&&(jr=i)):ni()}function ni(){Ue($a,$a.current),Ue(Rr,Rr.current)}function Va(i){ne(Rr),jr===i&&(jr=null),ne($a)}var $a=me(0);function rf(i){for(var c=i;c!==null;){if(c.tag===13){var g=c.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||qs(g)||xi(g)))return c}else if(c.tag===19&&(c.memoizedProps.revealOrder==="forwards"||c.memoizedProps.revealOrder==="backwards"||c.memoizedProps.revealOrder==="unstable_legacy-backwards"||c.memoizedProps.revealOrder==="together")){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var hc=0,Sn=null,Xn=null,wn=null,Fa=!1,Mo=!1,cl=!1,Cu=0,Mu=0,fc=null,Md=0;function Aa(){throw Error(f(321))}function ul(i,c){if(c===null)return!1;for(var g=0;g<c.length&&g<i.length;g++)if(!Pa(i[g],c[g]))return!1;return!0}function _h(i,c,g,T,I,L){return hc=L,Sn=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,et.H=i===null||i.memoizedState===null?pa:ci,cl=!1,L=g(T,I),cl=!1,Mo&&(L=nf(c,g,T,I)),xh(i),L}function xh(i){et.H=ea;var c=Xn!==null&&Xn.next!==null;if(hc=0,wn=Xn=Sn=null,Fa=!1,Mu=0,fc=null,c)throw Error(f(300));i===null||Ui||(i=i.dependencies,i!==null&&sc(i)&&(Ui=!0))}function nf(i,c,g,T){Sn=i;var I=0;do{if(Mo&&(fc=null),Mu=0,Mo=!1,25<=I)throw Error(f(301));if(I+=1,wn=Xn=null,i.updateQueue!=null){var L=i.updateQueue;L.lastEffect=null,L.events=null,L.stores=null,L.memoCache!=null&&(L.memoCache.index=0)}et.H=_i,L=c(g,T)}while(Mo);return L}function af(){var i=et.H,c=i.useState()[0];return c=typeof c.then=="function"?Du(c):c,i=i.useState()[0],(Xn!==null?Xn.memoizedState:null)!==i&&(Sn.flags|=1024),c}function sf(){var i=Cu!==0;return Cu=0,i}function qc(i,c,g){c.updateQueue=i.updateQueue,c.flags&=-2053,i.lanes&=~g}function dc(i){if(Fa){for(i=i.memoizedState;i!==null;){var c=i.queue;c!==null&&(c.pending=null),i=i.next}Fa=!1}hc=0,wn=Xn=Sn=null,Mo=!1,Mu=Cu=0,fc=null}function rs(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wn===null?Sn.memoizedState=wn=i:wn=wn.next=i,wn}function La(){if(Xn===null){var i=Sn.alternate;i=i!==null?i.memoizedState:null}else i=Xn.next;var c=wn===null?Sn.memoizedState:wn.next;if(c!==null)wn=c,Xn=i;else{if(i===null)throw Sn.alternate===null?Error(f(467)):Error(f(310));Xn=i,i={memoizedState:Xn.memoizedState,baseState:Xn.baseState,baseQueue:Xn.baseQueue,queue:Xn.queue,next:null},wn===null?Sn.memoizedState=wn=i:wn=wn.next=i}return wn}function Nl(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Du(i){var c=Mu;return Mu+=1,fc===null&&(fc=[]),i=Of(fc,i,c),c=Sn,(wn===null?c.memoizedState:wn.next)===null&&(c=c.alternate,et.H=c===null||c.memoizedState===null?pa:ci),i}function Ru(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Du(i);if(i.$$typeof===X)return Wa(i)}throw Error(f(438,String(i)))}function yh(i){var c=null,g=Sn.updateQueue;if(g!==null&&(c=g.memoCache),c==null){var T=Sn.alternate;T!==null&&(T=T.updateQueue,T!==null&&(T=T.memoCache,T!=null&&(c={data:T.data.map(function(I){return I.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),g===null&&(g=Nl(),Sn.updateQueue=g),g.memoCache=c,g=c.data[c.index],g===void 0)for(g=c.data[c.index]=Array(i),T=0;T<i;T++)g[T]=Ge;return c.index++,g}function hl(i,c){return typeof c=="function"?c(i):c}function w(i){var c=La();return t(c,Xn,i)}function t(i,c,g){var T=i.queue;if(T===null)throw Error(f(311));T.lastRenderedReducer=g;var I=i.baseQueue,L=T.pending;if(L!==null){if(I!==null){var ae=I.next;I.next=L.next,L.next=ae}c.baseQueue=I=L,T.pending=null}if(L=i.baseState,I===null)i.memoizedState=L;else{c=I.next;var Ae=ae=null,ut=null,Lt=c,er=!1;do{var sr=Lt.lane&-536870913;if(sr!==Lt.lane?(jn&sr)===sr:(hc&sr)===sr){var Ot=Lt.revertLane;if(Ot===0)ut!==null&&(ut=ut.next={lane:0,revertLane:0,gesture:null,action:Lt.action,hasEagerState:Lt.hasEagerState,eagerState:Lt.eagerState,next:null}),sr===oc&&(er=!0);else if((hc&Ot)===Ot){Lt=Lt.next,Ot===oc&&(er=!0);continue}else sr={lane:0,revertLane:Lt.revertLane,gesture:null,action:Lt.action,hasEagerState:Lt.hasEagerState,eagerState:Lt.eagerState,next:null},ut===null?(Ae=ut=sr,ae=L):ut=ut.next=sr,Sn.lanes|=Ot,Nu|=Ot;sr=Lt.action,cl&&g(L,sr),L=Lt.hasEagerState?Lt.eagerState:g(L,sr)}else Ot={lane:sr,revertLane:Lt.revertLane,gesture:Lt.gesture,action:Lt.action,hasEagerState:Lt.hasEagerState,eagerState:Lt.eagerState,next:null},ut===null?(Ae=ut=Ot,ae=L):ut=ut.next=Ot,Sn.lanes|=sr,Nu|=sr;Lt=Lt.next}while(Lt!==null&&Lt!==c);if(ut===null?ae=L:ut.next=Ae,!Pa(L,i.memoizedState)&&(Ui=!0,er&&(g=Ai,g!==null)))throw g;i.memoizedState=L,i.baseState=ae,i.baseQueue=ut,T.lastRenderedState=L}return I===null&&(T.lanes=0),[i.memoizedState,T.dispatch]}function o(i){var c=La(),g=c.queue;if(g===null)throw Error(f(311));g.lastRenderedReducer=i;var T=g.dispatch,I=g.pending,L=c.memoizedState;if(I!==null){g.pending=null;var ae=I=I.next;do L=i(L,ae.action),ae=ae.next;while(ae!==I);Pa(L,c.memoizedState)||(Ui=!0),c.memoizedState=L,c.baseQueue===null&&(c.baseState=L),g.lastRenderedState=L}return[L,T]}function d(i,c,g){var T=Sn,I=La(),L=Nr;if(L){if(g===void 0)throw Error(f(407));g=g()}else g=c();var ae=!Pa((Xn||I).memoizedState,g);if(ae&&(I.memoizedState=g,Ui=!0),I=I.queue,Ct(A.bind(null,T,I,i),[i]),I.getSnapshot!==c||ae||wn!==null&&wn.memoizedState.tag&1){if(T.flags|=2048,Ke(9,{destroy:void 0},S.bind(null,T,I,g,c),null),za===null)throw Error(f(349));L||(hc&127)!==0||x(T,c,g)}return g}function x(i,c,g){i.flags|=16384,i={getSnapshot:c,value:g},c=Sn.updateQueue,c===null?(c=Nl(),Sn.updateQueue=c,c.stores=[i]):(g=c.stores,g===null?c.stores=[i]:g.push(i))}function S(i,c,g,T){c.value=g,c.getSnapshot=T,R(c)&&F(i)}function A(i,c,g){return g(function(){R(c)&&F(i)})}function R(i){var c=i.getSnapshot;i=i.value;try{var g=c();return!Pa(i,g)}catch{return!0}}function F(i){var c=Ns(i,2);c!==null&&zo(c,i,2)}function V(i){var c=rs();if(typeof i=="function"){var g=i;if(i=g(),cl){vt(!0);try{g()}finally{vt(!1)}}}return c.memoizedState=c.baseState=i,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hl,lastRenderedState:i},c}function q(i,c,g,T){return i.baseState=g,t(i,Xn,typeof T=="function"?T:hl)}function te(i,c,g,T,I){if(io(i))throw Error(f(485));if(i=c.action,i!==null){var L={payload:I,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(ae){L.listeners.push(ae)}};et.T!==null?g(!0):L.isTransition=!1,T(L),g=c.pending,g===null?(L.next=c.pending=L,ee(c,L)):(L.next=g.next,c.pending=g.next=L)}}function ee(i,c){var g=c.action,T=c.payload,I=i.state;if(c.isTransition){var L=et.T,ae={};et.T=ae;try{var Ae=g(I,T),ut=et.S;ut!==null&&ut(ae,Ae),ce(i,c,Ae)}catch(Lt){Ie(i,c,Lt)}finally{L!==null&&ae.types!==null&&(L.types=ae.types),et.T=L}}else try{L=g(I,T),ce(i,c,L)}catch(Lt){Ie(i,c,Lt)}}function ce(i,c,g){g!==null&&typeof g=="object"&&typeof g.then=="function"?g.then(function(T){_e(i,c,T)},function(T){return Ie(i,c,T)}):_e(i,c,g)}function _e(i,c,g){c.status="fulfilled",c.value=g,Be(c),i.state=g,c=i.pending,c!==null&&(g=c.next,g===c?i.pending=null:(g=g.next,c.next=g,ee(i,g)))}function Ie(i,c,g){var T=i.pending;if(i.pending=null,T!==null){T=T.next;do c.status="rejected",c.reason=g,Be(c),c=c.next;while(c!==T)}i.action=null}function Be(i){i=i.listeners;for(var c=0;c<i.length;c++)(0,i[c])()}function ze(i,c){return c}function Ze(i,c){if(Nr){var g=za.formState;if(g!==null){e:{var T=Sn;if(Nr){if(Br){t:{for(var I=Br,L=Gr;I.nodeType!==8;){if(!L){I=null;break t}if(I=_l(I.nextSibling),I===null){I=null;break t}}L=I.data,I=L==="F!"||L==="F"?I:null}if(I){Br=_l(I.nextSibling),T=I.data==="F!";break e}}fa(T)}T=!1}T&&(c=g[0])}}return g=rs(),g.memoizedState=g.baseState=c,T={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ze,lastRenderedState:c},g.queue=T,g=vh.bind(null,Sn,T),T.dispatch=g,T=V(!1),L=Gs.bind(null,Sn,!1,T.queue),T=rs(),I={state:c,dispatch:null,action:i,pending:null},T.queue=I,g=te.bind(null,Sn,I,L,g),I.dispatch=g,T.memoizedState=i,[c,g,!1]}function rt(i){var c=La();return qe(c,Xn,i)}function qe(i,c,g){if(c=t(i,c,ze)[0],i=w(hl)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var T=Du(c)}catch(ae){throw ae===ol?Us:ae}else T=c;c=La();var I=c.queue,L=I.dispatch;return g!==c.memoizedState&&(Sn.flags|=2048,Ke(9,{destroy:void 0},tt.bind(null,I,g),null)),[T,L,i]}function tt(i,c){i.action=c}function lt(i){var c=La(),g=Xn;if(g!==null)return qe(c,g,i);La(),c=c.memoizedState,g=La();var T=g.queue.dispatch;return g.memoizedState=i,[c,T,!1]}function Ke(i,c,g,T){return i={tag:i,create:g,deps:T,inst:c,next:null},c=Sn.updateQueue,c===null&&(c=Nl(),Sn.updateQueue=c),g=c.lastEffect,g===null?c.lastEffect=i.next=i:(T=g.next,g.next=i,i.next=T,c.lastEffect=i),i}function dt(){return La().memoizedState}function Rt(i,c,g,T){var I=rs();Sn.flags|=i,I.memoizedState=Ke(1|c,{destroy:void 0},g,T===void 0?null:T)}function Tt(i,c,g,T){var I=La();T=T===void 0?null:T;var L=I.memoizedState.inst;Xn!==null&&T!==null&&ul(T,Xn.memoizedState.deps)?I.memoizedState=Ke(c,L,g,T):(Sn.flags|=i,I.memoizedState=Ke(1|c,L,g,T))}function kt(i,c){Rt(8390656,8,i,c)}function Ct(i,c){Tt(2048,8,i,c)}function ur(i){Sn.flags|=4;var c=Sn.updateQueue;if(c===null)c=Nl(),Sn.updateQueue=c,c.events=[i];else{var g=c.events;g===null?c.events=[i]:g.push(i)}}function hr(i){var c=La().memoizedState;return ur({ref:c,nextImpl:i}),function(){if((ma&2)!==0)throw Error(f(440));return c.impl.apply(void 0,arguments)}}function tr(i,c){return Tt(4,2,i,c)}function br(i,c){return Tt(4,4,i,c)}function fn(i,c){if(typeof c=="function"){i=i();var g=c(i);return function(){typeof g=="function"?g():c(null)}}if(c!=null)return i=i(),c.current=i,function(){c.current=null}}function Yn(i,c,g){g=g!=null?g.concat([i]):null,Tt(4,4,fn.bind(null,c,i),g)}function va(){}function da(i,c){var g=La();c=c===void 0?null:c;var T=g.memoizedState;return c!==null&&ul(c,T[1])?T[0]:(g.memoizedState=[i,c],i)}function ka(i,c){var g=La();c=c===void 0?null:c;var T=g.memoizedState;if(c!==null&&ul(c,T[1]))return T[0];if(T=i(),cl){vt(!0);try{i()}finally{vt(!1)}}return g.memoizedState=[T,c],T}function aa(i,c,g){return g===void 0||(hc&1073741824)!==0&&(jn&261930)===0?i.memoizedState=c:(i.memoizedState=g,i=d_(),Sn.lanes|=i,Nu|=i,g)}function Ga(i,c,g,T){return Pa(g,c)?g:Au.current!==null?(i=aa(i,g,T),Pa(i,c)||(Ui=!0),i):(hc&42)===0||(hc&1073741824)!==0&&(jn&261930)===0?(Ui=!0,i.memoizedState=g):(i=d_(),Sn.lanes|=i,Nu|=i,c)}function Ca(i,c,g,T,I){var L=He.p;He.p=L!==0&&8>L?L:8;var ae=et.T,Ae={};et.T=Ae,Gs(i,!1,c,g);try{var ut=I(),Lt=et.S;if(Lt!==null&&Lt(Ae,ut),ut!==null&&typeof ut=="object"&&typeof ut.then=="function"){var er=Su(ut,T);dl(i,c,er,Lo(i))}else dl(i,c,T,Lo(i))}catch(sr){dl(i,c,{then:function(){},status:"rejected",reason:sr},Lo())}finally{He.p=L,ae!==null&&Ae.types!==null&&(ae.types=Ae.types),et.T=ae}}function Ni(){}function Xa(i,c,g,T){if(i.tag!==5)throw Error(f(476));var I=Ya(i).queue;Ca(i,I,c,$t,g===null?Ni:function(){return ji(i),g(T)})}function Ya(i){var c=i.memoizedState;if(c!==null)return c;c={memoizedState:$t,baseState:$t,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hl,lastRenderedState:$t},next:null};var g={};return c.next={memoizedState:g,baseState:g,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hl,lastRenderedState:g},next:null},i.memoizedState=c,i=i.alternate,i!==null&&(i.memoizedState=c),c}function ji(i){var c=Ya(i);c.next===null&&(c=i.alternate.memoizedState),dl(i,c.next.queue,{},Lo())}function jl(){return Wa(cd)}function Ul(){return La().memoizedState}function fl(){return La().memoizedState}function Vs(i){for(var c=i.return;c!==null;){switch(c.tag){case 24:case 3:var g=Lo();i=Bl(g);var T=cc(c,i,g);T!==null&&(zo(T,c,g),ko(T,c,g)),c={cache:Eo()},i.payload=c;return}c=c.return}}function Iu(i,c,g){var T=Lo();g={lane:T,revertLane:0,gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},io(i)?Do(c,g):(g=Rl(i,c,g,T),g!==null&&(zo(g,i,T),Ro(g,c,T)))}function vh(i,c,g){var T=Lo();dl(i,c,g,T)}function dl(i,c,g,T){var I={lane:T,revertLane:0,gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null};if(io(i))Do(c,I);else{var L=i.alternate;if(i.lanes===0&&(L===null||L.lanes===0)&&(L=c.lastRenderedReducer,L!==null))try{var ae=c.lastRenderedState,Ae=L(ae,g);if(I.hasEagerState=!0,I.eagerState=Ae,Pa(Ae,ae))return bu(i,c,I,0),za===null&&il(),!1}catch{}if(g=Rl(i,c,I,T),g!==null)return zo(g,i,T),Ro(g,c,T),!0}return!1}function Gs(i,c,g,T){if(T={lane:2,revertLane:Im(),gesture:null,action:T,hasEagerState:!1,eagerState:null,next:null},io(i)){if(c)throw Error(f(479))}else c=Rl(i,g,T,2),c!==null&&zo(c,i,2)}function io(i){var c=i.alternate;return i===Sn||c!==null&&c===Sn}function Do(i,c){Mo=Fa=!0;var g=i.pending;g===null?c.next=c:(c.next=g.next,g.next=c),i.pending=c}function Ro(i,c,g){if((g&4194048)!==0){var T=c.lanes;T&=i.pendingLanes,g|=T,c.lanes=g,ba(i,g)}}var ea={readContext:Wa,use:Ru,useCallback:Aa,useContext:Aa,useEffect:Aa,useImperativeHandle:Aa,useLayoutEffect:Aa,useInsertionEffect:Aa,useMemo:Aa,useReducer:Aa,useRef:Aa,useState:Aa,useDebugValue:Aa,useDeferredValue:Aa,useTransition:Aa,useSyncExternalStore:Aa,useId:Aa,useHostTransitionStatus:Aa,useFormState:Aa,useActionState:Aa,useOptimistic:Aa,useMemoCache:Aa,useCacheRefresh:Aa};ea.useEffectEvent=Aa;var pa={readContext:Wa,use:Ru,useCallback:function(i,c){return rs().memoizedState=[i,c===void 0?null:c],i},useContext:Wa,useEffect:kt,useImperativeHandle:function(i,c,g){g=g!=null?g.concat([i]):null,Rt(4194308,4,fn.bind(null,c,i),g)},useLayoutEffect:function(i,c){return Rt(4194308,4,i,c)},useInsertionEffect:function(i,c){Rt(4,2,i,c)},useMemo:function(i,c){var g=rs();c=c===void 0?null:c;var T=i();if(cl){vt(!0);try{i()}finally{vt(!1)}}return g.memoizedState=[T,c],T},useReducer:function(i,c,g){var T=rs();if(g!==void 0){var I=g(c);if(cl){vt(!0);try{g(c)}finally{vt(!1)}}}else I=c;return T.memoizedState=T.baseState=I,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:I},T.queue=i,i=i.dispatch=Iu.bind(null,Sn,i),[T.memoizedState,i]},useRef:function(i){var c=rs();return i={current:i},c.memoizedState=i},useState:function(i){i=V(i);var c=i.queue,g=vh.bind(null,Sn,c);return c.dispatch=g,[i.memoizedState,g]},useDebugValue:va,useDeferredValue:function(i,c){var g=rs();return aa(g,i,c)},useTransition:function(){var i=V(!1);return i=Ca.bind(null,Sn,i.queue,!0,!1),rs().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,c,g){var T=Sn,I=rs();if(Nr){if(g===void 0)throw Error(f(407));g=g()}else{if(g=c(),za===null)throw Error(f(349));(jn&127)!==0||x(T,c,g)}I.memoizedState=g;var L={value:g,getSnapshot:c};return I.queue=L,kt(A.bind(null,T,L,i),[i]),T.flags|=2048,Ke(9,{destroy:void 0},S.bind(null,T,L,g,c),null),g},useId:function(){var i=rs(),c=za.identifierPrefix;if(Nr){var g=sn,T=Fr;g=(T&~(1<<32-zt(T)-1)).toString(32)+g,c="_"+c+"R_"+g,g=Cu++,0<g&&(c+="H"+g.toString(32)),c+="_"}else g=Md++,c="_"+c+"r_"+g.toString(32)+"_";return i.memoizedState=c},useHostTransitionStatus:jl,useFormState:Ze,useActionState:Ze,useOptimistic:function(i){var c=rs();c.memoizedState=c.baseState=i;var g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=g,c=Gs.bind(null,Sn,!0,g),g.dispatch=c,[i,c]},useMemoCache:yh,useCacheRefresh:function(){return rs().memoizedState=Vs.bind(null,Sn)},useEffectEvent:function(i){var c=rs(),g={impl:i};return c.memoizedState=g,function(){if((ma&2)!==0)throw Error(f(440));return g.impl.apply(void 0,arguments)}}},ci={readContext:Wa,use:Ru,useCallback:da,useContext:Wa,useEffect:Ct,useImperativeHandle:Yn,useInsertionEffect:tr,useLayoutEffect:br,useMemo:ka,useReducer:w,useRef:dt,useState:function(){return w(hl)},useDebugValue:va,useDeferredValue:function(i,c){var g=La();return Ga(g,Xn.memoizedState,i,c)},useTransition:function(){var i=w(hl)[0],c=La().memoizedState;return[typeof i=="boolean"?i:Du(i),c]},useSyncExternalStore:d,useId:Ul,useHostTransitionStatus:jl,useFormState:rt,useActionState:rt,useOptimistic:function(i,c){var g=La();return q(g,Xn,i,c)},useMemoCache:yh,useCacheRefresh:fl};ci.useEffectEvent=hr;var _i={readContext:Wa,use:Ru,useCallback:da,useContext:Wa,useEffect:Ct,useImperativeHandle:Yn,useInsertionEffect:tr,useLayoutEffect:br,useMemo:ka,useReducer:o,useRef:dt,useState:function(){return o(hl)},useDebugValue:va,useDeferredValue:function(i,c){var g=La();return Xn===null?aa(g,i,c):Ga(g,Xn.memoizedState,i,c)},useTransition:function(){var i=o(hl)[0],c=La().memoizedState;return[typeof i=="boolean"?i:Du(i),c]},useSyncExternalStore:d,useId:Ul,useHostTransitionStatus:jl,useFormState:lt,useActionState:lt,useOptimistic:function(i,c){var g=La();return Xn!==null?q(g,Xn,i,c):(g.baseState=i,[i,g.queue.dispatch])},useMemoCache:yh,useCacheRefresh:fl};_i.useEffectEvent=hr;function Vf(i,c,g,T){c=i.memoizedState,g=g(T,c),g=g==null?c:B({},c,g),i.memoizedState=g,i.lanes===0&&(i.updateQueue.baseState=g)}var Gf={enqueueSetState:function(i,c,g){i=i._reactInternals;var T=Lo(),I=Bl(T);I.payload=c,g!=null&&(I.callback=g),c=cc(i,I,T),c!==null&&(zo(c,i,T),ko(c,i,T))},enqueueReplaceState:function(i,c,g){i=i._reactInternals;var T=Lo(),I=Bl(T);I.tag=1,I.payload=c,g!=null&&(I.callback=g),c=cc(i,I,T),c!==null&&(zo(c,i,T),ko(c,i,T))},enqueueForceUpdate:function(i,c){i=i._reactInternals;var g=Lo(),T=Bl(g);T.tag=2,c!=null&&(T.callback=c),c=cc(i,T,g),c!==null&&(zo(c,i,g),ko(c,i,g))}};function Zc(i,c,g,T,I,L,ae){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(T,L,ae):c.prototype&&c.prototype.isPureReactComponent?!eo(g,T)||!eo(I,L):!0}function Lp(i,c,g,T){i=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(g,T),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(g,T),c.state!==i&&Gf.enqueueReplaceState(c,c.state,null)}function Wc(i,c){var g=c;if("ref"in c){g={};for(var T in c)T!=="ref"&&(g[T]=c[T])}if(i=i.defaultProps){g===c&&(g=B({},g));for(var I in i)g[I]===void 0&&(g[I]=i[I])}return g}function Hf(i){ts(i)}function pc(i){console.error(i)}function mc(i){ts(i)}function pl(i,c){try{var g=i.onUncaughtError;g(c.value,{componentStack:c.stack})}catch(T){setTimeout(function(){throw T})}}function qf(i,c,g){try{var T=i.onCaughtError;T(g.value,{componentStack:g.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(I){setTimeout(function(){throw I})}}function of(i,c,g){return g=Bl(g),g.tag=3,g.payload={element:null},g.callback=function(){pl(i,c)},g}function lf(i){return i=Bl(i),i.tag=3,i}function cf(i,c,g,T){var I=g.type.getDerivedStateFromError;if(typeof I=="function"){var L=T.value;i.payload=function(){return I(L)},i.callback=function(){qf(c,g,T)}}var ae=g.stateNode;ae!==null&&typeof ae.componentDidCatch=="function"&&(i.callback=function(){qf(c,g,T),typeof I!="function"&&(ju===null?ju=new Set([this]):ju.add(this));var Ae=T.stack;this.componentDidCatch(T.value,{componentStack:Ae!==null?Ae:""})})}function zp(i,c,g,T,I){if(g.flags|=32768,T!==null&&typeof T=="object"&&typeof T.then=="function"){if(c=g.alternate,c!==null&&Cs(c,g,I,!0),g=Rr.current,g!==null){switch(g.tag){case 31:case 13:return jr===null?$d():g.alternate===null&&ui===0&&(ui=3),g.flags&=-257,g.flags|=65536,g.lanes=I,T===Cr?g.flags|=16384:(c=g.updateQueue,c===null?g.updateQueue=new Set([T]):c.add(T),o0(i,T,I)),!1;case 22:return g.flags|=65536,T===Cr?g.flags|=16384:(c=g.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([T])},g.updateQueue=c):(g=c.retryQueue,g===null?c.retryQueue=new Set([T]):g.add(T)),o0(i,T,I)),!1}throw Error(f(435,g.tag))}return o0(i,T,I),$d(),!1}if(Nr)return c=Rr.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=I,T!==gn&&(i=Error(f(422),{cause:T}),ro(Vr(i,g)))):(T!==gn&&(c=Error(f(423),{cause:T}),ro(Vr(c,g))),i=i.current.alternate,i.flags|=65536,I&=-I,i.lanes|=I,T=Vr(T,g),I=of(i.stateNode,T,I),Qn(i,I),ui!==4&&(ui=2)),!1;var L=Error(f(520),{cause:T});if(L=Vr(L,g),Hd===null?Hd=[L]:Hd.push(L),ui!==4&&(ui=2),c===null)return!0;T=Vr(T,g),g=c;do{switch(g.tag){case 3:return g.flags|=65536,i=I&-I,g.lanes|=i,i=of(g.stateNode,T,i),Qn(g,i),!1;case 1:if(c=g.type,L=g.stateNode,(g.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||L!==null&&typeof L.componentDidCatch=="function"&&(ju===null||!ju.has(L))))return g.flags|=65536,I&=-I,g.lanes|=I,I=lf(I),cf(I,i,g,T),Qn(g,I),!1}g=g.return}while(g!==null);return!1}var Op=Error(f(461)),Ui=!1;function ns(i,c,g,T){c.child=i===null?Ad(c,null,g,T):zl(c,i.child,g,T)}function Yg(i,c,g,T,I){g=g.render;var L=c.ref;if("ref"in T){var ae={};for(var Ae in T)Ae!=="ref"&&(ae[Ae]=T[Ae])}else ae=T;return So(c),T=_h(i,c,g,ae,L,I),Ae=sf(),i!==null&&!Ui?(qc(i,c,I),Xc(i,c,I)):(Nr&&Ae&&nn(c),c.flags|=1,ns(i,c,T,I),c.child)}function Bp(i,c,g,T,I){if(i===null){var L=g.type;return typeof L=="function"&&!fh(L)&&L.defaultProps===void 0&&g.compare===null?(c.tag=15,c.type=L,om(i,c,L,T,I)):(i=ft(g.type,null,T,c,c.mode,I),i.ref=c.ref,i.return=c,c.child=i)}if(L=i.child,!Id(i,I)){var ae=L.memoizedProps;if(g=g.compare,g=g!==null?g:eo,g(ae,T)&&i.ref===c.ref)return Xc(i,c,I)}return c.flags|=1,i=Q(L,T),i.ref=c.ref,i.return=c,c.child=i}function om(i,c,g,T,I){if(i!==null){var L=i.memoizedProps;if(eo(L,T)&&i.ref===c.ref)if(Ui=!1,c.pendingProps=T=L,Id(i,I))(i.flags&131072)!==0&&(Ui=!0);else return c.lanes=i.lanes,Xc(i,c,I)}return cm(i,c,g,T,I)}function lm(i,c,g,T){var I=T.children,L=i!==null?i.memoizedState:null;if(i===null&&c.stateNode===null&&(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),T.mode==="hidden"){if((c.flags&128)!==0){if(L=L!==null?L.baseLanes|g:g,i!==null){for(T=c.child=i.child,I=0;T!==null;)I=I|T.lanes|T.childLanes,T=T.sibling;T=I&~L}else T=0,c.child=null;return Kg(i,c,L,g,T)}if((g&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},i!==null&&zf(c,L!==null?L.cachePool:null),L!==null?Cd(c,L):ao(),tf(c);else return T=c.lanes=536870912,Kg(i,c,L!==null?L.baseLanes|g:g,g,T)}else L!==null?(zf(c,L.cachePool),Cd(c,L),ni(),c.memoizedState=null):(i!==null&&zf(c,null),ao(),ni());return ns(i,c,I,g),c.child}function $c(i,c){return i!==null&&i.tag===22||c.stateNode!==null||(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.sibling}function Kg(i,c,g,T,I){var L=Lf();return L=L===null?null:{parent:Ua._currentValue,pool:L},c.memoizedState={baseLanes:g,cachePool:L},i!==null&&zf(c,null),ao(),tf(c),i!==null&&Cs(i,c,T,!0),c.childLanes=I,null}function Pu(i,c){return c=Gp({mode:c.mode,children:c.children},i.mode),c.ref=i.ref,i.child=c,c.return=i,c}function Dd(i,c,g){return zl(c,i.child,null,g),i=Pu(c,c.pendingProps),i.flags|=2,Va(c),c.memoizedState=null,i}function Np(i,c,g){var T=c.pendingProps,I=(c.flags&128)!==0;if(c.flags&=-129,i===null){if(Nr){if(T.mode==="hidden")return i=Pu(c,T),c.lanes=536870912,$c(null,i);if(gh(c),(i=Br)?(i=Dh(i,Gr),i=i!==null&&i.data==="&"?i:null,i!==null&&(c.memoizedState={dehydrated:i,treeContext:zr!==null?{id:Fr,overflow:sn}:null,retryLane:536870912,hydrationErrors:null},g=gr(i),g.return=c,c.child=g,Er=c,Br=null)):i=null,i===null)throw fa(c);return c.lanes=536870912,null}return Pu(c,T)}var L=i.memoizedState;if(L!==null){var ae=L.dehydrated;if(gh(c),I)if(c.flags&256)c.flags&=-257,c=Dd(i,c,g);else if(c.memoizedState!==null)c.child=i.child,c.flags|=128,c=null;else throw Error(f(558));else if(Ui||Cs(i,c,g,!1),I=(g&i.childLanes)!==0,Ui||I){if(T=za,T!==null&&(ae=El(T,g),ae!==0&&ae!==L.retryLane))throw L.retryLane=ae,Ns(i,ae),zo(T,i,ae),Op;$d(),c=Dd(i,c,g)}else i=L.treeContext,Br=_l(ae.nextSibling),Er=c,Nr=!0,Wn=null,Gr=!1,i!==null&&un(c,i),c=Pu(c,T),c.flags|=4096;return c}return i=Q(i.child,{mode:T.mode,children:T.children}),i.ref=c.ref,c.child=i,i.return=c,i}function jp(i,c){var g=c.ref;if(g===null)i!==null&&i.ref!==null&&(c.flags|=4194816);else{if(typeof g!="function"&&typeof g!="object")throw Error(f(284));(i===null||i.ref!==g)&&(c.flags|=4194816)}}function cm(i,c,g,T,I){return So(c),g=_h(i,c,g,T,void 0,I),T=sf(),i!==null&&!Ui?(qc(i,c,I),Xc(i,c,I)):(Nr&&T&&nn(c),c.flags|=1,ns(i,c,g,I),c.child)}function Jg(i,c,g,T,I,L){return So(c),c.updateQueue=null,g=nf(c,T,g,I),xh(i),T=sf(),i!==null&&!Ui?(qc(i,c,L),Xc(i,c,L)):(Nr&&T&&nn(c),c.flags|=1,ns(i,c,g,L),c.child)}function Qg(i,c,g,T,I){if(So(c),c.stateNode===null){var L=dn,ae=g.contextType;typeof ae=="object"&&ae!==null&&(L=Wa(ae)),L=new g(T,L),c.memoizedState=L.state!==null&&L.state!==void 0?L.state:null,L.updater=Gf,c.stateNode=L,L._reactInternals=c,L=c.stateNode,L.props=T,L.state=c.memoizedState,L.refs={},jf(c),ae=g.contextType,L.context=typeof ae=="object"&&ae!==null?Wa(ae):dn,L.state=c.memoizedState,ae=g.getDerivedStateFromProps,typeof ae=="function"&&(Vf(c,g,ae,T),L.state=c.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof L.getSnapshotBeforeUpdate=="function"||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(ae=L.state,typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount(),ae!==L.state&&Gf.enqueueReplaceState(L,L.state,null),Hc(c,T,L,I),uc(),L.state=c.memoizedState),typeof L.componentDidMount=="function"&&(c.flags|=4194308),T=!0}else if(i===null){L=c.stateNode;var Ae=c.memoizedProps,ut=Wc(g,Ae);L.props=ut;var Lt=L.context,er=g.contextType;ae=dn,typeof er=="object"&&er!==null&&(ae=Wa(er));var sr=g.getDerivedStateFromProps;er=typeof sr=="function"||typeof L.getSnapshotBeforeUpdate=="function",Ae=c.pendingProps!==Ae,er||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(Ae||Lt!==ae)&&Lp(c,L,T,ae),Ol=!1;var Ot=c.memoizedState;L.state=Ot,Hc(c,T,L,I),uc(),Lt=c.memoizedState,Ae||Ot!==Lt||Ol?(typeof sr=="function"&&(Vf(c,g,sr,T),Lt=c.memoizedState),(ut=Ol||Zc(c,g,ut,T,Ot,Lt,ae))?(er||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount()),typeof L.componentDidMount=="function"&&(c.flags|=4194308)):(typeof L.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=T,c.memoizedState=Lt),L.props=T,L.state=Lt,L.context=ae,T=ut):(typeof L.componentDidMount=="function"&&(c.flags|=4194308),T=!1)}else{L=c.stateNode,Jh(i,c),ae=c.memoizedProps,er=Wc(g,ae),L.props=er,sr=c.pendingProps,Ot=L.context,Lt=g.contextType,ut=dn,typeof Lt=="object"&&Lt!==null&&(ut=Wa(Lt)),Ae=g.getDerivedStateFromProps,(Lt=typeof Ae=="function"||typeof L.getSnapshotBeforeUpdate=="function")||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(ae!==sr||Ot!==ut)&&Lp(c,L,T,ut),Ol=!1,Ot=c.memoizedState,L.state=Ot,Hc(c,T,L,I),uc();var qt=c.memoizedState;ae!==sr||Ot!==qt||Ol||i!==null&&i.dependencies!==null&&sc(i.dependencies)?(typeof Ae=="function"&&(Vf(c,g,Ae,T),qt=c.memoizedState),(er=Ol||Zc(c,g,er,T,Ot,qt,ut)||i!==null&&i.dependencies!==null&&sc(i.dependencies))?(Lt||typeof L.UNSAFE_componentWillUpdate!="function"&&typeof L.componentWillUpdate!="function"||(typeof L.componentWillUpdate=="function"&&L.componentWillUpdate(T,qt,ut),typeof L.UNSAFE_componentWillUpdate=="function"&&L.UNSAFE_componentWillUpdate(T,qt,ut)),typeof L.componentDidUpdate=="function"&&(c.flags|=4),typeof L.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof L.componentDidUpdate!="function"||ae===i.memoizedProps&&Ot===i.memoizedState||(c.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||ae===i.memoizedProps&&Ot===i.memoizedState||(c.flags|=1024),c.memoizedProps=T,c.memoizedState=qt),L.props=T,L.state=qt,L.context=ut,T=er):(typeof L.componentDidUpdate!="function"||ae===i.memoizedProps&&Ot===i.memoizedState||(c.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||ae===i.memoizedProps&&Ot===i.memoizedState||(c.flags|=1024),T=!1)}return L=T,jp(i,c),T=(c.flags&128)!==0,L||T?(L=c.stateNode,g=T&&typeof g.getDerivedStateFromError!="function"?null:L.render(),c.flags|=1,i!==null&&T?(c.child=zl(c,i.child,null,I),c.child=zl(c,null,g,I)):ns(i,c,g,I),c.memoizedState=L.state,i=c.child):i=Xc(i,c,I),i}function e_(i,c,g,T){return zi(),c.flags|=256,ns(i,c,g,T),c.child}var Up={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Rd(i){return{baseLanes:i,cachePool:Fp()}}function Vp(i,c,g){return i=i!==null?i.childLanes&~g:0,c&&(i|=Ds),i}function um(i,c,g){var T=c.pendingProps,I=!1,L=(c.flags&128)!==0,ae;if((ae=L)||(ae=i!==null&&i.memoizedState===null?!1:($a.current&2)!==0),ae&&(I=!0,c.flags&=-129),ae=(c.flags&32)!==0,c.flags&=-33,i===null){if(Nr){if(I?Co(c):ni(),(i=Br)?(i=Dh(i,Gr),i=i!==null&&i.data!=="&"?i:null,i!==null&&(c.memoizedState={dehydrated:i,treeContext:zr!==null?{id:Fr,overflow:sn}:null,retryLane:536870912,hydrationErrors:null},g=gr(i),g.return=c,c.child=g,Er=c,Br=null)):i=null,i===null)throw fa(c);return xi(i)?c.lanes=32:c.lanes=536870912,null}var Ae=T.children;return T=T.fallback,I?(ni(),I=c.mode,Ae=Gp({mode:"hidden",children:Ae},I),T=Ht(T,I,g,null),Ae.return=c,T.return=c,Ae.sibling=T,c.child=Ae,T=c.child,T.memoizedState=Rd(g),T.childLanes=Vp(i,ae,g),c.memoizedState=Up,$c(null,T)):(Co(c),hm(c,Ae))}var ut=i.memoizedState;if(ut!==null&&(Ae=ut.dehydrated,Ae!==null)){if(L)c.flags&256?(Co(c),c.flags&=-257,c=Hp(i,c,g)):c.memoizedState!==null?(ni(),c.child=i.child,c.flags|=128,c=null):(ni(),Ae=T.fallback,I=c.mode,T=Gp({mode:"visible",children:T.children},I),Ae=Ht(Ae,I,g,null),Ae.flags|=2,T.return=c,Ae.return=c,T.sibling=Ae,c.child=T,zl(c,i.child,null,g),T=c.child,T.memoizedState=Rd(g),T.childLanes=Vp(i,ae,g),c.memoizedState=Up,c=$c(null,T));else if(Co(c),xi(Ae)){if(ae=Ae.nextSibling&&Ae.nextSibling.dataset,ae)var Lt=ae.dgst;ae=Lt,T=Error(f(419)),T.stack="",T.digest=ae,ro({value:T,source:null,stack:null}),c=Hp(i,c,g)}else if(Ui||Cs(i,c,g,!1),ae=(g&i.childLanes)!==0,Ui||ae){if(ae=za,ae!==null&&(T=El(ae,g),T!==0&&T!==ut.retryLane))throw ut.retryLane=T,Ns(i,T),zo(ae,i,T),Op;qs(Ae)||$d(),c=Hp(i,c,g)}else qs(Ae)?(c.flags|=192,c.child=i.child,c=null):(i=ut.treeContext,Br=_l(Ae.nextSibling),Er=c,Nr=!0,Wn=null,Gr=!1,i!==null&&un(c,i),c=hm(c,T.children),c.flags|=4096);return c}return I?(ni(),Ae=T.fallback,I=c.mode,ut=i.child,Lt=ut.sibling,T=Q(ut,{mode:"hidden",children:T.children}),T.subtreeFlags=ut.subtreeFlags&65011712,Lt!==null?Ae=Q(Lt,Ae):(Ae=Ht(Ae,I,g,null),Ae.flags|=2),Ae.return=c,T.return=c,T.sibling=Ae,c.child=T,$c(null,T),T=c.child,Ae=i.child.memoizedState,Ae===null?Ae=Rd(g):(I=Ae.cachePool,I!==null?(ut=Ua._currentValue,I=I.parent!==ut?{parent:ut,pool:ut}:I):I=Fp(),Ae={baseLanes:Ae.baseLanes|g,cachePool:I}),T.memoizedState=Ae,T.childLanes=Vp(i,ae,g),c.memoizedState=Up,$c(i.child,T)):(Co(c),g=i.child,i=g.sibling,g=Q(g,{mode:"visible",children:T.children}),g.return=c,g.sibling=null,i!==null&&(ae=c.deletions,ae===null?(c.deletions=[i],c.flags|=16):ae.push(i)),c.child=g,c.memoizedState=null,g)}function hm(i,c){return c=Gp({mode:"visible",children:c},i.mode),c.return=i,i.child=c}function Gp(i,c){return i=As(22,i,null,c),i.lanes=0,i}function Hp(i,c,g){return zl(c,i.child,null,g),i=hm(c,c.pendingProps.children),i.flags|=2,c.memoizedState=null,i}function fm(i,c,g){i.lanes|=c;var T=i.alternate;T!==null&&(T.lanes|=c),ks(i.return,c,g)}function dm(i,c,g,T,I,L){var ae=i.memoizedState;ae===null?i.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:T,tail:g,tailMode:I,treeForkCount:L}:(ae.isBackwards=c,ae.rendering=null,ae.renderingStartTime=0,ae.last=T,ae.tail=g,ae.tailMode=I,ae.treeForkCount=L)}function qp(i,c,g){var T=c.pendingProps,I=T.revealOrder,L=T.tail;T=T.children;var ae=$a.current,Ae=(ae&2)!==0;if(Ae?(ae=ae&1|2,c.flags|=128):ae&=1,Ue($a,ae),ns(i,c,T,g),T=Nr?dr:0,!Ae&&i!==null&&(i.flags&128)!==0)e:for(i=c.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&fm(i,g,c);else if(i.tag===19)fm(i,g,c);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===c)break e;for(;i.sibling===null;){if(i.return===null||i.return===c)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(I){case"forwards":for(g=c.child,I=null;g!==null;)i=g.alternate,i!==null&&rf(i)===null&&(I=g),g=g.sibling;g=I,g===null?(I=c.child,c.child=null):(I=g.sibling,g.sibling=null),dm(c,!1,I,g,L,T);break;case"backwards":case"unstable_legacy-backwards":for(g=null,I=c.child,c.child=null;I!==null;){if(i=I.alternate,i!==null&&rf(i)===null){c.child=I;break}i=I.sibling,I.sibling=g,g=I,I=i}dm(c,!0,g,null,L,T);break;case"together":dm(c,!1,null,null,void 0,T);break;default:c.memoizedState=null}return c.child}function Xc(i,c,g){if(i!==null&&(c.dependencies=i.dependencies),Nu|=c.lanes,(g&c.childLanes)===0)if(i!==null){if(Cs(i,c,g,!1),(g&c.childLanes)===0)return null}else return null;if(i!==null&&c.child!==i.child)throw Error(f(153));if(c.child!==null){for(i=c.child,g=Q(i,i.pendingProps),c.child=g,g.return=c;i.sibling!==null;)i=i.sibling,g=g.sibling=Q(i,i.pendingProps),g.return=c;g.sibling=null}return c.child}function Id(i,c){return(i.lanes&c)!==0?!0:(i=i.dependencies,!!(i!==null&&sc(i)))}function Pd(i,c,g){switch(c.tag){case 3:Vt(c,c.stateNode.containerInfo),Bi(c,Ua,i.memoizedState.cache),zi();break;case 27:case 5:Yt(c);break;case 4:Vt(c,c.stateNode.containerInfo);break;case 10:Bi(c,c.type,c.memoizedProps.value);break;case 31:if(c.memoizedState!==null)return c.flags|=128,gh(c),null;break;case 13:var T=c.memoizedState;if(T!==null)return T.dehydrated!==null?(Co(c),c.flags|=128,null):(g&c.child.childLanes)!==0?um(i,c,g):(Co(c),i=Xc(i,c,g),i!==null?i.sibling:null);Co(c);break;case 19:var I=(i.flags&128)!==0;if(T=(g&c.childLanes)!==0,T||(Cs(i,c,g,!1),T=(g&c.childLanes)!==0),I){if(T)return qp(i,c,g);c.flags|=128}if(I=c.memoizedState,I!==null&&(I.rendering=null,I.tail=null,I.lastEffect=null),Ue($a,$a.current),T)break;return null;case 22:return c.lanes=0,lm(i,c,g,c.pendingProps);case 24:Bi(c,Ua,i.memoizedState.cache)}return Xc(i,c,g)}function Hs(i,c,g){if(i!==null)if(i.memoizedProps!==c.pendingProps)Ui=!0;else{if(!Id(i,g)&&(c.flags&128)===0)return Ui=!1,Pd(i,c,g);Ui=(i.flags&131072)!==0}else Ui=!1,Nr&&(c.flags&1048576)!==0&&Sr(c,dr,c.index);switch(c.lanes=0,c.tag){case 16:e:{var T=c.pendingProps;if(i=Ao(c.elementType),c.type=i,typeof i=="function")fh(i)?(T=Wc(i,T),c.tag=1,c=Qg(null,c,i,T,g)):(c.tag=0,c=cm(null,c,i,T,g));else{if(i!=null){var I=i.$$typeof;if(I===pe){c.tag=11,c=Yg(null,c,i,T,g);break e}else if(I===re){c.tag=14,c=Bp(null,c,i,T,g);break e}}throw c=le(i)||i,Error(f(306,c,""))}}return c;case 0:return cm(i,c,c.type,c.pendingProps,g);case 1:return T=c.type,I=Wc(T,c.pendingProps),Qg(i,c,T,I,g);case 3:e:{if(Vt(c,c.stateNode.containerInfo),i===null)throw Error(f(387));T=c.pendingProps;var L=c.memoizedState;I=L.element,Jh(i,c),Hc(c,T,null,g);var ae=c.memoizedState;if(T=ae.cache,Bi(c,Ua,T),T!==L.cache&&Il(c,[Ua],g,!0),uc(),T=ae.element,L.isDehydrated)if(L={element:T,isDehydrated:!1,cache:ae.cache},c.updateQueue.baseState=L,c.memoizedState=L,c.flags&256){c=e_(i,c,T,g);break e}else if(T!==I){I=Vr(Error(f(424)),c),ro(I),c=e_(i,c,T,g);break e}else for(i=c.stateNode.containerInfo,i.nodeType===9?i=i.body:i=i.nodeName==="HTML"?i.ownerDocument.body:i,Br=_l(i.firstChild),Er=c,Nr=!0,Wn=null,Gr=!0,g=Ad(c,null,T,g),c.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling;else{if(zi(),T===I){c=Xc(i,c,g);break e}ns(i,c,T,g)}c=c.child}return c;case 26:return jp(i,c),i===null?(g=Wm(c.type,null,c.pendingProps,null))?c.memoizedState=g:Nr||(g=c.type,i=c.pendingProps,T=ep(bt.current).createElement(g),T[Me]=c,T[Te]=i,is(T,g,i),Ur(T),c.stateNode=T):c.memoizedState=Wm(c.type,i.memoizedProps,c.pendingProps,i.memoizedState),null;case 27:return Yt(c),i===null&&Nr&&(T=c.stateNode=F_(c.type,c.pendingProps,bt.current),Er=c,Gr=!0,I=Br,Mh(c.type)?(co=I,Br=_l(T.firstChild)):Br=I),ns(i,c,c.pendingProps.children,g),jp(i,c),i===null&&(c.flags|=4194304),c.child;case 5:return i===null&&Nr&&((I=T=Br)&&(T=ps(T,c.type,c.pendingProps,Gr),T!==null?(c.stateNode=T,Er=c,Br=_l(T.firstChild),Gr=!1,I=!0):I=!1),I||fa(c)),Yt(c),I=c.type,L=c.pendingProps,ae=i!==null?i.memoizedProps:null,T=L.children,x0(I,L)?T=null:ae!==null&&x0(I,ae)&&(c.flags|=32),c.memoizedState!==null&&(I=_h(i,c,af,null,null,g),cd._currentValue=I),jp(i,c),ns(i,c,T,g),c.child;case 6:return i===null&&Nr&&((i=g=Br)&&(g=vc(g,c.pendingProps,Gr),g!==null?(c.stateNode=g,Er=c,Br=null,i=!0):i=!1),i||fa(c)),null;case 13:return um(i,c,g);case 4:return Vt(c,c.stateNode.containerInfo),T=c.pendingProps,i===null?c.child=zl(c,null,T,g):ns(i,c,T,g),c.child;case 11:return Yg(i,c,c.type,c.pendingProps,g);case 7:return ns(i,c,c.pendingProps,g),c.child;case 8:return ns(i,c,c.pendingProps.children,g),c.child;case 12:return ns(i,c,c.pendingProps.children,g),c.child;case 10:return T=c.pendingProps,Bi(c,c.type,T.value),ns(i,c,T.children,g),c.child;case 9:return I=c.type._context,T=c.pendingProps.children,So(c),I=Wa(I),T=T(I),c.flags|=1,ns(i,c,T,g),c.child;case 14:return Bp(i,c,c.type,c.pendingProps,g);case 15:return om(i,c,c.type,c.pendingProps,g);case 19:return qp(i,c,g);case 31:return Np(i,c,g);case 22:return lm(i,c,g,c.pendingProps);case 24:return So(c),T=Wa(Ua),i===null?(I=Lf(),I===null&&(I=za,L=Eo(),I.pooledCache=L,L.refCount++,L!==null&&(I.pooledCacheLanes|=g),I=L),c.memoizedState={parent:T,cache:I},jf(c),Bi(c,Ua,I)):((i.lanes&g)!==0&&(Jh(i,c),Hc(c,null,null,g),uc()),I=i.memoizedState,L=c.memoizedState,I.parent!==T?(I={parent:T,cache:T},c.memoizedState=I,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=I),Bi(c,Ua,T)):(T=L.cache,Bi(c,Ua,T),T!==I.cache&&Il(c,[Ua],g,!0))),ns(i,c,c.pendingProps.children,g),c.child;case 29:throw c.pendingProps}throw Error(f(156,c.tag))}function Yc(i){i.flags|=4}function Fd(i,c,g,T,I){if((c=(i.mode&32)!==0)&&(c=!1),c){if(i.flags|=16777216,(I&335544128)===I)if(i.stateNode.complete)i.flags|=8192;else if(Em())i.flags|=8192;else throw ll=Cr,Gc}else i.flags&=-16777217}function t_(i,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!ap(c))if(Em())i.flags|=8192;else throw ll=Cr,Gc}function Ld(i,c){c!==null&&(i.flags|=4),i.flags&16384&&(c=i.tag!==22?Ln():536870912,i.lanes|=c,pf|=c)}function zd(i,c){if(!Nr)switch(i.tailMode){case"hidden":c=i.tail;for(var g=null;c!==null;)c.alternate!==null&&(g=c),c=c.sibling;g===null?i.tail=null:g.sibling=null;break;case"collapsed":g=i.tail;for(var T=null;g!==null;)g.alternate!==null&&(T=g),g=g.sibling;T===null?c||i.tail===null?i.tail=null:i.tail.sibling=null:T.sibling=null}}function Ka(i){var c=i.alternate!==null&&i.alternate.child===i.child,g=0,T=0;if(c)for(var I=i.child;I!==null;)g|=I.lanes|I.childLanes,T|=I.subtreeFlags&65011712,T|=I.flags&65011712,I.return=i,I=I.sibling;else for(I=i.child;I!==null;)g|=I.lanes|I.childLanes,T|=I.subtreeFlags,T|=I.flags,I.return=i,I=I.sibling;return i.subtreeFlags|=T,i.childLanes=g,c}function r_(i,c,g){var T=c.pendingProps;switch(qr(c),c.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ka(c),null;case 1:return Ka(c),null;case 3:return g=c.stateNode,T=null,i!==null&&(T=i.memoizedState.cache),c.memoizedState.cache!==T&&(c.flags|=2048),Si(Ua),Bt(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(i===null||i.child===null)&&(fs(c)?Yc(c):i===null||i.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Oi())),Ka(c),null;case 26:var I=c.type,L=c.memoizedState;return i===null?(Yc(c),L!==null?(Ka(c),t_(c,L)):(Ka(c),Fd(c,I,null,T,g))):L?L!==i.memoizedState?(Yc(c),Ka(c),t_(c,L)):(Ka(c),c.flags&=-16777217):(i=i.memoizedProps,i!==T&&Yc(c),Ka(c),Fd(c,I,i,T,g)),null;case 27:if(Or(c),g=bt.current,I=c.type,i!==null&&c.stateNode!=null)i.memoizedProps!==T&&Yc(c);else{if(!T){if(c.stateNode===null)throw Error(f(166));return Ka(c),null}i=Fe.current,fs(c)?Za(c):(i=F_(I,T,g),c.stateNode=i,Yc(c))}return Ka(c),null;case 5:if(Or(c),I=c.type,i!==null&&c.stateNode!=null)i.memoizedProps!==T&&Yc(c);else{if(!T){if(c.stateNode===null)throw Error(f(166));return Ka(c),null}if(L=Fe.current,fs(c))Za(c);else{var ae=ep(bt.current);switch(L){case 1:L=ae.createElementNS("http://www.w3.org/2000/svg",I);break;case 2:L=ae.createElementNS("http://www.w3.org/1998/Math/MathML",I);break;default:switch(I){case"svg":L=ae.createElementNS("http://www.w3.org/2000/svg",I);break;case"math":L=ae.createElementNS("http://www.w3.org/1998/Math/MathML",I);break;case"script":L=ae.createElement("div"),L.innerHTML="<script><\/script>",L=L.removeChild(L.firstChild);break;case"select":L=typeof T.is=="string"?ae.createElement("select",{is:T.is}):ae.createElement("select"),T.multiple?L.multiple=!0:T.size&&(L.size=T.size);break;default:L=typeof T.is=="string"?ae.createElement(I,{is:T.is}):ae.createElement(I)}}L[Me]=c,L[Te]=T;e:for(ae=c.child;ae!==null;){if(ae.tag===5||ae.tag===6)L.appendChild(ae.stateNode);else if(ae.tag!==4&&ae.tag!==27&&ae.child!==null){ae.child.return=ae,ae=ae.child;continue}if(ae===c)break e;for(;ae.sibling===null;){if(ae.return===null||ae.return===c)break e;ae=ae.return}ae.sibling.return=ae.return,ae=ae.sibling}c.stateNode=L;e:switch(is(L,I,T),I){case"button":case"input":case"select":case"textarea":T=!!T.autoFocus;break e;case"img":T=!0;break e;default:T=!1}T&&Yc(c)}}return Ka(c),Fd(c,c.type,i===null?null:i.memoizedProps,c.pendingProps,g),null;case 6:if(i&&c.stateNode!=null)i.memoizedProps!==T&&Yc(c);else{if(typeof T!="string"&&c.stateNode===null)throw Error(f(166));if(i=bt.current,fs(c)){if(i=c.stateNode,g=c.memoizedProps,T=null,I=Er,I!==null)switch(I.tag){case 27:case 5:T=I.memoizedProps}i[Me]=c,i=!!(i.nodeValue===g||T!==null&&T.suppressHydrationWarning===!0||Om(i.nodeValue,g)),i||fa(c,!0)}else i=ep(i).createTextNode(T),i[Me]=c,c.stateNode=i}return Ka(c),null;case 31:if(g=c.memoizedState,i===null||i.memoizedState!==null){if(T=fs(c),g!==null){if(i===null){if(!T)throw Error(f(318));if(i=c.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(f(557));i[Me]=c}else zi(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Ka(c),i=!1}else g=Oi(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=g),i=!0;if(!i)return c.flags&256?(Va(c),c):(Va(c),null);if((c.flags&128)!==0)throw Error(f(558))}return Ka(c),null;case 13:if(T=c.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(I=fs(c),T!==null&&T.dehydrated!==null){if(i===null){if(!I)throw Error(f(318));if(I=c.memoizedState,I=I!==null?I.dehydrated:null,!I)throw Error(f(317));I[Me]=c}else zi(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Ka(c),I=!1}else I=Oi(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=I),I=!0;if(!I)return c.flags&256?(Va(c),c):(Va(c),null)}return Va(c),(c.flags&128)!==0?(c.lanes=g,c):(g=T!==null,i=i!==null&&i.memoizedState!==null,g&&(T=c.child,I=null,T.alternate!==null&&T.alternate.memoizedState!==null&&T.alternate.memoizedState.cachePool!==null&&(I=T.alternate.memoizedState.cachePool.pool),L=null,T.memoizedState!==null&&T.memoizedState.cachePool!==null&&(L=T.memoizedState.cachePool.pool),L!==I&&(T.flags|=2048)),g!==i&&g&&(c.child.flags|=8192),Ld(c,c.updateQueue),Ka(c),null);case 4:return Bt(),i===null&&Lm(c.stateNode.containerInfo),Ka(c),null;case 10:return Si(c.type),Ka(c),null;case 19:if(ne($a),T=c.memoizedState,T===null)return Ka(c),null;if(I=(c.flags&128)!==0,L=T.rendering,L===null)if(I)zd(T,!1);else{if(ui!==0||i!==null&&(i.flags&128)!==0)for(i=c.child;i!==null;){if(L=rf(i),L!==null){for(c.flags|=128,zd(T,!1),i=L.updateQueue,c.updateQueue=i,Ld(c,i),c.subtreeFlags=0,i=g,g=c.child;g!==null;)Qe(g,i),g=g.sibling;return Ue($a,$a.current&1|2),Nr&&xr(c,T.treeForkCount),c.child}i=i.sibling}T.tail!==null&&pr()>qd&&(c.flags|=128,I=!0,zd(T,!1),c.lanes=4194304)}else{if(!I)if(i=rf(L),i!==null){if(c.flags|=128,I=!0,i=i.updateQueue,c.updateQueue=i,Ld(c,i),zd(T,!0),T.tail===null&&T.tailMode==="hidden"&&!L.alternate&&!Nr)return Ka(c),null}else 2*pr()-T.renderingStartTime>qd&&g!==536870912&&(c.flags|=128,I=!0,zd(T,!1),c.lanes=4194304);T.isBackwards?(L.sibling=c.child,c.child=L):(i=T.last,i!==null?i.sibling=L:c.child=L,T.last=L)}return T.tail!==null?(i=T.tail,T.rendering=i,T.tail=i.sibling,T.renderingStartTime=pr(),i.sibling=null,g=$a.current,Ue($a,I?g&1|2:g&1),Nr&&xr(c,T.treeForkCount),i):(Ka(c),null);case 22:case 23:return Va(c),ku(),T=c.memoizedState!==null,i!==null?i.memoizedState!==null!==T&&(c.flags|=8192):T&&(c.flags|=8192),T?(g&536870912)!==0&&(c.flags&128)===0&&(Ka(c),c.subtreeFlags&6&&(c.flags|=8192)):Ka(c),g=c.updateQueue,g!==null&&Ld(c,g.retryQueue),g=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(g=i.memoizedState.cachePool.pool),T=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(T=c.memoizedState.cachePool.pool),T!==g&&(c.flags|=2048),i!==null&&ne(sl),null;case 24:return g=null,i!==null&&(g=i.memoizedState.cache),c.memoizedState.cache!==g&&(c.flags|=2048),Si(Ua),Ka(c),null;case 25:return null;case 30:return null}throw Error(f(156,c.tag))}function Vx(i,c){switch(qr(c),c.tag){case 1:return i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 3:return Si(Ua),Bt(),i=c.flags,(i&65536)!==0&&(i&128)===0?(c.flags=i&-65537|128,c):null;case 26:case 27:case 5:return Or(c),null;case 31:if(c.memoizedState!==null){if(Va(c),c.alternate===null)throw Error(f(340));zi()}return i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 13:if(Va(c),i=c.memoizedState,i!==null&&i.dehydrated!==null){if(c.alternate===null)throw Error(f(340));zi()}return i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 19:return ne($a),null;case 4:return Bt(),null;case 10:return Si(c.type),null;case 22:case 23:return Va(c),ku(),i!==null&&ne(sl),i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 24:return Si(Ua),null;case 25:return null;default:return null}}function Zp(i,c){switch(qr(c),c.tag){case 3:Si(Ua),Bt();break;case 26:case 27:case 5:Or(c);break;case 4:Bt();break;case 31:c.memoizedState!==null&&Va(c);break;case 13:Va(c);break;case 19:ne($a);break;case 10:Si(c.type);break;case 22:case 23:Va(c),ku(),i!==null&&ne(sl);break;case 24:Si(Ua)}}function Zf(i,c){try{var g=c.updateQueue,T=g!==null?g.lastEffect:null;if(T!==null){var I=T.next;g=I;do{if((g.tag&i)===i){T=void 0;var L=g.create,ae=g.inst;T=L(),ae.destroy=T}g=g.next}while(g!==I)}}catch(Ae){ga(c,c.return,Ae)}}function Fu(i,c,g){try{var T=c.updateQueue,I=T!==null?T.lastEffect:null;if(I!==null){var L=I.next;T=L;do{if((T.tag&i)===i){var ae=T.inst,Ae=ae.destroy;if(Ae!==void 0){ae.destroy=void 0,I=c;var ut=g,Lt=Ae;try{Lt()}catch(er){ga(I,ut,er)}}}T=T.next}while(T!==L)}}catch(er){ga(c,c.return,er)}}function n_(i){var c=i.updateQueue;if(c!==null){var g=i.stateNode;try{Uf(c,g)}catch(T){ga(i,i.return,T)}}}function a_(i,c,g){g.props=Wc(i.type,i.memoizedProps),g.state=i.memoizedState;try{g.componentWillUnmount()}catch(T){ga(i,c,T)}}function Od(i,c){try{var g=i.ref;if(g!==null){switch(i.tag){case 26:case 27:case 5:var T=i.stateNode;break;case 30:T=i.stateNode;break;default:T=i.stateNode}typeof g=="function"?i.refCleanup=g(T):g.current=T}}catch(I){ga(i,c,I)}}function ml(i,c){var g=i.ref,T=i.refCleanup;if(g!==null)if(typeof T=="function")try{T()}catch(I){ga(i,c,I)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof g=="function")try{g(null)}catch(I){ga(i,c,I)}else g.current=null}function Wp(i){var c=i.type,g=i.memoizedProps,T=i.stateNode;try{e:switch(c){case"button":case"input":case"select":case"textarea":g.autoFocus&&T.focus();break e;case"img":g.src?T.src=g.src:g.srcSet&&(T.srcset=g.srcSet)}}catch(I){ga(i,i.return,I)}}function $p(i,c,g){try{var T=i.stateNode;I_(T,i.type,g,c),T[Te]=c}catch(I){ga(i,i.return,I)}}function bh(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Mh(i.type)||i.tag===4}function uf(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||bh(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Mh(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function pm(i,c,g){var T=i.tag;if(T===5||T===6)i=i.stateNode,c?(g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g).insertBefore(i,c):(c=g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g,c.appendChild(i),g=g._reactRootContainer,g!=null||c.onclick!==null||(c.onclick=_o));else if(T!==4&&(T===27&&Mh(i.type)&&(g=i.stateNode,c=null),i=i.child,i!==null))for(pm(i,c,g),i=i.sibling;i!==null;)pm(i,c,g),i=i.sibling}function Xp(i,c,g){var T=i.tag;if(T===5||T===6)i=i.stateNode,c?g.insertBefore(i,c):g.appendChild(i);else if(T!==4&&(T===27&&Mh(i.type)&&(g=i.stateNode),i=i.child,i!==null))for(Xp(i,c,g),i=i.sibling;i!==null;)Xp(i,c,g),i=i.sibling}function i_(i){var c=i.stateNode,g=i.memoizedProps;try{for(var T=i.type,I=c.attributes;I.length;)c.removeAttributeNode(I[0]);is(c,T,g),c[Me]=i,c[Te]=g}catch(L){ga(i,i.return,L)}}var Lu=!1,Vi=!1,mm=!1,s_=typeof WeakSet=="function"?WeakSet:Set,Gi=null;function Gx(i,c){if(i=i.containerInfo,Qd=cp,i=oh(i),_u(i)){if("selectionStart"in i)var g={start:i.selectionStart,end:i.selectionEnd};else e:{g=(g=i.ownerDocument)&&g.defaultView||window;var T=g.getSelection&&g.getSelection();if(T&&T.rangeCount!==0){g=T.anchorNode;var I=T.anchorOffset,L=T.focusNode;T=T.focusOffset;try{g.nodeType,L.nodeType}catch{g=null;break e}var ae=0,Ae=-1,ut=-1,Lt=0,er=0,sr=i,Ot=null;t:for(;;){for(var qt;sr!==g||I!==0&&sr.nodeType!==3||(Ae=ae+I),sr!==L||T!==0&&sr.nodeType!==3||(ut=ae+T),sr.nodeType===3&&(ae+=sr.nodeValue.length),(qt=sr.firstChild)!==null;)Ot=sr,sr=qt;for(;;){if(sr===i)break t;if(Ot===g&&++Lt===I&&(Ae=ae),Ot===L&&++er===T&&(ut=ae),(qt=sr.nextSibling)!==null)break;sr=Ot,Ot=sr.parentNode}sr=qt}g=Ae===-1||ut===-1?null:{start:Ae,end:ut}}else g=null}g=g||{start:0,end:0}}else g=null;for(Bm={focusedElem:i,selectionRange:g},cp=!1,Gi=c;Gi!==null;)if(c=Gi,i=c.child,(c.subtreeFlags&1028)!==0&&i!==null)i.return=c,Gi=i;else for(;Gi!==null;){switch(c=Gi,L=c.alternate,i=c.flags,c.tag){case 0:if((i&4)!==0&&(i=c.updateQueue,i=i!==null?i.events:null,i!==null))for(g=0;g<i.length;g++)I=i[g],I.ref.impl=I.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&L!==null){i=void 0,g=c,I=L.memoizedProps,L=L.memoizedState,T=g.stateNode;try{var $r=Wc(g.type,I);i=T.getSnapshotBeforeUpdate($r,L),T.__reactInternalSnapshotBeforeUpdate=i}catch(on){ga(g,g.return,on)}}break;case 3:if((i&1024)!==0){if(i=c.stateNode.containerInfo,g=i.nodeType,g===9)yc(i);else if(g===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":yc(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(f(163))}if(i=c.sibling,i!==null){i.return=c.return,Gi=i;break}Gi=c.return}}function gm(i,c,g){var T=g.flags;switch(g.tag){case 0:case 11:case 15:Po(i,g),T&4&&Zf(5,g);break;case 1:if(Po(i,g),T&4)if(i=g.stateNode,c===null)try{i.componentDidMount()}catch(ae){ga(g,g.return,ae)}else{var I=Wc(g.type,c.memoizedProps);c=c.memoizedState;try{i.componentDidUpdate(I,c,i.__reactInternalSnapshotBeforeUpdate)}catch(ae){ga(g,g.return,ae)}}T&64&&n_(g),T&512&&Od(g,g.return);break;case 3:if(Po(i,g),T&64&&(i=g.updateQueue,i!==null)){if(c=null,g.child!==null)switch(g.child.tag){case 27:case 5:c=g.child.stateNode;break;case 1:c=g.child.stateNode}try{Uf(i,c)}catch(ae){ga(g,g.return,ae)}}break;case 27:c===null&&T&4&&i_(g);case 26:case 5:Po(i,g),c===null&&T&4&&Wp(g),T&512&&Od(g,g.return);break;case 12:Po(i,g);break;case 31:Po(i,g),T&4&&Bd(i,g);break;case 13:Po(i,g),T&4&&Nd(i,g),T&64&&(i=g.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(g=km.bind(null,g),qi(i,g))));break;case 22:if(T=g.memoizedState!==null||Lu,!T){c=c!==null&&c.memoizedState!==null||Vi,I=Lu;var L=Vi;Lu=T,(Vi=c)&&!L?zu(i,g,(g.subtreeFlags&8772)!==0):Po(i,g),Lu=I,Vi=L}break;case 30:break;default:Po(i,g)}}function Wf(i){var c=i.alternate;c!==null&&(i.alternate=null,Wf(c)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(c=i.stateNode,c!==null&&or(c)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var ai=null,Vn=!1;function Io(i,c,g){for(g=g.child;g!==null;)_m(i,c,g),g=g.sibling}function _m(i,c,g){if(it&&typeof it.onCommitFiberUnmount=="function")try{it.onCommitFiberUnmount(ot,g)}catch{}switch(g.tag){case 26:Vi||ml(g,c),Io(i,c,g),g.memoizedState?g.memoizedState.count--:g.stateNode&&(g=g.stateNode,g.parentNode.removeChild(g));break;case 27:Vi||ml(g,c);var T=ai,I=Vn;Mh(g.type)&&(ai=g.stateNode,Vn=!1),Io(i,c,g),sd(g.stateNode),ai=T,Vn=I;break;case 5:Vi||ml(g,c);case 6:if(T=ai,I=Vn,ai=null,Io(i,c,g),ai=T,Vn=I,ai!==null)if(Vn)try{(ai.nodeType===9?ai.body:ai.nodeName==="HTML"?ai.ownerDocument.body:ai).removeChild(g.stateNode)}catch(L){ga(g,c,L)}else try{ai.removeChild(g.stateNode)}catch(L){ga(g,c,L)}break;case 18:ai!==null&&(Vn?(i=ai,P_(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,g.stateNode),Lh(i)):P_(ai,g.stateNode));break;case 4:T=ai,I=Vn,ai=g.stateNode.containerInfo,Vn=!0,Io(i,c,g),ai=T,Vn=I;break;case 0:case 11:case 14:case 15:Fu(2,g,c),Vi||Fu(4,g,c),Io(i,c,g);break;case 1:Vi||(ml(g,c),T=g.stateNode,typeof T.componentWillUnmount=="function"&&a_(g,c,T)),Io(i,c,g);break;case 21:Io(i,c,g);break;case 22:Vi=(T=Vi)||g.memoizedState!==null,Io(i,c,g),Vi=T;break;default:Io(i,c,g)}}function Bd(i,c){if(c.memoizedState===null&&(i=c.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{Lh(i)}catch(g){ga(c,c.return,g)}}}function Nd(i,c){if(c.memoizedState===null&&(i=c.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Lh(i)}catch(g){ga(c,c.return,g)}}function jd(i){switch(i.tag){case 31:case 13:case 19:var c=i.stateNode;return c===null&&(c=i.stateNode=new s_),c;case 22:return i=i.stateNode,c=i._retryCache,c===null&&(c=i._retryCache=new s_),c;default:throw Error(f(435,i.tag))}}function Ud(i,c){var g=jd(i);c.forEach(function(T){if(!g.has(T)){g.add(T);var I=Zx.bind(null,i,T);T.then(I,I)}})}function so(i,c){var g=c.deletions;if(g!==null)for(var T=0;T<g.length;T++){var I=g[T],L=i,ae=c,Ae=ae;e:for(;Ae!==null;){switch(Ae.tag){case 27:if(Mh(Ae.type)){ai=Ae.stateNode,Vn=!1;break e}break;case 5:ai=Ae.stateNode,Vn=!1;break e;case 3:case 4:ai=Ae.stateNode.containerInfo,Vn=!0;break e}Ae=Ae.return}if(ai===null)throw Error(f(160));_m(L,ae,I),ai=null,Vn=!1,L=I.alternate,L!==null&&(L.return=null),I.return=null}if(c.subtreeFlags&13886)for(c=c.child;c!==null;)Yp(c,i),c=c.sibling}var oo=null;function Yp(i,c){var g=i.alternate,T=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:so(c,i),as(i),T&4&&(Fu(3,i,i.return),Zf(3,i),Fu(5,i,i.return));break;case 1:so(c,i),as(i),T&512&&(Vi||g===null||ml(g,g.return)),T&64&&Lu&&(i=i.updateQueue,i!==null&&(T=i.callbacks,T!==null&&(g=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=g===null?T:g.concat(T))));break;case 26:var I=oo;if(so(c,i),as(i),T&512&&(Vi||g===null||ml(g,g.return)),T&4){var L=g!==null?g.memoizedState:null;if(T=i.memoizedState,g===null)if(T===null)if(i.stateNode===null){e:{T=i.type,g=i.memoizedProps,I=I.ownerDocument||I;t:switch(T){case"title":L=I.getElementsByTagName("title")[0],(!L||L[_t]||L[Me]||L.namespaceURI==="http://www.w3.org/2000/svg"||L.hasAttribute("itemprop"))&&(L=I.createElement(T),I.head.insertBefore(L,I.querySelector("head > title"))),is(L,T,g),L[Me]=i,Ur(L),T=L;break e;case"link":var ae=Km("link","href",I).get(T+(g.href||""));if(ae){for(var Ae=0;Ae<ae.length;Ae++)if(L=ae[Ae],L.getAttribute("href")===(g.href==null||g.href===""?null:g.href)&&L.getAttribute("rel")===(g.rel==null?null:g.rel)&&L.getAttribute("title")===(g.title==null?null:g.title)&&L.getAttribute("crossorigin")===(g.crossOrigin==null?null:g.crossOrigin)){ae.splice(Ae,1);break t}}L=I.createElement(T),is(L,T,g),I.head.appendChild(L);break;case"meta":if(ae=Km("meta","content",I).get(T+(g.content||""))){for(Ae=0;Ae<ae.length;Ae++)if(L=ae[Ae],L.getAttribute("content")===(g.content==null?null:""+g.content)&&L.getAttribute("name")===(g.name==null?null:g.name)&&L.getAttribute("property")===(g.property==null?null:g.property)&&L.getAttribute("http-equiv")===(g.httpEquiv==null?null:g.httpEquiv)&&L.getAttribute("charset")===(g.charSet==null?null:g.charSet)){ae.splice(Ae,1);break t}}L=I.createElement(T),is(L,T,g),I.head.appendChild(L);break;default:throw Error(f(468,T))}L[Me]=i,Ur(L),T=L}i.stateNode=T}else np(I,i.type,i.stateNode);else i.stateNode=Ym(I,T,i.memoizedProps);else L!==T?(L===null?g.stateNode!==null&&(g=g.stateNode,g.parentNode.removeChild(g)):L.count--,T===null?np(I,i.type,i.stateNode):Ym(I,T,i.memoizedProps)):T===null&&i.stateNode!==null&&$p(i,i.memoizedProps,g.memoizedProps)}break;case 27:so(c,i),as(i),T&512&&(Vi||g===null||ml(g,g.return)),g!==null&&T&4&&$p(i,i.memoizedProps,g.memoizedProps);break;case 5:if(so(c,i),as(i),T&512&&(Vi||g===null||ml(g,g.return)),i.flags&32){I=i.stateNode;try{go(I,"")}catch($r){ga(i,i.return,$r)}}T&4&&i.stateNode!=null&&(I=i.memoizedProps,$p(i,I,g!==null?g.memoizedProps:I)),T&1024&&(mm=!0);break;case 6:if(so(c,i),as(i),T&4){if(i.stateNode===null)throw Error(f(162));T=i.memoizedProps,g=i.stateNode;try{g.nodeValue=T}catch($r){ga(i,i.return,$r)}}break;case 3:if(S0=null,I=oo,oo=b0(c.containerInfo),so(c,i),oo=I,as(i),T&4&&g!==null&&g.memoizedState.isDehydrated)try{Lh(c.containerInfo)}catch($r){ga(i,i.return,$r)}mm&&(mm=!1,Vd(i));break;case 4:T=oo,oo=b0(i.stateNode.containerInfo),so(c,i),as(i),oo=T;break;case 12:so(c,i),as(i);break;case 31:so(c,i),as(i),T&4&&(T=i.updateQueue,T!==null&&(i.updateQueue=null,Ud(i,T)));break;case 13:so(c,i),as(i),i.child.flags&8192&&i.memoizedState!==null!=(g!==null&&g.memoizedState!==null)&&(Qp=pr()),T&4&&(T=i.updateQueue,T!==null&&(i.updateQueue=null,Ud(i,T)));break;case 22:I=i.memoizedState!==null;var ut=g!==null&&g.memoizedState!==null,Lt=Lu,er=Vi;if(Lu=Lt||I,Vi=er||ut,so(c,i),Vi=er,Lu=Lt,as(i),T&8192)e:for(c=i.stateNode,c._visibility=I?c._visibility&-2:c._visibility|1,I&&(g===null||ut||Lu||Vi||gc(i)),g=null,c=i;;){if(c.tag===5||c.tag===26){if(g===null){ut=g=c;try{if(L=ut.stateNode,I)ae=L.style,typeof ae.setProperty=="function"?ae.setProperty("display","none","important"):ae.display="none";else{Ae=ut.stateNode;var sr=ut.memoizedProps.style,Ot=sr!=null&&sr.hasOwnProperty("display")?sr.display:null;Ae.style.display=Ot==null||typeof Ot=="boolean"?"":(""+Ot).trim()}}catch($r){ga(ut,ut.return,$r)}}}else if(c.tag===6){if(g===null){ut=c;try{ut.stateNode.nodeValue=I?"":ut.memoizedProps}catch($r){ga(ut,ut.return,$r)}}}else if(c.tag===18){if(g===null){ut=c;try{var qt=ut.stateNode;I?An(qt,!0):An(ut.stateNode,!1)}catch($r){ga(ut,ut.return,$r)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===i)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===i)break e;for(;c.sibling===null;){if(c.return===null||c.return===i)break e;g===c&&(g=null),c=c.return}g===c&&(g=null),c.sibling.return=c.return,c=c.sibling}T&4&&(T=i.updateQueue,T!==null&&(g=T.retryQueue,g!==null&&(T.retryQueue=null,Ud(i,g))));break;case 19:so(c,i),as(i),T&4&&(T=i.updateQueue,T!==null&&(i.updateQueue=null,Ud(i,T)));break;case 30:break;case 21:break;default:so(c,i),as(i)}}function as(i){var c=i.flags;if(c&2){try{for(var g,T=i.return;T!==null;){if(bh(T)){g=T;break}T=T.return}if(g==null)throw Error(f(160));switch(g.tag){case 27:var I=g.stateNode,L=uf(i);Xp(i,L,I);break;case 5:var ae=g.stateNode;g.flags&32&&(go(ae,""),g.flags&=-33);var Ae=uf(i);Xp(i,Ae,ae);break;case 3:case 4:var ut=g.stateNode.containerInfo,Lt=uf(i);pm(i,Lt,ut);break;default:throw Error(f(161))}}catch(er){ga(i,i.return,er)}i.flags&=-3}c&4096&&(i.flags&=-4097)}function Vd(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var c=i;Vd(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),i=i.sibling}}function Po(i,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)gm(i,c.alternate,c),c=c.sibling}function gc(i){for(i=i.child;i!==null;){var c=i;switch(c.tag){case 0:case 11:case 14:case 15:Fu(4,c,c.return),gc(c);break;case 1:ml(c,c.return);var g=c.stateNode;typeof g.componentWillUnmount=="function"&&a_(c,c.return,g),gc(c);break;case 27:sd(c.stateNode);case 26:case 5:ml(c,c.return),gc(c);break;case 22:c.memoizedState===null&&gc(c);break;case 30:gc(c);break;default:gc(c)}i=i.sibling}}function zu(i,c,g){for(g=g&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var T=c.alternate,I=i,L=c,ae=L.flags;switch(L.tag){case 0:case 11:case 15:zu(I,L,g),Zf(4,L);break;case 1:if(zu(I,L,g),T=L,I=T.stateNode,typeof I.componentDidMount=="function")try{I.componentDidMount()}catch(Lt){ga(T,T.return,Lt)}if(T=L,I=T.updateQueue,I!==null){var Ae=T.stateNode;try{var ut=I.shared.hiddenCallbacks;if(ut!==null)for(I.shared.hiddenCallbacks=null,I=0;I<ut.length;I++)Qh(ut[I],Ae)}catch(Lt){ga(T,T.return,Lt)}}g&&ae&64&&n_(L),Od(L,L.return);break;case 27:i_(L);case 26:case 5:zu(I,L,g),g&&T===null&&ae&4&&Wp(L),Od(L,L.return);break;case 12:zu(I,L,g);break;case 31:zu(I,L,g),g&&ae&4&&Bd(I,L);break;case 13:zu(I,L,g),g&&ae&4&&Nd(I,L);break;case 22:L.memoizedState===null&&zu(I,L,g),Od(L,L.return);break;case 30:break;default:zu(I,L,g)}c=c.sibling}}function Kp(i,c){var g=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(g=i.memoizedState.cachePool.pool),i=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(i=c.memoizedState.cachePool.pool),i!==g&&(i!=null&&i.refCount++,g!=null&&Pl(g))}function Ou(i,c){i=null,c.alternate!==null&&(i=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==i&&(c.refCount++,i!=null&&Pl(i))}function _c(i,c,g,T){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)xm(i,c,g,T),c=c.sibling}function xm(i,c,g,T){var I=c.flags;switch(c.tag){case 0:case 11:case 15:_c(i,c,g,T),I&2048&&Zf(9,c);break;case 1:_c(i,c,g,T);break;case 3:_c(i,c,g,T),I&2048&&(i=null,c.alternate!==null&&(i=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==i&&(c.refCount++,i!=null&&Pl(i)));break;case 12:if(I&2048){_c(i,c,g,T),i=c.stateNode;try{var L=c.memoizedProps,ae=L.id,Ae=L.onPostCommit;typeof Ae=="function"&&Ae(ae,c.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(ut){ga(c,c.return,ut)}}else _c(i,c,g,T);break;case 31:_c(i,c,g,T);break;case 13:_c(i,c,g,T);break;case 23:break;case 22:L=c.stateNode,ae=c.alternate,c.memoizedState!==null?L._visibility&2?_c(i,c,g,T):hf(i,c):L._visibility&2?_c(i,c,g,T):(L._visibility|=2,Kc(i,c,g,T,(c.subtreeFlags&10256)!==0||!1)),I&2048&&Kp(ae,c);break;case 24:_c(i,c,g,T),I&2048&&Ou(c.alternate,c);break;default:_c(i,c,g,T)}}function Kc(i,c,g,T,I){for(I=I&&((c.subtreeFlags&10256)!==0||!1),c=c.child;c!==null;){var L=i,ae=c,Ae=g,ut=T,Lt=ae.flags;switch(ae.tag){case 0:case 11:case 15:Kc(L,ae,Ae,ut,I),Zf(8,ae);break;case 23:break;case 22:var er=ae.stateNode;ae.memoizedState!==null?er._visibility&2?Kc(L,ae,Ae,ut,I):hf(L,ae):(er._visibility|=2,Kc(L,ae,Ae,ut,I)),I&&Lt&2048&&Kp(ae.alternate,ae);break;case 24:Kc(L,ae,Ae,ut,I),I&&Lt&2048&&Ou(ae.alternate,ae);break;default:Kc(L,ae,Ae,ut,I)}c=c.sibling}}function hf(i,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var g=i,T=c,I=T.flags;switch(T.tag){case 22:hf(g,T),I&2048&&Kp(T.alternate,T);break;case 24:hf(g,T),I&2048&&Ou(T.alternate,T);break;default:hf(g,T)}c=c.sibling}}var $f=8192;function ff(i,c,g){if(i.subtreeFlags&$f)for(i=i.child;i!==null;)o_(i,c,g),i=i.sibling}function o_(i,c,g){switch(i.tag){case 26:ff(i,c,g),i.flags&$f&&i.memoizedState!==null&&Jm(g,oo,i.memoizedState,i.memoizedProps);break;case 5:ff(i,c,g);break;case 3:case 4:var T=oo;oo=b0(i.stateNode.containerInfo),ff(i,c,g),oo=T;break;case 22:i.memoizedState===null&&(T=i.alternate,T!==null&&T.memoizedState!==null?(T=$f,$f=16777216,ff(i,c,g),$f=T):ff(i,c,g));break;default:ff(i,c,g)}}function l_(i){var c=i.alternate;if(c!==null&&(i=c.child,i!==null)){c.child=null;do c=i.sibling,i.sibling=null,i=c;while(i!==null)}}function Gd(i){var c=i.deletions;if((i.flags&16)!==0){if(c!==null)for(var g=0;g<c.length;g++){var T=c[g];Gi=T,Xf(T,i)}l_(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)c_(i),i=i.sibling}function c_(i){switch(i.tag){case 0:case 11:case 15:Gd(i),i.flags&2048&&Fu(9,i,i.return);break;case 3:Gd(i);break;case 12:Gd(i);break;case 22:var c=i.stateNode;i.memoizedState!==null&&c._visibility&2&&(i.return===null||i.return.tag!==13)?(c._visibility&=-3,Jp(i)):Gd(i);break;default:Gd(i)}}function Jp(i){var c=i.deletions;if((i.flags&16)!==0){if(c!==null)for(var g=0;g<c.length;g++){var T=c[g];Gi=T,Xf(T,i)}l_(i)}for(i=i.child;i!==null;){switch(c=i,c.tag){case 0:case 11:case 15:Fu(8,c,c.return),Jp(c);break;case 22:g=c.stateNode,g._visibility&2&&(g._visibility&=-3,Jp(c));break;default:Jp(c)}i=i.sibling}}function Xf(i,c){for(;Gi!==null;){var g=Gi;switch(g.tag){case 0:case 11:case 15:Fu(8,g,c);break;case 23:case 22:if(g.memoizedState!==null&&g.memoizedState.cachePool!==null){var T=g.memoizedState.cachePool.pool;T!=null&&T.refCount++}break;case 24:Pl(g.memoizedState.cache)}if(T=g.child,T!==null)T.return=g,Gi=T;else e:for(g=i;Gi!==null;){T=Gi;var I=T.sibling,L=T.return;if(Wf(T),T===g){Gi=null;break e}if(I!==null){I.return=L,Gi=I;break e}Gi=L}}}var Hx={getCacheForType:function(i){var c=Wa(Ua),g=c.data.get(i);return g===void 0&&(g=i(),c.data.set(i,g)),g},cacheSignal:function(){return Wa(Ua).controller.signal}},u_=typeof WeakMap=="function"?WeakMap:Map,ma=0,za=null,Nn=null,jn=0,Ta=0,lo=null,Vl=!1,wh=!1,ym=!1,Bu=0,ui=0,Nu=0,df=0,vm=0,Ds=0,pf=0,Hd=null,Fo=null,bm=!1,Qp=0,h_=0,qd=1/0,Yf=null,ju=null,Hi=0,Uu=null,Kf=null,Gl=0,wm=0,e0=null,f_=null,Zd=0,Tm=null;function Lo(){return(ma&2)!==0&&jn!==0?jn&-jn:et.T!==null?Im():ye()}function d_(){if(Ds===0)if((jn&536870912)===0||Nr){var i=yn;yn<<=1,(yn&3932160)===0&&(yn=262144),Ds=i}else Ds=536870912;return i=Rr.current,i!==null&&(i.flags|=32),Ds}function zo(i,c,g){(i===za&&(Ta===2||Ta===9)||i.cancelPendingCommit!==null)&&(Qf(i,0),Th(i,jn,Ds,!1)),zn(i,g),((ma&2)===0||i!==za)&&(i===za&&((ma&2)===0&&(df|=g),ui===4&&Th(i,jn,Ds,!1)),xc(i))}function ki(i,c,g){if((ma&6)!==0)throw Error(f(327));var T=!g&&(c&127)===0&&(c&i.expiredLanes)===0||Kn(i,c),I=T?ed(i,c):n0(i,c,!0),L=T;do{if(I===0){wh&&!T&&Th(i,c,0,!1);break}else{if(g=i.current.alternate,L&&!qx(g)){I=n0(i,c,!1),L=!1;continue}if(I===2){if(L=c,i.errorRecoveryDisabledLanes&L)var ae=0;else ae=i.pendingLanes&-536870913,ae=ae!==0?ae:ae&536870912?536870912:0;if(ae!==0){c=ae;e:{var Ae=i;I=Hd;var ut=Ae.current.memoizedState.isDehydrated;if(ut&&(Qf(Ae,ae).flags|=256),ae=n0(Ae,ae,!1),ae!==2){if(ym&&!ut){Ae.errorRecoveryDisabledLanes|=L,df|=L,I=4;break e}L=Fo,Fo=I,L!==null&&(Fo===null?Fo=L:Fo.push.apply(Fo,L))}I=ae}if(L=!1,I!==2)continue}}if(I===1){Qf(i,0),Th(i,c,0,!0);break}e:{switch(T=i,L=I,L){case 0:case 1:throw Error(f(345));case 4:if((c&4194048)!==c)break;case 6:Th(T,c,Ds,!Vl);break e;case 2:Fo=null;break;case 3:case 5:break;default:throw Error(f(329))}if((c&62914560)===c&&(I=Qp+300-pr(),10<I)){if(Th(T,c,Ds,!Vl),En(T,0,!0)!==0)break e;Gl=c,T.timeoutHandle=v0(Jf.bind(null,T,g,Fo,Yf,bm,c,Ds,df,pf,Vl,L,"Throttled",-0,0),I);break e}Jf(T,g,Fo,Yf,bm,c,Ds,df,pf,Vl,L,null,-0,0)}}break}while(!0);xc(i)}function Jf(i,c,g,T,I,L,ae,Ae,ut,Lt,er,sr,Ot,qt){if(i.timeoutHandle=-1,sr=c.subtreeFlags,sr&8192||(sr&16785408)===16785408){sr={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:_o},o_(c,L,sr);var $r=(L&62914560)===L?Qp-pr():(L&4194048)===L?h_-pr():0;if($r=Qm(sr,$r),$r!==null){Gl=L,i.cancelPendingCommit=$r(x_.bind(null,i,c,L,g,T,I,ae,Ae,ut,er,sr,null,Ot,qt)),Th(i,L,ae,!Lt);return}}x_(i,c,L,g,T,I,ae,Ae,ut)}function qx(i){for(var c=i;;){var g=c.tag;if((g===0||g===11||g===15)&&c.flags&16384&&(g=c.updateQueue,g!==null&&(g=g.stores,g!==null)))for(var T=0;T<g.length;T++){var I=g[T],L=I.getSnapshot;I=I.value;try{if(!Pa(L(),I))return!1}catch{return!1}}if(g=c.child,c.subtreeFlags&16384&&g!==null)g.return=c,c=g;else{if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Th(i,c,g,T){c&=~vm,c&=~df,i.suspendedLanes|=c,i.pingedLanes&=~c,T&&(i.warmLanes|=c),T=i.expirationTimes;for(var I=c;0<I;){var L=31-zt(I),ae=1<<L;T[L]=-1,I&=~ae}g!==0&&Bn(i,g,c)}function Wd(){return(ma&6)===0?(gl(0),!1):!0}function t0(){if(Nn!==null){if(Ta===0)var i=Nn.return;else i=Nn,ri=ds=null,dc(i),Fl=null,Eu=0,i=Nn;for(;i!==null;)Zp(i.alternate,i),i=i.return;Nn=null}}function Qf(i,c){var g=i.timeoutHandle;g!==-1&&(i.timeoutHandle=-1,jm(g)),g=i.cancelPendingCommit,g!==null&&(i.cancelPendingCommit=null,g()),Gl=0,t0(),za=i,Nn=g=Q(i.current,null),jn=c,Ta=0,lo=null,Vl=!1,wh=Kn(i,c),ym=!1,pf=Ds=vm=df=Nu=ui=0,Fo=Hd=null,bm=!1,(c&8)!==0&&(c|=c&32);var T=i.entangledLanes;if(T!==0)for(i=i.entanglements,T&=c;0<T;){var I=31-zt(T),L=1<<I;c|=i[I],T&=~L}return Bu=c,il(),g}function Sm(i,c){Sn=null,et.H=ea,c===ol||c===Us?(c=mh(),Ta=3):c===Gc?(c=mh(),Ta=4):Ta=c===Op?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,lo=c,Nn===null&&(ui=1,pl(i,Vr(c,i.current)))}function Em(){var i=Rr.current;return i===null?!0:(jn&4194048)===jn?jr===null:(jn&62914560)===jn||(jn&536870912)!==0?i===jr:!1}function mf(){var i=et.H;return et.H=ea,i===null?ea:i}function r0(){var i=et.A;return et.A=Hx,i}function $d(){ui=4,Vl||(jn&4194048)!==jn&&Rr.current!==null||(wh=!0),(Nu&134217727)===0&&(df&134217727)===0||za===null||Th(za,jn,Ds,!1)}function n0(i,c,g){var T=ma;ma|=2;var I=mf(),L=r0();(za!==i||jn!==c)&&(Yf=null,Qf(i,c)),c=!1;var ae=ui;e:do try{if(Ta!==0&&Nn!==null){var Ae=Nn,ut=lo;switch(Ta){case 8:t0(),ae=6;break e;case 3:case 2:case 9:case 6:Rr.current===null&&(c=!0);var Lt=Ta;if(Ta=0,lo=null,td(i,Ae,ut,Lt),g&&wh){ae=0;break e}break;default:Lt=Ta,Ta=0,lo=null,td(i,Ae,ut,Lt)}}a0(),ae=ui;break}catch(er){Sm(i,er)}while(!0);return c&&i.shellSuspendCounter++,ri=ds=null,ma=T,et.H=I,et.A=L,Nn===null&&(za=null,jn=0,il()),ae}function a0(){for(;Nn!==null;)m_(Nn)}function ed(i,c){var g=ma;ma|=2;var T=mf(),I=r0();za!==i||jn!==c?(Yf=null,qd=pr()+500,Qf(i,c)):wh=Kn(i,c);e:do try{if(Ta!==0&&Nn!==null){c=Nn;var L=lo;t:switch(Ta){case 1:Ta=0,lo=null,td(i,c,L,1);break;case 2:case 9:if(Xh(L)){Ta=0,lo=null,g_(c);break}c=function(){Ta!==2&&Ta!==9||za!==i||(Ta=7),xc(i)},L.then(c,c);break e;case 3:Ta=7;break e;case 4:Ta=5;break e;case 7:Xh(L)?(Ta=0,lo=null,g_(c)):(Ta=0,lo=null,td(i,c,L,7));break;case 5:var ae=null;switch(Nn.tag){case 26:ae=Nn.memoizedState;case 5:case 27:var Ae=Nn;if(ae?ap(ae):Ae.stateNode.complete){Ta=0,lo=null;var ut=Ae.sibling;if(ut!==null)Nn=ut;else{var Lt=Ae.return;Lt!==null?(Nn=Lt,i0(Lt)):Nn=null}break t}}Ta=0,lo=null,td(i,c,L,5);break;case 6:Ta=0,lo=null,td(i,c,L,6);break;case 8:t0(),ui=6;break e;default:throw Error(f(462))}}p_();break}catch(er){Sm(i,er)}while(!0);return ri=ds=null,et.H=T,et.A=I,ma=g,Nn!==null?0:(za=null,jn=0,il(),ui)}function p_(){for(;Nn!==null&&!Et();)m_(Nn)}function m_(i){var c=Hs(i.alternate,i,Bu);i.memoizedProps=i.pendingProps,c===null?i0(i):Nn=c}function g_(i){var c=i,g=c.alternate;switch(c.tag){case 15:case 0:c=Jg(g,c,c.pendingProps,c.type,void 0,jn);break;case 11:c=Jg(g,c,c.pendingProps,c.type.render,c.ref,jn);break;case 5:dc(c);default:Zp(g,c),c=Nn=Qe(c,Bu),c=Hs(g,c,Bu)}i.memoizedProps=i.pendingProps,c===null?i0(i):Nn=c}function td(i,c,g,T){ri=ds=null,dc(c),Fl=null,Eu=0;var I=c.return;try{if(zp(i,I,c,g,jn)){ui=1,pl(i,Vr(g,i.current)),Nn=null;return}}catch(L){if(I!==null)throw Nn=I,L;ui=1,pl(i,Vr(g,i.current)),Nn=null;return}c.flags&32768?(Nr||T===1?i=!0:wh||(jn&536870912)!==0?i=!1:(Vl=i=!0,(T===2||T===9||T===3||T===6)&&(T=Rr.current,T!==null&&T.tag===13&&(T.flags|=16384))),__(c,i)):i0(c)}function i0(i){var c=i;do{if((c.flags&32768)!==0){__(c,Vl);return}i=c.return;var g=r_(c.alternate,c,Bu);if(g!==null){Nn=g;return}if(c=c.sibling,c!==null){Nn=c;return}Nn=c=i}while(c!==null);ui===0&&(ui=5)}function __(i,c){do{var g=Vx(i.alternate,i);if(g!==null){g.flags&=32767,Nn=g;return}if(g=i.return,g!==null&&(g.flags|=32768,g.subtreeFlags=0,g.deletions=null),!c&&(i=i.sibling,i!==null)){Nn=i;return}Nn=i=g}while(i!==null);ui=6,Nn=null}function x_(i,c,g,T,I,L,ae,Ae,ut){i.cancelPendingCommit=null;do s0();while(Hi!==0);if((ma&6)!==0)throw Error(f(327));if(c!==null){if(c===i.current)throw Error(f(177));if(L=c.lanes|c.childLanes,L|=al,tn(i,g,L,ae,Ae,ut),i===za&&(Nn=za=null,jn=0),Kf=c,Uu=i,Gl=g,wm=L,e0=I,f_=T,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,S_(he,function(){return T_(),null})):(i.callbackNode=null,i.callbackPriority=0),T=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||T){T=et.T,et.T=null,I=He.p,He.p=2,ae=ma,ma|=4;try{Gx(i,c,g)}finally{ma=ae,He.p=I,et.T=T}}Hi=1,y_(),v_(),b_()}}function y_(){if(Hi===1){Hi=0;var i=Uu,c=Kf,g=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||g){g=et.T,et.T=null;var T=He.p;He.p=2;var I=ma;ma|=4;try{Yp(c,i);var L=Bm,ae=oh(i.containerInfo),Ae=L.focusedElem,ut=L.selectionRange;if(ae!==Ae&&Ae&&Ae.ownerDocument&&sh(Ae.ownerDocument.documentElement,Ae)){if(ut!==null&&_u(Ae)){var Lt=ut.start,er=ut.end;if(er===void 0&&(er=Lt),"selectionStart"in Ae)Ae.selectionStart=Lt,Ae.selectionEnd=Math.min(er,Ae.value.length);else{var sr=Ae.ownerDocument||document,Ot=sr&&sr.defaultView||window;if(Ot.getSelection){var qt=Ot.getSelection(),$r=Ae.textContent.length,on=Math.min(ut.start,$r),Sa=ut.end===void 0?on:Math.min(ut.end,$r);!qt.extend&&on>Sa&&(ae=Sa,Sa=on,on=ae);var wt=gu(Ae,on),mt=gu(Ae,Sa);if(wt&&mt&&(qt.rangeCount!==1||qt.anchorNode!==wt.node||qt.anchorOffset!==wt.offset||qt.focusNode!==mt.node||qt.focusOffset!==mt.offset)){var Pt=sr.createRange();Pt.setStart(wt.node,wt.offset),qt.removeAllRanges(),on>Sa?(qt.addRange(Pt),qt.extend(mt.node,mt.offset)):(Pt.setEnd(mt.node,mt.offset),qt.addRange(Pt))}}}}for(sr=[],qt=Ae;qt=qt.parentNode;)qt.nodeType===1&&sr.push({element:qt,left:qt.scrollLeft,top:qt.scrollTop});for(typeof Ae.focus=="function"&&Ae.focus(),Ae=0;Ae<sr.length;Ae++){var nr=sr[Ae];nr.element.scrollLeft=nr.left,nr.element.scrollTop=nr.top}}cp=!!Qd,Bm=Qd=null}finally{ma=I,He.p=T,et.T=g}}i.current=c,Hi=2}}function v_(){if(Hi===2){Hi=0;var i=Uu,c=Kf,g=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||g){g=et.T,et.T=null;var T=He.p;He.p=2;var I=ma;ma|=4;try{gm(i,c.alternate,c)}finally{ma=I,He.p=T,et.T=g}}Hi=3}}function b_(){if(Hi===4||Hi===3){Hi=0,lr();var i=Uu,c=Kf,g=Gl,T=f_;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?Hi=5:(Hi=0,Kf=Uu=null,w_(i,i.pendingLanes));var I=i.pendingLanes;if(I===0&&(ju=null),Qt(g),c=c.stateNode,it&&typeof it.onCommitFiberRoot=="function")try{it.onCommitFiberRoot(ot,c,void 0,(c.current.flags&128)===128)}catch{}if(T!==null){c=et.T,I=He.p,He.p=2,et.T=null;try{for(var L=i.onRecoverableError,ae=0;ae<T.length;ae++){var Ae=T[ae];L(Ae.value,{componentStack:Ae.stack})}}finally{et.T=c,He.p=I}}(Gl&3)!==0&&s0(),xc(i),I=i.pendingLanes,(g&261930)!==0&&(I&42)!==0?i===Tm?Zd++:(Zd=0,Tm=i):Zd=0,gl(0)}}function w_(i,c){(i.pooledCacheLanes&=c)===0&&(c=i.pooledCache,c!=null&&(i.pooledCache=null,Pl(c)))}function s0(){return y_(),v_(),b_(),T_()}function T_(){if(Hi!==5)return!1;var i=Uu,c=wm;wm=0;var g=Qt(Gl),T=et.T,I=He.p;try{He.p=32>g?32:g,et.T=null,g=e0,e0=null;var L=Uu,ae=Gl;if(Hi=0,Kf=Uu=null,Gl=0,(ma&6)!==0)throw Error(f(331));var Ae=ma;if(ma|=4,c_(L.current),xm(L,L.current,ae,g),ma=Ae,gl(0,!1),it&&typeof it.onPostCommitFiberRoot=="function")try{it.onPostCommitFiberRoot(ot,L)}catch{}return!0}finally{He.p=I,et.T=T,w_(i,c)}}function Am(i,c,g){c=Vr(g,c),c=of(i.stateNode,c,2),i=cc(i,c,2),i!==null&&(zn(i,2),xc(i))}function ga(i,c,g){if(i.tag===3)Am(i,i,g);else for(;c!==null;){if(c.tag===3){Am(c,i,g);break}else if(c.tag===1){var T=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof T.componentDidCatch=="function"&&(ju===null||!ju.has(T))){i=Vr(g,i),g=lf(2),T=cc(c,g,2),T!==null&&(cf(g,T,c,i),zn(T,2),xc(T));break}}c=c.return}}function o0(i,c,g){var T=i.pingCache;if(T===null){T=i.pingCache=new u_;var I=new Set;T.set(c,I)}else I=T.get(c),I===void 0&&(I=new Set,T.set(c,I));I.has(g)||(ym=!0,I.add(g),i=Sh.bind(null,i,c,g),c.then(i,i))}function Sh(i,c,g){var T=i.pingCache;T!==null&&T.delete(c),i.pingedLanes|=i.suspendedLanes&g,i.warmLanes&=~g,za===i&&(jn&g)===g&&(ui===4||ui===3&&(jn&62914560)===jn&&300>pr()-Qp?(ma&2)===0&&Qf(i,0):vm|=g,pf===jn&&(pf=0)),xc(i)}function Xd(i,c){c===0&&(c=Ln()),i=Ns(i,c),i!==null&&(zn(i,c),xc(i))}function km(i){var c=i.memoizedState,g=0;c!==null&&(g=c.retryLane),Xd(i,g)}function Zx(i,c){var g=0;switch(i.tag){case 31:case 13:var T=i.stateNode,I=i.memoizedState;I!==null&&(g=I.retryLane);break;case 19:T=i.stateNode;break;case 22:T=i.stateNode._retryCache;break;default:throw Error(f(314))}T!==null&&T.delete(c),Xd(i,g)}function S_(i,c){return Jt(i,c)}var l0=null,rd=null,Cm=!1,c0=!1,Mm=!1,Vu=0;function xc(i){i!==rd&&i.next===null&&(rd===null?l0=rd=i:rd=rd.next=i),c0=!0,Cm||(Cm=!0,Rm())}function gl(i,c){if(!Mm&&c0){Mm=!0;do for(var g=!1,T=l0;T!==null;){if(i!==0){var I=T.pendingLanes;if(I===0)var L=0;else{var ae=T.suspendedLanes,Ae=T.pingedLanes;L=(1<<31-zt(42|i)+1)-1,L&=I&~(ae&~Ae),L=L&201326741?L&201326741|1:L?L|2:0}L!==0&&(g=!0,Yd(T,L))}else L=jn,L=En(T,T===za?L:0,T.cancelPendingCommit!==null||T.timeoutHandle!==-1),(L&3)===0||Kn(T,L)||(g=!0,Yd(T,L));T=T.next}while(g);Mm=!1}}function Eh(){Dm()}function Dm(){c0=Cm=!1;var i=0;Vu!==0&&y0()&&(i=Vu);for(var c=pr(),g=null,T=l0;T!==null;){var I=T.next,L=u0(T,c);L===0?(T.next=null,g===null?l0=I:g.next=I,I===null&&(rd=g)):(g=T,(i!==0||(L&3)!==0)&&(c0=!0)),T=I}Hi!==0&&Hi!==5||gl(i),Vu!==0&&(Vu=0)}function u0(i,c){for(var g=i.suspendedLanes,T=i.pingedLanes,I=i.expirationTimes,L=i.pendingLanes&-62914561;0<L;){var ae=31-zt(L),Ae=1<<ae,ut=I[ae];ut===-1?((Ae&g)===0||(Ae&T)!==0)&&(I[ae]=Qr(Ae,c)):ut<=c&&(i.expiredLanes|=Ae),L&=~Ae}if(c=za,g=jn,g=En(i,i===c?g:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),T=i.callbackNode,g===0||i===c&&(Ta===2||Ta===9)||i.cancelPendingCommit!==null)return T!==null&&T!==null&&Kt(T),i.callbackNode=null,i.callbackPriority=0;if((g&3)===0||Kn(i,g)){if(c=g&-g,c===i.callbackPriority)return c;switch(T!==null&&Kt(T),Qt(g)){case 2:case 8:g=fe;break;case 32:g=he;break;case 268435456:g=Ve;break;default:g=he}return T=E_.bind(null,i),g=Jt(g,T),i.callbackPriority=c,i.callbackNode=g,c}return T!==null&&T!==null&&Kt(T),i.callbackPriority=2,i.callbackNode=null,2}function E_(i,c){if(Hi!==0&&Hi!==5)return i.callbackNode=null,i.callbackPriority=0,null;var g=i.callbackNode;if(s0()&&i.callbackNode!==g)return null;var T=jn;return T=En(i,i===za?T:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),T===0?null:(ki(i,T,c),u0(i,pr()),i.callbackNode!=null&&i.callbackNode===g?E_.bind(null,i):null)}function Yd(i,c){if(s0())return null;ki(i,c,!0)}function Rm(){Vm(function(){(ma&6)!==0?Jt(st,Eh):Dm()})}function Im(){if(Vu===0){var i=oc;i===0&&(i=Kr,Kr<<=1,(Kr&261888)===0&&(Kr=256)),Vu=i}return Vu}function h0(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:ln(""+i)}function f0(i,c){var g=c.ownerDocument.createElement("input");return g.name=c.name,g.value=c.value,i.id&&g.setAttribute("form",i.id),c.parentNode.insertBefore(g,c),i=new FormData(i),g.parentNode.removeChild(g),i}function nd(i,c,g,T,I){if(c==="submit"&&g&&g.stateNode===I){var L=h0((I[Te]||null).action),ae=T.submitter;ae&&(c=(c=ae[Te]||null)?h0(c.formAction):ae.getAttribute("formAction"),c!==null&&(L=c,ae=null));var Ae=new Rc("action","action",null,T,I);i.push({event:Ae,listeners:[{instance:null,listener:function(){if(T.defaultPrevented){if(Vu!==0){var ut=ae?f0(I,ae):new FormData(I);Xa(g,{pending:!0,data:ut,method:I.method,action:L},null,ut)}}else typeof L=="function"&&(Ae.preventDefault(),ut=ae?f0(I,ae):new FormData(I),Xa(g,{pending:!0,data:ut,method:I.method,action:L},L,ut))},currentTarget:I}]})}}for(var d0=0;d0<ic.length;d0++){var p0=ic[d0],Pm=p0.toLowerCase(),A_=p0[0].toUpperCase()+p0.slice(1);hs(Pm,"on"+A_)}hs(nl,"onAnimationEnd"),hs(yu,"onAnimationIteration"),hs(ch,"onAnimationStart"),hs("dblclick","onDoubleClick"),hs("focusin","onFocus"),hs("focusout","onBlur"),hs(ac,"onTransitionRun"),hs(vu,"onTransitionStart"),hs(jc,"onTransitionCancel"),hs(gi,"onTransitionEnd"),Mi("onMouseEnter",["mouseout","mouseover"]),Mi("onMouseLeave",["mouseout","mouseover"]),Mi("onPointerEnter",["pointerout","pointerover"]),Mi("onPointerLeave",["pointerout","pointerover"]),Zr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Zr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Zr("onBeforeInput",["compositionend","keypress","textInput","paste"]),Zr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Zr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Zr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ah="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),k_=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ah));function C_(i,c){c=(c&4)!==0;for(var g=0;g<i.length;g++){var T=i[g],I=T.event;T=T.listeners;e:{var L=void 0;if(c)for(var ae=T.length-1;0<=ae;ae--){var Ae=T[ae],ut=Ae.instance,Lt=Ae.currentTarget;if(Ae=Ae.listener,ut!==L&&I.isPropagationStopped())break e;L=Ae,I.currentTarget=Lt;try{L(I)}catch(er){ts(er)}I.currentTarget=null,L=ut}else for(ae=0;ae<T.length;ae++){if(Ae=T[ae],ut=Ae.instance,Lt=Ae.currentTarget,Ae=Ae.listener,ut!==L&&I.isPropagationStopped())break e;L=Ae,I.currentTarget=Lt;try{L(I)}catch(er){ts(er)}I.currentTarget=null,L=ut}}}}function Un(i,c){var g=c[gt];g===void 0&&(g=c[gt]=new Set);var T=i+"__bubble";g.has(T)||(g0(c,i,2,!1),g.add(T))}function Fm(i,c,g){var T=0;c&&(T|=4),g0(g,i,T,c)}var m0="_reactListening"+Math.random().toString(36).slice(2);function Lm(i){if(!i[m0]){i[m0]=!0,Tn.forEach(function(g){g!=="selectionchange"&&(k_.has(g)||Fm(g,!1,i),Fm(g,!0,i))});var c=i.nodeType===9?i:i.ownerDocument;c===null||c[m0]||(c[m0]=!0,Fm("selectionchange",!1,c))}}function g0(i,c,g,T){switch(xf(c)){case 2:var I=up;break;case 8:I=V_;break;default:I=tg}g=I.bind(null,c,g,i),I=void 0,!Ri||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(I=!0),T?I!==void 0?i.addEventListener(c,g,{capture:!0,passive:I}):i.addEventListener(c,g,!0):I!==void 0?i.addEventListener(c,g,{passive:I}):i.addEventListener(c,g,!1)}function Jc(i,c,g,T,I){var L=T;if((c&1)===0&&(c&2)===0&&T!==null)e:for(;;){if(T===null)return;var ae=T.tag;if(ae===3||ae===4){var Ae=T.stateNode.containerInfo;if(Ae===I)break;if(ae===4)for(ae=T.return;ae!==null;){var ut=ae.tag;if((ut===3||ut===4)&&ae.stateNode.containerInfo===I)return;ae=ae.return}for(;Ae!==null;){if(ae=yr(Ae),ae===null)return;if(ut=ae.tag,ut===5||ut===6||ut===26||ut===27){T=L=ae;continue e}Ae=Ae.parentNode}}T=T.return}Jn(function(){var Lt=L,er=Dc(g),sr=[];e:{var Ot=uh.get(i);if(Ot!==void 0){var qt=Rc,$r=i;switch(i){case"keypress":if(Ea(g)===0)break e;case"keydown":case"keyup":qt=ua;break;case"focusin":$r="focus",qt=Jo;break;case"focusout":$r="blur",qt=Jo;break;case"beforeblur":case"afterblur":qt=Jo;break;case"click":if(g.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":qt=ls;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":qt=Cl;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":qt=na;break;case nl:case yu:case ch:qt=Ic;break;case gi:qt=Zn;break;case"scroll":case"scrollend":qt=xo;break;case"wheel":qt=Kl;break;case"copy":case"cut":case"paste":qt=du;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":qt=Pc;break;case"toggle":case"beforetoggle":qt=Js}var on=(c&4)!==0,Sa=!on&&(i==="scroll"||i==="scrollend"),wt=on?Ot!==null?Ot+"Capture":null:Ot;on=[];for(var mt=Lt,Pt;mt!==null;){var nr=mt;if(Pt=nr.stateNode,nr=nr.tag,nr!==5&&nr!==26&&nr!==27||Pt===null||wt===null||(nr=os(mt,wt),nr!=null&&on.push(ad(mt,nr,Pt))),Sa)break;mt=mt.return}0<on.length&&(Ot=new qt(Ot,$r,null,g,er),sr.push({event:Ot,listeners:on}))}}if((c&7)===0){e:{if(Ot=i==="mouseover"||i==="pointerover",qt=i==="mouseout"||i==="pointerout",Ot&&g!==nh&&($r=g.relatedTarget||g.fromElement)&&(yr($r)||$r[Pe]))break e;if((qt||Ot)&&(Ot=er.window===er?er:(Ot=er.ownerDocument)?Ot.defaultView||Ot.parentWindow:window,qt?($r=g.relatedTarget||g.toElement,qt=Lt,$r=$r?yr($r):null,$r!==null&&(Sa=b($r),on=$r.tag,$r!==Sa||on!==5&&on!==27&&on!==6)&&($r=null)):(qt=null,$r=Lt),qt!==$r)){if(on=ls,nr="onMouseLeave",wt="onMouseEnter",mt="mouse",(i==="pointerout"||i==="pointerover")&&(on=Pc,nr="onPointerLeave",wt="onPointerEnter",mt="pointer"),Sa=qt==null?Ot:fr(qt),Pt=$r==null?Ot:fr($r),Ot=new on(nr,mt+"leave",qt,g,er),Ot.target=Sa,Ot.relatedTarget=Pt,nr=null,yr(er)===Lt&&(on=new on(wt,mt+"enter",$r,g,er),on.target=Pt,on.relatedTarget=Sa,nr=on),Sa=nr,qt&&$r)t:{for(on=M_,wt=qt,mt=$r,Pt=0,nr=wt;nr;nr=on(nr))Pt++;nr=0;for(var an=mt;an;an=on(an))nr++;for(;0<Pt-nr;)wt=on(wt),Pt--;for(;0<nr-Pt;)mt=on(mt),nr--;for(;Pt--;){if(wt===mt||mt!==null&&wt===mt.alternate){on=wt;break t}wt=on(wt),mt=on(mt)}on=null}else on=null;qt!==null&&zm(sr,Ot,qt,on,!1),$r!==null&&Sa!==null&&zm(sr,Sa,$r,on,!0)}}e:{if(Ot=Lt?fr(Lt):window,qt=Ot.nodeName&&Ot.nodeName.toLowerCase(),qt==="select"||qt==="input"&&Ot.type==="file")var sa=Os;else if(Ia(Ot))if(ws)sa=ih;else{sa=Oc;var Xr=Pf}else qt=Ot.nodeName,!qt||qt.toLowerCase()!=="input"||Ot.type!=="checkbox"&&Ot.type!=="radio"?Lt&&Yo(Lt.elementType)&&(sa=Os):sa=Bs;if(sa&&(sa=sa(i,Lt))){Qs(sr,sa,g,er);break e}Xr&&Xr(i,Ot,Lt),i==="focusout"&&Lt&&Ot.type==="number"&&Lt.memoizedProps.value!=null&&hu(Ot,"number",Ot.value)}switch(Xr=Lt?fr(Lt):window,i){case"focusin":(Ia(Xr)||Xr.contentEditable==="true")&&(es=Xr,nc=Lt,Bc=null);break;case"focusout":Bc=nc=es=null;break;case"mousedown":Nc=!0;break;case"contextmenu":case"mouseup":case"dragend":Nc=!1,lh(sr,g,er);break;case"selectionchange":if(xu)break;case"keydown":case"keyup":lh(sr,g,er)}var rn;if(wa)e:{switch(i){case"compositionstart":var On="onCompositionStart";break e;case"compositionend":On="onCompositionEnd";break e;case"compositionupdate":On="onCompositionUpdate";break e}On=void 0}else us?rl(i,g)&&(On="onCompositionEnd"):i==="keydown"&&g.keyCode===229&&(On="onCompositionStart");On&&(vo&&g.locale!=="ko"&&(us||On!=="onCompositionStart"?On==="onCompositionEnd"&&us&&(rn=kl()):(ei=er,mi="value"in ei?ei.value:ei.textContent,us=!0)),Xr=Kd(Lt,On),0<Xr.length&&(On=new $l(On,i,null,g,er),sr.push({event:On,listeners:Xr}),rn?On.data=rn:(rn=ah(g),rn!==null&&(On.data=rn)))),(rn=ec?pu(i,g):qh(i,g))&&(On=Kd(Lt,"onBeforeInput"),0<On.length&&(Xr=new $l("onBeforeInput","beforeinput",null,g,er),sr.push({event:Xr,listeners:On}),Xr.data=rn)),nd(sr,i,Lt,g,er)}C_(sr,c)})}function ad(i,c,g){return{instance:i,listener:c,currentTarget:g}}function Kd(i,c){for(var g=c+"Capture",T=[];i!==null;){var I=i,L=I.stateNode;if(I=I.tag,I!==5&&I!==26&&I!==27||L===null||(I=os(i,g),I!=null&&T.unshift(ad(i,I,L)),I=os(i,c),I!=null&&T.push(ad(i,I,L))),i.tag===3)return T;i=i.return}return[]}function M_(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function zm(i,c,g,T,I){for(var L=c._reactName,ae=[];g!==null&&g!==T;){var Ae=g,ut=Ae.alternate,Lt=Ae.stateNode;if(Ae=Ae.tag,ut!==null&&ut===T)break;Ae!==5&&Ae!==26&&Ae!==27||Lt===null||(ut=Lt,I?(Lt=os(g,L),Lt!=null&&ae.unshift(ad(g,Lt,ut))):I||(Lt=os(g,L),Lt!=null&&ae.push(ad(g,Lt,ut)))),g=g.return}ae.length!==0&&i.push({event:c,listeners:ae})}var D_=/\r\n?/g,R_=/\u0000|\uFFFD/g;function Jd(i){return(typeof i=="string"?i:""+i).replace(D_,`
`).replace(R_,"")}function Om(i,c){return c=Jd(c),Jd(i)===c}function ia(i,c,g,T,I,L){switch(g){case"children":typeof T=="string"?c==="body"||c==="textarea"&&T===""||go(i,T):(typeof T=="number"||typeof T=="bigint")&&c!=="body"&&go(i,""+T);break;case"className":wi(i,"class",T);break;case"tabIndex":wi(i,"tabindex",T);break;case"dir":case"role":case"viewBox":case"width":case"height":wi(i,g,T);break;case"style":fu(i,T,L);break;case"data":if(c!=="object"){wi(i,"data",T);break}case"src":case"href":if(T===""&&(c!=="a"||g!=="href")){i.removeAttribute(g);break}if(T==null||typeof T=="function"||typeof T=="symbol"||typeof T=="boolean"){i.removeAttribute(g);break}T=ln(""+T),i.setAttribute(g,T);break;case"action":case"formAction":if(typeof T=="function"){i.setAttribute(g,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof L=="function"&&(g==="formAction"?(c!=="input"&&ia(i,c,"name",I.name,I,null),ia(i,c,"formEncType",I.formEncType,I,null),ia(i,c,"formMethod",I.formMethod,I,null),ia(i,c,"formTarget",I.formTarget,I,null)):(ia(i,c,"encType",I.encType,I,null),ia(i,c,"method",I.method,I,null),ia(i,c,"target",I.target,I,null)));if(T==null||typeof T=="symbol"||typeof T=="boolean"){i.removeAttribute(g);break}T=ln(""+T),i.setAttribute(g,T);break;case"onClick":T!=null&&(i.onclick=_o);break;case"onScroll":T!=null&&Un("scroll",i);break;case"onScrollEnd":T!=null&&Un("scrollend",i);break;case"dangerouslySetInnerHTML":if(T!=null){if(typeof T!="object"||!("__html"in T))throw Error(f(61));if(g=T.__html,g!=null){if(I.children!=null)throw Error(f(60));i.innerHTML=g}}break;case"multiple":i.multiple=T&&typeof T!="function"&&typeof T!="symbol";break;case"muted":i.muted=T&&typeof T!="function"&&typeof T!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(T==null||typeof T=="function"||typeof T=="boolean"||typeof T=="symbol"){i.removeAttribute("xlink:href");break}g=ln(""+T),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",g);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":T!=null&&typeof T!="function"&&typeof T!="symbol"?i.setAttribute(g,""+T):i.removeAttribute(g);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":T&&typeof T!="function"&&typeof T!="symbol"?i.setAttribute(g,""):i.removeAttribute(g);break;case"capture":case"download":T===!0?i.setAttribute(g,""):T!==!1&&T!=null&&typeof T!="function"&&typeof T!="symbol"?i.setAttribute(g,T):i.removeAttribute(g);break;case"cols":case"rows":case"size":case"span":T!=null&&typeof T!="function"&&typeof T!="symbol"&&!isNaN(T)&&1<=T?i.setAttribute(g,T):i.removeAttribute(g);break;case"rowSpan":case"start":T==null||typeof T=="function"||typeof T=="symbol"||isNaN(T)?i.removeAttribute(g):i.setAttribute(g,T);break;case"popover":Un("beforetoggle",i),Un("toggle",i),Di(i,"popover",T);break;case"xlinkActuate":bs(i,"http://www.w3.org/1999/xlink","xlink:actuate",T);break;case"xlinkArcrole":bs(i,"http://www.w3.org/1999/xlink","xlink:arcrole",T);break;case"xlinkRole":bs(i,"http://www.w3.org/1999/xlink","xlink:role",T);break;case"xlinkShow":bs(i,"http://www.w3.org/1999/xlink","xlink:show",T);break;case"xlinkTitle":bs(i,"http://www.w3.org/1999/xlink","xlink:title",T);break;case"xlinkType":bs(i,"http://www.w3.org/1999/xlink","xlink:type",T);break;case"xmlBase":bs(i,"http://www.w3.org/XML/1998/namespace","xml:base",T);break;case"xmlLang":bs(i,"http://www.w3.org/XML/1998/namespace","xml:lang",T);break;case"xmlSpace":bs(i,"http://www.w3.org/XML/1998/namespace","xml:space",T);break;case"is":Di(i,"is",T);break;case"innerText":case"textContent":break;default:(!(2<g.length)||g[0]!=="o"&&g[0]!=="O"||g[1]!=="n"&&g[1]!=="N")&&(g=Al.get(g)||g,Di(i,g,T))}}function _0(i,c,g,T,I,L){switch(g){case"style":fu(i,T,L);break;case"dangerouslySetInnerHTML":if(T!=null){if(typeof T!="object"||!("__html"in T))throw Error(f(61));if(g=T.__html,g!=null){if(I.children!=null)throw Error(f(60));i.innerHTML=g}}break;case"children":typeof T=="string"?go(i,T):(typeof T=="number"||typeof T=="bigint")&&go(i,""+T);break;case"onScroll":T!=null&&Un("scroll",i);break;case"onScrollEnd":T!=null&&Un("scrollend",i);break;case"onClick":T!=null&&(i.onclick=_o);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!vn.hasOwnProperty(g))e:{if(g[0]==="o"&&g[1]==="n"&&(I=g.endsWith("Capture"),c=g.slice(2,I?g.length-7:void 0),L=i[Te]||null,L=L!=null?L[g]:null,typeof L=="function"&&i.removeEventListener(c,L,I),typeof T=="function")){typeof L!="function"&&L!==null&&(g in i?i[g]=null:i.hasAttribute(g)&&i.removeAttribute(g)),i.addEventListener(c,T,I);break e}g in i?i[g]=T:T===!0?i.setAttribute(g,""):Di(i,g,T)}}}function is(i,c,g){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Un("error",i),Un("load",i);var T=!1,I=!1,L;for(L in g)if(g.hasOwnProperty(L)){var ae=g[L];if(ae!=null)switch(L){case"src":T=!0;break;case"srcSet":I=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(f(137,c));default:ia(i,c,L,ae,g,null)}}I&&ia(i,c,"srcSet",g.srcSet,g,null),T&&ia(i,c,"src",g.src,g,null);return;case"input":Un("invalid",i);var Ae=L=ae=I=null,ut=null,Lt=null;for(T in g)if(g.hasOwnProperty(T)){var er=g[T];if(er!=null)switch(T){case"name":I=er;break;case"type":ae=er;break;case"checked":ut=er;break;case"defaultChecked":Lt=er;break;case"value":L=er;break;case"defaultValue":Ae=er;break;case"children":case"dangerouslySetInnerHTML":if(er!=null)throw Error(f(137,c));break;default:ia(i,c,T,er,g,null)}}Wl(i,L,Ae,ut,Lt,ae,I,!1);return;case"select":Un("invalid",i),T=ae=L=null;for(I in g)if(g.hasOwnProperty(I)&&(Ae=g[I],Ae!=null))switch(I){case"value":L=Ae;break;case"defaultValue":ae=Ae;break;case"multiple":T=Ae;default:ia(i,c,I,Ae,g,null)}c=L,g=ae,i.multiple=!!T,c!=null?mo(i,!!T,c,!1):g!=null&&mo(i,!!T,g,!0);return;case"textarea":Un("invalid",i),L=I=T=null;for(ae in g)if(g.hasOwnProperty(ae)&&(Ae=g[ae],Ae!=null))switch(ae){case"value":T=Ae;break;case"defaultValue":I=Ae;break;case"children":L=Ae;break;case"dangerouslySetInnerHTML":if(Ae!=null)throw Error(f(91));break;default:ia(i,c,ae,Ae,g,null)}$o(i,T,I,L);return;case"option":for(ut in g)g.hasOwnProperty(ut)&&(T=g[ut],T!=null)&&(ut==="selected"?i.selected=T&&typeof T!="function"&&typeof T!="symbol":ia(i,c,ut,T,g,null));return;case"dialog":Un("beforetoggle",i),Un("toggle",i),Un("cancel",i),Un("close",i);break;case"iframe":case"object":Un("load",i);break;case"video":case"audio":for(T=0;T<Ah.length;T++)Un(Ah[T],i);break;case"image":Un("error",i),Un("load",i);break;case"details":Un("toggle",i);break;case"embed":case"source":case"link":Un("error",i),Un("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Lt in g)if(g.hasOwnProperty(Lt)&&(T=g[Lt],T!=null))switch(Lt){case"children":case"dangerouslySetInnerHTML":throw Error(f(137,c));default:ia(i,c,Lt,T,g,null)}return;default:if(Yo(c)){for(er in g)g.hasOwnProperty(er)&&(T=g[er],T!==void 0&&_0(i,c,er,T,g,void 0));return}}for(Ae in g)g.hasOwnProperty(Ae)&&(T=g[Ae],T!=null&&ia(i,c,Ae,T,g,null))}function I_(i,c,g,T){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var I=null,L=null,ae=null,Ae=null,ut=null,Lt=null,er=null;for(qt in g){var sr=g[qt];if(g.hasOwnProperty(qt)&&sr!=null)switch(qt){case"checked":break;case"value":break;case"defaultValue":ut=sr;default:T.hasOwnProperty(qt)||ia(i,c,qt,null,T,sr)}}for(var Ot in T){var qt=T[Ot];if(sr=g[Ot],T.hasOwnProperty(Ot)&&(qt!=null||sr!=null))switch(Ot){case"type":L=qt;break;case"name":I=qt;break;case"checked":Lt=qt;break;case"defaultChecked":er=qt;break;case"value":ae=qt;break;case"defaultValue":Ae=qt;break;case"children":case"dangerouslySetInnerHTML":if(qt!=null)throw Error(f(137,c));break;default:qt!==sr&&ia(i,c,Ot,qt,T,sr)}}Mc(i,ae,Ae,ut,Lt,er,L,I);return;case"select":qt=ae=Ae=Ot=null;for(L in g)if(ut=g[L],g.hasOwnProperty(L)&&ut!=null)switch(L){case"value":break;case"multiple":qt=ut;default:T.hasOwnProperty(L)||ia(i,c,L,null,T,ut)}for(I in T)if(L=T[I],ut=g[I],T.hasOwnProperty(I)&&(L!=null||ut!=null))switch(I){case"value":Ot=L;break;case"defaultValue":Ae=L;break;case"multiple":ae=L;default:L!==ut&&ia(i,c,I,L,T,ut)}c=Ae,g=ae,T=qt,Ot!=null?mo(i,!!g,Ot,!1):!!T!=!!g&&(c!=null?mo(i,!!g,c,!0):mo(i,!!g,g?[]:"",!1));return;case"textarea":qt=Ot=null;for(Ae in g)if(I=g[Ae],g.hasOwnProperty(Ae)&&I!=null&&!T.hasOwnProperty(Ae))switch(Ae){case"value":break;case"children":break;default:ia(i,c,Ae,null,T,I)}for(ae in T)if(I=T[ae],L=g[ae],T.hasOwnProperty(ae)&&(I!=null||L!=null))switch(ae){case"value":Ot=I;break;case"defaultValue":qt=I;break;case"children":break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(f(91));break;default:I!==L&&ia(i,c,ae,I,T,L)}Df(i,Ot,qt);return;case"option":for(var $r in g)Ot=g[$r],g.hasOwnProperty($r)&&Ot!=null&&!T.hasOwnProperty($r)&&($r==="selected"?i.selected=!1:ia(i,c,$r,null,T,Ot));for(ut in T)Ot=T[ut],qt=g[ut],T.hasOwnProperty(ut)&&Ot!==qt&&(Ot!=null||qt!=null)&&(ut==="selected"?i.selected=Ot&&typeof Ot!="function"&&typeof Ot!="symbol":ia(i,c,ut,Ot,T,qt));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var on in g)Ot=g[on],g.hasOwnProperty(on)&&Ot!=null&&!T.hasOwnProperty(on)&&ia(i,c,on,null,T,Ot);for(Lt in T)if(Ot=T[Lt],qt=g[Lt],T.hasOwnProperty(Lt)&&Ot!==qt&&(Ot!=null||qt!=null))switch(Lt){case"children":case"dangerouslySetInnerHTML":if(Ot!=null)throw Error(f(137,c));break;default:ia(i,c,Lt,Ot,T,qt)}return;default:if(Yo(c)){for(var Sa in g)Ot=g[Sa],g.hasOwnProperty(Sa)&&Ot!==void 0&&!T.hasOwnProperty(Sa)&&_0(i,c,Sa,void 0,T,Ot);for(er in T)Ot=T[er],qt=g[er],!T.hasOwnProperty(er)||Ot===qt||Ot===void 0&&qt===void 0||_0(i,c,er,Ot,T,qt);return}}for(var wt in g)Ot=g[wt],g.hasOwnProperty(wt)&&Ot!=null&&!T.hasOwnProperty(wt)&&ia(i,c,wt,null,T,Ot);for(sr in T)Ot=T[sr],qt=g[sr],!T.hasOwnProperty(sr)||Ot===qt||Ot==null&&qt==null||ia(i,c,sr,Ot,T,qt)}function Oo(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function id(){if(typeof performance.getEntriesByType=="function"){for(var i=0,c=0,g=performance.getEntriesByType("resource"),T=0;T<g.length;T++){var I=g[T],L=I.transferSize,ae=I.initiatorType,Ae=I.duration;if(L&&Ae&&Oo(ae)){for(ae=0,Ae=I.responseEnd,T+=1;T<g.length;T++){var ut=g[T],Lt=ut.startTime;if(Lt>Ae)break;var er=ut.transferSize,sr=ut.initiatorType;er&&Oo(sr)&&(ut=ut.responseEnd,ae+=er*(ut<Ae?1:(Ae-Lt)/(ut-Lt)))}if(--T,c+=8*(L+ae)/(I.duration/1e3),i++,10<i)break}}if(0<i)return c/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var Qd=null,Bm=null;function ep(i){return i.nodeType===9?i:i.ownerDocument}function kh(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Nm(i,c){if(i===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&c==="foreignObject"?0:i}function x0(i,c){return i==="textarea"||i==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var Ch=null;function y0(){var i=window.event;return i&&i.type==="popstate"?i===Ch?!1:(Ch=i,!0):(Ch=null,!1)}var v0=typeof setTimeout=="function"?setTimeout:void 0,jm=typeof clearTimeout=="function"?clearTimeout:void 0,Um=typeof Promise=="function"?Promise:void 0,Vm=typeof queueMicrotask=="function"?queueMicrotask:typeof Um<"u"?function(i){return Um.resolve(null).then(i).catch(Gm)}:v0;function Gm(i){setTimeout(function(){throw i})}function Mh(i){return i==="head"}function P_(i,c){var g=c,T=0;do{var I=g.nextSibling;if(i.removeChild(g),I&&I.nodeType===8)if(g=I.data,g==="/$"||g==="/&"){if(T===0){i.removeChild(I),Lh(c);return}T--}else if(g==="$"||g==="$?"||g==="$~"||g==="$!"||g==="&")T++;else if(g==="html")sd(i.ownerDocument.documentElement);else if(g==="head"){g=i.ownerDocument.head,sd(g);for(var L=g.firstChild;L;){var ae=L.nextSibling,Ae=L.nodeName;L[_t]||Ae==="SCRIPT"||Ae==="STYLE"||Ae==="LINK"&&L.rel.toLowerCase()==="stylesheet"||g.removeChild(L),L=ae}}else g==="body"&&sd(i.ownerDocument.body);g=I}while(g);Lh(c)}function An(i,c){var g=i;i=0;do{var T=g.nextSibling;if(g.nodeType===1?c?(g._stashedDisplay=g.style.display,g.style.display="none"):(g.style.display=g._stashedDisplay||"",g.getAttribute("style")===""&&g.removeAttribute("style")):g.nodeType===3&&(c?(g._stashedText=g.nodeValue,g.nodeValue=""):g.nodeValue=g._stashedText||""),T&&T.nodeType===8)if(g=T.data,g==="/$"){if(i===0)break;i--}else g!=="$"&&g!=="$?"&&g!=="$~"&&g!=="$!"||i++;g=T}while(g)}function yc(i){var c=i.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var g=c;switch(c=c.nextSibling,g.nodeName){case"HTML":case"HEAD":case"BODY":yc(g),or(g);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(g.rel.toLowerCase()==="stylesheet")continue}i.removeChild(g)}}function ps(i,c,g,T){for(;i.nodeType===1;){var I=g;if(i.nodeName.toLowerCase()!==c.toLowerCase()){if(!T&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(T){if(!i[_t])switch(c){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(L=i.getAttribute("rel"),L==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(L!==I.rel||i.getAttribute("href")!==(I.href==null||I.href===""?null:I.href)||i.getAttribute("crossorigin")!==(I.crossOrigin==null?null:I.crossOrigin)||i.getAttribute("title")!==(I.title==null?null:I.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(L=i.getAttribute("src"),(L!==(I.src==null?null:I.src)||i.getAttribute("type")!==(I.type==null?null:I.type)||i.getAttribute("crossorigin")!==(I.crossOrigin==null?null:I.crossOrigin))&&L&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(c==="input"&&i.type==="hidden"){var L=I.name==null?null:""+I.name;if(I.type==="hidden"&&i.getAttribute("name")===L)return i}else return i;if(i=_l(i.nextSibling),i===null)break}return null}function vc(i,c,g){if(c==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!g||(i=_l(i.nextSibling),i===null))return null;return i}function Dh(i,c){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!c||(i=_l(i.nextSibling),i===null))return null;return i}function qs(i){return i.data==="$?"||i.data==="$~"}function xi(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function qi(i,c){var g=i.ownerDocument;if(i.data==="$~")i._reactRetry=c;else if(i.data!=="$?"||g.readyState!=="loading")c();else{var T=function(){c(),g.removeEventListener("DOMContentLoaded",T)};g.addEventListener("DOMContentLoaded",T),i._reactRetry=T}}function _l(i){for(;i!=null;i=i.nextSibling){var c=i.nodeType;if(c===1||c===3)break;if(c===8){if(c=i.data,c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"||c==="F!"||c==="F")break;if(c==="/$"||c==="/&")return null}}return i}var co=null;function Zi(i){i=i.nextSibling;for(var c=0;i;){if(i.nodeType===8){var g=i.data;if(g==="/$"||g==="/&"){if(c===0)return _l(i.nextSibling);c--}else g!=="$"&&g!=="$!"&&g!=="$?"&&g!=="$~"&&g!=="&"||c++}i=i.nextSibling}return null}function tp(i){i=i.previousSibling;for(var c=0;i;){if(i.nodeType===8){var g=i.data;if(g==="$"||g==="$!"||g==="$?"||g==="$~"||g==="&"){if(c===0)return i;c--}else g!=="/$"&&g!=="/&"||c++}i=i.previousSibling}return null}function F_(i,c,g){switch(c=ep(g),i){case"html":if(i=c.documentElement,!i)throw Error(f(452));return i;case"head":if(i=c.head,!i)throw Error(f(453));return i;case"body":if(i=c.body,!i)throw Error(f(454));return i;default:throw Error(f(451))}}function sd(i){for(var c=i.attributes;c.length;)i.removeAttributeNode(c[0]);or(i)}var ms=new Map,gf=new Set;function b0(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Qc=He.d;He.d={f:L_,r:z_,D:qm,C:Zs,L:bc,m:Ws,X:w0,S:Ih,M:Zm};function L_(){var i=Qc.f(),c=Wd();return i||c}function z_(i){var c=vr(i);c!==null&&c.tag===5&&c.type==="form"?ji(c):Qc.r(i)}var Rh=typeof document>"u"?null:document;function Hm(i,c,g){var T=Rh;if(T&&typeof c=="string"&&c){var I=Na(c);I='link[rel="'+i+'"][href="'+I+'"]',typeof g=="string"&&(I+='[crossorigin="'+g+'"]'),gf.has(I)||(gf.add(I),i={rel:i,crossOrigin:g,href:c},T.querySelector(I)===null&&(c=T.createElement("link"),is(c,"link",i),Ur(c),T.head.appendChild(c)))}}function qm(i){Qc.D(i),Hm("dns-prefetch",i,null)}function Zs(i,c){Qc.C(i,c),Hm("preconnect",i,c)}function bc(i,c,g){Qc.L(i,c,g);var T=Rh;if(T&&i&&c){var I='link[rel="preload"][as="'+Na(c)+'"]';c==="image"&&g&&g.imageSrcSet?(I+='[imagesrcset="'+Na(g.imageSrcSet)+'"]',typeof g.imageSizes=="string"&&(I+='[imagesizes="'+Na(g.imageSizes)+'"]')):I+='[href="'+Na(i)+'"]';var L=I;switch(c){case"style":L=_f(i);break;case"script":L=Gu(i)}ms.has(L)||(i=B({rel:"preload",href:c==="image"&&g&&g.imageSrcSet?void 0:i,as:c},g),ms.set(L,i),T.querySelector(I)!==null||c==="style"&&T.querySelector(od(L))||c==="script"&&T.querySelector(ld(L))||(c=T.createElement("link"),is(c,"link",i),Ur(c),T.head.appendChild(c)))}}function Ws(i,c){Qc.m(i,c);var g=Rh;if(g&&i){var T=c&&typeof c.as=="string"?c.as:"script",I='link[rel="modulepreload"][as="'+Na(T)+'"][href="'+Na(i)+'"]',L=I;switch(T){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":L=Gu(i)}if(!ms.has(L)&&(i=B({rel:"modulepreload",href:i},c),ms.set(L,i),g.querySelector(I)===null)){switch(T){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(g.querySelector(ld(L)))return}T=g.createElement("link"),is(T,"link",i),Ur(T),g.head.appendChild(T)}}}function Ih(i,c,g){Qc.S(i,c,g);var T=Rh;if(T&&i){var I=_r(T).hoistableStyles,L=_f(i);c=c||"default";var ae=I.get(L);if(!ae){var Ae={loading:0,preload:null};if(ae=T.querySelector(od(L)))Ae.loading=5;else{i=B({rel:"stylesheet",href:i,"data-precedence":c},g),(g=ms.get(L))&&rp(i,g);var ut=ae=T.createElement("link");Ur(ut),is(ut,"link",i),ut._p=new Promise(function(Lt,er){ut.onload=Lt,ut.onerror=er}),ut.addEventListener("load",function(){Ae.loading|=1}),ut.addEventListener("error",function(){Ae.loading|=2}),Ae.loading|=4,Hu(ae,c,T)}ae={type:"stylesheet",instance:ae,count:1,state:Ae},I.set(L,ae)}}}function w0(i,c){Qc.X(i,c);var g=Rh;if(g&&i){var T=_r(g).hoistableScripts,I=Gu(i),L=T.get(I);L||(L=g.querySelector(ld(I)),L||(i=B({src:i,async:!0},c),(c=ms.get(I))&&T0(i,c),L=g.createElement("script"),Ur(L),is(L,"link",i),g.head.appendChild(L)),L={type:"script",instance:L,count:1,state:null},T.set(I,L))}}function Zm(i,c){Qc.M(i,c);var g=Rh;if(g&&i){var T=_r(g).hoistableScripts,I=Gu(i),L=T.get(I);L||(L=g.querySelector(ld(I)),L||(i=B({src:i,async:!0,type:"module"},c),(c=ms.get(I))&&T0(i,c),L=g.createElement("script"),Ur(L),is(L,"link",i),g.head.appendChild(L)),L={type:"script",instance:L,count:1,state:null},T.set(I,L))}}function Wm(i,c,g,T){var I=(I=bt.current)?b0(I):null;if(!I)throw Error(f(446));switch(i){case"meta":case"title":return null;case"style":return typeof g.precedence=="string"&&typeof g.href=="string"?(c=_f(g.href),g=_r(I).hoistableStyles,T=g.get(c),T||(T={type:"style",instance:null,count:0,state:null},g.set(c,T)),T):{type:"void",instance:null,count:0,state:null};case"link":if(g.rel==="stylesheet"&&typeof g.href=="string"&&typeof g.precedence=="string"){i=_f(g.href);var L=_r(I).hoistableStyles,ae=L.get(i);if(ae||(I=I.ownerDocument||I,ae={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},L.set(i,ae),(L=I.querySelector(od(i)))&&!L._p&&(ae.instance=L,ae.state.loading=5),ms.has(i)||(g={rel:"preload",as:"style",href:g.href,crossOrigin:g.crossOrigin,integrity:g.integrity,media:g.media,hrefLang:g.hrefLang,referrerPolicy:g.referrerPolicy},ms.set(i,g),L||Xm(I,i,g,ae.state))),c&&T===null)throw Error(f(528,""));return ae}if(c&&T!==null)throw Error(f(529,""));return null;case"script":return c=g.async,g=g.src,typeof g=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=Gu(g),g=_r(I).hoistableScripts,T=g.get(c),T||(T={type:"script",instance:null,count:0,state:null},g.set(c,T)),T):{type:"void",instance:null,count:0,state:null};default:throw Error(f(444,i))}}function _f(i){return'href="'+Na(i)+'"'}function od(i){return'link[rel="stylesheet"]['+i+"]"}function $m(i){return B({},i,{"data-precedence":i.precedence,precedence:null})}function Xm(i,c,g,T){i.querySelector('link[rel="preload"][as="style"]['+c+"]")?T.loading=1:(c=i.createElement("link"),T.preload=c,c.addEventListener("load",function(){return T.loading|=1}),c.addEventListener("error",function(){return T.loading|=2}),is(c,"link",g),Ur(c),i.head.appendChild(c))}function Gu(i){return'[src="'+Na(i)+'"]'}function ld(i){return"script[async]"+i}function Ym(i,c,g){if(c.count++,c.instance===null)switch(c.type){case"style":var T=i.querySelector('style[data-href~="'+Na(g.href)+'"]');if(T)return c.instance=T,Ur(T),T;var I=B({},g,{"data-href":g.href,"data-precedence":g.precedence,href:null,precedence:null});return T=(i.ownerDocument||i).createElement("style"),Ur(T),is(T,"style",I),Hu(T,g.precedence,i),c.instance=T;case"stylesheet":I=_f(g.href);var L=i.querySelector(od(I));if(L)return c.state.loading|=4,c.instance=L,Ur(L),L;T=$m(g),(I=ms.get(I))&&rp(T,I),L=(i.ownerDocument||i).createElement("link"),Ur(L);var ae=L;return ae._p=new Promise(function(Ae,ut){ae.onload=Ae,ae.onerror=ut}),is(L,"link",T),c.state.loading|=4,Hu(L,g.precedence,i),c.instance=L;case"script":return L=Gu(g.src),(I=i.querySelector(ld(L)))?(c.instance=I,Ur(I),I):(T=g,(I=ms.get(L))&&(T=B({},g),T0(T,I)),i=i.ownerDocument||i,I=i.createElement("script"),Ur(I),is(I,"link",T),i.head.appendChild(I),c.instance=I);case"void":return null;default:throw Error(f(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(T=c.instance,c.state.loading|=4,Hu(T,g.precedence,i));return c.instance}function Hu(i,c,g){for(var T=g.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),I=T.length?T[T.length-1]:null,L=I,ae=0;ae<T.length;ae++){var Ae=T[ae];if(Ae.dataset.precedence===c)L=Ae;else if(L!==I)break}L?L.parentNode.insertBefore(i,L.nextSibling):(c=g.nodeType===9?g.head:g,c.insertBefore(i,c.firstChild))}function rp(i,c){i.crossOrigin==null&&(i.crossOrigin=c.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=c.referrerPolicy),i.title==null&&(i.title=c.title)}function T0(i,c){i.crossOrigin==null&&(i.crossOrigin=c.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=c.referrerPolicy),i.integrity==null&&(i.integrity=c.integrity)}var S0=null;function Km(i,c,g){if(S0===null){var T=new Map,I=S0=new Map;I.set(g,T)}else I=S0,T=I.get(g),T||(T=new Map,I.set(g,T));if(T.has(i))return T;for(T.set(i,null),g=g.getElementsByTagName(i),I=0;I<g.length;I++){var L=g[I];if(!(L[_t]||L[Me]||i==="link"&&L.getAttribute("rel")==="stylesheet")&&L.namespaceURI!=="http://www.w3.org/2000/svg"){var ae=L.getAttribute(c)||"";ae=i+ae;var Ae=T.get(ae);Ae?Ae.push(L):T.set(ae,[L])}}return T}function np(i,c,g){i=i.ownerDocument||i,i.head.insertBefore(g,c==="title"?i.querySelector("head > title"):null)}function E0(i,c,g){if(g===1||c.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;return c.rel==="stylesheet"?(i=c.disabled,typeof c.precedence=="string"&&i==null):!0;case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function ap(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function Jm(i,c,g,T){if(g.type==="stylesheet"&&(typeof T.media!="string"||matchMedia(T.media).matches!==!1)&&(g.state.loading&4)===0){if(g.instance===null){var I=_f(T.href),L=c.querySelector(od(I));if(L){c=L._p,c!==null&&typeof c=="object"&&typeof c.then=="function"&&(i.count++,i=sp.bind(i),c.then(i,i)),g.state.loading|=4,g.instance=L,Ur(L);return}L=c.ownerDocument||c,T=$m(T),(I=ms.get(I))&&rp(T,I),L=L.createElement("link"),Ur(L);var ae=L;ae._p=new Promise(function(Ae,ut){ae.onload=Ae,ae.onerror=ut}),is(L,"link",T),g.instance=L}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(g,c),(c=g.state.preload)&&(g.state.loading&3)===0&&(i.count++,g=sp.bind(i),c.addEventListener("load",g),c.addEventListener("error",g))}}var ip=0;function Qm(i,c){return i.stylesheets&&i.count===0&&lp(i,i.stylesheets),0<i.count||0<i.imgCount?function(g){var T=setTimeout(function(){if(i.stylesheets&&lp(i,i.stylesheets),i.unsuspend){var L=i.unsuspend;i.unsuspend=null,L()}},6e4+c);0<i.imgBytes&&ip===0&&(ip=62500*id());var I=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&lp(i,i.stylesheets),i.unsuspend)){var L=i.unsuspend;i.unsuspend=null,L()}},(i.imgBytes>ip?50:800)+c);return i.unsuspend=g,function(){i.unsuspend=null,clearTimeout(T),clearTimeout(I)}}:null}function sp(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)lp(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var op=null;function lp(i,c){i.stylesheets=null,i.unsuspend!==null&&(i.count++,op=new Map,c.forEach(O_,i),op=null,sp.call(i))}function O_(i,c){if(!(c.state.loading&4)){var g=op.get(i);if(g)var T=g.get(null);else{g=new Map,op.set(i,g);for(var I=i.querySelectorAll("link[data-precedence],style[data-precedence]"),L=0;L<I.length;L++){var ae=I[L];(ae.nodeName==="LINK"||ae.getAttribute("media")!=="not all")&&(g.set(ae.dataset.precedence,ae),T=ae)}T&&g.set(null,T)}I=c.instance,ae=I.getAttribute("data-precedence"),L=g.get(ae)||T,L===T&&g.set(null,I),g.set(ae,I),this.count++,T=sp.bind(this),I.addEventListener("load",T),I.addEventListener("error",T),L?L.parentNode.insertBefore(I,L.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(I,i.firstChild)),c.state.loading|=4}}var cd={$$typeof:X,Provider:null,Consumer:null,_currentValue:$t,_currentValue2:$t,_threadCount:0};function Wx(i,c,g,T,I,L,ae,Ae,ut){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ba(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ba(0),this.hiddenUpdates=Ba(null),this.identifierPrefix=T,this.onUncaughtError=I,this.onCaughtError=L,this.onRecoverableError=ae,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ut,this.incompleteTransitions=new Map}function eg(i,c,g,T,I,L,ae,Ae,ut,Lt,er,sr){return i=new Wx(i,c,g,ae,ut,Lt,er,sr,Ae),c=1,L===!0&&(c|=24),L=As(3,null,null,c),i.current=L,L.stateNode=i,c=Eo(),c.refCount++,i.pooledCache=c,c.refCount++,L.memoizedState={element:T,isDehydrated:g,cache:c},jf(L),i}function B_(i){return i?(i=dn,i):dn}function N_(i,c,g,T,I,L){I=B_(I),T.context===null?T.context=I:T.pendingContext=I,T=Bl(c),T.payload={element:g},L=L===void 0?null:L,L!==null&&(T.callback=L),g=cc(i,T,c),g!==null&&(zo(g,i,c),ko(g,i,c))}function A0(i,c){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var g=i.retryLane;i.retryLane=g!==0&&g<c?g:c}}function k0(i,c){A0(i,c),(i=i.alternate)&&A0(i,c)}function j_(i){if(i.tag===13||i.tag===31){var c=Ns(i,67108864);c!==null&&zo(c,i,67108864),k0(i,67108864)}}function U_(i){if(i.tag===13||i.tag===31){var c=Lo();c=Zo(c);var g=Ns(i,c);g!==null&&zo(g,i,c),k0(i,c)}}var cp=!0;function up(i,c,g,T){var I=et.T;et.T=null;var L=He.p;try{He.p=2,tg(i,c,g,T)}finally{He.p=L,et.T=I}}function V_(i,c,g,T){var I=et.T;et.T=null;var L=He.p;try{He.p=8,tg(i,c,g,T)}finally{He.p=L,et.T=I}}function tg(i,c,g,T){if(cp){var I=hp(T);if(I===null)Jc(i,c,T,ud,g),G_(i,T);else if(Xx(I,i,c,g,T))T.stopPropagation();else if(G_(i,T),c&4&&-1<$x.indexOf(i)){for(;I!==null;){var L=vr(I);if(L!==null)switch(L.tag){case 3:if(L=L.stateNode,L.current.memoizedState.isDehydrated){var ae=ht(L.pendingLanes);if(ae!==0){var Ae=L;for(Ae.pendingLanes|=2,Ae.entangledLanes|=2;ae;){var ut=1<<31-zt(ae);Ae.entanglements[1]|=ut,ae&=~ut}xc(L),(ma&6)===0&&(qd=pr()+500,gl(0))}}break;case 31:case 13:Ae=Ns(L,2),Ae!==null&&zo(Ae,L,2),Wd(),k0(L,2)}if(L=hp(T),L===null&&Jc(i,c,T,ud,g),L===I)break;I=L}I!==null&&T.stopPropagation()}else Jc(i,c,T,null,g)}}function hp(i){return i=Dc(i),C0(i)}var ud=null;function C0(i){if(ud=null,i=yr(i),i!==null){var c=b(i);if(c===null)i=null;else{var g=c.tag;if(g===13){if(i=_(c),i!==null)return i;i=null}else if(g===31){if(i=s(c),i!==null)return i;i=null}else if(g===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;i=null}else c!==i&&(i=null)}}return ud=i,null}function xf(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ir()){case st:return 2;case fe:return 8;case he:case we:return 32;case Ve:return 268435456;default:return 32}default:return 32}}var M0=!1,Ph=null,Hl=null,Fh=null,fp=new Map,hd=new Map,qu=[],$x="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function G_(i,c){switch(i){case"focusin":case"focusout":Ph=null;break;case"dragenter":case"dragleave":Hl=null;break;case"mouseover":case"mouseout":Fh=null;break;case"pointerover":case"pointerout":fp.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":hd.delete(c.pointerId)}}function dp(i,c,g,T,I,L){return i===null||i.nativeEvent!==L?(i={blockedOn:c,domEventName:g,eventSystemFlags:T,nativeEvent:L,targetContainers:[I]},c!==null&&(c=vr(c),c!==null&&j_(c)),i):(i.eventSystemFlags|=T,c=i.targetContainers,I!==null&&c.indexOf(I)===-1&&c.push(I),i)}function Xx(i,c,g,T,I){switch(c){case"focusin":return Ph=dp(Ph,i,c,g,T,I),!0;case"dragenter":return Hl=dp(Hl,i,c,g,T,I),!0;case"mouseover":return Fh=dp(Fh,i,c,g,T,I),!0;case"pointerover":var L=I.pointerId;return fp.set(L,dp(fp.get(L)||null,i,c,g,T,I)),!0;case"gotpointercapture":return L=I.pointerId,hd.set(L,dp(hd.get(L)||null,i,c,g,T,I)),!0}return!1}function H_(i){var c=yr(i.target);if(c!==null){var g=b(c);if(g!==null){if(c=g.tag,c===13){if(c=_(g),c!==null){i.blockedOn=c,je(i.priority,function(){U_(g)});return}}else if(c===31){if(c=s(g),c!==null){i.blockedOn=c,je(i.priority,function(){U_(g)});return}}else if(c===3&&g.stateNode.current.memoizedState.isDehydrated){i.blockedOn=g.tag===3?g.stateNode.containerInfo:null;return}}}i.blockedOn=null}function pp(i){if(i.blockedOn!==null)return!1;for(var c=i.targetContainers;0<c.length;){var g=hp(i.nativeEvent);if(g===null){g=i.nativeEvent;var T=new g.constructor(g.type,g);nh=T,g.target.dispatchEvent(T),nh=null}else return c=vr(g),c!==null&&j_(c),i.blockedOn=g,!1;c.shift()}return!0}function q_(i,c,g){pp(i)&&g.delete(c)}function mp(){M0=!1,Ph!==null&&pp(Ph)&&(Ph=null),Hl!==null&&pp(Hl)&&(Hl=null),Fh!==null&&pp(Fh)&&(Fh=null),fp.forEach(q_),hd.forEach(q_)}function D0(i,c){i.blockedOn===c&&(i.blockedOn=null,M0||(M0=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,mp)))}var R0=null;function Z_(i){R0!==i&&(R0=i,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){R0===i&&(R0=null);for(var c=0;c<i.length;c+=3){var g=i[c],T=i[c+1],I=i[c+2];if(typeof T!="function"){if(C0(T||g)===null)continue;break}var L=vr(g);L!==null&&(i.splice(c,3),c-=3,Xa(L,{pending:!0,data:I,method:g.method,action:T},T,I))}}))}function Lh(i){function c(ut){return D0(ut,i)}Ph!==null&&D0(Ph,i),Hl!==null&&D0(Hl,i),Fh!==null&&D0(Fh,i),fp.forEach(c),hd.forEach(c);for(var g=0;g<qu.length;g++){var T=qu[g];T.blockedOn===i&&(T.blockedOn=null)}for(;0<qu.length&&(g=qu[0],g.blockedOn===null);)H_(g),g.blockedOn===null&&qu.shift();if(g=(i.ownerDocument||i).$$reactFormReplay,g!=null)for(T=0;T<g.length;T+=3){var I=g[T],L=g[T+1],ae=I[Te]||null;if(typeof L=="function")ae||Z_(g);else if(ae){var Ae=null;if(L&&L.hasAttribute("formAction")){if(I=L,ae=L[Te]||null)Ae=ae.formAction;else if(C0(I)!==null)continue}else Ae=ae.action;typeof Ae=="function"?g[T+1]=Ae:(g.splice(T,3),T-=3),Z_(g)}}}function rg(){function i(L){L.canIntercept&&L.info==="react-transition"&&L.intercept({handler:function(){return new Promise(function(ae){return I=ae})},focusReset:"manual",scroll:"manual"})}function c(){I!==null&&(I(),I=null),T||setTimeout(g,20)}function g(){if(!T&&!navigation.transition){var L=navigation.currentEntry;L&&L.url!=null&&navigation.navigate(L.url,{state:L.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var T=!1,I=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",c),navigation.addEventListener("navigateerror",c),setTimeout(g,100),function(){T=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",c),navigation.removeEventListener("navigateerror",c),I!==null&&(I(),I=null)}}}function ng(i){this._internalRoot=i}I0.prototype.render=ng.prototype.render=function(i){var c=this._internalRoot;if(c===null)throw Error(f(409));var g=c.current,T=Lo();N_(g,T,i,c,null,null)},I0.prototype.unmount=ng.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var c=i.containerInfo;N_(i.current,2,null,i,null,null),Wd(),c[Pe]=null}};function I0(i){this._internalRoot=i}I0.prototype.unstable_scheduleHydration=function(i){if(i){var c=ye();i={blockedOn:null,target:i,priority:c};for(var g=0;g<qu.length&&c!==0&&c<qu[g].priority;g++);qu.splice(g,0,i),g===0&&H_(i)}};var ag=u.version;if(ag!=="19.2.3")throw Error(f(527,ag,"19.2.3"));He.findDOMNode=function(i){var c=i._reactInternals;if(c===void 0)throw typeof i.render=="function"?Error(f(188)):(i=Object.keys(i).join(","),Error(f(268,i)));return i=M(c),i=i!==null?D(i):null,i=i===null?null:i.stateNode,i};var W_={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:et,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var P0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!P0.isDisabled&&P0.supportsFiber)try{ot=P0.inject(W_),it=P0}catch{}}return ug.createRoot=function(i,c){if(!p(i))throw Error(f(299));var g=!1,T="",I=Hf,L=pc,ae=mc;return c!=null&&(c.unstable_strictMode===!0&&(g=!0),c.identifierPrefix!==void 0&&(T=c.identifierPrefix),c.onUncaughtError!==void 0&&(I=c.onUncaughtError),c.onCaughtError!==void 0&&(L=c.onCaughtError),c.onRecoverableError!==void 0&&(ae=c.onRecoverableError)),c=eg(i,1,!1,null,null,g,T,null,I,L,ae,rg),i[Pe]=c.current,Lm(i),new ng(c)},ug.hydrateRoot=function(i,c,g){if(!p(i))throw Error(f(299));var T=!1,I="",L=Hf,ae=pc,Ae=mc,ut=null;return g!=null&&(g.unstable_strictMode===!0&&(T=!0),g.identifierPrefix!==void 0&&(I=g.identifierPrefix),g.onUncaughtError!==void 0&&(L=g.onUncaughtError),g.onCaughtError!==void 0&&(ae=g.onCaughtError),g.onRecoverableError!==void 0&&(Ae=g.onRecoverableError),g.formState!==void 0&&(ut=g.formState)),c=eg(i,1,!0,c,g??null,T,I,ut,L,ae,Ae,rg),c.context=B_(null),g=c.current,T=Lo(),T=Zo(T),I=Bl(T),I.callback=null,cc(g,I,T),g=T,c.current.lanes=g,zn(c,g),xc(c),i[Pe]=c.current,Lm(i),new I0(c)},ug.version="19.2.3",ug}var J1;function aT(){if(J1)return oy.exports;J1=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(u){console.error(u)}}return r(),oy.exports=nT(),oy.exports}var iT=aT();const sT=Fx(iT);var Q1="popstate";function oT(r={}){function u(f,p){let{pathname:b,search:_,hash:s}=f.location;return Iy("",{pathname:b,search:_,hash:s},p.state&&p.state.usr||null,p.state&&p.state.key||"default")}function l(f,p){return typeof p=="string"?p:Dg(p)}return cT(u,l,null,r)}function Ci(r,u){if(r===!1||r===null||typeof r>"u")throw new Error(u)}function jh(r,u){if(!r){typeof console<"u"&&console.warn(u);try{throw new Error(u)}catch{}}}function lT(){return Math.random().toString(36).substring(2,10)}function ev(r,u){return{usr:r.state,key:r.key,idx:u}}function Iy(r,u,l=null,f){return{pathname:typeof r=="string"?r:r.pathname,search:"",hash:"",...typeof u=="string"?em(u):u,state:l,key:u&&u.key||f||lT()}}function Dg({pathname:r="/",search:u="",hash:l=""}){return u&&u!=="?"&&(r+=u.charAt(0)==="?"?u:"?"+u),l&&l!=="#"&&(r+=l.charAt(0)==="#"?l:"#"+l),r}function em(r){let u={};if(r){let l=r.indexOf("#");l>=0&&(u.hash=r.substring(l),r=r.substring(0,l));let f=r.indexOf("?");f>=0&&(u.search=r.substring(f),r=r.substring(0,f)),r&&(u.pathname=r)}return u}function cT(r,u,l,f={}){let{window:p=document.defaultView,v5Compat:b=!1}=f,_=p.history,s="POP",C=null,M=D();M==null&&(M=0,_.replaceState({..._.state,idx:M},""));function D(){return(_.state||{idx:null}).idx}function B(){s="POP";let N=D(),Z=N==null?null:N-M;M=N,C&&C({action:s,location:O.location,delta:Z})}function U(N,Z){s="PUSH";let J=Iy(O.location,N,Z);M=D()+1;let X=ev(J,M),pe=O.createHref(J);try{_.pushState(X,"",pe)}catch(ge){if(ge instanceof DOMException&&ge.name==="DataCloneError")throw ge;p.location.assign(pe)}b&&C&&C({action:s,location:O.location,delta:1})}function j(N,Z){s="REPLACE";let J=Iy(O.location,N,Z);M=D();let X=ev(J,M),pe=O.createHref(J);_.replaceState(X,"",pe),b&&C&&C({action:s,location:O.location,delta:0})}function H(N){return uT(N)}let O={get action(){return s},get location(){return r(p,_)},listen(N){if(C)throw new Error("A history only accepts one active listener");return p.addEventListener(Q1,B),C=N,()=>{p.removeEventListener(Q1,B),C=null}},createHref(N){return u(p,N)},createURL:H,encodeLocation(N){let Z=H(N);return{pathname:Z.pathname,search:Z.search,hash:Z.hash}},push:U,replace:j,go(N){return _.go(N)}};return O}function uT(r,u=!1){let l="http://localhost";typeof window<"u"&&(l=window.location.origin!=="null"?window.location.origin:window.location.href),Ci(l,"No window.location.(origin|href) available to create URL");let f=typeof r=="string"?r:Dg(r);return f=f.replace(/ $/,"%20"),!u&&f.startsWith("//")&&(f=l+f),new URL(f,l)}function Sb(r,u,l="/"){return hT(r,u,l,!1)}function hT(r,u,l,f){let p=typeof u=="string"?em(u):u,b=Af(p.pathname||"/",l);if(b==null)return null;let _=Eb(r);fT(_);let s=null;for(let C=0;s==null&&C<_.length;++C){let M=TT(b);s=bT(_[C],M,f)}return s}function Eb(r,u=[],l=[],f="",p=!1){let b=(_,s,C=p,M)=>{let D={relativePath:M===void 0?_.path||"":M,caseSensitive:_.caseSensitive===!0,childrenIndex:s,route:_};if(D.relativePath.startsWith("/")){if(!D.relativePath.startsWith(f)&&C)return;Ci(D.relativePath.startsWith(f),`Absolute route path "${D.relativePath}" nested under path "${f}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),D.relativePath=D.relativePath.slice(f.length)}let B=Tf([f,D.relativePath]),U=l.concat(D);_.children&&_.children.length>0&&(Ci(_.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${B}".`),Eb(_.children,u,U,B,C)),!(_.path==null&&!_.index)&&u.push({path:B,score:yT(B,_.index),routesMeta:U})};return r.forEach((_,s)=>{if(_.path===""||!_.path?.includes("?"))b(_,s);else for(let C of Ab(_.path))b(_,s,!0,C)}),u}function Ab(r){let u=r.split("/");if(u.length===0)return[];let[l,...f]=u,p=l.endsWith("?"),b=l.replace(/\?$/,"");if(f.length===0)return p?[b,""]:[b];let _=Ab(f.join("/")),s=[];return s.push(..._.map(C=>C===""?b:[b,C].join("/"))),p&&s.push(..._),s.map(C=>r.startsWith("/")&&C===""?"/":C)}function fT(r){r.sort((u,l)=>u.score!==l.score?l.score-u.score:vT(u.routesMeta.map(f=>f.childrenIndex),l.routesMeta.map(f=>f.childrenIndex)))}var dT=/^:[\w-]+$/,pT=3,mT=2,gT=1,_T=10,xT=-2,tv=r=>r==="*";function yT(r,u){let l=r.split("/"),f=l.length;return l.some(tv)&&(f+=xT),u&&(f+=mT),l.filter(p=>!tv(p)).reduce((p,b)=>p+(dT.test(b)?pT:b===""?gT:_T),f)}function vT(r,u){return r.length===u.length&&r.slice(0,-1).every((f,p)=>f===u[p])?r[r.length-1]-u[u.length-1]:0}function bT(r,u,l=!1){let{routesMeta:f}=r,p={},b="/",_=[];for(let s=0;s<f.length;++s){let C=f[s],M=s===f.length-1,D=b==="/"?u:u.slice(b.length)||"/",B=yx({path:C.relativePath,caseSensitive:C.caseSensitive,end:M},D),U=C.route;if(!B&&M&&l&&!f[f.length-1].route.index&&(B=yx({path:C.relativePath,caseSensitive:C.caseSensitive,end:!1},D)),!B)return null;Object.assign(p,B.params),_.push({params:p,pathname:Tf([b,B.pathname]),pathnameBase:kT(Tf([b,B.pathnameBase])),route:U}),B.pathnameBase!=="/"&&(b=Tf([b,B.pathnameBase]))}return _}function yx(r,u){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[l,f]=wT(r.path,r.caseSensitive,r.end),p=u.match(l);if(!p)return null;let b=p[0],_=b.replace(/(.)\/+$/,"$1"),s=p.slice(1);return{params:f.reduce((M,{paramName:D,isOptional:B},U)=>{if(D==="*"){let H=s[U]||"";_=b.slice(0,b.length-H.length).replace(/(.)\/+$/,"$1")}const j=s[U];return B&&!j?M[D]=void 0:M[D]=(j||"").replace(/%2F/g,"/"),M},{}),pathname:b,pathnameBase:_,pattern:r}}function wT(r,u=!1,l=!0){jh(r==="*"||!r.endsWith("*")||r.endsWith("/*"),`Route path "${r}" will be treated as if it were "${r.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${r.replace(/\*$/,"/*")}".`);let f=[],p="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(_,s,C)=>(f.push({paramName:s,isOptional:C!=null}),C?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return r.endsWith("*")?(f.push({paramName:"*"}),p+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):l?p+="\\/*$":r!==""&&r!=="/"&&(p+="(?:(?=\\/|$))"),[new RegExp(p,u?void 0:"i"),f]}function TT(r){try{return r.split("/").map(u=>decodeURIComponent(u).replace(/\//g,"%2F")).join("/")}catch(u){return jh(!1,`The URL path "${r}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${u}).`),r}}function Af(r,u){if(u==="/")return r;if(!r.toLowerCase().startsWith(u.toLowerCase()))return null;let l=u.endsWith("/")?u.length-1:u.length,f=r.charAt(l);return f&&f!=="/"?null:r.slice(l)||"/"}var ST=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function ET(r,u="/"){let{pathname:l,search:f="",hash:p=""}=typeof r=="string"?em(r):r,b;return l?(l=l.replace(/\/\/+/g,"/"),l.startsWith("/")?b=rv(l.substring(1),"/"):b=rv(l,u)):b=u,{pathname:b,search:CT(f),hash:MT(p)}}function rv(r,u){let l=u.replace(/\/+$/,"").split("/");return r.split("/").forEach(p=>{p===".."?l.length>1&&l.pop():p!=="."&&l.push(p)}),l.length>1?l.join("/"):"/"}function hy(r,u,l,f){return`Cannot include a '${r}' character in a manually specified \`to.${u}\` field [${JSON.stringify(f)}].  Please separate it out to the \`to.${l}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function AT(r){return r.filter((u,l)=>l===0||u.route.path&&u.route.path.length>0)}function kb(r){let u=AT(r);return u.map((l,f)=>f===u.length-1?l.pathname:l.pathnameBase)}function Cb(r,u,l,f=!1){let p;typeof r=="string"?p=em(r):(p={...r},Ci(!p.pathname||!p.pathname.includes("?"),hy("?","pathname","search",p)),Ci(!p.pathname||!p.pathname.includes("#"),hy("#","pathname","hash",p)),Ci(!p.search||!p.search.includes("#"),hy("#","search","hash",p)));let b=r===""||p.pathname==="",_=b?"/":p.pathname,s;if(_==null)s=l;else{let B=u.length-1;if(!f&&_.startsWith("..")){let U=_.split("/");for(;U[0]==="..";)U.shift(),B-=1;p.pathname=U.join("/")}s=B>=0?u[B]:"/"}let C=ET(p,s),M=_&&_!=="/"&&_.endsWith("/"),D=(b||_===".")&&l.endsWith("/");return!C.pathname.endsWith("/")&&(M||D)&&(C.pathname+="/"),C}var Tf=r=>r.join("/").replace(/\/\/+/g,"/"),kT=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),CT=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,MT=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r,DT=class{constructor(r,u,l,f=!1){this.status=r,this.statusText=u||"",this.internal=f,l instanceof Error?(this.data=l.toString(),this.error=l):this.data=l}};function RT(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}function IT(r){return r.map(u=>u.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var Mb=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Db(r,u){let l=r;if(typeof l!="string"||!ST.test(l))return{absoluteURL:void 0,isExternal:!1,to:l};let f=l,p=!1;if(Mb)try{let b=new URL(window.location.href),_=l.startsWith("//")?new URL(b.protocol+l):new URL(l),s=Af(_.pathname,u);_.origin===b.origin&&s!=null?l=s+_.search+_.hash:p=!0}catch{jh(!1,`<Link to="${l}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:f,isExternal:p,to:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Rb=["POST","PUT","PATCH","DELETE"];new Set(Rb);var PT=["GET",...Rb];new Set(PT);var tm=ke.createContext(null);tm.displayName="DataRouter";var Lx=ke.createContext(null);Lx.displayName="DataRouterState";var FT=ke.createContext(!1),Ib=ke.createContext({isTransitioning:!1});Ib.displayName="ViewTransition";var LT=ke.createContext(new Map);LT.displayName="Fetchers";var zT=ke.createContext(null);zT.displayName="Await";var su=ke.createContext(null);su.displayName="Navigation";var jg=ke.createContext(null);jg.displayName="Location";var Cf=ke.createContext({outlet:null,matches:[],isDataRoute:!1});Cf.displayName="Route";var Yy=ke.createContext(null);Yy.displayName="RouteError";var Pb="REACT_ROUTER_ERROR",OT="REDIRECT",BT="ROUTE_ERROR_RESPONSE";function NT(r){if(r.startsWith(`${Pb}:${OT}:{`))try{let u=JSON.parse(r.slice(28));if(typeof u=="object"&&u&&typeof u.status=="number"&&typeof u.statusText=="string"&&typeof u.location=="string"&&typeof u.reloadDocument=="boolean"&&typeof u.replace=="boolean")return u}catch{}}function jT(r){if(r.startsWith(`${Pb}:${BT}:{`))try{let u=JSON.parse(r.slice(40));if(typeof u=="object"&&u&&typeof u.status=="number"&&typeof u.statusText=="string")return new DT(u.status,u.statusText,u.data)}catch{}}function UT(r,{relative:u}={}){Ci(Ug(),"useHref() may be used only in the context of a <Router> component.");let{basename:l,navigator:f}=ke.useContext(su),{hash:p,pathname:b,search:_}=Vg(r,{relative:u}),s=b;return l!=="/"&&(s=b==="/"?l:Tf([l,b])),f.createHref({pathname:s,search:_,hash:p})}function Ug(){return ke.useContext(jg)!=null}function kp(){return Ci(Ug(),"useLocation() may be used only in the context of a <Router> component."),ke.useContext(jg).location}var Fb="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Lb(r){ke.useContext(su).static||ke.useLayoutEffect(r)}function VT(){let{isDataRoute:r}=ke.useContext(Cf);return r?tS():GT()}function GT(){Ci(Ug(),"useNavigate() may be used only in the context of a <Router> component.");let r=ke.useContext(tm),{basename:u,navigator:l}=ke.useContext(su),{matches:f}=ke.useContext(Cf),{pathname:p}=kp(),b=JSON.stringify(kb(f)),_=ke.useRef(!1);return Lb(()=>{_.current=!0}),ke.useCallback((C,M={})=>{if(jh(_.current,Fb),!_.current)return;if(typeof C=="number"){l.go(C);return}let D=Cb(C,JSON.parse(b),p,M.relative==="path");r==null&&u!=="/"&&(D.pathname=D.pathname==="/"?u:Tf([u,D.pathname])),(M.replace?l.replace:l.push)(D,M.state,M)},[u,l,b,p,r])}ke.createContext(null);function Vg(r,{relative:u}={}){let{matches:l}=ke.useContext(Cf),{pathname:f}=kp(),p=JSON.stringify(kb(l));return ke.useMemo(()=>Cb(r,JSON.parse(p),f,u==="path"),[r,p,f,u])}function HT(r,u){return zb(r,u)}function zb(r,u,l,f,p){Ci(Ug(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:b}=ke.useContext(su),{matches:_}=ke.useContext(Cf),s=_[_.length-1],C=s?s.params:{},M=s?s.pathname:"/",D=s?s.pathnameBase:"/",B=s&&s.route;{let J=B&&B.path||"";Bb(M,!B||J.endsWith("*")||J.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${M}" (under <Route path="${J}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${J}"> to <Route path="${J==="/"?"*":`${J}/*`}">.`)}let U=kp(),j;if(u){let J=typeof u=="string"?em(u):u;Ci(D==="/"||J.pathname?.startsWith(D),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${D}" but pathname "${J.pathname}" was given in the \`location\` prop.`),j=J}else j=U;let H=j.pathname||"/",O=H;if(D!=="/"){let J=D.replace(/^\//,"").split("/");O="/"+H.replace(/^\//,"").split("/").slice(J.length).join("/")}let N=Sb(r,{pathname:O});jh(B||N!=null,`No routes matched location "${j.pathname}${j.search}${j.hash}" `),jh(N==null||N[N.length-1].route.element!==void 0||N[N.length-1].route.Component!==void 0||N[N.length-1].route.lazy!==void 0,`Matched leaf route at location "${j.pathname}${j.search}${j.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let Z=XT(N&&N.map(J=>Object.assign({},J,{params:Object.assign({},C,J.params),pathname:Tf([D,b.encodeLocation?b.encodeLocation(J.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:J.pathname]),pathnameBase:J.pathnameBase==="/"?D:Tf([D,b.encodeLocation?b.encodeLocation(J.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:J.pathnameBase])})),_,l,f,p);return u&&Z?ke.createElement(jg.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...j},navigationType:"POP"}},Z):Z}function qT(){let r=eS(),u=RT(r)?`${r.status} ${r.statusText}`:r instanceof Error?r.message:JSON.stringify(r),l=r instanceof Error?r.stack:null,f="rgba(200,200,200, 0.5)",p={padding:"0.5rem",backgroundColor:f},b={padding:"2px 4px",backgroundColor:f},_=null;return console.error("Error handled by React Router default ErrorBoundary:",r),_=ke.createElement(ke.Fragment,null,ke.createElement("p",null," Hey developer "),ke.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",ke.createElement("code",{style:b},"ErrorBoundary")," or"," ",ke.createElement("code",{style:b},"errorElement")," prop on your route.")),ke.createElement(ke.Fragment,null,ke.createElement("h2",null,"Unexpected Application Error!"),ke.createElement("h3",{style:{fontStyle:"italic"}},u),l?ke.createElement("pre",{style:p},l):null,_)}var ZT=ke.createElement(qT,null),Ob=class extends ke.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,u){return u.location!==r.location||u.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:u.error,location:u.location,revalidation:r.revalidation||u.revalidation}}componentDidCatch(r,u){this.props.onError?this.props.onError(r,u):console.error("React Router caught the following error during render",r)}render(){let r=this.state.error;if(this.context&&typeof r=="object"&&r&&"digest"in r&&typeof r.digest=="string"){const l=jT(r.digest);l&&(r=l)}let u=r!==void 0?ke.createElement(Cf.Provider,{value:this.props.routeContext},ke.createElement(Yy.Provider,{value:r,children:this.props.component})):this.props.children;return this.context?ke.createElement(WT,{error:r},u):u}};Ob.contextType=FT;var fy=new WeakMap;function WT({children:r,error:u}){let{basename:l}=ke.useContext(su);if(typeof u=="object"&&u&&"digest"in u&&typeof u.digest=="string"){let f=NT(u.digest);if(f){let p=fy.get(u);if(p)throw p;let b=Db(f.location,l);if(Mb&&!fy.get(u))if(b.isExternal||f.reloadDocument)window.location.href=b.absoluteURL||b.to;else{const _=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(b.to,{replace:f.replace}));throw fy.set(u,_),_}return ke.createElement("meta",{httpEquiv:"refresh",content:`0;url=${b.absoluteURL||b.to}`})}}return r}function $T({routeContext:r,match:u,children:l}){let f=ke.useContext(tm);return f&&f.static&&f.staticContext&&(u.route.errorElement||u.route.ErrorBoundary)&&(f.staticContext._deepestRenderedBoundaryId=u.route.id),ke.createElement(Cf.Provider,{value:r},l)}function XT(r,u=[],l=null,f=null,p=null){if(r==null){if(!l)return null;if(l.errors)r=l.matches;else if(u.length===0&&!l.initialized&&l.matches.length>0)r=l.matches;else return null}let b=r,_=l?.errors;if(_!=null){let D=b.findIndex(B=>B.route.id&&_?.[B.route.id]!==void 0);Ci(D>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(_).join(",")}`),b=b.slice(0,Math.min(b.length,D+1))}let s=!1,C=-1;if(l)for(let D=0;D<b.length;D++){let B=b[D];if((B.route.HydrateFallback||B.route.hydrateFallbackElement)&&(C=D),B.route.id){let{loaderData:U,errors:j}=l,H=B.route.loader&&!U.hasOwnProperty(B.route.id)&&(!j||j[B.route.id]===void 0);if(B.route.lazy||H){s=!0,C>=0?b=b.slice(0,C+1):b=[b[0]];break}}}let M=l&&f?(D,B)=>{f(D,{location:l.location,params:l.matches?.[0]?.params??{},unstable_pattern:IT(l.matches),errorInfo:B})}:void 0;return b.reduceRight((D,B,U)=>{let j,H=!1,O=null,N=null;l&&(j=_&&B.route.id?_[B.route.id]:void 0,O=B.route.errorElement||ZT,s&&(C<0&&U===0?(Bb("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),H=!0,N=null):C===U&&(H=!0,N=B.route.hydrateFallbackElement||null)));let Z=u.concat(b.slice(0,U+1)),J=()=>{let X;return j?X=O:H?X=N:B.route.Component?X=ke.createElement(B.route.Component,null):B.route.element?X=B.route.element:X=D,ke.createElement($T,{match:B,routeContext:{outlet:D,matches:Z,isDataRoute:l!=null},children:X})};return l&&(B.route.ErrorBoundary||B.route.errorElement||U===0)?ke.createElement(Ob,{location:l.location,revalidation:l.revalidation,component:O,error:j,children:J(),routeContext:{outlet:null,matches:Z,isDataRoute:!0},onError:M}):J()},null)}function Ky(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function YT(r){let u=ke.useContext(tm);return Ci(u,Ky(r)),u}function KT(r){let u=ke.useContext(Lx);return Ci(u,Ky(r)),u}function JT(r){let u=ke.useContext(Cf);return Ci(u,Ky(r)),u}function Jy(r){let u=JT(r),l=u.matches[u.matches.length-1];return Ci(l.route.id,`${r} can only be used on routes that contain a unique "id"`),l.route.id}function QT(){return Jy("useRouteId")}function eS(){let r=ke.useContext(Yy),u=KT("useRouteError"),l=Jy("useRouteError");return r!==void 0?r:u.errors?.[l]}function tS(){let{router:r}=YT("useNavigate"),u=Jy("useNavigate"),l=ke.useRef(!1);return Lb(()=>{l.current=!0}),ke.useCallback(async(p,b={})=>{jh(l.current,Fb),l.current&&(typeof p=="number"?await r.navigate(p):await r.navigate(p,{fromRouteId:u,...b}))},[r,u])}var nv={};function Bb(r,u,l){!u&&!nv[r]&&(nv[r]=!0,jh(!1,l))}ke.memo(rS);function rS({routes:r,future:u,state:l,onError:f}){return zb(r,void 0,l,f,u)}function fx(r){Ci(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function nS({basename:r="/",children:u=null,location:l,navigationType:f="POP",navigator:p,static:b=!1,unstable_useTransitions:_}){Ci(!Ug(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let s=r.replace(/^\/*/,"/"),C=ke.useMemo(()=>({basename:s,navigator:p,static:b,unstable_useTransitions:_,future:{}}),[s,p,b,_]);typeof l=="string"&&(l=em(l));let{pathname:M="/",search:D="",hash:B="",state:U=null,key:j="default"}=l,H=ke.useMemo(()=>{let O=Af(M,s);return O==null?null:{location:{pathname:O,search:D,hash:B,state:U,key:j},navigationType:f}},[s,M,D,B,U,j,f]);return jh(H!=null,`<Router basename="${s}"> is not able to match the URL "${M}${D}${B}" because it does not start with the basename, so the <Router> won't render anything.`),H==null?null:ke.createElement(su.Provider,{value:C},ke.createElement(jg.Provider,{children:u,value:H}))}function aS({children:r,location:u}){return HT(Py(r),u)}function Py(r,u=[]){let l=[];return ke.Children.forEach(r,(f,p)=>{if(!ke.isValidElement(f))return;let b=[...u,p];if(f.type===ke.Fragment){l.push.apply(l,Py(f.props.children,b));return}Ci(f.type===fx,`[${typeof f.type=="string"?f.type:f.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ci(!f.props.index||!f.props.children,"An index route cannot have child routes.");let _={id:f.props.id||b.join("-"),caseSensitive:f.props.caseSensitive,element:f.props.element,Component:f.props.Component,index:f.props.index,path:f.props.path,middleware:f.props.middleware,loader:f.props.loader,action:f.props.action,hydrateFallbackElement:f.props.hydrateFallbackElement,HydrateFallback:f.props.HydrateFallback,errorElement:f.props.errorElement,ErrorBoundary:f.props.ErrorBoundary,hasErrorBoundary:f.props.hasErrorBoundary===!0||f.props.ErrorBoundary!=null||f.props.errorElement!=null,shouldRevalidate:f.props.shouldRevalidate,handle:f.props.handle,lazy:f.props.lazy};f.props.children&&(_.children=Py(f.props.children,b)),l.push(_)}),l}var dx="get",px="application/x-www-form-urlencoded";function zx(r){return typeof HTMLElement<"u"&&r instanceof HTMLElement}function iS(r){return zx(r)&&r.tagName.toLowerCase()==="button"}function sS(r){return zx(r)&&r.tagName.toLowerCase()==="form"}function oS(r){return zx(r)&&r.tagName.toLowerCase()==="input"}function lS(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function cS(r,u){return r.button===0&&(!u||u==="_self")&&!lS(r)}var Y_=null;function uS(){if(Y_===null)try{new FormData(document.createElement("form"),0),Y_=!1}catch{Y_=!0}return Y_}var hS=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function dy(r){return r!=null&&!hS.has(r)?(jh(!1,`"${r}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${px}"`),null):r}function fS(r,u){let l,f,p,b,_;if(sS(r)){let s=r.getAttribute("action");f=s?Af(s,u):null,l=r.getAttribute("method")||dx,p=dy(r.getAttribute("enctype"))||px,b=new FormData(r)}else if(iS(r)||oS(r)&&(r.type==="submit"||r.type==="image")){let s=r.form;if(s==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let C=r.getAttribute("formaction")||s.getAttribute("action");if(f=C?Af(C,u):null,l=r.getAttribute("formmethod")||s.getAttribute("method")||dx,p=dy(r.getAttribute("formenctype"))||dy(s.getAttribute("enctype"))||px,b=new FormData(s,r),!uS()){let{name:M,type:D,value:B}=r;if(D==="image"){let U=M?`${M}.`:"";b.append(`${U}x`,"0"),b.append(`${U}y`,"0")}else M&&b.append(M,B)}}else{if(zx(r))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');l=dx,f=null,p=px,_=r}return b&&p==="text/plain"&&(_=b,b=void 0),{action:f,method:l.toLowerCase(),encType:p,formData:b,body:_}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Qy(r,u){if(r===!1||r===null||typeof r>"u")throw new Error(u)}function dS(r,u,l,f){let p=typeof r=="string"?new URL(r,typeof window>"u"?"server://singlefetch/":window.location.origin):r;return l?p.pathname.endsWith("/")?p.pathname=`${p.pathname}_.${f}`:p.pathname=`${p.pathname}.${f}`:p.pathname==="/"?p.pathname=`_root.${f}`:u&&Af(p.pathname,u)==="/"?p.pathname=`${u.replace(/\/$/,"")}/_root.${f}`:p.pathname=`${p.pathname.replace(/\/$/,"")}.${f}`,p}async function pS(r,u){if(r.id in u)return u[r.id];try{let l=await import(r.module);return u[r.id]=l,l}catch(l){return console.error(`Error loading route module \`${r.module}\`, reloading page...`),console.error(l),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function mS(r){return r==null?!1:r.href==null?r.rel==="preload"&&typeof r.imageSrcSet=="string"&&typeof r.imageSizes=="string":typeof r.rel=="string"&&typeof r.href=="string"}async function gS(r,u,l){let f=await Promise.all(r.map(async p=>{let b=u.routes[p.route.id];if(b){let _=await pS(b,l);return _.links?_.links():[]}return[]}));return vS(f.flat(1).filter(mS).filter(p=>p.rel==="stylesheet"||p.rel==="preload").map(p=>p.rel==="stylesheet"?{...p,rel:"prefetch",as:"style"}:{...p,rel:"prefetch"}))}function av(r,u,l,f,p,b){let _=(C,M)=>l[M]?C.route.id!==l[M].route.id:!0,s=(C,M)=>l[M].pathname!==C.pathname||l[M].route.path?.endsWith("*")&&l[M].params["*"]!==C.params["*"];return b==="assets"?u.filter((C,M)=>_(C,M)||s(C,M)):b==="data"?u.filter((C,M)=>{let D=f.routes[C.route.id];if(!D||!D.hasLoader)return!1;if(_(C,M)||s(C,M))return!0;if(C.route.shouldRevalidate){let B=C.route.shouldRevalidate({currentUrl:new URL(p.pathname+p.search+p.hash,window.origin),currentParams:l[0]?.params||{},nextUrl:new URL(r,window.origin),nextParams:C.params,defaultShouldRevalidate:!0});if(typeof B=="boolean")return B}return!0}):[]}function _S(r,u,{includeHydrateFallback:l}={}){return xS(r.map(f=>{let p=u.routes[f.route.id];if(!p)return[];let b=[p.module];return p.clientActionModule&&(b=b.concat(p.clientActionModule)),p.clientLoaderModule&&(b=b.concat(p.clientLoaderModule)),l&&p.hydrateFallbackModule&&(b=b.concat(p.hydrateFallbackModule)),p.imports&&(b=b.concat(p.imports)),b}).flat(1))}function xS(r){return[...new Set(r)]}function yS(r){let u={},l=Object.keys(r).sort();for(let f of l)u[f]=r[f];return u}function vS(r,u){let l=new Set;return new Set(u),r.reduce((f,p)=>{let b=JSON.stringify(yS(p));return l.has(b)||(l.add(b),f.push({key:b,link:p})),f},[])}function Nb(){let r=ke.useContext(tm);return Qy(r,"You must render this element inside a <DataRouterContext.Provider> element"),r}function bS(){let r=ke.useContext(Lx);return Qy(r,"You must render this element inside a <DataRouterStateContext.Provider> element"),r}var e1=ke.createContext(void 0);e1.displayName="FrameworkContext";function jb(){let r=ke.useContext(e1);return Qy(r,"You must render this element inside a <HydratedRouter> element"),r}function wS(r,u){let l=ke.useContext(e1),[f,p]=ke.useState(!1),[b,_]=ke.useState(!1),{onFocus:s,onBlur:C,onMouseEnter:M,onMouseLeave:D,onTouchStart:B}=u,U=ke.useRef(null);ke.useEffect(()=>{if(r==="render"&&_(!0),r==="viewport"){let O=Z=>{Z.forEach(J=>{_(J.isIntersecting)})},N=new IntersectionObserver(O,{threshold:.5});return U.current&&N.observe(U.current),()=>{N.disconnect()}}},[r]),ke.useEffect(()=>{if(f){let O=setTimeout(()=>{_(!0)},100);return()=>{clearTimeout(O)}}},[f]);let j=()=>{p(!0)},H=()=>{p(!1),_(!1)};return l?r!=="intent"?[b,U,{}]:[b,U,{onFocus:hg(s,j),onBlur:hg(C,H),onMouseEnter:hg(M,j),onMouseLeave:hg(D,H),onTouchStart:hg(B,j)}]:[!1,U,{}]}function hg(r,u){return l=>{r&&r(l),l.defaultPrevented||u(l)}}function TS({page:r,...u}){let{router:l}=Nb(),f=ke.useMemo(()=>Sb(l.routes,r,l.basename),[l.routes,r,l.basename]);return f?ke.createElement(ES,{page:r,matches:f,...u}):null}function SS(r){let{manifest:u,routeModules:l}=jb(),[f,p]=ke.useState([]);return ke.useEffect(()=>{let b=!1;return gS(r,u,l).then(_=>{b||p(_)}),()=>{b=!0}},[r,u,l]),f}function ES({page:r,matches:u,...l}){let f=kp(),{future:p,manifest:b,routeModules:_}=jb(),{basename:s}=Nb(),{loaderData:C,matches:M}=bS(),D=ke.useMemo(()=>av(r,u,M,b,f,"data"),[r,u,M,b,f]),B=ke.useMemo(()=>av(r,u,M,b,f,"assets"),[r,u,M,b,f]),U=ke.useMemo(()=>{if(r===f.pathname+f.search+f.hash)return[];let O=new Set,N=!1;if(u.forEach(J=>{let X=b.routes[J.route.id];!X||!X.hasLoader||(!D.some(pe=>pe.route.id===J.route.id)&&J.route.id in C&&_[J.route.id]?.shouldRevalidate||X.hasClientLoader?N=!0:O.add(J.route.id))}),O.size===0)return[];let Z=dS(r,s,p.unstable_trailingSlashAwareDataRequests,"data");return N&&O.size>0&&Z.searchParams.set("_routes",u.filter(J=>O.has(J.route.id)).map(J=>J.route.id).join(",")),[Z.pathname+Z.search]},[s,p.unstable_trailingSlashAwareDataRequests,C,f,b,D,u,r,_]),j=ke.useMemo(()=>_S(B,b),[B,b]),H=SS(B);return ke.createElement(ke.Fragment,null,U.map(O=>ke.createElement("link",{key:O,rel:"prefetch",as:"fetch",href:O,...l})),j.map(O=>ke.createElement("link",{key:O,rel:"modulepreload",href:O,...l})),H.map(({key:O,link:N})=>ke.createElement("link",{key:O,nonce:l.nonce,...N,crossOrigin:N.crossOrigin??l.crossOrigin})))}function AS(...r){return u=>{r.forEach(l=>{typeof l=="function"?l(u):l!=null&&(l.current=u)})}}var kS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{kS&&(window.__reactRouterVersion="7.13.0")}catch{}function CS({basename:r,children:u,unstable_useTransitions:l,window:f}){let p=ke.useRef();p.current==null&&(p.current=oT({window:f,v5Compat:!0}));let b=p.current,[_,s]=ke.useState({action:b.action,location:b.location}),C=ke.useCallback(M=>{l===!1?s(M):ke.startTransition(()=>s(M))},[l]);return ke.useLayoutEffect(()=>b.listen(C),[b,C]),ke.createElement(nS,{basename:r,children:u,location:_.location,navigationType:_.action,navigator:b,unstable_useTransitions:l})}var Ub=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,G0=ke.forwardRef(function({onClick:u,discover:l="render",prefetch:f="none",relative:p,reloadDocument:b,replace:_,state:s,target:C,to:M,preventScrollReset:D,viewTransition:B,unstable_defaultShouldRevalidate:U,...j},H){let{basename:O,unstable_useTransitions:N}=ke.useContext(su),Z=typeof M=="string"&&Ub.test(M),J=Db(M,O);M=J.to;let X=UT(M,{relative:p}),[pe,ge,ve]=wS(f,j),re=IS(M,{replace:_,state:s,target:C,preventScrollReset:D,relative:p,viewTransition:B,unstable_defaultShouldRevalidate:U,unstable_useTransitions:N});function Ce(Ge){u&&u(Ge),Ge.defaultPrevented||re(Ge)}let xe=ke.createElement("a",{...j,...ve,href:J.absoluteURL||X,onClick:J.isExternal||b?u:Ce,ref:AS(H,ge),target:C,"data-discover":!Z&&l==="render"?"true":void 0});return pe&&!Z?ke.createElement(ke.Fragment,null,xe,ke.createElement(TS,{page:X})):xe});G0.displayName="Link";var MS=ke.forwardRef(function({"aria-current":u="page",caseSensitive:l=!1,className:f="",end:p=!1,style:b,to:_,viewTransition:s,children:C,...M},D){let B=Vg(_,{relative:M.relative}),U=kp(),j=ke.useContext(Lx),{navigator:H,basename:O}=ke.useContext(su),N=j!=null&&OS(B)&&s===!0,Z=H.encodeLocation?H.encodeLocation(B).pathname:B.pathname,J=U.pathname,X=j&&j.navigation&&j.navigation.location?j.navigation.location.pathname:null;l||(J=J.toLowerCase(),X=X?X.toLowerCase():null,Z=Z.toLowerCase()),X&&O&&(X=Af(X,O)||X);const pe=Z!=="/"&&Z.endsWith("/")?Z.length-1:Z.length;let ge=J===Z||!p&&J.startsWith(Z)&&J.charAt(pe)==="/",ve=X!=null&&(X===Z||!p&&X.startsWith(Z)&&X.charAt(Z.length)==="/"),re={isActive:ge,isPending:ve,isTransitioning:N},Ce=ge?u:void 0,xe;typeof f=="function"?xe=f(re):xe=[f,ge?"active":null,ve?"pending":null,N?"transitioning":null].filter(Boolean).join(" ");let Ge=typeof b=="function"?b(re):b;return ke.createElement(G0,{...M,"aria-current":Ce,className:xe,ref:D,style:Ge,to:_,viewTransition:s},typeof C=="function"?C(re):C)});MS.displayName="NavLink";var DS=ke.forwardRef(({discover:r="render",fetcherKey:u,navigate:l,reloadDocument:f,replace:p,state:b,method:_=dx,action:s,onSubmit:C,relative:M,preventScrollReset:D,viewTransition:B,unstable_defaultShouldRevalidate:U,...j},H)=>{let{unstable_useTransitions:O}=ke.useContext(su),N=LS(),Z=zS(s,{relative:M}),J=_.toLowerCase()==="get"?"get":"post",X=typeof s=="string"&&Ub.test(s),pe=ge=>{if(C&&C(ge),ge.defaultPrevented)return;ge.preventDefault();let ve=ge.nativeEvent.submitter,re=ve?.getAttribute("formmethod")||_,Ce=()=>N(ve||ge.currentTarget,{fetcherKey:u,method:re,navigate:l,replace:p,state:b,relative:M,preventScrollReset:D,viewTransition:B,unstable_defaultShouldRevalidate:U});O&&l!==!1?ke.startTransition(()=>Ce()):Ce()};return ke.createElement("form",{ref:H,method:J,action:Z,onSubmit:f?C:pe,...j,"data-discover":!X&&r==="render"?"true":void 0})});DS.displayName="Form";function RS(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Vb(r){let u=ke.useContext(tm);return Ci(u,RS(r)),u}function IS(r,{target:u,replace:l,state:f,preventScrollReset:p,relative:b,viewTransition:_,unstable_defaultShouldRevalidate:s,unstable_useTransitions:C}={}){let M=VT(),D=kp(),B=Vg(r,{relative:b});return ke.useCallback(U=>{if(cS(U,u)){U.preventDefault();let j=l!==void 0?l:Dg(D)===Dg(B),H=()=>M(r,{replace:j,state:f,preventScrollReset:p,relative:b,viewTransition:_,unstable_defaultShouldRevalidate:s});C?ke.startTransition(()=>H()):H()}},[D,M,B,l,f,u,r,p,b,_,s,C])}var PS=0,FS=()=>`__${String(++PS)}__`;function LS(){let{router:r}=Vb("useSubmit"),{basename:u}=ke.useContext(su),l=QT(),f=r.fetch,p=r.navigate;return ke.useCallback(async(b,_={})=>{let{action:s,method:C,encType:M,formData:D,body:B}=fS(b,u);if(_.navigate===!1){let U=_.fetcherKey||FS();await f(U,l,_.action||s,{unstable_defaultShouldRevalidate:_.unstable_defaultShouldRevalidate,preventScrollReset:_.preventScrollReset,formData:D,body:B,formMethod:_.method||C,formEncType:_.encType||M,flushSync:_.flushSync})}else await p(_.action||s,{unstable_defaultShouldRevalidate:_.unstable_defaultShouldRevalidate,preventScrollReset:_.preventScrollReset,formData:D,body:B,formMethod:_.method||C,formEncType:_.encType||M,replace:_.replace,state:_.state,fromRouteId:l,flushSync:_.flushSync,viewTransition:_.viewTransition})},[f,p,u,l])}function zS(r,{relative:u}={}){let{basename:l}=ke.useContext(su),f=ke.useContext(Cf);Ci(f,"useFormAction must be used inside a RouteContext");let[p]=f.matches.slice(-1),b={...Vg(r||".",{relative:u})},_=kp();if(r==null){b.search=_.search;let s=new URLSearchParams(b.search),C=s.getAll("index");if(C.some(D=>D==="")){s.delete("index"),C.filter(B=>B).forEach(B=>s.append("index",B));let D=s.toString();b.search=D?`?${D}`:""}}return(!r||r===".")&&p.route.index&&(b.search=b.search?b.search.replace(/^\?/,"?index&"):"?index"),l!=="/"&&(b.pathname=b.pathname==="/"?l:Tf([l,b.pathname])),Dg(b)}function OS(r,{relative:u}={}){let l=ke.useContext(Ib);Ci(l!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:f}=Vb("useViewTransitionState"),p=Vg(r,{relative:u});if(!l.isTransitioning)return!1;let b=Af(l.currentLocation.pathname,f)||l.currentLocation.pathname,_=Af(l.nextLocation.pathname,f)||l.nextLocation.pathname;return yx(p.pathname,_)!=null||yx(p.pathname,b)!=null}var Gb=1252,BS=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],t1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},r1=function(r){BS.indexOf(r)!=-1&&(Gb=t1[0]=r)};function NS(){r1(1252)}var eh=function(r){r1(r)};function Hb(){eh(1200),NS()}function iv(r){for(var u=[],l=0,f=r.length;l<f;++l)u[l]=r.charCodeAt(l);return u}function jS(r){for(var u=[],l=0;l<r.length>>1;++l)u[l]=String.fromCharCode(r.charCodeAt(2*l)+(r.charCodeAt(2*l+1)<<8));return u.join("")}function qb(r){for(var u=[],l=0;l<r.length>>1;++l)u[l]=String.fromCharCode(r.charCodeAt(2*l+1)+(r.charCodeAt(2*l)<<8));return u.join("")}var pg=function(r){var u=r.charCodeAt(0),l=r.charCodeAt(1);return u==255&&l==254?jS(r.slice(2)):u==254&&l==255?qb(r.slice(2)):u==65279?r.slice(1):r},K_=function(u){return String.fromCharCode(u)},sv=function(u){return String.fromCharCode(u)},Rg,yd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ov(r){for(var u="",l=0,f=0,p=0,b=0,_=0,s=0,C=0,M=0;M<r.length;)l=r.charCodeAt(M++),b=l>>2,f=r.charCodeAt(M++),_=(l&3)<<4|f>>4,p=r.charCodeAt(M++),s=(f&15)<<2|p>>6,C=p&63,isNaN(f)?s=C=64:isNaN(p)&&(C=64),u+=yd.charAt(b)+yd.charAt(_)+yd.charAt(s)+yd.charAt(C);return u}function Ac(r){var u="",l=0,f=0,p=0,b=0,_=0,s=0,C=0;r=r.replace(/[^\w\+\/\=]/g,"");for(var M=0;M<r.length;)b=yd.indexOf(r.charAt(M++)),_=yd.indexOf(r.charAt(M++)),l=b<<2|_>>4,u+=String.fromCharCode(l),s=yd.indexOf(r.charAt(M++)),f=(_&15)<<4|s>>2,s!==64&&(u+=String.fromCharCode(f)),C=yd.indexOf(r.charAt(M++)),p=(s&3)<<6|C,C!==64&&(u+=String.fromCharCode(p));return u}var ra=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Cp=(function(){if(typeof Buffer<"u"){var r=!Buffer.from;if(!r)try{Buffer.from("foo","utf8")}catch{r=!0}return r?function(u,l){return l?new Buffer(u,l):new Buffer(u)}:Buffer.from.bind(Buffer)}return function(){}})();function Td(r){return ra?Buffer.alloc?Buffer.alloc(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}function lv(r){return ra?Buffer.allocUnsafe?Buffer.allocUnsafe(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}var Ju=function(u){return ra?Cp(u,"binary"):u.split("").map(function(l){return l.charCodeAt(0)&255})};function Mp(r){if(Array.isArray(r))return r.map(function(f){return String.fromCharCode(f)}).join("");for(var u=[],l=0;l<r.length;++l)u[l]=String.fromCharCode(r[l]);return u.join("")}function n1(r){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(r instanceof ArrayBuffer)return n1(new Uint8Array(r));for(var u=new Array(r.length),l=0;l<r.length;++l)u[l]=r[l];return u}var gd=ra?function(r){return Buffer.concat(r.map(function(u){return Buffer.isBuffer(u)?u:Cp(u)}))}:function(r){if(typeof Uint8Array<"u"){var u=0,l=0;for(u=0;u<r.length;++u)l+=r[u].length;var f=new Uint8Array(l),p=0;for(u=0,l=0;u<r.length;l+=p,++u)if(p=r[u].length,r[u]instanceof Uint8Array)f.set(r[u],l);else{if(typeof r[u]=="string")throw"wtf";f.set(new Uint8Array(r[u]),l)}return f}return[].concat.apply([],r.map(function(b){return Array.isArray(b)?b:[].slice.call(b)}))};function US(r){for(var u=[],l=0,f=r.length+250,p=Td(r.length+255),b=0;b<r.length;++b){var _=r.charCodeAt(b);if(_<128)p[l++]=_;else if(_<2048)p[l++]=192|_>>6&31,p[l++]=128|_&63;else if(_>=55296&&_<57344){_=(_&1023)+64;var s=r.charCodeAt(++b)&1023;p[l++]=240|_>>8&7,p[l++]=128|_>>2&63,p[l++]=128|s>>6&15|(_&3)<<4,p[l++]=128|s&63}else p[l++]=224|_>>12&15,p[l++]=128|_>>6&63,p[l++]=128|_&63;l>f&&(u.push(p.slice(0,l)),l=0,p=Td(65535),f=65530)}return u.push(p.slice(0,l)),gd(u)}var Tl=/\u0000/g,mg=/[\u0001-\u0006]/g;function Z0(r){for(var u="",l=r.length-1;l>=0;)u+=r.charAt(l--);return u}function th(r,u){var l=""+r;return l.length>=u?l:Xi("0",u-l.length)+l}function a1(r,u){var l=""+r;return l.length>=u?l:Xi(" ",u-l.length)+l}function vx(r,u){var l=""+r;return l.length>=u?l:l+Xi(" ",u-l.length)}function VS(r,u){var l=""+Math.round(r);return l.length>=u?l:Xi("0",u-l.length)+l}function GS(r,u){var l=""+r;return l.length>=u?l:Xi("0",u-l.length)+l}var cv=Math.pow(2,32);function O0(r,u){if(r>cv||r<-cv)return VS(r,u);var l=Math.round(r);return GS(l,u)}function bx(r,u){return u=u||0,r.length>=7+u&&(r.charCodeAt(u)|32)===103&&(r.charCodeAt(u+1)|32)===101&&(r.charCodeAt(u+2)|32)===110&&(r.charCodeAt(u+3)|32)===101&&(r.charCodeAt(u+4)|32)===114&&(r.charCodeAt(u+5)|32)===97&&(r.charCodeAt(u+6)|32)===108}var uv=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],py=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function HS(r){return r||(r={}),r[0]="General",r[1]="0",r[2]="0.00",r[3]="#,##0",r[4]="#,##0.00",r[9]="0%",r[10]="0.00%",r[11]="0.00E+00",r[12]="# ?/?",r[13]="# ??/??",r[14]="m/d/yy",r[15]="d-mmm-yy",r[16]="d-mmm",r[17]="mmm-yy",r[18]="h:mm AM/PM",r[19]="h:mm:ss AM/PM",r[20]="h:mm",r[21]="h:mm:ss",r[22]="m/d/yy h:mm",r[37]="#,##0 ;(#,##0)",r[38]="#,##0 ;[Red](#,##0)",r[39]="#,##0.00;(#,##0.00)",r[40]="#,##0.00;[Red](#,##0.00)",r[45]="mm:ss",r[46]="[h]:mm:ss",r[47]="mmss.0",r[48]="##0.0E+0",r[49]="@",r[56]='"/ "hh""mm""ss" "',r}var Pn={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},hv={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},qS={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function wx(r,u,l){for(var f=r<0?-1:1,p=r*f,b=0,_=1,s=0,C=1,M=0,D=0,B=Math.floor(p);M<u&&(B=Math.floor(p),s=B*_+b,D=B*M+C,!(p-B<5e-8));)p=1/(p-B),b=_,_=s,C=M,M=D;if(D>u&&(M>u?(D=C,s=b):(D=M,s=_)),!l)return[0,f*s,D];var U=Math.floor(f*s/D);return[U,f*s-U*D,D]}function bp(r,u,l){if(r>2958465||r<0)return null;var f=r|0,p=Math.floor(86400*(r-f)),b=0,_=[],s={D:f,T:p,u:86400*(r-f)-p,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(s.u)<1e-6&&(s.u=0),u&&u.date1904&&(f+=1462),s.u>.9999&&(s.u=0,++p==86400&&(s.T=p=0,++f,++s.D)),f===60)_=l?[1317,10,29]:[1900,2,29],b=3;else if(f===0)_=l?[1317,8,29]:[1900,1,0],b=6;else{f>60&&--f;var C=new Date(1900,0,1);C.setDate(C.getDate()+f-1),_=[C.getFullYear(),C.getMonth()+1,C.getDate()],b=C.getDay(),f<60&&(b=(b+6)%7),l&&(b=KS(C,_))}return s.y=_[0],s.m=_[1],s.d=_[2],s.S=p%60,p=Math.floor(p/60),s.M=p%60,p=Math.floor(p/60),s.H=p,s.q=b,s}var Zb=new Date(1899,11,31,0,0,0),ZS=Zb.getTime(),WS=new Date(1900,2,1,0,0,0);function Wb(r,u){var l=r.getTime();return u?l-=1461*24*60*60*1e3:r>=WS&&(l+=1440*60*1e3),(l-(ZS+(r.getTimezoneOffset()-Zb.getTimezoneOffset())*6e4))/(1440*60*1e3)}function i1(r){return r.indexOf(".")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function $S(r){return r.indexOf("E")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function XS(r){var u=r<0?12:11,l=i1(r.toFixed(12));return l.length<=u||(l=r.toPrecision(10),l.length<=u)?l:r.toExponential(5)}function YS(r){var u=i1(r.toFixed(11));return u.length>(r<0?12:11)||u==="0"||u==="-0"?r.toPrecision(6):u}function Ig(r){var u=Math.floor(Math.log(Math.abs(r))*Math.LOG10E),l;return u>=-4&&u<=-1?l=r.toPrecision(10+u):Math.abs(u)<=9?l=XS(r):u===10?l=r.toFixed(10).substr(0,12):l=YS(r),i1($S(l.toUpperCase()))}function Sp(r,u){switch(typeof r){case"string":return r;case"boolean":return r?"TRUE":"FALSE";case"number":return(r|0)===r?r.toString(10):Ig(r);case"undefined":return"";case"object":if(r==null)return"";if(r instanceof Date)return iu(14,Wb(r,u&&u.date1904),u)}throw new Error("unsupported value in General format: "+r)}function KS(r,u){u[0]-=581;var l=r.getDay();return r<60&&(l=(l+6)%7),l}function JS(r,u,l,f){var p="",b=0,_=0,s=l.y,C,M=0;switch(r){case 98:s=l.y+543;case 121:switch(u.length){case 1:case 2:C=s%100,M=2;break;default:C=s%1e4,M=4;break}break;case 109:switch(u.length){case 1:case 2:C=l.m,M=u.length;break;case 3:return py[l.m-1][1];case 5:return py[l.m-1][0];default:return py[l.m-1][2]}break;case 100:switch(u.length){case 1:case 2:C=l.d,M=u.length;break;case 3:return uv[l.q][0];default:return uv[l.q][1]}break;case 104:switch(u.length){case 1:case 2:C=1+(l.H+11)%12,M=u.length;break;default:throw"bad hour format: "+u}break;case 72:switch(u.length){case 1:case 2:C=l.H,M=u.length;break;default:throw"bad hour format: "+u}break;case 77:switch(u.length){case 1:case 2:C=l.M,M=u.length;break;default:throw"bad minute format: "+u}break;case 115:if(u!="s"&&u!="ss"&&u!=".0"&&u!=".00"&&u!=".000")throw"bad second format: "+u;return l.u===0&&(u=="s"||u=="ss")?th(l.S,u.length):(f>=2?_=f===3?1e3:100:_=f===1?10:1,b=Math.round(_*(l.S+l.u)),b>=60*_&&(b=0),u==="s"?b===0?"0":""+b/_:(p=th(b,2+f),u==="ss"?p.substr(0,2):"."+p.substr(2,u.length-1)));case 90:switch(u){case"[h]":case"[hh]":C=l.D*24+l.H;break;case"[m]":case"[mm]":C=(l.D*24+l.H)*60+l.M;break;case"[s]":case"[ss]":C=((l.D*24+l.H)*60+l.M)*60+Math.round(l.S+l.u);break;default:throw"bad abstime format: "+u}M=u.length===3?1:2;break;case 101:C=s,M=1;break}var D=M>0?th(C,M):"";return D}function vd(r){var u=3;if(r.length<=u)return r;for(var l=r.length%u,f=r.substr(0,l);l!=r.length;l+=u)f+=(f.length>0?",":"")+r.substr(l,u);return f}var $b=/%/g;function QS(r,u,l){var f=u.replace($b,""),p=u.length-f.length;return Sf(r,f,l*Math.pow(10,2*p))+Xi("%",p)}function eE(r,u,l){for(var f=u.length-1;u.charCodeAt(f-1)===44;)--f;return Sf(r,u.substr(0,f),l/Math.pow(10,3*(u.length-f)))}function Xb(r,u){var l,f=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(u==0)return"0.0E+0";if(u<0)return"-"+Xb(r,-u);var p=r.indexOf(".");p===-1&&(p=r.indexOf("E"));var b=Math.floor(Math.log(u)*Math.LOG10E)%p;if(b<0&&(b+=p),l=(u/Math.pow(10,b)).toPrecision(f+1+(p+b)%p),l.indexOf("e")===-1){var _=Math.floor(Math.log(u)*Math.LOG10E);for(l.indexOf(".")===-1?l=l.charAt(0)+"."+l.substr(1)+"E+"+(_-l.length+b):l+="E+"+(_-b);l.substr(0,2)==="0.";)l=l.charAt(0)+l.substr(2,p)+"."+l.substr(2+p),l=l.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");l=l.replace(/\+-/,"-")}l=l.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(s,C,M,D){return C+M+D.substr(0,(p+b)%p)+"."+D.substr(b)+"E"})}else l=u.toExponential(f);return r.match(/E\+00$/)&&l.match(/e[+-]\d$/)&&(l=l.substr(0,l.length-1)+"0"+l.charAt(l.length-1)),r.match(/E\-/)&&l.match(/e\+/)&&(l=l.replace(/e\+/,"e")),l.replace("e","E")}var Yb=/# (\?+)( ?)\/( ?)(\d+)/;function tE(r,u,l){var f=parseInt(r[4],10),p=Math.round(u*f),b=Math.floor(p/f),_=p-b*f,s=f;return l+(b===0?"":""+b)+" "+(_===0?Xi(" ",r[1].length+1+r[4].length):a1(_,r[1].length)+r[2]+"/"+r[3]+th(s,r[4].length))}function rE(r,u,l){return l+(u===0?"":""+u)+Xi(" ",r[1].length+2+r[4].length)}var Kb=/^#*0*\.([0#]+)/,Jb=/\).*[0#]/,Qb=/\(###\) ###\\?-####/;function vl(r){for(var u="",l,f=0;f!=r.length;++f)switch(l=r.charCodeAt(f)){case 35:break;case 63:u+=" ";break;case 48:u+="0";break;default:u+=String.fromCharCode(l)}return u}function fv(r,u){var l=Math.pow(10,u);return""+Math.round(r*l)/l}function dv(r,u){var l=r-Math.floor(r),f=Math.pow(10,u);return u<(""+Math.round(l*f)).length?0:Math.round(l*f)}function nE(r,u){return u<(""+Math.round((r-Math.floor(r))*Math.pow(10,u))).length?1:0}function aE(r){return r<2147483647&&r>-2147483648?""+(r>=0?r|0:r-1|0):""+Math.floor(r)}function ru(r,u,l){if(r.charCodeAt(0)===40&&!u.match(Jb)){var f=u.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return l>=0?ru("n",f,l):"("+ru("n",f,-l)+")"}if(u.charCodeAt(u.length-1)===44)return eE(r,u,l);if(u.indexOf("%")!==-1)return QS(r,u,l);if(u.indexOf("E")!==-1)return Xb(u,l);if(u.charCodeAt(0)===36)return"$"+ru(r,u.substr(u.charAt(1)==" "?2:1),l);var p,b,_,s,C=Math.abs(l),M=l<0?"-":"";if(u.match(/^00+$/))return M+O0(C,u.length);if(u.match(/^[#?]+$/))return p=O0(l,0),p==="0"&&(p=""),p.length>u.length?p:vl(u.substr(0,u.length-p.length))+p;if(b=u.match(Yb))return tE(b,C,M);if(u.match(/^#+0+$/))return M+O0(C,u.length-u.indexOf("0"));if(b=u.match(Kb))return p=fv(l,b[1].length).replace(/^([^\.]+)$/,"$1."+vl(b[1])).replace(/\.$/,"."+vl(b[1])).replace(/\.(\d*)$/,function(H,O){return"."+O+Xi("0",vl(b[1]).length-O.length)}),u.indexOf("0.")!==-1?p:p.replace(/^0\./,".");if(u=u.replace(/^#+([0.])/,"$1"),b=u.match(/^(0*)\.(#*)$/))return M+fv(C,b[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,b[1].length?"0.":".");if(b=u.match(/^#{1,3},##0(\.?)$/))return M+vd(O0(C,0));if(b=u.match(/^#,##0\.([#0]*0)$/))return l<0?"-"+ru(r,u,-l):vd(""+(Math.floor(l)+nE(l,b[1].length)))+"."+th(dv(l,b[1].length),b[1].length);if(b=u.match(/^#,#*,#0/))return ru(r,u.replace(/^#,#*,/,""),l);if(b=u.match(/^([0#]+)(\\?-([0#]+))+$/))return p=Z0(ru(r,u.replace(/[\\-]/g,""),l)),_=0,Z0(Z0(u.replace(/\\/g,"")).replace(/[0#]/g,function(H){return _<p.length?p.charAt(_++):H==="0"?"0":""}));if(u.match(Qb))return p=ru(r,"##########",l),"("+p.substr(0,3)+") "+p.substr(3,3)+"-"+p.substr(6);var D="";if(b=u.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return _=Math.min(b[4].length,7),s=wx(C,Math.pow(10,_)-1,!1),p=""+M,D=Sf("n",b[1],s[1]),D.charAt(D.length-1)==" "&&(D=D.substr(0,D.length-1)+"0"),p+=D+b[2]+"/"+b[3],D=vx(s[2],_),D.length<b[4].length&&(D=vl(b[4].substr(b[4].length-D.length))+D),p+=D,p;if(b=u.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return _=Math.min(Math.max(b[1].length,b[4].length),7),s=wx(C,Math.pow(10,_)-1,!0),M+(s[0]||(s[1]?"":"0"))+" "+(s[1]?a1(s[1],_)+b[2]+"/"+b[3]+vx(s[2],_):Xi(" ",2*_+1+b[2].length+b[3].length));if(b=u.match(/^[#0?]+$/))return p=O0(l,0),u.length<=p.length?p:vl(u.substr(0,u.length-p.length))+p;if(b=u.match(/^([#0?]+)\.([#0]+)$/)){p=""+l.toFixed(Math.min(b[2].length,10)).replace(/([^0])0+$/,"$1"),_=p.indexOf(".");var B=u.indexOf(".")-_,U=u.length-p.length-B;return vl(u.substr(0,B)+p+u.substr(u.length-U))}if(b=u.match(/^00,000\.([#0]*0)$/))return _=dv(l,b[1].length),l<0?"-"+ru(r,u,-l):vd(aE(l)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(H){return"00,"+(H.length<3?th(0,3-H.length):"")+H})+"."+th(_,b[1].length);switch(u){case"###,##0.00":return ru(r,"#,##0.00",l);case"###,###":case"##,###":case"#,###":var j=vd(O0(C,0));return j!=="0"?M+j:"";case"###,###.00":return ru(r,"###,##0.00",l).replace(/^0\./,".");case"#,###.00":return ru(r,"#,##0.00",l).replace(/^0\./,".")}throw new Error("unsupported format |"+u+"|")}function iE(r,u,l){for(var f=u.length-1;u.charCodeAt(f-1)===44;)--f;return Sf(r,u.substr(0,f),l/Math.pow(10,3*(u.length-f)))}function sE(r,u,l){var f=u.replace($b,""),p=u.length-f.length;return Sf(r,f,l*Math.pow(10,2*p))+Xi("%",p)}function e2(r,u){var l,f=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(u==0)return"0.0E+0";if(u<0)return"-"+e2(r,-u);var p=r.indexOf(".");p===-1&&(p=r.indexOf("E"));var b=Math.floor(Math.log(u)*Math.LOG10E)%p;if(b<0&&(b+=p),l=(u/Math.pow(10,b)).toPrecision(f+1+(p+b)%p),!l.match(/[Ee]/)){var _=Math.floor(Math.log(u)*Math.LOG10E);l.indexOf(".")===-1?l=l.charAt(0)+"."+l.substr(1)+"E+"+(_-l.length+b):l+="E+"+(_-b),l=l.replace(/\+-/,"-")}l=l.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(s,C,M,D){return C+M+D.substr(0,(p+b)%p)+"."+D.substr(b)+"E"})}else l=u.toExponential(f);return r.match(/E\+00$/)&&l.match(/e[+-]\d$/)&&(l=l.substr(0,l.length-1)+"0"+l.charAt(l.length-1)),r.match(/E\-/)&&l.match(/e\+/)&&(l=l.replace(/e\+/,"e")),l.replace("e","E")}function Bh(r,u,l){if(r.charCodeAt(0)===40&&!u.match(Jb)){var f=u.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return l>=0?Bh("n",f,l):"("+Bh("n",f,-l)+")"}if(u.charCodeAt(u.length-1)===44)return iE(r,u,l);if(u.indexOf("%")!==-1)return sE(r,u,l);if(u.indexOf("E")!==-1)return e2(u,l);if(u.charCodeAt(0)===36)return"$"+Bh(r,u.substr(u.charAt(1)==" "?2:1),l);var p,b,_,s,C=Math.abs(l),M=l<0?"-":"";if(u.match(/^00+$/))return M+th(C,u.length);if(u.match(/^[#?]+$/))return p=""+l,l===0&&(p=""),p.length>u.length?p:vl(u.substr(0,u.length-p.length))+p;if(b=u.match(Yb))return rE(b,C,M);if(u.match(/^#+0+$/))return M+th(C,u.length-u.indexOf("0"));if(b=u.match(Kb))return p=(""+l).replace(/^([^\.]+)$/,"$1."+vl(b[1])).replace(/\.$/,"."+vl(b[1])),p=p.replace(/\.(\d*)$/,function(H,O){return"."+O+Xi("0",vl(b[1]).length-O.length)}),u.indexOf("0.")!==-1?p:p.replace(/^0\./,".");if(u=u.replace(/^#+([0.])/,"$1"),b=u.match(/^(0*)\.(#*)$/))return M+(""+C).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,b[1].length?"0.":".");if(b=u.match(/^#{1,3},##0(\.?)$/))return M+vd(""+C);if(b=u.match(/^#,##0\.([#0]*0)$/))return l<0?"-"+Bh(r,u,-l):vd(""+l)+"."+Xi("0",b[1].length);if(b=u.match(/^#,#*,#0/))return Bh(r,u.replace(/^#,#*,/,""),l);if(b=u.match(/^([0#]+)(\\?-([0#]+))+$/))return p=Z0(Bh(r,u.replace(/[\\-]/g,""),l)),_=0,Z0(Z0(u.replace(/\\/g,"")).replace(/[0#]/g,function(H){return _<p.length?p.charAt(_++):H==="0"?"0":""}));if(u.match(Qb))return p=Bh(r,"##########",l),"("+p.substr(0,3)+") "+p.substr(3,3)+"-"+p.substr(6);var D="";if(b=u.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return _=Math.min(b[4].length,7),s=wx(C,Math.pow(10,_)-1,!1),p=""+M,D=Sf("n",b[1],s[1]),D.charAt(D.length-1)==" "&&(D=D.substr(0,D.length-1)+"0"),p+=D+b[2]+"/"+b[3],D=vx(s[2],_),D.length<b[4].length&&(D=vl(b[4].substr(b[4].length-D.length))+D),p+=D,p;if(b=u.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return _=Math.min(Math.max(b[1].length,b[4].length),7),s=wx(C,Math.pow(10,_)-1,!0),M+(s[0]||(s[1]?"":"0"))+" "+(s[1]?a1(s[1],_)+b[2]+"/"+b[3]+vx(s[2],_):Xi(" ",2*_+1+b[2].length+b[3].length));if(b=u.match(/^[#0?]+$/))return p=""+l,u.length<=p.length?p:vl(u.substr(0,u.length-p.length))+p;if(b=u.match(/^([#0]+)\.([#0]+)$/)){p=""+l.toFixed(Math.min(b[2].length,10)).replace(/([^0])0+$/,"$1"),_=p.indexOf(".");var B=u.indexOf(".")-_,U=u.length-p.length-B;return vl(u.substr(0,B)+p+u.substr(u.length-U))}if(b=u.match(/^00,000\.([#0]*0)$/))return l<0?"-"+Bh(r,u,-l):vd(""+l).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(H){return"00,"+(H.length<3?th(0,3-H.length):"")+H})+"."+th(0,b[1].length);switch(u){case"###,###":case"##,###":case"#,###":var j=vd(""+C);return j!=="0"?M+j:"";default:if(u.match(/\.[0#?]*$/))return Bh(r,u.slice(0,u.lastIndexOf(".")),l)+vl(u.slice(u.lastIndexOf(".")))}throw new Error("unsupported format |"+u+"|")}function Sf(r,u,l){return(l|0)===l?Bh(r,u,l):ru(r,u,l)}function oE(r){for(var u=[],l=!1,f=0,p=0;f<r.length;++f)switch(r.charCodeAt(f)){case 34:l=!l;break;case 95:case 42:case 92:++f;break;case 59:u[u.length]=r.substr(p,f-p),p=f+1}if(u[u.length]=r.substr(p),l===!0)throw new Error("Format |"+r+"| unterminated string ");return u}var t2=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function rm(r){for(var u=0,l="",f="";u<r.length;)switch(l=r.charAt(u)){case"G":bx(r,u)&&(u+=6),u++;break;case'"':for(;r.charCodeAt(++u)!==34&&u<r.length;);++u;break;case"\\":u+=2;break;case"_":u+=2;break;case"@":++u;break;case"B":case"b":if(r.charAt(u+1)==="1"||r.charAt(u+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(r.substr(u,3).toUpperCase()==="A/P"||r.substr(u,5).toUpperCase()==="AM/PM"||r.substr(u,5).toUpperCase()==="/")return!0;++u;break;case"[":for(f=l;r.charAt(u++)!=="]"&&u<r.length;)f+=r.charAt(u);if(f.match(t2))return!0;break;case".":case"0":case"#":for(;u<r.length&&("0#?.,E+-%".indexOf(l=r.charAt(++u))>-1||l=="\\"&&r.charAt(u+1)=="-"&&"0#".indexOf(r.charAt(u+2))>-1););break;case"?":for(;r.charAt(++u)===l;);break;case"*":++u,(r.charAt(u)==" "||r.charAt(u)=="*")&&++u;break;case"(":case")":++u;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;u<r.length&&"0123456789".indexOf(r.charAt(++u))>-1;);break;case" ":++u;break;default:++u;break}return!1}function lE(r,u,l,f){for(var p=[],b="",_=0,s="",C="t",M,D,B,U="H";_<r.length;)switch(s=r.charAt(_)){case"G":if(!bx(r,_))throw new Error("unrecognized character "+s+" in "+r);p[p.length]={t:"G",v:"General"},_+=7;break;case'"':for(b="";(B=r.charCodeAt(++_))!==34&&_<r.length;)b+=String.fromCharCode(B);p[p.length]={t:"t",v:b},++_;break;case"\\":var j=r.charAt(++_),H=j==="("||j===")"?j:"t";p[p.length]={t:H,v:j},++_;break;case"_":p[p.length]={t:"t",v:" "},_+=2;break;case"@":p[p.length]={t:"T",v:u},++_;break;case"B":case"b":if(r.charAt(_+1)==="1"||r.charAt(_+1)==="2"){if(M==null&&(M=bp(u,l,r.charAt(_+1)==="2"),M==null))return"";p[p.length]={t:"X",v:r.substr(_,2)},C=s,_+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":s=s.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(u<0||M==null&&(M=bp(u,l),M==null))return"";for(b=s;++_<r.length&&r.charAt(_).toLowerCase()===s;)b+=s;s==="m"&&C.toLowerCase()==="h"&&(s="M"),s==="h"&&(s=U),p[p.length]={t:s,v:b},C=s;break;case"A":case"a":case"":var O={t:s,v:s};if(M==null&&(M=bp(u,l)),r.substr(_,3).toUpperCase()==="A/P"?(M!=null&&(O.v=M.H>=12?"P":"A"),O.t="T",U="h",_+=3):r.substr(_,5).toUpperCase()==="AM/PM"?(M!=null&&(O.v=M.H>=12?"PM":"AM"),O.t="T",_+=5,U="h"):r.substr(_,5).toUpperCase()==="/"?(M!=null&&(O.v=M.H>=12?"":""),O.t="T",_+=5,U="h"):(O.t="t",++_),M==null&&O.t==="T")return"";p[p.length]=O,C=s;break;case"[":for(b=s;r.charAt(_++)!=="]"&&_<r.length;)b+=r.charAt(_);if(b.slice(-1)!=="]")throw'unterminated "[" block: |'+b+"|";if(b.match(t2)){if(M==null&&(M=bp(u,l),M==null))return"";p[p.length]={t:"Z",v:b.toLowerCase()},C=b.charAt(1)}else b.indexOf("$")>-1&&(b=(b.match(/\$([^-\[\]]*)/)||[])[1]||"$",rm(r)||(p[p.length]={t:"t",v:b}));break;case".":if(M!=null){for(b=s;++_<r.length&&(s=r.charAt(_))==="0";)b+=s;p[p.length]={t:"s",v:b};break}case"0":case"#":for(b=s;++_<r.length&&"0#?.,E+-%".indexOf(s=r.charAt(_))>-1;)b+=s;p[p.length]={t:"n",v:b};break;case"?":for(b=s;r.charAt(++_)===s;)b+=s;p[p.length]={t:s,v:b},C=s;break;case"*":++_,(r.charAt(_)==" "||r.charAt(_)=="*")&&++_;break;case"(":case")":p[p.length]={t:f===1?"t":s,v:s},++_;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(b=s;_<r.length&&"0123456789".indexOf(r.charAt(++_))>-1;)b+=r.charAt(_);p[p.length]={t:"D",v:b};break;case" ":p[p.length]={t:s,v:s},++_;break;case"$":p[p.length]={t:"t",v:"$"},++_;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(s)===-1)throw new Error("unrecognized character "+s+" in "+r);p[p.length]={t:"t",v:s},++_;break}var N=0,Z=0,J;for(_=p.length-1,C="t";_>=0;--_)switch(p[_].t){case"h":case"H":p[_].t=U,C="h",N<1&&(N=1);break;case"s":(J=p[_].v.match(/\.0+$/))&&(Z=Math.max(Z,J[0].length-1)),N<3&&(N=3);case"d":case"y":case"M":case"e":C=p[_].t;break;case"m":C==="s"&&(p[_].t="M",N<2&&(N=2));break;case"X":break;case"Z":N<1&&p[_].v.match(/[Hh]/)&&(N=1),N<2&&p[_].v.match(/[Mm]/)&&(N=2),N<3&&p[_].v.match(/[Ss]/)&&(N=3)}switch(N){case 0:break;case 1:M.u>=.5&&(M.u=0,++M.S),M.S>=60&&(M.S=0,++M.M),M.M>=60&&(M.M=0,++M.H);break;case 2:M.u>=.5&&(M.u=0,++M.S),M.S>=60&&(M.S=0,++M.M);break}var X="",pe;for(_=0;_<p.length;++_)switch(p[_].t){case"t":case"T":case" ":case"D":break;case"X":p[_].v="",p[_].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":p[_].v=JS(p[_].t.charCodeAt(0),p[_].v,M,Z),p[_].t="t";break;case"n":case"?":for(pe=_+1;p[pe]!=null&&((s=p[pe].t)==="?"||s==="D"||(s===" "||s==="t")&&p[pe+1]!=null&&(p[pe+1].t==="?"||p[pe+1].t==="t"&&p[pe+1].v==="/")||p[_].t==="("&&(s===" "||s==="n"||s===")")||s==="t"&&(p[pe].v==="/"||p[pe].v===" "&&p[pe+1]!=null&&p[pe+1].t=="?"));)p[_].v+=p[pe].v,p[pe]={v:"",t:";"},++pe;X+=p[_].v,_=pe-1;break;case"G":p[_].t="t",p[_].v=Sp(u,l);break}var ge="",ve,re;if(X.length>0){X.charCodeAt(0)==40?(ve=u<0&&X.charCodeAt(0)===45?-u:u,re=Sf("n",X,ve)):(ve=u<0&&f>1?-u:u,re=Sf("n",X,ve),ve<0&&p[0]&&p[0].t=="t"&&(re=re.substr(1),p[0].v="-"+p[0].v)),pe=re.length-1;var Ce=p.length;for(_=0;_<p.length;++_)if(p[_]!=null&&p[_].t!="t"&&p[_].v.indexOf(".")>-1){Ce=_;break}var xe=p.length;if(Ce===p.length&&re.indexOf("E")===-1){for(_=p.length-1;_>=0;--_)p[_]==null||"n?".indexOf(p[_].t)===-1||(pe>=p[_].v.length-1?(pe-=p[_].v.length,p[_].v=re.substr(pe+1,p[_].v.length)):pe<0?p[_].v="":(p[_].v=re.substr(0,pe+1),pe=-1),p[_].t="t",xe=_);pe>=0&&xe<p.length&&(p[xe].v=re.substr(0,pe+1)+p[xe].v)}else if(Ce!==p.length&&re.indexOf("E")===-1){for(pe=re.indexOf(".")-1,_=Ce;_>=0;--_)if(!(p[_]==null||"n?".indexOf(p[_].t)===-1)){for(D=p[_].v.indexOf(".")>-1&&_===Ce?p[_].v.indexOf(".")-1:p[_].v.length-1,ge=p[_].v.substr(D+1);D>=0;--D)pe>=0&&(p[_].v.charAt(D)==="0"||p[_].v.charAt(D)==="#")&&(ge=re.charAt(pe--)+ge);p[_].v=ge,p[_].t="t",xe=_}for(pe>=0&&xe<p.length&&(p[xe].v=re.substr(0,pe+1)+p[xe].v),pe=re.indexOf(".")+1,_=Ce;_<p.length;++_)if(!(p[_]==null||"n?(".indexOf(p[_].t)===-1&&_!==Ce)){for(D=p[_].v.indexOf(".")>-1&&_===Ce?p[_].v.indexOf(".")+1:0,ge=p[_].v.substr(0,D);D<p[_].v.length;++D)pe<re.length&&(ge+=re.charAt(pe++));p[_].v=ge,p[_].t="t",xe=_}}}for(_=0;_<p.length;++_)p[_]!=null&&"n?".indexOf(p[_].t)>-1&&(ve=f>1&&u<0&&_>0&&p[_-1].v==="-"?-u:u,p[_].v=Sf(p[_].t,p[_].v,ve),p[_].t="t");var Ge="";for(_=0;_!==p.length;++_)p[_]!=null&&(Ge+=p[_].v);return Ge}var pv=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function mv(r,u){if(u==null)return!1;var l=parseFloat(u[2]);switch(u[1]){case"=":if(r==l)return!0;break;case">":if(r>l)return!0;break;case"<":if(r<l)return!0;break;case"<>":if(r!=l)return!0;break;case">=":if(r>=l)return!0;break;case"<=":if(r<=l)return!0;break}return!1}function cE(r,u){var l=oE(r),f=l.length,p=l[f-1].indexOf("@");if(f<4&&p>-1&&--f,l.length>4)throw new Error("cannot find right format for |"+l.join("|")+"|");if(typeof u!="number")return[4,l.length===4||p>-1?l[l.length-1]:"@"];switch(l.length){case 1:l=p>-1?["General","General","General",l[0]]:[l[0],l[0],l[0],"@"];break;case 2:l=p>-1?[l[0],l[0],l[0],l[1]]:[l[0],l[1],l[0],"@"];break;case 3:l=p>-1?[l[0],l[1],l[0],l[2]]:[l[0],l[1],l[2],"@"];break}var b=u>0?l[0]:u<0?l[1]:l[2];if(l[0].indexOf("[")===-1&&l[1].indexOf("[")===-1)return[f,b];if(l[0].match(/\[[=<>]/)!=null||l[1].match(/\[[=<>]/)!=null){var _=l[0].match(pv),s=l[1].match(pv);return mv(u,_)?[f,l[0]]:mv(u,s)?[f,l[1]]:[f,l[_!=null&&s!=null?2:1]]}return[f,b]}function iu(r,u,l){l==null&&(l={});var f="";switch(typeof r){case"string":r=="m/d/yy"&&l.dateNF?f=l.dateNF:f=r;break;case"number":r==14&&l.dateNF?f=l.dateNF:f=(l.table!=null?l.table:Pn)[r],f==null&&(f=l.table&&l.table[hv[r]]||Pn[hv[r]]),f==null&&(f=qS[r]||"General");break}if(bx(f,0))return Sp(u,l);u instanceof Date&&(u=Wb(u,l.date1904));var p=cE(f,u);if(bx(p[1]))return Sp(u,l);if(u===!0)u="TRUE";else if(u===!1)u="FALSE";else if(u===""||u==null)return"";return lE(p[1],u,l,p[0])}function wp(r,u){if(typeof u!="number"){u=+u||-1;for(var l=0;l<392;++l){if(Pn[l]==null){u<0&&(u=l);continue}if(Pn[l]==r){u=l;break}}u<0&&(u=391)}return Pn[u]=r,u}function r2(){Pn=HS()}var uE={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},n2=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function hE(r){var u=typeof r=="number"?Pn[r]:r;return u=u.replace(n2,"(\\d+)"),new RegExp("^"+u+"$")}function fE(r,u,l){var f=-1,p=-1,b=-1,_=-1,s=-1,C=-1;(u.match(n2)||[]).forEach(function(B,U){var j=parseInt(l[U+1],10);switch(B.toLowerCase().charAt(0)){case"y":f=j;break;case"d":b=j;break;case"h":_=j;break;case"s":C=j;break;case"m":_>=0?s=j:p=j;break}}),C>=0&&s==-1&&p>=0&&(s=p,p=-1);var M=(""+(f>=0?f:new Date().getFullYear())).slice(-4)+"-"+("00"+(p>=1?p:1)).slice(-2)+"-"+("00"+(b>=1?b:1)).slice(-2);M.length==7&&(M="0"+M),M.length==8&&(M="20"+M);var D=("00"+(_>=0?_:0)).slice(-2)+":"+("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(C>=0?C:0)).slice(-2);return _==-1&&s==-1&&C==-1?M:f==-1&&p==-1&&b==-1?D:M+"T"+D}var dE=(function(){var r={};r.version="1.2.0";function u(){for(var re=0,Ce=new Array(256),xe=0;xe!=256;++xe)re=xe,re=re&1?-306674912^re>>>1:re>>>1,re=re&1?-306674912^re>>>1:re>>>1,re=re&1?-306674912^re>>>1:re>>>1,re=re&1?-306674912^re>>>1:re>>>1,re=re&1?-306674912^re>>>1:re>>>1,re=re&1?-306674912^re>>>1:re>>>1,re=re&1?-306674912^re>>>1:re>>>1,re=re&1?-306674912^re>>>1:re>>>1,Ce[xe]=re;return typeof Int32Array<"u"?new Int32Array(Ce):Ce}var l=u();function f(re){var Ce=0,xe=0,Ge=0,$e=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Ge=0;Ge!=256;++Ge)$e[Ge]=re[Ge];for(Ge=0;Ge!=256;++Ge)for(xe=re[Ge],Ce=256+Ge;Ce<4096;Ce+=256)xe=$e[Ce]=xe>>>8^re[xe&255];var de=[];for(Ge=1;Ge!=16;++Ge)de[Ge-1]=typeof Int32Array<"u"?$e.subarray(Ge*256,Ge*256+256):$e.slice(Ge*256,Ge*256+256);return de}var p=f(l),b=p[0],_=p[1],s=p[2],C=p[3],M=p[4],D=p[5],B=p[6],U=p[7],j=p[8],H=p[9],O=p[10],N=p[11],Z=p[12],J=p[13],X=p[14];function pe(re,Ce){for(var xe=Ce^-1,Ge=0,$e=re.length;Ge<$e;)xe=xe>>>8^l[(xe^re.charCodeAt(Ge++))&255];return~xe}function ge(re,Ce){for(var xe=Ce^-1,Ge=re.length-15,$e=0;$e<Ge;)xe=X[re[$e++]^xe&255]^J[re[$e++]^xe>>8&255]^Z[re[$e++]^xe>>16&255]^N[re[$e++]^xe>>>24]^O[re[$e++]]^H[re[$e++]]^j[re[$e++]]^U[re[$e++]]^B[re[$e++]]^D[re[$e++]]^M[re[$e++]]^C[re[$e++]]^s[re[$e++]]^_[re[$e++]]^b[re[$e++]]^l[re[$e++]];for(Ge+=15;$e<Ge;)xe=xe>>>8^l[(xe^re[$e++])&255];return~xe}function ve(re,Ce){for(var xe=Ce^-1,Ge=0,$e=re.length,de=0,nt=0;Ge<$e;)de=re.charCodeAt(Ge++),de<128?xe=xe>>>8^l[(xe^de)&255]:de<2048?(xe=xe>>>8^l[(xe^(192|de>>6&31))&255],xe=xe>>>8^l[(xe^(128|de&63))&255]):de>=55296&&de<57344?(de=(de&1023)+64,nt=re.charCodeAt(Ge++)&1023,xe=xe>>>8^l[(xe^(240|de>>8&7))&255],xe=xe>>>8^l[(xe^(128|de>>2&63))&255],xe=xe>>>8^l[(xe^(128|nt>>6&15|(de&3)<<4))&255],xe=xe>>>8^l[(xe^(128|nt&63))&255]):(xe=xe>>>8^l[(xe^(224|de>>12&15))&255],xe=xe>>>8^l[(xe^(128|de>>6&63))&255],xe=xe>>>8^l[(xe^(128|de&63))&255]);return~xe}return r.table=l,r.bstr=pe,r.buf=ge,r.str=ve,r})(),la=(function(){var u={};u.version="1.2.1";function l(ye,je){for(var Le=ye.split("/"),Me=je.split("/"),Te=0,Pe=0,gt=Math.min(Le.length,Me.length);Te<gt;++Te){if(Pe=Le[Te].length-Me[Te].length)return Pe;if(Le[Te]!=Me[Te])return Le[Te]<Me[Te]?-1:1}return Le.length-Me.length}function f(ye){if(ye.charAt(ye.length-1)=="/")return ye.slice(0,-1).indexOf("/")===-1?ye:f(ye.slice(0,-1));var je=ye.lastIndexOf("/");return je===-1?ye:ye.slice(0,je+1)}function p(ye){if(ye.charAt(ye.length-1)=="/")return p(ye.slice(0,-1));var je=ye.lastIndexOf("/");return je===-1?ye:ye.slice(je+1)}function b(ye,je){typeof je=="string"&&(je=new Date(je));var Le=je.getHours();Le=Le<<6|je.getMinutes(),Le=Le<<5|je.getSeconds()>>>1,ye.write_shift(2,Le);var Me=je.getFullYear()-1980;Me=Me<<4|je.getMonth()+1,Me=Me<<5|je.getDate(),ye.write_shift(2,Me)}function _(ye){var je=ye.read_shift(2)&65535,Le=ye.read_shift(2)&65535,Me=new Date,Te=Le&31;Le>>>=5;var Pe=Le&15;Le>>>=4,Me.setMilliseconds(0),Me.setFullYear(Le+1980),Me.setMonth(Pe-1),Me.setDate(Te);var gt=je&31;je>>>=5;var jt=je&63;return je>>>=6,Me.setHours(je),Me.setMinutes(jt),Me.setSeconds(gt<<1),Me}function s(ye){ho(ye,0);for(var je={},Le=0;ye.l<=ye.length-4;){var Me=ye.read_shift(2),Te=ye.read_shift(2),Pe=ye.l+Te,gt={};Me===21589&&(Le=ye.read_shift(1),Le&1&&(gt.mtime=ye.read_shift(4)),Te>5&&(Le&2&&(gt.atime=ye.read_shift(4)),Le&4&&(gt.ctime=ye.read_shift(4))),gt.mtime&&(gt.mt=new Date(gt.mtime*1e3))),ye.l=Pe,je[Me]=gt}return je}var C;function M(){return C||(C={})}function D(ye,je){if(ye[0]==80&&ye[1]==75)return Kr(ye,je);if((ye[0]|32)==109&&(ye[1]|32)==105)return zn(ye,je);if(ye.length<512)throw new Error("CFB file size "+ye.length+" < 512");var Le=3,Me=512,Te=0,Pe=0,gt=0,jt=0,Dt=0,At=[],_t=ye.slice(0,512);ho(_t,0);var or=B(_t);switch(Le=or[0],Le){case 3:Me=512;break;case 4:Me=4096;break;case 0:if(or[1]==0)return Kr(ye,je);default:throw new Error("Major Version: Expected 3 or 4 saw "+Le)}Me!==512&&(_t=ye.slice(0,Me),ho(_t,28));var yr=ye.slice(0,Me);U(_t,Le);var vr=_t.read_shift(4,"i");if(Le===3&&vr!==0)throw new Error("# Directory Sectors: Expected 0 saw "+vr);_t.l+=4,gt=_t.read_shift(4,"i"),_t.l+=4,_t.chk("00100000","Mini Stream Cutoff Size: "),jt=_t.read_shift(4,"i"),Te=_t.read_shift(4,"i"),Dt=_t.read_shift(4,"i"),Pe=_t.read_shift(4,"i");for(var fr=-1,_r=0;_r<109&&(fr=_t.read_shift(4,"i"),!(fr<0));++_r)At[_r]=fr;var Ur=j(ye,Me);N(Dt,Pe,Ur,Me,At);var Tn=J(Ur,gt,At,Me);Tn[gt].name="!Directory",Te>0&&jt!==nt&&(Tn[jt].name="!MiniFAT"),Tn[At[0]].name="!FAT",Tn.fat_addrs=At,Tn.ssz=Me;var vn={},Zr=[],Mi=[],Fs=[];X(gt,Tn,Ur,Zr,Te,vn,Mi,jt),H(Mi,Fs,Zr),Zr.shift();var pi={FileIndex:Mi,FullPaths:Fs};return je&&je.raw&&(pi.raw={header:yr,sectors:Ur}),pi}function B(ye){if(ye[ye.l]==80&&ye[ye.l+1]==75)return[0,0];ye.chk(le,"Header Signature: "),ye.l+=16;var je=ye.read_shift(2,"u");return[ye.read_shift(2,"u"),je]}function U(ye,je){var Le=9;switch(ye.l+=2,Le=ye.read_shift(2)){case 9:if(je!=3)throw new Error("Sector Shift: Expected 9 saw "+Le);break;case 12:if(je!=4)throw new Error("Sector Shift: Expected 12 saw "+Le);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Le)}ye.chk("0600","Mini Sector Shift: "),ye.chk("000000000000","Reserved: ")}function j(ye,je){for(var Le=Math.ceil(ye.length/je)-1,Me=[],Te=1;Te<Le;++Te)Me[Te-1]=ye.slice(Te*je,(Te+1)*je);return Me[Le-1]=ye.slice(Le*je),Me}function H(ye,je,Le){for(var Me=0,Te=0,Pe=0,gt=0,jt=0,Dt=Le.length,At=[],_t=[];Me<Dt;++Me)At[Me]=_t[Me]=Me,je[Me]=Le[Me];for(;jt<_t.length;++jt)Me=_t[jt],Te=ye[Me].L,Pe=ye[Me].R,gt=ye[Me].C,At[Me]===Me&&(Te!==-1&&At[Te]!==Te&&(At[Me]=At[Te]),Pe!==-1&&At[Pe]!==Pe&&(At[Me]=At[Pe])),gt!==-1&&(At[gt]=Me),Te!==-1&&Me!=At[Me]&&(At[Te]=At[Me],_t.lastIndexOf(Te)<jt&&_t.push(Te)),Pe!==-1&&Me!=At[Me]&&(At[Pe]=At[Me],_t.lastIndexOf(Pe)<jt&&_t.push(Pe));for(Me=1;Me<Dt;++Me)At[Me]===Me&&(Pe!==-1&&At[Pe]!==Pe?At[Me]=At[Pe]:Te!==-1&&At[Te]!==Te&&(At[Me]=At[Te]));for(Me=1;Me<Dt;++Me)if(ye[Me].type!==0){if(jt=Me,jt!=At[jt])do jt=At[jt],je[Me]=je[jt]+"/"+je[Me];while(jt!==0&&At[jt]!==-1&&jt!=At[jt]);At[Me]=-1}for(je[0]+="/",Me=1;Me<Dt;++Me)ye[Me].type!==2&&(je[Me]+="/")}function O(ye,je,Le){for(var Me=ye.start,Te=ye.size,Pe=[],gt=Me;Le&&Te>0&&gt>=0;)Pe.push(je.slice(gt*de,gt*de+de)),Te-=de,gt=vp(Le,gt*4);return Pe.length===0?Rs(0):gd(Pe).slice(0,ye.size)}function N(ye,je,Le,Me,Te){var Pe=nt;if(ye===nt){if(je!==0)throw new Error("DIFAT chain shorter than expected")}else if(ye!==-1){var gt=Le[ye],jt=(Me>>>2)-1;if(!gt)return;for(var Dt=0;Dt<jt&&(Pe=vp(gt,Dt*4))!==nt;++Dt)Te.push(Pe);N(vp(gt,Me-4),je-1,Le,Me,Te)}}function Z(ye,je,Le,Me,Te){var Pe=[],gt=[];Te||(Te=[]);var jt=Me-1,Dt=0,At=0;for(Dt=je;Dt>=0;){Te[Dt]=!0,Pe[Pe.length]=Dt,gt.push(ye[Dt]);var _t=Le[Math.floor(Dt*4/Me)];if(At=Dt*4&jt,Me<4+At)throw new Error("FAT boundary crossed: "+Dt+" 4 "+Me);if(!ye[_t])break;Dt=vp(ye[_t],At)}return{nodes:Pe,data:Ev([gt])}}function J(ye,je,Le,Me){var Te=ye.length,Pe=[],gt=[],jt=[],Dt=[],At=Me-1,_t=0,or=0,yr=0,vr=0;for(_t=0;_t<Te;++_t)if(jt=[],yr=_t+je,yr>=Te&&(yr-=Te),!gt[yr]){Dt=[];var fr=[];for(or=yr;or>=0;){fr[or]=!0,gt[or]=!0,jt[jt.length]=or,Dt.push(ye[or]);var _r=Le[Math.floor(or*4/Me)];if(vr=or*4&At,Me<4+vr)throw new Error("FAT boundary crossed: "+or+" 4 "+Me);if(!ye[_r]||(or=vp(ye[_r],vr),fr[or]))break}Pe[yr]={nodes:jt,data:Ev([Dt])}}return Pe}function X(ye,je,Le,Me,Te,Pe,gt,jt){for(var Dt=0,At=Me.length?2:0,_t=je[ye].data,or=0,yr=0,vr;or<_t.length;or+=128){var fr=_t.slice(or,or+128);ho(fr,64),yr=fr.read_shift(2),vr=u1(fr,0,yr-At),Me.push(vr);var _r={name:vr,type:fr.read_shift(1),color:fr.read_shift(1),L:fr.read_shift(4,"i"),R:fr.read_shift(4,"i"),C:fr.read_shift(4,"i"),clsid:fr.read_shift(16),state:fr.read_shift(4,"i"),start:0,size:0},Ur=fr.read_shift(2)+fr.read_shift(2)+fr.read_shift(2)+fr.read_shift(2);Ur!==0&&(_r.ct=pe(fr,fr.l-8));var Tn=fr.read_shift(2)+fr.read_shift(2)+fr.read_shift(2)+fr.read_shift(2);Tn!==0&&(_r.mt=pe(fr,fr.l-8)),_r.start=fr.read_shift(4,"i"),_r.size=fr.read_shift(4,"i"),_r.size<0&&_r.start<0&&(_r.size=_r.type=0,_r.start=nt,_r.name=""),_r.type===5?(Dt=_r.start,Te>0&&Dt!==nt&&(je[Dt].name="!StreamData")):_r.size>=4096?(_r.storage="fat",je[_r.start]===void 0&&(je[_r.start]=Z(Le,_r.start,je.fat_addrs,je.ssz)),je[_r.start].name=_r.name,_r.content=je[_r.start].data.slice(0,_r.size)):(_r.storage="minifat",_r.size<0?_r.size=0:Dt!==nt&&_r.start!==nt&&je[Dt]&&(_r.content=O(_r,je[Dt].data,(je[jt]||{}).data))),_r.content&&ho(_r.content,0),Pe[vr]=_r,gt.push(_r)}}function pe(ye,je){return new Date((Sc(ye,je+4)/1e7*Math.pow(2,32)+Sc(ye,je)/1e7-11644473600)*1e3)}function ge(ye,je){return M(),D(C.readFileSync(ye),je)}function ve(ye,je){var Le=je&&je.type;switch(Le||ra&&Buffer.isBuffer(ye)&&(Le="buffer"),Le||"base64"){case"file":return ge(ye,je);case"base64":return D(Ju(Ac(ye)),je);case"binary":return D(Ju(ye),je)}return D(ye,je)}function re(ye,je){var Le=je||{},Me=Le.root||"Root Entry";if(ye.FullPaths||(ye.FullPaths=[]),ye.FileIndex||(ye.FileIndex=[]),ye.FullPaths.length!==ye.FileIndex.length)throw new Error("inconsistent CFB structure");ye.FullPaths.length===0&&(ye.FullPaths[0]=Me+"/",ye.FileIndex[0]={name:Me,type:5}),Le.CLSID&&(ye.FileIndex[0].clsid=Le.CLSID),Ce(ye)}function Ce(ye){var je="Sh33tJ5";if(!la.find(ye,"/"+je)){var Le=Rs(4);Le[0]=55,Le[1]=Le[3]=50,Le[2]=54,ye.FileIndex.push({name:je,type:2,content:Le,size:4,L:69,R:69,C:69}),ye.FullPaths.push(ye.FullPaths[0]+je),xe(ye)}}function xe(ye,je){re(ye);for(var Le=!1,Me=!1,Te=ye.FullPaths.length-1;Te>=0;--Te){var Pe=ye.FileIndex[Te];switch(Pe.type){case 0:Me?Le=!0:(ye.FileIndex.pop(),ye.FullPaths.pop());break;case 1:case 2:case 5:Me=!0,isNaN(Pe.R*Pe.L*Pe.C)&&(Le=!0),Pe.R>-1&&Pe.L>-1&&Pe.R==Pe.L&&(Le=!0);break;default:Le=!0;break}}if(!(!Le&&!je)){var gt=new Date(1987,1,19),jt=0,Dt=Object.create?Object.create(null):{},At=[];for(Te=0;Te<ye.FullPaths.length;++Te)Dt[ye.FullPaths[Te]]=!0,ye.FileIndex[Te].type!==0&&At.push([ye.FullPaths[Te],ye.FileIndex[Te]]);for(Te=0;Te<At.length;++Te){var _t=f(At[Te][0]);Me=Dt[_t],Me||(At.push([_t,{name:p(_t).replace("/",""),type:1,clsid:et,ct:gt,mt:gt,content:null}]),Dt[_t]=!0)}for(At.sort(function(vr,fr){return l(vr[0],fr[0])}),ye.FullPaths=[],ye.FileIndex=[],Te=0;Te<At.length;++Te)ye.FullPaths[Te]=At[Te][0],ye.FileIndex[Te]=At[Te][1];for(Te=0;Te<At.length;++Te){var or=ye.FileIndex[Te],yr=ye.FullPaths[Te];if(or.name=p(yr).replace("/",""),or.L=or.R=or.C=-(or.color=1),or.size=or.content?or.content.length:0,or.start=0,or.clsid=or.clsid||et,Te===0)or.C=At.length>1?1:-1,or.size=0,or.type=5;else if(yr.slice(-1)=="/"){for(jt=Te+1;jt<At.length&&f(ye.FullPaths[jt])!=yr;++jt);for(or.C=jt>=At.length?-1:jt,jt=Te+1;jt<At.length&&f(ye.FullPaths[jt])!=f(yr);++jt);or.R=jt>=At.length?-1:jt,or.type=1}else f(ye.FullPaths[Te+1]||"")==f(yr)&&(or.R=Te+1),or.type=2}}}function Ge(ye,je){var Le=je||{};if(Le.fileType=="mad")return tn(ye,Le);if(xe(ye),Le.fileType==="zip")return hn(ye,Le);var Me=(function(vr){for(var fr=0,_r=0,Ur=0;Ur<vr.FileIndex.length;++Ur){var Tn=vr.FileIndex[Ur];if(Tn.content){var vn=Tn.content.length;vn>0&&(vn<4096?fr+=vn+63>>6:_r+=vn+511>>9)}}for(var Zr=vr.FullPaths.length+3>>2,Mi=fr+7>>3,Fs=fr+127>>7,pi=Mi+_r+Zr+Fs,bi=pi+127>>7,oi=bi<=109?0:Math.ceil((bi-109)/127);pi+bi+oi+127>>7>bi;)oi=++bi<=109?0:Math.ceil((bi-109)/127);var Di=[1,oi,bi,Fs,Zr,_r,fr,0];return vr.FileIndex[0].size=fr<<6,Di[7]=(vr.FileIndex[0].start=Di[0]+Di[1]+Di[2]+Di[3]+Di[4]+Di[5])+(Di[6]+7>>3),Di})(ye),Te=Rs(Me[7]<<9),Pe=0,gt=0;{for(Pe=0;Pe<8;++Pe)Te.write_shift(1,ct[Pe]);for(Pe=0;Pe<8;++Pe)Te.write_shift(2,0);for(Te.write_shift(2,62),Te.write_shift(2,3),Te.write_shift(2,65534),Te.write_shift(2,9),Te.write_shift(2,6),Pe=0;Pe<3;++Pe)Te.write_shift(2,0);for(Te.write_shift(4,0),Te.write_shift(4,Me[2]),Te.write_shift(4,Me[0]+Me[1]+Me[2]+Me[3]-1),Te.write_shift(4,0),Te.write_shift(4,4096),Te.write_shift(4,Me[3]?Me[0]+Me[1]+Me[2]-1:nt),Te.write_shift(4,Me[3]),Te.write_shift(-4,Me[1]?Me[0]-1:nt),Te.write_shift(4,Me[1]),Pe=0;Pe<109;++Pe)Te.write_shift(-4,Pe<Me[2]?Me[1]+Pe:-1)}if(Me[1])for(gt=0;gt<Me[1];++gt){for(;Pe<236+gt*127;++Pe)Te.write_shift(-4,Pe<Me[2]?Me[1]+Pe:-1);Te.write_shift(-4,gt===Me[1]-1?nt:gt+1)}var jt=function(vr){for(gt+=vr;Pe<gt-1;++Pe)Te.write_shift(-4,Pe+1);vr&&(++Pe,Te.write_shift(-4,nt))};for(gt=Pe=0,gt+=Me[1];Pe<gt;++Pe)Te.write_shift(-4,He.DIFSECT);for(gt+=Me[2];Pe<gt;++Pe)Te.write_shift(-4,He.FATSECT);jt(Me[3]),jt(Me[4]);for(var Dt=0,At=0,_t=ye.FileIndex[0];Dt<ye.FileIndex.length;++Dt)_t=ye.FileIndex[Dt],_t.content&&(At=_t.content.length,!(At<4096)&&(_t.start=gt,jt(At+511>>9)));for(jt(Me[6]+7>>3);Te.l&511;)Te.write_shift(-4,He.ENDOFCHAIN);for(gt=Pe=0,Dt=0;Dt<ye.FileIndex.length;++Dt)_t=ye.FileIndex[Dt],_t.content&&(At=_t.content.length,!(!At||At>=4096)&&(_t.start=gt,jt(At+63>>6)));for(;Te.l&511;)Te.write_shift(-4,He.ENDOFCHAIN);for(Pe=0;Pe<Me[4]<<2;++Pe){var or=ye.FullPaths[Pe];if(!or||or.length===0){for(Dt=0;Dt<17;++Dt)Te.write_shift(4,0);for(Dt=0;Dt<3;++Dt)Te.write_shift(4,-1);for(Dt=0;Dt<12;++Dt)Te.write_shift(4,0);continue}_t=ye.FileIndex[Pe],Pe===0&&(_t.start=_t.size?_t.start-1:nt);var yr=Pe===0&&Le.root||_t.name;if(At=2*(yr.length+1),Te.write_shift(64,yr,"utf16le"),Te.write_shift(2,At),Te.write_shift(1,_t.type),Te.write_shift(1,_t.color),Te.write_shift(-4,_t.L),Te.write_shift(-4,_t.R),Te.write_shift(-4,_t.C),_t.clsid)Te.write_shift(16,_t.clsid,"hex");else for(Dt=0;Dt<4;++Dt)Te.write_shift(4,0);Te.write_shift(4,_t.state||0),Te.write_shift(4,0),Te.write_shift(4,0),Te.write_shift(4,0),Te.write_shift(4,0),Te.write_shift(4,_t.start),Te.write_shift(4,_t.size),Te.write_shift(4,0)}for(Pe=1;Pe<ye.FileIndex.length;++Pe)if(_t=ye.FileIndex[Pe],_t.size>=4096)if(Te.l=_t.start+1<<9,ra&&Buffer.isBuffer(_t.content))_t.content.copy(Te,Te.l,0,_t.size),Te.l+=_t.size+511&-512;else{for(Dt=0;Dt<_t.size;++Dt)Te.write_shift(1,_t.content[Dt]);for(;Dt&511;++Dt)Te.write_shift(1,0)}for(Pe=1;Pe<ye.FileIndex.length;++Pe)if(_t=ye.FileIndex[Pe],_t.size>0&&_t.size<4096)if(ra&&Buffer.isBuffer(_t.content))_t.content.copy(Te,Te.l,0,_t.size),Te.l+=_t.size+63&-64;else{for(Dt=0;Dt<_t.size;++Dt)Te.write_shift(1,_t.content[Dt]);for(;Dt&63;++Dt)Te.write_shift(1,0)}if(ra)Te.l=Te.length;else for(;Te.l<Te.length;)Te.write_shift(1,0);return Te}function $e(ye,je){var Le=ye.FullPaths.map(function(Dt){return Dt.toUpperCase()}),Me=Le.map(function(Dt){var At=Dt.split("/");return At[At.length-(Dt.slice(-1)=="/"?2:1)]}),Te=!1;je.charCodeAt(0)===47?(Te=!0,je=Le[0].slice(0,-1)+je):Te=je.indexOf("/")!==-1;var Pe=je.toUpperCase(),gt=Te===!0?Le.indexOf(Pe):Me.indexOf(Pe);if(gt!==-1)return ye.FileIndex[gt];var jt=!Pe.match(mg);for(Pe=Pe.replace(Tl,""),jt&&(Pe=Pe.replace(mg,"!")),gt=0;gt<Le.length;++gt)if((jt?Le[gt].replace(mg,"!"):Le[gt]).replace(Tl,"")==Pe||(jt?Me[gt].replace(mg,"!"):Me[gt]).replace(Tl,"")==Pe)return ye.FileIndex[gt];return null}var de=64,nt=-2,le="d0cf11e0a1b11ae1",ct=[208,207,17,224,161,177,26,225],et="00000000000000000000000000000000",He={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:nt,FREESECT:-1,HEADER_SIGNATURE:le,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:et,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function $t(ye,je,Le){M();var Me=Ge(ye,Le);C.writeFileSync(je,Me)}function Oe(ye){for(var je=new Array(ye.length),Le=0;Le<ye.length;++Le)je[Le]=String.fromCharCode(ye[Le]);return je.join("")}function It(ye,je){var Le=Ge(ye,je);switch(je&&je.type||"buffer"){case"file":return M(),C.writeFileSync(je.filename,Le),Le;case"binary":return typeof Le=="string"?Le:Oe(Le);case"base64":return ov(typeof Le=="string"?Le:Oe(Le));case"buffer":if(ra)return Buffer.isBuffer(Le)?Le:Cp(Le);case"array":return typeof Le=="string"?Ju(Le):Le}return Le}var me;function ne(ye){try{var je=ye.InflateRaw,Le=new je;if(Le._processChunk(new Uint8Array([3,0]),Le._finishFlushFlag),Le.bytesRead)me=ye;else throw new Error("zlib does not expose bytesRead")}catch(Me){console.error("cannot use native zlib: "+(Me.message||Me))}}function Ue(ye,je){if(!me)return mr(ye,je);var Le=me.InflateRaw,Me=new Le,Te=Me._processChunk(ye.slice(ye.l),Me._finishFlushFlag);return ye.l+=Me.bytesRead,Te}function Fe(ye){return me?me.deflateRawSync(ye):Ve(ye)}var Re=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],bt=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Gt=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Vt(ye){var je=(ye<<1|ye<<11)&139536|(ye<<5|ye<<15)&558144;return(je>>16|je>>8|je)&255}for(var Bt=typeof Uint8Array<"u",Yt=Bt?new Uint8Array(256):[],Or=0;Or<256;++Or)Yt[Or]=Vt(Or);function Ye(ye,je){var Le=Yt[ye&255];return je<=8?Le>>>8-je:(Le=Le<<8|Yt[ye>>8&255],je<=16?Le>>>16-je:(Le=Le<<8|Yt[ye>>16&255],Le>>>24-je))}function pn(ye,je){var Le=je&7,Me=je>>>3;return(ye[Me]|(Le<=6?0:ye[Me+1]<<8))>>>Le&3}function se(ye,je){var Le=je&7,Me=je>>>3;return(ye[Me]|(Le<=5?0:ye[Me+1]<<8))>>>Le&7}function Mt(ye,je){var Le=je&7,Me=je>>>3;return(ye[Me]|(Le<=4?0:ye[Me+1]<<8))>>>Le&15}function yt(ye,je){var Le=je&7,Me=je>>>3;return(ye[Me]|(Le<=3?0:ye[Me+1]<<8))>>>Le&31}function Ee(ye,je){var Le=je&7,Me=je>>>3;return(ye[Me]|(Le<=1?0:ye[Me+1]<<8))>>>Le&127}function Ne(ye,je,Le){var Me=je&7,Te=je>>>3,Pe=(1<<Le)-1,gt=ye[Te]>>>Me;return Le<8-Me||(gt|=ye[Te+1]<<8-Me,Le<16-Me)||(gt|=ye[Te+2]<<16-Me,Le<24-Me)||(gt|=ye[Te+3]<<24-Me),gt&Pe}function pt(ye,je,Le){var Me=je&7,Te=je>>>3;return Me<=5?ye[Te]|=(Le&7)<<Me:(ye[Te]|=Le<<Me&255,ye[Te+1]=(Le&7)>>8-Me),je+3}function Jt(ye,je,Le){var Me=je&7,Te=je>>>3;return Le=(Le&1)<<Me,ye[Te]|=Le,je+1}function Kt(ye,je,Le){var Me=je&7,Te=je>>>3;return Le<<=Me,ye[Te]|=Le&255,Le>>>=8,ye[Te+1]=Le,je+8}function Et(ye,je,Le){var Me=je&7,Te=je>>>3;return Le<<=Me,ye[Te]|=Le&255,Le>>>=8,ye[Te+1]=Le&255,ye[Te+2]=Le>>>8,je+16}function lr(ye,je){var Le=ye.length,Me=2*Le>je?2*Le:je+5,Te=0;if(Le>=je)return ye;if(ra){var Pe=lv(Me);if(ye.copy)ye.copy(Pe);else for(;Te<ye.length;++Te)Pe[Te]=ye[Te];return Pe}else if(Bt){var gt=new Uint8Array(Me);if(gt.set)gt.set(ye);else for(;Te<Le;++Te)gt[Te]=ye[Te];return gt}return ye.length=Me,ye}function pr(ye){for(var je=new Array(ye),Le=0;Le<ye;++Le)je[Le]=0;return je}function ir(ye,je,Le){var Me=1,Te=0,Pe=0,gt=0,jt=0,Dt=ye.length,At=Bt?new Uint16Array(32):pr(32);for(Pe=0;Pe<32;++Pe)At[Pe]=0;for(Pe=Dt;Pe<Le;++Pe)ye[Pe]=0;Dt=ye.length;var _t=Bt?new Uint16Array(Dt):pr(Dt);for(Pe=0;Pe<Dt;++Pe)At[Te=ye[Pe]]++,Me<Te&&(Me=Te),_t[Pe]=0;for(At[0]=0,Pe=1;Pe<=Me;++Pe)At[Pe+16]=jt=jt+At[Pe-1]<<1;for(Pe=0;Pe<Dt;++Pe)jt=ye[Pe],jt!=0&&(_t[Pe]=At[jt+16]++);var or=0;for(Pe=0;Pe<Dt;++Pe)if(or=ye[Pe],or!=0)for(jt=Ye(_t[Pe],Me)>>Me-or,gt=(1<<Me+4-or)-1;gt>=0;--gt)je[jt|gt<<or]=or&15|Pe<<4;return Me}var st=Bt?new Uint16Array(512):pr(512),fe=Bt?new Uint16Array(32):pr(32);if(!Bt){for(var he=0;he<512;++he)st[he]=0;for(he=0;he<32;++he)fe[he]=0}(function(){for(var ye=[],je=0;je<32;je++)ye.push(5);ir(ye,fe,32);var Le=[];for(je=0;je<=143;je++)Le.push(8);for(;je<=255;je++)Le.push(9);for(;je<=279;je++)Le.push(7);for(;je<=287;je++)Le.push(8);ir(Le,st,288)})();var we=(function(){for(var je=Bt?new Uint8Array(32768):[],Le=0,Me=0;Le<Gt.length-1;++Le)for(;Me<Gt[Le+1];++Me)je[Me]=Le;for(;Me<32768;++Me)je[Me]=29;var Te=Bt?new Uint8Array(259):[];for(Le=0,Me=0;Le<bt.length-1;++Le)for(;Me<bt[Le+1];++Me)Te[Me]=Le;function Pe(jt,Dt){for(var At=0;At<jt.length;){var _t=Math.min(65535,jt.length-At),or=At+_t==jt.length;for(Dt.write_shift(1,+or),Dt.write_shift(2,_t),Dt.write_shift(2,~_t&65535);_t-- >0;)Dt[Dt.l++]=jt[At++]}return Dt.l}function gt(jt,Dt){for(var At=0,_t=0,or=Bt?new Uint16Array(32768):[];_t<jt.length;){var yr=Math.min(65535,jt.length-_t);if(yr<10){for(At=pt(Dt,At,+(_t+yr==jt.length)),At&7&&(At+=8-(At&7)),Dt.l=At/8|0,Dt.write_shift(2,yr),Dt.write_shift(2,~yr&65535);yr-- >0;)Dt[Dt.l++]=jt[_t++];At=Dt.l*8;continue}At=pt(Dt,At,+(_t+yr==jt.length)+2);for(var vr=0;yr-- >0;){var fr=jt[_t];vr=(vr<<5^fr)&32767;var _r=-1,Ur=0;if((_r=or[vr])&&(_r|=_t&-32768,_r>_t&&(_r-=32768),_r<_t))for(;jt[_r+Ur]==jt[_t+Ur]&&Ur<250;)++Ur;if(Ur>2){fr=Te[Ur],fr<=22?At=Kt(Dt,At,Yt[fr+1]>>1)-1:(Kt(Dt,At,3),At+=5,Kt(Dt,At,Yt[fr-23]>>5),At+=3);var Tn=fr<8?0:fr-4>>2;Tn>0&&(Et(Dt,At,Ur-bt[fr]),At+=Tn),fr=je[_t-_r],At=Kt(Dt,At,Yt[fr]>>3),At-=3;var vn=fr<4?0:fr-2>>1;vn>0&&(Et(Dt,At,_t-_r-Gt[fr]),At+=vn);for(var Zr=0;Zr<Ur;++Zr)or[vr]=_t&32767,vr=(vr<<5^jt[_t])&32767,++_t;yr-=Ur-1}else fr<=143?fr=fr+48:At=Jt(Dt,At,1),At=Kt(Dt,At,Yt[fr]),or[vr]=_t&32767,++_t}At=Kt(Dt,At,0)-1}return Dt.l=(At+7)/8|0,Dt.l}return function(Dt,At){return Dt.length<8?Pe(Dt,At):gt(Dt,At)}})();function Ve(ye){var je=Rs(50+Math.floor(ye.length*1.1)),Le=we(ye,je);return je.slice(0,Le)}var Xe=Bt?new Uint16Array(32768):pr(32768),xt=Bt?new Uint16Array(32768):pr(32768),ot=Bt?new Uint16Array(128):pr(128),it=1,vt=1;function zt(ye,je){var Le=yt(ye,je)+257;je+=5;var Me=yt(ye,je)+1;je+=5;var Te=Mt(ye,je)+4;je+=4;for(var Pe=0,gt=Bt?new Uint8Array(19):pr(19),jt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Dt=1,At=Bt?new Uint8Array(8):pr(8),_t=Bt?new Uint8Array(8):pr(8),or=gt.length,yr=0;yr<Te;++yr)gt[Re[yr]]=Pe=se(ye,je),Dt<Pe&&(Dt=Pe),At[Pe]++,je+=3;var vr=0;for(At[0]=0,yr=1;yr<=Dt;++yr)_t[yr]=vr=vr+At[yr-1]<<1;for(yr=0;yr<or;++yr)(vr=gt[yr])!=0&&(jt[yr]=_t[vr]++);var fr=0;for(yr=0;yr<or;++yr)if(fr=gt[yr],fr!=0){vr=Yt[jt[yr]]>>8-fr;for(var _r=(1<<7-fr)-1;_r>=0;--_r)ot[vr|_r<<fr]=fr&7|yr<<3}var Ur=[];for(Dt=1;Ur.length<Le+Me;)switch(vr=ot[Ee(ye,je)],je+=vr&7,vr>>>=3){case 16:for(Pe=3+pn(ye,je),je+=2,vr=Ur[Ur.length-1];Pe-- >0;)Ur.push(vr);break;case 17:for(Pe=3+se(ye,je),je+=3;Pe-- >0;)Ur.push(0);break;case 18:for(Pe=11+Ee(ye,je),je+=7;Pe-- >0;)Ur.push(0);break;default:Ur.push(vr),Dt<vr&&(Dt=vr);break}var Tn=Ur.slice(0,Le),vn=Ur.slice(Le);for(yr=Le;yr<286;++yr)Tn[yr]=0;for(yr=Me;yr<30;++yr)vn[yr]=0;return it=ir(Tn,Xe,286),vt=ir(vn,xt,30),je}function Wt(ye,je){if(ye[0]==3&&!(ye[1]&3))return[Td(je),2];for(var Le=0,Me=0,Te=lv(je||1<<18),Pe=0,gt=Te.length>>>0,jt=0,Dt=0;(Me&1)==0;){if(Me=se(ye,Le),Le+=3,Me>>>1)Me>>1==1?(jt=9,Dt=5):(Le=zt(ye,Le),jt=it,Dt=vt);else{Le&7&&(Le+=8-(Le&7));var At=ye[Le>>>3]|ye[(Le>>>3)+1]<<8;if(Le+=32,At>0)for(!je&&gt<Pe+At&&(Te=lr(Te,Pe+At),gt=Te.length);At-- >0;)Te[Pe++]=ye[Le>>>3],Le+=8;continue}for(;;){!je&&gt<Pe+32767&&(Te=lr(Te,Pe+32767),gt=Te.length);var _t=Ne(ye,Le,jt),or=Me>>>1==1?st[_t]:Xe[_t];if(Le+=or&15,or>>>=4,(or>>>8&255)===0)Te[Pe++]=or;else{if(or==256)break;or-=257;var yr=or<8?0:or-4>>2;yr>5&&(yr=0);var vr=Pe+bt[or];yr>0&&(vr+=Ne(ye,Le,yr),Le+=yr),_t=Ne(ye,Le,Dt),or=Me>>>1==1?fe[_t]:xt[_t],Le+=or&15,or>>>=4;var fr=or<4?0:or-2>>1,_r=Gt[or];for(fr>0&&(_r+=Ne(ye,Le,fr),Le+=fr),!je&&gt<vr&&(Te=lr(Te,vr+100),gt=Te.length);Pe<vr;)Te[Pe]=Te[Pe-_r],++Pe}}}return je?[Te,Le+7>>>3]:[Te.slice(0,Pe),Le+7>>>3]}function mr(ye,je){var Le=ye.slice(ye.l||0),Me=Wt(Le,je);return ye.l+=Me[1],Me[0]}function kr(ye,je){if(ye)typeof console<"u"&&console.error(je);else throw new Error(je)}function Kr(ye,je){var Le=ye;ho(Le,0);var Me=[],Te=[],Pe={FileIndex:Me,FullPaths:Te};re(Pe,{root:je.root});for(var gt=Le.length-4;(Le[gt]!=80||Le[gt+1]!=75||Le[gt+2]!=5||Le[gt+3]!=6)&&gt>=0;)--gt;Le.l=gt+4,Le.l+=4;var jt=Le.read_shift(2);Le.l+=6;var Dt=Le.read_shift(4);for(Le.l=Dt,gt=0;gt<jt;++gt){Le.l+=20;var At=Le.read_shift(4),_t=Le.read_shift(4),or=Le.read_shift(2),yr=Le.read_shift(2),vr=Le.read_shift(2);Le.l+=8;var fr=Le.read_shift(4),_r=s(Le.slice(Le.l+or,Le.l+or+yr));Le.l+=or+yr+vr;var Ur=Le.l;Le.l=fr+4,yn(Le,At,_t,Pe,_r),Le.l=Ur}return Pe}function yn(ye,je,Le,Me,Te){ye.l+=2;var Pe=ye.read_shift(2),gt=ye.read_shift(2),jt=_(ye);if(Pe&8257)throw new Error("Unsupported ZIP encryption");for(var Dt=ye.read_shift(4),At=ye.read_shift(4),_t=ye.read_shift(4),or=ye.read_shift(2),yr=ye.read_shift(2),vr="",fr=0;fr<or;++fr)vr+=String.fromCharCode(ye[ye.l++]);if(yr){var _r=s(ye.slice(ye.l,ye.l+yr));(_r[21589]||{}).mt&&(jt=_r[21589].mt),((Te||{})[21589]||{}).mt&&(jt=Te[21589].mt)}ye.l+=yr;var Ur=ye.slice(ye.l,ye.l+At);switch(gt){case 8:Ur=Ue(ye,_t);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+gt)}var Tn=!1;Pe&8&&(Dt=ye.read_shift(4),Dt==134695760&&(Dt=ye.read_shift(4),Tn=!0),At=ye.read_shift(4),_t=ye.read_shift(4)),At!=je&&kr(Tn,"Bad compressed size: "+je+" != "+At),_t!=Le&&kr(Tn,"Bad uncompressed size: "+Le+" != "+_t),ba(Me,vr,Ur,{unsafe:!0,mt:jt})}function hn(ye,je){var Le=je||{},Me=[],Te=[],Pe=Rs(1),gt=Le.compression?8:0,jt=0,Dt=0,At=0,_t=0,or=0,yr=ye.FullPaths[0],vr=yr,fr=ye.FileIndex[0],_r=[],Ur=0;for(Dt=1;Dt<ye.FullPaths.length;++Dt)if(vr=ye.FullPaths[Dt].slice(yr.length),fr=ye.FileIndex[Dt],!(!fr.size||!fr.content||vr=="Sh33tJ5")){var Tn=_t,vn=Rs(vr.length);for(At=0;At<vr.length;++At)vn.write_shift(1,vr.charCodeAt(At)&127);vn=vn.slice(0,vn.l),_r[or]=dE.buf(fr.content,0);var Zr=fr.content;gt==8&&(Zr=Fe(Zr)),Pe=Rs(30),Pe.write_shift(4,67324752),Pe.write_shift(2,20),Pe.write_shift(2,jt),Pe.write_shift(2,gt),fr.mt?b(Pe,fr.mt):Pe.write_shift(4,0),Pe.write_shift(-4,_r[or]),Pe.write_shift(4,Zr.length),Pe.write_shift(4,fr.content.length),Pe.write_shift(2,vn.length),Pe.write_shift(2,0),_t+=Pe.length,Me.push(Pe),_t+=vn.length,Me.push(vn),_t+=Zr.length,Me.push(Zr),Pe=Rs(46),Pe.write_shift(4,33639248),Pe.write_shift(2,0),Pe.write_shift(2,20),Pe.write_shift(2,jt),Pe.write_shift(2,gt),Pe.write_shift(4,0),Pe.write_shift(-4,_r[or]),Pe.write_shift(4,Zr.length),Pe.write_shift(4,fr.content.length),Pe.write_shift(2,vn.length),Pe.write_shift(2,0),Pe.write_shift(2,0),Pe.write_shift(2,0),Pe.write_shift(2,0),Pe.write_shift(4,0),Pe.write_shift(4,Tn),Ur+=Pe.l,Te.push(Pe),Ur+=vn.length,Te.push(vn),++or}return Pe=Rs(22),Pe.write_shift(4,101010256),Pe.write_shift(2,0),Pe.write_shift(2,0),Pe.write_shift(2,or),Pe.write_shift(2,or),Pe.write_shift(4,Ur),Pe.write_shift(4,_t),Pe.write_shift(2,0),gd([gd(Me),gd(Te),Pe])}var ht={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function En(ye,je){if(ye.ctype)return ye.ctype;var Le=ye.name||"",Me=Le.match(/\.([^\.]+)$/);return Me&&ht[Me[1]]||je&&(Me=(Le=je).match(/[\.\\]([^\.\\])+$/),Me&&ht[Me[1]])?ht[Me[1]]:"application/octet-stream"}function Kn(ye){for(var je=ov(ye),Le=[],Me=0;Me<je.length;Me+=76)Le.push(je.slice(Me,Me+76));return Le.join(`\r
`)+`\r
`}function Qr(ye){var je=ye.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(At){var _t=At.charCodeAt(0).toString(16).toUpperCase();return"="+(_t.length==1?"0"+_t:_t)});je=je.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),je.charAt(0)==`
`&&(je="=0D"+je.slice(1)),je=je.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Le=[],Me=je.split(`\r
`),Te=0;Te<Me.length;++Te){var Pe=Me[Te];if(Pe.length==0){Le.push("");continue}for(var gt=0;gt<Pe.length;){var jt=76,Dt=Pe.slice(gt,gt+jt);Dt.charAt(jt-1)=="="?jt--:Dt.charAt(jt-2)=="="?jt-=2:Dt.charAt(jt-3)=="="&&(jt-=3),Dt=Pe.slice(gt,gt+jt),gt+=jt,gt<Pe.length&&(Dt+="="),Le.push(Dt)}}return Le.join(`\r
`)}function Ln(ye){for(var je=[],Le=0;Le<ye.length;++Le){for(var Me=ye[Le];Le<=ye.length&&Me.charAt(Me.length-1)=="=";)Me=Me.slice(0,Me.length-1)+ye[++Le];je.push(Me)}for(var Te=0;Te<je.length;++Te)je[Te]=je[Te].replace(/[=][0-9A-Fa-f]{2}/g,function(Pe){return String.fromCharCode(parseInt(Pe.slice(1),16))});return Ju(je.join(`\r
`))}function Ba(ye,je,Le){for(var Me="",Te="",Pe="",gt,jt=0;jt<10;++jt){var Dt=je[jt];if(!Dt||Dt.match(/^\s*$/))break;var At=Dt.match(/^(.*?):\s*([^\s].*)$/);if(At)switch(At[1].toLowerCase()){case"content-location":Me=At[2].trim();break;case"content-type":Pe=At[2].trim();break;case"content-transfer-encoding":Te=At[2].trim();break}}switch(++jt,Te.toLowerCase()){case"base64":gt=Ju(Ac(je.slice(jt).join("")));break;case"quoted-printable":gt=Ln(je.slice(jt));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Te)}var _t=ba(ye,Me.slice(Le.length),gt,{unsafe:!0});Pe&&(_t.ctype=Pe)}function zn(ye,je){if(Oe(ye.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Le=je&&je.root||"",Me=(ra&&Buffer.isBuffer(ye)?ye.toString("binary"):Oe(ye)).split(`\r
`),Te=0,Pe="";for(Te=0;Te<Me.length;++Te)if(Pe=Me[Te],!!/^Content-Location:/i.test(Pe)&&(Pe=Pe.slice(Pe.indexOf("file")),Le||(Le=Pe.slice(0,Pe.lastIndexOf("/")+1)),Pe.slice(0,Le.length)!=Le))for(;Le.length>0&&(Le=Le.slice(0,Le.length-1),Le=Le.slice(0,Le.lastIndexOf("/")+1),Pe.slice(0,Le.length)!=Le););var gt=(Me[1]||"").match(/boundary="(.*?)"/);if(!gt)throw new Error("MAD cannot find boundary");var jt="--"+(gt[1]||""),Dt=[],At=[],_t={FileIndex:Dt,FullPaths:At};re(_t);var or,yr=0;for(Te=0;Te<Me.length;++Te){var vr=Me[Te];vr!==jt&&vr!==jt+"--"||(yr++&&Ba(_t,Me.slice(or,Te),Le),or=Te)}return _t}function tn(ye,je){var Le=je||{},Me=Le.boundary||"SheetJS";Me="------="+Me;for(var Te=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Me.slice(2)+'"',"","",""],Pe=ye.FullPaths[0],gt=Pe,jt=ye.FileIndex[0],Dt=1;Dt<ye.FullPaths.length;++Dt)if(gt=ye.FullPaths[Dt].slice(Pe.length),jt=ye.FileIndex[Dt],!(!jt.size||!jt.content||gt=="Sh33tJ5")){gt=gt.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ur){return"_x"+Ur.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ur){return"_u"+Ur.charCodeAt(0).toString(16)+"_"});for(var At=jt.content,_t=ra&&Buffer.isBuffer(At)?At.toString("binary"):Oe(At),or=0,yr=Math.min(1024,_t.length),vr=0,fr=0;fr<=yr;++fr)(vr=_t.charCodeAt(fr))>=32&&vr<128&&++or;var _r=or>=yr*4/5;Te.push(Me),Te.push("Content-Location: "+(Le.root||"file:///C:/SheetJS/")+gt),Te.push("Content-Transfer-Encoding: "+(_r?"quoted-printable":"base64")),Te.push("Content-Type: "+En(jt,gt)),Te.push(""),Te.push(_r?Qr(_t):Kn(_t))}return Te.push(Me+`--\r
`),Te.join(`\r
`)}function Bn(ye){var je={};return re(je,ye),je}function ba(ye,je,Le,Me){var Te=Me&&Me.unsafe;Te||re(ye);var Pe=!Te&&la.find(ye,je);if(!Pe){var gt=ye.FullPaths[0];je.slice(0,gt.length)==gt?gt=je:(gt.slice(-1)!="/"&&(gt+="/"),gt=(gt+je).replace("//","/")),Pe={name:p(je),type:2},ye.FileIndex.push(Pe),ye.FullPaths.push(gt),Te||la.utils.cfb_gc(ye)}return Pe.content=Le,Pe.size=Le?Le.length:0,Me&&(Me.CLSID&&(Pe.clsid=Me.CLSID),Me.mt&&(Pe.mt=Me.mt),Me.ct&&(Pe.ct=Me.ct)),Pe}function El(ye,je){re(ye);var Le=la.find(ye,je);if(Le){for(var Me=0;Me<ye.FileIndex.length;++Me)if(ye.FileIndex[Me]==Le)return ye.FileIndex.splice(Me,1),ye.FullPaths.splice(Me,1),!0}return!1}function Zo(ye,je,Le){re(ye);var Me=la.find(ye,je);if(Me){for(var Te=0;Te<ye.FileIndex.length;++Te)if(ye.FileIndex[Te]==Me)return ye.FileIndex[Te].name=p(Le),ye.FullPaths[Te]=Le,!0}return!1}function Qt(ye){xe(ye,!0)}return u.find=$e,u.read=ve,u.parse=D,u.write=It,u.writeFile=$t,u.utils={cfb_new:Bn,cfb_add:ba,cfb_del:El,cfb_mov:Zo,cfb_gc:Qt,ReadShift:bg,CheckField:E2,prep_blob:ho,bconcat:gd,use_zlib:ne,_deflateRaw:Ve,_inflateRaw:mr,consts:He},u})();function pE(r){if(typeof Deno<"u")return Deno.readFileSync(r);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(r);u.open("r"),u.encoding="binary";var l=u.read();return u.close(),l}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("Cannot access file "+r)}function Uh(r){for(var u=Object.keys(r),l=[],f=0;f<u.length;++f)Object.prototype.hasOwnProperty.call(r,u[f])&&l.push(u[f]);return l}function s1(r){for(var u=[],l=Uh(r),f=0;f!==l.length;++f)u[r[l[f]]]=l[f];return u}var Tx=new Date(1899,11,30,0,0,0);function Sl(r,u){var l=r.getTime(),f=Tx.getTime()+(r.getTimezoneOffset()-Tx.getTimezoneOffset())*6e4;return(l-f)/(1440*60*1e3)}var a2=new Date,mE=Tx.getTime()+(a2.getTimezoneOffset()-Tx.getTimezoneOffset())*6e4,gv=a2.getTimezoneOffset();function Ox(r){var u=new Date;return u.setTime(r*24*60*60*1e3+mE),u.getTimezoneOffset()!==gv&&u.setTime(u.getTime()+(u.getTimezoneOffset()-gv)*6e4),u}function gE(r){var u=0,l=0,f=!1,p=r.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!p)throw new Error("|"+r+"| is not an ISO8601 Duration");for(var b=1;b!=p.length;++b)if(p[b]){switch(l=1,b>3&&(f=!0),p[b].slice(p[b].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+p[b].slice(p[b].length-1));case"D":l*=24;case"H":l*=60;case"M":if(f)l*=60;else throw new Error("Unsupported ISO Duration Field: M")}u+=l*parseInt(p[b],10)}return u}var _v=new Date("2017-02-19T19:06:09.000Z"),i2=isNaN(_v.getFullYear())?new Date("2/19/17"):_v,_E=i2.getFullYear()==2017;function Ks(r,u){var l=new Date(r);if(_E)return u>0?l.setTime(l.getTime()+l.getTimezoneOffset()*60*1e3):u<0&&l.setTime(l.getTime()-l.getTimezoneOffset()*60*1e3),l;if(r instanceof Date)return r;if(i2.getFullYear()==1917&&!isNaN(l.getFullYear())){var f=l.getFullYear();return r.indexOf(""+f)>-1||l.setFullYear(l.getFullYear()+100),l}var p=r.match(/\d+/g)||["2017","2","19","0","0","0"],b=new Date(+p[0],+p[1]-1,+p[2],+p[3]||0,+p[4]||0,+p[5]||0);return r.indexOf("Z")>-1&&(b=new Date(b.getTime()-b.getTimezoneOffset()*60*1e3)),b}function Ep(r,u){if(ra&&Buffer.isBuffer(r)){if(u){if(r[0]==255&&r[1]==254)return _g(r.slice(2).toString("utf16le"));if(r[1]==254&&r[2]==255)return _g(qb(r.slice(2).toString("binary")))}return r.toString("binary")}if(typeof TextDecoder<"u")try{if(u){if(r[0]==255&&r[1]==254)return _g(new TextDecoder("utf-16le").decode(r.slice(2)));if(r[0]==254&&r[1]==255)return _g(new TextDecoder("utf-16be").decode(r.slice(2)))}var l={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(r)&&(r=new Uint8Array(r)),new TextDecoder("latin1").decode(r).replace(/[]/g,function(b){return l[b]||b})}catch{}for(var f=[],p=0;p!=r.length;++p)f.push(String.fromCharCode(r[p]));return f.join("")}function fo(r){if(typeof JSON<"u"&&!Array.isArray(r))return JSON.parse(JSON.stringify(r));if(typeof r!="object"||r==null)return r;if(r instanceof Date)return new Date(r.getTime());var u={};for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(u[l]=fo(r[l]));return u}function Xi(r,u){for(var l="";l.length<u;)l+=r;return l}function rh(r){var u=Number(r);if(!isNaN(u))return isFinite(u)?u:NaN;if(!/\d/.test(r))return u;var l=1,f=r.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return l*=100,""});return!isNaN(u=Number(f))||(f=f.replace(/[(](.*)[)]/,function(p,b){return l=-l,b}),!isNaN(u=Number(f)))?u/l:u}var xE=["january","february","march","april","may","june","july","august","september","october","november","december"];function Y0(r){var u=new Date(r),l=new Date(NaN),f=u.getYear(),p=u.getMonth(),b=u.getDate();if(isNaN(b))return l;var _=r.toLowerCase();if(_.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(_=_.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),_.length>3&&xE.indexOf(_)==-1)return l}else if(_.match(/[a-z]/))return l;return f<0||f>8099?l:(p>0||b>1)&&f!=101?u:r.match(/[^-0-9:,\/\\]/)?l:u}var yE=(function(){var r="abacaba".split(/(:?b)/i).length==5;return function(l,f,p){if(r||typeof f=="string")return l.split(f);for(var b=l.split(f),_=[b[0]],s=1;s<b.length;++s)_.push(p),_.push(b[s]);return _}})();function s2(r){return r?r.content&&r.type?Ep(r.content,!0):r.data?pg(r.data):r.asNodeBuffer&&ra?pg(r.asNodeBuffer().toString("binary")):r.asBinary?pg(r.asBinary()):r._data&&r._data.getContent?pg(Ep(Array.prototype.slice.call(r._data.getContent(),0))):null:null}function o2(r){if(!r)return null;if(r.data)return iv(r.data);if(r.asNodeBuffer&&ra)return r.asNodeBuffer();if(r._data&&r._data.getContent){var u=r._data.getContent();return typeof u=="string"?iv(u):Array.prototype.slice.call(u)}return r.content&&r.type?r.content:null}function vE(r){return r&&r.name.slice(-4)===".bin"?o2(r):s2(r)}function nu(r,u){for(var l=r.FullPaths||Uh(r.files),f=u.toLowerCase().replace(/[\/]/g,"\\"),p=f.replace(/\\/g,"/"),b=0;b<l.length;++b){var _=l[b].replace(/^Root Entry[\/]/,"").toLowerCase();if(f==_||p==_)return r.files?r.files[l[b]]:r.FileIndex[b]}return null}function o1(r,u){var l=nu(r,u);if(l==null)throw new Error("Cannot find file "+u+" in zip");return l}function ys(r,u,l){if(!l)return vE(o1(r,u));if(!u)return null;try{return ys(r,u)}catch{return null}}function Ec(r,u,l){if(!l)return s2(o1(r,u));if(!u)return null;try{return Ec(r,u)}catch{return null}}function bE(r,u,l){return o2(o1(r,u))}function xv(r){for(var u=r.FullPaths||Uh(r.files),l=[],f=0;f<u.length;++f)u[f].slice(-1)!="/"&&l.push(u[f].replace(/^Root Entry[\/]/,""));return l.sort()}function wE(r,u,l){if(r.FullPaths){if(typeof l=="string"){var f;return ra?f=Cp(l):f=US(l),la.utils.cfb_add(r,u,f)}la.utils.cfb_add(r,u,l)}else r.file(u,l)}function l2(r,u){switch(u.type){case"base64":return la.read(r,{type:"base64"});case"binary":return la.read(r,{type:"binary"});case"buffer":case"array":return la.read(r,{type:"buffer"})}throw new Error("Unrecognized type "+u.type)}function gg(r,u){if(r.charAt(0)=="/")return r.slice(1);var l=u.split("/");u.slice(-1)!="/"&&l.pop();for(var f=r.split("/");f.length!==0;){var p=f.shift();p===".."?l.pop():p!=="."&&l.push(p)}return l.join("/")}var c2=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,TE=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,yv=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,SE=/<[^>]*>/g,qo=c2.match(yv)?yv:SE,EE=/<\w*:/,AE=/<(\/?)\w+:/;function xn(r,u,l){for(var f={},p=0,b=0;p!==r.length&&!((b=r.charCodeAt(p))===32||b===10||b===13);++p);if(u||(f[0]=r.slice(0,p)),p===r.length)return f;var _=r.match(TE),s=0,C="",M=0,D="",B="",U=1;if(_)for(M=0;M!=_.length;++M){for(B=_[M],b=0;b!=B.length&&B.charCodeAt(b)!==61;++b);for(D=B.slice(0,b).trim();B.charCodeAt(b+1)==32;)++b;for(U=(p=B.charCodeAt(b+1))==34||p==39?1:0,C=B.slice(b+1+U,B.length-U),s=0;s!=D.length&&D.charCodeAt(s)!==58;++s);if(s===D.length)D.indexOf("_")>0&&(D=D.slice(0,D.indexOf("_"))),f[D]=C,f[D.toLowerCase()]=C;else{var j=(s===5&&D.slice(0,5)==="xmlns"?"xmlns":"")+D.slice(s+1);if(f[j]&&D.slice(s-3,s)=="ext")continue;f[j]=C,f[j.toLowerCase()]=C}}return f}function Vh(r){return r.replace(AE,"<$1")}var u2={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},kE=s1(u2),xa=(function(){var r=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,u=/_x([\da-fA-F]{4})_/ig;return function l(f){var p=f+"",b=p.indexOf("<![CDATA[");if(b==-1)return p.replace(r,function(s,C){return u2[s]||String.fromCharCode(parseInt(C,s.indexOf("x")>-1?16:10))||s}).replace(u,function(s,C){return String.fromCharCode(parseInt(C,16))});var _=p.indexOf("]]>");return l(p.slice(0,b))+p.slice(b+9,_)+l(p.slice(_+3))}})(),CE=/[&<>'"]/g,ME=/[\u0000-\u001f]/g;function l1(r){var u=r+"";return u.replace(CE,function(l){return kE[l]}).replace(/\n/g,"<br/>").replace(ME,function(l){return"&#x"+("000"+l.charCodeAt(0).toString(16)).slice(-4)+";"})}var vv=(function(){var r=/&#(\d+);/g;function u(l,f){return String.fromCharCode(parseInt(f,10))}return function(f){return f.replace(r,u)}})();function vi(r){switch(r){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function my(r){for(var u="",l=0,f=0,p=0,b=0,_=0,s=0;l<r.length;){if(f=r.charCodeAt(l++),f<128){u+=String.fromCharCode(f);continue}if(p=r.charCodeAt(l++),f>191&&f<224){_=(f&31)<<6,_|=p&63,u+=String.fromCharCode(_);continue}if(b=r.charCodeAt(l++),f<240){u+=String.fromCharCode((f&15)<<12|(p&63)<<6|b&63);continue}_=r.charCodeAt(l++),s=((f&7)<<18|(p&63)<<12|(b&63)<<6|_&63)-65536,u+=String.fromCharCode(55296+(s>>>10&1023)),u+=String.fromCharCode(56320+(s&1023))}return u}function bv(r){var u=Td(2*r.length),l,f,p=1,b=0,_=0,s;for(f=0;f<r.length;f+=p)p=1,(s=r.charCodeAt(f))<128?l=s:s<224?(l=(s&31)*64+(r.charCodeAt(f+1)&63),p=2):s<240?(l=(s&15)*4096+(r.charCodeAt(f+1)&63)*64+(r.charCodeAt(f+2)&63),p=3):(p=4,l=(s&7)*262144+(r.charCodeAt(f+1)&63)*4096+(r.charCodeAt(f+2)&63)*64+(r.charCodeAt(f+3)&63),l-=65536,_=55296+(l>>>10&1023),l=56320+(l&1023)),_!==0&&(u[b++]=_&255,u[b++]=_>>>8,_=0),u[b++]=l%256,u[b++]=l>>>8;return u.slice(0,b).toString("ucs2")}function wv(r){return Cp(r,"binary").toString("utf8")}var J_="foo bar baz",si=ra&&(wv(J_)==my(J_)&&wv||bv(J_)==my(J_)&&bv)||my,_g=ra?function(r){return Cp(r,"utf8").toString("binary")}:function(r){for(var u=[],l=0,f=0,p=0;l<r.length;)switch(f=r.charCodeAt(l++),!0){case f<128:u.push(String.fromCharCode(f));break;case f<2048:u.push(String.fromCharCode(192+(f>>6))),u.push(String.fromCharCode(128+(f&63)));break;case(f>=55296&&f<57344):f-=55296,p=r.charCodeAt(l++)-56320+(f<<10),u.push(String.fromCharCode(240+(p>>18&7))),u.push(String.fromCharCode(144+(p>>12&63))),u.push(String.fromCharCode(128+(p>>6&63))),u.push(String.fromCharCode(128+(p&63)));break;default:u.push(String.fromCharCode(224+(f>>12))),u.push(String.fromCharCode(128+(f>>6&63))),u.push(String.fromCharCode(128+(f&63)))}return u.join("")},Pg=(function(){var r={};return function(l,f){var p=l+"|"+(f||"");return r[p]?r[p]:r[p]=new RegExp("<(?:\\w+:)?"+l+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+l+">",f||"")}})(),h2=(function(){var r=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(u){return[new RegExp("&"+u[0]+";","ig"),u[1]]});return function(l){for(var f=l.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),p=0;p<r.length;++p)f=f.replace(r[p][0],r[p][1]);return f}})(),DE=(function(){var r={};return function(l){return r[l]!==void 0?r[l]:r[l]=new RegExp("<(?:vt:)?"+l+">([\\s\\S]*?)</(?:vt:)?"+l+">","g")}})(),RE=/<\/?(?:vt:)?variant>/g,IE=/<(?:vt:)([^>]*)>([\s\S]*)</;function Tv(r,u){var l=xn(r),f=r.match(DE(l.baseType))||[],p=[];if(f.length!=l.size){if(u.WTF)throw new Error("unexpected vector length "+f.length+" != "+l.size);return p}return f.forEach(function(b){var _=b.replace(RE,"").match(IE);_&&p.push({v:si(_[2]),t:_[1]})}),p}var PE=/(^\s|\s$|\n)/;function FE(r){return Uh(r).map(function(u){return" "+u+'="'+r[u]+'"'}).join("")}function LE(r,u,l){return"<"+r+(l!=null?FE(l):"")+(u!=null?(u.match(PE)?' xml:space="preserve"':"")+">"+u+"</"+r:"/")+">"}function c1(r){if(ra&&Buffer.isBuffer(r))return r.toString("utf8");if(typeof r=="string")return r;if(typeof Uint8Array<"u"&&r instanceof Uint8Array)return si(Mp(n1(r)));throw new Error("Bad input format: expected Buffer or string")}var Fg=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,zE={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},OE=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function BE(r,u){for(var l=1-2*(r[u+7]>>>7),f=((r[u+7]&127)<<4)+(r[u+6]>>>4&15),p=r[u+6]&15,b=5;b>=0;--b)p=p*256+r[u+b];return f==2047?p==0?l*(1/0):NaN:(f==0?f=-1022:(f-=1023,p+=Math.pow(2,52)),l*Math.pow(2,f-52)*p)}function NE(r,u,l){var f=(u<0||1/u==-1/0?1:0)<<7,p=0,b=0,_=f?-u:u;isFinite(_)?_==0?p=b=0:(p=Math.floor(Math.log(_)/Math.LN2),b=_*Math.pow(2,52-p),p<=-1023&&(!isFinite(b)||b<Math.pow(2,52))?p=-1022:(b-=Math.pow(2,52),p+=1023)):(p=2047,b=isNaN(u)?26985:0);for(var s=0;s<=5;++s,b/=256)r[l+s]=b&255;r[l+6]=(p&15)<<4|b&15,r[l+7]=p>>4|f}var Sv=function(r){for(var u=[],l=10240,f=0;f<r[0].length;++f)if(r[0][f])for(var p=0,b=r[0][f].length;p<b;p+=l)u.push.apply(u,r[0][f].slice(p,p+l));return u},Ev=ra?function(r){return r[0].length>0&&Buffer.isBuffer(r[0][0])?Buffer.concat(r[0].map(function(u){return Buffer.isBuffer(u)?u:Cp(u)})):Sv(r)}:Sv,Av=function(r,u,l){for(var f=[],p=u;p<l;p+=2)f.push(String.fromCharCode(wf(r,p)));return f.join("").replace(Tl,"")},u1=ra?function(r,u,l){return Buffer.isBuffer(r)?r.toString("utf16le",u,l).replace(Tl,""):Av(r,u,l)}:Av,kv=function(r,u,l){for(var f=[],p=u;p<u+l;++p)f.push(("0"+r[p].toString(16)).slice(-2));return f.join("")},f2=ra?function(r,u,l){return Buffer.isBuffer(r)?r.toString("hex",u,u+l):kv(r,u,l)}:kv,Cv=function(r,u,l){for(var f=[],p=u;p<l;p++)f.push(String.fromCharCode(V0(r,p)));return f.join("")},Gg=ra?function(u,l,f){return Buffer.isBuffer(u)?u.toString("utf8",l,f):Cv(u,l,f)}:Cv,d2=function(r,u){var l=Sc(r,u);return l>0?Gg(r,u+4,u+4+l-1):""},p2=d2,m2=function(r,u){var l=Sc(r,u);return l>0?Gg(r,u+4,u+4+l-1):""},g2=m2,_2=function(r,u){var l=2*Sc(r,u);return l>0?Gg(r,u+4,u+4+l-1):""},x2=_2,y2=function(u,l){var f=Sc(u,l);return f>0?u1(u,l+4,l+4+f):""},v2=y2,b2=function(r,u){var l=Sc(r,u);return l>0?Gg(r,u+4,u+4+l):""},w2=b2,T2=function(r,u){return BE(r,u)},Sx=T2,S2=function(u){return Array.isArray(u)||typeof Uint8Array<"u"&&u instanceof Uint8Array};ra&&(p2=function(u,l){if(!Buffer.isBuffer(u))return d2(u,l);var f=u.readUInt32LE(l);return f>0?u.toString("utf8",l+4,l+4+f-1):""},g2=function(u,l){if(!Buffer.isBuffer(u))return m2(u,l);var f=u.readUInt32LE(l);return f>0?u.toString("utf8",l+4,l+4+f-1):""},x2=function(u,l){if(!Buffer.isBuffer(u))return _2(u,l);var f=2*u.readUInt32LE(l);return u.toString("utf16le",l+4,l+4+f-1)},v2=function(u,l){if(!Buffer.isBuffer(u))return y2(u,l);var f=u.readUInt32LE(l);return u.toString("utf16le",l+4,l+4+f)},w2=function(u,l){if(!Buffer.isBuffer(u))return b2(u,l);var f=u.readUInt32LE(l);return u.toString("utf8",l+4,l+4+f)},Sx=function(u,l){return Buffer.isBuffer(u)?u.readDoubleLE(l):T2(u,l)},S2=function(u){return Buffer.isBuffer(u)||Array.isArray(u)||typeof Uint8Array<"u"&&u instanceof Uint8Array});var V0=function(r,u){return r[u]},wf=function(r,u){return r[u+1]*256+r[u]},jE=function(r,u){var l=r[u+1]*256+r[u];return l<32768?l:(65535-l+1)*-1},Sc=function(r,u){return r[u+3]*(1<<24)+(r[u+2]<<16)+(r[u+1]<<8)+r[u]},vp=function(r,u){return r[u+3]<<24|r[u+2]<<16|r[u+1]<<8|r[u]},UE=function(r,u){return r[u]<<24|r[u+1]<<16|r[u+2]<<8|r[u+3]};function bg(r,u){var l="",f,p,b=[],_,s,C,M;switch(u){case"dbcs":if(M=this.l,ra&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*r).toString("utf16le");else for(C=0;C<r;++C)l+=String.fromCharCode(wf(this,M)),M+=2;r*=2;break;case"utf8":l=Gg(this,this.l,this.l+r);break;case"utf16le":r*=2,l=u1(this,this.l,this.l+r);break;case"wstr":return bg.call(this,r,"dbcs");case"lpstr-ansi":l=p2(this,this.l),r=4+Sc(this,this.l);break;case"lpstr-cp":l=g2(this,this.l),r=4+Sc(this,this.l);break;case"lpwstr":l=x2(this,this.l),r=4+2*Sc(this,this.l);break;case"lpp4":r=4+Sc(this,this.l),l=v2(this,this.l),r&2&&(r+=2);break;case"8lpp4":r=4+Sc(this,this.l),l=w2(this,this.l),r&3&&(r+=4-(r&3));break;case"cstr":for(r=0,l="";(_=V0(this,this.l+r++))!==0;)b.push(K_(_));l=b.join("");break;case"_wstr":for(r=0,l="";(_=wf(this,this.l+r))!==0;)b.push(K_(_)),r+=2;r+=2,l=b.join("");break;case"dbcs-cont":for(l="",M=this.l,C=0;C<r;++C){if(this.lens&&this.lens.indexOf(M)!==-1)return _=V0(this,M),this.l=M+1,s=bg.call(this,r-C,_?"dbcs-cont":"sbcs-cont"),b.join("")+s;b.push(K_(wf(this,M))),M+=2}l=b.join(""),r*=2;break;case"cpstr":case"sbcs-cont":for(l="",M=this.l,C=0;C!=r;++C){if(this.lens&&this.lens.indexOf(M)!==-1)return _=V0(this,M),this.l=M+1,s=bg.call(this,r-C,_?"dbcs-cont":"sbcs-cont"),b.join("")+s;b.push(K_(V0(this,M))),M+=1}l=b.join("");break;default:switch(r){case 1:return f=V0(this,this.l),this.l++,f;case 2:return f=(u==="i"?jE:wf)(this,this.l),this.l+=2,f;case 4:case-4:return u==="i"||(this[this.l+3]&128)===0?(f=(r>0?vp:UE)(this,this.l),this.l+=4,f):(p=Sc(this,this.l),this.l+=4,p);case 8:case-8:if(u==="f")return r==8?p=Sx(this,this.l):p=Sx([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,p;r=8;case 16:l=f2(this,this.l,r);break}}return this.l+=r,l}var VE=function(r,u,l){r[l]=u&255,r[l+1]=u>>>8&255,r[l+2]=u>>>16&255,r[l+3]=u>>>24&255},GE=function(r,u,l){r[l]=u&255,r[l+1]=u>>8&255,r[l+2]=u>>16&255,r[l+3]=u>>24&255},HE=function(r,u,l){r[l]=u&255,r[l+1]=u>>>8&255};function qE(r,u,l){var f=0,p=0;if(l==="dbcs"){for(p=0;p!=u.length;++p)HE(this,u.charCodeAt(p),this.l+2*p);f=2*u.length}else if(l==="sbcs"){for(u=u.replace(/[^\x00-\x7F]/g,"_"),p=0;p!=u.length;++p)this[this.l+p]=u.charCodeAt(p)&255;f=u.length}else if(l==="hex"){for(;p<r;++p)this[this.l++]=parseInt(u.slice(2*p,2*p+2),16)||0;return this}else if(l==="utf16le"){var b=Math.min(this.l+r,this.length);for(p=0;p<Math.min(u.length,r);++p){var _=u.charCodeAt(p);this[this.l++]=_&255,this[this.l++]=_>>8}for(;this.l<b;)this[this.l++]=0;return this}else switch(r){case 1:f=1,this[this.l]=u&255;break;case 2:f=2,this[this.l]=u&255,u>>>=8,this[this.l+1]=u&255;break;case 3:f=3,this[this.l]=u&255,u>>>=8,this[this.l+1]=u&255,u>>>=8,this[this.l+2]=u&255;break;case 4:f=4,VE(this,u,this.l);break;case 8:if(f=8,l==="f"){NE(this,u,this.l);break}case 16:break;case-4:f=4,GE(this,u,this.l);break}return this.l+=f,this}function E2(r,u){var l=f2(this,this.l,r.length>>1);if(l!==r)throw new Error(u+"Expected "+r+" saw "+l);this.l+=r.length>>1}function ho(r,u){r.l=u,r.read_shift=bg,r.chk=E2,r.write_shift=qE}function Ho(r,u){r.l+=u}function Rs(r){var u=Td(r);return ho(u,0),u}function Mf(r,u,l){if(r){var f,p,b;ho(r,r.l||0);for(var _=r.length,s=0,C=0;r.l<_;){s=r.read_shift(1),s&128&&(s=(s&127)+((r.read_shift(1)&127)<<7));var M=Dx[s]||Dx[65535];for(f=r.read_shift(1),b=f&127,p=1;p<4&&f&128;++p)b+=((f=r.read_shift(1))&127)<<7*p;C=r.l+b;var D=M.f&&M.f(r,b,l);if(r.l=C,u(D,M,s))return}}}function Fy(){var r=[],u=ra?256:2048,l=function(M){var D=Rs(M);return ho(D,0),D},f=l(u),p=function(){f&&(f.length>f.l&&(f=f.slice(0,f.l),f.l=f.length),f.length>0&&r.push(f),f=null)},b=function(M){return f&&M<f.length-f.l?f:(p(),f=l(Math.max(M+1,u)))},_=function(){return p(),gd(r)},s=function(M){p(),f=M,f.l==null&&(f.l=f.length),b(u)};return{next:b,push:s,end:_,_bufs:r}}function wg(r,u,l){var f=fo(r);if(u.s?(f.cRel&&(f.c+=u.s.c),f.rRel&&(f.r+=u.s.r)):(f.cRel&&(f.c+=u.c),f.rRel&&(f.r+=u.r)),!l||l.biff<12){for(;f.c>=256;)f.c-=256;for(;f.r>=65536;)f.r-=65536}return f}function Mv(r,u,l){var f=fo(r);return f.s=wg(f.s,u.s,l),f.e=wg(f.e,u.s,l),f}function Tg(r,u){if(r.cRel&&r.c<0)for(r=fo(r);r.c<0;)r.c+=u>8?16384:256;if(r.rRel&&r.r<0)for(r=fo(r);r.r<0;)r.r+=u>8?1048576:u>5?65536:16384;var l=Dn(r);return!r.cRel&&r.cRel!=null&&(l=$E(l)),!r.rRel&&r.rRel!=null&&(l=ZE(l)),l}function gy(r,u){return r.s.r==0&&!r.s.rRel&&r.e.r==(u.biff>=12?1048575:u.biff>=8?65536:16384)&&!r.e.rRel?(r.s.cRel?"":"$")+Is(r.s.c)+":"+(r.e.cRel?"":"$")+Is(r.e.c):r.s.c==0&&!r.s.cRel&&r.e.c==(u.biff>=12?16383:255)&&!r.e.cRel?(r.s.rRel?"":"$")+po(r.s.r)+":"+(r.e.rRel?"":"$")+po(r.e.r):Tg(r.s,u.biff)+":"+Tg(r.e,u.biff)}function h1(r){return parseInt(WE(r),10)-1}function po(r){return""+(r+1)}function ZE(r){return r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function WE(r){return r.replace(/\$(\d+)$/,"$1")}function f1(r){for(var u=XE(r),l=0,f=0;f!==u.length;++f)l=26*l+u.charCodeAt(f)-64;return l-1}function Is(r){if(r<0)throw new Error("invalid column "+r);var u="";for(++r;r;r=Math.floor((r-1)/26))u=String.fromCharCode((r-1)%26+65)+u;return u}function $E(r){return r.replace(/^([A-Z])/,"$$$1")}function XE(r){return r.replace(/^\$([A-Z])/,"$1")}function YE(r){return r.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function wl(r){for(var u=0,l=0,f=0;f<r.length;++f){var p=r.charCodeAt(f);p>=48&&p<=57?u=10*u+(p-48):p>=65&&p<=90&&(l=26*l+(p-64))}return{c:l-1,r:u-1}}function Dn(r){for(var u=r.c+1,l="";u;u=(u-1)/26|0)l=String.fromCharCode((u-1)%26+65)+l;return l+(r.r+1)}function nm(r){var u=r.indexOf(":");return u==-1?{s:wl(r),e:wl(r)}:{s:wl(r.slice(0,u)),e:wl(r.slice(u+1))}}function ca(r,u){return typeof u>"u"||typeof u=="number"?ca(r.s,r.e):(typeof r!="string"&&(r=Dn(r)),typeof u!="string"&&(u=Dn(u)),r==u?r:r+":"+u)}function Yi(r){var u={s:{c:0,r:0},e:{c:0,r:0}},l=0,f=0,p=0,b=r.length;for(l=0;f<b&&!((p=r.charCodeAt(f)-64)<1||p>26);++f)l=26*l+p;for(u.s.c=--l,l=0;f<b&&!((p=r.charCodeAt(f)-48)<0||p>9);++f)l=10*l+p;if(u.s.r=--l,f===b||p!=10)return u.e.c=u.s.c,u.e.r=u.s.r,u;for(++f,l=0;f!=b&&!((p=r.charCodeAt(f)-64)<1||p>26);++f)l=26*l+p;for(u.e.c=--l,l=0;f!=b&&!((p=r.charCodeAt(f)-48)<0||p>9);++f)l=10*l+p;return u.e.r=--l,u}function Dv(r,u){var l=r.t=="d"&&u instanceof Date;if(r.z!=null)try{return r.w=iu(r.z,l?Sl(u):u)}catch{}try{return r.w=iu((r.XF||{}).numFmtId||(l?14:0),l?Sl(u):u)}catch{return""+u}}function kf(r,u,l){return r==null||r.t==null||r.t=="z"?"":r.w!==void 0?r.w:(r.t=="d"&&!r.z&&l&&l.dateNF&&(r.z=l.dateNF),r.t=="e"?Ip[r.v]||r.v:u==null?Dv(r,r.v):Dv(r,u))}function Ed(r,u){var l=u&&u.sheet?u.sheet:"Sheet1",f={};return f[l]=r,{SheetNames:[l],Sheets:f}}function A2(r,u,l){var f=l||{},p=r?Array.isArray(r):f.dense,b=r||(p?[]:{}),_=0,s=0;if(b&&f.origin!=null){if(typeof f.origin=="number")_=f.origin;else{var C=typeof f.origin=="string"?wl(f.origin):f.origin;_=C.r,s=C.c}b["!ref"]||(b["!ref"]="A1:A1")}var M={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(b["!ref"]){var D=Yi(b["!ref"]);M.s.c=D.s.c,M.s.r=D.s.r,M.e.c=Math.max(M.e.c,D.e.c),M.e.r=Math.max(M.e.r,D.e.r),_==-1&&(M.e.r=_=D.e.r+1)}for(var B=0;B!=u.length;++B)if(u[B]){if(!Array.isArray(u[B]))throw new Error("aoa_to_sheet expects an array of arrays");for(var U=0;U!=u[B].length;++U)if(!(typeof u[B][U]>"u")){var j={v:u[B][U]},H=_+B,O=s+U;if(M.s.r>H&&(M.s.r=H),M.s.c>O&&(M.s.c=O),M.e.r<H&&(M.e.r=H),M.e.c<O&&(M.e.c=O),u[B][U]&&typeof u[B][U]=="object"&&!Array.isArray(u[B][U])&&!(u[B][U]instanceof Date))j=u[B][U];else if(Array.isArray(j.v)&&(j.f=u[B][U][1],j.v=j.v[0]),j.v===null)if(j.f)j.t="n";else if(f.nullError)j.t="e",j.v=0;else if(f.sheetStubs)j.t="z";else continue;else typeof j.v=="number"?j.t="n":typeof j.v=="boolean"?j.t="b":j.v instanceof Date?(j.z=f.dateNF||Pn[14],f.cellDates?(j.t="d",j.w=iu(j.z,Sl(j.v))):(j.t="n",j.v=Sl(j.v),j.w=iu(j.z,j.v))):j.t="s";if(p)b[H]||(b[H]=[]),b[H][O]&&b[H][O].z&&(j.z=b[H][O].z),b[H][O]=j;else{var N=Dn({c:O,r:H});b[N]&&b[N].z&&(j.z=b[N].z),b[N]=j}}}return M.s.c<1e7&&(b["!ref"]=ca(M)),b}function am(r,u){return A2(null,r,u)}function KE(r){return r.read_shift(4,"i")}function Go(r){var u=r.read_shift(4);return u===0?"":r.read_shift(u,"dbcs")}function JE(r){return{ich:r.read_shift(2),ifnt:r.read_shift(2)}}function d1(r,u){var l=r.l,f=r.read_shift(1),p=Go(r),b=[],_={t:p,h:p};if((f&1)!==0){for(var s=r.read_shift(4),C=0;C!=s;++C)b.push(JE(r));_.r=b}else _.r=[{ich:0,ifnt:0}];return r.l=l+u,_}var QE=d1;function ou(r){var u=r.read_shift(4),l=r.read_shift(2);return l+=r.read_shift(1)<<16,r.l++,{c:u,iStyleRef:l}}function Dp(r){var u=r.read_shift(2);return u+=r.read_shift(1)<<16,r.l++,{c:-1,iStyleRef:u}}var eA=Go;function p1(r){var u=r.read_shift(4);return u===0||u===4294967295?"":r.read_shift(u,"dbcs")}var tA=Go,Ly=p1;function m1(r){var u=r.slice(r.l,r.l+4),l=u[0]&1,f=u[0]&2;r.l+=4;var p=f===0?Sx([0,0,0,0,u[0]&252,u[1],u[2],u[3]],0):vp(u,0)>>2;return l?p/100:p}function k2(r){var u={s:{},e:{}};return u.s.r=r.read_shift(4),u.e.r=r.read_shift(4),u.s.c=r.read_shift(4),u.e.c=r.read_shift(4),u}var Rp=k2;function Uo(r){if(r.length-r.l<8)throw"XLS Xnum Buffer underflow";return r.read_shift(8,"f")}function rA(r){var u={},l=r.read_shift(1),f=l>>>1,p=r.read_shift(1),b=r.read_shift(2,"i"),_=r.read_shift(1),s=r.read_shift(1),C=r.read_shift(1);switch(r.l++,f){case 0:u.auto=1;break;case 1:u.index=p;var M=Tp[p];M&&(u.rgb=zg(M));break;case 2:u.rgb=zg([_,s,C]);break;case 3:u.theme=p;break}return b!=0&&(u.tint=b>0?b/32767:b/32768),u}function nA(r){var u=r.read_shift(1);r.l++;var l={fBold:u&1,fItalic:u&2,fUnderline:u&4,fStrikeout:u&8,fOutline:u&16,fShadow:u&32,fCondense:u&64,fExtend:u&128};return l}function C2(r,u){var l={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},f=r.read_shift(4);switch(f){case 0:return"";case 4294967295:case 4294967294:return l[r.read_shift(4)]||""}if(f>400)throw new Error("Unsupported Clipboard: "+f.toString(16));return r.l-=4,r.read_shift(0,u==1?"lpstr":"lpwstr")}function aA(r){return C2(r,1)}function iA(r){return C2(r,2)}var g1=2,Zl=3,Q_=11,Rv=12,Ex=19,ex=64,sA=65,oA=71,lA=4108,cA=4126,Ys=80,M2=81,uA=[Ys,M2],hA={1:{n:"CodePage",t:g1},2:{n:"Category",t:Ys},3:{n:"PresentationFormat",t:Ys},4:{n:"ByteCount",t:Zl},5:{n:"LineCount",t:Zl},6:{n:"ParagraphCount",t:Zl},7:{n:"SlideCount",t:Zl},8:{n:"NoteCount",t:Zl},9:{n:"HiddenCount",t:Zl},10:{n:"MultimediaClipCount",t:Zl},11:{n:"ScaleCrop",t:Q_},12:{n:"HeadingPairs",t:lA},13:{n:"TitlesOfParts",t:cA},14:{n:"Manager",t:Ys},15:{n:"Company",t:Ys},16:{n:"LinksUpToDate",t:Q_},17:{n:"CharacterCount",t:Zl},19:{n:"SharedDoc",t:Q_},22:{n:"HyperlinksChanged",t:Q_},23:{n:"AppVersion",t:Zl,p:"version"},24:{n:"DigSig",t:sA},26:{n:"ContentType",t:Ys},27:{n:"ContentStatus",t:Ys},28:{n:"Language",t:Ys},29:{n:"Version",t:Ys},255:{},2147483648:{n:"Locale",t:Ex},2147483651:{n:"Behavior",t:Ex},1919054434:{}},fA={1:{n:"CodePage",t:g1},2:{n:"Title",t:Ys},3:{n:"Subject",t:Ys},4:{n:"Author",t:Ys},5:{n:"Keywords",t:Ys},6:{n:"Comments",t:Ys},7:{n:"Template",t:Ys},8:{n:"LastAuthor",t:Ys},9:{n:"RevNumber",t:Ys},10:{n:"EditTime",t:ex},11:{n:"LastPrinted",t:ex},12:{n:"CreatedDate",t:ex},13:{n:"ModifiedDate",t:ex},14:{n:"PageCount",t:Zl},15:{n:"WordCount",t:Zl},16:{n:"CharCount",t:Zl},17:{n:"Thumbnail",t:oA},18:{n:"Application",t:Ys},19:{n:"DocSecurity",t:Zl},255:{},2147483648:{n:"Locale",t:Ex},2147483651:{n:"Behavior",t:Ex},1919054434:{}},Iv={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},dA=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function pA(r){return r.map(function(u){return[u>>16&255,u>>8&255,u&255]})}var mA=pA([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Tp=fo(mA),Ip={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},D2={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Pv={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function gA(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function _A(r){var u=gA();if(!r||!r.match)return u;var l={};if((r.match(qo)||[]).forEach(function(f){var p=xn(f);switch(p[0].replace(EE,"<")){case"<?xml":break;case"<Types":u.xmlns=p["xmlns"+(p[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":l[p.Extension]=p.ContentType;break;case"<Override":u[Pv[p.ContentType]]!==void 0&&u[Pv[p.ContentType]].push(p.PartName);break}}),u.xmlns!==zE.CT)throw new Error("Unknown Namespace: "+u.xmlns);return u.calcchain=u.calcchains.length>0?u.calcchains[0]:"",u.sst=u.strs.length>0?u.strs[0]:"",u.style=u.styles.length>0?u.styles[0]:"",u.defaults=l,delete u.calcchains,u}var H0={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function zy(r){var u=r.lastIndexOf("/");return r.slice(0,u+1)+"_rels/"+r.slice(u+1)+".rels"}function Sg(r,u){var l={"!id":{}};if(!r)return l;u.charAt(0)!=="/"&&(u="/"+u);var f={};return(r.match(qo)||[]).forEach(function(p){var b=xn(p);if(b[0]==="<Relationship"){var _={};_.Type=b.Type,_.Target=b.Target,_.Id=b.Id,b.TargetMode&&(_.TargetMode=b.TargetMode);var s=b.TargetMode==="External"?b.Target:gg(b.Target,u);l[s]=_,f[b.Id]=_}}),l["!id"]=f,l}var xA="application/vnd.oasis.opendocument.spreadsheet";function yA(r,u){for(var l=c1(r),f,p;f=Fg.exec(l);)switch(f[3]){case"manifest":break;case"file-entry":if(p=xn(f[0],!1),p.path=="/"&&p.type!==xA)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(u&&u.WTF)throw f}}var Eg=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],vA=(function(){for(var r=new Array(Eg.length),u=0;u<Eg.length;++u){var l=Eg[u],f="(?:"+l[0].slice(0,l[0].indexOf(":"))+":)"+l[0].slice(l[0].indexOf(":")+1);r[u]=new RegExp("<"+f+"[^>]*>([\\s\\S]*?)</"+f+">")}return r})();function R2(r){var u={};r=si(r);for(var l=0;l<Eg.length;++l){var f=Eg[l],p=r.match(vA[l]);p!=null&&p.length>0&&(u[f[1]]=xa(p[1])),f[2]==="date"&&u[f[1]]&&(u[f[1]]=Ks(u[f[1]]))}return u}var bA=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function I2(r,u,l,f){var p=[];if(typeof r=="string")p=Tv(r,f);else for(var b=0;b<r.length;++b)p=p.concat(r[b].map(function(D){return{v:D}}));var _=typeof u=="string"?Tv(u,f).map(function(D){return D.v}):u,s=0,C=0;if(_.length>0)for(var M=0;M!==p.length;M+=2){switch(C=+p[M+1].v,p[M].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":l.Worksheets=C,l.SheetNames=_.slice(s,s+C);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":l.NamedRanges=C,l.DefinedNames=_.slice(s,s+C);break;case"Charts":case"Diagramme":l.Chartsheets=C,l.ChartNames=_.slice(s,s+C);break}s+=C}}function wA(r,u,l){var f={};return u||(u={}),r=si(r),bA.forEach(function(p){var b=(r.match(Pg(p[0]))||[])[1];switch(p[2]){case"string":b&&(u[p[1]]=xa(b));break;case"bool":u[p[1]]=b==="true";break;case"raw":var _=r.match(new RegExp("<"+p[0]+"[^>]*>([\\s\\S]*?)</"+p[0]+">"));_&&_.length>0&&(f[p[1]]=_[1]);break}}),f.HeadingPairs&&f.TitlesOfParts&&I2(f.HeadingPairs,f.TitlesOfParts,u,l),u}var TA=/<[^>]+>[^<]*/g;function SA(r,u){var l={},f="",p=r.match(TA);if(p)for(var b=0;b!=p.length;++b){var _=p[b],s=xn(_);switch(s[0]){case"<?xml":break;case"<Properties":break;case"<property":f=xa(s.name);break;case"</property>":f=null;break;default:if(_.indexOf("<vt:")===0){var C=_.split(">"),M=C[0].slice(4),D=C[1];switch(M){case"lpstr":case"bstr":case"lpwstr":l[f]=xa(D);break;case"bool":l[f]=vi(D);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":l[f]=parseInt(D,10);break;case"r4":case"r8":case"decimal":l[f]=parseFloat(D);break;case"filetime":case"date":l[f]=Ks(D);break;case"cy":case"error":l[f]=xa(D);break;default:if(M.slice(-1)=="/")break;u.WTF&&typeof console<"u"&&console.warn("Unexpected",_,M,C)}}else if(_.slice(0,2)!=="</"){if(u.WTF)throw new Error(_)}}}return l}var EA={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},_y;function AA(r,u,l){_y||(_y=s1(EA)),u=_y[u]||u,r[u]=l}function _1(r){var u=r.read_shift(4),l=r.read_shift(4);return new Date((l/1e7*Math.pow(2,32)+u/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function P2(r,u,l){var f=r.l,p=r.read_shift(0,"lpstr-cp");if(l)for(;r.l-f&3;)++r.l;return p}function F2(r,u,l){var f=r.read_shift(0,"lpwstr");return f}function L2(r,u,l){return u===31?F2(r):P2(r,u,l)}function Oy(r,u,l){return L2(r,u,l===!1?0:4)}function kA(r,u){if(!u)throw new Error("VtUnalignedString must have positive length");return L2(r,u,0)}function CA(r){for(var u=r.read_shift(4),l=[],f=0;f!=u;++f){var p=r.l;l[f]=r.read_shift(0,"lpwstr").replace(Tl,""),r.l-p&2&&(r.l+=2)}return l}function MA(r){for(var u=r.read_shift(4),l=[],f=0;f!=u;++f)l[f]=r.read_shift(0,"lpstr-cp").replace(Tl,"");return l}function DA(r){var u=r.l,l=Ax(r,M2);r[r.l]==0&&r[r.l+1]==0&&r.l-u&2&&(r.l+=2);var f=Ax(r,Zl);return[l,f]}function RA(r){for(var u=r.read_shift(4),l=[],f=0;f<u/2;++f)l.push(DA(r));return l}function Fv(r,u){for(var l=r.read_shift(4),f={},p=0;p!=l;++p){var b=r.read_shift(4),_=r.read_shift(4);f[b]=r.read_shift(_,u===1200?"utf16le":"utf8").replace(Tl,"").replace(mg,"!"),u===1200&&_%2&&(r.l+=2)}return r.l&3&&(r.l=r.l>>3<<2),f}function z2(r){var u=r.read_shift(4),l=r.slice(r.l,r.l+u);return r.l+=u,(u&3)>0&&(r.l+=4-(u&3)&3),l}function IA(r){var u={};return u.Size=r.read_shift(4),r.l+=u.Size+3-(u.Size-1)%4,u}function Ax(r,u,l){var f=r.read_shift(2),p,b=l||{};if(r.l+=2,u!==Rv&&f!==u&&uA.indexOf(u)===-1&&!((u&65534)==4126&&(f&65534)==4126))throw new Error("Expected type "+u+" saw "+f);switch(u===Rv?f:u){case 2:return p=r.read_shift(2,"i"),b.raw||(r.l+=2),p;case 3:return p=r.read_shift(4,"i"),p;case 11:return r.read_shift(4)!==0;case 19:return p=r.read_shift(4),p;case 30:return P2(r,f,4).replace(Tl,"");case 31:return F2(r);case 64:return _1(r);case 65:return z2(r);case 71:return IA(r);case 80:return Oy(r,f,!b.raw).replace(Tl,"");case 81:return kA(r,f).replace(Tl,"");case 4108:return RA(r);case 4126:case 4127:return f==4127?CA(r):MA(r);default:throw new Error("TypedPropertyValue unrecognized type "+u+" "+f)}}function Lv(r,u){var l=r.l,f=r.read_shift(4),p=r.read_shift(4),b=[],_=0,s=0,C=-1,M={};for(_=0;_!=p;++_){var D=r.read_shift(4),B=r.read_shift(4);b[_]=[D,B+l]}b.sort(function(J,X){return J[1]-X[1]});var U={};for(_=0;_!=p;++_){if(r.l!==b[_][1]){var j=!0;if(_>0&&u)switch(u[b[_-1][0]].t){case 2:r.l+2===b[_][1]&&(r.l+=2,j=!1);break;case 80:r.l<=b[_][1]&&(r.l=b[_][1],j=!1);break;case 4108:r.l<=b[_][1]&&(r.l=b[_][1],j=!1);break}if((!u||_==0)&&r.l<=b[_][1]&&(j=!1,r.l=b[_][1]),j)throw new Error("Read Error: Expected address "+b[_][1]+" at "+r.l+" :"+_)}if(u){var H=u[b[_][0]];if(U[H.n]=Ax(r,H.t,{raw:!0}),H.p==="version"&&(U[H.n]=String(U[H.n]>>16)+"."+("0000"+String(U[H.n]&65535)).slice(-4)),H.n=="CodePage")switch(U[H.n]){case 0:U[H.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:eh(s=U[H.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+U[H.n])}}else if(b[_][0]===1){if(s=U.CodePage=Ax(r,g1),eh(s),C!==-1){var O=r.l;r.l=b[C][1],M=Fv(r,s),r.l=O}}else if(b[_][0]===0){if(s===0){C=_,r.l=b[_+1][1];continue}M=Fv(r,s)}else{var N=M[b[_][0]],Z;switch(r[r.l]){case 65:r.l+=4,Z=z2(r);break;case 30:r.l+=4,Z=Oy(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 31:r.l+=4,Z=Oy(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 3:r.l+=4,Z=r.read_shift(4,"i");break;case 19:r.l+=4,Z=r.read_shift(4);break;case 5:r.l+=4,Z=r.read_shift(8,"f");break;case 11:r.l+=4,Z=ss(r,4);break;case 64:r.l+=4,Z=Ks(_1(r));break;default:throw new Error("unparsed value: "+r[r.l])}U[N]=Z}}return r.l=l+f,U}function zv(r,u,l){var f=r.content;if(!f)return{};ho(f,0);var p,b,_,s,C=0;f.chk("feff","Byte Order: "),f.read_shift(2);var M=f.read_shift(4),D=f.read_shift(16);if(D!==la.utils.consts.HEADER_CLSID&&D!==l)throw new Error("Bad PropertySet CLSID "+D);if(p=f.read_shift(4),p!==1&&p!==2)throw new Error("Unrecognized #Sets: "+p);if(b=f.read_shift(16),s=f.read_shift(4),p===1&&s!==f.l)throw new Error("Length mismatch: "+s+" !== "+f.l);p===2&&(_=f.read_shift(16),C=f.read_shift(4));var B=Lv(f,u),U={SystemIdentifier:M};for(var j in B)U[j]=B[j];if(U.FMTID=b,p===1)return U;if(C-f.l==2&&(f.l+=2),f.l!==C)throw new Error("Length mismatch 2: "+f.l+" !== "+C);var H;try{H=Lv(f,null)}catch{}for(j in H)U[j]=H[j];return U.FMTID=[b,_],U}function dd(r,u){return r.read_shift(u),null}function PA(r,u,l){for(var f=[],p=r.l+u;r.l<p;)f.push(l(r,p-r.l));if(p!==r.l)throw new Error("Slurp error");return f}function ss(r,u){return r.read_shift(u)===1}function vs(r){return r.read_shift(2,"u")}function O2(r,u){return PA(r,u,vs)}function FA(r){var u=r.read_shift(1),l=r.read_shift(1);return l===1?u:u===1}function Hg(r,u,l){var f=r.read_shift(l&&l.biff>=12?2:1),p="sbcs-cont";if(l&&l.biff>=8,!l||l.biff==8){var b=r.read_shift(1);b&&(p="dbcs-cont")}else l.biff==12&&(p="wstr");l.biff>=2&&l.biff<=5&&(p="cpstr");var _=f?r.read_shift(f,p):"";return _}function LA(r){var u=r.read_shift(2),l=r.read_shift(1),f=l&4,p=l&8,b=1+(l&1),_=0,s,C={};p&&(_=r.read_shift(2)),f&&(s=r.read_shift(4));var M=b==2?"dbcs-cont":"sbcs-cont",D=u===0?"":r.read_shift(u,M);return p&&(r.l+=4*_),f&&(r.l+=s),C.t=D,p||(C.raw="<t>"+C.t+"</t>",C.r=C.t),C}function Ap(r,u,l){var f;if(l){if(l.biff>=2&&l.biff<=5)return r.read_shift(u,"cpstr");if(l.biff>=12)return r.read_shift(u,"dbcs-cont")}var p=r.read_shift(1);return p===0?f=r.read_shift(u,"sbcs-cont"):f=r.read_shift(u,"dbcs-cont"),f}function qg(r,u,l){var f=r.read_shift(l&&l.biff==2?1:2);return f===0?(r.l++,""):Ap(r,f,l)}function Pp(r,u,l){if(l.biff>5)return qg(r,u,l);var f=r.read_shift(1);return f===0?(r.l++,""):r.read_shift(f,l.biff<=4||!r.lens?"cpstr":"sbcs-cont")}function zA(r){var u=r.read_shift(1);r.l++;var l=r.read_shift(2);return r.l+=2,[u,l]}function OA(r){var u=r.read_shift(4),l=r.l,f=!1;u>24&&(r.l+=u-24,r.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(f=!0),r.l=l);var p=r.read_shift((f?u-24:u)>>1,"utf16le").replace(Tl,"");return f&&(r.l+=24),p}function BA(r){for(var u=r.read_shift(2),l="";u-- >0;)l+="../";var f=r.read_shift(0,"lpstr-ansi");if(r.l+=2,r.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var p=r.read_shift(4);if(p===0)return l+f.replace(/\\/g,"/");var b=r.read_shift(4);if(r.read_shift(2)!=3)throw new Error("Bad FileMoniker");var _=r.read_shift(b>>1,"utf16le").replace(Tl,"");return l+_}function NA(r,u){var l=r.read_shift(16);switch(l){case"e0c9ea79f9bace118c8200aa004ba90b":return OA(r);case"0303000000000000c000000000000046":return BA(r);default:throw new Error("Unsupported Moniker "+l)}}function tx(r){var u=r.read_shift(4),l=u>0?r.read_shift(u,"utf16le").replace(Tl,""):"";return l}function jA(r,u){var l=r.l+u,f=r.read_shift(4);if(f!==2)throw new Error("Unrecognized streamVersion: "+f);var p=r.read_shift(2);r.l+=2;var b,_,s,C,M="",D,B;p&16&&(b=tx(r,l-r.l)),p&128&&(_=tx(r,l-r.l)),(p&257)===257&&(s=tx(r,l-r.l)),(p&257)===1&&(C=NA(r,l-r.l)),p&8&&(M=tx(r,l-r.l)),p&32&&(D=r.read_shift(16)),p&64&&(B=_1(r)),r.l=l;var U=_||s||C||"";U&&M&&(U+="#"+M),U||(U="#"+M),p&2&&U.charAt(0)=="/"&&U.charAt(1)!="/"&&(U="file://"+U);var j={Target:U};return D&&(j.guid=D),B&&(j.time=B),b&&(j.Tooltip=b),j}function B2(r){var u=r.read_shift(1),l=r.read_shift(1),f=r.read_shift(1),p=r.read_shift(1);return[u,l,f,p]}function N2(r,u){var l=B2(r);return l[3]=0,l}function Gh(r){var u=r.read_shift(2),l=r.read_shift(2),f=r.read_shift(2);return{r:u,c:l,ixfe:f}}function UA(r){var u=r.read_shift(2),l=r.read_shift(2);return r.l+=8,{type:u,flags:l}}function VA(r,u,l){return u===0?"":Pp(r,u,l)}function GA(r,u,l){var f=l.biff>8?4:2,p=r.read_shift(f),b=r.read_shift(f,"i"),_=r.read_shift(f,"i");return[p,b,_]}function j2(r){var u=r.read_shift(2),l=m1(r);return[u,l]}function HA(r,u,l){r.l+=4,u-=4;var f=r.l+u,p=Hg(r,u,l),b=r.read_shift(2);if(f-=r.l,b!==f)throw new Error("Malformed AddinUdf: padding = "+f+" != "+b);return r.l+=b,p}function Bx(r){var u=r.read_shift(2),l=r.read_shift(2),f=r.read_shift(2),p=r.read_shift(2);return{s:{c:f,r:u},e:{c:p,r:l}}}function U2(r){var u=r.read_shift(2),l=r.read_shift(2),f=r.read_shift(1),p=r.read_shift(1);return{s:{c:f,r:u},e:{c:p,r:l}}}var qA=U2;function V2(r){r.l+=4;var u=r.read_shift(2),l=r.read_shift(2),f=r.read_shift(2);return r.l+=12,[l,u,f]}function ZA(r){var u={};return r.l+=4,r.l+=16,u.fSharedNote=r.read_shift(2),r.l+=4,u}function WA(r){var u={};return r.l+=4,r.cf=r.read_shift(2),u}function No(r){r.l+=2,r.l+=r.read_shift(2)}var $A={0:No,4:No,5:No,6:No,7:WA,8:No,9:No,10:No,11:No,12:No,13:ZA,14:No,15:No,16:No,17:No,18:No,19:No,20:No,21:V2};function XA(r,u){for(var l=r.l+u,f=[];r.l<l;){var p=r.read_shift(2);r.l-=2;try{f.push($A[p](r,l-r.l))}catch{return r.l=l,f}}return r.l!=l&&(r.l=l),f}function rx(r,u){var l={BIFFVer:0,dt:0};switch(l.BIFFVer=r.read_shift(2),u-=2,u>=2&&(l.dt=r.read_shift(2),r.l-=2),l.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(u>6)throw new Error("Unexpected BIFF Ver "+l.BIFFVer)}return r.read_shift(u),l}function YA(r,u){return u===0||r.read_shift(2),1200}function KA(r,u,l){if(l.enc)return r.l+=u,"";var f=r.l,p=Pp(r,0,l);return r.read_shift(u+f-r.l),p}function JA(r,u,l){var f=l&&l.biff==8||u==2?r.read_shift(2):(r.l+=u,0);return{fDialog:f&16,fBelow:f&64,fRight:f&128}}function QA(r,u,l){var f=r.read_shift(4),p=r.read_shift(1)&3,b=r.read_shift(1);switch(b){case 0:b="Worksheet";break;case 1:b="Macrosheet";break;case 2:b="Chartsheet";break;case 6:b="VBAModule";break}var _=Hg(r,0,l);return _.length===0&&(_="Sheet1"),{pos:f,hs:p,dt:b,name:_}}function ek(r,u){for(var l=r.l+u,f=r.read_shift(4),p=r.read_shift(4),b=[],_=0;_!=p&&r.l<l;++_)b.push(LA(r));return b.Count=f,b.Unique=p,b}function tk(r,u){var l={};return l.dsst=r.read_shift(2),r.l+=u-2,l}function rk(r){var u={};u.r=r.read_shift(2),u.c=r.read_shift(2),u.cnt=r.read_shift(2)-u.c;var l=r.read_shift(2);r.l+=4;var f=r.read_shift(1);return r.l+=3,f&7&&(u.level=f&7),f&32&&(u.hidden=!0),f&64&&(u.hpt=l/20),u}function nk(r){var u=UA(r);if(u.type!=2211)throw new Error("Invalid Future Record "+u.type);var l=r.read_shift(4);return l!==0}function ak(r){return r.read_shift(2),r.read_shift(4)}function Ov(r,u,l){var f=0;l&&l.biff==2||(f=r.read_shift(2));var p=r.read_shift(2);l&&l.biff==2&&(f=1-(p>>15),p&=32767);var b={Unsynced:f&1,DyZero:(f&2)>>1,ExAsc:(f&4)>>2,ExDsc:(f&8)>>3};return[b,p]}function ik(r){var u=r.read_shift(2),l=r.read_shift(2),f=r.read_shift(2),p=r.read_shift(2),b=r.read_shift(2),_=r.read_shift(2),s=r.read_shift(2),C=r.read_shift(2),M=r.read_shift(2);return{Pos:[u,l],Dim:[f,p],Flags:b,CurTab:_,FirstTab:s,Selected:C,TabRatio:M}}function sk(r,u,l){if(l&&l.biff>=2&&l.biff<5)return{};var f=r.read_shift(2);return{RTL:f&64}}function ok(){}function lk(r,u,l){var f={dyHeight:r.read_shift(2),fl:r.read_shift(2)};switch(l&&l.biff||8){case 2:break;case 3:case 4:r.l+=2;break;default:r.l+=10;break}return f.name=Hg(r,0,l),f}function ck(r){var u=Gh(r);return u.isst=r.read_shift(4),u}function uk(r,u,l){l.biffguess&&l.biff==2&&(l.biff=5);var f=r.l+u,p=Gh(r);l.biff==2&&r.l++;var b=qg(r,f-r.l,l);return p.val=b,p}function hk(r,u,l){var f=r.read_shift(2),p=Pp(r,0,l);return[f,p]}var fk=Pp;function Bv(r,u,l){var f=r.l+u,p=l.biff==8||!l.biff?4:2,b=r.read_shift(p),_=r.read_shift(p),s=r.read_shift(2),C=r.read_shift(2);return r.l=f,{s:{r:b,c:s},e:{r:_,c:C}}}function dk(r){var u=r.read_shift(2),l=r.read_shift(2),f=j2(r);return{r:u,c:l,ixfe:f[0],rknum:f[1]}}function pk(r,u){for(var l=r.l+u-2,f=r.read_shift(2),p=r.read_shift(2),b=[];r.l<l;)b.push(j2(r));if(r.l!==l)throw new Error("MulRK read error");var _=r.read_shift(2);if(b.length!=_-p+1)throw new Error("MulRK length mismatch");return{r:f,c:p,C:_,rkrec:b}}function mk(r,u){for(var l=r.l+u-2,f=r.read_shift(2),p=r.read_shift(2),b=[];r.l<l;)b.push(r.read_shift(2));if(r.l!==l)throw new Error("MulBlank read error");var _=r.read_shift(2);if(b.length!=_-p+1)throw new Error("MulBlank length mismatch");return{r:f,c:p,C:_,ixfe:b}}function gk(r,u,l,f){var p={},b=r.read_shift(4),_=r.read_shift(4),s=r.read_shift(4),C=r.read_shift(2);return p.patternType=dA[s>>26],f.cellStyles&&(p.alc=b&7,p.fWrap=b>>3&1,p.alcV=b>>4&7,p.fJustLast=b>>7&1,p.trot=b>>8&255,p.cIndent=b>>16&15,p.fShrinkToFit=b>>20&1,p.iReadOrder=b>>22&2,p.fAtrNum=b>>26&1,p.fAtrFnt=b>>27&1,p.fAtrAlc=b>>28&1,p.fAtrBdr=b>>29&1,p.fAtrPat=b>>30&1,p.fAtrProt=b>>31&1,p.dgLeft=_&15,p.dgRight=_>>4&15,p.dgTop=_>>8&15,p.dgBottom=_>>12&15,p.icvLeft=_>>16&127,p.icvRight=_>>23&127,p.grbitDiag=_>>30&3,p.icvTop=s&127,p.icvBottom=s>>7&127,p.icvDiag=s>>14&127,p.dgDiag=s>>21&15,p.icvFore=C&127,p.icvBack=C>>7&127,p.fsxButton=C>>14&1),p}function _k(r,u,l){var f={};return f.ifnt=r.read_shift(2),f.numFmtId=r.read_shift(2),f.flags=r.read_shift(2),f.fStyle=f.flags>>2&1,u-=6,f.data=gk(r,u,f.fStyle,l),f}function xk(r){r.l+=4;var u=[r.read_shift(2),r.read_shift(2)];if(u[0]!==0&&u[0]--,u[1]!==0&&u[1]--,u[0]>7||u[1]>7)throw new Error("Bad Gutters: "+u.join("|"));return u}function Nv(r,u,l){var f=Gh(r);(l.biff==2||u==9)&&++r.l;var p=FA(r);return f.val=p,f.t=p===!0||p===!1?"b":"e",f}function yk(r,u,l){l.biffguess&&l.biff==2&&(l.biff=5);var f=Gh(r),p=Uo(r);return f.val=p,f}var jv=VA;function vk(r,u,l){var f=r.l+u,p=r.read_shift(2),b=r.read_shift(2);if(l.sbcch=b,b==1025||b==14849)return[b,p];if(b<1||b>255)throw new Error("Unexpected SupBook type: "+b);for(var _=Ap(r,b),s=[];f>r.l;)s.push(qg(r));return[b,p,_,s]}function Uv(r,u,l){var f=r.read_shift(2),p,b={fBuiltIn:f&1,fWantAdvise:f>>>1&1,fWantPict:f>>>2&1,fOle:f>>>3&1,fOleLink:f>>>4&1,cf:f>>>5&1023,fIcon:f>>>15&1};return l.sbcch===14849&&(p=HA(r,u-2,l)),b.body=p||r.read_shift(u-2),typeof p=="string"&&(b.Name=p),b}var bk=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Vv(r,u,l){var f=r.l+u,p=r.read_shift(2),b=r.read_shift(1),_=r.read_shift(1),s=r.read_shift(l&&l.biff==2?1:2),C=0;(!l||l.biff>=5)&&(l.biff!=5&&(r.l+=2),C=r.read_shift(2),l.biff==5&&(r.l+=2),r.l+=4);var M=Ap(r,_,l);p&32&&(M=bk[M.charCodeAt(0)]);var D=f-r.l;l&&l.biff==2&&--D;var B=f==r.l||s===0||!(D>0)?[]:rM(r,D,l,s);return{chKey:b,Name:M,itab:C,rgce:B}}function G2(r,u,l){if(l.biff<8)return wk(r,u,l);for(var f=[],p=r.l+u,b=r.read_shift(l.biff>8?4:2);b--!==0;)f.push(GA(r,l.biff>8?12:6,l));if(r.l!=p)throw new Error("Bad ExternSheet: "+r.l+" != "+p);return f}function wk(r,u,l){r[r.l+1]==3&&r[r.l]++;var f=Hg(r,u,l);return f.charCodeAt(0)==3?f.slice(1):f}function Tk(r,u,l){if(l.biff<8){r.l+=u;return}var f=r.read_shift(2),p=r.read_shift(2),b=Ap(r,f,l),_=Ap(r,p,l);return[b,_]}function Sk(r,u,l){var f=U2(r);r.l++;var p=r.read_shift(1);return u-=8,[nM(r,u,l),p,f]}function Gv(r,u,l){var f=qA(r);switch(l.biff){case 2:r.l++,u-=7;break;case 3:case 4:r.l+=2,u-=8;break;default:r.l+=6,u-=12}return[f,eM(r,u,l)]}function Ek(r){var u=r.read_shift(4)!==0,l=r.read_shift(4)!==0,f=r.read_shift(4);return[u,l,f]}function Ak(r,u,l){if(!(l.biff<8)){var f=r.read_shift(2),p=r.read_shift(2),b=r.read_shift(2),_=r.read_shift(2),s=Pp(r,0,l);return l.biff<8&&r.read_shift(1),[{r:f,c:p},s,_,b]}}function kk(r,u,l){return Ak(r,u,l)}function Ck(r,u){for(var l=[],f=r.read_shift(2);f--;)l.push(Bx(r));return l}function Mk(r,u,l){if(l&&l.biff<8)return Rk(r,u,l);var f=V2(r),p=XA(r,u-22,f[1]);return{cmo:f,ft:p}}var Dk={8:function(r,u){var l=r.l+u;r.l+=10;var f=r.read_shift(2);r.l+=4,r.l+=2,r.l+=2,r.l+=2,r.l+=4;var p=r.read_shift(1);return r.l+=p,r.l=l,{fmt:f}}};function Rk(r,u,l){r.l+=4;var f=r.read_shift(2),p=r.read_shift(2),b=r.read_shift(2);r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=6,u-=36;var _=[];return _.push((Dk[f]||Ho)(r,u,l)),{cmo:[p,f,b],ft:_}}function Ik(r,u,l){var f=r.l,p="";try{r.l+=4;var b=(l.lastobj||{cmo:[0,0]}).cmo[1],_;[0,5,7,11,12,14].indexOf(b)==-1?r.l+=6:_=zA(r,6,l);var s=r.read_shift(2);r.read_shift(2),vs(r,2);var C=r.read_shift(2);r.l+=C;for(var M=1;M<r.lens.length-1;++M){if(r.l-f!=r.lens[M])throw new Error("TxO: bad continue record");var D=r[r.l],B=Ap(r,r.lens[M+1]-r.lens[M]-1);if(p+=B,p.length>=(D?s:2*s))break}if(p.length!==s&&p.length!==s*2)throw new Error("cchText: "+s+" != "+p.length);return r.l=f+u,{t:p}}catch{return r.l=f+u,{t:p}}}function Pk(r,u){var l=Bx(r);r.l+=16;var f=jA(r,u-24);return[l,f]}function Fk(r,u){r.read_shift(2);var l=Bx(r),f=r.read_shift((u-10)/2,"dbcs-cont");return f=f.replace(Tl,""),[l,f]}function Lk(r){var u=[0,0],l;return l=r.read_shift(2),u[0]=Iv[l]||l,l=r.read_shift(2),u[1]=Iv[l]||l,u}function zk(r){for(var u=r.read_shift(2),l=[];u-- >0;)l.push(N2(r));return l}function Ok(r){for(var u=r.read_shift(2),l=[];u-- >0;)l.push(N2(r));return l}function Bk(r){r.l+=2;var u={cxfs:0,crc:0};return u.cxfs=r.read_shift(2),u.crc=r.read_shift(4),u}function H2(r,u,l){if(!l.cellStyles)return Ho(r,u);var f=l&&l.biff>=12?4:2,p=r.read_shift(f),b=r.read_shift(f),_=r.read_shift(f),s=r.read_shift(f),C=r.read_shift(2);f==2&&(r.l+=2);var M={s:p,e:b,w:_,ixfe:s,flags:C};return(l.biff>=5||!l.biff)&&(M.level=C>>8&7),M}function Nk(r,u){var l={};return u<32||(r.l+=16,l.header=Uo(r),l.footer=Uo(r),r.l+=2),l}function jk(r,u,l){var f={area:!1};if(l.biff!=5)return r.l+=u,f;var p=r.read_shift(1);return r.l+=3,p&16&&(f.area=!0),f}var Uk=Gh,Vk=O2,Gk=qg;function Hk(r){var u=r.read_shift(2),l=r.read_shift(2),f=r.read_shift(4),p={fmt:u,env:l,len:f,data:r.slice(r.l,r.l+f)};return r.l+=f,p}function qk(r,u,l){l.biffguess&&l.biff==5&&(l.biff=2);var f=Gh(r);++r.l;var p=Pp(r,u-7,l);return f.t="str",f.val=p,f}function Zk(r){var u=Gh(r);++r.l;var l=Uo(r);return u.t="n",u.val=l,u}function Wk(r){var u=Gh(r);++r.l;var l=r.read_shift(2);return u.t="n",u.val=l,u}function $k(r){var u=r.read_shift(1);return u===0?(r.l++,""):r.read_shift(u,"sbcs-cont")}function Xk(r,u){r.l+=6,r.l+=2,r.l+=1,r.l+=3,r.l+=1,r.l+=u-13}function Yk(r,u,l){var f=r.l+u,p=Gh(r),b=r.read_shift(2),_=Ap(r,b,l);return r.l=f,p.t="str",p.val=_,p}var Kk=[2,3,48,49,131,139,140,245],Hv=(function(){var r={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},u=s1({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function l(s,C){var M=[],D=Td(1);switch(C.type){case"base64":D=Ju(Ac(s));break;case"binary":D=Ju(s);break;case"buffer":case"array":D=s;break}ho(D,0);var B=D.read_shift(1),U=!!(B&136),j=!1,H=!1;switch(B){case 2:break;case 3:break;case 48:j=!0,U=!0;break;case 49:j=!0,U=!0;break;case 131:break;case 139:break;case 140:H=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+B.toString(16))}var O=0,N=521;B==2&&(O=D.read_shift(2)),D.l+=3,B!=2&&(O=D.read_shift(4)),O>1048576&&(O=1e6),B!=2&&(N=D.read_shift(2));var Z=D.read_shift(2),J=C.codepage||1252;B!=2&&(D.l+=16,D.read_shift(1),D[D.l]!==0&&(J=r[D[D.l]]),D.l+=1,D.l+=2),H&&(D.l+=36);for(var X=[],pe={},ge=Math.min(D.length,B==2?521:N-10-(j?264:0)),ve=H?32:11;D.l<ge&&D[D.l]!=13;)switch(pe={},pe.name=Rg.utils.decode(J,D.slice(D.l,D.l+ve)).replace(/[\u0000\r\n].*$/g,""),D.l+=ve,pe.type=String.fromCharCode(D.read_shift(1)),B!=2&&!H&&(pe.offset=D.read_shift(4)),pe.len=D.read_shift(1),B==2&&(pe.offset=D.read_shift(2)),pe.dec=D.read_shift(1),pe.name.length&&X.push(pe),B!=2&&(D.l+=H?13:14),pe.type){case"B":(!j||pe.len!=8)&&C.WTF&&console.log("Skipping "+pe.name+":"+pe.type);break;case"G":case"P":C.WTF&&console.log("Skipping "+pe.name+":"+pe.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+pe.type)}if(D[D.l]!==13&&(D.l=N-1),D.read_shift(1)!==13)throw new Error("DBF Terminator not found "+D.l+" "+D[D.l]);D.l=N;var re=0,Ce=0;for(M[0]=[],Ce=0;Ce!=X.length;++Ce)M[0][Ce]=X[Ce].name;for(;O-- >0;){if(D[D.l]===42){D.l+=Z;continue}for(++D.l,M[++re]=[],Ce=0,Ce=0;Ce!=X.length;++Ce){var xe=D.slice(D.l,D.l+X[Ce].len);D.l+=X[Ce].len,ho(xe,0);var Ge=Rg.utils.decode(J,xe);switch(X[Ce].type){case"C":Ge.trim().length&&(M[re][Ce]=Ge.replace(/\s+$/,""));break;case"D":Ge.length===8?M[re][Ce]=new Date(+Ge.slice(0,4),+Ge.slice(4,6)-1,+Ge.slice(6,8)):M[re][Ce]=Ge;break;case"F":M[re][Ce]=parseFloat(Ge.trim());break;case"+":case"I":M[re][Ce]=H?xe.read_shift(-4,"i")^2147483648:xe.read_shift(4,"i");break;case"L":switch(Ge.trim().toUpperCase()){case"Y":case"T":M[re][Ce]=!0;break;case"N":case"F":M[re][Ce]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Ge+"|")}break;case"M":if(!U)throw new Error("DBF Unexpected MEMO for type "+B.toString(16));M[re][Ce]="##MEMO##"+(H?parseInt(Ge.trim(),10):xe.read_shift(4));break;case"N":Ge=Ge.replace(/\u0000/g,"").trim(),Ge&&Ge!="."&&(M[re][Ce]=+Ge||0);break;case"@":M[re][Ce]=new Date(xe.read_shift(-8,"f")-621356832e5);break;case"T":M[re][Ce]=new Date((xe.read_shift(4)-2440588)*864e5+xe.read_shift(4));break;case"Y":M[re][Ce]=xe.read_shift(4,"i")/1e4+xe.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":M[re][Ce]=-xe.read_shift(-8,"f");break;case"B":if(j&&X[Ce].len==8){M[re][Ce]=xe.read_shift(8,"f");break}case"G":case"P":xe.l+=X[Ce].len;break;case"0":if(X[Ce].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+X[Ce].type)}}}if(B!=2&&D.l<D.length&&D[D.l++]!=26)throw new Error("DBF EOF Marker missing "+(D.l-1)+" of "+D.length+" "+D[D.l-1].toString(16));return C&&C.sheetRows&&(M=M.slice(0,C.sheetRows)),C.DBF=X,M}function f(s,C){var M=C||{};M.dateNF||(M.dateNF="yyyymmdd");var D=am(l(s,M),M);return D["!cols"]=M.DBF.map(function(B){return{wch:B.len,DBF:B}}),delete M.DBF,D}function p(s,C){try{return Ed(f(s,C),C)}catch(M){if(C&&C.WTF)throw M}return{SheetNames:[],Sheets:{}}}var b={B:8,C:250,L:1,D:8,"?":0,"":0};function _(s,C){var M=C||{};if(+M.codepage>=0&&eh(+M.codepage),M.type=="string")throw new Error("Cannot write DBF to JS string");var D=Fy(),B=Hy(s,{header:1,raw:!0,cellDates:!0}),U=B[0],j=B.slice(1),H=s["!cols"]||[],O=0,N=0,Z=0,J=1;for(O=0;O<U.length;++O){if(((H[O]||{}).DBF||{}).name){U[O]=H[O].DBF.name,++Z;continue}if(U[O]!=null){if(++Z,typeof U[O]=="number"&&(U[O]=U[O].toString(10)),typeof U[O]!="string")throw new Error("DBF Invalid column name "+U[O]+" |"+typeof U[O]+"|");if(U.indexOf(U[O])!==O){for(N=0;N<1024;++N)if(U.indexOf(U[O]+"_"+N)==-1){U[O]+="_"+N;break}}}}var X=Yi(s["!ref"]),pe=[],ge=[],ve=[];for(O=0;O<=X.e.c-X.s.c;++O){var re="",Ce="",xe=0,Ge=[];for(N=0;N<j.length;++N)j[N][O]!=null&&Ge.push(j[N][O]);if(Ge.length==0||U[O]==null){pe[O]="?";continue}for(N=0;N<Ge.length;++N){switch(typeof Ge[N]){case"number":Ce="B";break;case"string":Ce="C";break;case"boolean":Ce="L";break;case"object":Ce=Ge[N]instanceof Date?"D":"C";break;default:Ce="C"}xe=Math.max(xe,String(Ge[N]).length),re=re&&re!=Ce?"C":Ce}xe>250&&(xe=250),Ce=((H[O]||{}).DBF||{}).type,Ce=="C"&&H[O].DBF.len>xe&&(xe=H[O].DBF.len),re=="B"&&Ce=="N"&&(re="N",ve[O]=H[O].DBF.dec,xe=H[O].DBF.len),ge[O]=re=="C"||Ce=="N"?xe:b[re]||0,J+=ge[O],pe[O]=re}var $e=D.next(32);for($e.write_shift(4,318902576),$e.write_shift(4,j.length),$e.write_shift(2,296+32*Z),$e.write_shift(2,J),O=0;O<4;++O)$e.write_shift(4,0);for($e.write_shift(4,0|(+u[Gb]||3)<<8),O=0,N=0;O<U.length;++O)if(U[O]!=null){var de=D.next(32),nt=(U[O].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);de.write_shift(1,nt,"sbcs"),de.write_shift(1,pe[O]=="?"?"C":pe[O],"sbcs"),de.write_shift(4,N),de.write_shift(1,ge[O]||b[pe[O]]||0),de.write_shift(1,ve[O]||0),de.write_shift(1,2),de.write_shift(4,0),de.write_shift(1,0),de.write_shift(4,0),de.write_shift(4,0),N+=ge[O]||b[pe[O]]||0}var le=D.next(264);for(le.write_shift(4,13),O=0;O<65;++O)le.write_shift(4,0);for(O=0;O<j.length;++O){var ct=D.next(J);for(ct.write_shift(1,0),N=0;N<U.length;++N)if(U[N]!=null)switch(pe[N]){case"L":ct.write_shift(1,j[O][N]==null?63:j[O][N]?84:70);break;case"B":ct.write_shift(8,j[O][N]||0,"f");break;case"N":var et="0";for(typeof j[O][N]=="number"&&(et=j[O][N].toFixed(ve[N]||0)),Z=0;Z<ge[N]-et.length;++Z)ct.write_shift(1,32);ct.write_shift(1,et,"sbcs");break;case"D":j[O][N]?(ct.write_shift(4,("0000"+j[O][N].getFullYear()).slice(-4),"sbcs"),ct.write_shift(2,("00"+(j[O][N].getMonth()+1)).slice(-2),"sbcs"),ct.write_shift(2,("00"+j[O][N].getDate()).slice(-2),"sbcs")):ct.write_shift(8,"00000000","sbcs");break;case"C":var He=String(j[O][N]!=null?j[O][N]:"").slice(0,ge[N]);for(ct.write_shift(1,He,"sbcs"),Z=0;Z<ge[N]-He.length;++Z)ct.write_shift(1,32);break}}return D.next(1).write_shift(1,26),D.end()}return{to_workbook:p,to_sheet:f,from_sheet:_}})(),Jk=(function(){var r={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},u=new RegExp("\x1BN("+Uh(r).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),l=function(U,j){var H=r[j];return typeof H=="number"?sv(H):H},f=function(U,j,H){var O=j.charCodeAt(0)-32<<4|H.charCodeAt(0)-48;return O==59?U:sv(O)};r["|"]=254;function p(U,j){switch(j.type){case"base64":return b(Ac(U),j);case"binary":return b(U,j);case"buffer":return b(ra&&Buffer.isBuffer(U)?U.toString("binary"):Mp(U),j);case"array":return b(Ep(U),j)}throw new Error("Unrecognized type "+j.type)}function b(U,j){var H=U.split(/[\n\r]+/),O=-1,N=-1,Z=0,J=0,X=[],pe=[],ge=null,ve={},re=[],Ce=[],xe=[],Ge=0,$e;for(+j.codepage>=0&&eh(+j.codepage);Z!==H.length;++Z){Ge=0;var de=H[Z].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,f).replace(u,l),nt=de.replace(/;;/g,"\0").split(";").map(function(Re){return Re.replace(/\u0000/g,";")}),le=nt[0],ct;if(de.length>0)switch(le){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":nt[1].charAt(0)=="P"&&pe.push(de.slice(3).replace(/;;/g,";"));break;case"C":var et=!1,He=!1,$t=!1,Oe=!1,It=-1,me=-1;for(J=1;J<nt.length;++J)switch(nt[J].charAt(0)){case"A":break;case"X":N=parseInt(nt[J].slice(1))-1,He=!0;break;case"Y":for(O=parseInt(nt[J].slice(1))-1,He||(N=0),$e=X.length;$e<=O;++$e)X[$e]=[];break;case"K":ct=nt[J].slice(1),ct.charAt(0)==='"'?ct=ct.slice(1,ct.length-1):ct==="TRUE"?ct=!0:ct==="FALSE"?ct=!1:isNaN(rh(ct))?isNaN(Y0(ct).getDate())||(ct=Ks(ct)):(ct=rh(ct),ge!==null&&rm(ge)&&(ct=Ox(ct))),et=!0;break;case"E":Oe=!0;var ne=W0(nt[J].slice(1),{r:O,c:N});X[O][N]=[X[O][N],ne];break;case"S":$t=!0,X[O][N]=[X[O][N],"S5S"];break;case"G":break;case"R":It=parseInt(nt[J].slice(1))-1;break;case"C":me=parseInt(nt[J].slice(1))-1;break;default:if(j&&j.WTF)throw new Error("SYLK bad record "+de)}if(et&&(X[O][N]&&X[O][N].length==2?X[O][N][0]=ct:X[O][N]=ct,ge=null),$t){if(Oe)throw new Error("SYLK shared formula cannot have own formula");var Ue=It>-1&&X[It][me];if(!Ue||!Ue[1])throw new Error("SYLK shared formula cannot find base");X[O][N][1]=ew(Ue[1],{r:O-It,c:N-me})}break;case"F":var Fe=0;for(J=1;J<nt.length;++J)switch(nt[J].charAt(0)){case"X":N=parseInt(nt[J].slice(1))-1,++Fe;break;case"Y":for(O=parseInt(nt[J].slice(1))-1,$e=X.length;$e<=O;++$e)X[$e]=[];break;case"M":Ge=parseInt(nt[J].slice(1))/20;break;case"F":break;case"G":break;case"P":ge=pe[parseInt(nt[J].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(xe=nt[J].slice(1).split(" "),$e=parseInt(xe[0],10);$e<=parseInt(xe[1],10);++$e)Ge=parseInt(xe[2],10),Ce[$e-1]=Ge===0?{hidden:!0}:{wch:Ge},K0(Ce[$e-1]);break;case"C":N=parseInt(nt[J].slice(1))-1,Ce[N]||(Ce[N]={});break;case"R":O=parseInt(nt[J].slice(1))-1,re[O]||(re[O]={}),Ge>0?(re[O].hpt=Ge,re[O].hpx=Og(Ge)):Ge===0&&(re[O].hidden=!0);break;default:if(j&&j.WTF)throw new Error("SYLK bad record "+de)}Fe<1&&(ge=null);break;default:if(j&&j.WTF)throw new Error("SYLK bad record "+de)}}return re.length>0&&(ve["!rows"]=re),Ce.length>0&&(ve["!cols"]=Ce),j&&j.sheetRows&&(X=X.slice(0,j.sheetRows)),[X,ve]}function _(U,j){var H=p(U,j),O=H[0],N=H[1],Z=am(O,j);return Uh(N).forEach(function(J){Z[J]=N[J]}),Z}function s(U,j){return Ed(_(U,j),j)}function C(U,j,H,O){var N="C;Y"+(H+1)+";X"+(O+1)+";K";switch(U.t){case"n":N+=U.v||0,U.f&&!U.F&&(N+=";E"+B5(U.f,{r:H,c:O}));break;case"b":N+=U.v?"TRUE":"FALSE";break;case"e":N+=U.w||U.v;break;case"d":N+='"'+(U.w||U.v)+'"';break;case"s":N+='"'+U.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return N}function M(U,j){j.forEach(function(H,O){var N="F;W"+(O+1)+" "+(O+1)+" ";H.hidden?N+="0":(typeof H.width=="number"&&!H.wpx&&(H.wpx=Cx(H.width)),typeof H.wpx=="number"&&!H.wch&&(H.wch=Mx(H.wpx)),typeof H.wch=="number"&&(N+=Math.round(H.wch))),N.charAt(N.length-1)!=" "&&U.push(N)})}function D(U,j){j.forEach(function(H,O){var N="F;";H.hidden?N+="M0;":H.hpt?N+="M"+20*H.hpt+";":H.hpx&&(N+="M"+20*K2(H.hpx)+";"),N.length>2&&U.push(N+"R"+(O+1))})}function B(U,j){var H=["ID;PWXL;N;E"],O=[],N=Yi(U["!ref"]),Z,J=Array.isArray(U),X=`\r
`;H.push("P;PGeneral"),H.push("F;P0;DG0G8;M255"),U["!cols"]&&M(H,U["!cols"]),U["!rows"]&&D(H,U["!rows"]),H.push("B;Y"+(N.e.r-N.s.r+1)+";X"+(N.e.c-N.s.c+1)+";D"+[N.s.c,N.s.r,N.e.c,N.e.r].join(" "));for(var pe=N.s.r;pe<=N.e.r;++pe)for(var ge=N.s.c;ge<=N.e.c;++ge){var ve=Dn({r:pe,c:ge});Z=J?(U[pe]||[])[ge]:U[ve],!(!Z||Z.v==null&&(!Z.f||Z.F))&&O.push(C(Z,U,pe,ge))}return H.join(X)+X+O.join(X)+X+"E"+X}return{to_workbook:s,to_sheet:_,from_sheet:B}})(),Qk=(function(){function r(b,_){switch(_.type){case"base64":return u(Ac(b),_);case"binary":return u(b,_);case"buffer":return u(ra&&Buffer.isBuffer(b)?b.toString("binary"):Mp(b),_);case"array":return u(Ep(b),_)}throw new Error("Unrecognized type "+_.type)}function u(b,_){for(var s=b.split(`
`),C=-1,M=-1,D=0,B=[];D!==s.length;++D){if(s[D].trim()==="BOT"){B[++C]=[],M=0;continue}if(!(C<0)){var U=s[D].trim().split(","),j=U[0],H=U[1];++D;for(var O=s[D]||"";(O.match(/["]/g)||[]).length&1&&D<s.length-1;)O+=`
`+s[++D];switch(O=O.trim(),+j){case-1:if(O==="BOT"){B[++C]=[],M=0;continue}else if(O!=="EOD")throw new Error("Unrecognized DIF special command "+O);break;case 0:O==="TRUE"?B[C][M]=!0:O==="FALSE"?B[C][M]=!1:isNaN(rh(H))?isNaN(Y0(H).getDate())?B[C][M]=H:B[C][M]=Ks(H):B[C][M]=rh(H),++M;break;case 1:O=O.slice(1,O.length-1),O=O.replace(/""/g,'"'),O&&O.match(/^=".*"$/)&&(O=O.slice(2,-1)),B[C][M++]=O!==""?O:null;break}if(O==="EOD")break}}return _&&_.sheetRows&&(B=B.slice(0,_.sheetRows)),B}function l(b,_){return am(r(b,_),_)}function f(b,_){return Ed(l(b,_),_)}var p=(function(){var b=function(C,M,D,B,U){C.push(M),C.push(D+","+B),C.push('"'+U.replace(/"/g,'""')+'"')},_=function(C,M,D,B){C.push(M+","+D),C.push(M==1?'"'+B.replace(/"/g,'""')+'"':B)};return function(C){var M=[],D=Yi(C["!ref"]),B,U=Array.isArray(C);b(M,"TABLE",0,1,"sheetjs"),b(M,"VECTORS",0,D.e.r-D.s.r+1,""),b(M,"TUPLES",0,D.e.c-D.s.c+1,""),b(M,"DATA",0,0,"");for(var j=D.s.r;j<=D.e.r;++j){_(M,-1,0,"BOT");for(var H=D.s.c;H<=D.e.c;++H){var O=Dn({r:j,c:H});if(B=U?(C[j]||[])[H]:C[O],!B){_(M,1,0,"");continue}switch(B.t){case"n":var N=B.w;!N&&B.v!=null&&(N=B.v),N==null?B.f&&!B.F?_(M,1,0,"="+B.f):_(M,1,0,""):_(M,0,N,"V");break;case"b":_(M,0,B.v?1:0,B.v?"TRUE":"FALSE");break;case"s":_(M,1,0,isNaN(B.v)?B.v:'="'+B.v+'"');break;case"d":B.w||(B.w=iu(B.z||Pn[14],Sl(Ks(B.v)))),_(M,0,B.w,"V");break;default:_(M,1,0,"")}}}_(M,-1,0,"EOD");var Z=`\r
`,J=M.join(Z);return J}})();return{to_workbook:f,to_sheet:l,from_sheet:p}})(),eC=(function(){function r(B){return B.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function u(B){return B.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function l(B,U){for(var j=B.split(`
`),H=-1,O=-1,N=0,Z=[];N!==j.length;++N){var J=j[N].trim().split(":");if(J[0]==="cell"){var X=wl(J[1]);if(Z.length<=X.r)for(H=Z.length;H<=X.r;++H)Z[H]||(Z[H]=[]);switch(H=X.r,O=X.c,J[2]){case"t":Z[H][O]=r(J[3]);break;case"v":Z[H][O]=+J[3];break;case"vtf":var pe=J[J.length-1];case"vtc":J[3]==="nl"?Z[H][O]=!!+J[4]:Z[H][O]=+J[4],J[2]=="vtf"&&(Z[H][O]=[Z[H][O],pe])}}}return U&&U.sheetRows&&(Z=Z.slice(0,U.sheetRows)),Z}function f(B,U){return am(l(B,U),U)}function p(B,U){return Ed(f(B,U),U)}var b=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),_=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,s=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),C="--SocialCalcSpreadsheetControlSave--";function M(B){if(!B||!B["!ref"])return"";for(var U=[],j=[],H,O="",N=nm(B["!ref"]),Z=Array.isArray(B),J=N.s.r;J<=N.e.r;++J)for(var X=N.s.c;X<=N.e.c;++X)if(O=Dn({r:J,c:X}),H=Z?(B[J]||[])[X]:B[O],!(!H||H.v==null||H.t==="z")){switch(j=["cell",O,"t"],H.t){case"s":case"str":j.push(u(H.v));break;case"n":H.f?(j[2]="vtf",j[3]="n",j[4]=H.v,j[5]=u(H.f)):(j[2]="v",j[3]=H.v);break;case"b":j[2]="vt"+(H.f?"f":"c"),j[3]="nl",j[4]=H.v?"1":"0",j[5]=u(H.f||(H.v?"TRUE":"FALSE"));break;case"d":var pe=Sl(Ks(H.v));j[2]="vtc",j[3]="nd",j[4]=""+pe,j[5]=H.w||iu(H.z||Pn[14],pe);break;case"e":continue}U.push(j.join(":"))}return U.push("sheet:c:"+(N.e.c-N.s.c+1)+":r:"+(N.e.r-N.s.r+1)+":tvf:1"),U.push("valueformat:1:text-wiki"),U.join(`
`)}function D(B){return[b,_,s,_,M(B),C].join(`
`)}return{to_workbook:p,to_sheet:f,from_sheet:D}})(),Lg=(function(){function r(D,B,U,j,H){H.raw?B[U][j]=D:D===""||(D==="TRUE"?B[U][j]=!0:D==="FALSE"?B[U][j]=!1:isNaN(rh(D))?isNaN(Y0(D).getDate())?B[U][j]=D:B[U][j]=Ks(D):B[U][j]=rh(D))}function u(D,B){var U=B||{},j=[];if(!D||D.length===0)return j;for(var H=D.split(/[\r\n]/),O=H.length-1;O>=0&&H[O].length===0;)--O;for(var N=10,Z=0,J=0;J<=O;++J)Z=H[J].indexOf(" "),Z==-1?Z=H[J].length:Z++,N=Math.max(N,Z);for(J=0;J<=O;++J){j[J]=[];var X=0;for(r(H[J].slice(0,N).trim(),j,J,X,U),X=1;X<=(H[J].length-N)/10+1;++X)r(H[J].slice(N+(X-1)*10,N+X*10).trim(),j,J,X,U)}return U.sheetRows&&(j=j.slice(0,U.sheetRows)),j}var l={44:",",9:"	",59:";",124:"|"},f={44:3,9:2,59:1,124:0};function p(D){for(var B={},U=!1,j=0,H=0;j<D.length;++j)(H=D.charCodeAt(j))==34?U=!U:!U&&H in l&&(B[H]=(B[H]||0)+1);H=[];for(j in B)Object.prototype.hasOwnProperty.call(B,j)&&H.push([B[j],j]);if(!H.length){B=f;for(j in B)Object.prototype.hasOwnProperty.call(B,j)&&H.push([B[j],j])}return H.sort(function(O,N){return O[0]-N[0]||f[O[1]]-f[N[1]]}),l[H.pop()[1]]||44}function b(D,B){var U=B||{},j="",H=U.dense?[]:{},O={s:{c:0,r:0},e:{c:0,r:0}};D.slice(0,4)=="sep="?D.charCodeAt(5)==13&&D.charCodeAt(6)==10?(j=D.charAt(4),D=D.slice(7)):D.charCodeAt(5)==13||D.charCodeAt(5)==10?(j=D.charAt(4),D=D.slice(6)):j=p(D.slice(0,1024)):U&&U.FS?j=U.FS:j=p(D.slice(0,1024));var N=0,Z=0,J=0,X=0,pe=0,ge=j.charCodeAt(0),ve=!1,re=0,Ce=D.charCodeAt(0);D=D.replace(/\r\n/mg,`
`);var xe=U.dateNF!=null?hE(U.dateNF):null;function Ge(){var $e=D.slice(X,pe),de={};if($e.charAt(0)=='"'&&$e.charAt($e.length-1)=='"'&&($e=$e.slice(1,-1).replace(/""/g,'"')),$e.length===0)de.t="z";else if(U.raw)de.t="s",de.v=$e;else if($e.trim().length===0)de.t="s",de.v=$e;else if($e.charCodeAt(0)==61)$e.charCodeAt(1)==34&&$e.charCodeAt($e.length-1)==34?(de.t="s",de.v=$e.slice(2,-1).replace(/""/g,'"')):j5($e)?(de.t="n",de.f=$e.slice(1)):(de.t="s",de.v=$e);else if($e=="TRUE")de.t="b",de.v=!0;else if($e=="FALSE")de.t="b",de.v=!1;else if(!isNaN(J=rh($e)))de.t="n",U.cellText!==!1&&(de.w=$e),de.v=J;else if(!isNaN(Y0($e).getDate())||xe&&$e.match(xe)){de.z=U.dateNF||Pn[14];var nt=0;xe&&$e.match(xe)&&($e=fE($e,U.dateNF,$e.match(xe)||[]),nt=1),U.cellDates?(de.t="d",de.v=Ks($e,nt)):(de.t="n",de.v=Sl(Ks($e,nt))),U.cellText!==!1&&(de.w=iu(de.z,de.v instanceof Date?Sl(de.v):de.v)),U.cellNF||delete de.z}else de.t="s",de.v=$e;if(de.t=="z"||(U.dense?(H[N]||(H[N]=[]),H[N][Z]=de):H[Dn({c:Z,r:N})]=de),X=pe+1,Ce=D.charCodeAt(X),O.e.c<Z&&(O.e.c=Z),O.e.r<N&&(O.e.r=N),re==ge)++Z;else if(Z=0,++N,U.sheetRows&&U.sheetRows<=N)return!0}e:for(;pe<D.length;++pe)switch(re=D.charCodeAt(pe)){case 34:Ce===34&&(ve=!ve);break;case ge:case 10:case 13:if(!ve&&Ge())break e;break}return pe-X>0&&Ge(),H["!ref"]=ca(O),H}function _(D,B){return!(B&&B.PRN)||B.FS||D.slice(0,4)=="sep="||D.indexOf("	")>=0||D.indexOf(",")>=0||D.indexOf(";")>=0?b(D,B):am(u(D,B),B)}function s(D,B){var U="",j=B.type=="string"?[0,0,0,0]:E1(D,B);switch(B.type){case"base64":U=Ac(D);break;case"binary":U=D;break;case"buffer":B.codepage==65001?U=D.toString("utf8"):B.codepage&&typeof Rg<"u"||(U=ra&&Buffer.isBuffer(D)?D.toString("binary"):Mp(D));break;case"array":U=Ep(D);break;case"string":U=D;break;default:throw new Error("Unrecognized type "+B.type)}return j[0]==239&&j[1]==187&&j[2]==191?U=si(U.slice(3)):B.type!="string"&&B.type!="buffer"&&B.codepage==65001?U=si(U):B.type=="binary"&&typeof Rg<"u",U.slice(0,19)=="socialcalc:version:"?eC.to_sheet(B.type=="string"?U:si(U),B):_(U,B)}function C(D,B){return Ed(s(D,B),B)}function M(D){for(var B=[],U=Yi(D["!ref"]),j,H=Array.isArray(D),O=U.s.r;O<=U.e.r;++O){for(var N=[],Z=U.s.c;Z<=U.e.c;++Z){var J=Dn({r:O,c:Z});if(j=H?(D[O]||[])[Z]:D[J],!j||j.v==null){N.push("          ");continue}for(var X=(j.w||(kf(j),j.w)||"").slice(0,10);X.length<10;)X+=" ";N.push(X+(Z===0?" ":""))}B.push(N.join(""))}return B.join(`
`)}return{to_workbook:C,to_sheet:s,from_sheet:M}})();function tC(r,u){var l=u||{},f=!!l.WTF;l.WTF=!0;try{var p=Jk.to_workbook(r,l);return l.WTF=f,p}catch(b){if(l.WTF=f,!b.message.match(/SYLK bad record ID/)&&f)throw b;return Lg.to_workbook(r,u)}}var Ag=(function(){function r(ne,Ue,Fe){if(ne){ho(ne,ne.l||0);for(var Re=Fe.Enum||It;ne.l<ne.length;){var bt=ne.read_shift(2),Gt=Re[bt]||Re[65535],Vt=ne.read_shift(2),Bt=ne.l+Vt,Yt=Gt.f&&Gt.f(ne,Vt,Fe);if(ne.l=Bt,Ue(Yt,Gt,bt))return}}}function u(ne,Ue){switch(Ue.type){case"base64":return l(Ju(Ac(ne)),Ue);case"binary":return l(Ju(ne),Ue);case"buffer":case"array":return l(ne,Ue)}throw"Unsupported type "+Ue.type}function l(ne,Ue){if(!ne)return ne;var Fe=Ue||{},Re=Fe.dense?[]:{},bt="Sheet1",Gt="",Vt=0,Bt={},Yt=[],Or=[],Ye={s:{r:0,c:0},e:{r:0,c:0}},pn=Fe.sheetRows||0;if(ne[2]==0&&(ne[3]==8||ne[3]==9)&&ne.length>=16&&ne[14]==5&&ne[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(ne[2]==2)Fe.Enum=It,r(ne,function(Ee,Ne,pt){switch(pt){case 0:Fe.vers=Ee,Ee>=4096&&(Fe.qpro=!0);break;case 6:Ye=Ee;break;case 204:Ee&&(Gt=Ee);break;case 222:Gt=Ee;break;case 15:case 51:Fe.qpro||(Ee[1].v=Ee[1].v.slice(1));case 13:case 14:case 16:pt==14&&(Ee[2]&112)==112&&(Ee[2]&15)>1&&(Ee[2]&15)<15&&(Ee[1].z=Fe.dateNF||Pn[14],Fe.cellDates&&(Ee[1].t="d",Ee[1].v=Ox(Ee[1].v))),Fe.qpro&&Ee[3]>Vt&&(Re["!ref"]=ca(Ye),Bt[bt]=Re,Yt.push(bt),Re=Fe.dense?[]:{},Ye={s:{r:0,c:0},e:{r:0,c:0}},Vt=Ee[3],bt=Gt||"Sheet"+(Vt+1),Gt="");var Jt=Fe.dense?(Re[Ee[0].r]||[])[Ee[0].c]:Re[Dn(Ee[0])];if(Jt){Jt.t=Ee[1].t,Jt.v=Ee[1].v,Ee[1].z!=null&&(Jt.z=Ee[1].z),Ee[1].f!=null&&(Jt.f=Ee[1].f);break}Fe.dense?(Re[Ee[0].r]||(Re[Ee[0].r]=[]),Re[Ee[0].r][Ee[0].c]=Ee[1]):Re[Dn(Ee[0])]=Ee[1];break}},Fe);else if(ne[2]==26||ne[2]==14)Fe.Enum=me,ne[2]==14&&(Fe.qpro=!0,ne.l=0),r(ne,function(Ee,Ne,pt){switch(pt){case 204:bt=Ee;break;case 22:Ee[1].v=Ee[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ee[3]>Vt&&(Re["!ref"]=ca(Ye),Bt[bt]=Re,Yt.push(bt),Re=Fe.dense?[]:{},Ye={s:{r:0,c:0},e:{r:0,c:0}},Vt=Ee[3],bt="Sheet"+(Vt+1)),pn>0&&Ee[0].r>=pn)break;Fe.dense?(Re[Ee[0].r]||(Re[Ee[0].r]=[]),Re[Ee[0].r][Ee[0].c]=Ee[1]):Re[Dn(Ee[0])]=Ee[1],Ye.e.c<Ee[0].c&&(Ye.e.c=Ee[0].c),Ye.e.r<Ee[0].r&&(Ye.e.r=Ee[0].r);break;case 27:Ee[14e3]&&(Or[Ee[14e3][0]]=Ee[14e3][1]);break;case 1537:Or[Ee[0]]=Ee[1],Ee[0]==Vt&&(bt=Ee[1]);break}},Fe);else throw new Error("Unrecognized LOTUS BOF "+ne[2]);if(Re["!ref"]=ca(Ye),Bt[Gt||bt]=Re,Yt.push(Gt||bt),!Or.length)return{SheetNames:Yt,Sheets:Bt};for(var se={},Mt=[],yt=0;yt<Or.length;++yt)Bt[Yt[yt]]?(Mt.push(Or[yt]||Yt[yt]),se[Or[yt]]=Bt[Or[yt]]||Bt[Yt[yt]]):(Mt.push(Or[yt]),se[Or[yt]]={"!ref":"A1"});return{SheetNames:Mt,Sheets:se}}function f(ne,Ue){var Fe=Ue||{};if(+Fe.codepage>=0&&eh(+Fe.codepage),Fe.type=="string")throw new Error("Cannot write WK1 to JS string");var Re=Fy(),bt=Yi(ne["!ref"]),Gt=Array.isArray(ne),Vt=[];Ku(Re,0,b(1030)),Ku(Re,6,C(bt));for(var Bt=Math.min(bt.e.r,8191),Yt=bt.s.r;Yt<=Bt;++Yt)for(var Or=po(Yt),Ye=bt.s.c;Ye<=bt.e.c;++Ye){Yt===bt.s.r&&(Vt[Ye]=Is(Ye));var pn=Vt[Ye]+Or,se=Gt?(ne[Yt]||[])[Ye]:ne[pn];if(!(!se||se.t=="z"))if(se.t=="n")(se.v|0)==se.v&&se.v>=-32768&&se.v<=32767?Ku(Re,13,j(Yt,Ye,se.v)):Ku(Re,14,O(Yt,Ye,se.v));else{var Mt=kf(se);Ku(Re,15,B(Yt,Ye,Mt.slice(0,239)))}}return Ku(Re,1),Re.end()}function p(ne,Ue){var Fe=Ue||{};if(+Fe.codepage>=0&&eh(+Fe.codepage),Fe.type=="string")throw new Error("Cannot write WK3 to JS string");var Re=Fy();Ku(Re,0,_(ne));for(var bt=0,Gt=0;bt<ne.SheetNames.length;++bt)(ne.Sheets[ne.SheetNames[bt]]||{})["!ref"]&&Ku(Re,27,Oe(ne.SheetNames[bt],Gt++));var Vt=0;for(bt=0;bt<ne.SheetNames.length;++bt){var Bt=ne.Sheets[ne.SheetNames[bt]];if(!(!Bt||!Bt["!ref"])){for(var Yt=Yi(Bt["!ref"]),Or=Array.isArray(Bt),Ye=[],pn=Math.min(Yt.e.r,8191),se=Yt.s.r;se<=pn;++se)for(var Mt=po(se),yt=Yt.s.c;yt<=Yt.e.c;++yt){se===Yt.s.r&&(Ye[yt]=Is(yt));var Ee=Ye[yt]+Mt,Ne=Or?(Bt[se]||[])[yt]:Bt[Ee];if(!(!Ne||Ne.t=="z"))if(Ne.t=="n")Ku(Re,23,Ge(se,yt,Vt,Ne.v));else{var pt=kf(Ne);Ku(Re,22,re(se,yt,Vt,pt.slice(0,239)))}}++Vt}}return Ku(Re,1),Re.end()}function b(ne){var Ue=Rs(2);return Ue.write_shift(2,ne),Ue}function _(ne){var Ue=Rs(26);Ue.write_shift(2,4096),Ue.write_shift(2,4),Ue.write_shift(4,0);for(var Fe=0,Re=0,bt=0,Gt=0;Gt<ne.SheetNames.length;++Gt){var Vt=ne.SheetNames[Gt],Bt=ne.Sheets[Vt];if(!(!Bt||!Bt["!ref"])){++bt;var Yt=nm(Bt["!ref"]);Fe<Yt.e.r&&(Fe=Yt.e.r),Re<Yt.e.c&&(Re=Yt.e.c)}}return Fe>8191&&(Fe=8191),Ue.write_shift(2,Fe),Ue.write_shift(1,bt),Ue.write_shift(1,Re),Ue.write_shift(2,0),Ue.write_shift(2,0),Ue.write_shift(1,1),Ue.write_shift(1,2),Ue.write_shift(4,0),Ue.write_shift(4,0),Ue}function s(ne,Ue,Fe){var Re={s:{c:0,r:0},e:{c:0,r:0}};return Ue==8&&Fe.qpro?(Re.s.c=ne.read_shift(1),ne.l++,Re.s.r=ne.read_shift(2),Re.e.c=ne.read_shift(1),ne.l++,Re.e.r=ne.read_shift(2),Re):(Re.s.c=ne.read_shift(2),Re.s.r=ne.read_shift(2),Ue==12&&Fe.qpro&&(ne.l+=2),Re.e.c=ne.read_shift(2),Re.e.r=ne.read_shift(2),Ue==12&&Fe.qpro&&(ne.l+=2),Re.s.c==65535&&(Re.s.c=Re.e.c=Re.s.r=Re.e.r=0),Re)}function C(ne){var Ue=Rs(8);return Ue.write_shift(2,ne.s.c),Ue.write_shift(2,ne.s.r),Ue.write_shift(2,ne.e.c),Ue.write_shift(2,ne.e.r),Ue}function M(ne,Ue,Fe){var Re=[{c:0,r:0},{t:"n",v:0},0,0];return Fe.qpro&&Fe.vers!=20768?(Re[0].c=ne.read_shift(1),Re[3]=ne.read_shift(1),Re[0].r=ne.read_shift(2),ne.l+=2):(Re[2]=ne.read_shift(1),Re[0].c=ne.read_shift(2),Re[0].r=ne.read_shift(2)),Re}function D(ne,Ue,Fe){var Re=ne.l+Ue,bt=M(ne,Ue,Fe);if(bt[1].t="s",Fe.vers==20768){ne.l++;var Gt=ne.read_shift(1);return bt[1].v=ne.read_shift(Gt,"utf8"),bt}return Fe.qpro&&ne.l++,bt[1].v=ne.read_shift(Re-ne.l,"cstr"),bt}function B(ne,Ue,Fe){var Re=Rs(7+Fe.length);Re.write_shift(1,255),Re.write_shift(2,Ue),Re.write_shift(2,ne),Re.write_shift(1,39);for(var bt=0;bt<Re.length;++bt){var Gt=Fe.charCodeAt(bt);Re.write_shift(1,Gt>=128?95:Gt)}return Re.write_shift(1,0),Re}function U(ne,Ue,Fe){var Re=M(ne,Ue,Fe);return Re[1].v=ne.read_shift(2,"i"),Re}function j(ne,Ue,Fe){var Re=Rs(7);return Re.write_shift(1,255),Re.write_shift(2,Ue),Re.write_shift(2,ne),Re.write_shift(2,Fe,"i"),Re}function H(ne,Ue,Fe){var Re=M(ne,Ue,Fe);return Re[1].v=ne.read_shift(8,"f"),Re}function O(ne,Ue,Fe){var Re=Rs(13);return Re.write_shift(1,255),Re.write_shift(2,Ue),Re.write_shift(2,ne),Re.write_shift(8,Fe,"f"),Re}function N(ne,Ue,Fe){var Re=ne.l+Ue,bt=M(ne,Ue,Fe);if(bt[1].v=ne.read_shift(8,"f"),Fe.qpro)ne.l=Re;else{var Gt=ne.read_shift(2);pe(ne.slice(ne.l,ne.l+Gt),bt),ne.l+=Gt}return bt}function Z(ne,Ue,Fe){var Re=Ue&32768;return Ue&=-32769,Ue=(Re?ne:0)+(Ue>=8192?Ue-16384:Ue),(Re?"":"$")+(Fe?Is(Ue):po(Ue))}var J={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},X=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function pe(ne,Ue){ho(ne,0);for(var Fe=[],Re=0,bt="",Gt="",Vt="",Bt="";ne.l<ne.length;){var Yt=ne[ne.l++];switch(Yt){case 0:Fe.push(ne.read_shift(8,"f"));break;case 1:Gt=Z(Ue[0].c,ne.read_shift(2),!0),bt=Z(Ue[0].r,ne.read_shift(2),!1),Fe.push(Gt+bt);break;case 2:{var Or=Z(Ue[0].c,ne.read_shift(2),!0),Ye=Z(Ue[0].r,ne.read_shift(2),!1);Gt=Z(Ue[0].c,ne.read_shift(2),!0),bt=Z(Ue[0].r,ne.read_shift(2),!1),Fe.push(Or+Ye+":"+Gt+bt)}break;case 3:if(ne.l<ne.length){console.error("WK1 premature formula end");return}break;case 4:Fe.push("("+Fe.pop()+")");break;case 5:Fe.push(ne.read_shift(2));break;case 6:{for(var pn="";Yt=ne[ne.l++];)pn+=String.fromCharCode(Yt);Fe.push('"'+pn.replace(/"/g,'""')+'"')}break;case 8:Fe.push("-"+Fe.pop());break;case 23:Fe.push("+"+Fe.pop());break;case 22:Fe.push("NOT("+Fe.pop()+")");break;case 20:case 21:Bt=Fe.pop(),Vt=Fe.pop(),Fe.push(["AND","OR"][Yt-20]+"("+Vt+","+Bt+")");break;default:if(Yt<32&&X[Yt])Bt=Fe.pop(),Vt=Fe.pop(),Fe.push(Vt+X[Yt]+Bt);else if(J[Yt]){if(Re=J[Yt][1],Re==69&&(Re=ne[ne.l++]),Re>Fe.length){console.error("WK1 bad formula parse 0x"+Yt.toString(16)+":|"+Fe.join("|")+"|");return}var se=Fe.slice(-Re);Fe.length-=Re,Fe.push(J[Yt][0]+"("+se.join(",")+")")}else return Yt<=7?console.error("WK1 invalid opcode "+Yt.toString(16)):Yt<=24?console.error("WK1 unsupported op "+Yt.toString(16)):Yt<=30?console.error("WK1 invalid opcode "+Yt.toString(16)):Yt<=115?console.error("WK1 unsupported function opcode "+Yt.toString(16)):console.error("WK1 unrecognized opcode "+Yt.toString(16))}}Fe.length==1?Ue[1].f=""+Fe[0]:console.error("WK1 bad formula parse |"+Fe.join("|")+"|")}function ge(ne){var Ue=[{c:0,r:0},{t:"n",v:0},0];return Ue[0].r=ne.read_shift(2),Ue[3]=ne[ne.l++],Ue[0].c=ne[ne.l++],Ue}function ve(ne,Ue){var Fe=ge(ne);return Fe[1].t="s",Fe[1].v=ne.read_shift(Ue-4,"cstr"),Fe}function re(ne,Ue,Fe,Re){var bt=Rs(6+Re.length);bt.write_shift(2,ne),bt.write_shift(1,Fe),bt.write_shift(1,Ue),bt.write_shift(1,39);for(var Gt=0;Gt<Re.length;++Gt){var Vt=Re.charCodeAt(Gt);bt.write_shift(1,Vt>=128?95:Vt)}return bt.write_shift(1,0),bt}function Ce(ne,Ue){var Fe=ge(ne);Fe[1].v=ne.read_shift(2);var Re=Fe[1].v>>1;if(Fe[1].v&1)switch(Re&7){case 0:Re=(Re>>3)*5e3;break;case 1:Re=(Re>>3)*500;break;case 2:Re=(Re>>3)/20;break;case 3:Re=(Re>>3)/200;break;case 4:Re=(Re>>3)/2e3;break;case 5:Re=(Re>>3)/2e4;break;case 6:Re=(Re>>3)/16;break;case 7:Re=(Re>>3)/64;break}return Fe[1].v=Re,Fe}function xe(ne,Ue){var Fe=ge(ne),Re=ne.read_shift(4),bt=ne.read_shift(4),Gt=ne.read_shift(2);if(Gt==65535)return Re===0&&bt===3221225472?(Fe[1].t="e",Fe[1].v=15):Re===0&&bt===3489660928?(Fe[1].t="e",Fe[1].v=42):Fe[1].v=0,Fe;var Vt=Gt&32768;return Gt=(Gt&32767)-16446,Fe[1].v=(1-Vt*2)*(bt*Math.pow(2,Gt+32)+Re*Math.pow(2,Gt)),Fe}function Ge(ne,Ue,Fe,Re){var bt=Rs(14);if(bt.write_shift(2,ne),bt.write_shift(1,Fe),bt.write_shift(1,Ue),Re==0)return bt.write_shift(4,0),bt.write_shift(4,0),bt.write_shift(2,65535),bt;var Gt=0,Vt=0,Bt=0,Yt=0;return Re<0&&(Gt=1,Re=-Re),Vt=Math.log2(Re)|0,Re/=Math.pow(2,Vt-31),Yt=Re>>>0,(Yt&2147483648)==0&&(Re/=2,++Vt,Yt=Re>>>0),Re-=Yt,Yt|=2147483648,Yt>>>=0,Re*=Math.pow(2,32),Bt=Re>>>0,bt.write_shift(4,Bt),bt.write_shift(4,Yt),Vt+=16383+(Gt?32768:0),bt.write_shift(2,Vt),bt}function $e(ne,Ue){var Fe=xe(ne);return ne.l+=Ue-14,Fe}function de(ne,Ue){var Fe=ge(ne),Re=ne.read_shift(4);return Fe[1].v=Re>>6,Fe}function nt(ne,Ue){var Fe=ge(ne),Re=ne.read_shift(8,"f");return Fe[1].v=Re,Fe}function le(ne,Ue){var Fe=nt(ne);return ne.l+=Ue-10,Fe}function ct(ne,Ue){return ne[ne.l+Ue-1]==0?ne.read_shift(Ue,"cstr"):""}function et(ne,Ue){var Fe=ne[ne.l++];Fe>Ue-1&&(Fe=Ue-1);for(var Re="";Re.length<Fe;)Re+=String.fromCharCode(ne[ne.l++]);return Re}function He(ne,Ue,Fe){if(!(!Fe.qpro||Ue<21)){var Re=ne.read_shift(1);ne.l+=17,ne.l+=1,ne.l+=2;var bt=ne.read_shift(Ue-21,"cstr");return[Re,bt]}}function $t(ne,Ue){for(var Fe={},Re=ne.l+Ue;ne.l<Re;){var bt=ne.read_shift(2);if(bt==14e3){for(Fe[bt]=[0,""],Fe[bt][0]=ne.read_shift(2);ne[ne.l];)Fe[bt][1]+=String.fromCharCode(ne[ne.l]),ne.l++;ne.l++}}return Fe}function Oe(ne,Ue){var Fe=Rs(5+ne.length);Fe.write_shift(2,14e3),Fe.write_shift(2,Ue);for(var Re=0;Re<ne.length;++Re){var bt=ne.charCodeAt(Re);Fe[Fe.l++]=bt>127?95:bt}return Fe[Fe.l++]=0,Fe}var It={0:{n:"BOF",f:vs},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:s},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:U},14:{n:"NUMBER",f:H},15:{n:"LABEL",f:D},16:{n:"FORMULA",f:N},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:D},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ct},222:{n:"SHEETNAMELP",f:et},65535:{n:""}},me={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:ve},23:{n:"NUMBER17",f:xe},24:{n:"NUMBER18",f:Ce},25:{n:"FORMULA19",f:$e},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:$t},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:de},38:{n:"??"},39:{n:"NUMBER27",f:nt},40:{n:"FORMULA28",f:le},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ct},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:He},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:f,book_to_wk3:p,to_workbook:u}})();function rC(r){var u={},l=r.match(qo),f=0,p=!1;if(l)for(;f!=l.length;++f){var b=xn(l[f]);switch(b[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!b.val)break;case"<shadow>":case"<shadow/>":u.shadow=1;break;case"</shadow>":break;case"<charset":if(b.val=="1")break;u.cp=t1[parseInt(b.val,10)];break;case"<outline":if(!b.val)break;case"<outline>":case"<outline/>":u.outline=1;break;case"</outline>":break;case"<rFont":u.name=b.val;break;case"<sz":u.sz=b.val;break;case"<strike":if(!b.val)break;case"<strike>":case"<strike/>":u.strike=1;break;case"</strike>":break;case"<u":if(!b.val)break;switch(b.val){case"double":u.uval="double";break;case"singleAccounting":u.uval="single-accounting";break;case"doubleAccounting":u.uval="double-accounting";break}case"<u>":case"<u/>":u.u=1;break;case"</u>":break;case"<b":if(b.val=="0")break;case"<b>":case"<b/>":u.b=1;break;case"</b>":break;case"<i":if(b.val=="0")break;case"<i>":case"<i/>":u.i=1;break;case"</i>":break;case"<color":b.rgb&&(u.color=b.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":u.family=b.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":u.valign=b.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":p=!0;break;case"</ext>":p=!1;break;default:if(b[0].charCodeAt(1)!==47&&!p)throw new Error("Unrecognized rich format "+b[0])}}return u}var nC=(function(){var r=Pg("t"),u=Pg("rPr");function l(b){var _=b.match(r);if(!_)return{t:"s",v:""};var s={t:"s",v:xa(_[1])},C=b.match(u);return C&&(s.s=rC(C[1])),s}var f=/<(?:\w+:)?r>/g,p=/<\/(?:\w+:)?r>/;return function(_){return _.replace(f,"").split(p).map(l).filter(function(s){return s.v})}})(),aC=(function(){var u=/(\r\n|\n)/g;function l(p,b,_){var s=[];p.u&&s.push("text-decoration: underline;"),p.uval&&s.push("text-underline-style:"+p.uval+";"),p.sz&&s.push("font-size:"+p.sz+"pt;"),p.outline&&s.push("text-effect: outline;"),p.shadow&&s.push("text-shadow: auto;"),b.push('<span style="'+s.join("")+'">'),p.b&&(b.push("<b>"),_.push("</b>")),p.i&&(b.push("<i>"),_.push("</i>")),p.strike&&(b.push("<s>"),_.push("</s>"));var C=p.valign||"";return C=="superscript"||C=="super"?C="sup":C=="subscript"&&(C="sub"),C!=""&&(b.push("<"+C+">"),_.push("</"+C+">")),_.push("</span>"),p}function f(p){var b=[[],p.v,[]];return p.v?(p.s&&l(p.s,b[0],b[2]),b[0].join("")+b[1].replace(u,"<br/>")+b[2].join("")):""}return function(b){return b.map(f).join("")}})(),iC=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,sC=/<(?:\w+:)?r>/,oC=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function x1(r,u){var l=u?u.cellHTML:!0,f={};return r?(r.match(/^\s*<(?:\w+:)?t[^>]*>/)?(f.t=xa(si(r.slice(r.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),f.r=si(r),l&&(f.h=l1(f.t))):r.match(sC)&&(f.r=si(r),f.t=xa(si((r.replace(oC,"").match(iC)||[]).join("").replace(qo,""))),l&&(f.h=aC(nC(f.r)))),f):{t:""}}var lC=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,cC=/<(?:\w+:)?(?:si|sstItem)>/g,uC=/<\/(?:\w+:)?(?:si|sstItem)>/;function hC(r,u){var l=[],f="";if(!r)return l;var p=r.match(lC);if(p){f=p[2].replace(cC,"").split(uC);for(var b=0;b!=f.length;++b){var _=x1(f[b].trim(),u);_!=null&&(l[l.length]=_)}p=xn(p[1]),l.Count=p.count,l.Unique=p.uniqueCount}return l}function fC(r){return[r.read_shift(4),r.read_shift(4)]}function dC(r,u){var l=[],f=!1;return Mf(r,function(b,_,s){switch(s){case 159:l.Count=b[0],l.Unique=b[1];break;case 19:l.push(b);break;case 160:return!0;case 35:f=!0;break;case 36:f=!1;break;default:if(_.T,!f||u.WTF)throw new Error("Unexpected record 0x"+s.toString(16))}}),l}function q2(r){for(var u=[],l=r.split(""),f=0;f<l.length;++f)u[f]=l[f].charCodeAt(0);return u}function Ef(r,u){var l={};return l.Major=r.read_shift(2),l.Minor=r.read_shift(2),u>=4&&(r.l+=u-4),l}function pC(r){var u={};return u.id=r.read_shift(0,"lpp4"),u.R=Ef(r,4),u.U=Ef(r,4),u.W=Ef(r,4),u}function mC(r){for(var u=r.read_shift(4),l=r.l+u-4,f={},p=r.read_shift(4),b=[];p-- >0;)b.push({t:r.read_shift(4),v:r.read_shift(0,"lpp4")});if(f.name=r.read_shift(0,"lpp4"),f.comps=b,r.l!=l)throw new Error("Bad DataSpaceMapEntry: "+r.l+" != "+l);return f}function gC(r){var u=[];r.l+=4;for(var l=r.read_shift(4);l-- >0;)u.push(mC(r));return u}function _C(r){var u=[];r.l+=4;for(var l=r.read_shift(4);l-- >0;)u.push(r.read_shift(0,"lpp4"));return u}function xC(r){var u={};return r.read_shift(4),r.l+=4,u.id=r.read_shift(0,"lpp4"),u.name=r.read_shift(0,"lpp4"),u.R=Ef(r,4),u.U=Ef(r,4),u.W=Ef(r,4),u}function yC(r){var u=xC(r);if(u.ename=r.read_shift(0,"8lpp4"),u.blksz=r.read_shift(4),u.cmode=r.read_shift(4),r.read_shift(4)!=4)throw new Error("Bad !Primary record");return u}function Z2(r,u){var l=r.l+u,f={};f.Flags=r.read_shift(4)&63,r.l+=4,f.AlgID=r.read_shift(4);var p=!1;switch(f.AlgID){case 26126:case 26127:case 26128:p=f.Flags==36;break;case 26625:p=f.Flags==4;break;case 0:p=f.Flags==16||f.Flags==4||f.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+f.AlgID}if(!p)throw new Error("Encryption Flags/AlgID mismatch");return f.AlgIDHash=r.read_shift(4),f.KeySize=r.read_shift(4),f.ProviderType=r.read_shift(4),r.l+=8,f.CSPName=r.read_shift(l-r.l>>1,"utf16le"),r.l=l,f}function W2(r,u){var l={},f=r.l+u;return r.l+=4,l.Salt=r.slice(r.l,r.l+16),r.l+=16,l.Verifier=r.slice(r.l,r.l+16),r.l+=16,r.read_shift(4),l.VerifierHash=r.slice(r.l,f),r.l=f,l}function vC(r){var u=Ef(r);switch(u.Minor){case 2:return[u.Minor,bC(r)];case 3:return[u.Minor,wC()];case 4:return[u.Minor,TC(r)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+u.Minor)}function bC(r){var u=r.read_shift(4);if((u&63)!=36)throw new Error("EncryptionInfo mismatch");var l=r.read_shift(4),f=Z2(r,l),p=W2(r,r.length-r.l);return{t:"Std",h:f,v:p}}function wC(){throw new Error("File is password-protected: ECMA-376 Extensible")}function TC(r){var u=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];r.l+=4;var l=r.read_shift(r.length-r.l,"utf8"),f={};return l.replace(qo,function(b){var _=xn(b);switch(Vh(_[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":u.forEach(function(s){f[s]=_[s]});break;case"<dataIntegrity":f.encryptedHmacKey=_.encryptedHmacKey,f.encryptedHmacValue=_.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":f.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":f.uri=_.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":f.encs.push(_);break;default:throw _[0]}}),f}function SC(r,u){var l={},f=l.EncryptionVersionInfo=Ef(r,4);if(u-=4,f.Minor!=2)throw new Error("unrecognized minor version code: "+f.Minor);if(f.Major>4||f.Major<2)throw new Error("unrecognized major version code: "+f.Major);l.Flags=r.read_shift(4),u-=4;var p=r.read_shift(4);return u-=4,l.EncryptionHeader=Z2(r,p),u-=p,l.EncryptionVerifier=W2(r,u),l}function EC(r){var u={},l=u.EncryptionVersionInfo=Ef(r,4);if(l.Major!=1||l.Minor!=1)throw"unrecognized version code "+l.Major+" : "+l.Minor;return u.Salt=r.read_shift(16),u.EncryptedVerifier=r.read_shift(16),u.EncryptedVerifierHash=r.read_shift(16),u}function AC(r){var u=0,l,f=q2(r),p=f.length+1,b,_,s,C,M;for(l=Td(p),l[0]=f.length,b=1;b!=p;++b)l[b]=f[b-1];for(b=p-1;b>=0;--b)_=l[b],s=(u&16384)===0?0:1,C=u<<1&32767,M=s|C,u=M^_;return u^52811}var $2=(function(){var r=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],u=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],l=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],f=function(_){return(_/2|_*128)&255},p=function(_,s){return f(_^s)},b=function(_){for(var s=u[_.length-1],C=104,M=_.length-1;M>=0;--M)for(var D=_[M],B=0;B!=7;++B)D&64&&(s^=l[C]),D*=2,--C;return s};return function(_){for(var s=q2(_),C=b(s),M=s.length,D=Td(16),B=0;B!=16;++B)D[B]=0;var U,j,H;for((M&1)===1&&(U=C>>8,D[M]=p(r[0],U),--M,U=C&255,j=s[s.length-1],D[M]=p(j,U));M>0;)--M,U=C>>8,D[M]=p(s[M],U),--M,U=C&255,D[M]=p(s[M],U);for(M=15,H=15-s.length;H>0;)U=C>>8,D[M]=p(r[H],U),--M,--H,U=C&255,D[M]=p(s[M],U),--M,--H;return D}})(),kC=function(r,u,l,f,p){p||(p=u),f||(f=$2(r));var b,_;for(b=0;b!=u.length;++b)_=u[b],_^=f[l],_=(_>>5|_<<3)&255,p[b]=_,++l;return[p,l,f]},CC=function(r){var u=0,l=$2(r);return function(f){var p=kC("",f,u,l);return u=p[1],p[0]}};function MC(r,u,l,f){var p={key:vs(r),verificationBytes:vs(r)};return l.password&&(p.verifier=AC(l.password)),f.valid=p.verificationBytes===p.verifier,f.valid&&(f.insitu=CC(l.password)),p}function DC(r,u,l){var f=l||{};return f.Info=r.read_shift(2),r.l-=2,f.Info===1?f.Data=EC(r):f.Data=SC(r,u),f}function RC(r,u,l){var f={Type:l.biff>=8?r.read_shift(2):0};return f.Type?DC(r,u-2,f):MC(r,l.biff>=8?u:u-2,l,f),f}var IC=(function(){function r(p,b){switch(b.type){case"base64":return u(Ac(p),b);case"binary":return u(p,b);case"buffer":return u(ra&&Buffer.isBuffer(p)?p.toString("binary"):Mp(p),b);case"array":return u(Ep(p),b)}throw new Error("Unrecognized type "+b.type)}function u(p,b){var _=b||{},s=_.dense?[]:{},C=p.match(/\\trowd.*?\\row\b/g);if(!C.length)throw new Error("RTF missing table");var M={s:{c:0,r:0},e:{c:0,r:C.length-1}};return C.forEach(function(D,B){Array.isArray(s)&&(s[B]=[]);for(var U=/\\\w+\b/g,j=0,H,O=-1;H=U.exec(D);){switch(H[0]){case"\\cell":var N=D.slice(j,U.lastIndex-H[0].length);if(N[0]==" "&&(N=N.slice(1)),++O,N.length){var Z={v:N,t:"s"};Array.isArray(s)?s[B][O]=Z:s[Dn({r:B,c:O})]=Z}break}j=U.lastIndex}O>M.e.c&&(M.e.c=O)}),s["!ref"]=ca(M),s}function l(p,b){return Ed(r(p,b),b)}function f(p){for(var b=["{\\rtf1\\ansi"],_=Yi(p["!ref"]),s,C=Array.isArray(p),M=_.s.r;M<=_.e.r;++M){b.push("\\trowd\\trautofit1");for(var D=_.s.c;D<=_.e.c;++D)b.push("\\cellx"+(D+1));for(b.push("\\pard\\intbl"),D=_.s.c;D<=_.e.c;++D){var B=Dn({r:M,c:D});s=C?(p[M]||[])[D]:p[B],!(!s||s.v==null&&(!s.f||s.F))&&(b.push(" "+(s.w||(kf(s),s.w))),b.push("\\cell"))}b.push("\\pard\\intbl\\row")}return b.join("")+"}"}return{to_workbook:l,to_sheet:r,from_sheet:f}})();function PC(r){var u=r.slice(r[0]==="#"?1:0).slice(0,6);return[parseInt(u.slice(0,2),16),parseInt(u.slice(2,4),16),parseInt(u.slice(4,6),16)]}function zg(r){for(var u=0,l=1;u!=3;++u)l=l*256+(r[u]>255?255:r[u]<0?0:r[u]);return l.toString(16).toUpperCase().slice(1)}function FC(r){var u=r[0]/255,l=r[1]/255,f=r[2]/255,p=Math.max(u,l,f),b=Math.min(u,l,f),_=p-b;if(_===0)return[0,0,u];var s=0,C=0,M=p+b;switch(C=_/(M>1?2-M:M),p){case u:s=((l-f)/_+6)%6;break;case l:s=(f-u)/_+2;break;case f:s=(u-l)/_+4;break}return[s/6,C,M/2]}function LC(r){var u=r[0],l=r[1],f=r[2],p=l*2*(f<.5?f:1-f),b=f-p/2,_=[b,b,b],s=6*u,C;if(l!==0)switch(s|0){case 0:case 6:C=p*s,_[0]+=p,_[1]+=C;break;case 1:C=p*(2-s),_[0]+=C,_[1]+=p;break;case 2:C=p*(s-2),_[1]+=p,_[2]+=C;break;case 3:C=p*(4-s),_[1]+=C,_[2]+=p;break;case 4:C=p*(s-4),_[2]+=p,_[0]+=C;break;case 5:C=p*(6-s),_[2]+=C,_[0]+=p;break}for(var M=0;M!=3;++M)_[M]=Math.round(_[M]*255);return _}function kx(r,u){if(u===0)return r;var l=FC(PC(r));return u<0?l[2]=l[2]*(1+u):l[2]=1-(1-l[2])*(1-u),zg(LC(l))}var X2=6,zC=15,OC=1,bl=X2;function Cx(r){return Math.floor((r+Math.round(128/bl)/256)*bl)}function Mx(r){return Math.floor((r-5)/bl*100+.5)/100}function By(r){return Math.round((r*bl+5)/bl*256)/256}function xy(r){return By(Mx(Cx(r)))}function y1(r){var u=Math.abs(r-xy(r)),l=bl;if(u>.005)for(bl=OC;bl<zC;++bl)Math.abs(r-xy(r))<=u&&(u=Math.abs(r-xy(r)),l=bl);bl=l}function K0(r){r.width?(r.wpx=Cx(r.width),r.wch=Mx(r.wpx),r.MDW=bl):r.wpx?(r.wch=Mx(r.wpx),r.width=By(r.wch),r.MDW=bl):typeof r.wch=="number"&&(r.width=By(r.wch),r.wpx=Cx(r.width),r.MDW=bl),r.customWidth&&delete r.customWidth}var BC=96,Y2=BC;function K2(r){return r*96/Y2}function Og(r){return r*Y2/96}var NC={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function jC(r,u,l,f){u.Borders=[];var p={},b=!1;(r[0].match(qo)||[]).forEach(function(_){var s=xn(_);switch(Vh(s[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":p={},s.diagonalUp&&(p.diagonalUp=vi(s.diagonalUp)),s.diagonalDown&&(p.diagonalDown=vi(s.diagonalDown)),u.Borders.push(p);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":b=!0;break;case"</ext>":b=!1;break;default:if(f&&f.WTF&&!b)throw new Error("unrecognized "+s[0]+" in borders")}})}function UC(r,u,l,f){u.Fills=[];var p={},b=!1;(r[0].match(qo)||[]).forEach(function(_){var s=xn(_);switch(Vh(s[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":p={},u.Fills.push(p);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":u.Fills.push(p),p={};break;case"<patternFill":case"<patternFill>":s.patternType&&(p.patternType=s.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":p.bgColor||(p.bgColor={}),s.indexed&&(p.bgColor.indexed=parseInt(s.indexed,10)),s.theme&&(p.bgColor.theme=parseInt(s.theme,10)),s.tint&&(p.bgColor.tint=parseFloat(s.tint)),s.rgb&&(p.bgColor.rgb=s.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":p.fgColor||(p.fgColor={}),s.theme&&(p.fgColor.theme=parseInt(s.theme,10)),s.tint&&(p.fgColor.tint=parseFloat(s.tint)),s.rgb!=null&&(p.fgColor.rgb=s.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":b=!0;break;case"</ext>":b=!1;break;default:if(f&&f.WTF&&!b)throw new Error("unrecognized "+s[0]+" in fills")}})}function VC(r,u,l,f){u.Fonts=[];var p={},b=!1;(r[0].match(qo)||[]).forEach(function(_){var s=xn(_);switch(Vh(s[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":u.Fonts.push(p),p={};break;case"<name":s.val&&(p.name=si(s.val));break;case"<name/>":case"</name>":break;case"<b":p.bold=s.val?vi(s.val):1;break;case"<b/>":p.bold=1;break;case"<i":p.italic=s.val?vi(s.val):1;break;case"<i/>":p.italic=1;break;case"<u":switch(s.val){case"none":p.underline=0;break;case"single":p.underline=1;break;case"double":p.underline=2;break;case"singleAccounting":p.underline=33;break;case"doubleAccounting":p.underline=34;break}break;case"<u/>":p.underline=1;break;case"<strike":p.strike=s.val?vi(s.val):1;break;case"<strike/>":p.strike=1;break;case"<outline":p.outline=s.val?vi(s.val):1;break;case"<outline/>":p.outline=1;break;case"<shadow":p.shadow=s.val?vi(s.val):1;break;case"<shadow/>":p.shadow=1;break;case"<condense":p.condense=s.val?vi(s.val):1;break;case"<condense/>":p.condense=1;break;case"<extend":p.extend=s.val?vi(s.val):1;break;case"<extend/>":p.extend=1;break;case"<sz":s.val&&(p.sz=+s.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":s.val&&(p.vertAlign=s.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":s.val&&(p.family=parseInt(s.val,10));break;case"<family/>":case"</family>":break;case"<scheme":s.val&&(p.scheme=s.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(s.val=="1")break;s.codepage=t1[parseInt(s.val,10)];break;case"<color":if(p.color||(p.color={}),s.auto&&(p.color.auto=vi(s.auto)),s.rgb)p.color.rgb=s.rgb.slice(-6);else if(s.indexed){p.color.index=parseInt(s.indexed,10);var C=Tp[p.color.index];p.color.index==81&&(C=Tp[1]),C||(C=Tp[1]),p.color.rgb=C[0].toString(16)+C[1].toString(16)+C[2].toString(16)}else s.theme&&(p.color.theme=parseInt(s.theme,10),s.tint&&(p.color.tint=parseFloat(s.tint)),s.theme&&l.themeElements&&l.themeElements.clrScheme&&(p.color.rgb=kx(l.themeElements.clrScheme[p.color.theme].rgb,p.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":b=!0;break;case"</AlternateContent>":b=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":b=!0;break;case"</ext>":b=!1;break;default:if(f&&f.WTF&&!b)throw new Error("unrecognized "+s[0]+" in fonts")}})}function GC(r,u,l){u.NumberFmt=[];for(var f=Uh(Pn),p=0;p<f.length;++p)u.NumberFmt[f[p]]=Pn[f[p]];var b=r[0].match(qo);if(b)for(p=0;p<b.length;++p){var _=xn(b[p]);switch(Vh(_[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var s=xa(si(_.formatCode)),C=parseInt(_.numFmtId,10);if(u.NumberFmt[C]=s,C>0){if(C>392){for(C=392;C>60&&u.NumberFmt[C]!=null;--C);u.NumberFmt[C]=s}wp(s,C)}}break;case"</numFmt>":break;default:if(l.WTF)throw new Error("unrecognized "+_[0]+" in numFmts")}}}var nx=["numFmtId","fillId","fontId","borderId","xfId"],ax=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function HC(r,u,l){u.CellXf=[];var f,p=!1;(r[0].match(qo)||[]).forEach(function(b){var _=xn(b),s=0;switch(Vh(_[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(f=_,delete f[0],s=0;s<nx.length;++s)f[nx[s]]&&(f[nx[s]]=parseInt(f[nx[s]],10));for(s=0;s<ax.length;++s)f[ax[s]]&&(f[ax[s]]=vi(f[ax[s]]));if(u.NumberFmt&&f.numFmtId>392){for(s=392;s>60;--s)if(u.NumberFmt[f.numFmtId]==u.NumberFmt[s]){f.numFmtId=s;break}}u.CellXf.push(f);break;case"</xf>":break;case"<alignment":case"<alignment/>":var C={};_.vertical&&(C.vertical=_.vertical),_.horizontal&&(C.horizontal=_.horizontal),_.textRotation!=null&&(C.textRotation=_.textRotation),_.indent&&(C.indent=_.indent),_.wrapText&&(C.wrapText=vi(_.wrapText)),f.alignment=C;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":p=!0;break;case"</AlternateContent>":p=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":p=!0;break;case"</ext>":p=!1;break;default:if(l&&l.WTF&&!p)throw new Error("unrecognized "+_[0]+" in cellXfs")}})}var qC=(function(){var u=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,l=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,f=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,p=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,b=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(s,C,M){var D={};if(!s)return D;s=s.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var B;return(B=s.match(u))&&GC(B,D,M),(B=s.match(p))&&VC(B,D,C,M),(B=s.match(f))&&UC(B,D,C,M),(B=s.match(b))&&jC(B,D,C,M),(B=s.match(l))&&HC(B,D,M),D}})();function ZC(r,u){var l=r.read_shift(2),f=Go(r);return[l,f]}function WC(r,u,l){var f={};f.sz=r.read_shift(2)/20;var p=nA(r);p.fItalic&&(f.italic=1),p.fCondense&&(f.condense=1),p.fExtend&&(f.extend=1),p.fShadow&&(f.shadow=1),p.fOutline&&(f.outline=1),p.fStrikeout&&(f.strike=1);var b=r.read_shift(2);switch(b===700&&(f.bold=1),r.read_shift(2)){case 1:f.vertAlign="superscript";break;case 2:f.vertAlign="subscript";break}var _=r.read_shift(1);_!=0&&(f.underline=_);var s=r.read_shift(1);s>0&&(f.family=s);var C=r.read_shift(1);switch(C>0&&(f.charset=C),r.l++,f.color=rA(r),r.read_shift(1)){case 1:f.scheme="major";break;case 2:f.scheme="minor";break}return f.name=Go(r),f}var $C=Ho;function XC(r,u){var l=r.l+u,f=r.read_shift(2),p=r.read_shift(2);return r.l=l,{ixfe:f,numFmtId:p}}var YC=Ho;function KC(r,u,l){var f={};f.NumberFmt=[];for(var p in Pn)f.NumberFmt[p]=Pn[p];f.CellXf=[],f.Fonts=[];var b=[],_=!1;return Mf(r,function(C,M,D){switch(D){case 44:f.NumberFmt[C[0]]=C[1],wp(C[1],C[0]);break;case 43:f.Fonts.push(C),C.color.theme!=null&&u&&u.themeElements&&u.themeElements.clrScheme&&(C.color.rgb=kx(u.themeElements.clrScheme[C.color.theme].rgb,C.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:b[b.length-1]==617&&f.CellXf.push(C);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:_=!0;break;case 36:_=!1;break;case 37:b.push(D),_=!0;break;case 38:b.pop(),_=!1;break;default:if(M.T>0)b.push(D);else if(M.T<0)b.pop();else if(!_||l.WTF&&b[b.length-1]!=37)throw new Error("Unexpected record 0x"+D.toString(16))}}),f}var JC=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function QC(r,u,l){u.themeElements.clrScheme=[];var f={};(r[0].match(qo)||[]).forEach(function(p){var b=xn(p);switch(b[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":f.rgb=b.val;break;case"<a:sysClr":f.rgb=b.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":b[0].charAt(1)==="/"?(u.themeElements.clrScheme[JC.indexOf(b[0])]=f,f={}):f.name=b[0].slice(3,b[0].length-1);break;default:if(l&&l.WTF)throw new Error("Unrecognized "+b[0]+" in clrScheme")}})}function e5(){}function t5(){}var r5=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,n5=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,a5=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function i5(r,u,l){u.themeElements={};var f;[["clrScheme",r5,QC],["fontScheme",n5,e5],["fmtScheme",a5,t5]].forEach(function(p){if(!(f=r.match(p[1])))throw new Error(p[0]+" not found in themeElements");p[2](f,u,l)})}var s5=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function J2(r,u){(!r||r.length===0)&&(r=o5());var l,f={};if(!(l=r.match(s5)))throw new Error("themeElements not found in theme");return i5(l[0],f,u),f.raw=r,f}function o5(r,u){var l=[c2];return l[l.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',l[l.length]="<a:themeElements>",l[l.length]='<a:clrScheme name="Office">',l[l.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',l[l.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',l[l.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',l[l.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',l[l.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',l[l.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',l[l.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',l[l.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',l[l.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',l[l.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',l[l.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',l[l.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',l[l.length]="</a:clrScheme>",l[l.length]='<a:fontScheme name="Office">',l[l.length]="<a:majorFont>",l[l.length]='<a:latin typeface="Cambria"/>',l[l.length]='<a:ea typeface=""/>',l[l.length]='<a:cs typeface=""/>',l[l.length]='<a:font script="Jpan" typeface=" "/>',l[l.length]='<a:font script="Hang" typeface=" "/>',l[l.length]='<a:font script="Hans" typeface=""/>',l[l.length]='<a:font script="Hant" typeface=""/>',l[l.length]='<a:font script="Arab" typeface="Times New Roman"/>',l[l.length]='<a:font script="Hebr" typeface="Times New Roman"/>',l[l.length]='<a:font script="Thai" typeface="Tahoma"/>',l[l.length]='<a:font script="Ethi" typeface="Nyala"/>',l[l.length]='<a:font script="Beng" typeface="Vrinda"/>',l[l.length]='<a:font script="Gujr" typeface="Shruti"/>',l[l.length]='<a:font script="Khmr" typeface="MoolBoran"/>',l[l.length]='<a:font script="Knda" typeface="Tunga"/>',l[l.length]='<a:font script="Guru" typeface="Raavi"/>',l[l.length]='<a:font script="Cans" typeface="Euphemia"/>',l[l.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',l[l.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',l[l.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',l[l.length]='<a:font script="Thaa" typeface="MV Boli"/>',l[l.length]='<a:font script="Deva" typeface="Mangal"/>',l[l.length]='<a:font script="Telu" typeface="Gautami"/>',l[l.length]='<a:font script="Taml" typeface="Latha"/>',l[l.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',l[l.length]='<a:font script="Orya" typeface="Kalinga"/>',l[l.length]='<a:font script="Mlym" typeface="Kartika"/>',l[l.length]='<a:font script="Laoo" typeface="DokChampa"/>',l[l.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',l[l.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',l[l.length]='<a:font script="Viet" typeface="Times New Roman"/>',l[l.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',l[l.length]='<a:font script="Geor" typeface="Sylfaen"/>',l[l.length]="</a:majorFont>",l[l.length]="<a:minorFont>",l[l.length]='<a:latin typeface="Calibri"/>',l[l.length]='<a:ea typeface=""/>',l[l.length]='<a:cs typeface=""/>',l[l.length]='<a:font script="Jpan" typeface=" "/>',l[l.length]='<a:font script="Hang" typeface=" "/>',l[l.length]='<a:font script="Hans" typeface=""/>',l[l.length]='<a:font script="Hant" typeface=""/>',l[l.length]='<a:font script="Arab" typeface="Arial"/>',l[l.length]='<a:font script="Hebr" typeface="Arial"/>',l[l.length]='<a:font script="Thai" typeface="Tahoma"/>',l[l.length]='<a:font script="Ethi" typeface="Nyala"/>',l[l.length]='<a:font script="Beng" typeface="Vrinda"/>',l[l.length]='<a:font script="Gujr" typeface="Shruti"/>',l[l.length]='<a:font script="Khmr" typeface="DaunPenh"/>',l[l.length]='<a:font script="Knda" typeface="Tunga"/>',l[l.length]='<a:font script="Guru" typeface="Raavi"/>',l[l.length]='<a:font script="Cans" typeface="Euphemia"/>',l[l.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',l[l.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',l[l.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',l[l.length]='<a:font script="Thaa" typeface="MV Boli"/>',l[l.length]='<a:font script="Deva" typeface="Mangal"/>',l[l.length]='<a:font script="Telu" typeface="Gautami"/>',l[l.length]='<a:font script="Taml" typeface="Latha"/>',l[l.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',l[l.length]='<a:font script="Orya" typeface="Kalinga"/>',l[l.length]='<a:font script="Mlym" typeface="Kartika"/>',l[l.length]='<a:font script="Laoo" typeface="DokChampa"/>',l[l.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',l[l.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',l[l.length]='<a:font script="Viet" typeface="Arial"/>',l[l.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',l[l.length]='<a:font script="Geor" typeface="Sylfaen"/>',l[l.length]="</a:minorFont>",l[l.length]="</a:fontScheme>",l[l.length]='<a:fmtScheme name="Office">',l[l.length]="<a:fillStyleLst>",l[l.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',l[l.length]='<a:gradFill rotWithShape="1">',l[l.length]="<a:gsLst>",l[l.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',l[l.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',l[l.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',l[l.length]="</a:gsLst>",l[l.length]='<a:lin ang="16200000" scaled="1"/>',l[l.length]="</a:gradFill>",l[l.length]='<a:gradFill rotWithShape="1">',l[l.length]="<a:gsLst>",l[l.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',l[l.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',l[l.length]="</a:gsLst>",l[l.length]='<a:lin ang="16200000" scaled="0"/>',l[l.length]="</a:gradFill>",l[l.length]="</a:fillStyleLst>",l[l.length]="<a:lnStyleLst>",l[l.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',l[l.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',l[l.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',l[l.length]="</a:lnStyleLst>",l[l.length]="<a:effectStyleLst>",l[l.length]="<a:effectStyle>",l[l.length]="<a:effectLst>",l[l.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',l[l.length]="</a:effectLst>",l[l.length]="</a:effectStyle>",l[l.length]="<a:effectStyle>",l[l.length]="<a:effectLst>",l[l.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',l[l.length]="</a:effectLst>",l[l.length]="</a:effectStyle>",l[l.length]="<a:effectStyle>",l[l.length]="<a:effectLst>",l[l.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',l[l.length]="</a:effectLst>",l[l.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',l[l.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',l[l.length]="</a:effectStyle>",l[l.length]="</a:effectStyleLst>",l[l.length]="<a:bgFillStyleLst>",l[l.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',l[l.length]='<a:gradFill rotWithShape="1">',l[l.length]="<a:gsLst>",l[l.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',l[l.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',l[l.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',l[l.length]="</a:gsLst>",l[l.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',l[l.length]="</a:gradFill>",l[l.length]='<a:gradFill rotWithShape="1">',l[l.length]="<a:gsLst>",l[l.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',l[l.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',l[l.length]="</a:gsLst>",l[l.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',l[l.length]="</a:gradFill>",l[l.length]="</a:bgFillStyleLst>",l[l.length]="</a:fmtScheme>",l[l.length]="</a:themeElements>",l[l.length]="<a:objectDefaults>",l[l.length]="<a:spDef>",l[l.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',l[l.length]="</a:spDef>",l[l.length]="<a:lnDef>",l[l.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',l[l.length]="</a:lnDef>",l[l.length]="</a:objectDefaults>",l[l.length]="<a:extraClrSchemeLst/>",l[l.length]="</a:theme>",l.join("")}function l5(r,u,l){var f=r.l+u,p=r.read_shift(4);if(p!==124226){if(!l.cellStyles){r.l=f;return}var b=r.slice(r.l);r.l=f;var _;try{_=l2(b,{type:"array"})}catch{return}var s=Ec(_,"theme/theme/theme1.xml",!0);if(s)return J2(s,l)}}function c5(r){return r.read_shift(4)}function u5(r){var u={};switch(u.xclrType=r.read_shift(2),u.nTintShade=r.read_shift(2),u.xclrType){case 0:r.l+=4;break;case 1:u.xclrValue=h5(r,4);break;case 2:u.xclrValue=B2(r);break;case 3:u.xclrValue=c5(r);break;case 4:r.l+=4;break}return r.l+=8,u}function h5(r,u){return Ho(r,u)}function f5(r,u){return Ho(r,u)}function d5(r){var u=r.read_shift(2),l=r.read_shift(2)-4,f=[u];switch(u){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:f[1]=u5(r);break;case 6:f[1]=f5(r,l);break;case 14:case 15:f[1]=r.read_shift(l===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+u+" "+l)}return f}function p5(r,u){var l=r.l+u;r.l+=2;var f=r.read_shift(2);r.l+=2;for(var p=r.read_shift(2),b=[];p-- >0;)b.push(d5(r,l-r.l));return{ixfe:f,ext:b}}function m5(r,u){u.forEach(function(l){l[0]})}function g5(r,u){return{flags:r.read_shift(4),version:r.read_shift(4),name:Go(r)}}function _5(r){for(var u=[],l=r.read_shift(4);l-- >0;)u.push([r.read_shift(4),r.read_shift(4)]);return u}function x5(r){return r.l+=4,r.read_shift(4)!=0}function y5(r,u,l){var f={Types:[],Cell:[],Value:[]},p=l||{},b=[],_=!1,s=2;return Mf(r,function(C,M,D){switch(D){case 335:f.Types.push({name:C.name});break;case 51:C.forEach(function(B){s==1?f.Cell.push({type:f.Types[B[0]-1].name,index:B[1]}):s==0&&f.Value.push({type:f.Types[B[0]-1].name,index:B[1]})});break;case 337:s=C?1:0;break;case 338:s=2;break;case 35:b.push(D),_=!0;break;case 36:b.pop(),_=!1;break;default:if(!M.T){if(!_||p.WTF&&b[b.length-1]!=35)throw new Error("Unexpected record 0x"+D.toString(16))}}}),f}function v5(r,u,l){var f={Types:[],Cell:[],Value:[]};if(!r)return f;var p=!1,b=2,_;return r.replace(qo,function(s){var C=xn(s);switch(Vh(C[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":f.Types.push({name:C.name});break;case"</metadataType>":break;case"<futureMetadata":for(var M=0;M<f.Types.length;++M)f.Types[M].name==C.name&&(_=f.Types[M]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":b==1?f.Cell.push({type:f.Types[C.t-1].name,index:+C.v}):b==0&&f.Value.push({type:f.Types[C.t-1].name,index:+C.v});break;case"</rc>":break;case"<cellMetadata":b=1;break;case"</cellMetadata>":b=2;break;case"<valueMetadata":b=0;break;case"</valueMetadata>":b=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":p=!0;break;case"</ext>":p=!1;break;case"<rvb":if(!_)break;_.offsets||(_.offsets=[]),_.offsets.push(+C.i);break;default:if(!p&&l.WTF)throw new Error("unrecognized "+C[0]+" in metadata")}return s}),f}function b5(r){var u=[];if(!r)return u;var l=1;return(r.match(qo)||[]).forEach(function(f){var p=xn(f);switch(p[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete p[0],p.i?l=p.i:p.i=l,u.push(p);break}}),u}function w5(r){var u={};u.i=r.read_shift(4);var l={};l.r=r.read_shift(4),l.c=r.read_shift(4),u.r=Dn(l);var f=r.read_shift(1);return f&2&&(u.l="1"),f&8&&(u.a="1"),u}function T5(r,u,l){var f=[];return Mf(r,function(b,_,s){switch(s){case 63:f.push(b);break;default:if(!_.T)throw new Error("Unexpected record 0x"+s.toString(16))}}),f}function S5(r,u,l,f){if(!r)return r;var p=f||{},b=!1;Mf(r,function(s,C,M){switch(M){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:b=!0;break;case 36:b=!1;break;default:if(!C.T){if(!b||p.WTF)throw new Error("Unexpected record 0x"+M.toString(16))}}},p)}function E5(r,u){if(!r)return"??";var l=(r.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return u["!id"][l].Target}function qv(r,u,l,f){var p=Array.isArray(r),b;u.forEach(function(_){var s=wl(_.ref);if(p?(r[s.r]||(r[s.r]=[]),b=r[s.r][s.c]):b=r[_.ref],!b){b={t:"z"},p?r[s.r][s.c]=b:r[_.ref]=b;var C=Yi(r["!ref"]||"BDWGO1000001:A1");C.s.r>s.r&&(C.s.r=s.r),C.e.r<s.r&&(C.e.r=s.r),C.s.c>s.c&&(C.s.c=s.c),C.e.c<s.c&&(C.e.c=s.c);var M=ca(C);M!==r["!ref"]&&(r["!ref"]=M)}b.c||(b.c=[]);var D={a:_.author,t:_.t,r:_.r,T:l};_.h&&(D.h=_.h);for(var B=b.c.length-1;B>=0;--B){if(!l&&b.c[B].T)return;l&&!b.c[B].T&&b.c.splice(B,1)}if(l&&f){for(B=0;B<f.length;++B)if(D.a==f[B].id){D.a=f[B].name||D.a;break}}b.c.push(D)})}function A5(r,u){if(r.match(/<(?:\w+:)?comments *\/>/))return[];var l=[],f=[],p=r.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);p&&p[1]&&p[1].split(/<\/\w*:?author>/).forEach(function(_){if(!(_===""||_.trim()==="")){var s=_.match(/<(?:\w+:)?author[^>]*>(.*)/);s&&l.push(s[1])}});var b=r.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return b&&b[1]&&b[1].split(/<\/\w*:?comment>/).forEach(function(_){if(!(_===""||_.trim()==="")){var s=_.match(/<(?:\w+:)?comment[^>]*>/);if(s){var C=xn(s[0]),M={author:C.authorId&&l[C.authorId]||"sheetjsghost",ref:C.ref,guid:C.guid},D=wl(C.ref);if(!(u.sheetRows&&u.sheetRows<=D.r)){var B=_.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),U=!!B&&!!B[1]&&x1(B[1])||{r:"",t:"",h:""};M.r=U.r,U.r=="<t></t>"&&(U.t=U.h=""),M.t=(U.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),u.cellHTML&&(M.h=U.h),f.push(M)}}}}),f}function k5(r,u){var l=[],f=!1,p={},b=0;return r.replace(qo,function(s,C){var M=xn(s);switch(Vh(M[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":p={author:M.personId,guid:M.id,ref:M.ref,T:1};break;case"</threadedComment>":p.t!=null&&l.push(p);break;case"<text>":case"<text":b=C+s.length;break;case"</text>":p.t=r.slice(b,C).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":f=!0;break;case"</mentions>":f=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":f=!0;break;case"</ext>":f=!1;break;default:if(!f&&u.WTF)throw new Error("unrecognized "+M[0]+" in threaded comments")}return s}),l}function C5(r,u){var l=[],f=!1;return r.replace(qo,function(b){var _=xn(b);switch(Vh(_[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":l.push({name:_.displayname,id:_.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":f=!0;break;case"</ext>":f=!1;break;default:if(!f&&u.WTF)throw new Error("unrecognized "+_[0]+" in threaded comments")}return b}),l}function M5(r){var u={};u.iauthor=r.read_shift(4);var l=Rp(r);return u.rfx=l.s,u.ref=Dn(l.s),r.l+=16,u}var D5=Go;function R5(r,u){var l=[],f=[],p={},b=!1;return Mf(r,function(s,C,M){switch(M){case 632:f.push(s);break;case 635:p=s;break;case 637:p.t=s.t,p.h=s.h,p.r=s.r;break;case 636:if(p.author=f[p.iauthor],delete p.iauthor,u.sheetRows&&p.rfx&&u.sheetRows<=p.rfx.r)break;p.t||(p.t=""),delete p.rfx,l.push(p);break;case 3072:break;case 35:b=!0;break;case 36:b=!1;break;case 37:break;case 38:break;default:if(!C.T){if(!b||u.WTF)throw new Error("Unexpected record 0x"+M.toString(16))}}}),l}var I5="application/vnd.ms-office.vbaProject";function P5(r){var u=la.utils.cfb_new({root:"R"});return r.FullPaths.forEach(function(l,f){if(!(l.slice(-1)==="/"||!l.match(/_VBA_PROJECT_CUR/))){var p=l.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");la.utils.cfb_add(u,p,r.FileIndex[f].content)}}),la.write(u)}function F5(){return{"!type":"dialog"}}function L5(){return{"!type":"dialog"}}function z5(){return{"!type":"macro"}}function O5(){return{"!type":"macro"}}var W0=(function(){var r=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,u={r:0,c:0};function l(f,p,b,_){var s=!1,C=!1;b.length==0?C=!0:b.charAt(0)=="["&&(C=!0,b=b.slice(1,-1)),_.length==0?s=!0:_.charAt(0)=="["&&(s=!0,_=_.slice(1,-1));var M=b.length>0?parseInt(b,10)|0:0,D=_.length>0?parseInt(_,10)|0:0;return s?D+=u.c:--D,C?M+=u.r:--M,p+(s?"":"$")+Is(D)+(C?"":"$")+po(M)}return function(p,b){return u=b,p.replace(r,l)}})(),Q2=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,B5=(function(){return function(u,l){return u.replace(Q2,function(f,p,b,_,s,C){var M=f1(_)-(b?0:l.c),D=h1(C)-(s?0:l.r),B=D==0?"":s?D+1:"["+D+"]",U=M==0?"":b?M+1:"["+M+"]";return p+"R"+B+"C"+U})}})();function ew(r,u){return r.replace(Q2,function(l,f,p,b,_,s){return f+(p=="$"?p+b:Is(f1(b)+u.c))+(_=="$"?_+s:po(h1(s)+u.r))})}function N5(r,u,l){var f=nm(u),p=f.s,b=wl(l),_={r:b.r-p.r,c:b.c-p.c};return ew(r,_)}function j5(r){return r.length!=1}function Zv(r){return r.replace(/_xlfn\./g,"")}function xs(r){r.l+=1}function Sd(r,u){var l=r.read_shift(2);return[l&16383,l>>14&1,l>>15&1]}function tw(r,u,l){var f=2;if(l){if(l.biff>=2&&l.biff<=5)return rw(r);l.biff==12&&(f=4)}var p=r.read_shift(f),b=r.read_shift(f),_=Sd(r),s=Sd(r);return{s:{r:p,c:_[0],cRel:_[1],rRel:_[2]},e:{r:b,c:s[0],cRel:s[1],rRel:s[2]}}}function rw(r){var u=Sd(r),l=Sd(r),f=r.read_shift(1),p=r.read_shift(1);return{s:{r:u[0],c:f,cRel:u[1],rRel:u[2]},e:{r:l[0],c:p,cRel:l[1],rRel:l[2]}}}function U5(r,u,l){if(l.biff<8)return rw(r);var f=r.read_shift(l.biff==12?4:2),p=r.read_shift(l.biff==12?4:2),b=Sd(r),_=Sd(r);return{s:{r:f,c:b[0],cRel:b[1],rRel:b[2]},e:{r:p,c:_[0],cRel:_[1],rRel:_[2]}}}function nw(r,u,l){if(l&&l.biff>=2&&l.biff<=5)return V5(r);var f=r.read_shift(l&&l.biff==12?4:2),p=Sd(r);return{r:f,c:p[0],cRel:p[1],rRel:p[2]}}function V5(r){var u=Sd(r),l=r.read_shift(1);return{r:u[0],c:l,cRel:u[1],rRel:u[2]}}function G5(r){var u=r.read_shift(2),l=r.read_shift(2);return{r:u,c:l&255,fQuoted:!!(l&16384),cRel:l>>15,rRel:l>>15}}function H5(r,u,l){var f=l&&l.biff?l.biff:8;if(f>=2&&f<=5)return q5(r);var p=r.read_shift(f>=12?4:2),b=r.read_shift(2),_=(b&16384)>>14,s=(b&32768)>>15;if(b&=16383,s==1)for(;p>524287;)p-=1048576;if(_==1)for(;b>8191;)b=b-16384;return{r:p,c:b,cRel:_,rRel:s}}function q5(r){var u=r.read_shift(2),l=r.read_shift(1),f=(u&32768)>>15,p=(u&16384)>>14;return u&=16383,f==1&&u>=8192&&(u=u-16384),p==1&&l>=128&&(l=l-256),{r:u,c:l,cRel:p,rRel:f}}function Z5(r,u,l){var f=(r[r.l++]&96)>>5,p=tw(r,l.biff>=2&&l.biff<=5?6:8,l);return[f,p]}function W5(r,u,l){var f=(r[r.l++]&96)>>5,p=r.read_shift(2,"i"),b=8;if(l)switch(l.biff){case 5:r.l+=12,b=6;break;case 12:b=12;break}var _=tw(r,b,l);return[f,p,_]}function $5(r,u,l){var f=(r[r.l++]&96)>>5;return r.l+=l&&l.biff>8?12:l.biff<8?6:8,[f]}function X5(r,u,l){var f=(r[r.l++]&96)>>5,p=r.read_shift(2),b=8;if(l)switch(l.biff){case 5:r.l+=12,b=6;break;case 12:b=12;break}return r.l+=b,[f,p]}function Y5(r,u,l){var f=(r[r.l++]&96)>>5,p=U5(r,u-1,l);return[f,p]}function K5(r,u,l){var f=(r[r.l++]&96)>>5;return r.l+=l.biff==2?6:l.biff==12?14:7,[f]}function Wv(r){var u=r[r.l+1]&1,l=1;return r.l+=4,[u,l]}function J5(r,u,l){r.l+=2;for(var f=r.read_shift(l&&l.biff==2?1:2),p=[],b=0;b<=f;++b)p.push(r.read_shift(l&&l.biff==2?1:2));return p}function Q5(r,u,l){var f=r[r.l+1]&255?1:0;return r.l+=2,[f,r.read_shift(l&&l.biff==2?1:2)]}function e3(r,u,l){var f=r[r.l+1]&255?1:0;return r.l+=2,[f,r.read_shift(l&&l.biff==2?1:2)]}function t3(r){var u=r[r.l+1]&255?1:0;return r.l+=2,[u,r.read_shift(2)]}function r3(r,u,l){var f=r[r.l+1]&255?1:0;return r.l+=l&&l.biff==2?3:4,[f]}function aw(r){var u=r.read_shift(1),l=r.read_shift(1);return[u,l]}function n3(r){return r.read_shift(2),aw(r)}function a3(r){return r.read_shift(2),aw(r)}function i3(r,u,l){var f=(r[r.l]&96)>>5;r.l+=1;var p=nw(r,0,l);return[f,p]}function s3(r,u,l){var f=(r[r.l]&96)>>5;r.l+=1;var p=H5(r,0,l);return[f,p]}function o3(r,u,l){var f=(r[r.l]&96)>>5;r.l+=1;var p=r.read_shift(2);l&&l.biff==5&&(r.l+=12);var b=nw(r,0,l);return[f,p,b]}function l3(r,u,l){var f=(r[r.l]&96)>>5;r.l+=1;var p=r.read_shift(l&&l.biff<=3?1:2);return[cM[p],ow[p],f]}function c3(r,u,l){var f=r[r.l++],p=r.read_shift(1),b=l&&l.biff<=3?[f==88?-1:0,r.read_shift(1)]:u3(r);return[p,(b[0]===0?ow:lM)[b[1]]]}function u3(r){return[r[r.l+1]>>7,r.read_shift(2)&32767]}function h3(r,u,l){r.l+=l&&l.biff==2?3:4}function f3(r,u,l){if(r.l++,l&&l.biff==12)return[r.read_shift(4,"i"),0];var f=r.read_shift(2),p=r.read_shift(l&&l.biff==2?1:2);return[f,p]}function d3(r){return r.l++,Ip[r.read_shift(1)]}function p3(r){return r.l++,r.read_shift(2)}function m3(r){return r.l++,r.read_shift(1)!==0}function g3(r){return r.l++,Uo(r)}function _3(r,u,l){return r.l++,Hg(r,u-1,l)}function x3(r,u){var l=[r.read_shift(1)];if(u==12)switch(l[0]){case 2:l[0]=4;break;case 4:l[0]=16;break;case 0:l[0]=1;break;case 1:l[0]=2;break}switch(l[0]){case 4:l[1]=ss(r,1)?"TRUE":"FALSE",u!=12&&(r.l+=7);break;case 37:case 16:l[1]=Ip[r[r.l]],r.l+=u==12?4:8;break;case 0:r.l+=8;break;case 1:l[1]=Uo(r);break;case 2:l[1]=Pp(r,0,{biff:u>0&&u<8?2:u});break;default:throw new Error("Bad SerAr: "+l[0])}return l}function y3(r,u,l){for(var f=r.read_shift(l.biff==12?4:2),p=[],b=0;b!=f;++b)p.push((l.biff==12?Rp:Bx)(r));return p}function v3(r,u,l){var f=0,p=0;l.biff==12?(f=r.read_shift(4),p=r.read_shift(4)):(p=1+r.read_shift(1),f=1+r.read_shift(2)),l.biff>=2&&l.biff<8&&(--f,--p==0&&(p=256));for(var b=0,_=[];b!=f&&(_[b]=[]);++b)for(var s=0;s!=p;++s)_[b][s]=x3(r,l.biff);return _}function b3(r,u,l){var f=r.read_shift(1)>>>5&3,p=!l||l.biff>=8?4:2,b=r.read_shift(p);switch(l.biff){case 2:r.l+=5;break;case 3:case 4:r.l+=8;break;case 5:r.l+=12;break}return[f,0,b]}function w3(r,u,l){if(l.biff==5)return T3(r);var f=r.read_shift(1)>>>5&3,p=r.read_shift(2),b=r.read_shift(4);return[f,p,b]}function T3(r){var u=r.read_shift(1)>>>5&3,l=r.read_shift(2,"i");r.l+=8;var f=r.read_shift(2);return r.l+=12,[u,l,f]}function S3(r,u,l){var f=r.read_shift(1)>>>5&3;r.l+=l&&l.biff==2?3:4;var p=r.read_shift(l&&l.biff==2?1:2);return[f,p]}function E3(r,u,l){var f=r.read_shift(1)>>>5&3,p=r.read_shift(l&&l.biff==2?1:2);return[f,p]}function A3(r,u,l){var f=r.read_shift(1)>>>5&3;return r.l+=4,l.biff<8&&r.l--,l.biff==12&&(r.l+=2),[f]}function k3(r,u,l){var f=(r[r.l++]&96)>>5,p=r.read_shift(2),b=4;if(l)switch(l.biff){case 5:b=15;break;case 12:b=6;break}return r.l+=b,[f,p]}var C3=Ho,M3=Ho,D3=Ho;function Zg(r,u,l){return r.l+=2,[G5(r)]}function v1(r){return r.l+=6,[]}var R3=Zg,I3=v1,P3=v1,F3=Zg;function iw(r){return r.l+=2,[vs(r),r.read_shift(2)&1]}var L3=Zg,z3=iw,O3=v1,B3=Zg,N3=Zg,j3=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function U3(r){r.l+=2;var u=r.read_shift(2),l=r.read_shift(2),f=r.read_shift(4),p=r.read_shift(2),b=r.read_shift(2),_=j3[l>>2&31];return{ixti:u,coltype:l&3,rt:_,idx:f,c:p,C:b}}function V3(r){return r.l+=2,[r.read_shift(4)]}function G3(r,u,l){return r.l+=5,r.l+=2,r.l+=l.biff==2?1:4,["PTGSHEET"]}function H3(r,u,l){return r.l+=l.biff==2?4:5,["PTGENDSHEET"]}function q3(r){var u=r.read_shift(1)>>>5&3,l=r.read_shift(2);return[u,l]}function Z3(r){var u=r.read_shift(1)>>>5&3,l=r.read_shift(2);return[u,l]}function W3(r){return r.l+=4,[0,0]}var $v={1:{n:"PtgExp",f:f3},2:{n:"PtgTbl",f:D3},3:{n:"PtgAdd",f:xs},4:{n:"PtgSub",f:xs},5:{n:"PtgMul",f:xs},6:{n:"PtgDiv",f:xs},7:{n:"PtgPower",f:xs},8:{n:"PtgConcat",f:xs},9:{n:"PtgLt",f:xs},10:{n:"PtgLe",f:xs},11:{n:"PtgEq",f:xs},12:{n:"PtgGe",f:xs},13:{n:"PtgGt",f:xs},14:{n:"PtgNe",f:xs},15:{n:"PtgIsect",f:xs},16:{n:"PtgUnion",f:xs},17:{n:"PtgRange",f:xs},18:{n:"PtgUplus",f:xs},19:{n:"PtgUminus",f:xs},20:{n:"PtgPercent",f:xs},21:{n:"PtgParen",f:xs},22:{n:"PtgMissArg",f:xs},23:{n:"PtgStr",f:_3},26:{n:"PtgSheet",f:G3},27:{n:"PtgEndSheet",f:H3},28:{n:"PtgErr",f:d3},29:{n:"PtgBool",f:m3},30:{n:"PtgInt",f:p3},31:{n:"PtgNum",f:g3},32:{n:"PtgArray",f:K5},33:{n:"PtgFunc",f:l3},34:{n:"PtgFuncVar",f:c3},35:{n:"PtgName",f:b3},36:{n:"PtgRef",f:i3},37:{n:"PtgArea",f:Z5},38:{n:"PtgMemArea",f:S3},39:{n:"PtgMemErr",f:C3},40:{n:"PtgMemNoMem",f:M3},41:{n:"PtgMemFunc",f:E3},42:{n:"PtgRefErr",f:A3},43:{n:"PtgAreaErr",f:$5},44:{n:"PtgRefN",f:s3},45:{n:"PtgAreaN",f:Y5},46:{n:"PtgMemAreaN",f:q3},47:{n:"PtgMemNoMemN",f:Z3},57:{n:"PtgNameX",f:w3},58:{n:"PtgRef3d",f:o3},59:{n:"PtgArea3d",f:W5},60:{n:"PtgRefErr3d",f:k3},61:{n:"PtgAreaErr3d",f:X5},255:{}},$3={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},X3={1:{n:"PtgElfLel",f:iw},2:{n:"PtgElfRw",f:B3},3:{n:"PtgElfCol",f:R3},6:{n:"PtgElfRwV",f:N3},7:{n:"PtgElfColV",f:F3},10:{n:"PtgElfRadical",f:L3},11:{n:"PtgElfRadicalS",f:O3},13:{n:"PtgElfColS",f:I3},15:{n:"PtgElfColSV",f:P3},16:{n:"PtgElfRadicalLel",f:z3},25:{n:"PtgList",f:U3},29:{n:"PtgSxName",f:V3},255:{}},Y3={0:{n:"PtgAttrNoop",f:W3},1:{n:"PtgAttrSemi",f:r3},2:{n:"PtgAttrIf",f:e3},4:{n:"PtgAttrChoose",f:J5},8:{n:"PtgAttrGoto",f:Q5},16:{n:"PtgAttrSum",f:h3},32:{n:"PtgAttrBaxcel",f:Wv},33:{n:"PtgAttrBaxcel",f:Wv},64:{n:"PtgAttrSpace",f:n3},65:{n:"PtgAttrSpaceSemi",f:a3},128:{n:"PtgAttrIfError",f:t3},255:{}};function Wg(r,u,l,f){if(f.biff<8)return Ho(r,u);for(var p=r.l+u,b=[],_=0;_!==l.length;++_)switch(l[_][0]){case"PtgArray":l[_][1]=v3(r,0,f),b.push(l[_][1]);break;case"PtgMemArea":l[_][2]=y3(r,l[_][1],f),b.push(l[_][2]);break;case"PtgExp":f&&f.biff==12&&(l[_][1][1]=r.read_shift(4),b.push(l[_][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+l[_][0]}return u=p-r.l,u!==0&&b.push(Ho(r,u)),b}function $g(r,u,l){for(var f=r.l+u,p,b,_=[];f!=r.l;)u=f-r.l,b=r[r.l],p=$v[b]||$v[$3[b]],(b===24||b===25)&&(p=(b===24?X3:Y3)[r[r.l+1]]),!p||!p.f?Ho(r,u):_.push([p.n,p.f(r,u,l)]);return _}function K3(r){for(var u=[],l=0;l<r.length;++l){for(var f=r[l],p=[],b=0;b<f.length;++b){var _=f[b];_?_[0]===2?p.push('"'+_[1].replace(/"/g,'""')+'"'):p.push(_[1]):p.push("")}u.push(p.join(","))}return u.join(";")}var J3={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Q3(r,u){if(!r&&!(u&&u.biff<=5&&u.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(r)?"'"+r+"'":r}function sw(r,u,l){if(!r)return"SH33TJSERR0";if(l.biff>8&&(!r.XTI||!r.XTI[u]))return r.SheetNames[u];if(!r.XTI)return"SH33TJSERR6";var f=r.XTI[u];if(l.biff<8)return u>1e4&&(u-=65536),u<0&&(u=-u),u==0?"":r.XTI[u-1];if(!f)return"SH33TJSERR1";var p="";if(l.biff>8)switch(r[f[0]][0]){case 357:return p=f[1]==-1?"#REF":r.SheetNames[f[1]],f[1]==f[2]?p:p+":"+r.SheetNames[f[2]];case 358:return l.SID!=null?r.SheetNames[l.SID]:"SH33TJSSAME"+r[f[0]][0];default:return"SH33TJSSRC"+r[f[0]][0]}switch(r[f[0]][0][0]){case 1025:return p=f[1]==-1?"#REF":r.SheetNames[f[1]]||"SH33TJSERR3",f[1]==f[2]?p:p+":"+r.SheetNames[f[2]];case 14849:return r[f[0]].slice(1).map(function(b){return b.Name}).join(";;");default:return r[f[0]][0][3]?(p=f[1]==-1?"#REF":r[f[0]][0][3][f[1]]||"SH33TJSERR4",f[1]==f[2]?p:p+":"+r[f[0]][0][3][f[2]]):"SH33TJSERR2"}}function Xv(r,u,l){var f=sw(r,u,l);return f=="#REF"?f:Q3(f,l)}function jo(r,u,l,f,p){var b=p&&p.biff||8,_={s:{c:0,r:0}},s=[],C,M,D,B=0,U=0,j,H="";if(!r[0]||!r[0][0])return"";for(var O=-1,N="",Z=0,J=r[0].length;Z<J;++Z){var X=r[0][Z];switch(X[0]){case"PtgUminus":s.push("-"+s.pop());break;case"PtgUplus":s.push("+"+s.pop());break;case"PtgPercent":s.push(s.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(C=s.pop(),M=s.pop(),O>=0){switch(r[0][O][1][0]){case 0:N=Xi(" ",r[0][O][1][1]);break;case 1:N=Xi("\r",r[0][O][1][1]);break;default:if(N="",p.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][O][1][0])}M=M+N,O=-1}s.push(M+J3[X[0]]+C);break;case"PtgIsect":C=s.pop(),M=s.pop(),s.push(M+" "+C);break;case"PtgUnion":C=s.pop(),M=s.pop(),s.push(M+","+C);break;case"PtgRange":C=s.pop(),M=s.pop(),s.push(M+":"+C);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":D=wg(X[1][1],_,p),s.push(Tg(D,b));break;case"PtgRefN":D=l?wg(X[1][1],l,p):X[1][1],s.push(Tg(D,b));break;case"PtgRef3d":B=X[1][1],D=wg(X[1][2],_,p),H=Xv(f,B,p),s.push(H+"!"+Tg(D,b));break;case"PtgFunc":case"PtgFuncVar":var pe=X[1][0],ge=X[1][1];pe||(pe=0),pe&=127;var ve=pe==0?[]:s.slice(-pe);s.length-=pe,ge==="User"&&(ge=ve.shift()),s.push(ge+"("+ve.join(",")+")");break;case"PtgBool":s.push(X[1]?"TRUE":"FALSE");break;case"PtgInt":s.push(X[1]);break;case"PtgNum":s.push(String(X[1]));break;case"PtgStr":s.push('"'+X[1].replace(/"/g,'""')+'"');break;case"PtgErr":s.push(X[1]);break;case"PtgAreaN":j=Mv(X[1][1],l?{s:l}:_,p),s.push(gy(j,p));break;case"PtgArea":j=Mv(X[1][1],_,p),s.push(gy(j,p));break;case"PtgArea3d":B=X[1][1],j=X[1][2],H=Xv(f,B,p),s.push(H+"!"+gy(j,p));break;case"PtgAttrSum":s.push("SUM("+s.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":U=X[1][2];var re=(f.names||[])[U-1]||(f[0]||[])[U],Ce=re?re.Name:"SH33TJSNAME"+String(U);Ce&&Ce.slice(0,6)=="_xlfn."&&!p.xlfn&&(Ce=Ce.slice(6)),s.push(Ce);break;case"PtgNameX":var xe=X[1][1];U=X[1][2];var Ge;if(p.biff<=5)xe<0&&(xe=-xe),f[xe]&&(Ge=f[xe][U]);else{var $e="";if(((f[xe]||[])[0]||[])[0]==14849||(((f[xe]||[])[0]||[])[0]==1025?f[xe][U]&&f[xe][U].itab>0&&($e=f.SheetNames[f[xe][U].itab-1]+"!"):$e=f.SheetNames[U-1]+"!"),f[xe]&&f[xe][U])$e+=f[xe][U].Name;else if(f[0]&&f[0][U])$e+=f[0][U].Name;else{var de=(sw(f,xe,p)||"").split(";;");de[U-1]?$e=de[U-1]:$e+="SH33TJSERRX"}s.push($e);break}Ge||(Ge={Name:"SH33TJSERRY"}),s.push(Ge.Name);break;case"PtgParen":var nt="(",le=")";if(O>=0){switch(N="",r[0][O][1][0]){case 2:nt=Xi(" ",r[0][O][1][1])+nt;break;case 3:nt=Xi("\r",r[0][O][1][1])+nt;break;case 4:le=Xi(" ",r[0][O][1][1])+le;break;case 5:le=Xi("\r",r[0][O][1][1])+le;break;default:if(p.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][O][1][0])}O=-1}s.push(nt+s.pop()+le);break;case"PtgRefErr":s.push("#REF!");break;case"PtgRefErr3d":s.push("#REF!");break;case"PtgExp":D={c:X[1][1],r:X[1][0]};var ct={c:l.c,r:l.r};if(f.sharedf[Dn(D)]){var et=f.sharedf[Dn(D)];s.push(jo(et,_,ct,f,p))}else{var He=!1;for(C=0;C!=f.arrayf.length;++C)if(M=f.arrayf[C],!(D.c<M[0].s.c||D.c>M[0].e.c)&&!(D.r<M[0].s.r||D.r>M[0].e.r)){s.push(jo(M[1],_,ct,f,p)),He=!0;break}He||s.push(X[1])}break;case"PtgArray":s.push("{"+K3(X[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":O=Z;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":s.push("");break;case"PtgAreaErr":s.push("#REF!");break;case"PtgAreaErr3d":s.push("#REF!");break;case"PtgList":s.push("Table"+X[1].idx+"[#"+X[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(X));default:throw new Error("Unrecognized Formula Token: "+String(X))}var $t=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(p.biff!=3&&O>=0&&$t.indexOf(r[0][Z][0])==-1){X=r[0][O];var Oe=!0;switch(X[1][0]){case 4:Oe=!1;case 0:N=Xi(" ",X[1][1]);break;case 5:Oe=!1;case 1:N=Xi("\r",X[1][1]);break;default:if(N="",p.WTF)throw new Error("Unexpected PtgAttrSpaceType "+X[1][0])}s.push((Oe?N:"")+s.pop()+(Oe?"":N)),O=-1}}if(s.length>1&&p.WTF)throw new Error("bad formula stack");return s[0]}function eM(r,u,l){var f=r.l+u,p=l.biff==2?1:2,b,_=r.read_shift(p);if(_==65535)return[[],Ho(r,u-2)];var s=$g(r,_,l);return u!==_+p&&(b=Wg(r,u-_-p,s,l)),r.l=f,[s,b]}function tM(r,u,l){var f=r.l+u,p=l.biff==2?1:2,b,_=r.read_shift(p);if(_==65535)return[[],Ho(r,u-2)];var s=$g(r,_,l);return u!==_+p&&(b=Wg(r,u-_-p,s,l)),r.l=f,[s,b]}function rM(r,u,l,f){var p=r.l+u,b=$g(r,f,l),_;return p!==r.l&&(_=Wg(r,p-r.l,b,l)),[b,_]}function nM(r,u,l){var f=r.l+u,p,b=r.read_shift(2),_=$g(r,b,l);return b==65535?[[],Ho(r,u-2)]:(u!==b+2&&(p=Wg(r,f-b-2,_,l)),[_,p])}function aM(r){var u;if(wf(r,r.l+6)!==65535)return[Uo(r),"n"];switch(r[r.l]){case 0:return r.l+=8,["String","s"];case 1:return u=r[r.l+2]===1,r.l+=8,[u,"b"];case 2:return u=r[r.l+2],r.l+=8,[u,"e"];case 3:return r.l+=8,["","s"]}return[]}function yy(r,u,l){var f=r.l+u,p=Gh(r);l.biff==2&&++r.l;var b=aM(r),_=r.read_shift(1);l.biff!=2&&(r.read_shift(1),l.biff>=5&&r.read_shift(4));var s=tM(r,f-r.l,l);return{cell:p,val:b[0],formula:s,shared:_>>3&1,tt:b[1]}}function Nx(r,u,l){var f=r.read_shift(4),p=$g(r,f,l),b=r.read_shift(4),_=b>0?Wg(r,b,p,l):null;return[p,_]}var iM=Nx,jx=Nx,sM=Nx,oM=Nx,lM={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ow={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},cM={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Yv(r){return r.slice(0,3)=="of:"&&(r=r.slice(3)),r.charCodeAt(0)==61&&(r=r.slice(1),r.charCodeAt(0)==61&&(r=r.slice(1))),r=r.replace(/COM\.MICROSOFT\./g,""),r=r.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(u,l){return l.replace(/\./g,"")}),r=r.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),r.replace(/[;~]/g,",").replace(/\|/g,";")}function vy(r){var u=r.split(":"),l=u[0].split(".")[0];return[l,u[0].split(".")[1]+(u.length>1?":"+(u[1].split(".")[1]||u[1].split(".")[0]):"")]}var kg={},$0={};function Cg(r,u){if(r){var l=[.7,.7,.75,.75,.3,.3];u=="xlml"&&(l=[1,1,1,1,.5,.5]),r.left==null&&(r.left=l[0]),r.right==null&&(r.right=l[1]),r.top==null&&(r.top=l[2]),r.bottom==null&&(r.bottom=l[3]),r.header==null&&(r.header=l[4]),r.footer==null&&(r.footer=l[5])}}function lw(r,u,l,f,p,b){try{f.cellNF&&(r.z=Pn[u])}catch(s){if(f.WTF)throw s}if(!(r.t==="z"&&!f.cellStyles)){if(r.t==="d"&&typeof r.v=="string"&&(r.v=Ks(r.v)),(!f||f.cellText!==!1)&&r.t!=="z")try{if(Pn[u]==null&&wp(uE[u]||"General",u),r.t==="e")r.w=r.w||Ip[r.v];else if(u===0)if(r.t==="n")(r.v|0)===r.v?r.w=r.v.toString(10):r.w=Ig(r.v);else if(r.t==="d"){var _=Sl(r.v);(_|0)===_?r.w=_.toString(10):r.w=Ig(_)}else{if(r.v===void 0)return"";r.w=Sp(r.v,$0)}else r.t==="d"?r.w=iu(u,Sl(r.v),$0):r.w=iu(u,r.v,$0)}catch(s){if(f.WTF)throw s}if(f.cellStyles&&l!=null)try{r.s=b.Fills[l],r.s.fgColor&&r.s.fgColor.theme&&!r.s.fgColor.rgb&&(r.s.fgColor.rgb=kx(p.themeElements.clrScheme[r.s.fgColor.theme].rgb,r.s.fgColor.tint||0),f.WTF&&(r.s.fgColor.raw_rgb=p.themeElements.clrScheme[r.s.fgColor.theme].rgb)),r.s.bgColor&&r.s.bgColor.theme&&(r.s.bgColor.rgb=kx(p.themeElements.clrScheme[r.s.bgColor.theme].rgb,r.s.bgColor.tint||0),f.WTF&&(r.s.bgColor.raw_rgb=p.themeElements.clrScheme[r.s.bgColor.theme].rgb))}catch(s){if(f.WTF&&b.Fills)throw s}}}function uM(r,u){var l=Yi(u);l.s.r<=l.e.r&&l.s.c<=l.e.c&&l.s.r>=0&&l.s.c>=0&&(r["!ref"]=ca(l))}var hM=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,fM=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,dM=/<(?:\w:)?hyperlink [^>]*>/mg,pM=/"(\w*:\w*)"/,mM=/<(?:\w:)?col\b[^>]*[\/]?>/g,gM=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,_M=/<(?:\w:)?pageMargins[^>]*\/>/g,cw=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,xM=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,yM=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function vM(r,u,l,f,p,b,_){if(!r)return r;f||(f={"!id":{}});var s=u.dense?[]:{},C={s:{r:2e6,c:2e6},e:{r:0,c:0}},M="",D="",B=r.match(fM);B?(M=r.slice(0,B.index),D=r.slice(B.index+B[0].length)):M=D=r;var U=M.match(cw);U?b1(U[0],s,p,l):(U=M.match(xM))&&bM(U[0],U[1]||"",s,p,l);var j=(M.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(j>0){var H=M.slice(j,j+50).match(pM);H&&uM(s,H[1])}var O=M.match(yM);O&&O[1]&&kM(O[1],p);var N=[];if(u.cellStyles){var Z=M.match(mM);Z&&SM(N,Z)}B&&CM(B[1],s,u,C,b,_);var J=D.match(gM);J&&(s["!autofilter"]=EM(J[0]));var X=[],pe=D.match(hM);if(pe)for(j=0;j!=pe.length;++j)X[j]=Yi(pe[j].slice(pe[j].indexOf('"')+1));var ge=D.match(dM);ge&&wM(s,ge,f);var ve=D.match(_M);if(ve&&(s["!margins"]=TM(xn(ve[0]))),!s["!ref"]&&C.e.c>=C.s.c&&C.e.r>=C.s.r&&(s["!ref"]=ca(C)),u.sheetRows>0&&s["!ref"]){var re=Yi(s["!ref"]);u.sheetRows<=+re.e.r&&(re.e.r=u.sheetRows-1,re.e.r>C.e.r&&(re.e.r=C.e.r),re.e.r<re.s.r&&(re.s.r=re.e.r),re.e.c>C.e.c&&(re.e.c=C.e.c),re.e.c<re.s.c&&(re.s.c=re.e.c),s["!fullref"]=s["!ref"],s["!ref"]=ca(re))}return N.length>0&&(s["!cols"]=N),X.length>0&&(s["!merges"]=X),s}function b1(r,u,l,f){var p=xn(r);l.Sheets[f]||(l.Sheets[f]={}),p.codeName&&(l.Sheets[f].CodeName=xa(si(p.codeName)))}function bM(r,u,l,f,p){b1(r.slice(0,r.indexOf(">")),l,f,p)}function wM(r,u,l){for(var f=Array.isArray(r),p=0;p!=u.length;++p){var b=xn(si(u[p]),!0);if(!b.ref)return;var _=((l||{})["!id"]||[])[b.id];_?(b.Target=_.Target,b.location&&(b.Target+="#"+xa(b.location))):(b.Target="#"+xa(b.location),_={Target:b.Target,TargetMode:"Internal"}),b.Rel=_,b.tooltip&&(b.Tooltip=b.tooltip,delete b.tooltip);for(var s=Yi(b.ref),C=s.s.r;C<=s.e.r;++C)for(var M=s.s.c;M<=s.e.c;++M){var D=Dn({c:M,r:C});f?(r[C]||(r[C]=[]),r[C][M]||(r[C][M]={t:"z",v:void 0}),r[C][M].l=b):(r[D]||(r[D]={t:"z",v:void 0}),r[D].l=b)}}}function TM(r){var u={};return["left","right","top","bottom","header","footer"].forEach(function(l){r[l]&&(u[l]=parseFloat(r[l]))}),u}function SM(r,u){for(var l=!1,f=0;f!=u.length;++f){var p=xn(u[f],!0);p.hidden&&(p.hidden=vi(p.hidden));var b=parseInt(p.min,10)-1,_=parseInt(p.max,10)-1;for(p.outlineLevel&&(p.level=+p.outlineLevel||0),delete p.min,delete p.max,p.width=+p.width,!l&&p.width&&(l=!0,y1(p.width)),K0(p);b<=_;)r[b++]=fo(p)}}function EM(r){var u={ref:(r.match(/ref="([^"]*)"/)||[])[1]};return u}var AM=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function kM(r,u){u.Views||(u.Views=[{}]),(r.match(AM)||[]).forEach(function(l,f){var p=xn(l);u.Views[f]||(u.Views[f]={}),+p.zoomScale&&(u.Views[f].zoom=+p.zoomScale),vi(p.rightToLeft)&&(u.Views[f].RTL=!0)})}var CM=(function(){var r=/<(?:\w+:)?c[ \/>]/,u=/<\/(?:\w+:)?row>/,l=/r=["']([^"']*)["']/,f=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,p=/ref=["']([^"']*)["']/,b=Pg("v"),_=Pg("f");return function(C,M,D,B,U,j){for(var H=0,O="",N=[],Z=[],J=0,X=0,pe=0,ge="",ve,re,Ce=0,xe=0,Ge,$e,de=0,nt=0,le=Array.isArray(j.CellXf),ct,et=[],He=[],$t=Array.isArray(M),Oe=[],It={},me=!1,ne=!!D.sheetStubs,Ue=C.split(u),Fe=0,Re=Ue.length;Fe!=Re;++Fe){O=Ue[Fe].trim();var bt=O.length;if(bt!==0){var Gt=0;e:for(H=0;H<bt;++H)switch(O[H]){case">":if(O[H-1]!="/"){++H;break e}if(D&&D.cellStyles){if(re=xn(O.slice(Gt,H),!0),Ce=re.r!=null?parseInt(re.r,10):Ce+1,xe=-1,D.sheetRows&&D.sheetRows<Ce)continue;It={},me=!1,re.ht&&(me=!0,It.hpt=parseFloat(re.ht),It.hpx=Og(It.hpt)),re.hidden=="1"&&(me=!0,It.hidden=!0),re.outlineLevel!=null&&(me=!0,It.level=+re.outlineLevel),me&&(Oe[Ce-1]=It)}break;case"<":Gt=H;break}if(Gt>=H)break;if(re=xn(O.slice(Gt,H),!0),Ce=re.r!=null?parseInt(re.r,10):Ce+1,xe=-1,!(D.sheetRows&&D.sheetRows<Ce)){B.s.r>Ce-1&&(B.s.r=Ce-1),B.e.r<Ce-1&&(B.e.r=Ce-1),D&&D.cellStyles&&(It={},me=!1,re.ht&&(me=!0,It.hpt=parseFloat(re.ht),It.hpx=Og(It.hpt)),re.hidden=="1"&&(me=!0,It.hidden=!0),re.outlineLevel!=null&&(me=!0,It.level=+re.outlineLevel),me&&(Oe[Ce-1]=It)),N=O.slice(H).split(r);for(var Vt=0;Vt!=N.length&&N[Vt].trim().charAt(0)=="<";++Vt);for(N=N.slice(Vt),H=0;H!=N.length;++H)if(O=N[H].trim(),O.length!==0){if(Z=O.match(l),J=H,X=0,pe=0,O="<c "+(O.slice(0,1)=="<"?">":"")+O,Z!=null&&Z.length===2){for(J=0,ge=Z[1],X=0;X!=ge.length&&!((pe=ge.charCodeAt(X)-64)<1||pe>26);++X)J=26*J+pe;--J,xe=J}else++xe;for(X=0;X!=O.length&&O.charCodeAt(X)!==62;++X);if(++X,re=xn(O.slice(0,X),!0),re.r||(re.r=Dn({r:Ce-1,c:xe})),ge=O.slice(X),ve={t:""},(Z=ge.match(b))!=null&&Z[1]!==""&&(ve.v=xa(Z[1])),D.cellFormula){if((Z=ge.match(_))!=null&&Z[1]!==""){if(ve.f=xa(si(Z[1])).replace(/\r\n/g,`
`),D.xlfn||(ve.f=Zv(ve.f)),Z[0].indexOf('t="array"')>-1)ve.F=(ge.match(p)||[])[1],ve.F.indexOf(":")>-1&&et.push([Yi(ve.F),ve.F]);else if(Z[0].indexOf('t="shared"')>-1){$e=xn(Z[0]);var Bt=xa(si(Z[1]));D.xlfn||(Bt=Zv(Bt)),He[parseInt($e.si,10)]=[$e,Bt,re.r]}}else(Z=ge.match(/<f[^>]*\/>/))&&($e=xn(Z[0]),He[$e.si]&&(ve.f=N5(He[$e.si][1],He[$e.si][2],re.r)));var Yt=wl(re.r);for(X=0;X<et.length;++X)Yt.r>=et[X][0].s.r&&Yt.r<=et[X][0].e.r&&Yt.c>=et[X][0].s.c&&Yt.c<=et[X][0].e.c&&(ve.F=et[X][1])}if(re.t==null&&ve.v===void 0)if(ve.f||ve.F)ve.v=0,ve.t="n";else if(ne)ve.t="z";else continue;else ve.t=re.t||"n";switch(B.s.c>xe&&(B.s.c=xe),B.e.c<xe&&(B.e.c=xe),ve.t){case"n":if(ve.v==""||ve.v==null){if(!ne)continue;ve.t="z"}else ve.v=parseFloat(ve.v);break;case"s":if(typeof ve.v>"u"){if(!ne)continue;ve.t="z"}else Ge=kg[parseInt(ve.v,10)],ve.v=Ge.t,ve.r=Ge.r,D.cellHTML&&(ve.h=Ge.h);break;case"str":ve.t="s",ve.v=ve.v!=null?si(ve.v):"",D.cellHTML&&(ve.h=l1(ve.v));break;case"inlineStr":Z=ge.match(f),ve.t="s",Z!=null&&(Ge=x1(Z[1]))?(ve.v=Ge.t,D.cellHTML&&(ve.h=Ge.h)):ve.v="";break;case"b":ve.v=vi(ve.v);break;case"d":D.cellDates?ve.v=Ks(ve.v,1):(ve.v=Sl(Ks(ve.v,1)),ve.t="n");break;case"e":(!D||D.cellText!==!1)&&(ve.w=ve.v),ve.v=D2[ve.v];break}if(de=nt=0,ct=null,le&&re.s!==void 0&&(ct=j.CellXf[re.s],ct!=null&&(ct.numFmtId!=null&&(de=ct.numFmtId),D.cellStyles&&ct.fillId!=null&&(nt=ct.fillId))),lw(ve,de,nt,D,U,j),D.cellDates&&le&&ve.t=="n"&&rm(Pn[de])&&(ve.t="d",ve.v=Ox(ve.v)),re.cm&&D.xlmeta){var Or=(D.xlmeta.Cell||[])[+re.cm-1];Or&&Or.type=="XLDAPR"&&(ve.D=!0)}if($t){var Ye=wl(re.r);M[Ye.r]||(M[Ye.r]=[]),M[Ye.r][Ye.c]=ve}else M[re.r]=ve}}}}Oe.length>0&&(M["!rows"]=Oe)}})();function MM(r,u){var l={},f=r.l+u;l.r=r.read_shift(4),r.l+=4;var p=r.read_shift(2);r.l+=1;var b=r.read_shift(1);return r.l=f,b&7&&(l.level=b&7),b&16&&(l.hidden=!0),b&32&&(l.hpt=p/20),l}var DM=Rp;function RM(){}function IM(r,u){var l={},f=r[r.l];return++r.l,l.above=!(f&64),l.left=!(f&128),r.l+=18,l.name=eA(r),l}function PM(r){var u=ou(r);return[u]}function FM(r){var u=Dp(r);return[u]}function LM(r){var u=ou(r),l=r.read_shift(1);return[u,l,"b"]}function zM(r){var u=Dp(r),l=r.read_shift(1);return[u,l,"b"]}function OM(r){var u=ou(r),l=r.read_shift(1);return[u,l,"e"]}function BM(r){var u=Dp(r),l=r.read_shift(1);return[u,l,"e"]}function NM(r){var u=ou(r),l=r.read_shift(4);return[u,l,"s"]}function jM(r){var u=Dp(r),l=r.read_shift(4);return[u,l,"s"]}function UM(r){var u=ou(r),l=Uo(r);return[u,l,"n"]}function uw(r){var u=Dp(r),l=Uo(r);return[u,l,"n"]}function VM(r){var u=ou(r),l=m1(r);return[u,l,"n"]}function GM(r){var u=Dp(r),l=m1(r);return[u,l,"n"]}function HM(r){var u=ou(r),l=d1(r);return[u,l,"is"]}function qM(r){var u=ou(r),l=Go(r);return[u,l,"str"]}function ZM(r){var u=Dp(r),l=Go(r);return[u,l,"str"]}function WM(r,u,l){var f=r.l+u,p=ou(r);p.r=l["!row"];var b=r.read_shift(1),_=[p,b,"b"];if(l.cellFormula){r.l+=2;var s=jx(r,f-r.l,l);_[3]=jo(s,null,p,l.supbooks,l)}else r.l=f;return _}function $M(r,u,l){var f=r.l+u,p=ou(r);p.r=l["!row"];var b=r.read_shift(1),_=[p,b,"e"];if(l.cellFormula){r.l+=2;var s=jx(r,f-r.l,l);_[3]=jo(s,null,p,l.supbooks,l)}else r.l=f;return _}function XM(r,u,l){var f=r.l+u,p=ou(r);p.r=l["!row"];var b=Uo(r),_=[p,b,"n"];if(l.cellFormula){r.l+=2;var s=jx(r,f-r.l,l);_[3]=jo(s,null,p,l.supbooks,l)}else r.l=f;return _}function YM(r,u,l){var f=r.l+u,p=ou(r);p.r=l["!row"];var b=Go(r),_=[p,b,"str"];if(l.cellFormula){r.l+=2;var s=jx(r,f-r.l,l);_[3]=jo(s,null,p,l.supbooks,l)}else r.l=f;return _}var KM=Rp;function JM(r,u){var l=r.l+u,f=Rp(r),p=p1(r),b=Go(r),_=Go(r),s=Go(r);r.l=l;var C={rfx:f,relId:p,loc:b,display:s};return _&&(C.Tooltip=_),C}function QM(){}function e4(r,u,l){var f=r.l+u,p=k2(r),b=r.read_shift(1),_=[p];if(_[2]=b,l.cellFormula){var s=iM(r,f-r.l,l);_[1]=s}else r.l=f;return _}function t4(r,u,l){var f=r.l+u,p=Rp(r),b=[p];if(l.cellFormula){var _=oM(r,f-r.l,l);b[1]=_,r.l=f}else r.l=f;return b}var r4=["left","right","top","bottom","header","footer"];function n4(r){var u={};return r4.forEach(function(l){u[l]=Uo(r)}),u}function a4(r){var u=r.read_shift(2);return r.l+=28,{RTL:u&32}}function i4(){}function s4(){}function o4(r,u,l,f,p,b,_){if(!r)return r;var s=u||{};f||(f={"!id":{}});var C=s.dense?[]:{},M,D={s:{r:2e6,c:2e6},e:{r:0,c:0}},B=!1,U=!1,j,H,O,N,Z,J,X,pe,ge,ve=[];s.biff=12,s["!row"]=0;var re=0,Ce=!1,xe=[],Ge={},$e=s.supbooks||p.supbooks||[[]];if($e.sharedf=Ge,$e.arrayf=xe,$e.SheetNames=p.SheetNames||p.Sheets.map(function($t){return $t.name}),!s.supbooks&&(s.supbooks=$e,p.Names))for(var de=0;de<p.Names.length;++de)$e[0][de+1]=p.Names[de];var nt=[],le=[],ct=!1;Dx[16]={n:"BrtShortReal",f:uw};var et;if(Mf(r,function(Oe,It,me){if(!U)switch(me){case 148:M=Oe;break;case 0:j=Oe,s.sheetRows&&s.sheetRows<=j.r&&(U=!0),pe=po(N=j.r),s["!row"]=j.r,(Oe.hidden||Oe.hpt||Oe.level!=null)&&(Oe.hpt&&(Oe.hpx=Og(Oe.hpt)),le[Oe.r]=Oe);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(H={t:Oe[2]},Oe[2]){case"n":H.v=Oe[1];break;case"s":X=kg[Oe[1]],H.v=X.t,H.r=X.r;break;case"b":H.v=!!Oe[1];break;case"e":H.v=Oe[1],s.cellText!==!1&&(H.w=Ip[H.v]);break;case"str":H.t="s",H.v=Oe[1];break;case"is":H.t="s",H.v=Oe[1].t;break}if((O=_.CellXf[Oe[0].iStyleRef])&&lw(H,O.numFmtId,null,s,b,_),Z=Oe[0].c==-1?Z+1:Oe[0].c,s.dense?(C[N]||(C[N]=[]),C[N][Z]=H):C[Is(Z)+pe]=H,s.cellFormula){for(Ce=!1,re=0;re<xe.length;++re){var ne=xe[re];j.r>=ne[0].s.r&&j.r<=ne[0].e.r&&Z>=ne[0].s.c&&Z<=ne[0].e.c&&(H.F=ca(ne[0]),Ce=!0)}!Ce&&Oe.length>3&&(H.f=Oe[3])}if(D.s.r>j.r&&(D.s.r=j.r),D.s.c>Z&&(D.s.c=Z),D.e.r<j.r&&(D.e.r=j.r),D.e.c<Z&&(D.e.c=Z),s.cellDates&&O&&H.t=="n"&&rm(Pn[O.numFmtId])){var Ue=bp(H.v);Ue&&(H.t="d",H.v=new Date(Ue.y,Ue.m-1,Ue.d,Ue.H,Ue.M,Ue.S,Ue.u))}et&&(et.type=="XLDAPR"&&(H.D=!0),et=void 0);break;case 1:case 12:if(!s.sheetStubs||B)break;H={t:"z",v:void 0},Z=Oe[0].c==-1?Z+1:Oe[0].c,s.dense?(C[N]||(C[N]=[]),C[N][Z]=H):C[Is(Z)+pe]=H,D.s.r>j.r&&(D.s.r=j.r),D.s.c>Z&&(D.s.c=Z),D.e.r<j.r&&(D.e.r=j.r),D.e.c<Z&&(D.e.c=Z),et&&(et.type=="XLDAPR"&&(H.D=!0),et=void 0);break;case 176:ve.push(Oe);break;case 49:et=((s.xlmeta||{}).Cell||[])[Oe-1];break;case 494:var Fe=f["!id"][Oe.relId];for(Fe?(Oe.Target=Fe.Target,Oe.loc&&(Oe.Target+="#"+Oe.loc),Oe.Rel=Fe):Oe.relId==""&&(Oe.Target="#"+Oe.loc),N=Oe.rfx.s.r;N<=Oe.rfx.e.r;++N)for(Z=Oe.rfx.s.c;Z<=Oe.rfx.e.c;++Z)s.dense?(C[N]||(C[N]=[]),C[N][Z]||(C[N][Z]={t:"z",v:void 0}),C[N][Z].l=Oe):(J=Dn({c:Z,r:N}),C[J]||(C[J]={t:"z",v:void 0}),C[J].l=Oe);break;case 426:if(!s.cellFormula)break;xe.push(Oe),ge=s.dense?C[N][Z]:C[Is(Z)+pe],ge.f=jo(Oe[1],D,{r:j.r,c:Z},$e,s),ge.F=ca(Oe[0]);break;case 427:if(!s.cellFormula)break;Ge[Dn(Oe[0].s)]=Oe[1],ge=s.dense?C[N][Z]:C[Is(Z)+pe],ge.f=jo(Oe[1],D,{r:j.r,c:Z},$e,s);break;case 60:if(!s.cellStyles)break;for(;Oe.e>=Oe.s;)nt[Oe.e--]={width:Oe.w/256,hidden:!!(Oe.flags&1),level:Oe.level},ct||(ct=!0,y1(Oe.w/256)),K0(nt[Oe.e+1]);break;case 161:C["!autofilter"]={ref:ca(Oe)};break;case 476:C["!margins"]=Oe;break;case 147:p.Sheets[l]||(p.Sheets[l]={}),Oe.name&&(p.Sheets[l].CodeName=Oe.name),(Oe.above||Oe.left)&&(C["!outline"]={above:Oe.above,left:Oe.left});break;case 137:p.Views||(p.Views=[{}]),p.Views[0]||(p.Views[0]={}),Oe.RTL&&(p.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:B=!0;break;case 36:B=!1;break;case 37:B=!0;break;case 38:B=!1;break;default:if(!It.T){if(!B||s.WTF)throw new Error("Unexpected record 0x"+me.toString(16))}}},s),delete s.supbooks,delete s["!row"],!C["!ref"]&&(D.s.r<2e6||M&&(M.e.r>0||M.e.c>0||M.s.r>0||M.s.c>0))&&(C["!ref"]=ca(M||D)),s.sheetRows&&C["!ref"]){var He=Yi(C["!ref"]);s.sheetRows<=+He.e.r&&(He.e.r=s.sheetRows-1,He.e.r>D.e.r&&(He.e.r=D.e.r),He.e.r<He.s.r&&(He.s.r=He.e.r),He.e.c>D.e.c&&(He.e.c=D.e.c),He.e.c<He.s.c&&(He.s.c=He.e.c),C["!fullref"]=C["!ref"],C["!ref"]=ca(He))}return ve.length>0&&(C["!merges"]=ve),nt.length>0&&(C["!cols"]=nt),le.length>0&&(C["!rows"]=le),C}function l4(r){var u=[],l=r.match(/^<c:numCache>/),f;(r.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(b){var _=b.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);_&&(u[+_[1]]=l?+_[2]:_[2])});var p=xa((r.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(r.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(b){f=b.replace(/<.*?>/g,"")}),[u,p,f]}function c4(r,u,l,f,p,b){var _=b||{"!type":"chart"};if(!r)return b;var s=0,C=0,M="A",D={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(r.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(B){var U=l4(B);D.s.r=D.s.c=0,D.e.c=s,M=Is(s),U[0].forEach(function(j,H){_[M+po(H)]={t:"n",v:j,z:U[1]},C=H}),D.e.r<C&&(D.e.r=C),++s}),s>0&&(_["!ref"]=ca(D)),_}function u4(r,u,l,f,p){if(!r)return r;f||(f={"!id":{}});var b={"!type":"chart","!drawel":null,"!rel":""},_,s=r.match(cw);return s&&b1(s[0],b,p,l),(_=r.match(/drawing r:id="(.*?)"/))&&(b["!rel"]=_[1]),f["!id"][b["!rel"]]&&(b["!drawel"]=f["!id"][b["!rel"]]),b}function h4(r,u){r.l+=10;var l=Go(r);return{name:l}}function f4(r,u,l,f,p){if(!r)return r;f||(f={"!id":{}});var b={"!type":"chart","!drawel":null,"!rel":""},_=!1;return Mf(r,function(C,M,D){switch(D){case 550:b["!rel"]=C;break;case 651:p.Sheets[l]||(p.Sheets[l]={}),C.name&&(p.Sheets[l].CodeName=C.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:_=!0;break;case 36:_=!1;break;case 37:break;case 38:break;default:if(!(M.T>0)){if(!(M.T<0)){if(!_||u.WTF)throw new Error("Unexpected record 0x"+D.toString(16))}}}},u),f["!id"][b["!rel"]]&&(b["!drawel"]=f["!id"][b["!rel"]]),b}var hw=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],d4=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],p4=[],m4=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Kv(r,u){for(var l=0;l!=r.length;++l)for(var f=r[l],p=0;p!=u.length;++p){var b=u[p];if(f[b[0]]==null)f[b[0]]=b[1];else switch(b[2]){case"bool":typeof f[b[0]]=="string"&&(f[b[0]]=vi(f[b[0]]));break;case"int":typeof f[b[0]]=="string"&&(f[b[0]]=parseInt(f[b[0]],10));break}}}function Jv(r,u){for(var l=0;l!=u.length;++l){var f=u[l];if(r[f[0]]==null)r[f[0]]=f[1];else switch(f[2]){case"bool":typeof r[f[0]]=="string"&&(r[f[0]]=vi(r[f[0]]));break;case"int":typeof r[f[0]]=="string"&&(r[f[0]]=parseInt(r[f[0]],10));break}}}function fw(r){Jv(r.WBProps,hw),Jv(r.CalcPr,m4),Kv(r.WBView,d4),Kv(r.Sheets,p4),$0.date1904=vi(r.WBProps.date1904)}var g4="][*?/\\".split("");function _4(r,u){if(r.length>31)throw new Error("Sheet names cannot exceed 31 chars");var l=!0;return g4.forEach(function(f){if(r.indexOf(f)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),l}var x4=/<\w+:workbook/;function y4(r,u){if(!r)throw new Error("Could not find file");var l={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},f=!1,p="xmlns",b={},_=0;if(r.replace(qo,function(C,M){var D=xn(C);switch(Vh(D[0])){case"<?xml":break;case"<workbook":C.match(x4)&&(p="xmlns"+C.match(/<(\w+):/)[1]),l.xmlns=D[p];break;case"</workbook>":break;case"<fileVersion":delete D[0],l.AppVersion=D;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":hw.forEach(function(B){if(D[B[0]]!=null)switch(B[2]){case"bool":l.WBProps[B[0]]=vi(D[B[0]]);break;case"int":l.WBProps[B[0]]=parseInt(D[B[0]],10);break;default:l.WBProps[B[0]]=D[B[0]]}}),D.codeName&&(l.WBProps.CodeName=si(D.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete D[0],l.WBView.push(D);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(D.state){case"hidden":D.Hidden=1;break;case"veryHidden":D.Hidden=2;break;default:D.Hidden=0}delete D.state,D.name=xa(si(D.name)),delete D[0],l.Sheets.push(D);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":f=!0;break;case"</definedNames>":f=!1;break;case"<definedName":b={},b.Name=si(D.name),D.comment&&(b.Comment=D.comment),D.localSheetId&&(b.Sheet=+D.localSheetId),vi(D.hidden||"0")&&(b.Hidden=!0),_=M+C.length;break;case"</definedName>":b.Ref=xa(si(r.slice(_,M))),l.Names.push(b);break;case"<definedName/>":break;case"<calcPr":delete D[0],l.CalcPr=D;break;case"<calcPr/>":delete D[0],l.CalcPr=D;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":f=!0;break;case"</ext>":f=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":f=!0;break;case"</AlternateContent>":f=!1;break;case"<revisionPtr":break;default:if(!f&&u.WTF)throw new Error("unrecognized "+D[0]+" in workbook")}return C}),OE.indexOf(l.xmlns)===-1)throw new Error("Unknown Namespace: "+l.xmlns);return fw(l),l}function v4(r,u){var l={};return l.Hidden=r.read_shift(4),l.iTabID=r.read_shift(4),l.strRelID=Ly(r),l.name=Go(r),l}function b4(r,u){var l={},f=r.read_shift(4);l.defaultThemeVersion=r.read_shift(4);var p=u>8?Go(r):"";return p.length>0&&(l.CodeName=p),l.autoCompressPictures=!!(f&65536),l.backupFile=!!(f&64),l.checkCompatibility=!!(f&4096),l.date1904=!!(f&1),l.filterPrivacy=!!(f&8),l.hidePivotFieldList=!!(f&1024),l.promptedSolutions=!!(f&16),l.publishItems=!!(f&2048),l.refreshAllConnections=!!(f&262144),l.saveExternalLinkValues=!!(f&128),l.showBorderUnselectedTables=!!(f&4),l.showInkAnnotation=!!(f&32),l.showObjects=["all","placeholders","none"][f>>13&3],l.showPivotChartFilter=!!(f&32768),l.updateLinks=["userSet","never","always"][f>>8&3],l}function w4(r,u){var l={};return r.read_shift(4),l.ArchID=r.read_shift(4),r.l+=u-8,l}function T4(r,u,l){var f=r.l+u;r.l+=4,r.l+=1;var p=r.read_shift(4),b=tA(r),_=sM(r,0,l),s=p1(r);r.l=f;var C={Name:b,Ptg:_};return p<268435455&&(C.Sheet=p),s&&(C.Comment=s),C}function S4(r,u){var l={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},f=[],p=!1;u||(u={}),u.biff=12;var b=[],_=[[]];return _.SheetNames=[],_.XTI=[],Dx[16]={n:"BrtFRTArchID$",f:w4},Mf(r,function(C,M,D){switch(D){case 156:_.SheetNames.push(C.name),l.Sheets.push(C);break;case 153:l.WBProps=C;break;case 39:C.Sheet!=null&&(u.SID=C.Sheet),C.Ref=jo(C.Ptg,null,null,_,u),delete u.SID,delete C.Ptg,b.push(C);break;case 1036:break;case 357:case 358:case 355:case 667:_[0].length?_.push([D,C]):_[0]=[D,C],_[_.length-1].XTI=[];break;case 362:_.length===0&&(_[0]=[],_[0].XTI=[]),_[_.length-1].XTI=_[_.length-1].XTI.concat(C),_.XTI=_.XTI.concat(C);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:f.push(D),p=!0;break;case 36:f.pop(),p=!1;break;case 37:f.push(D),p=!0;break;case 38:f.pop(),p=!1;break;case 16:break;default:if(!M.T){if(!p||u.WTF&&f[f.length-1]!=37&&f[f.length-1]!=35)throw new Error("Unexpected record 0x"+D.toString(16))}}},u),fw(l),l.Names=b,l.supbooks=_,l}function E4(r,u,l){return u.slice(-4)===".bin"?S4(r,l):y4(r,l)}function A4(r,u,l,f,p,b,_,s){return u.slice(-4)===".bin"?o4(r,f,l,p,b,_,s):vM(r,f,l,p,b,_,s)}function k4(r,u,l,f,p,b,_,s){return u.slice(-4)===".bin"?f4(r,f,l,p,b):u4(r,f,l,p,b)}function C4(r,u,l,f,p,b,_,s){return u.slice(-4)===".bin"?z5():O5()}function M4(r,u,l,f,p,b,_,s){return u.slice(-4)===".bin"?F5():L5()}function D4(r,u,l,f){return u.slice(-4)===".bin"?KC(r,l,f):qC(r,l,f)}function R4(r,u,l){return J2(r,l)}function I4(r,u,l){return u.slice(-4)===".bin"?dC(r,l):hC(r,l)}function P4(r,u,l){return u.slice(-4)===".bin"?R5(r,l):A5(r,l)}function F4(r,u,l){return u.slice(-4)===".bin"?T5(r):b5(r)}function L4(r,u,l,f){return l.slice(-4)===".bin"?S5(r,u,l,f):void 0}function z4(r,u,l){return u.slice(-4)===".bin"?y5(r,u,l):v5(r,u,l)}var dw=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,pw=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Yu(r,u){var l=r.split(/\s+/),f=[];if(f[0]=l[0],l.length===1)return f;var p=r.match(dw),b,_,s,C;if(p)for(C=0;C!=p.length;++C)b=p[C].match(pw),(_=b[1].indexOf(":"))===-1?f[b[1]]=b[2].slice(1,b[2].length-1):(b[1].slice(0,6)==="xmlns:"?s="xmlns"+b[1].slice(6):s=b[1].slice(_+1),f[s]=b[2].slice(1,b[2].length-1));return f}function O4(r){var u=r.split(/\s+/),l={};if(u.length===1)return l;var f=r.match(dw),p,b,_,s;if(f)for(s=0;s!=f.length;++s)p=f[s].match(pw),(b=p[1].indexOf(":"))===-1?l[p[1]]=p[2].slice(1,p[2].length-1):(p[1].slice(0,6)==="xmlns:"?_="xmlns"+p[1].slice(6):_=p[1].slice(b+1),l[_]=p[2].slice(1,p[2].length-1));return l}var Mg;function B4(r,u){var l=Mg[r]||xa(r);return l==="General"?Sp(u):iu(l,u)}function N4(r,u,l,f){var p=f;switch((l[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":p=vi(f);break;case"i2":case"int":p=parseInt(f,10);break;case"r4":case"float":p=parseFloat(f);break;case"date":case"dateTime.tz":p=Ks(f);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+l[0])}r[xa(u)]=p}function j4(r,u,l){if(r.t!=="z"){if(!l||l.cellText!==!1)try{r.t==="e"?r.w=r.w||Ip[r.v]:u==="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=Ig(r.v):r.w=Sp(r.v):r.w=B4(u||"General",r.v)}catch(b){if(l.WTF)throw b}try{var f=Mg[u]||u||"General";if(l.cellNF&&(r.z=f),l.cellDates&&r.t=="n"&&rm(f)){var p=bp(r.v);p&&(r.t="d",r.v=new Date(p.y,p.m-1,p.d,p.H,p.M,p.S,p.u))}}catch(b){if(l.WTF)throw b}}}function U4(r,u,l){if(l.cellStyles&&u.Interior){var f=u.Interior;f.Pattern&&(f.patternType=NC[f.Pattern]||f.Pattern)}r[u.ID]=u}function V4(r,u,l,f,p,b,_,s,C,M){var D="General",B=f.StyleID,U={};M=M||{};var j=[],H=0;for(B===void 0&&s&&(B=s.StyleID),B===void 0&&_&&(B=_.StyleID);b[B]!==void 0&&(b[B].nf&&(D=b[B].nf),b[B].Interior&&j.push(b[B].Interior),!!b[B].Parent);)B=b[B].Parent;switch(l.Type){case"Boolean":f.t="b",f.v=vi(r);break;case"String":f.t="s",f.r=vv(xa(r)),f.v=r.indexOf("<")>-1?xa(u||r).replace(/<.*?>/g,""):f.r;break;case"DateTime":r.slice(-1)!="Z"&&(r+="Z"),f.v=(Ks(r)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),f.v!==f.v?f.v=xa(r):f.v<60&&(f.v=f.v-1),(!D||D=="General")&&(D="yyyy-mm-dd");case"Number":f.v===void 0&&(f.v=+r),f.t||(f.t="n");break;case"Error":f.t="e",f.v=D2[r],M.cellText!==!1&&(f.w=r);break;default:r==""&&u==""?f.t="z":(f.t="s",f.v=vv(u||r));break}if(j4(f,D,M),M.cellFormula!==!1)if(f.Formula){var O=xa(f.Formula);O.charCodeAt(0)==61&&(O=O.slice(1)),f.f=W0(O,p),delete f.Formula,f.ArrayRange=="RC"?f.F=W0("RC:RC",p):f.ArrayRange&&(f.F=W0(f.ArrayRange,p),C.push([Yi(f.F),f.F]))}else for(H=0;H<C.length;++H)p.r>=C[H][0].s.r&&p.r<=C[H][0].e.r&&p.c>=C[H][0].s.c&&p.c<=C[H][0].e.c&&(f.F=C[H][1]);M.cellStyles&&(j.forEach(function(N){!U.patternType&&N.patternType&&(U.patternType=N.patternType)}),f.s=U),f.StyleID!==void 0&&(f.ixfe=f.StyleID)}function G4(r){r.t=r.v||"",r.t=r.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.v=r.w=r.ixfe=void 0}function by(r,u){var l=u||{};r2();var f=pg(c1(r));(l.type=="binary"||l.type=="array"||l.type=="base64")&&(f=si(f));var p=f.slice(0,1024).toLowerCase(),b=!1;if(p=p.replace(/".*?"/g,""),(p.indexOf(">")&1023)>Math.min(p.indexOf(",")&1023,p.indexOf(";")&1023)){var _=fo(l);return _.type="string",Lg.to_workbook(f,_)}if(p.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ne){p.indexOf("<"+Ne)>=0&&(b=!0)}),b)return J4(f,l);Mg={"General Number":"General","General Date":Pn[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Pn[15],"Short Date":Pn[14],"Long Time":Pn[19],"Medium Time":Pn[18],"Short Time":Pn[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Pn[2],Standard:Pn[4],Percent:Pn[10],Scientific:Pn[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var s,C=[],M,D={},B=[],U=l.dense?[]:{},j="",H={},O={},N=Yu('<Data ss:Type="String">'),Z=0,J=0,X=0,pe={s:{r:2e6,c:2e6},e:{r:0,c:0}},ge={},ve={},re="",Ce=0,xe=[],Ge={},$e={},de=0,nt=[],le=[],ct={},et=[],He,$t=!1,Oe=[],It=[],me={},ne=0,Ue=0,Fe={Sheets:[],WBProps:{date1904:!1}},Re={};Fg.lastIndex=0,f=f.replace(/<!--([\s\S]*?)-->/mg,"");for(var bt="";s=Fg.exec(f);)switch(s[3]=(bt=s[3]).toLowerCase()){case"data":if(bt=="data"){if(s[1]==="/"){if((M=C.pop())[0]!==s[3])throw new Error("Bad state: "+M.join("|"))}else s[0].charAt(s[0].length-2)!=="/"&&C.push([s[3],!0]);break}if(C[C.length-1][1])break;s[1]==="/"?V4(f.slice(Z,s.index),re,N,C[C.length-1][0]=="comment"?ct:H,{c:J,r:X},ge,et[J],O,Oe,l):(re="",N=Yu(s[0]),Z=s.index+s[0].length);break;case"cell":if(s[1]==="/")if(le.length>0&&(H.c=le),(!l.sheetRows||l.sheetRows>X)&&H.v!==void 0&&(l.dense?(U[X]||(U[X]=[]),U[X][J]=H):U[Is(J)+po(X)]=H),H.HRef&&(H.l={Target:xa(H.HRef)},H.HRefScreenTip&&(H.l.Tooltip=H.HRefScreenTip),delete H.HRef,delete H.HRefScreenTip),(H.MergeAcross||H.MergeDown)&&(ne=J+(parseInt(H.MergeAcross,10)|0),Ue=X+(parseInt(H.MergeDown,10)|0),xe.push({s:{c:J,r:X},e:{c:ne,r:Ue}})),!l.sheetStubs)H.MergeAcross?J=ne+1:++J;else if(H.MergeAcross||H.MergeDown){for(var Gt=J;Gt<=ne;++Gt)for(var Vt=X;Vt<=Ue;++Vt)(Gt>J||Vt>X)&&(l.dense?(U[Vt]||(U[Vt]=[]),U[Vt][Gt]={t:"z"}):U[Is(Gt)+po(Vt)]={t:"z"});J=ne+1}else++J;else H=O4(s[0]),H.Index&&(J=+H.Index-1),J<pe.s.c&&(pe.s.c=J),J>pe.e.c&&(pe.e.c=J),s[0].slice(-2)==="/>"&&++J,le=[];break;case"row":s[1]==="/"||s[0].slice(-2)==="/>"?(X<pe.s.r&&(pe.s.r=X),X>pe.e.r&&(pe.e.r=X),s[0].slice(-2)==="/>"&&(O=Yu(s[0]),O.Index&&(X=+O.Index-1)),J=0,++X):(O=Yu(s[0]),O.Index&&(X=+O.Index-1),me={},(O.AutoFitHeight=="0"||O.Height)&&(me.hpx=parseInt(O.Height,10),me.hpt=K2(me.hpx),It[X]=me),O.Hidden=="1"&&(me.hidden=!0,It[X]=me));break;case"worksheet":if(s[1]==="/"){if((M=C.pop())[0]!==s[3])throw new Error("Bad state: "+M.join("|"));B.push(j),pe.s.r<=pe.e.r&&pe.s.c<=pe.e.c&&(U["!ref"]=ca(pe),l.sheetRows&&l.sheetRows<=pe.e.r&&(U["!fullref"]=U["!ref"],pe.e.r=l.sheetRows-1,U["!ref"]=ca(pe))),xe.length&&(U["!merges"]=xe),et.length>0&&(U["!cols"]=et),It.length>0&&(U["!rows"]=It),D[j]=U}else pe={s:{r:2e6,c:2e6},e:{r:0,c:0}},X=J=0,C.push([s[3],!1]),M=Yu(s[0]),j=xa(M.Name),U=l.dense?[]:{},xe=[],Oe=[],It=[],Re={name:j,Hidden:0},Fe.Sheets.push(Re);break;case"table":if(s[1]==="/"){if((M=C.pop())[0]!==s[3])throw new Error("Bad state: "+M.join("|"))}else{if(s[0].slice(-2)=="/>")break;C.push([s[3],!1]),et=[],$t=!1}break;case"style":s[1]==="/"?U4(ge,ve,l):ve=Yu(s[0]);break;case"numberformat":ve.nf=xa(Yu(s[0]).Format||"General"),Mg[ve.nf]&&(ve.nf=Mg[ve.nf]);for(var Bt=0;Bt!=392&&Pn[Bt]!=ve.nf;++Bt);if(Bt==392){for(Bt=57;Bt!=392;++Bt)if(Pn[Bt]==null){wp(ve.nf,Bt);break}}break;case"column":if(C[C.length-1][0]!=="table")break;if(He=Yu(s[0]),He.Hidden&&(He.hidden=!0,delete He.Hidden),He.Width&&(He.wpx=parseInt(He.Width,10)),!$t&&He.wpx>10){$t=!0,bl=X2;for(var Yt=0;Yt<et.length;++Yt)et[Yt]&&K0(et[Yt])}$t&&K0(He),et[He.Index-1||et.length]=He;for(var Or=0;Or<+He.Span;++Or)et[et.length]=fo(He);break;case"namedrange":if(s[1]==="/")break;Fe.Names||(Fe.Names=[]);var Ye=xn(s[0]),pn={Name:Ye.Name,Ref:W0(Ye.RefersTo.slice(1),{r:0,c:0})};Fe.Sheets.length>0&&(pn.Sheet=Fe.Sheets.length-1),Fe.Names.push(pn);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(s[0].slice(-2)==="/>")break;s[1]==="/"?re+=f.slice(Ce,s.index):Ce=s.index+s[0].length;break;case"interior":if(!l.cellStyles)break;ve.Interior=Yu(s[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(s[0].slice(-2)==="/>")break;s[1]==="/"?AA(Ge,bt,f.slice(de,s.index)):de=s.index+s[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(s[1]==="/"){if((M=C.pop())[0]!==s[3])throw new Error("Bad state: "+M.join("|"))}else C.push([s[3],!1]);break;case"comment":if(s[1]==="/"){if((M=C.pop())[0]!==s[3])throw new Error("Bad state: "+M.join("|"));G4(ct),le.push(ct)}else C.push([s[3],!1]),M=Yu(s[0]),ct={a:M.Author};break;case"autofilter":if(s[1]==="/"){if((M=C.pop())[0]!==s[3])throw new Error("Bad state: "+M.join("|"))}else if(s[0].charAt(s[0].length-2)!=="/"){var se=Yu(s[0]);U["!autofilter"]={ref:W0(se.Range).replace(/\$/g,"")},C.push([s[3],!0])}break;case"name":break;case"datavalidation":if(s[1]==="/"){if((M=C.pop())[0]!==s[3])throw new Error("Bad state: "+M.join("|"))}else s[0].charAt(s[0].length-2)!=="/"&&C.push([s[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(s[1]==="/"){if((M=C.pop())[0]!==s[3])throw new Error("Bad state: "+M.join("|"))}else s[0].charAt(s[0].length-2)!=="/"&&C.push([s[3],!0]);break;case"null":break;default:if(C.length==0&&s[3]=="document"||C.length==0&&s[3]=="uof")return ab(f,l);var Mt=!0;switch(C[C.length-1][0]){case"officedocumentsettings":switch(s[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Mt=!1}break;case"componentoptions":switch(s[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Mt=!1}break;case"excelworkbook":switch(s[3]){case"date1904":Fe.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Mt=!1}break;case"workbookoptions":switch(s[3]){case"owcversion":break;case"height":break;case"width":break;default:Mt=!1}break;case"worksheetoptions":switch(s[3]){case"visible":if(s[0].slice(-2)!=="/>")if(s[1]==="/")switch(f.slice(de,s.index)){case"SheetHidden":Re.Hidden=1;break;case"SheetVeryHidden":Re.Hidden=2;break}else de=s.index+s[0].length;break;case"header":U["!margins"]||Cg(U["!margins"]={},"xlml"),isNaN(+xn(s[0]).Margin)||(U["!margins"].header=+xn(s[0]).Margin);break;case"footer":U["!margins"]||Cg(U["!margins"]={},"xlml"),isNaN(+xn(s[0]).Margin)||(U["!margins"].footer=+xn(s[0]).Margin);break;case"pagemargins":var yt=xn(s[0]);U["!margins"]||Cg(U["!margins"]={},"xlml"),isNaN(+yt.Top)||(U["!margins"].top=+yt.Top),isNaN(+yt.Left)||(U["!margins"].left=+yt.Left),isNaN(+yt.Right)||(U["!margins"].right=+yt.Right),isNaN(+yt.Bottom)||(U["!margins"].bottom=+yt.Bottom);break;case"displayrighttoleft":Fe.Views||(Fe.Views=[]),Fe.Views[0]||(Fe.Views[0]={}),Fe.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":U["!outline"]||(U["!outline"]={}),U["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":U["!outline"]||(U["!outline"]={}),U["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Mt=!1}break;case"pivottable":case"pivotcache":switch(s[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Mt=!1}break;case"pagebreaks":switch(s[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Mt=!1}break;case"autofilter":switch(s[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Mt=!1}break;case"querytable":switch(s[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Mt=!1}break;case"datavalidation":switch(s[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Mt=!1}break;case"sorting":case"conditionalformatting":switch(s[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Mt=!1}break;case"mapinfo":case"schema":case"data":switch(s[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Mt=!1}break;case"smarttags":break;default:Mt=!1;break}if(Mt||s[3].match(/!\[CDATA/))break;if(!C[C.length-1][1])throw"Unrecognized tag: "+s[3]+"|"+C.join("|");if(C[C.length-1][0]==="customdocumentproperties"){if(s[0].slice(-2)==="/>")break;s[1]==="/"?N4($e,bt,nt,f.slice(de,s.index)):(nt=s,de=s.index+s[0].length);break}if(l.WTF)throw"Unrecognized tag: "+s[3]+"|"+C.join("|")}var Ee={};return!l.bookSheets&&!l.bookProps&&(Ee.Sheets=D),Ee.SheetNames=B,Ee.Workbook=Fe,Ee.SSF=fo(Pn),Ee.Props=Ge,Ee.Custprops=$e,Ee}function Ny(r,u){switch(S1(u=u||{}),u.type||"base64"){case"base64":return by(Ac(r),u);case"binary":case"buffer":case"file":return by(r,u);case"array":return by(Mp(r),u)}}function H4(r){var u={},l=r.content;if(l.l=28,u.AnsiUserType=l.read_shift(0,"lpstr-ansi"),u.AnsiClipboardFormat=aA(l),l.length-l.l<=4)return u;var f=l.read_shift(4);if(f==0||f>40||(l.l-=4,u.Reserved1=l.read_shift(0,"lpstr-ansi"),l.length-l.l<=4)||(f=l.read_shift(4),f!==1907505652)||(u.UnicodeClipboardFormat=iA(l),f=l.read_shift(4),f==0||f>40))return u;l.l-=4,u.Reserved2=l.read_shift(0,"lpwstr")}var q4=[60,1084,2066,2165,2175];function Z4(r,u,l,f,p){var b=f,_=[],s=l.slice(l.l,l.l+b);if(p&&p.enc&&p.enc.insitu&&s.length>0)switch(r){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:p.enc.insitu(s)}_.push(s),l.l+=b;for(var C=wf(l,l.l),M=jy[C],D=0;M!=null&&q4.indexOf(C)>-1;)b=wf(l,l.l+2),D=l.l+4,C==2066?D+=4:(C==2165||C==2175)&&(D+=12),s=l.slice(D,l.l+4+b),_.push(s),l.l+=4+b,M=jy[C=wf(l,l.l)];var B=gd(_);ho(B,0);var U=0;B.lens=[];for(var j=0;j<_.length;++j)B.lens.push(U),U+=_[j].length;if(B.length<f)throw"XLS Record 0x"+r.toString(16)+" Truncated: "+B.length+" < "+f;return u.f(B,B.length,p)}function Oh(r,u,l){if(r.t!=="z"&&r.XF){var f=0;try{f=r.z||r.XF.numFmtId||0,u.cellNF&&(r.z=Pn[f])}catch(b){if(u.WTF)throw b}if(!u||u.cellText!==!1)try{r.t==="e"?r.w=r.w||Ip[r.v]:f===0||f=="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=Ig(r.v):r.w=Sp(r.v):r.w=iu(f,r.v,{date1904:!!l,dateNF:u&&u.dateNF})}catch(b){if(u.WTF)throw b}if(u.cellDates&&f&&r.t=="n"&&rm(Pn[f]||String(f))){var p=bp(r.v);p&&(r.t="d",r.v=new Date(p.y,p.m-1,p.d,p.H,p.M,p.S,p.u))}}}function ix(r,u,l){return{v:r,ixfe:u,t:l}}function W4(r,u){var l={opts:{}},f={},p=u.dense?[]:{},b={},_={},s=null,C=[],M="",D={},B,U="",j,H,O,N,Z={},J=[],X,pe,ge=[],ve=[],re={Sheets:[],WBProps:{date1904:!1},Views:[{}]},Ce={},xe=function(Ve){return Ve<8?Tp[Ve]:Ve<64&&ve[Ve-8]||Tp[Ve]},Ge=function(Ve,Xe,xt){var ot=Xe.XF.data;if(!(!ot||!ot.patternType||!xt||!xt.cellStyles)){Xe.s={},Xe.s.patternType=ot.patternType;var it;(it=zg(xe(ot.icvFore)))&&(Xe.s.fgColor={rgb:it}),(it=zg(xe(ot.icvBack)))&&(Xe.s.bgColor={rgb:it})}},$e=function(Ve,Xe,xt){if(!(me>1)&&!(xt.sheetRows&&Ve.r>=xt.sheetRows)){if(xt.cellStyles&&Xe.XF&&Xe.XF.data&&Ge(Ve,Xe,xt),delete Xe.ixfe,delete Xe.XF,B=Ve,U=Dn(Ve),(!_||!_.s||!_.e)&&(_={s:{r:0,c:0},e:{r:0,c:0}}),Ve.r<_.s.r&&(_.s.r=Ve.r),Ve.c<_.s.c&&(_.s.c=Ve.c),Ve.r+1>_.e.r&&(_.e.r=Ve.r+1),Ve.c+1>_.e.c&&(_.e.c=Ve.c+1),xt.cellFormula&&Xe.f){for(var ot=0;ot<J.length;++ot)if(!(J[ot][0].s.c>Ve.c||J[ot][0].s.r>Ve.r)&&!(J[ot][0].e.c<Ve.c||J[ot][0].e.r<Ve.r)){Xe.F=ca(J[ot][0]),(J[ot][0].s.c!=Ve.c||J[ot][0].s.r!=Ve.r)&&delete Xe.f,Xe.f&&(Xe.f=""+jo(J[ot][1],_,Ve,Oe,de));break}}xt.dense?(p[Ve.r]||(p[Ve.r]=[]),p[Ve.r][Ve.c]=Xe):p[U]=Xe}},de={enc:!1,sbcch:0,snames:[],sharedf:Z,arrayf:J,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!u&&!!u.cellStyles,WTF:!!u&&!!u.wtf};u.password&&(de.password=u.password);var nt,le=[],ct=[],et=[],He=[],$t=!1,Oe=[];Oe.SheetNames=de.snames,Oe.sharedf=de.sharedf,Oe.arrayf=de.arrayf,Oe.names=[],Oe.XTI=[];var It=0,me=0,ne=0,Ue=[],Fe=[],Re;de.codepage=1200,eh(1200);for(var bt=!1;r.l<r.length-1;){var Gt=r.l,Vt=r.read_shift(2);if(Vt===0&&It===10)break;var Bt=r.l===r.length?0:r.read_shift(2),Yt=jy[Vt];if(Yt&&Yt.f){if(u.bookSheets&&It===133&&Vt!==133)break;if(It=Vt,Yt.r===2||Yt.r==12){var Or=r.read_shift(2);if(Bt-=2,!de.enc&&Or!==Vt&&((Or&255)<<8|Or>>8)!==Vt)throw new Error("rt mismatch: "+Or+"!="+Vt);Yt.r==12&&(r.l+=10,Bt-=10)}var Ye={};if(Vt===10?Ye=Yt.f(r,Bt,de):Ye=Z4(Vt,Yt,r,Bt,de),me==0&&[9,521,1033,2057].indexOf(It)===-1)continue;switch(Vt){case 34:l.opts.Date1904=re.WBProps.date1904=Ye;break;case 134:l.opts.WriteProtect=!0;break;case 47:if(de.enc||(r.l=0),de.enc=Ye,!u.password)throw new Error("File is password-protected");if(Ye.valid==null)throw new Error("Encryption scheme unsupported");if(!Ye.valid)throw new Error("Password is incorrect");break;case 92:de.lastuser=Ye;break;case 66:var pn=Number(Ye);switch(pn){case 21010:pn=1200;break;case 32768:pn=1e4;break;case 32769:pn=1252;break}eh(de.codepage=pn),bt=!0;break;case 317:de.rrtabid=Ye;break;case 25:de.winlocked=Ye;break;case 439:l.opts.RefreshAll=Ye;break;case 12:l.opts.CalcCount=Ye;break;case 16:l.opts.CalcDelta=Ye;break;case 17:l.opts.CalcIter=Ye;break;case 13:l.opts.CalcMode=Ye;break;case 14:l.opts.CalcPrecision=Ye;break;case 95:l.opts.CalcSaveRecalc=Ye;break;case 15:de.CalcRefMode=Ye;break;case 2211:l.opts.FullCalc=Ye;break;case 129:Ye.fDialog&&(p["!type"]="dialog"),Ye.fBelow||((p["!outline"]||(p["!outline"]={})).above=!0),Ye.fRight||((p["!outline"]||(p["!outline"]={})).left=!0);break;case 224:ge.push(Ye);break;case 430:Oe.push([Ye]),Oe[Oe.length-1].XTI=[];break;case 35:case 547:Oe[Oe.length-1].push(Ye);break;case 24:case 536:Re={Name:Ye.Name,Ref:jo(Ye.rgce,_,null,Oe,de)},Ye.itab>0&&(Re.Sheet=Ye.itab-1),Oe.names.push(Re),Oe[0]||(Oe[0]=[],Oe[0].XTI=[]),Oe[Oe.length-1].push(Ye),Ye.Name=="_xlnm._FilterDatabase"&&Ye.itab>0&&Ye.rgce&&Ye.rgce[0]&&Ye.rgce[0][0]&&Ye.rgce[0][0][0]=="PtgArea3d"&&(Fe[Ye.itab-1]={ref:ca(Ye.rgce[0][0][1][2])});break;case 22:de.ExternCount=Ye;break;case 23:Oe.length==0&&(Oe[0]=[],Oe[0].XTI=[]),Oe[Oe.length-1].XTI=Oe[Oe.length-1].XTI.concat(Ye),Oe.XTI=Oe.XTI.concat(Ye);break;case 2196:if(de.biff<8)break;Re!=null&&(Re.Comment=Ye[1]);break;case 18:p["!protect"]=Ye;break;case 19:Ye!==0&&de.WTF&&console.error("Password verifier: "+Ye);break;case 133:b[Ye.pos]=Ye,de.snames.push(Ye.name);break;case 10:{if(--me)break;if(_.e){if(_.e.r>0&&_.e.c>0){if(_.e.r--,_.e.c--,p["!ref"]=ca(_),u.sheetRows&&u.sheetRows<=_.e.r){var se=_.e.r;_.e.r=u.sheetRows-1,p["!fullref"]=p["!ref"],p["!ref"]=ca(_),_.e.r=se}_.e.r++,_.e.c++}le.length>0&&(p["!merges"]=le),ct.length>0&&(p["!objects"]=ct),et.length>0&&(p["!cols"]=et),He.length>0&&(p["!rows"]=He),re.Sheets.push(Ce)}M===""?D=p:f[M]=p,p=u.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(de.biff===8&&(de.biff={9:2,521:3,1033:4}[Vt]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Ye.BIFFVer]||8),de.biffguess=Ye.BIFFVer==0,Ye.BIFFVer==0&&Ye.dt==4096&&(de.biff=5,bt=!0,eh(de.codepage=28591)),de.biff==8&&Ye.BIFFVer==0&&Ye.dt==16&&(de.biff=2),me++)break;if(p=u.dense?[]:{},de.biff<8&&!bt&&(bt=!0,eh(de.codepage=u.codepage||1252)),de.biff<5||Ye.BIFFVer==0&&Ye.dt==4096){M===""&&(M="Sheet1"),_={s:{r:0,c:0},e:{r:0,c:0}};var Mt={pos:r.l-Bt,name:M};b[Mt.pos]=Mt,de.snames.push(M)}else M=(b[Gt]||{name:""}).name;Ye.dt==32&&(p["!type"]="chart"),Ye.dt==64&&(p["!type"]="macro"),le=[],ct=[],de.arrayf=J=[],et=[],He=[],$t=!1,Ce={Hidden:(b[Gt]||{hs:0}).hs,name:M}}break;case 515:case 3:case 2:p["!type"]=="chart"&&(u.dense?(p[Ye.r]||[])[Ye.c]:p[Dn({c:Ye.c,r:Ye.r})])&&++Ye.c,X={ixfe:Ye.ixfe,XF:ge[Ye.ixfe]||{},v:Ye.val,t:"n"},ne>0&&(X.z=Ue[X.ixfe>>8&63]),Oh(X,u,l.opts.Date1904),$e({c:Ye.c,r:Ye.r},X,u);break;case 5:case 517:X={ixfe:Ye.ixfe,XF:ge[Ye.ixfe],v:Ye.val,t:Ye.t},ne>0&&(X.z=Ue[X.ixfe>>8&63]),Oh(X,u,l.opts.Date1904),$e({c:Ye.c,r:Ye.r},X,u);break;case 638:X={ixfe:Ye.ixfe,XF:ge[Ye.ixfe],v:Ye.rknum,t:"n"},ne>0&&(X.z=Ue[X.ixfe>>8&63]),Oh(X,u,l.opts.Date1904),$e({c:Ye.c,r:Ye.r},X,u);break;case 189:for(var yt=Ye.c;yt<=Ye.C;++yt){var Ee=Ye.rkrec[yt-Ye.c][0];X={ixfe:Ee,XF:ge[Ee],v:Ye.rkrec[yt-Ye.c][1],t:"n"},ne>0&&(X.z=Ue[X.ixfe>>8&63]),Oh(X,u,l.opts.Date1904),$e({c:yt,r:Ye.r},X,u)}break;case 6:case 518:case 1030:{if(Ye.val=="String"){s=Ye;break}if(X=ix(Ye.val,Ye.cell.ixfe,Ye.tt),X.XF=ge[X.ixfe],u.cellFormula){var Ne=Ye.formula;if(Ne&&Ne[0]&&Ne[0][0]&&Ne[0][0][0]=="PtgExp"){var pt=Ne[0][0][1][0],Jt=Ne[0][0][1][1],Kt=Dn({r:pt,c:Jt});Z[Kt]?X.f=""+jo(Ye.formula,_,Ye.cell,Oe,de):X.F=((u.dense?(p[pt]||[])[Jt]:p[Kt])||{}).F}else X.f=""+jo(Ye.formula,_,Ye.cell,Oe,de)}ne>0&&(X.z=Ue[X.ixfe>>8&63]),Oh(X,u,l.opts.Date1904),$e(Ye.cell,X,u),s=Ye}break;case 7:case 519:if(s)s.val=Ye,X=ix(Ye,s.cell.ixfe,"s"),X.XF=ge[X.ixfe],u.cellFormula&&(X.f=""+jo(s.formula,_,s.cell,Oe,de)),ne>0&&(X.z=Ue[X.ixfe>>8&63]),Oh(X,u,l.opts.Date1904),$e(s.cell,X,u),s=null;else throw new Error("String record expects Formula");break;case 33:case 545:{J.push(Ye);var Et=Dn(Ye[0].s);if(j=u.dense?(p[Ye[0].s.r]||[])[Ye[0].s.c]:p[Et],u.cellFormula&&j){if(!s||!Et||!j)break;j.f=""+jo(Ye[1],_,Ye[0],Oe,de),j.F=ca(Ye[0])}}break;case 1212:{if(!u.cellFormula)break;if(U){if(!s)break;Z[Dn(s.cell)]=Ye[0],j=u.dense?(p[s.cell.r]||[])[s.cell.c]:p[Dn(s.cell)],(j||{}).f=""+jo(Ye[0],_,B,Oe,de)}}break;case 253:X=ix(C[Ye.isst].t,Ye.ixfe,"s"),C[Ye.isst].h&&(X.h=C[Ye.isst].h),X.XF=ge[X.ixfe],ne>0&&(X.z=Ue[X.ixfe>>8&63]),Oh(X,u,l.opts.Date1904),$e({c:Ye.c,r:Ye.r},X,u);break;case 513:u.sheetStubs&&(X={ixfe:Ye.ixfe,XF:ge[Ye.ixfe],t:"z"},ne>0&&(X.z=Ue[X.ixfe>>8&63]),Oh(X,u,l.opts.Date1904),$e({c:Ye.c,r:Ye.r},X,u));break;case 190:if(u.sheetStubs)for(var lr=Ye.c;lr<=Ye.C;++lr){var pr=Ye.ixfe[lr-Ye.c];X={ixfe:pr,XF:ge[pr],t:"z"},ne>0&&(X.z=Ue[X.ixfe>>8&63]),Oh(X,u,l.opts.Date1904),$e({c:lr,r:Ye.r},X,u)}break;case 214:case 516:case 4:X=ix(Ye.val,Ye.ixfe,"s"),X.XF=ge[X.ixfe],ne>0&&(X.z=Ue[X.ixfe>>8&63]),Oh(X,u,l.opts.Date1904),$e({c:Ye.c,r:Ye.r},X,u);break;case 0:case 512:me===1&&(_=Ye);break;case 252:C=Ye;break;case 1054:if(de.biff==4){Ue[ne++]=Ye[1];for(var ir=0;ir<ne+163&&Pn[ir]!=Ye[1];++ir);ir>=163&&wp(Ye[1],ne+163)}else wp(Ye[1],Ye[0]);break;case 30:{Ue[ne++]=Ye;for(var st=0;st<ne+163&&Pn[st]!=Ye;++st);st>=163&&wp(Ye,ne+163)}break;case 229:le=le.concat(Ye);break;case 93:ct[Ye.cmo[0]]=de.lastobj=Ye;break;case 438:de.lastobj.TxO=Ye;break;case 127:de.lastobj.ImData=Ye;break;case 440:for(N=Ye[0].s.r;N<=Ye[0].e.r;++N)for(O=Ye[0].s.c;O<=Ye[0].e.c;++O)j=u.dense?(p[N]||[])[O]:p[Dn({c:O,r:N})],j&&(j.l=Ye[1]);break;case 2048:for(N=Ye[0].s.r;N<=Ye[0].e.r;++N)for(O=Ye[0].s.c;O<=Ye[0].e.c;++O)j=u.dense?(p[N]||[])[O]:p[Dn({c:O,r:N})],j&&j.l&&(j.l.Tooltip=Ye[1]);break;case 28:{if(de.biff<=5&&de.biff>=2)break;j=u.dense?(p[Ye[0].r]||[])[Ye[0].c]:p[Dn(Ye[0])];var fe=ct[Ye[2]];j||(u.dense?(p[Ye[0].r]||(p[Ye[0].r]=[]),j=p[Ye[0].r][Ye[0].c]={t:"z"}):j=p[Dn(Ye[0])]={t:"z"},_.e.r=Math.max(_.e.r,Ye[0].r),_.s.r=Math.min(_.s.r,Ye[0].r),_.e.c=Math.max(_.e.c,Ye[0].c),_.s.c=Math.min(_.s.c,Ye[0].c)),j.c||(j.c=[]),H={a:Ye[1],t:fe.TxO.t},j.c.push(H)}break;case 2173:m5(ge[Ye.ixfe],Ye.ext);break;case 125:{if(!de.cellStyles)break;for(;Ye.e>=Ye.s;)et[Ye.e--]={width:Ye.w/256,level:Ye.level||0,hidden:!!(Ye.flags&1)},$t||($t=!0,y1(Ye.w/256)),K0(et[Ye.e+1])}break;case 520:{var he={};Ye.level!=null&&(He[Ye.r]=he,he.level=Ye.level),Ye.hidden&&(He[Ye.r]=he,he.hidden=!0),Ye.hpt&&(He[Ye.r]=he,he.hpt=Ye.hpt,he.hpx=Og(Ye.hpt))}break;case 38:case 39:case 40:case 41:p["!margins"]||Cg(p["!margins"]={}),p["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Vt]]=Ye;break;case 161:p["!margins"]||Cg(p["!margins"]={}),p["!margins"].header=Ye.header,p["!margins"].footer=Ye.footer;break;case 574:Ye.RTL&&(re.Views[0].RTL=!0);break;case 146:ve=Ye;break;case 2198:nt=Ye;break;case 140:pe=Ye;break;case 442:M?Ce.CodeName=Ye||Ce.name:re.WBProps.CodeName=Ye||"ThisWorkbook";break}}else Yt||console.error("Missing Info for XLS Record 0x"+Vt.toString(16)),r.l+=Bt}return l.SheetNames=Uh(b).sort(function(we,Ve){return Number(we)-Number(Ve)}).map(function(we){return b[we].name}),u.bookSheets||(l.Sheets=f),!l.SheetNames.length&&D["!ref"]?(l.SheetNames.push("Sheet1"),l.Sheets&&(l.Sheets.Sheet1=D)):l.Preamble=D,l.Sheets&&Fe.forEach(function(we,Ve){l.Sheets[l.SheetNames[Ve]]["!autofilter"]=we}),l.Strings=C,l.SSF=fo(Pn),de.enc&&(l.Encryption=de.enc),nt&&(l.Themes=nt),l.Metadata={},pe!==void 0&&(l.Metadata.Country=pe),Oe.names.length>0&&(re.Names=Oe.names),l.Workbook=re,l}var Qv={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function $4(r,u,l){var f=la.find(r,"/!DocumentSummaryInformation");if(f&&f.size>0)try{var p=zv(f,hA,Qv.DSI);for(var b in p)u[b]=p[b]}catch(M){if(l.WTF)throw M}var _=la.find(r,"/!SummaryInformation");if(_&&_.size>0)try{var s=zv(_,fA,Qv.SI);for(var C in s)u[C]==null&&(u[C]=s[C])}catch(M){if(l.WTF)throw M}u.HeadingPairs&&u.TitlesOfParts&&(I2(u.HeadingPairs,u.TitlesOfParts,u,l),delete u.HeadingPairs,delete u.TitlesOfParts)}function mw(r,u){u||(u={}),S1(u),Hb(),u.codepage&&r1(u.codepage);var l,f;if(r.FullPaths){if(la.find(r,"/encryption"))throw new Error("File is password-protected");l=la.find(r,"!CompObj"),f=la.find(r,"/Workbook")||la.find(r,"/Book")}else{switch(u.type){case"base64":r=Ju(Ac(r));break;case"binary":r=Ju(r);break;case"buffer":break;case"array":Array.isArray(r)||(r=Array.prototype.slice.call(r));break}ho(r,0),f={content:r}}var p,b;if(l&&H4(l),u.bookProps&&!u.bookSheets)p={};else{var _=ra?"buffer":"array";if(f&&f.content)p=W4(f.content,u);else if((b=la.find(r,"PerfectOffice_MAIN"))&&b.content)p=Ag.to_workbook(b.content,(u.type=_,u));else if((b=la.find(r,"NativeContent_MAIN"))&&b.content)p=Ag.to_workbook(b.content,(u.type=_,u));else throw(b=la.find(r,"MN0"))&&b.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");u.bookVBA&&r.FullPaths&&la.find(r,"/_VBA_PROJECT_CUR/VBA/dir")&&(p.vbaraw=P5(r))}var s={};return r.FullPaths&&$4(r,s,u),p.Props=p.Custprops=s,u.bookFiles&&(p.cfb=r),p}var Dx={0:{f:MM},1:{f:PM},2:{f:VM},3:{f:OM},4:{f:LM},5:{f:UM},6:{f:qM},7:{f:NM},8:{f:YM},9:{f:XM},10:{f:WM},11:{f:$M},12:{f:FM},13:{f:GM},14:{f:BM},15:{f:zM},16:{f:uw},17:{f:ZM},18:{f:jM},19:{f:d1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:T4},40:{},42:{},43:{f:WC},44:{f:ZC},45:{f:$C},46:{f:YC},47:{f:XC},48:{},49:{f:KE},50:{},51:{f:_5},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:H2},62:{f:HM},63:{f:w5},64:{f:i4},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ho,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:a4},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:IM},148:{f:DM,p:16},151:{f:QM},152:{},153:{f:b4},154:{},155:{},156:{f:v4},157:{},158:{},159:{T:1,f:fC},160:{T:-1},161:{T:1,f:Rp},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:KM},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:g5},336:{T:-1},337:{f:x5,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ly},357:{},358:{},359:{},360:{T:1},361:{},362:{f:G2},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:e4},427:{f:t4},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:n4},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:RM},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:JM},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ly},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:D5},633:{T:1},634:{T:-1},635:{T:1,f:M5},636:{T:-1},637:{f:QE},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:h4},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:s4},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},jy={6:{f:yy},10:{f:dd},12:{f:vs},13:{f:vs},14:{f:ss},15:{f:ss},16:{f:Uo},17:{f:ss},18:{f:ss},19:{f:vs},20:{f:jv},21:{f:jv},23:{f:G2},24:{f:Vv},25:{f:ss},26:{},27:{},28:{f:kk},29:{},34:{f:ss},35:{f:Uv},38:{f:Uo},39:{f:Uo},40:{f:Uo},41:{f:Uo},42:{f:ss},43:{f:ss},47:{f:RC},49:{f:lk},51:{f:vs},60:{},61:{f:ik},64:{f:ss},65:{f:ok},66:{f:vs},77:{},80:{},81:{},82:{},85:{f:vs},89:{},90:{},91:{},92:{f:KA},93:{f:Mk},94:{},95:{f:ss},96:{},97:{},99:{f:ss},125:{f:H2},128:{f:xk},129:{f:JA},130:{f:vs},131:{f:ss},132:{f:ss},133:{f:QA},134:{},140:{f:Lk},141:{f:vs},144:{},146:{f:Ok},151:{},152:{},153:{},154:{},155:{},156:{f:vs},157:{},158:{},160:{f:Vk},161:{f:Nk},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:pk},190:{f:mk},193:{f:dd},197:{},198:{},199:{},200:{},201:{},202:{f:ss},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:vs},220:{},221:{f:ss},222:{},224:{f:_k},225:{f:YA},226:{f:dd},227:{},229:{f:Ck},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:ek},253:{f:ck},255:{f:tk},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:O2},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:ss},353:{f:dd},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:vk},431:{f:ss},432:{},433:{},434:{},437:{},438:{f:Ik},439:{f:ss},440:{f:Pk},441:{},442:{f:qg},443:{},444:{f:vs},445:{},446:{},448:{f:dd},449:{f:ak,r:2},450:{f:dd},512:{f:Bv},513:{f:Uk},515:{f:yk},516:{f:uk},517:{f:Nv},519:{f:Gk},520:{f:rk},523:{},545:{f:Gv},549:{f:Ov},566:{},574:{f:sk},638:{f:dk},659:{},1048:{},1054:{f:hk},1084:{},1212:{f:Sk},2048:{f:Fk},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:rx},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:dd},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Bk,r:12},2173:{f:p5,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:ss,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Tk,r:12},2197:{},2198:{f:l5,r:12},2199:{},2200:{},2201:{},2202:{f:Ek,r:12},2203:{f:dd},2204:{},2205:{},2206:{},2207:{},2211:{f:nk},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:vs},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:jk},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:zk},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Bv},1:{},2:{f:Wk},3:{f:Zk},4:{f:qk},5:{f:Nv},7:{f:$k},8:{},9:{f:rx},11:{},22:{f:vs},30:{f:fk},31:{},32:{},33:{f:Gv},36:{},37:{f:Ov},50:{f:Xk},62:{},52:{},67:{},68:{f:vs},69:{},86:{},126:{},127:{f:Hk},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Yk},223:{},234:{},354:{},421:{},518:{f:yy},521:{f:rx},536:{f:Vv},547:{f:Uv},561:{},579:{},1030:{f:yy},1033:{f:rx},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ku(r,u,l,f){var p=u;if(!isNaN(p)){var b=(l||[]).length||0,_=r.next(4);_.write_shift(2,p),_.write_shift(2,b),b>0&&S2(l)&&r.push(l)}}function eb(r,u){var l=u||{},f=l.dense?[]:{};r=r.replace(/<!--.*?-->/g,"");var p=r.match(/<table/i);if(!p)throw new Error("Invalid HTML: could not find <table>");var b=r.match(/<\/table/i),_=p.index,s=b&&b.index||r.length,C=yE(r.slice(_,s),/(:?<tr[^>]*>)/i,"<tr>"),M=-1,D=0,B=0,U=0,j={s:{r:1e7,c:1e7},e:{r:0,c:0}},H=[];for(_=0;_<C.length;++_){var O=C[_].trim(),N=O.slice(0,3).toLowerCase();if(N=="<tr"){if(++M,l.sheetRows&&l.sheetRows<=M){--M;break}D=0;continue}if(!(N!="<td"&&N!="<th")){var Z=O.split(/<\/t[dh]>/i);for(s=0;s<Z.length;++s){var J=Z[s].trim();if(J.match(/<t[dh]/i)){for(var X=J,pe=0;X.charAt(0)=="<"&&(pe=X.indexOf(">"))>-1;)X=X.slice(pe+1);for(var ge=0;ge<H.length;++ge){var ve=H[ge];ve.s.c==D&&ve.s.r<M&&M<=ve.e.r&&(D=ve.e.c+1,ge=-1)}var re=xn(J.slice(0,J.indexOf(">")));U=re.colspan?+re.colspan:1,((B=+re.rowspan)>1||U>1)&&H.push({s:{r:M,c:D},e:{r:M+(B||1)-1,c:D+U-1}});var Ce=re.t||re["data-t"]||"";if(!X.length){D+=U;continue}if(X=h2(X),j.s.r>M&&(j.s.r=M),j.e.r<M&&(j.e.r=M),j.s.c>D&&(j.s.c=D),j.e.c<D&&(j.e.c=D),!X.length){D+=U;continue}var xe={t:"s",v:X};l.raw||!X.trim().length||Ce=="s"||(X==="TRUE"?xe={t:"b",v:!0}:X==="FALSE"?xe={t:"b",v:!1}:isNaN(rh(X))?isNaN(Y0(X).getDate())||(xe={t:"d",v:Ks(X)},l.cellDates||(xe={t:"n",v:Sl(xe.v)}),xe.z=l.dateNF||Pn[14]):xe={t:"n",v:rh(X)}),l.dense?(f[M]||(f[M]=[]),f[M][D]=xe):f[Dn({r:M,c:D})]=xe,D+=U}}}}return f["!ref"]=ca(j),H.length&&(f["!merges"]=H),f}function X4(r,u,l,f){for(var p=r["!merges"]||[],b=[],_=u.s.c;_<=u.e.c;++_){for(var s=0,C=0,M=0;M<p.length;++M)if(!(p[M].s.r>l||p[M].s.c>_)&&!(p[M].e.r<l||p[M].e.c<_)){if(p[M].s.r<l||p[M].s.c<_){s=-1;break}s=p[M].e.r-p[M].s.r+1,C=p[M].e.c-p[M].s.c+1;break}if(!(s<0)){var D=Dn({r:l,c:_}),B=f.dense?(r[l]||[])[_]:r[D],U=B&&B.v!=null&&(B.h||l1(B.w||(kf(B),B.w)||""))||"",j={};s>1&&(j.rowspan=s),C>1&&(j.colspan=C),f.editable?U='<span contenteditable="true">'+U+"</span>":B&&(j["data-t"]=B&&B.t||"z",B.v!=null&&(j["data-v"]=B.v),B.z!=null&&(j["data-z"]=B.z),B.l&&(B.l.Target||"#").charAt(0)!="#"&&(U='<a href="'+B.l.Target+'">'+U+"</a>")),j.id=(f.id||"sjs")+"-"+D,b.push(LE("td",U,j))}}var H="<tr>";return H+b.join("")+"</tr>"}var Y4='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',K4="</body></html>";function J4(r,u){var l=r.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!l||l.length==0)throw new Error("Invalid HTML: could not find <table>");if(l.length==1)return Ed(eb(l[0],u),u);var f=A1();return l.forEach(function(p,b){k1(f,eb(p,u),"Sheet"+(b+1))}),f}function Q4(r,u,l){var f=[];return f.join("")+"<table"+(l&&l.id?' id="'+l.id+'"':"")+">"}function eD(r,u){var l=u||{},f=l.header!=null?l.header:Y4,p=l.footer!=null?l.footer:K4,b=[f],_=nm(r["!ref"]);l.dense=Array.isArray(r),b.push(Q4(r,_,l));for(var s=_.s.r;s<=_.e.r;++s)b.push(X4(r,_,s,l));return b.push("</table>"+p),b.join("")}function gw(r,u,l){var f=l||{},p=0,b=0;if(f.origin!=null)if(typeof f.origin=="number")p=f.origin;else{var _=typeof f.origin=="string"?wl(f.origin):f.origin;p=_.r,b=_.c}var s=u.getElementsByTagName("tr"),C=Math.min(f.sheetRows||1e7,s.length),M={s:{r:0,c:0},e:{r:p,c:b}};if(r["!ref"]){var D=nm(r["!ref"]);M.s.r=Math.min(M.s.r,D.s.r),M.s.c=Math.min(M.s.c,D.s.c),M.e.r=Math.max(M.e.r,D.e.r),M.e.c=Math.max(M.e.c,D.e.c),p==-1&&(M.e.r=p=D.e.r+1)}var B=[],U=0,j=r["!rows"]||(r["!rows"]=[]),H=0,O=0,N=0,Z=0,J=0,X=0;for(r["!cols"]||(r["!cols"]=[]);H<s.length&&O<C;++H){var pe=s[H];if(tb(pe)){if(f.display)continue;j[O]={hidden:!0}}var ge=pe.children;for(N=Z=0;N<ge.length;++N){var ve=ge[N];if(!(f.display&&tb(ve))){var re=ve.hasAttribute("data-v")?ve.getAttribute("data-v"):ve.hasAttribute("v")?ve.getAttribute("v"):h2(ve.innerHTML),Ce=ve.getAttribute("data-z")||ve.getAttribute("z");for(U=0;U<B.length;++U){var xe=B[U];xe.s.c==Z+b&&xe.s.r<O+p&&O+p<=xe.e.r&&(Z=xe.e.c+1-b,U=-1)}X=+ve.getAttribute("colspan")||1,((J=+ve.getAttribute("rowspan")||1)>1||X>1)&&B.push({s:{r:O+p,c:Z+b},e:{r:O+p+(J||1)-1,c:Z+b+(X||1)-1}});var Ge={t:"s",v:re},$e=ve.getAttribute("data-t")||ve.getAttribute("t")||"";re!=null&&(re.length==0?Ge.t=$e||"z":f.raw||re.trim().length==0||$e=="s"||(re==="TRUE"?Ge={t:"b",v:!0}:re==="FALSE"?Ge={t:"b",v:!1}:isNaN(rh(re))?isNaN(Y0(re).getDate())||(Ge={t:"d",v:Ks(re)},f.cellDates||(Ge={t:"n",v:Sl(Ge.v)}),Ge.z=f.dateNF||Pn[14]):Ge={t:"n",v:rh(re)})),Ge.z===void 0&&Ce!=null&&(Ge.z=Ce);var de="",nt=ve.getElementsByTagName("A");if(nt&&nt.length)for(var le=0;le<nt.length&&!(nt[le].hasAttribute("href")&&(de=nt[le].getAttribute("href"),de.charAt(0)!="#"));++le);de&&de.charAt(0)!="#"&&(Ge.l={Target:de}),f.dense?(r[O+p]||(r[O+p]=[]),r[O+p][Z+b]=Ge):r[Dn({c:Z+b,r:O+p})]=Ge,M.e.c<Z+b&&(M.e.c=Z+b),Z+=X}}++O}return B.length&&(r["!merges"]=(r["!merges"]||[]).concat(B)),M.e.r=Math.max(M.e.r,O-1+p),r["!ref"]=ca(M),O>=C&&(r["!fullref"]=ca((M.e.r=s.length-H+O-1+p,M))),r}function _w(r,u){var l=u||{},f=l.dense?[]:{};return gw(f,r,u)}function tD(r,u){return Ed(_w(r,u),u)}function tb(r){var u="",l=rD(r);return l&&(u=l(r).getPropertyValue("display")),u||(u=r.style&&r.style.display),u==="none"}function rD(r){return r.ownerDocument.defaultView&&typeof r.ownerDocument.defaultView.getComputedStyle=="function"?r.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function nD(r){var u=r.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(f,p){return Array(parseInt(p,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),l=xa(u.replace(/<[^>]*>/g,""));return[l]}var rb={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function xw(r,u){var l=u||{},f=c1(r),p=[],b,_,s={name:""},C="",M=0,D,B,U={},j=[],H=l.dense?[]:{},O,N,Z={value:""},J="",X=0,pe=[],ge=-1,ve=-1,re={s:{r:1e6,c:1e7},e:{r:0,c:0}},Ce=0,xe={},Ge=[],$e={},de=0,nt=0,le=[],ct=1,et=1,He=[],$t={Names:[]},Oe={},It=["",""],me=[],ne={},Ue="",Fe=0,Re=!1,bt=!1,Gt=0;for(Fg.lastIndex=0,f=f.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");O=Fg.exec(f);)switch(O[3]=O[3].replace(/_.*$/,"")){case"table":case"":O[1]==="/"?(re.e.c>=re.s.c&&re.e.r>=re.s.r?H["!ref"]=ca(re):H["!ref"]="A1:A1",l.sheetRows>0&&l.sheetRows<=re.e.r&&(H["!fullref"]=H["!ref"],re.e.r=l.sheetRows-1,H["!ref"]=ca(re)),Ge.length&&(H["!merges"]=Ge),le.length&&(H["!rows"]=le),D.name=D.||D.name,typeof JSON<"u"&&JSON.stringify(D),j.push(D.name),U[D.name]=H,bt=!1):O[0].charAt(O[0].length-2)!=="/"&&(D=xn(O[0],!1),ge=ve=-1,re.s.r=re.s.c=1e7,re.e.r=re.e.c=0,H=l.dense?[]:{},Ge=[],le=[],bt=!0);break;case"table-row-group":O[1]==="/"?--Ce:++Ce;break;case"table-row":case"":if(O[1]==="/"){ge+=ct,ct=1;break}if(B=xn(O[0],!1),B.?ge=B.-1:ge==-1&&(ge=0),ct=+B["number-rows-repeated"]||1,ct<10)for(Gt=0;Gt<ct;++Gt)Ce>0&&(le[ge+Gt]={level:Ce});ve=-1;break;case"covered-table-cell":O[1]!=="/"&&++ve,l.sheetStubs&&(l.dense?(H[ge]||(H[ge]=[]),H[ge][ve]={t:"z"}):H[Dn({r:ge,c:ve})]={t:"z"}),J="",pe=[];break;case"table-cell":case"":if(O[0].charAt(O[0].length-2)==="/")++ve,Z=xn(O[0],!1),et=parseInt(Z["number-columns-repeated"]||"1",10),N={t:"z",v:null},Z.formula&&l.cellFormula!=!1&&(N.f=Yv(xa(Z.formula))),(Z.||Z["value-type"])=="string"&&(N.t="s",N.v=xa(Z["string-value"]||""),l.dense?(H[ge]||(H[ge]=[]),H[ge][ve]=N):H[Dn({r:ge,c:ve})]=N),ve+=et-1;else if(O[1]!=="/"){++ve,J="",X=0,pe=[],et=1;var Vt=ct?ge+ct-1:ge;if(ve>re.e.c&&(re.e.c=ve),ve<re.s.c&&(re.s.c=ve),ge<re.s.r&&(re.s.r=ge),Vt>re.e.r&&(re.e.r=Vt),Z=xn(O[0],!1),me=[],ne={},N={t:Z.||Z["value-type"],v:null},l.cellFormula)if(Z.formula&&(Z.formula=xa(Z.formula)),Z["number-matrix-columns-spanned"]&&Z["number-matrix-rows-spanned"]&&(de=parseInt(Z["number-matrix-rows-spanned"],10)||0,nt=parseInt(Z["number-matrix-columns-spanned"],10)||0,$e={s:{r:ge,c:ve},e:{r:ge+de-1,c:ve+nt-1}},N.F=ca($e),He.push([$e,N.F])),Z.formula)N.f=Yv(Z.formula);else for(Gt=0;Gt<He.length;++Gt)ge>=He[Gt][0].s.r&&ge<=He[Gt][0].e.r&&ve>=He[Gt][0].s.c&&ve<=He[Gt][0].e.c&&(N.F=He[Gt][1]);switch((Z["number-columns-spanned"]||Z["number-rows-spanned"])&&(de=parseInt(Z["number-rows-spanned"],10)||0,nt=parseInt(Z["number-columns-spanned"],10)||0,$e={s:{r:ge,c:ve},e:{r:ge+de-1,c:ve+nt-1}},Ge.push($e)),Z["number-columns-repeated"]&&(et=parseInt(Z["number-columns-repeated"],10)),N.t){case"boolean":N.t="b",N.v=vi(Z["boolean-value"]);break;case"float":N.t="n",N.v=parseFloat(Z.value);break;case"percentage":N.t="n",N.v=parseFloat(Z.value);break;case"currency":N.t="n",N.v=parseFloat(Z.value);break;case"date":N.t="d",N.v=Ks(Z["date-value"]),l.cellDates||(N.t="n",N.v=Sl(N.v)),N.z="m/d/yy";break;case"time":N.t="n",N.v=gE(Z["time-value"])/86400,l.cellDates&&(N.t="d",N.v=Ox(N.v)),N.z="HH:MM:SS";break;case"number":N.t="n",N.v=parseFloat(Z.);break;default:if(N.t==="string"||N.t==="text"||!N.t)N.t="s",Z["string-value"]!=null&&(J=xa(Z["string-value"]),pe=[]);else throw new Error("Unsupported value type "+N.t)}}else{if(Re=!1,N.t==="s"&&(N.v=J||"",pe.length&&(N.R=pe),Re=X==0),Oe.Target&&(N.l=Oe),me.length>0&&(N.c=me,me=[]),J&&l.cellText!==!1&&(N.w=J),Re&&(N.t="z",delete N.v),(!Re||l.sheetStubs)&&!(l.sheetRows&&l.sheetRows<=ge))for(var Bt=0;Bt<ct;++Bt){if(et=parseInt(Z["number-columns-repeated"]||"1",10),l.dense)for(H[ge+Bt]||(H[ge+Bt]=[]),H[ge+Bt][ve]=Bt==0?N:fo(N);--et>0;)H[ge+Bt][ve+et]=fo(N);else for(H[Dn({r:ge+Bt,c:ve})]=N;--et>0;)H[Dn({r:ge+Bt,c:ve+et})]=fo(N);re.e.c<=ve&&(re.e.c=ve)}et=parseInt(Z["number-columns-repeated"]||"1",10),ve+=et-1,et=0,N={},J="",pe=[]}Oe={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(O[1]==="/"){if((b=p.pop())[0]!==O[3])throw"Bad state: "+b}else O[0].charAt(O[0].length-2)!=="/"&&p.push([O[3],!0]);break;case"annotation":if(O[1]==="/"){if((b=p.pop())[0]!==O[3])throw"Bad state: "+b;ne.t=J,pe.length&&(ne.R=pe),ne.a=Ue,me.push(ne)}else O[0].charAt(O[0].length-2)!=="/"&&p.push([O[3],!1]);Ue="",Fe=0,J="",X=0,pe=[];break;case"creator":O[1]==="/"?Ue=f.slice(Fe,O.index):Fe=O.index+O[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(O[1]==="/"){if((b=p.pop())[0]!==O[3])throw"Bad state: "+b}else O[0].charAt(O[0].length-2)!=="/"&&p.push([O[3],!1]);J="",X=0,pe=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(O[1]==="/"){if(xe[s.name]=C,(b=p.pop())[0]!==O[3])throw"Bad state: "+b}else O[0].charAt(O[0].length-2)!=="/"&&(C="",s=xn(O[0],!1),p.push([O[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(p[p.length-1][0]){case"time-style":case"date-style":_=xn(O[0],!1),C+=rb[O[3]][_.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(p[p.length-1][0]){case"time-style":case"date-style":_=xn(O[0],!1),C+=rb[O[3]][_.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(O[0].slice(-2)==="/>")break;if(O[1]==="/")switch(p[p.length-1][0]){case"number-style":case"date-style":case"time-style":C+=f.slice(M,O.index);break}else M=O.index+O[0].length;break;case"named-range":_=xn(O[0],!1),It=vy(_["cell-range-address"]);var Yt={Name:_.name,Ref:It[0]+"!"+It[1]};bt&&(Yt.Sheet=j.length),$t.Names.push(Yt);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(p[p.length-1][0])>-1)break;if(O[1]==="/"&&(!Z||!Z["string-value"])){var Or=nD(f.slice(X,O.index));J=(J.length>0?J+`
`:"")+Or[0]}else xn(O[0],!1),X=O.index+O[0].length;break;case"s":break;case"database-range":if(O[1]==="/")break;try{It=vy(xn(O[0])["target-range-address"]),U[It[0]]["!autofilter"]={ref:It[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(O[1]!=="/"){if(Oe=xn(O[0],!1),!Oe.href)break;Oe.Target=xa(Oe.href),delete Oe.href,Oe.Target.charAt(0)=="#"&&Oe.Target.indexOf(".")>-1?(It=vy(Oe.Target.slice(1)),Oe.Target="#"+It[0]+"!"+It[1]):Oe.Target.match(/^\.\.[\\\/]/)&&(Oe.Target=Oe.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(O[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(l.WTF)throw new Error(O)}}var Ye={Sheets:U,SheetNames:j,Workbook:$t};return l.bookSheets&&delete Ye.Sheets,Ye}function nb(r,u){u=u||{},nu(r,"META-INF/manifest.xml")&&yA(ys(r,"META-INF/manifest.xml"),u);var l=Ec(r,"content.xml");if(!l)throw new Error("Missing content.xml in ODS / UOF file");var f=xw(si(l),u);return nu(r,"meta.xml")&&(f.Props=R2(ys(r,"meta.xml"))),f}function ab(r,u){return xw(r,u)}function w1(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function Uy(r){return typeof TextDecoder<"u"?new TextDecoder().decode(r):si(Mp(r))}function Vy(r){var u=r.reduce(function(p,b){return p+b.length},0),l=new Uint8Array(u),f=0;return r.forEach(function(p){l.set(p,f),f+=p.length}),l}function ib(r){return r-=r>>1&1431655765,r=(r&858993459)+(r>>2&858993459),(r+(r>>4)&252645135)*16843009>>>24}function aD(r,u){for(var l=(r[u+15]&127)<<7|r[u+14]>>1,f=r[u+14]&1,p=u+13;p>=u;--p)f=f*256+r[p];return(r[u+15]&128?-f:f)*Math.pow(10,l-6176)}function Bg(r,u){var l=u?u[0]:0,f=r[l]&127;e:if(r[l++]>=128&&(f|=(r[l]&127)<<7,r[l++]<128||(f|=(r[l]&127)<<14,r[l++]<128)||(f|=(r[l]&127)<<21,r[l++]<128)||(f+=(r[l]&127)*Math.pow(2,28),++l,r[l++]<128)||(f+=(r[l]&127)*Math.pow(2,35),++l,r[l++]<128)||(f+=(r[l]&127)*Math.pow(2,42),++l,r[l++]<128)))break e;return u&&(u[0]=l),f}function Ps(r){var u=0,l=r[u]&127;e:if(r[u++]>=128){if(l|=(r[u]&127)<<7,r[u++]<128||(l|=(r[u]&127)<<14,r[u++]<128)||(l|=(r[u]&127)<<21,r[u++]<128))break e;l|=(r[u]&127)<<28}return l}function Vo(r){for(var u=[],l=[0];l[0]<r.length;){var f=l[0],p=Bg(r,l),b=p&7;p=Math.floor(p/8);var _=0,s;if(p==0)break;switch(b){case 0:{for(var C=l[0];r[l[0]++]>=128;);s=r.slice(C,l[0])}break;case 5:_=4,s=r.slice(l[0],l[0]+_),l[0]+=_;break;case 1:_=8,s=r.slice(l[0],l[0]+_),l[0]+=_;break;case 2:_=Bg(r,l),s=r.slice(l[0],l[0]+_),l[0]+=_;break;default:throw new Error("PB Type ".concat(b," for Field ").concat(p," at offset ").concat(f))}var M={data:s,type:b};u[p]==null?u[p]=[M]:u[p].push(M)}return u}function T1(r,u){return r?.map(function(l){return u(l.data)})||[]}function iD(r){for(var u,l=[],f=[0];f[0]<r.length;){var p=Bg(r,f),b=Vo(r.slice(f[0],f[0]+p));f[0]+=p;var _={id:Ps(b[1][0].data),messages:[]};b[2].forEach(function(s){var C=Vo(s.data),M=Ps(C[3][0].data);_.messages.push({meta:C,data:r.slice(f[0],f[0]+M)}),f[0]+=M}),(u=b[3])!=null&&u[0]&&(_.merge=Ps(b[3][0].data)>>>0>0),l.push(_)}return l}function sD(r,u){if(r!=0)throw new Error("Unexpected Snappy chunk type ".concat(r));for(var l=[0],f=Bg(u,l),p=[];l[0]<u.length;){var b=u[l[0]]&3;if(b==0){var _=u[l[0]++]>>2;if(_<60)++_;else{var s=_-59;_=u[l[0]],s>1&&(_|=u[l[0]+1]<<8),s>2&&(_|=u[l[0]+2]<<16),s>3&&(_|=u[l[0]+3]<<24),_>>>=0,_++,l[0]+=s}p.push(u.slice(l[0],l[0]+_)),l[0]+=_;continue}else{var C=0,M=0;if(b==1?(M=(u[l[0]]>>2&7)+4,C=(u[l[0]++]&224)<<3,C|=u[l[0]++]):(M=(u[l[0]++]>>2)+1,b==2?(C=u[l[0]]|u[l[0]+1]<<8,l[0]+=2):(C=(u[l[0]]|u[l[0]+1]<<8|u[l[0]+2]<<16|u[l[0]+3]<<24)>>>0,l[0]+=4)),p=[Vy(p)],C==0)throw new Error("Invalid offset 0");if(C>p[0].length)throw new Error("Invalid offset beyond length");if(M>=C)for(p.push(p[0].slice(-C)),M-=C;M>=p[p.length-1].length;)p.push(p[p.length-1]),M-=p[p.length-1].length;p.push(p[0].slice(-C,-C+M))}}var D=Vy(p);if(D.length!=f)throw new Error("Unexpected length: ".concat(D.length," != ").concat(f));return D}function oD(r){for(var u=[],l=0;l<r.length;){var f=r[l++],p=r[l]|r[l+1]<<8|r[l+2]<<16;l+=3,u.push(sD(f,r.slice(l,l+p))),l+=p}if(l!==r.length)throw new Error("data is not a valid framed stream!");return Vy(u)}function lD(r,u,l,f){var p=w1(r),b=p.getUint32(4,!0),_=(f>1?12:8)+ib(b&(f>1?3470:398))*4,s=-1,C=-1,M=NaN,D=new Date(2001,0,1);b&512&&(s=p.getUint32(_,!0),_+=4),_+=ib(b&(f>1?12288:4096))*4,b&16&&(C=p.getUint32(_,!0),_+=4),b&32&&(M=p.getFloat64(_,!0),_+=8),b&64&&(D.setTime(D.getTime()+p.getFloat64(_,!0)*1e3),_+=8);var B;switch(r[2]){case 0:break;case 2:B={t:"n",v:M};break;case 3:B={t:"s",v:u[C]};break;case 5:B={t:"d",v:D};break;case 6:B={t:"b",v:M>0};break;case 7:B={t:"n",v:M/86400};break;case 8:B={t:"e",v:0};break;case 9:if(s>-1)B={t:"s",v:l[s]};else if(C>-1)B={t:"s",v:u[C]};else if(!isNaN(M))B={t:"n",v:M};else throw new Error("Unsupported cell type ".concat(r.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(r.slice(0,4)))}return B}function cD(r,u,l){var f=w1(r),p=f.getUint32(8,!0),b=12,_=-1,s=-1,C=NaN,M=NaN,D=new Date(2001,0,1);p&1&&(C=aD(r,b),b+=16),p&2&&(M=f.getFloat64(b,!0),b+=8),p&4&&(D.setTime(D.getTime()+f.getFloat64(b,!0)*1e3),b+=8),p&8&&(s=f.getUint32(b,!0),b+=4),p&16&&(_=f.getUint32(b,!0),b+=4);var B;switch(r[1]){case 0:break;case 2:B={t:"n",v:C};break;case 3:B={t:"s",v:u[s]};break;case 5:B={t:"d",v:D};break;case 6:B={t:"b",v:M>0};break;case 7:B={t:"n",v:M/86400};break;case 8:B={t:"e",v:0};break;case 9:if(_>-1)B={t:"s",v:l[_]};else throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(p&31," : ").concat(r.slice(0,4)));break;case 10:B={t:"n",v:C};break;default:throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(p&31," : ").concat(r.slice(0,4)))}return B}function uD(r,u,l){switch(r[0]){case 0:case 1:case 2:case 3:return lD(r,u,l,r[0]);case 5:return cD(r,u,l);default:throw new Error("Unsupported payload version ".concat(r[0]))}}function wd(r){var u=Vo(r);return Bg(u[1][0].data)}function sb(r,u){var l=Vo(u.data),f=Ps(l[1][0].data),p=l[3],b=[];return(p||[]).forEach(function(_){var s=Vo(_.data),C=Ps(s[1][0].data)>>>0;switch(f){case 1:b[C]=Uy(s[3][0].data);break;case 8:{var M=r[wd(s[9][0].data)][0],D=Vo(M.data),B=r[wd(D[1][0].data)][0],U=Ps(B.meta[1][0].data);if(U!=2001)throw new Error("2000 unexpected reference to ".concat(U));var j=Vo(B.data);b[C]=j[3].map(function(H){return Uy(H.data)}).join("")}break}}),b}function hD(r,u){var l,f,p,b,_,s,C,M,D,B,U,j,H,O,N=Vo(r),Z=Ps(N[1][0].data)>>>0,J=Ps(N[2][0].data)>>>0,X=((f=(l=N[8])==null?void 0:l[0])==null?void 0:f.data)&&Ps(N[8][0].data)>0||!1,pe,ge;if((b=(p=N[7])==null?void 0:p[0])!=null&&b.data&&u!=0)pe=(s=(_=N[7])==null?void 0:_[0])==null?void 0:s.data,ge=(M=(C=N[6])==null?void 0:C[0])==null?void 0:M.data;else if((B=(D=N[4])==null?void 0:D[0])!=null&&B.data&&u!=1)pe=(j=(U=N[4])==null?void 0:U[0])==null?void 0:j.data,ge=(O=(H=N[3])==null?void 0:H[0])==null?void 0:O.data;else throw"NUMBERS Tile missing ".concat(u," cell storage");for(var ve=X?4:1,re=w1(pe),Ce=[],xe=0;xe<pe.length/2;++xe){var Ge=re.getUint16(xe*2,!0);Ge<65535&&Ce.push([xe,Ge])}if(Ce.length!=J)throw"Expected ".concat(J," cells, found ").concat(Ce.length);var $e=[];for(xe=0;xe<Ce.length-1;++xe)$e[Ce[xe][0]]=ge.subarray(Ce[xe][1]*ve,Ce[xe+1][1]*ve);return Ce.length>=1&&($e[Ce[Ce.length-1][0]]=ge.subarray(Ce[Ce.length-1][1]*ve)),{R:Z,cells:$e}}function fD(r,u){var l,f=Vo(u.data),p=(l=f?.[7])!=null&&l[0]?Ps(f[7][0].data)>>>0>0?1:0:-1,b=T1(f[5],function(_){return hD(_,p)});return{nrows:Ps(f[4][0].data)>>>0,data:b.reduce(function(_,s){return _[s.R]||(_[s.R]=[]),s.cells.forEach(function(C,M){if(_[s.R][M])throw new Error("Duplicate cell r=".concat(s.R," c=").concat(M));_[s.R][M]=C}),_},[])}}function dD(r,u,l){var f,p=Vo(u.data),b={s:{r:0,c:0},e:{r:0,c:0}};if(b.e.r=(Ps(p[6][0].data)>>>0)-1,b.e.r<0)throw new Error("Invalid row varint ".concat(p[6][0].data));if(b.e.c=(Ps(p[7][0].data)>>>0)-1,b.e.c<0)throw new Error("Invalid col varint ".concat(p[7][0].data));l["!ref"]=ca(b);var _=Vo(p[4][0].data),s=sb(r,r[wd(_[4][0].data)][0]),C=(f=_[17])!=null&&f[0]?sb(r,r[wd(_[17][0].data)][0]):[],M=Vo(_[3][0].data),D=0;M[1].forEach(function(B){var U=Vo(B.data),j=r[wd(U[2][0].data)][0],H=Ps(j.meta[1][0].data);if(H!=6002)throw new Error("6001 unexpected reference to ".concat(H));var O=fD(r,j);O.data.forEach(function(N,Z){N.forEach(function(J,X){var pe=Dn({r:D+Z,c:X}),ge=uD(J,s,C);ge&&(l[pe]=ge)})}),D+=O.nrows})}function pD(r,u){var l=Vo(u.data),f={"!ref":"A1"},p=r[wd(l[2][0].data)],b=Ps(p[0].meta[1][0].data);if(b!=6001)throw new Error("6000 unexpected reference to ".concat(b));return dD(r,p[0],f),f}function mD(r,u){var l,f=Vo(u.data),p={name:(l=f[1])!=null&&l[0]?Uy(f[1][0].data):"",sheets:[]},b=T1(f[2],wd);return b.forEach(function(_){r[_].forEach(function(s){var C=Ps(s.meta[1][0].data);C==6e3&&p.sheets.push(pD(r,s))})}),p}function gD(r,u){var l=A1(),f=Vo(u.data),p=T1(f[1],wd);if(p.forEach(function(b){r[b].forEach(function(_){var s=Ps(_.meta[1][0].data);if(s==2){var C=mD(r,_);C.sheets.forEach(function(M,D){k1(l,M,D==0?C.name:C.name+"_"+D,!0)})}})}),l.SheetNames.length==0)throw new Error("Empty NUMBERS file");return l}function wy(r){var u,l,f,p,b={},_=[];if(r.FullPaths.forEach(function(C){if(C.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),r.FileIndex.forEach(function(C){if(C.name.match(/\.iwa$/)){var M;try{M=oD(C.content)}catch(B){return console.log("?? "+C.content.length+" "+(B.message||B))}var D;try{D=iD(M)}catch(B){return console.log("## "+(B.message||B))}D.forEach(function(B){b[B.id]=B.messages,_.push(B.id)})}}),!_.length)throw new Error("File has no messages");var s=((p=(f=(l=(u=b?.[1])==null?void 0:u[0])==null?void 0:l.meta)==null?void 0:f[1])==null?void 0:p[0].data)&&Ps(b[1][0].meta[1][0].data)==1&&b[1][0];if(s||_.forEach(function(C){b[C].forEach(function(M){var D=Ps(M.meta[1][0].data)>>>0;if(D==1)if(!s)s=M;else throw new Error("Document has multiple roots")})}),!s)throw new Error("Cannot find Document root");return gD(b,s)}function _D(r){return function(l){for(var f=0;f!=r.length;++f){var p=r[f];l[p[0]]===void 0&&(l[p[0]]=p[1]),p[2]==="n"&&(l[p[0]]=Number(l[p[0]]))}}}function S1(r){_D([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(r)}function xD(r){return H0.WS.indexOf(r)>-1?"sheet":r==H0.CS?"chart":r==H0.DS?"dialog":r==H0.MS?"macro":r&&r.length?r:"sheet"}function yD(r,u){if(!r)return 0;try{r=u.map(function(f){return f.id||(f.id=f.strRelID),[f.name,r["!id"][f.id].Target,xD(r["!id"][f.id].Type)]})}catch{return null}return!r||r.length===0?null:r}function vD(r,u,l,f,p,b,_,s,C,M,D,B){try{b[f]=Sg(Ec(r,l,!0),u);var U=ys(r,u),j;switch(s){case"sheet":j=A4(U,u,p,C,b[f],M,D,B);break;case"chart":if(j=k4(U,u,p,C,b[f],M,D,B),!j||!j["!drawel"])break;var H=gg(j["!drawel"].Target,u),O=zy(H),N=E5(Ec(r,H,!0),Sg(Ec(r,O,!0),H)),Z=gg(N,H),J=zy(Z);j=c4(Ec(r,Z,!0),Z,C,Sg(Ec(r,J,!0),Z),M,j);break;case"macro":j=C4(U,u,p,C,b[f],M,D,B);break;case"dialog":j=M4(U,u,p,C,b[f],M,D,B);break;default:throw new Error("Unrecognized sheet type "+s)}_[f]=j;var X=[];b&&b[f]&&Uh(b[f]).forEach(function(pe){var ge="";if(b[f][pe].Type==H0.CMNT){ge=gg(b[f][pe].Target,u);var ve=P4(ys(r,ge,!0),ge,C);if(!ve||!ve.length)return;qv(j,ve,!1)}b[f][pe].Type==H0.TCMNT&&(ge=gg(b[f][pe].Target,u),X=X.concat(k5(ys(r,ge,!0),C)))}),X&&X.length&&qv(j,X,!0,C.people||[])}catch(pe){if(C.WTF)throw pe}}function tu(r){return r.charAt(0)=="/"?r.slice(1):r}function bD(r,u){if(r2(),u=u||{},S1(u),nu(r,"META-INF/manifest.xml")||nu(r,"objectdata.xml"))return nb(r,u);if(nu(r,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof wy<"u"){if(r.FileIndex)return wy(r);var l=la.utils.cfb_new();return xv(r).forEach(function(le){wE(l,le,bE(r,le))}),wy(l)}throw new Error("Unsupported NUMBERS file")}if(!nu(r,"[Content_Types].xml"))throw nu(r,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):nu(r,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var f=xv(r),p=_A(Ec(r,"[Content_Types].xml")),b=!1,_,s;if(p.workbooks.length===0&&(s="xl/workbook.xml",ys(r,s,!0)&&p.workbooks.push(s)),p.workbooks.length===0){if(s="xl/workbook.bin",!ys(r,s,!0))throw new Error("Could not find workbook");p.workbooks.push(s),b=!0}p.workbooks[0].slice(-3)=="bin"&&(b=!0);var C={},M={};if(!u.bookSheets&&!u.bookProps){if(kg=[],p.sst)try{kg=I4(ys(r,tu(p.sst)),p.sst,u)}catch(le){if(u.WTF)throw le}u.cellStyles&&p.themes.length&&(C=R4(Ec(r,p.themes[0].replace(/^\//,""),!0)||"",p.themes[0],u)),p.style&&(M=D4(ys(r,tu(p.style)),p.style,C,u))}p.links.map(function(le){try{var ct=Sg(Ec(r,zy(tu(le))),le);return L4(ys(r,tu(le)),ct,le,u)}catch{}});var D=E4(ys(r,tu(p.workbooks[0])),p.workbooks[0],u),B={},U="";p.coreprops.length&&(U=ys(r,tu(p.coreprops[0]),!0),U&&(B=R2(U)),p.extprops.length!==0&&(U=ys(r,tu(p.extprops[0]),!0),U&&wA(U,B,u)));var j={};(!u.bookSheets||u.bookProps)&&p.custprops.length!==0&&(U=Ec(r,tu(p.custprops[0]),!0),U&&(j=SA(U,u)));var H={};if((u.bookSheets||u.bookProps)&&(D.Sheets?_=D.Sheets.map(function(ct){return ct.name}):B.Worksheets&&B.SheetNames.length>0&&(_=B.SheetNames),u.bookProps&&(H.Props=B,H.Custprops=j),u.bookSheets&&typeof _<"u"&&(H.SheetNames=_),u.bookSheets?H.SheetNames:u.bookProps))return H;_={};var O={};u.bookDeps&&p.calcchain&&(O=F4(ys(r,tu(p.calcchain)),p.calcchain));var N=0,Z={},J,X;{var pe=D.Sheets;B.Worksheets=pe.length,B.SheetNames=[];for(var ge=0;ge!=pe.length;++ge)B.SheetNames[ge]=pe[ge].name}var ve=b?"bin":"xml",re=p.workbooks[0].lastIndexOf("/"),Ce=(p.workbooks[0].slice(0,re+1)+"_rels/"+p.workbooks[0].slice(re+1)+".rels").replace(/^\//,"");nu(r,Ce)||(Ce="xl/_rels/workbook."+ve+".rels");var xe=Sg(Ec(r,Ce,!0),Ce.replace(/_rels.*/,"s5s"));(p.metadata||[]).length>=1&&(u.xlmeta=z4(ys(r,tu(p.metadata[0])),p.metadata[0],u)),(p.people||[]).length>=1&&(u.people=C5(ys(r,tu(p.people[0])),u)),xe&&(xe=yD(xe,D.Sheets));var Ge=ys(r,"xl/worksheets/sheet.xml",!0)?1:0;e:for(N=0;N!=B.Worksheets;++N){var $e="sheet";if(xe&&xe[N]?(J="xl/"+xe[N][1].replace(/[\/]?xl\//,""),nu(r,J)||(J=xe[N][1]),nu(r,J)||(J=Ce.replace(/_rels\/.*$/,"")+xe[N][1]),$e=xe[N][2]):(J="xl/worksheets/sheet"+(N+1-Ge)+"."+ve,J=J.replace(/sheet0\./,"sheet.")),X=J.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),u&&u.sheets!=null)switch(typeof u.sheets){case"number":if(N!=u.sheets)continue e;break;case"string":if(B.SheetNames[N].toLowerCase()!=u.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(u.sheets)){for(var de=!1,nt=0;nt!=u.sheets.length;++nt)typeof u.sheets[nt]=="number"&&u.sheets[nt]==N&&(de=1),typeof u.sheets[nt]=="string"&&u.sheets[nt].toLowerCase()==B.SheetNames[N].toLowerCase()&&(de=1);if(!de)continue e}}vD(r,J,X,B.SheetNames[N],N,Z,_,$e,u,D,C,M)}return H={Directory:p,Workbook:D,Props:B,Custprops:j,Deps:O,Sheets:_,SheetNames:B.SheetNames,Strings:kg,Styles:M,Themes:C,SSF:fo(Pn)},u&&u.bookFiles&&(r.files?(H.keys=f,H.files=r.files):(H.keys=[],H.files={},r.FullPaths.forEach(function(le,ct){le=le.replace(/^Root Entry[\/]/,""),H.keys.push(le),H.files[le]=r.FileIndex[ct]}))),u&&u.bookVBA&&(p.vba.length>0?H.vbaraw=ys(r,tu(p.vba[0]),!0):p.defaults&&p.defaults.bin===I5&&(H.vbaraw=ys(r,"xl/vbaProject.bin",!0))),H}function wD(r,u){var l=u||{},f="Workbook",p=la.find(r,f);try{if(f="/!DataSpaces/Version",p=la.find(r,f),!p||!p.content)throw new Error("ECMA-376 Encrypted file missing "+f);if(pC(p.content),f="/!DataSpaces/DataSpaceMap",p=la.find(r,f),!p||!p.content)throw new Error("ECMA-376 Encrypted file missing "+f);var b=gC(p.content);if(b.length!==1||b[0].comps.length!==1||b[0].comps[0].t!==0||b[0].name!=="StrongEncryptionDataSpace"||b[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+f);if(f="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",p=la.find(r,f),!p||!p.content)throw new Error("ECMA-376 Encrypted file missing "+f);var _=_C(p.content);if(_.length!=1||_[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+f);if(f="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",p=la.find(r,f),!p||!p.content)throw new Error("ECMA-376 Encrypted file missing "+f);yC(p.content)}catch{}if(f="/EncryptionInfo",p=la.find(r,f),!p||!p.content)throw new Error("ECMA-376 Encrypted file missing "+f);var s=vC(p.content);if(f="/EncryptedPackage",p=la.find(r,f),!p||!p.content)throw new Error("ECMA-376 Encrypted file missing "+f);if(s[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(s[1],p.content,l.password||"",l);if(s[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(s[1],p.content,l.password||"",l);throw new Error("File is password-protected")}function E1(r,u){var l="";switch((u||{}).type||"base64"){case"buffer":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];case"base64":l=Ac(r.slice(0,12));break;case"binary":l=r;break;case"array":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];default:throw new Error("Unrecognized type "+(u&&u.type||"undefined"))}return[l.charCodeAt(0),l.charCodeAt(1),l.charCodeAt(2),l.charCodeAt(3),l.charCodeAt(4),l.charCodeAt(5),l.charCodeAt(6),l.charCodeAt(7)]}function TD(r,u){return la.find(r,"EncryptedPackage")?wD(r,u):mw(r,u)}function SD(r,u){var l,f=r,p=u||{};return p.type||(p.type=ra&&Buffer.isBuffer(r)?"buffer":"base64"),l=l2(f,p),bD(l,p)}function yw(r,u){var l=0;e:for(;l<r.length;)switch(r.charCodeAt(l)){case 10:case 13:case 32:++l;break;case 60:return Ny(r.slice(l),u);default:break e}return Lg.to_workbook(r,u)}function ED(r,u){var l="",f=E1(r,u);switch(u.type){case"base64":l=Ac(r);break;case"binary":l=r;break;case"buffer":l=r.toString("binary");break;case"array":l=Ep(r);break;default:throw new Error("Unrecognized type "+u.type)}return f[0]==239&&f[1]==187&&f[2]==191&&(l=si(l)),u.type="binary",yw(l,u)}function AD(r,u){var l=r;return u.type=="base64"&&(l=Ac(l)),l=Rg.utils.decode(1200,l.slice(2),"str"),u.type="binary",yw(l,u)}function kD(r){return r.match(/[^\x00-\x7F]/)?_g(r):r}function Ty(r,u,l,f){return f?(l.type="string",Lg.to_workbook(r,l)):Lg.to_workbook(u,l)}function Gy(r,u){Hb();var l=u||{};if(typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer)return Gy(new Uint8Array(r),(l=fo(l),l.type="array",l));typeof Uint8Array<"u"&&r instanceof Uint8Array&&!l.type&&(l.type=typeof Deno<"u"?"buffer":"array");var f=r,p=[0,0,0,0],b=!1;if(l.cellStyles&&(l.cellNF=!0,l.sheetStubs=!0),$0={},l.dateNF&&($0.dateNF=l.dateNF),l.type||(l.type=ra&&Buffer.isBuffer(r)?"buffer":"base64"),l.type=="file"&&(l.type=ra?"buffer":"binary",f=pE(r),typeof Uint8Array<"u"&&!ra&&(l.type="array")),l.type=="string"&&(b=!0,l.type="binary",l.codepage=65001,f=kD(r)),l.type=="array"&&typeof Uint8Array<"u"&&r instanceof Uint8Array&&typeof ArrayBuffer<"u"){var _=new ArrayBuffer(3),s=new Uint8Array(_);if(s.foo="bar",!s.foo)return l=fo(l),l.type="array",Gy(n1(f),l)}switch((p=E1(f,l))[0]){case 208:if(p[1]===207&&p[2]===17&&p[3]===224&&p[4]===161&&p[5]===177&&p[6]===26&&p[7]===225)return TD(la.read(f,l),l);break;case 9:if(p[1]<=8)return mw(f,l);break;case 60:return Ny(f,l);case 73:if(p[1]===73&&p[2]===42&&p[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(p[1]===68)return tC(f,l);break;case 84:if(p[1]===65&&p[2]===66&&p[3]===76)return Qk.to_workbook(f,l);break;case 80:return p[1]===75&&p[2]<9&&p[3]<9?SD(f,l):Ty(r,f,l,b);case 239:return p[3]===60?Ny(f,l):Ty(r,f,l,b);case 255:if(p[1]===254)return AD(f,l);if(p[1]===0&&p[2]===2&&p[3]===0)return Ag.to_workbook(f,l);break;case 0:if(p[1]===0&&(p[2]>=2&&p[3]===0||p[2]===0&&(p[3]===8||p[3]===9)))return Ag.to_workbook(f,l);break;case 3:case 131:case 139:case 140:return Hv.to_workbook(f,l);case 123:if(p[1]===92&&p[2]===114&&p[3]===116)return IC.to_workbook(f,l);break;case 10:case 13:case 32:return ED(f,l);case 137:if(p[1]===80&&p[2]===78&&p[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Kk.indexOf(p[0])>-1&&p[2]<=12&&p[3]<=31?Hv.to_workbook(f,l):Ty(r,f,l,b)}function CD(r,u,l,f,p,b,_,s){var C=po(l),M=s.defval,D=s.raw||!Object.prototype.hasOwnProperty.call(s,"raw"),B=!0,U=p===1?[]:{};if(p!==1)if(Object.defineProperty)try{Object.defineProperty(U,"__rowNum__",{value:l,enumerable:!1})}catch{U.__rowNum__=l}else U.__rowNum__=l;if(!_||r[l])for(var j=u.s.c;j<=u.e.c;++j){var H=_?r[l][j]:r[f[j]+C];if(H===void 0||H.t===void 0){if(M===void 0)continue;b[j]!=null&&(U[b[j]]=M);continue}var O=H.v;switch(H.t){case"z":if(O==null)break;continue;case"e":O=O==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+H.t)}if(b[j]!=null){if(O==null)if(H.t=="e"&&O===null)U[b[j]]=null;else if(M!==void 0)U[b[j]]=M;else if(D&&O===null)U[b[j]]=null;else continue;else U[b[j]]=D&&(H.t!=="n"||H.t==="n"&&s.rawNumbers!==!1)?O:kf(H,O,s);O!=null&&(B=!1)}}return{row:U,isempty:B}}function Hy(r,u){if(r==null||r["!ref"]==null)return[];var l={t:"n",v:0},f=0,p=1,b=[],_=0,s="",C={s:{r:0,c:0},e:{r:0,c:0}},M=u||{},D=M.range!=null?M.range:r["!ref"];switch(M.header===1?f=1:M.header==="A"?f=2:Array.isArray(M.header)?f=3:M.header==null&&(f=0),typeof D){case"string":C=Yi(D);break;case"number":C=Yi(r["!ref"]),C.s.r=D;break;default:C=D}f>0&&(p=0);var B=po(C.s.r),U=[],j=[],H=0,O=0,N=Array.isArray(r),Z=C.s.r,J=0,X={};N&&!r[Z]&&(r[Z]=[]);var pe=M.skipHidden&&r["!cols"]||[],ge=M.skipHidden&&r["!rows"]||[];for(J=C.s.c;J<=C.e.c;++J)if(!(pe[J]||{}).hidden)switch(U[J]=Is(J),l=N?r[Z][J]:r[U[J]+B],f){case 1:b[J]=J-C.s.c;break;case 2:b[J]=U[J];break;case 3:b[J]=M.header[J-C.s.c];break;default:if(l==null&&(l={w:"__EMPTY",t:"s"}),s=_=kf(l,null,M),O=X[_]||0,!O)X[_]=1;else{do s=_+"_"+O++;while(X[s]);X[_]=O,X[s]=1}b[J]=s}for(Z=C.s.r+p;Z<=C.e.r;++Z)if(!(ge[Z]||{}).hidden){var ve=CD(r,C,Z,U,f,b,N,M);(ve.isempty===!1||(f===1?M.blankrows!==!1:M.blankrows))&&(j[H++]=ve.row)}return j.length=H,j}var ob=/"/g;function MD(r,u,l,f,p,b,_,s){for(var C=!0,M=[],D="",B=po(l),U=u.s.c;U<=u.e.c;++U)if(f[U]){var j=s.dense?(r[l]||[])[U]:r[f[U]+B];if(j==null)D="";else if(j.v!=null){C=!1,D=""+(s.rawNumbers&&j.t=="n"?j.v:kf(j,null,s));for(var H=0,O=0;H!==D.length;++H)if((O=D.charCodeAt(H))===p||O===b||O===34||s.forceQuotes){D='"'+D.replace(ob,'""')+'"';break}D=="ID"&&(D='"ID"')}else j.f!=null&&!j.F?(C=!1,D="="+j.f,D.indexOf(",")>=0&&(D='"'+D.replace(ob,'""')+'"')):D="";M.push(D)}return s.blankrows===!1&&C?null:M.join(_)}function vw(r,u){var l=[],f=u??{};if(r==null||r["!ref"]==null)return"";var p=Yi(r["!ref"]),b=f.FS!==void 0?f.FS:",",_=b.charCodeAt(0),s=f.RS!==void 0?f.RS:`
`,C=s.charCodeAt(0),M=new RegExp((b=="|"?"\\|":b)+"+$"),D="",B=[];f.dense=Array.isArray(r);for(var U=f.skipHidden&&r["!cols"]||[],j=f.skipHidden&&r["!rows"]||[],H=p.s.c;H<=p.e.c;++H)(U[H]||{}).hidden||(B[H]=Is(H));for(var O=0,N=p.s.r;N<=p.e.r;++N)(j[N]||{}).hidden||(D=MD(r,p,N,B,_,C,b,f),D!=null&&(f.strip&&(D=D.replace(M,"")),(D||f.blankrows!==!1)&&l.push((O++?s:"")+D)));return delete f.dense,l.join("")}function DD(r,u){u||(u={}),u.FS="	",u.RS=`
`;var l=vw(r,u);return l}function RD(r){var u="",l,f="";if(r==null||r["!ref"]==null)return[];var p=Yi(r["!ref"]),b="",_=[],s,C=[],M=Array.isArray(r);for(s=p.s.c;s<=p.e.c;++s)_[s]=Is(s);for(var D=p.s.r;D<=p.e.r;++D)for(b=po(D),s=p.s.c;s<=p.e.c;++s)if(u=_[s]+b,l=M?(r[D]||[])[s]:r[u],f="",l!==void 0){if(l.F!=null){if(u=l.F,!l.f)continue;f=l.f,u.indexOf(":")==-1&&(u=u+":"+u)}if(l.f!=null)f=l.f;else{if(l.t=="z")continue;if(l.t=="n"&&l.v!=null)f=""+l.v;else if(l.t=="b")f=l.v?"TRUE":"FALSE";else if(l.w!==void 0)f="'"+l.w;else{if(l.v===void 0)continue;l.t=="s"?f="'"+l.v:f=""+l.v}}C[C.length]=u+"="+f}return C}function bw(r,u,l){var f=l||{},p=+!f.skipHeader,b=r||{},_=0,s=0;if(b&&f.origin!=null)if(typeof f.origin=="number")_=f.origin;else{var C=typeof f.origin=="string"?wl(f.origin):f.origin;_=C.r,s=C.c}var M,D={s:{c:0,r:0},e:{c:s,r:_+u.length-1+p}};if(b["!ref"]){var B=Yi(b["!ref"]);D.e.c=Math.max(D.e.c,B.e.c),D.e.r=Math.max(D.e.r,B.e.r),_==-1&&(_=B.e.r+1,D.e.r=_+u.length-1+p)}else _==-1&&(_=0,D.e.r=u.length-1+p);var U=f.header||[],j=0;u.forEach(function(O,N){Uh(O).forEach(function(Z){(j=U.indexOf(Z))==-1&&(U[j=U.length]=Z);var J=O[Z],X="z",pe="",ge=Dn({c:s+j,r:_+N+p});M=Ng(b,ge),J&&typeof J=="object"&&!(J instanceof Date)?b[ge]=J:(typeof J=="number"?X="n":typeof J=="boolean"?X="b":typeof J=="string"?X="s":J instanceof Date?(X="d",f.cellDates||(X="n",J=Sl(J)),pe=f.dateNF||Pn[14]):J===null&&f.nullError&&(X="e",J=0),M?(M.t=X,M.v=J,delete M.w,delete M.R,pe&&(M.z=pe)):b[ge]=M={t:X,v:J},pe&&(M.z=pe))})}),D.e.c=Math.max(D.e.c,s+U.length-1);var H=po(_);if(p)for(j=0;j<U.length;++j)b[Is(j+s)+H]={t:"s",v:U[j]};return b["!ref"]=ca(D),b}function ID(r,u){return bw(null,r,u)}function Ng(r,u,l){if(typeof u=="string"){if(Array.isArray(r)){var f=wl(u);return r[f.r]||(r[f.r]=[]),r[f.r][f.c]||(r[f.r][f.c]={t:"z"})}return r[u]||(r[u]={t:"z"})}return typeof u!="number"?Ng(r,Dn(u)):Ng(r,Dn({r:u,c:l||0}))}function PD(r,u){if(typeof u=="number"){if(u>=0&&r.SheetNames.length>u)return u;throw new Error("Cannot find sheet # "+u)}else if(typeof u=="string"){var l=r.SheetNames.indexOf(u);if(l>-1)return l;throw new Error("Cannot find sheet name |"+u+"|")}else throw new Error("Cannot find sheet |"+u+"|")}function A1(){return{SheetNames:[],Sheets:{}}}function k1(r,u,l,f){var p=1;if(!l)for(;p<=65535&&r.SheetNames.indexOf(l="Sheet"+p)!=-1;++p,l=void 0);if(!l||r.SheetNames.length>=65535)throw new Error("Too many worksheets");if(f&&r.SheetNames.indexOf(l)>=0){var b=l.match(/(^.*?)(\d+)$/);p=b&&+b[2]||0;var _=b&&b[1]||l;for(++p;p<=65535&&r.SheetNames.indexOf(l=_+p)!=-1;++p);}if(_4(l),r.SheetNames.indexOf(l)>=0)throw new Error("Worksheet with name |"+l+"| already exists!");return r.SheetNames.push(l),r.Sheets[l]=u,l}function FD(r,u,l){r.Workbook||(r.Workbook={}),r.Workbook.Sheets||(r.Workbook.Sheets=[]);var f=PD(r,u);switch(r.Workbook.Sheets[f]||(r.Workbook.Sheets[f]={}),l){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+l)}r.Workbook.Sheets[f].Hidden=l}function LD(r,u){return r.z=u,r}function ww(r,u,l){return u?(r.l={Target:u},l&&(r.l.Tooltip=l)):delete r.l,r}function zD(r,u,l){return ww(r,"#"+u,l)}function OD(r,u,l){r.c||(r.c=[]),r.c.push({t:u,a:l||"SheetJS"})}function BD(r,u,l,f){for(var p=typeof u!="string"?u:Yi(u),b=typeof u=="string"?u:ca(u),_=p.s.r;_<=p.e.r;++_)for(var s=p.s.c;s<=p.e.c;++s){var C=Ng(r,_,s);C.t="n",C.F=b,delete C.v,_==p.s.r&&s==p.s.c&&(C.f=l,f&&(C.D=!0))}return r}var lb={encode_col:Is,encode_row:po,encode_cell:Dn,encode_range:ca,decode_col:f1,decode_row:h1,split_cell:YE,decode_cell:wl,decode_range:nm,format_cell:kf,sheet_add_aoa:A2,sheet_add_json:bw,sheet_add_dom:gw,aoa_to_sheet:am,json_to_sheet:ID,table_to_sheet:_w,table_to_book:tD,sheet_to_csv:vw,sheet_to_txt:DD,sheet_to_json:Hy,sheet_to_html:eD,sheet_to_formulae:RD,sheet_to_row_object_array:Hy,sheet_get_cell:Ng,book_new:A1,book_append_sheet:k1,book_set_sheet_visibility:FD,cell_set_number_format:LD,cell_set_hyperlink:ww,cell_set_internal_link:zD,cell_add_comment:OD,sheet_set_array_formula:BD,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function sx(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Sy={exports:{}};var cb;function ND(){return cb||(cb=1,(function(r,u){(function(l){r.exports=l()})(function(){return(function l(f,p,b){function _(M,D){if(!p[M]){if(!f[M]){var B=typeof sx=="function"&&sx;if(!D&&B)return B(M,!0);if(s)return s(M,!0);var U=new Error("Cannot find module '"+M+"'");throw U.code="MODULE_NOT_FOUND",U}var j=p[M]={exports:{}};f[M][0].call(j.exports,function(H){var O=f[M][1][H];return _(O||H)},j,j.exports,l,f,p,b)}return p[M].exports}for(var s=typeof sx=="function"&&sx,C=0;C<b.length;C++)_(b[C]);return _})({1:[function(l,f,p){var b=l("./utils"),_=l("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";p.encode=function(C){for(var M,D,B,U,j,H,O,N=[],Z=0,J=C.length,X=J,pe=b.getTypeOf(C)!=="string";Z<C.length;)X=J-Z,B=pe?(M=C[Z++],D=Z<J?C[Z++]:0,Z<J?C[Z++]:0):(M=C.charCodeAt(Z++),D=Z<J?C.charCodeAt(Z++):0,Z<J?C.charCodeAt(Z++):0),U=M>>2,j=(3&M)<<4|D>>4,H=1<X?(15&D)<<2|B>>6:64,O=2<X?63&B:64,N.push(s.charAt(U)+s.charAt(j)+s.charAt(H)+s.charAt(O));return N.join("")},p.decode=function(C){var M,D,B,U,j,H,O=0,N=0,Z="data:";if(C.substr(0,Z.length)===Z)throw new Error("Invalid base64 input, it looks like a data url.");var J,X=3*(C=C.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(C.charAt(C.length-1)===s.charAt(64)&&X--,C.charAt(C.length-2)===s.charAt(64)&&X--,X%1!=0)throw new Error("Invalid base64 input, bad content length.");for(J=_.uint8array?new Uint8Array(0|X):new Array(0|X);O<C.length;)M=s.indexOf(C.charAt(O++))<<2|(U=s.indexOf(C.charAt(O++)))>>4,D=(15&U)<<4|(j=s.indexOf(C.charAt(O++)))>>2,B=(3&j)<<6|(H=s.indexOf(C.charAt(O++))),J[N++]=M,j!==64&&(J[N++]=D),H!==64&&(J[N++]=B);return J}},{"./support":30,"./utils":32}],2:[function(l,f,p){var b=l("./external"),_=l("./stream/DataWorker"),s=l("./stream/Crc32Probe"),C=l("./stream/DataLengthProbe");function M(D,B,U,j,H){this.compressedSize=D,this.uncompressedSize=B,this.crc32=U,this.compression=j,this.compressedContent=H}M.prototype={getContentWorker:function(){var D=new _(b.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new C("data_length")),B=this;return D.on("end",function(){if(this.streamInfo.data_length!==B.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),D},getCompressedWorker:function(){return new _(b.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},M.createWorkerFrom=function(D,B,U){return D.pipe(new s).pipe(new C("uncompressedSize")).pipe(B.compressWorker(U)).pipe(new C("compressedSize")).withStreamInfo("compression",B)},f.exports=M},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(l,f,p){var b=l("./stream/GenericWorker");p.STORE={magic:"\0\0",compressWorker:function(){return new b("STORE compression")},uncompressWorker:function(){return new b("STORE decompression")}},p.DEFLATE=l("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(l,f,p){var b=l("./utils"),_=(function(){for(var s,C=[],M=0;M<256;M++){s=M;for(var D=0;D<8;D++)s=1&s?3988292384^s>>>1:s>>>1;C[M]=s}return C})();f.exports=function(s,C){return s!==void 0&&s.length?b.getTypeOf(s)!=="string"?(function(M,D,B,U){var j=_,H=U+B;M^=-1;for(var O=U;O<H;O++)M=M>>>8^j[255&(M^D[O])];return-1^M})(0|C,s,s.length,0):(function(M,D,B,U){var j=_,H=U+B;M^=-1;for(var O=U;O<H;O++)M=M>>>8^j[255&(M^D.charCodeAt(O))];return-1^M})(0|C,s,s.length,0):0}},{"./utils":32}],5:[function(l,f,p){p.base64=!1,p.binary=!1,p.dir=!1,p.createFolders=!0,p.date=null,p.compression=null,p.compressionOptions=null,p.comment=null,p.unixPermissions=null,p.dosPermissions=null},{}],6:[function(l,f,p){var b=null;b=typeof Promise<"u"?Promise:l("lie"),f.exports={Promise:b}},{lie:37}],7:[function(l,f,p){var b=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",_=l("pako"),s=l("./utils"),C=l("./stream/GenericWorker"),M=b?"uint8array":"array";function D(B,U){C.call(this,"FlateWorker/"+B),this._pako=null,this._pakoAction=B,this._pakoOptions=U,this.meta={}}p.magic="\b\0",s.inherits(D,C),D.prototype.processChunk=function(B){this.meta=B.meta,this._pako===null&&this._createPako(),this._pako.push(s.transformTo(M,B.data),!1)},D.prototype.flush=function(){C.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},D.prototype.cleanUp=function(){C.prototype.cleanUp.call(this),this._pako=null},D.prototype._createPako=function(){this._pako=new _[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var B=this;this._pako.onData=function(U){B.push({data:U,meta:B.meta})}},p.compressWorker=function(B){return new D("Deflate",B)},p.uncompressWorker=function(){return new D("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(l,f,p){function b(j,H){var O,N="";for(O=0;O<H;O++)N+=String.fromCharCode(255&j),j>>>=8;return N}function _(j,H,O,N,Z,J){var X,pe,ge=j.file,ve=j.compression,re=J!==M.utf8encode,Ce=s.transformTo("string",J(ge.name)),xe=s.transformTo("string",M.utf8encode(ge.name)),Ge=ge.comment,$e=s.transformTo("string",J(Ge)),de=s.transformTo("string",M.utf8encode(Ge)),nt=xe.length!==ge.name.length,le=de.length!==Ge.length,ct="",et="",He="",$t=ge.dir,Oe=ge.date,It={crc32:0,compressedSize:0,uncompressedSize:0};H&&!O||(It.crc32=j.crc32,It.compressedSize=j.compressedSize,It.uncompressedSize=j.uncompressedSize);var me=0;H&&(me|=8),re||!nt&&!le||(me|=2048);var ne=0,Ue=0;$t&&(ne|=16),Z==="UNIX"?(Ue=798,ne|=(function(Re,bt){var Gt=Re;return Re||(Gt=bt?16893:33204),(65535&Gt)<<16})(ge.unixPermissions,$t)):(Ue=20,ne|=(function(Re){return 63&(Re||0)})(ge.dosPermissions)),X=Oe.getUTCHours(),X<<=6,X|=Oe.getUTCMinutes(),X<<=5,X|=Oe.getUTCSeconds()/2,pe=Oe.getUTCFullYear()-1980,pe<<=4,pe|=Oe.getUTCMonth()+1,pe<<=5,pe|=Oe.getUTCDate(),nt&&(et=b(1,1)+b(D(Ce),4)+xe,ct+="up"+b(et.length,2)+et),le&&(He=b(1,1)+b(D($e),4)+de,ct+="uc"+b(He.length,2)+He);var Fe="";return Fe+=`
\0`,Fe+=b(me,2),Fe+=ve.magic,Fe+=b(X,2),Fe+=b(pe,2),Fe+=b(It.crc32,4),Fe+=b(It.compressedSize,4),Fe+=b(It.uncompressedSize,4),Fe+=b(Ce.length,2),Fe+=b(ct.length,2),{fileRecord:B.LOCAL_FILE_HEADER+Fe+Ce+ct,dirRecord:B.CENTRAL_FILE_HEADER+b(Ue,2)+Fe+b($e.length,2)+"\0\0\0\0"+b(ne,4)+b(N,4)+Ce+ct+$e}}var s=l("../utils"),C=l("../stream/GenericWorker"),M=l("../utf8"),D=l("../crc32"),B=l("../signature");function U(j,H,O,N){C.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=H,this.zipPlatform=O,this.encodeFileName=N,this.streamFiles=j,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(U,C),U.prototype.push=function(j){var H=j.meta.percent||0,O=this.entriesCount,N=this._sources.length;this.accumulate?this.contentBuffer.push(j):(this.bytesWritten+=j.data.length,C.prototype.push.call(this,{data:j.data,meta:{currentFile:this.currentFile,percent:O?(H+100*(O-N-1))/O:100}}))},U.prototype.openedSource=function(j){this.currentSourceOffset=this.bytesWritten,this.currentFile=j.file.name;var H=this.streamFiles&&!j.file.dir;if(H){var O=_(j,H,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:O.fileRecord,meta:{percent:0}})}else this.accumulate=!0},U.prototype.closedSource=function(j){this.accumulate=!1;var H=this.streamFiles&&!j.file.dir,O=_(j,H,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(O.dirRecord),H)this.push({data:(function(N){return B.DATA_DESCRIPTOR+b(N.crc32,4)+b(N.compressedSize,4)+b(N.uncompressedSize,4)})(j),meta:{percent:100}});else for(this.push({data:O.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},U.prototype.flush=function(){for(var j=this.bytesWritten,H=0;H<this.dirRecords.length;H++)this.push({data:this.dirRecords[H],meta:{percent:100}});var O=this.bytesWritten-j,N=(function(Z,J,X,pe,ge){var ve=s.transformTo("string",ge(pe));return B.CENTRAL_DIRECTORY_END+"\0\0\0\0"+b(Z,2)+b(Z,2)+b(J,4)+b(X,4)+b(ve.length,2)+ve})(this.dirRecords.length,O,j,this.zipComment,this.encodeFileName);this.push({data:N,meta:{percent:100}})},U.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},U.prototype.registerPrevious=function(j){this._sources.push(j);var H=this;return j.on("data",function(O){H.processChunk(O)}),j.on("end",function(){H.closedSource(H.previous.streamInfo),H._sources.length?H.prepareNextSource():H.end()}),j.on("error",function(O){H.error(O)}),this},U.prototype.resume=function(){return!!C.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},U.prototype.error=function(j){var H=this._sources;if(!C.prototype.error.call(this,j))return!1;for(var O=0;O<H.length;O++)try{H[O].error(j)}catch{}return!0},U.prototype.lock=function(){C.prototype.lock.call(this);for(var j=this._sources,H=0;H<j.length;H++)j[H].lock()},f.exports=U},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(l,f,p){var b=l("../compressions"),_=l("./ZipFileWorker");p.generateWorker=function(s,C,M){var D=new _(C.streamFiles,M,C.platform,C.encodeFileName),B=0;try{s.forEach(function(U,j){B++;var H=(function(J,X){var pe=J||X,ge=b[pe];if(!ge)throw new Error(pe+" is not a valid compression method !");return ge})(j.options.compression,C.compression),O=j.options.compressionOptions||C.compressionOptions||{},N=j.dir,Z=j.date;j._compressWorker(H,O).withStreamInfo("file",{name:U,dir:N,date:Z,comment:j.comment||"",unixPermissions:j.unixPermissions,dosPermissions:j.dosPermissions}).pipe(D)}),D.entriesCount=B}catch(U){D.error(U)}return D}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(l,f,p){function b(){if(!(this instanceof b))return new b;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var _=new b;for(var s in this)typeof this[s]!="function"&&(_[s]=this[s]);return _}}(b.prototype=l("./object")).loadAsync=l("./load"),b.support=l("./support"),b.defaults=l("./defaults"),b.version="3.10.1",b.loadAsync=function(_,s){return new b().loadAsync(_,s)},b.external=l("./external"),f.exports=b},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(l,f,p){var b=l("./utils"),_=l("./external"),s=l("./utf8"),C=l("./zipEntries"),M=l("./stream/Crc32Probe"),D=l("./nodejsUtils");function B(U){return new _.Promise(function(j,H){var O=U.decompressed.getContentWorker().pipe(new M);O.on("error",function(N){H(N)}).on("end",function(){O.streamInfo.crc32!==U.decompressed.crc32?H(new Error("Corrupted zip : CRC32 mismatch")):j()}).resume()})}f.exports=function(U,j){var H=this;return j=b.extend(j||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),D.isNode&&D.isStream(U)?_.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):b.prepareContent("the loaded zip file",U,!0,j.optimizedBinaryString,j.base64).then(function(O){var N=new C(j);return N.load(O),N}).then(function(O){var N=[_.Promise.resolve(O)],Z=O.files;if(j.checkCRC32)for(var J=0;J<Z.length;J++)N.push(B(Z[J]));return _.Promise.all(N)}).then(function(O){for(var N=O.shift(),Z=N.files,J=0;J<Z.length;J++){var X=Z[J],pe=X.fileNameStr,ge=b.resolve(X.fileNameStr);H.file(ge,X.decompressed,{binary:!0,optimizedBinaryString:!0,date:X.date,dir:X.dir,comment:X.fileCommentStr.length?X.fileCommentStr:null,unixPermissions:X.unixPermissions,dosPermissions:X.dosPermissions,createFolders:j.createFolders}),X.dir||(H.file(ge).unsafeOriginalName=pe)}return N.zipComment.length&&(H.comment=N.zipComment),H})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(l,f,p){var b=l("../utils"),_=l("../stream/GenericWorker");function s(C,M){_.call(this,"Nodejs stream input adapter for "+C),this._upstreamEnded=!1,this._bindStream(M)}b.inherits(s,_),s.prototype._bindStream=function(C){var M=this;(this._stream=C).pause(),C.on("data",function(D){M.push({data:D,meta:{percent:0}})}).on("error",function(D){M.isPaused?this.generatedError=D:M.error(D)}).on("end",function(){M.isPaused?M._upstreamEnded=!0:M.end()})},s.prototype.pause=function(){return!!_.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!_.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},f.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(l,f,p){var b=l("readable-stream").Readable;function _(s,C,M){b.call(this,C),this._helper=s;var D=this;s.on("data",function(B,U){D.push(B)||D._helper.pause(),M&&M(U)}).on("error",function(B){D.emit("error",B)}).on("end",function(){D.push(null)})}l("../utils").inherits(_,b),_.prototype._read=function(){this._helper.resume()},f.exports=_},{"../utils":32,"readable-stream":16}],14:[function(l,f,p){f.exports={isNode:typeof Buffer<"u",newBufferFrom:function(b,_){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(b,_);if(typeof b=="number")throw new Error('The "data" argument must not be a number');return new Buffer(b,_)},allocBuffer:function(b){if(Buffer.alloc)return Buffer.alloc(b);var _=new Buffer(b);return _.fill(0),_},isBuffer:function(b){return Buffer.isBuffer(b)},isStream:function(b){return b&&typeof b.on=="function"&&typeof b.pause=="function"&&typeof b.resume=="function"}}},{}],15:[function(l,f,p){function b(ge,ve,re){var Ce,xe=s.getTypeOf(ve),Ge=s.extend(re||{},D);Ge.date=Ge.date||new Date,Ge.compression!==null&&(Ge.compression=Ge.compression.toUpperCase()),typeof Ge.unixPermissions=="string"&&(Ge.unixPermissions=parseInt(Ge.unixPermissions,8)),Ge.unixPermissions&&16384&Ge.unixPermissions&&(Ge.dir=!0),Ge.dosPermissions&&16&Ge.dosPermissions&&(Ge.dir=!0),Ge.dir&&(ge=Z(ge)),Ge.createFolders&&(Ce=N(ge))&&J.call(this,Ce,!0);var $e=xe==="string"&&Ge.binary===!1&&Ge.base64===!1;re&&re.binary!==void 0||(Ge.binary=!$e),(ve instanceof B&&ve.uncompressedSize===0||Ge.dir||!ve||ve.length===0)&&(Ge.base64=!1,Ge.binary=!0,ve="",Ge.compression="STORE",xe="string");var de=null;de=ve instanceof B||ve instanceof C?ve:H.isNode&&H.isStream(ve)?new O(ge,ve):s.prepareContent(ge,ve,Ge.binary,Ge.optimizedBinaryString,Ge.base64);var nt=new U(ge,de,Ge);this.files[ge]=nt}var _=l("./utf8"),s=l("./utils"),C=l("./stream/GenericWorker"),M=l("./stream/StreamHelper"),D=l("./defaults"),B=l("./compressedObject"),U=l("./zipObject"),j=l("./generate"),H=l("./nodejsUtils"),O=l("./nodejs/NodejsStreamInputAdapter"),N=function(ge){ge.slice(-1)==="/"&&(ge=ge.substring(0,ge.length-1));var ve=ge.lastIndexOf("/");return 0<ve?ge.substring(0,ve):""},Z=function(ge){return ge.slice(-1)!=="/"&&(ge+="/"),ge},J=function(ge,ve){return ve=ve!==void 0?ve:D.createFolders,ge=Z(ge),this.files[ge]||b.call(this,ge,null,{dir:!0,createFolders:ve}),this.files[ge]};function X(ge){return Object.prototype.toString.call(ge)==="[object RegExp]"}var pe={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(ge){var ve,re,Ce;for(ve in this.files)Ce=this.files[ve],(re=ve.slice(this.root.length,ve.length))&&ve.slice(0,this.root.length)===this.root&&ge(re,Ce)},filter:function(ge){var ve=[];return this.forEach(function(re,Ce){ge(re,Ce)&&ve.push(Ce)}),ve},file:function(ge,ve,re){if(arguments.length!==1)return ge=this.root+ge,b.call(this,ge,ve,re),this;if(X(ge)){var Ce=ge;return this.filter(function(Ge,$e){return!$e.dir&&Ce.test(Ge)})}var xe=this.files[this.root+ge];return xe&&!xe.dir?xe:null},folder:function(ge){if(!ge)return this;if(X(ge))return this.filter(function(xe,Ge){return Ge.dir&&ge.test(xe)});var ve=this.root+ge,re=J.call(this,ve),Ce=this.clone();return Ce.root=re.name,Ce},remove:function(ge){ge=this.root+ge;var ve=this.files[ge];if(ve||(ge.slice(-1)!=="/"&&(ge+="/"),ve=this.files[ge]),ve&&!ve.dir)delete this.files[ge];else for(var re=this.filter(function(xe,Ge){return Ge.name.slice(0,ge.length)===ge}),Ce=0;Ce<re.length;Ce++)delete this.files[re[Ce].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(ge){var ve,re={};try{if((re=s.extend(ge||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:_.utf8encode})).type=re.type.toLowerCase(),re.compression=re.compression.toUpperCase(),re.type==="binarystring"&&(re.type="string"),!re.type)throw new Error("No output type specified.");s.checkSupport(re.type),re.platform!=="darwin"&&re.platform!=="freebsd"&&re.platform!=="linux"&&re.platform!=="sunos"||(re.platform="UNIX"),re.platform==="win32"&&(re.platform="DOS");var Ce=re.comment||this.comment||"";ve=j.generateWorker(this,re,Ce)}catch(xe){(ve=new C("error")).error(xe)}return new M(ve,re.type||"string",re.mimeType)},generateAsync:function(ge,ve){return this.generateInternalStream(ge).accumulate(ve)},generateNodeStream:function(ge,ve){return(ge=ge||{}).type||(ge.type="nodebuffer"),this.generateInternalStream(ge).toNodejsStream(ve)}};f.exports=pe},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(l,f,p){f.exports=l("stream")},{stream:void 0}],17:[function(l,f,p){var b=l("./DataReader");function _(s){b.call(this,s);for(var C=0;C<this.data.length;C++)s[C]=255&s[C]}l("../utils").inherits(_,b),_.prototype.byteAt=function(s){return this.data[this.zero+s]},_.prototype.lastIndexOfSignature=function(s){for(var C=s.charCodeAt(0),M=s.charCodeAt(1),D=s.charCodeAt(2),B=s.charCodeAt(3),U=this.length-4;0<=U;--U)if(this.data[U]===C&&this.data[U+1]===M&&this.data[U+2]===D&&this.data[U+3]===B)return U-this.zero;return-1},_.prototype.readAndCheckSignature=function(s){var C=s.charCodeAt(0),M=s.charCodeAt(1),D=s.charCodeAt(2),B=s.charCodeAt(3),U=this.readData(4);return C===U[0]&&M===U[1]&&D===U[2]&&B===U[3]},_.prototype.readData=function(s){if(this.checkOffset(s),s===0)return[];var C=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,C},f.exports=_},{"../utils":32,"./DataReader":18}],18:[function(l,f,p){var b=l("../utils");function _(s){this.data=s,this.length=s.length,this.index=0,this.zero=0}_.prototype={checkOffset:function(s){this.checkIndex(this.index+s)},checkIndex:function(s){if(this.length<this.zero+s||s<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+s+"). Corrupted zip ?")},setIndex:function(s){this.checkIndex(s),this.index=s},skip:function(s){this.setIndex(this.index+s)},byteAt:function(){},readInt:function(s){var C,M=0;for(this.checkOffset(s),C=this.index+s-1;C>=this.index;C--)M=(M<<8)+this.byteAt(C);return this.index+=s,M},readString:function(s){return b.transformTo("string",this.readData(s))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var s=this.readInt(4);return new Date(Date.UTC(1980+(s>>25&127),(s>>21&15)-1,s>>16&31,s>>11&31,s>>5&63,(31&s)<<1))}},f.exports=_},{"../utils":32}],19:[function(l,f,p){var b=l("./Uint8ArrayReader");function _(s){b.call(this,s)}l("../utils").inherits(_,b),_.prototype.readData=function(s){this.checkOffset(s);var C=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,C},f.exports=_},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(l,f,p){var b=l("./DataReader");function _(s){b.call(this,s)}l("../utils").inherits(_,b),_.prototype.byteAt=function(s){return this.data.charCodeAt(this.zero+s)},_.prototype.lastIndexOfSignature=function(s){return this.data.lastIndexOf(s)-this.zero},_.prototype.readAndCheckSignature=function(s){return s===this.readData(4)},_.prototype.readData=function(s){this.checkOffset(s);var C=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,C},f.exports=_},{"../utils":32,"./DataReader":18}],21:[function(l,f,p){var b=l("./ArrayReader");function _(s){b.call(this,s)}l("../utils").inherits(_,b),_.prototype.readData=function(s){if(this.checkOffset(s),s===0)return new Uint8Array(0);var C=this.data.subarray(this.zero+this.index,this.zero+this.index+s);return this.index+=s,C},f.exports=_},{"../utils":32,"./ArrayReader":17}],22:[function(l,f,p){var b=l("../utils"),_=l("../support"),s=l("./ArrayReader"),C=l("./StringReader"),M=l("./NodeBufferReader"),D=l("./Uint8ArrayReader");f.exports=function(B){var U=b.getTypeOf(B);return b.checkSupport(U),U!=="string"||_.uint8array?U==="nodebuffer"?new M(B):_.uint8array?new D(b.transformTo("uint8array",B)):new s(b.transformTo("array",B)):new C(B)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(l,f,p){p.LOCAL_FILE_HEADER="PK",p.CENTRAL_FILE_HEADER="PK",p.CENTRAL_DIRECTORY_END="PK",p.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",p.ZIP64_CENTRAL_DIRECTORY_END="PK",p.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(l,f,p){var b=l("./GenericWorker"),_=l("../utils");function s(C){b.call(this,"ConvertWorker to "+C),this.destType=C}_.inherits(s,b),s.prototype.processChunk=function(C){this.push({data:_.transformTo(this.destType,C.data),meta:C.meta})},f.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(l,f,p){var b=l("./GenericWorker"),_=l("../crc32");function s(){b.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}l("../utils").inherits(s,b),s.prototype.processChunk=function(C){this.streamInfo.crc32=_(C.data,this.streamInfo.crc32||0),this.push(C)},f.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(l,f,p){var b=l("../utils"),_=l("./GenericWorker");function s(C){_.call(this,"DataLengthProbe for "+C),this.propName=C,this.withStreamInfo(C,0)}b.inherits(s,_),s.prototype.processChunk=function(C){if(C){var M=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=M+C.data.length}_.prototype.processChunk.call(this,C)},f.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(l,f,p){var b=l("../utils"),_=l("./GenericWorker");function s(C){_.call(this,"DataWorker");var M=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,C.then(function(D){M.dataIsReady=!0,M.data=D,M.max=D&&D.length||0,M.type=b.getTypeOf(D),M.isPaused||M._tickAndRepeat()},function(D){M.error(D)})}b.inherits(s,_),s.prototype.cleanUp=function(){_.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!_.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,b.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(b.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var C=null,M=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":C=this.data.substring(this.index,M);break;case"uint8array":C=this.data.subarray(this.index,M);break;case"array":case"nodebuffer":C=this.data.slice(this.index,M)}return this.index=M,this.push({data:C,meta:{percent:this.max?this.index/this.max*100:0}})},f.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(l,f,p){function b(_){this.name=_||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}b.prototype={push:function(_){this.emit("data",_)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(_){this.emit("error",_)}return!0},error:function(_){return!this.isFinished&&(this.isPaused?this.generatedError=_:(this.isFinished=!0,this.emit("error",_),this.previous&&this.previous.error(_),this.cleanUp()),!0)},on:function(_,s){return this._listeners[_].push(s),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(_,s){if(this._listeners[_])for(var C=0;C<this._listeners[_].length;C++)this._listeners[_][C].call(this,s)},pipe:function(_){return _.registerPrevious(this)},registerPrevious:function(_){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=_.streamInfo,this.mergeStreamInfo(),this.previous=_;var s=this;return _.on("data",function(C){s.processChunk(C)}),_.on("end",function(){s.end()}),_.on("error",function(C){s.error(C)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var _=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),_=!0),this.previous&&this.previous.resume(),!_},flush:function(){},processChunk:function(_){this.push(_)},withStreamInfo:function(_,s){return this.extraStreamInfo[_]=s,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var _ in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,_)&&(this.streamInfo[_]=this.extraStreamInfo[_])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var _="Worker "+this.name;return this.previous?this.previous+" -> "+_:_}},f.exports=b},{}],29:[function(l,f,p){var b=l("../utils"),_=l("./ConvertWorker"),s=l("./GenericWorker"),C=l("../base64"),M=l("../support"),D=l("../external"),B=null;if(M.nodestream)try{B=l("../nodejs/NodejsStreamOutputAdapter")}catch{}function U(H,O){return new D.Promise(function(N,Z){var J=[],X=H._internalType,pe=H._outputType,ge=H._mimeType;H.on("data",function(ve,re){J.push(ve),O&&O(re)}).on("error",function(ve){J=[],Z(ve)}).on("end",function(){try{var ve=(function(re,Ce,xe){switch(re){case"blob":return b.newBlob(b.transformTo("arraybuffer",Ce),xe);case"base64":return C.encode(Ce);default:return b.transformTo(re,Ce)}})(pe,(function(re,Ce){var xe,Ge=0,$e=null,de=0;for(xe=0;xe<Ce.length;xe++)de+=Ce[xe].length;switch(re){case"string":return Ce.join("");case"array":return Array.prototype.concat.apply([],Ce);case"uint8array":for($e=new Uint8Array(de),xe=0;xe<Ce.length;xe++)$e.set(Ce[xe],Ge),Ge+=Ce[xe].length;return $e;case"nodebuffer":return Buffer.concat(Ce);default:throw new Error("concat : unsupported type '"+re+"'")}})(X,J),ge);N(ve)}catch(re){Z(re)}J=[]}).resume()})}function j(H,O,N){var Z=O;switch(O){case"blob":case"arraybuffer":Z="uint8array";break;case"base64":Z="string"}try{this._internalType=Z,this._outputType=O,this._mimeType=N,b.checkSupport(Z),this._worker=H.pipe(new _(Z)),H.lock()}catch(J){this._worker=new s("error"),this._worker.error(J)}}j.prototype={accumulate:function(H){return U(this,H)},on:function(H,O){var N=this;return H==="data"?this._worker.on(H,function(Z){O.call(N,Z.data,Z.meta)}):this._worker.on(H,function(){b.delay(O,arguments,N)}),this},resume:function(){return b.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(H){if(b.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new B(this,{objectMode:this._outputType!=="nodebuffer"},H)}},f.exports=j},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(l,f,p){if(p.base64=!0,p.array=!0,p.string=!0,p.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",p.nodebuffer=typeof Buffer<"u",p.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")p.blob=!1;else{var b=new ArrayBuffer(0);try{p.blob=new Blob([b],{type:"application/zip"}).size===0}catch{try{var _=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);_.append(b),p.blob=_.getBlob("application/zip").size===0}catch{p.blob=!1}}}try{p.nodestream=!!l("readable-stream").Readable}catch{p.nodestream=!1}},{"readable-stream":16}],31:[function(l,f,p){for(var b=l("./utils"),_=l("./support"),s=l("./nodejsUtils"),C=l("./stream/GenericWorker"),M=new Array(256),D=0;D<256;D++)M[D]=252<=D?6:248<=D?5:240<=D?4:224<=D?3:192<=D?2:1;M[254]=M[254]=1;function B(){C.call(this,"utf-8 decode"),this.leftOver=null}function U(){C.call(this,"utf-8 encode")}p.utf8encode=function(j){return _.nodebuffer?s.newBufferFrom(j,"utf-8"):(function(H){var O,N,Z,J,X,pe=H.length,ge=0;for(J=0;J<pe;J++)(64512&(N=H.charCodeAt(J)))==55296&&J+1<pe&&(64512&(Z=H.charCodeAt(J+1)))==56320&&(N=65536+(N-55296<<10)+(Z-56320),J++),ge+=N<128?1:N<2048?2:N<65536?3:4;for(O=_.uint8array?new Uint8Array(ge):new Array(ge),J=X=0;X<ge;J++)(64512&(N=H.charCodeAt(J)))==55296&&J+1<pe&&(64512&(Z=H.charCodeAt(J+1)))==56320&&(N=65536+(N-55296<<10)+(Z-56320),J++),N<128?O[X++]=N:(N<2048?O[X++]=192|N>>>6:(N<65536?O[X++]=224|N>>>12:(O[X++]=240|N>>>18,O[X++]=128|N>>>12&63),O[X++]=128|N>>>6&63),O[X++]=128|63&N);return O})(j)},p.utf8decode=function(j){return _.nodebuffer?b.transformTo("nodebuffer",j).toString("utf-8"):(function(H){var O,N,Z,J,X=H.length,pe=new Array(2*X);for(O=N=0;O<X;)if((Z=H[O++])<128)pe[N++]=Z;else if(4<(J=M[Z]))pe[N++]=65533,O+=J-1;else{for(Z&=J===2?31:J===3?15:7;1<J&&O<X;)Z=Z<<6|63&H[O++],J--;1<J?pe[N++]=65533:Z<65536?pe[N++]=Z:(Z-=65536,pe[N++]=55296|Z>>10&1023,pe[N++]=56320|1023&Z)}return pe.length!==N&&(pe.subarray?pe=pe.subarray(0,N):pe.length=N),b.applyFromCharCode(pe)})(j=b.transformTo(_.uint8array?"uint8array":"array",j))},b.inherits(B,C),B.prototype.processChunk=function(j){var H=b.transformTo(_.uint8array?"uint8array":"array",j.data);if(this.leftOver&&this.leftOver.length){if(_.uint8array){var O=H;(H=new Uint8Array(O.length+this.leftOver.length)).set(this.leftOver,0),H.set(O,this.leftOver.length)}else H=this.leftOver.concat(H);this.leftOver=null}var N=(function(J,X){var pe;for((X=X||J.length)>J.length&&(X=J.length),pe=X-1;0<=pe&&(192&J[pe])==128;)pe--;return pe<0||pe===0?X:pe+M[J[pe]]>X?pe:X})(H),Z=H;N!==H.length&&(_.uint8array?(Z=H.subarray(0,N),this.leftOver=H.subarray(N,H.length)):(Z=H.slice(0,N),this.leftOver=H.slice(N,H.length))),this.push({data:p.utf8decode(Z),meta:j.meta})},B.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:p.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},p.Utf8DecodeWorker=B,b.inherits(U,C),U.prototype.processChunk=function(j){this.push({data:p.utf8encode(j.data),meta:j.meta})},p.Utf8EncodeWorker=U},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(l,f,p){var b=l("./support"),_=l("./base64"),s=l("./nodejsUtils"),C=l("./external");function M(O){return O}function D(O,N){for(var Z=0;Z<O.length;++Z)N[Z]=255&O.charCodeAt(Z);return N}l("setimmediate"),p.newBlob=function(O,N){p.checkSupport("blob");try{return new Blob([O],{type:N})}catch{try{var Z=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return Z.append(O),Z.getBlob(N)}catch{throw new Error("Bug : can't construct the Blob.")}}};var B={stringifyByChunk:function(O,N,Z){var J=[],X=0,pe=O.length;if(pe<=Z)return String.fromCharCode.apply(null,O);for(;X<pe;)N==="array"||N==="nodebuffer"?J.push(String.fromCharCode.apply(null,O.slice(X,Math.min(X+Z,pe)))):J.push(String.fromCharCode.apply(null,O.subarray(X,Math.min(X+Z,pe)))),X+=Z;return J.join("")},stringifyByChar:function(O){for(var N="",Z=0;Z<O.length;Z++)N+=String.fromCharCode(O[Z]);return N},applyCanBeUsed:{uint8array:(function(){try{return b.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return b.nodebuffer&&String.fromCharCode.apply(null,s.allocBuffer(1)).length===1}catch{return!1}})()}};function U(O){var N=65536,Z=p.getTypeOf(O),J=!0;if(Z==="uint8array"?J=B.applyCanBeUsed.uint8array:Z==="nodebuffer"&&(J=B.applyCanBeUsed.nodebuffer),J)for(;1<N;)try{return B.stringifyByChunk(O,Z,N)}catch{N=Math.floor(N/2)}return B.stringifyByChar(O)}function j(O,N){for(var Z=0;Z<O.length;Z++)N[Z]=O[Z];return N}p.applyFromCharCode=U;var H={};H.string={string:M,array:function(O){return D(O,new Array(O.length))},arraybuffer:function(O){return H.string.uint8array(O).buffer},uint8array:function(O){return D(O,new Uint8Array(O.length))},nodebuffer:function(O){return D(O,s.allocBuffer(O.length))}},H.array={string:U,array:M,arraybuffer:function(O){return new Uint8Array(O).buffer},uint8array:function(O){return new Uint8Array(O)},nodebuffer:function(O){return s.newBufferFrom(O)}},H.arraybuffer={string:function(O){return U(new Uint8Array(O))},array:function(O){return j(new Uint8Array(O),new Array(O.byteLength))},arraybuffer:M,uint8array:function(O){return new Uint8Array(O)},nodebuffer:function(O){return s.newBufferFrom(new Uint8Array(O))}},H.uint8array={string:U,array:function(O){return j(O,new Array(O.length))},arraybuffer:function(O){return O.buffer},uint8array:M,nodebuffer:function(O){return s.newBufferFrom(O)}},H.nodebuffer={string:U,array:function(O){return j(O,new Array(O.length))},arraybuffer:function(O){return H.nodebuffer.uint8array(O).buffer},uint8array:function(O){return j(O,new Uint8Array(O.length))},nodebuffer:M},p.transformTo=function(O,N){if(N=N||"",!O)return N;p.checkSupport(O);var Z=p.getTypeOf(N);return H[Z][O](N)},p.resolve=function(O){for(var N=O.split("/"),Z=[],J=0;J<N.length;J++){var X=N[J];X==="."||X===""&&J!==0&&J!==N.length-1||(X===".."?Z.pop():Z.push(X))}return Z.join("/")},p.getTypeOf=function(O){return typeof O=="string"?"string":Object.prototype.toString.call(O)==="[object Array]"?"array":b.nodebuffer&&s.isBuffer(O)?"nodebuffer":b.uint8array&&O instanceof Uint8Array?"uint8array":b.arraybuffer&&O instanceof ArrayBuffer?"arraybuffer":void 0},p.checkSupport=function(O){if(!b[O.toLowerCase()])throw new Error(O+" is not supported by this platform")},p.MAX_VALUE_16BITS=65535,p.MAX_VALUE_32BITS=-1,p.pretty=function(O){var N,Z,J="";for(Z=0;Z<(O||"").length;Z++)J+="\\x"+((N=O.charCodeAt(Z))<16?"0":"")+N.toString(16).toUpperCase();return J},p.delay=function(O,N,Z){setImmediate(function(){O.apply(Z||null,N||[])})},p.inherits=function(O,N){function Z(){}Z.prototype=N.prototype,O.prototype=new Z},p.extend=function(){var O,N,Z={};for(O=0;O<arguments.length;O++)for(N in arguments[O])Object.prototype.hasOwnProperty.call(arguments[O],N)&&Z[N]===void 0&&(Z[N]=arguments[O][N]);return Z},p.prepareContent=function(O,N,Z,J,X){return C.Promise.resolve(N).then(function(pe){return b.blob&&(pe instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(pe))!==-1)&&typeof FileReader<"u"?new C.Promise(function(ge,ve){var re=new FileReader;re.onload=function(Ce){ge(Ce.target.result)},re.onerror=function(Ce){ve(Ce.target.error)},re.readAsArrayBuffer(pe)}):pe}).then(function(pe){var ge=p.getTypeOf(pe);return ge?(ge==="arraybuffer"?pe=p.transformTo("uint8array",pe):ge==="string"&&(X?pe=_.decode(pe):Z&&J!==!0&&(pe=(function(ve){return D(ve,b.uint8array?new Uint8Array(ve.length):new Array(ve.length))})(pe))),pe):C.Promise.reject(new Error("Can't read the data of '"+O+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(l,f,p){var b=l("./reader/readerFor"),_=l("./utils"),s=l("./signature"),C=l("./zipEntry"),M=l("./support");function D(B){this.files=[],this.loadOptions=B}D.prototype={checkSignature:function(B){if(!this.reader.readAndCheckSignature(B)){this.reader.index-=4;var U=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+_.pretty(U)+", expected "+_.pretty(B)+")")}},isSignature:function(B,U){var j=this.reader.index;this.reader.setIndex(B);var H=this.reader.readString(4)===U;return this.reader.setIndex(j),H},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var B=this.reader.readData(this.zipCommentLength),U=M.uint8array?"uint8array":"array",j=_.transformTo(U,B);this.zipComment=this.loadOptions.decodeFileName(j)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var B,U,j,H=this.zip64EndOfCentralSize-44;0<H;)B=this.reader.readInt(2),U=this.reader.readInt(4),j=this.reader.readData(U),this.zip64ExtensibleData[B]={id:B,length:U,value:j}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var B,U;for(B=0;B<this.files.length;B++)U=this.files[B],this.reader.setIndex(U.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),U.readLocalPart(this.reader),U.handleUTF8(),U.processAttributes()},readCentralDir:function(){var B;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(B=new C({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(B);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var B=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(B<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(B);var U=B;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===_.MAX_VALUE_16BITS||this.diskWithCentralDirStart===_.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===_.MAX_VALUE_16BITS||this.centralDirRecords===_.MAX_VALUE_16BITS||this.centralDirSize===_.MAX_VALUE_32BITS||this.centralDirOffset===_.MAX_VALUE_32BITS){if(this.zip64=!0,(B=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(B),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var j=this.centralDirOffset+this.centralDirSize;this.zip64&&(j+=20,j+=12+this.zip64EndOfCentralSize);var H=U-j;if(0<H)this.isSignature(U,s.CENTRAL_FILE_HEADER)||(this.reader.zero=H);else if(H<0)throw new Error("Corrupted zip: missing "+Math.abs(H)+" bytes.")},prepareReader:function(B){this.reader=b(B)},load:function(B){this.prepareReader(B),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},f.exports=D},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(l,f,p){var b=l("./reader/readerFor"),_=l("./utils"),s=l("./compressedObject"),C=l("./crc32"),M=l("./utf8"),D=l("./compressions"),B=l("./support");function U(j,H){this.options=j,this.loadOptions=H}U.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(j){var H,O;if(j.skip(22),this.fileNameLength=j.readInt(2),O=j.readInt(2),this.fileName=j.readData(this.fileNameLength),j.skip(O),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((H=(function(N){for(var Z in D)if(Object.prototype.hasOwnProperty.call(D,Z)&&D[Z].magic===N)return D[Z];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+_.pretty(this.compressionMethod)+" unknown (inner file : "+_.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,H,j.readData(this.compressedSize))},readCentralPart:function(j){this.versionMadeBy=j.readInt(2),j.skip(2),this.bitFlag=j.readInt(2),this.compressionMethod=j.readString(2),this.date=j.readDate(),this.crc32=j.readInt(4),this.compressedSize=j.readInt(4),this.uncompressedSize=j.readInt(4);var H=j.readInt(2);if(this.extraFieldsLength=j.readInt(2),this.fileCommentLength=j.readInt(2),this.diskNumberStart=j.readInt(2),this.internalFileAttributes=j.readInt(2),this.externalFileAttributes=j.readInt(4),this.localHeaderOffset=j.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");j.skip(H),this.readExtraFields(j),this.parseZIP64ExtraField(j),this.fileComment=j.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var j=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),j==0&&(this.dosPermissions=63&this.externalFileAttributes),j==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var j=b(this.extraFields[1].value);this.uncompressedSize===_.MAX_VALUE_32BITS&&(this.uncompressedSize=j.readInt(8)),this.compressedSize===_.MAX_VALUE_32BITS&&(this.compressedSize=j.readInt(8)),this.localHeaderOffset===_.MAX_VALUE_32BITS&&(this.localHeaderOffset=j.readInt(8)),this.diskNumberStart===_.MAX_VALUE_32BITS&&(this.diskNumberStart=j.readInt(4))}},readExtraFields:function(j){var H,O,N,Z=j.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});j.index+4<Z;)H=j.readInt(2),O=j.readInt(2),N=j.readData(O),this.extraFields[H]={id:H,length:O,value:N};j.setIndex(Z)},handleUTF8:function(){var j=B.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=M.utf8decode(this.fileName),this.fileCommentStr=M.utf8decode(this.fileComment);else{var H=this.findExtraFieldUnicodePath();if(H!==null)this.fileNameStr=H;else{var O=_.transformTo(j,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(O)}var N=this.findExtraFieldUnicodeComment();if(N!==null)this.fileCommentStr=N;else{var Z=_.transformTo(j,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(Z)}}},findExtraFieldUnicodePath:function(){var j=this.extraFields[28789];if(j){var H=b(j.value);return H.readInt(1)!==1||C(this.fileName)!==H.readInt(4)?null:M.utf8decode(H.readData(j.length-5))}return null},findExtraFieldUnicodeComment:function(){var j=this.extraFields[25461];if(j){var H=b(j.value);return H.readInt(1)!==1||C(this.fileComment)!==H.readInt(4)?null:M.utf8decode(H.readData(j.length-5))}return null}},f.exports=U},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(l,f,p){function b(H,O,N){this.name=H,this.dir=N.dir,this.date=N.date,this.comment=N.comment,this.unixPermissions=N.unixPermissions,this.dosPermissions=N.dosPermissions,this._data=O,this._dataBinary=N.binary,this.options={compression:N.compression,compressionOptions:N.compressionOptions}}var _=l("./stream/StreamHelper"),s=l("./stream/DataWorker"),C=l("./utf8"),M=l("./compressedObject"),D=l("./stream/GenericWorker");b.prototype={internalStream:function(H){var O=null,N="string";try{if(!H)throw new Error("No output type specified.");var Z=(N=H.toLowerCase())==="string"||N==="text";N!=="binarystring"&&N!=="text"||(N="string"),O=this._decompressWorker();var J=!this._dataBinary;J&&!Z&&(O=O.pipe(new C.Utf8EncodeWorker)),!J&&Z&&(O=O.pipe(new C.Utf8DecodeWorker))}catch(X){(O=new D("error")).error(X)}return new _(O,N,"")},async:function(H,O){return this.internalStream(H).accumulate(O)},nodeStream:function(H,O){return this.internalStream(H||"nodebuffer").toNodejsStream(O)},_compressWorker:function(H,O){if(this._data instanceof M&&this._data.compression.magic===H.magic)return this._data.getCompressedWorker();var N=this._decompressWorker();return this._dataBinary||(N=N.pipe(new C.Utf8EncodeWorker)),M.createWorkerFrom(N,H,O)},_decompressWorker:function(){return this._data instanceof M?this._data.getContentWorker():this._data instanceof D?this._data:new s(this._data)}};for(var B=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],U=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},j=0;j<B.length;j++)b.prototype[B[j]]=U;f.exports=b},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(l,f,p){(function(b){var _,s,C=b.MutationObserver||b.WebKitMutationObserver;if(C){var M=0,D=new C(H),B=b.document.createTextNode("");D.observe(B,{characterData:!0}),_=function(){B.data=M=++M%2}}else if(b.setImmediate||b.MessageChannel===void 0)_="document"in b&&"onreadystatechange"in b.document.createElement("script")?function(){var O=b.document.createElement("script");O.onreadystatechange=function(){H(),O.onreadystatechange=null,O.parentNode.removeChild(O),O=null},b.document.documentElement.appendChild(O)}:function(){setTimeout(H,0)};else{var U=new b.MessageChannel;U.port1.onmessage=H,_=function(){U.port2.postMessage(0)}}var j=[];function H(){var O,N;s=!0;for(var Z=j.length;Z;){for(N=j,j=[],O=-1;++O<Z;)N[O]();Z=j.length}s=!1}f.exports=function(O){j.push(O)!==1||s||_()}}).call(this,typeof xd<"u"?xd:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(l,f,p){var b=l("immediate");function _(){}var s={},C=["REJECTED"],M=["FULFILLED"],D=["PENDING"];function B(Z){if(typeof Z!="function")throw new TypeError("resolver must be a function");this.state=D,this.queue=[],this.outcome=void 0,Z!==_&&O(this,Z)}function U(Z,J,X){this.promise=Z,typeof J=="function"&&(this.onFulfilled=J,this.callFulfilled=this.otherCallFulfilled),typeof X=="function"&&(this.onRejected=X,this.callRejected=this.otherCallRejected)}function j(Z,J,X){b(function(){var pe;try{pe=J(X)}catch(ge){return s.reject(Z,ge)}pe===Z?s.reject(Z,new TypeError("Cannot resolve promise with itself")):s.resolve(Z,pe)})}function H(Z){var J=Z&&Z.then;if(Z&&(typeof Z=="object"||typeof Z=="function")&&typeof J=="function")return function(){J.apply(Z,arguments)}}function O(Z,J){var X=!1;function pe(re){X||(X=!0,s.reject(Z,re))}function ge(re){X||(X=!0,s.resolve(Z,re))}var ve=N(function(){J(ge,pe)});ve.status==="error"&&pe(ve.value)}function N(Z,J){var X={};try{X.value=Z(J),X.status="success"}catch(pe){X.status="error",X.value=pe}return X}(f.exports=B).prototype.finally=function(Z){if(typeof Z!="function")return this;var J=this.constructor;return this.then(function(X){return J.resolve(Z()).then(function(){return X})},function(X){return J.resolve(Z()).then(function(){throw X})})},B.prototype.catch=function(Z){return this.then(null,Z)},B.prototype.then=function(Z,J){if(typeof Z!="function"&&this.state===M||typeof J!="function"&&this.state===C)return this;var X=new this.constructor(_);return this.state!==D?j(X,this.state===M?Z:J,this.outcome):this.queue.push(new U(X,Z,J)),X},U.prototype.callFulfilled=function(Z){s.resolve(this.promise,Z)},U.prototype.otherCallFulfilled=function(Z){j(this.promise,this.onFulfilled,Z)},U.prototype.callRejected=function(Z){s.reject(this.promise,Z)},U.prototype.otherCallRejected=function(Z){j(this.promise,this.onRejected,Z)},s.resolve=function(Z,J){var X=N(H,J);if(X.status==="error")return s.reject(Z,X.value);var pe=X.value;if(pe)O(Z,pe);else{Z.state=M,Z.outcome=J;for(var ge=-1,ve=Z.queue.length;++ge<ve;)Z.queue[ge].callFulfilled(J)}return Z},s.reject=function(Z,J){Z.state=C,Z.outcome=J;for(var X=-1,pe=Z.queue.length;++X<pe;)Z.queue[X].callRejected(J);return Z},B.resolve=function(Z){return Z instanceof this?Z:s.resolve(new this(_),Z)},B.reject=function(Z){var J=new this(_);return s.reject(J,Z)},B.all=function(Z){var J=this;if(Object.prototype.toString.call(Z)!=="[object Array]")return this.reject(new TypeError("must be an array"));var X=Z.length,pe=!1;if(!X)return this.resolve([]);for(var ge=new Array(X),ve=0,re=-1,Ce=new this(_);++re<X;)xe(Z[re],re);return Ce;function xe(Ge,$e){J.resolve(Ge).then(function(de){ge[$e]=de,++ve!==X||pe||(pe=!0,s.resolve(Ce,ge))},function(de){pe||(pe=!0,s.reject(Ce,de))})}},B.race=function(Z){var J=this;if(Object.prototype.toString.call(Z)!=="[object Array]")return this.reject(new TypeError("must be an array"));var X=Z.length,pe=!1;if(!X)return this.resolve([]);for(var ge=-1,ve=new this(_);++ge<X;)re=Z[ge],J.resolve(re).then(function(Ce){pe||(pe=!0,s.resolve(ve,Ce))},function(Ce){pe||(pe=!0,s.reject(ve,Ce))});var re;return ve}},{immediate:36}],38:[function(l,f,p){var b={};(0,l("./lib/utils/common").assign)(b,l("./lib/deflate"),l("./lib/inflate"),l("./lib/zlib/constants")),f.exports=b},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(l,f,p){var b=l("./zlib/deflate"),_=l("./utils/common"),s=l("./utils/strings"),C=l("./zlib/messages"),M=l("./zlib/zstream"),D=Object.prototype.toString,B=0,U=-1,j=0,H=8;function O(Z){if(!(this instanceof O))return new O(Z);this.options=_.assign({level:U,method:H,chunkSize:16384,windowBits:15,memLevel:8,strategy:j,to:""},Z||{});var J=this.options;J.raw&&0<J.windowBits?J.windowBits=-J.windowBits:J.gzip&&0<J.windowBits&&J.windowBits<16&&(J.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new M,this.strm.avail_out=0;var X=b.deflateInit2(this.strm,J.level,J.method,J.windowBits,J.memLevel,J.strategy);if(X!==B)throw new Error(C[X]);if(J.header&&b.deflateSetHeader(this.strm,J.header),J.dictionary){var pe;if(pe=typeof J.dictionary=="string"?s.string2buf(J.dictionary):D.call(J.dictionary)==="[object ArrayBuffer]"?new Uint8Array(J.dictionary):J.dictionary,(X=b.deflateSetDictionary(this.strm,pe))!==B)throw new Error(C[X]);this._dict_set=!0}}function N(Z,J){var X=new O(J);if(X.push(Z,!0),X.err)throw X.msg||C[X.err];return X.result}O.prototype.push=function(Z,J){var X,pe,ge=this.strm,ve=this.options.chunkSize;if(this.ended)return!1;pe=J===~~J?J:J===!0?4:0,typeof Z=="string"?ge.input=s.string2buf(Z):D.call(Z)==="[object ArrayBuffer]"?ge.input=new Uint8Array(Z):ge.input=Z,ge.next_in=0,ge.avail_in=ge.input.length;do{if(ge.avail_out===0&&(ge.output=new _.Buf8(ve),ge.next_out=0,ge.avail_out=ve),(X=b.deflate(ge,pe))!==1&&X!==B)return this.onEnd(X),!(this.ended=!0);ge.avail_out!==0&&(ge.avail_in!==0||pe!==4&&pe!==2)||(this.options.to==="string"?this.onData(s.buf2binstring(_.shrinkBuf(ge.output,ge.next_out))):this.onData(_.shrinkBuf(ge.output,ge.next_out)))}while((0<ge.avail_in||ge.avail_out===0)&&X!==1);return pe===4?(X=b.deflateEnd(this.strm),this.onEnd(X),this.ended=!0,X===B):pe!==2||(this.onEnd(B),!(ge.avail_out=0))},O.prototype.onData=function(Z){this.chunks.push(Z)},O.prototype.onEnd=function(Z){Z===B&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=_.flattenChunks(this.chunks)),this.chunks=[],this.err=Z,this.msg=this.strm.msg},p.Deflate=O,p.deflate=N,p.deflateRaw=function(Z,J){return(J=J||{}).raw=!0,N(Z,J)},p.gzip=function(Z,J){return(J=J||{}).gzip=!0,N(Z,J)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(l,f,p){var b=l("./zlib/inflate"),_=l("./utils/common"),s=l("./utils/strings"),C=l("./zlib/constants"),M=l("./zlib/messages"),D=l("./zlib/zstream"),B=l("./zlib/gzheader"),U=Object.prototype.toString;function j(O){if(!(this instanceof j))return new j(O);this.options=_.assign({chunkSize:16384,windowBits:0,to:""},O||{});var N=this.options;N.raw&&0<=N.windowBits&&N.windowBits<16&&(N.windowBits=-N.windowBits,N.windowBits===0&&(N.windowBits=-15)),!(0<=N.windowBits&&N.windowBits<16)||O&&O.windowBits||(N.windowBits+=32),15<N.windowBits&&N.windowBits<48&&(15&N.windowBits)==0&&(N.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new D,this.strm.avail_out=0;var Z=b.inflateInit2(this.strm,N.windowBits);if(Z!==C.Z_OK)throw new Error(M[Z]);this.header=new B,b.inflateGetHeader(this.strm,this.header)}function H(O,N){var Z=new j(N);if(Z.push(O,!0),Z.err)throw Z.msg||M[Z.err];return Z.result}j.prototype.push=function(O,N){var Z,J,X,pe,ge,ve,re=this.strm,Ce=this.options.chunkSize,xe=this.options.dictionary,Ge=!1;if(this.ended)return!1;J=N===~~N?N:N===!0?C.Z_FINISH:C.Z_NO_FLUSH,typeof O=="string"?re.input=s.binstring2buf(O):U.call(O)==="[object ArrayBuffer]"?re.input=new Uint8Array(O):re.input=O,re.next_in=0,re.avail_in=re.input.length;do{if(re.avail_out===0&&(re.output=new _.Buf8(Ce),re.next_out=0,re.avail_out=Ce),(Z=b.inflate(re,C.Z_NO_FLUSH))===C.Z_NEED_DICT&&xe&&(ve=typeof xe=="string"?s.string2buf(xe):U.call(xe)==="[object ArrayBuffer]"?new Uint8Array(xe):xe,Z=b.inflateSetDictionary(this.strm,ve)),Z===C.Z_BUF_ERROR&&Ge===!0&&(Z=C.Z_OK,Ge=!1),Z!==C.Z_STREAM_END&&Z!==C.Z_OK)return this.onEnd(Z),!(this.ended=!0);re.next_out&&(re.avail_out!==0&&Z!==C.Z_STREAM_END&&(re.avail_in!==0||J!==C.Z_FINISH&&J!==C.Z_SYNC_FLUSH)||(this.options.to==="string"?(X=s.utf8border(re.output,re.next_out),pe=re.next_out-X,ge=s.buf2string(re.output,X),re.next_out=pe,re.avail_out=Ce-pe,pe&&_.arraySet(re.output,re.output,X,pe,0),this.onData(ge)):this.onData(_.shrinkBuf(re.output,re.next_out)))),re.avail_in===0&&re.avail_out===0&&(Ge=!0)}while((0<re.avail_in||re.avail_out===0)&&Z!==C.Z_STREAM_END);return Z===C.Z_STREAM_END&&(J=C.Z_FINISH),J===C.Z_FINISH?(Z=b.inflateEnd(this.strm),this.onEnd(Z),this.ended=!0,Z===C.Z_OK):J!==C.Z_SYNC_FLUSH||(this.onEnd(C.Z_OK),!(re.avail_out=0))},j.prototype.onData=function(O){this.chunks.push(O)},j.prototype.onEnd=function(O){O===C.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=_.flattenChunks(this.chunks)),this.chunks=[],this.err=O,this.msg=this.strm.msg},p.Inflate=j,p.inflate=H,p.inflateRaw=function(O,N){return(N=N||{}).raw=!0,H(O,N)},p.ungzip=H},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(l,f,p){var b=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";p.assign=function(C){for(var M=Array.prototype.slice.call(arguments,1);M.length;){var D=M.shift();if(D){if(typeof D!="object")throw new TypeError(D+"must be non-object");for(var B in D)D.hasOwnProperty(B)&&(C[B]=D[B])}}return C},p.shrinkBuf=function(C,M){return C.length===M?C:C.subarray?C.subarray(0,M):(C.length=M,C)};var _={arraySet:function(C,M,D,B,U){if(M.subarray&&C.subarray)C.set(M.subarray(D,D+B),U);else for(var j=0;j<B;j++)C[U+j]=M[D+j]},flattenChunks:function(C){var M,D,B,U,j,H;for(M=B=0,D=C.length;M<D;M++)B+=C[M].length;for(H=new Uint8Array(B),M=U=0,D=C.length;M<D;M++)j=C[M],H.set(j,U),U+=j.length;return H}},s={arraySet:function(C,M,D,B,U){for(var j=0;j<B;j++)C[U+j]=M[D+j]},flattenChunks:function(C){return[].concat.apply([],C)}};p.setTyped=function(C){C?(p.Buf8=Uint8Array,p.Buf16=Uint16Array,p.Buf32=Int32Array,p.assign(p,_)):(p.Buf8=Array,p.Buf16=Array,p.Buf32=Array,p.assign(p,s))},p.setTyped(b)},{}],42:[function(l,f,p){var b=l("./common"),_=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch{_=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{s=!1}for(var C=new b.Buf8(256),M=0;M<256;M++)C[M]=252<=M?6:248<=M?5:240<=M?4:224<=M?3:192<=M?2:1;function D(B,U){if(U<65537&&(B.subarray&&s||!B.subarray&&_))return String.fromCharCode.apply(null,b.shrinkBuf(B,U));for(var j="",H=0;H<U;H++)j+=String.fromCharCode(B[H]);return j}C[254]=C[254]=1,p.string2buf=function(B){var U,j,H,O,N,Z=B.length,J=0;for(O=0;O<Z;O++)(64512&(j=B.charCodeAt(O)))==55296&&O+1<Z&&(64512&(H=B.charCodeAt(O+1)))==56320&&(j=65536+(j-55296<<10)+(H-56320),O++),J+=j<128?1:j<2048?2:j<65536?3:4;for(U=new b.Buf8(J),O=N=0;N<J;O++)(64512&(j=B.charCodeAt(O)))==55296&&O+1<Z&&(64512&(H=B.charCodeAt(O+1)))==56320&&(j=65536+(j-55296<<10)+(H-56320),O++),j<128?U[N++]=j:(j<2048?U[N++]=192|j>>>6:(j<65536?U[N++]=224|j>>>12:(U[N++]=240|j>>>18,U[N++]=128|j>>>12&63),U[N++]=128|j>>>6&63),U[N++]=128|63&j);return U},p.buf2binstring=function(B){return D(B,B.length)},p.binstring2buf=function(B){for(var U=new b.Buf8(B.length),j=0,H=U.length;j<H;j++)U[j]=B.charCodeAt(j);return U},p.buf2string=function(B,U){var j,H,O,N,Z=U||B.length,J=new Array(2*Z);for(j=H=0;j<Z;)if((O=B[j++])<128)J[H++]=O;else if(4<(N=C[O]))J[H++]=65533,j+=N-1;else{for(O&=N===2?31:N===3?15:7;1<N&&j<Z;)O=O<<6|63&B[j++],N--;1<N?J[H++]=65533:O<65536?J[H++]=O:(O-=65536,J[H++]=55296|O>>10&1023,J[H++]=56320|1023&O)}return D(J,H)},p.utf8border=function(B,U){var j;for((U=U||B.length)>B.length&&(U=B.length),j=U-1;0<=j&&(192&B[j])==128;)j--;return j<0||j===0?U:j+C[B[j]]>U?j:U}},{"./common":41}],43:[function(l,f,p){f.exports=function(b,_,s,C){for(var M=65535&b|0,D=b>>>16&65535|0,B=0;s!==0;){for(s-=B=2e3<s?2e3:s;D=D+(M=M+_[C++]|0)|0,--B;);M%=65521,D%=65521}return M|D<<16|0}},{}],44:[function(l,f,p){f.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(l,f,p){var b=(function(){for(var _,s=[],C=0;C<256;C++){_=C;for(var M=0;M<8;M++)_=1&_?3988292384^_>>>1:_>>>1;s[C]=_}return s})();f.exports=function(_,s,C,M){var D=b,B=M+C;_^=-1;for(var U=M;U<B;U++)_=_>>>8^D[255&(_^s[U])];return-1^_}},{}],46:[function(l,f,p){var b,_=l("../utils/common"),s=l("./trees"),C=l("./adler32"),M=l("./crc32"),D=l("./messages"),B=0,U=4,j=0,H=-2,O=-1,N=4,Z=2,J=8,X=9,pe=286,ge=30,ve=19,re=2*pe+1,Ce=15,xe=3,Ge=258,$e=Ge+xe+1,de=42,nt=113,le=1,ct=2,et=3,He=4;function $t(se,Mt){return se.msg=D[Mt],Mt}function Oe(se){return(se<<1)-(4<se?9:0)}function It(se){for(var Mt=se.length;0<=--Mt;)se[Mt]=0}function me(se){var Mt=se.state,yt=Mt.pending;yt>se.avail_out&&(yt=se.avail_out),yt!==0&&(_.arraySet(se.output,Mt.pending_buf,Mt.pending_out,yt,se.next_out),se.next_out+=yt,Mt.pending_out+=yt,se.total_out+=yt,se.avail_out-=yt,Mt.pending-=yt,Mt.pending===0&&(Mt.pending_out=0))}function ne(se,Mt){s._tr_flush_block(se,0<=se.block_start?se.block_start:-1,se.strstart-se.block_start,Mt),se.block_start=se.strstart,me(se.strm)}function Ue(se,Mt){se.pending_buf[se.pending++]=Mt}function Fe(se,Mt){se.pending_buf[se.pending++]=Mt>>>8&255,se.pending_buf[se.pending++]=255&Mt}function Re(se,Mt){var yt,Ee,Ne=se.max_chain_length,pt=se.strstart,Jt=se.prev_length,Kt=se.nice_match,Et=se.strstart>se.w_size-$e?se.strstart-(se.w_size-$e):0,lr=se.window,pr=se.w_mask,ir=se.prev,st=se.strstart+Ge,fe=lr[pt+Jt-1],he=lr[pt+Jt];se.prev_length>=se.good_match&&(Ne>>=2),Kt>se.lookahead&&(Kt=se.lookahead);do if(lr[(yt=Mt)+Jt]===he&&lr[yt+Jt-1]===fe&&lr[yt]===lr[pt]&&lr[++yt]===lr[pt+1]){pt+=2,yt++;do;while(lr[++pt]===lr[++yt]&&lr[++pt]===lr[++yt]&&lr[++pt]===lr[++yt]&&lr[++pt]===lr[++yt]&&lr[++pt]===lr[++yt]&&lr[++pt]===lr[++yt]&&lr[++pt]===lr[++yt]&&lr[++pt]===lr[++yt]&&pt<st);if(Ee=Ge-(st-pt),pt=st-Ge,Jt<Ee){if(se.match_start=Mt,Kt<=(Jt=Ee))break;fe=lr[pt+Jt-1],he=lr[pt+Jt]}}while((Mt=ir[Mt&pr])>Et&&--Ne!=0);return Jt<=se.lookahead?Jt:se.lookahead}function bt(se){var Mt,yt,Ee,Ne,pt,Jt,Kt,Et,lr,pr,ir=se.w_size;do{if(Ne=se.window_size-se.lookahead-se.strstart,se.strstart>=ir+(ir-$e)){for(_.arraySet(se.window,se.window,ir,ir,0),se.match_start-=ir,se.strstart-=ir,se.block_start-=ir,Mt=yt=se.hash_size;Ee=se.head[--Mt],se.head[Mt]=ir<=Ee?Ee-ir:0,--yt;);for(Mt=yt=ir;Ee=se.prev[--Mt],se.prev[Mt]=ir<=Ee?Ee-ir:0,--yt;);Ne+=ir}if(se.strm.avail_in===0)break;if(Jt=se.strm,Kt=se.window,Et=se.strstart+se.lookahead,lr=Ne,pr=void 0,pr=Jt.avail_in,lr<pr&&(pr=lr),yt=pr===0?0:(Jt.avail_in-=pr,_.arraySet(Kt,Jt.input,Jt.next_in,pr,Et),Jt.state.wrap===1?Jt.adler=C(Jt.adler,Kt,pr,Et):Jt.state.wrap===2&&(Jt.adler=M(Jt.adler,Kt,pr,Et)),Jt.next_in+=pr,Jt.total_in+=pr,pr),se.lookahead+=yt,se.lookahead+se.insert>=xe)for(pt=se.strstart-se.insert,se.ins_h=se.window[pt],se.ins_h=(se.ins_h<<se.hash_shift^se.window[pt+1])&se.hash_mask;se.insert&&(se.ins_h=(se.ins_h<<se.hash_shift^se.window[pt+xe-1])&se.hash_mask,se.prev[pt&se.w_mask]=se.head[se.ins_h],se.head[se.ins_h]=pt,pt++,se.insert--,!(se.lookahead+se.insert<xe)););}while(se.lookahead<$e&&se.strm.avail_in!==0)}function Gt(se,Mt){for(var yt,Ee;;){if(se.lookahead<$e){if(bt(se),se.lookahead<$e&&Mt===B)return le;if(se.lookahead===0)break}if(yt=0,se.lookahead>=xe&&(se.ins_h=(se.ins_h<<se.hash_shift^se.window[se.strstart+xe-1])&se.hash_mask,yt=se.prev[se.strstart&se.w_mask]=se.head[se.ins_h],se.head[se.ins_h]=se.strstart),yt!==0&&se.strstart-yt<=se.w_size-$e&&(se.match_length=Re(se,yt)),se.match_length>=xe)if(Ee=s._tr_tally(se,se.strstart-se.match_start,se.match_length-xe),se.lookahead-=se.match_length,se.match_length<=se.max_lazy_match&&se.lookahead>=xe){for(se.match_length--;se.strstart++,se.ins_h=(se.ins_h<<se.hash_shift^se.window[se.strstart+xe-1])&se.hash_mask,yt=se.prev[se.strstart&se.w_mask]=se.head[se.ins_h],se.head[se.ins_h]=se.strstart,--se.match_length!=0;);se.strstart++}else se.strstart+=se.match_length,se.match_length=0,se.ins_h=se.window[se.strstart],se.ins_h=(se.ins_h<<se.hash_shift^se.window[se.strstart+1])&se.hash_mask;else Ee=s._tr_tally(se,0,se.window[se.strstart]),se.lookahead--,se.strstart++;if(Ee&&(ne(se,!1),se.strm.avail_out===0))return le}return se.insert=se.strstart<xe-1?se.strstart:xe-1,Mt===U?(ne(se,!0),se.strm.avail_out===0?et:He):se.last_lit&&(ne(se,!1),se.strm.avail_out===0)?le:ct}function Vt(se,Mt){for(var yt,Ee,Ne;;){if(se.lookahead<$e){if(bt(se),se.lookahead<$e&&Mt===B)return le;if(se.lookahead===0)break}if(yt=0,se.lookahead>=xe&&(se.ins_h=(se.ins_h<<se.hash_shift^se.window[se.strstart+xe-1])&se.hash_mask,yt=se.prev[se.strstart&se.w_mask]=se.head[se.ins_h],se.head[se.ins_h]=se.strstart),se.prev_length=se.match_length,se.prev_match=se.match_start,se.match_length=xe-1,yt!==0&&se.prev_length<se.max_lazy_match&&se.strstart-yt<=se.w_size-$e&&(se.match_length=Re(se,yt),se.match_length<=5&&(se.strategy===1||se.match_length===xe&&4096<se.strstart-se.match_start)&&(se.match_length=xe-1)),se.prev_length>=xe&&se.match_length<=se.prev_length){for(Ne=se.strstart+se.lookahead-xe,Ee=s._tr_tally(se,se.strstart-1-se.prev_match,se.prev_length-xe),se.lookahead-=se.prev_length-1,se.prev_length-=2;++se.strstart<=Ne&&(se.ins_h=(se.ins_h<<se.hash_shift^se.window[se.strstart+xe-1])&se.hash_mask,yt=se.prev[se.strstart&se.w_mask]=se.head[se.ins_h],se.head[se.ins_h]=se.strstart),--se.prev_length!=0;);if(se.match_available=0,se.match_length=xe-1,se.strstart++,Ee&&(ne(se,!1),se.strm.avail_out===0))return le}else if(se.match_available){if((Ee=s._tr_tally(se,0,se.window[se.strstart-1]))&&ne(se,!1),se.strstart++,se.lookahead--,se.strm.avail_out===0)return le}else se.match_available=1,se.strstart++,se.lookahead--}return se.match_available&&(Ee=s._tr_tally(se,0,se.window[se.strstart-1]),se.match_available=0),se.insert=se.strstart<xe-1?se.strstart:xe-1,Mt===U?(ne(se,!0),se.strm.avail_out===0?et:He):se.last_lit&&(ne(se,!1),se.strm.avail_out===0)?le:ct}function Bt(se,Mt,yt,Ee,Ne){this.good_length=se,this.max_lazy=Mt,this.nice_length=yt,this.max_chain=Ee,this.func=Ne}function Yt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=J,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new _.Buf16(2*re),this.dyn_dtree=new _.Buf16(2*(2*ge+1)),this.bl_tree=new _.Buf16(2*(2*ve+1)),It(this.dyn_ltree),It(this.dyn_dtree),It(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new _.Buf16(Ce+1),this.heap=new _.Buf16(2*pe+1),It(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new _.Buf16(2*pe+1),It(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Or(se){var Mt;return se&&se.state?(se.total_in=se.total_out=0,se.data_type=Z,(Mt=se.state).pending=0,Mt.pending_out=0,Mt.wrap<0&&(Mt.wrap=-Mt.wrap),Mt.status=Mt.wrap?de:nt,se.adler=Mt.wrap===2?0:1,Mt.last_flush=B,s._tr_init(Mt),j):$t(se,H)}function Ye(se){var Mt=Or(se);return Mt===j&&(function(yt){yt.window_size=2*yt.w_size,It(yt.head),yt.max_lazy_match=b[yt.level].max_lazy,yt.good_match=b[yt.level].good_length,yt.nice_match=b[yt.level].nice_length,yt.max_chain_length=b[yt.level].max_chain,yt.strstart=0,yt.block_start=0,yt.lookahead=0,yt.insert=0,yt.match_length=yt.prev_length=xe-1,yt.match_available=0,yt.ins_h=0})(se.state),Mt}function pn(se,Mt,yt,Ee,Ne,pt){if(!se)return H;var Jt=1;if(Mt===O&&(Mt=6),Ee<0?(Jt=0,Ee=-Ee):15<Ee&&(Jt=2,Ee-=16),Ne<1||X<Ne||yt!==J||Ee<8||15<Ee||Mt<0||9<Mt||pt<0||N<pt)return $t(se,H);Ee===8&&(Ee=9);var Kt=new Yt;return(se.state=Kt).strm=se,Kt.wrap=Jt,Kt.gzhead=null,Kt.w_bits=Ee,Kt.w_size=1<<Kt.w_bits,Kt.w_mask=Kt.w_size-1,Kt.hash_bits=Ne+7,Kt.hash_size=1<<Kt.hash_bits,Kt.hash_mask=Kt.hash_size-1,Kt.hash_shift=~~((Kt.hash_bits+xe-1)/xe),Kt.window=new _.Buf8(2*Kt.w_size),Kt.head=new _.Buf16(Kt.hash_size),Kt.prev=new _.Buf16(Kt.w_size),Kt.lit_bufsize=1<<Ne+6,Kt.pending_buf_size=4*Kt.lit_bufsize,Kt.pending_buf=new _.Buf8(Kt.pending_buf_size),Kt.d_buf=1*Kt.lit_bufsize,Kt.l_buf=3*Kt.lit_bufsize,Kt.level=Mt,Kt.strategy=pt,Kt.method=yt,Ye(se)}b=[new Bt(0,0,0,0,function(se,Mt){var yt=65535;for(yt>se.pending_buf_size-5&&(yt=se.pending_buf_size-5);;){if(se.lookahead<=1){if(bt(se),se.lookahead===0&&Mt===B)return le;if(se.lookahead===0)break}se.strstart+=se.lookahead,se.lookahead=0;var Ee=se.block_start+yt;if((se.strstart===0||se.strstart>=Ee)&&(se.lookahead=se.strstart-Ee,se.strstart=Ee,ne(se,!1),se.strm.avail_out===0)||se.strstart-se.block_start>=se.w_size-$e&&(ne(se,!1),se.strm.avail_out===0))return le}return se.insert=0,Mt===U?(ne(se,!0),se.strm.avail_out===0?et:He):(se.strstart>se.block_start&&(ne(se,!1),se.strm.avail_out),le)}),new Bt(4,4,8,4,Gt),new Bt(4,5,16,8,Gt),new Bt(4,6,32,32,Gt),new Bt(4,4,16,16,Vt),new Bt(8,16,32,32,Vt),new Bt(8,16,128,128,Vt),new Bt(8,32,128,256,Vt),new Bt(32,128,258,1024,Vt),new Bt(32,258,258,4096,Vt)],p.deflateInit=function(se,Mt){return pn(se,Mt,J,15,8,0)},p.deflateInit2=pn,p.deflateReset=Ye,p.deflateResetKeep=Or,p.deflateSetHeader=function(se,Mt){return se&&se.state?se.state.wrap!==2?H:(se.state.gzhead=Mt,j):H},p.deflate=function(se,Mt){var yt,Ee,Ne,pt;if(!se||!se.state||5<Mt||Mt<0)return se?$t(se,H):H;if(Ee=se.state,!se.output||!se.input&&se.avail_in!==0||Ee.status===666&&Mt!==U)return $t(se,se.avail_out===0?-5:H);if(Ee.strm=se,yt=Ee.last_flush,Ee.last_flush=Mt,Ee.status===de)if(Ee.wrap===2)se.adler=0,Ue(Ee,31),Ue(Ee,139),Ue(Ee,8),Ee.gzhead?(Ue(Ee,(Ee.gzhead.text?1:0)+(Ee.gzhead.hcrc?2:0)+(Ee.gzhead.extra?4:0)+(Ee.gzhead.name?8:0)+(Ee.gzhead.comment?16:0)),Ue(Ee,255&Ee.gzhead.time),Ue(Ee,Ee.gzhead.time>>8&255),Ue(Ee,Ee.gzhead.time>>16&255),Ue(Ee,Ee.gzhead.time>>24&255),Ue(Ee,Ee.level===9?2:2<=Ee.strategy||Ee.level<2?4:0),Ue(Ee,255&Ee.gzhead.os),Ee.gzhead.extra&&Ee.gzhead.extra.length&&(Ue(Ee,255&Ee.gzhead.extra.length),Ue(Ee,Ee.gzhead.extra.length>>8&255)),Ee.gzhead.hcrc&&(se.adler=M(se.adler,Ee.pending_buf,Ee.pending,0)),Ee.gzindex=0,Ee.status=69):(Ue(Ee,0),Ue(Ee,0),Ue(Ee,0),Ue(Ee,0),Ue(Ee,0),Ue(Ee,Ee.level===9?2:2<=Ee.strategy||Ee.level<2?4:0),Ue(Ee,3),Ee.status=nt);else{var Jt=J+(Ee.w_bits-8<<4)<<8;Jt|=(2<=Ee.strategy||Ee.level<2?0:Ee.level<6?1:Ee.level===6?2:3)<<6,Ee.strstart!==0&&(Jt|=32),Jt+=31-Jt%31,Ee.status=nt,Fe(Ee,Jt),Ee.strstart!==0&&(Fe(Ee,se.adler>>>16),Fe(Ee,65535&se.adler)),se.adler=1}if(Ee.status===69)if(Ee.gzhead.extra){for(Ne=Ee.pending;Ee.gzindex<(65535&Ee.gzhead.extra.length)&&(Ee.pending!==Ee.pending_buf_size||(Ee.gzhead.hcrc&&Ee.pending>Ne&&(se.adler=M(se.adler,Ee.pending_buf,Ee.pending-Ne,Ne)),me(se),Ne=Ee.pending,Ee.pending!==Ee.pending_buf_size));)Ue(Ee,255&Ee.gzhead.extra[Ee.gzindex]),Ee.gzindex++;Ee.gzhead.hcrc&&Ee.pending>Ne&&(se.adler=M(se.adler,Ee.pending_buf,Ee.pending-Ne,Ne)),Ee.gzindex===Ee.gzhead.extra.length&&(Ee.gzindex=0,Ee.status=73)}else Ee.status=73;if(Ee.status===73)if(Ee.gzhead.name){Ne=Ee.pending;do{if(Ee.pending===Ee.pending_buf_size&&(Ee.gzhead.hcrc&&Ee.pending>Ne&&(se.adler=M(se.adler,Ee.pending_buf,Ee.pending-Ne,Ne)),me(se),Ne=Ee.pending,Ee.pending===Ee.pending_buf_size)){pt=1;break}pt=Ee.gzindex<Ee.gzhead.name.length?255&Ee.gzhead.name.charCodeAt(Ee.gzindex++):0,Ue(Ee,pt)}while(pt!==0);Ee.gzhead.hcrc&&Ee.pending>Ne&&(se.adler=M(se.adler,Ee.pending_buf,Ee.pending-Ne,Ne)),pt===0&&(Ee.gzindex=0,Ee.status=91)}else Ee.status=91;if(Ee.status===91)if(Ee.gzhead.comment){Ne=Ee.pending;do{if(Ee.pending===Ee.pending_buf_size&&(Ee.gzhead.hcrc&&Ee.pending>Ne&&(se.adler=M(se.adler,Ee.pending_buf,Ee.pending-Ne,Ne)),me(se),Ne=Ee.pending,Ee.pending===Ee.pending_buf_size)){pt=1;break}pt=Ee.gzindex<Ee.gzhead.comment.length?255&Ee.gzhead.comment.charCodeAt(Ee.gzindex++):0,Ue(Ee,pt)}while(pt!==0);Ee.gzhead.hcrc&&Ee.pending>Ne&&(se.adler=M(se.adler,Ee.pending_buf,Ee.pending-Ne,Ne)),pt===0&&(Ee.status=103)}else Ee.status=103;if(Ee.status===103&&(Ee.gzhead.hcrc?(Ee.pending+2>Ee.pending_buf_size&&me(se),Ee.pending+2<=Ee.pending_buf_size&&(Ue(Ee,255&se.adler),Ue(Ee,se.adler>>8&255),se.adler=0,Ee.status=nt)):Ee.status=nt),Ee.pending!==0){if(me(se),se.avail_out===0)return Ee.last_flush=-1,j}else if(se.avail_in===0&&Oe(Mt)<=Oe(yt)&&Mt!==U)return $t(se,-5);if(Ee.status===666&&se.avail_in!==0)return $t(se,-5);if(se.avail_in!==0||Ee.lookahead!==0||Mt!==B&&Ee.status!==666){var Kt=Ee.strategy===2?(function(Et,lr){for(var pr;;){if(Et.lookahead===0&&(bt(Et),Et.lookahead===0)){if(lr===B)return le;break}if(Et.match_length=0,pr=s._tr_tally(Et,0,Et.window[Et.strstart]),Et.lookahead--,Et.strstart++,pr&&(ne(Et,!1),Et.strm.avail_out===0))return le}return Et.insert=0,lr===U?(ne(Et,!0),Et.strm.avail_out===0?et:He):Et.last_lit&&(ne(Et,!1),Et.strm.avail_out===0)?le:ct})(Ee,Mt):Ee.strategy===3?(function(Et,lr){for(var pr,ir,st,fe,he=Et.window;;){if(Et.lookahead<=Ge){if(bt(Et),Et.lookahead<=Ge&&lr===B)return le;if(Et.lookahead===0)break}if(Et.match_length=0,Et.lookahead>=xe&&0<Et.strstart&&(ir=he[st=Et.strstart-1])===he[++st]&&ir===he[++st]&&ir===he[++st]){fe=Et.strstart+Ge;do;while(ir===he[++st]&&ir===he[++st]&&ir===he[++st]&&ir===he[++st]&&ir===he[++st]&&ir===he[++st]&&ir===he[++st]&&ir===he[++st]&&st<fe);Et.match_length=Ge-(fe-st),Et.match_length>Et.lookahead&&(Et.match_length=Et.lookahead)}if(Et.match_length>=xe?(pr=s._tr_tally(Et,1,Et.match_length-xe),Et.lookahead-=Et.match_length,Et.strstart+=Et.match_length,Et.match_length=0):(pr=s._tr_tally(Et,0,Et.window[Et.strstart]),Et.lookahead--,Et.strstart++),pr&&(ne(Et,!1),Et.strm.avail_out===0))return le}return Et.insert=0,lr===U?(ne(Et,!0),Et.strm.avail_out===0?et:He):Et.last_lit&&(ne(Et,!1),Et.strm.avail_out===0)?le:ct})(Ee,Mt):b[Ee.level].func(Ee,Mt);if(Kt!==et&&Kt!==He||(Ee.status=666),Kt===le||Kt===et)return se.avail_out===0&&(Ee.last_flush=-1),j;if(Kt===ct&&(Mt===1?s._tr_align(Ee):Mt!==5&&(s._tr_stored_block(Ee,0,0,!1),Mt===3&&(It(Ee.head),Ee.lookahead===0&&(Ee.strstart=0,Ee.block_start=0,Ee.insert=0))),me(se),se.avail_out===0))return Ee.last_flush=-1,j}return Mt!==U?j:Ee.wrap<=0?1:(Ee.wrap===2?(Ue(Ee,255&se.adler),Ue(Ee,se.adler>>8&255),Ue(Ee,se.adler>>16&255),Ue(Ee,se.adler>>24&255),Ue(Ee,255&se.total_in),Ue(Ee,se.total_in>>8&255),Ue(Ee,se.total_in>>16&255),Ue(Ee,se.total_in>>24&255)):(Fe(Ee,se.adler>>>16),Fe(Ee,65535&se.adler)),me(se),0<Ee.wrap&&(Ee.wrap=-Ee.wrap),Ee.pending!==0?j:1)},p.deflateEnd=function(se){var Mt;return se&&se.state?(Mt=se.state.status)!==de&&Mt!==69&&Mt!==73&&Mt!==91&&Mt!==103&&Mt!==nt&&Mt!==666?$t(se,H):(se.state=null,Mt===nt?$t(se,-3):j):H},p.deflateSetDictionary=function(se,Mt){var yt,Ee,Ne,pt,Jt,Kt,Et,lr,pr=Mt.length;if(!se||!se.state||(pt=(yt=se.state).wrap)===2||pt===1&&yt.status!==de||yt.lookahead)return H;for(pt===1&&(se.adler=C(se.adler,Mt,pr,0)),yt.wrap=0,pr>=yt.w_size&&(pt===0&&(It(yt.head),yt.strstart=0,yt.block_start=0,yt.insert=0),lr=new _.Buf8(yt.w_size),_.arraySet(lr,Mt,pr-yt.w_size,yt.w_size,0),Mt=lr,pr=yt.w_size),Jt=se.avail_in,Kt=se.next_in,Et=se.input,se.avail_in=pr,se.next_in=0,se.input=Mt,bt(yt);yt.lookahead>=xe;){for(Ee=yt.strstart,Ne=yt.lookahead-(xe-1);yt.ins_h=(yt.ins_h<<yt.hash_shift^yt.window[Ee+xe-1])&yt.hash_mask,yt.prev[Ee&yt.w_mask]=yt.head[yt.ins_h],yt.head[yt.ins_h]=Ee,Ee++,--Ne;);yt.strstart=Ee,yt.lookahead=xe-1,bt(yt)}return yt.strstart+=yt.lookahead,yt.block_start=yt.strstart,yt.insert=yt.lookahead,yt.lookahead=0,yt.match_length=yt.prev_length=xe-1,yt.match_available=0,se.next_in=Kt,se.input=Et,se.avail_in=Jt,yt.wrap=pt,j},p.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(l,f,p){f.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(l,f,p){f.exports=function(b,_){var s,C,M,D,B,U,j,H,O,N,Z,J,X,pe,ge,ve,re,Ce,xe,Ge,$e,de,nt,le,ct;s=b.state,C=b.next_in,le=b.input,M=C+(b.avail_in-5),D=b.next_out,ct=b.output,B=D-(_-b.avail_out),U=D+(b.avail_out-257),j=s.dmax,H=s.wsize,O=s.whave,N=s.wnext,Z=s.window,J=s.hold,X=s.bits,pe=s.lencode,ge=s.distcode,ve=(1<<s.lenbits)-1,re=(1<<s.distbits)-1;e:do{X<15&&(J+=le[C++]<<X,X+=8,J+=le[C++]<<X,X+=8),Ce=pe[J&ve];t:for(;;){if(J>>>=xe=Ce>>>24,X-=xe,(xe=Ce>>>16&255)===0)ct[D++]=65535&Ce;else{if(!(16&xe)){if((64&xe)==0){Ce=pe[(65535&Ce)+(J&(1<<xe)-1)];continue t}if(32&xe){s.mode=12;break e}b.msg="invalid literal/length code",s.mode=30;break e}Ge=65535&Ce,(xe&=15)&&(X<xe&&(J+=le[C++]<<X,X+=8),Ge+=J&(1<<xe)-1,J>>>=xe,X-=xe),X<15&&(J+=le[C++]<<X,X+=8,J+=le[C++]<<X,X+=8),Ce=ge[J&re];r:for(;;){if(J>>>=xe=Ce>>>24,X-=xe,!(16&(xe=Ce>>>16&255))){if((64&xe)==0){Ce=ge[(65535&Ce)+(J&(1<<xe)-1)];continue r}b.msg="invalid distance code",s.mode=30;break e}if($e=65535&Ce,X<(xe&=15)&&(J+=le[C++]<<X,(X+=8)<xe&&(J+=le[C++]<<X,X+=8)),j<($e+=J&(1<<xe)-1)){b.msg="invalid distance too far back",s.mode=30;break e}if(J>>>=xe,X-=xe,(xe=D-B)<$e){if(O<(xe=$e-xe)&&s.sane){b.msg="invalid distance too far back",s.mode=30;break e}if(nt=Z,(de=0)===N){if(de+=H-xe,xe<Ge){for(Ge-=xe;ct[D++]=Z[de++],--xe;);de=D-$e,nt=ct}}else if(N<xe){if(de+=H+N-xe,(xe-=N)<Ge){for(Ge-=xe;ct[D++]=Z[de++],--xe;);if(de=0,N<Ge){for(Ge-=xe=N;ct[D++]=Z[de++],--xe;);de=D-$e,nt=ct}}}else if(de+=N-xe,xe<Ge){for(Ge-=xe;ct[D++]=Z[de++],--xe;);de=D-$e,nt=ct}for(;2<Ge;)ct[D++]=nt[de++],ct[D++]=nt[de++],ct[D++]=nt[de++],Ge-=3;Ge&&(ct[D++]=nt[de++],1<Ge&&(ct[D++]=nt[de++]))}else{for(de=D-$e;ct[D++]=ct[de++],ct[D++]=ct[de++],ct[D++]=ct[de++],2<(Ge-=3););Ge&&(ct[D++]=ct[de++],1<Ge&&(ct[D++]=ct[de++]))}break}}break}}while(C<M&&D<U);C-=Ge=X>>3,J&=(1<<(X-=Ge<<3))-1,b.next_in=C,b.next_out=D,b.avail_in=C<M?M-C+5:5-(C-M),b.avail_out=D<U?U-D+257:257-(D-U),s.hold=J,s.bits=X}},{}],49:[function(l,f,p){var b=l("../utils/common"),_=l("./adler32"),s=l("./crc32"),C=l("./inffast"),M=l("./inftrees"),D=1,B=2,U=0,j=-2,H=1,O=852,N=592;function Z(de){return(de>>>24&255)+(de>>>8&65280)+((65280&de)<<8)+((255&de)<<24)}function J(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new b.Buf16(320),this.work=new b.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function X(de){var nt;return de&&de.state?(nt=de.state,de.total_in=de.total_out=nt.total=0,de.msg="",nt.wrap&&(de.adler=1&nt.wrap),nt.mode=H,nt.last=0,nt.havedict=0,nt.dmax=32768,nt.head=null,nt.hold=0,nt.bits=0,nt.lencode=nt.lendyn=new b.Buf32(O),nt.distcode=nt.distdyn=new b.Buf32(N),nt.sane=1,nt.back=-1,U):j}function pe(de){var nt;return de&&de.state?((nt=de.state).wsize=0,nt.whave=0,nt.wnext=0,X(de)):j}function ge(de,nt){var le,ct;return de&&de.state?(ct=de.state,nt<0?(le=0,nt=-nt):(le=1+(nt>>4),nt<48&&(nt&=15)),nt&&(nt<8||15<nt)?j:(ct.window!==null&&ct.wbits!==nt&&(ct.window=null),ct.wrap=le,ct.wbits=nt,pe(de))):j}function ve(de,nt){var le,ct;return de?(ct=new J,(de.state=ct).window=null,(le=ge(de,nt))!==U&&(de.state=null),le):j}var re,Ce,xe=!0;function Ge(de){if(xe){var nt;for(re=new b.Buf32(512),Ce=new b.Buf32(32),nt=0;nt<144;)de.lens[nt++]=8;for(;nt<256;)de.lens[nt++]=9;for(;nt<280;)de.lens[nt++]=7;for(;nt<288;)de.lens[nt++]=8;for(M(D,de.lens,0,288,re,0,de.work,{bits:9}),nt=0;nt<32;)de.lens[nt++]=5;M(B,de.lens,0,32,Ce,0,de.work,{bits:5}),xe=!1}de.lencode=re,de.lenbits=9,de.distcode=Ce,de.distbits=5}function $e(de,nt,le,ct){var et,He=de.state;return He.window===null&&(He.wsize=1<<He.wbits,He.wnext=0,He.whave=0,He.window=new b.Buf8(He.wsize)),ct>=He.wsize?(b.arraySet(He.window,nt,le-He.wsize,He.wsize,0),He.wnext=0,He.whave=He.wsize):(ct<(et=He.wsize-He.wnext)&&(et=ct),b.arraySet(He.window,nt,le-ct,et,He.wnext),(ct-=et)?(b.arraySet(He.window,nt,le-ct,ct,0),He.wnext=ct,He.whave=He.wsize):(He.wnext+=et,He.wnext===He.wsize&&(He.wnext=0),He.whave<He.wsize&&(He.whave+=et))),0}p.inflateReset=pe,p.inflateReset2=ge,p.inflateResetKeep=X,p.inflateInit=function(de){return ve(de,15)},p.inflateInit2=ve,p.inflate=function(de,nt){var le,ct,et,He,$t,Oe,It,me,ne,Ue,Fe,Re,bt,Gt,Vt,Bt,Yt,Or,Ye,pn,se,Mt,yt,Ee,Ne=0,pt=new b.Buf8(4),Jt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!de||!de.state||!de.output||!de.input&&de.avail_in!==0)return j;(le=de.state).mode===12&&(le.mode=13),$t=de.next_out,et=de.output,It=de.avail_out,He=de.next_in,ct=de.input,Oe=de.avail_in,me=le.hold,ne=le.bits,Ue=Oe,Fe=It,Mt=U;e:for(;;)switch(le.mode){case H:if(le.wrap===0){le.mode=13;break}for(;ne<16;){if(Oe===0)break e;Oe--,me+=ct[He++]<<ne,ne+=8}if(2&le.wrap&&me===35615){pt[le.check=0]=255&me,pt[1]=me>>>8&255,le.check=s(le.check,pt,2,0),ne=me=0,le.mode=2;break}if(le.flags=0,le.head&&(le.head.done=!1),!(1&le.wrap)||(((255&me)<<8)+(me>>8))%31){de.msg="incorrect header check",le.mode=30;break}if((15&me)!=8){de.msg="unknown compression method",le.mode=30;break}if(ne-=4,se=8+(15&(me>>>=4)),le.wbits===0)le.wbits=se;else if(se>le.wbits){de.msg="invalid window size",le.mode=30;break}le.dmax=1<<se,de.adler=le.check=1,le.mode=512&me?10:12,ne=me=0;break;case 2:for(;ne<16;){if(Oe===0)break e;Oe--,me+=ct[He++]<<ne,ne+=8}if(le.flags=me,(255&le.flags)!=8){de.msg="unknown compression method",le.mode=30;break}if(57344&le.flags){de.msg="unknown header flags set",le.mode=30;break}le.head&&(le.head.text=me>>8&1),512&le.flags&&(pt[0]=255&me,pt[1]=me>>>8&255,le.check=s(le.check,pt,2,0)),ne=me=0,le.mode=3;case 3:for(;ne<32;){if(Oe===0)break e;Oe--,me+=ct[He++]<<ne,ne+=8}le.head&&(le.head.time=me),512&le.flags&&(pt[0]=255&me,pt[1]=me>>>8&255,pt[2]=me>>>16&255,pt[3]=me>>>24&255,le.check=s(le.check,pt,4,0)),ne=me=0,le.mode=4;case 4:for(;ne<16;){if(Oe===0)break e;Oe--,me+=ct[He++]<<ne,ne+=8}le.head&&(le.head.xflags=255&me,le.head.os=me>>8),512&le.flags&&(pt[0]=255&me,pt[1]=me>>>8&255,le.check=s(le.check,pt,2,0)),ne=me=0,le.mode=5;case 5:if(1024&le.flags){for(;ne<16;){if(Oe===0)break e;Oe--,me+=ct[He++]<<ne,ne+=8}le.length=me,le.head&&(le.head.extra_len=me),512&le.flags&&(pt[0]=255&me,pt[1]=me>>>8&255,le.check=s(le.check,pt,2,0)),ne=me=0}else le.head&&(le.head.extra=null);le.mode=6;case 6:if(1024&le.flags&&(Oe<(Re=le.length)&&(Re=Oe),Re&&(le.head&&(se=le.head.extra_len-le.length,le.head.extra||(le.head.extra=new Array(le.head.extra_len)),b.arraySet(le.head.extra,ct,He,Re,se)),512&le.flags&&(le.check=s(le.check,ct,Re,He)),Oe-=Re,He+=Re,le.length-=Re),le.length))break e;le.length=0,le.mode=7;case 7:if(2048&le.flags){if(Oe===0)break e;for(Re=0;se=ct[He+Re++],le.head&&se&&le.length<65536&&(le.head.name+=String.fromCharCode(se)),se&&Re<Oe;);if(512&le.flags&&(le.check=s(le.check,ct,Re,He)),Oe-=Re,He+=Re,se)break e}else le.head&&(le.head.name=null);le.length=0,le.mode=8;case 8:if(4096&le.flags){if(Oe===0)break e;for(Re=0;se=ct[He+Re++],le.head&&se&&le.length<65536&&(le.head.comment+=String.fromCharCode(se)),se&&Re<Oe;);if(512&le.flags&&(le.check=s(le.check,ct,Re,He)),Oe-=Re,He+=Re,se)break e}else le.head&&(le.head.comment=null);le.mode=9;case 9:if(512&le.flags){for(;ne<16;){if(Oe===0)break e;Oe--,me+=ct[He++]<<ne,ne+=8}if(me!==(65535&le.check)){de.msg="header crc mismatch",le.mode=30;break}ne=me=0}le.head&&(le.head.hcrc=le.flags>>9&1,le.head.done=!0),de.adler=le.check=0,le.mode=12;break;case 10:for(;ne<32;){if(Oe===0)break e;Oe--,me+=ct[He++]<<ne,ne+=8}de.adler=le.check=Z(me),ne=me=0,le.mode=11;case 11:if(le.havedict===0)return de.next_out=$t,de.avail_out=It,de.next_in=He,de.avail_in=Oe,le.hold=me,le.bits=ne,2;de.adler=le.check=1,le.mode=12;case 12:if(nt===5||nt===6)break e;case 13:if(le.last){me>>>=7&ne,ne-=7&ne,le.mode=27;break}for(;ne<3;){if(Oe===0)break e;Oe--,me+=ct[He++]<<ne,ne+=8}switch(le.last=1&me,ne-=1,3&(me>>>=1)){case 0:le.mode=14;break;case 1:if(Ge(le),le.mode=20,nt!==6)break;me>>>=2,ne-=2;break e;case 2:le.mode=17;break;case 3:de.msg="invalid block type",le.mode=30}me>>>=2,ne-=2;break;case 14:for(me>>>=7&ne,ne-=7&ne;ne<32;){if(Oe===0)break e;Oe--,me+=ct[He++]<<ne,ne+=8}if((65535&me)!=(me>>>16^65535)){de.msg="invalid stored block lengths",le.mode=30;break}if(le.length=65535&me,ne=me=0,le.mode=15,nt===6)break e;case 15:le.mode=16;case 16:if(Re=le.length){if(Oe<Re&&(Re=Oe),It<Re&&(Re=It),Re===0)break e;b.arraySet(et,ct,He,Re,$t),Oe-=Re,He+=Re,It-=Re,$t+=Re,le.length-=Re;break}le.mode=12;break;case 17:for(;ne<14;){if(Oe===0)break e;Oe--,me+=ct[He++]<<ne,ne+=8}if(le.nlen=257+(31&me),me>>>=5,ne-=5,le.ndist=1+(31&me),me>>>=5,ne-=5,le.ncode=4+(15&me),me>>>=4,ne-=4,286<le.nlen||30<le.ndist){de.msg="too many length or distance symbols",le.mode=30;break}le.have=0,le.mode=18;case 18:for(;le.have<le.ncode;){for(;ne<3;){if(Oe===0)break e;Oe--,me+=ct[He++]<<ne,ne+=8}le.lens[Jt[le.have++]]=7&me,me>>>=3,ne-=3}for(;le.have<19;)le.lens[Jt[le.have++]]=0;if(le.lencode=le.lendyn,le.lenbits=7,yt={bits:le.lenbits},Mt=M(0,le.lens,0,19,le.lencode,0,le.work,yt),le.lenbits=yt.bits,Mt){de.msg="invalid code lengths set",le.mode=30;break}le.have=0,le.mode=19;case 19:for(;le.have<le.nlen+le.ndist;){for(;Bt=(Ne=le.lencode[me&(1<<le.lenbits)-1])>>>16&255,Yt=65535&Ne,!((Vt=Ne>>>24)<=ne);){if(Oe===0)break e;Oe--,me+=ct[He++]<<ne,ne+=8}if(Yt<16)me>>>=Vt,ne-=Vt,le.lens[le.have++]=Yt;else{if(Yt===16){for(Ee=Vt+2;ne<Ee;){if(Oe===0)break e;Oe--,me+=ct[He++]<<ne,ne+=8}if(me>>>=Vt,ne-=Vt,le.have===0){de.msg="invalid bit length repeat",le.mode=30;break}se=le.lens[le.have-1],Re=3+(3&me),me>>>=2,ne-=2}else if(Yt===17){for(Ee=Vt+3;ne<Ee;){if(Oe===0)break e;Oe--,me+=ct[He++]<<ne,ne+=8}ne-=Vt,se=0,Re=3+(7&(me>>>=Vt)),me>>>=3,ne-=3}else{for(Ee=Vt+7;ne<Ee;){if(Oe===0)break e;Oe--,me+=ct[He++]<<ne,ne+=8}ne-=Vt,se=0,Re=11+(127&(me>>>=Vt)),me>>>=7,ne-=7}if(le.have+Re>le.nlen+le.ndist){de.msg="invalid bit length repeat",le.mode=30;break}for(;Re--;)le.lens[le.have++]=se}}if(le.mode===30)break;if(le.lens[256]===0){de.msg="invalid code -- missing end-of-block",le.mode=30;break}if(le.lenbits=9,yt={bits:le.lenbits},Mt=M(D,le.lens,0,le.nlen,le.lencode,0,le.work,yt),le.lenbits=yt.bits,Mt){de.msg="invalid literal/lengths set",le.mode=30;break}if(le.distbits=6,le.distcode=le.distdyn,yt={bits:le.distbits},Mt=M(B,le.lens,le.nlen,le.ndist,le.distcode,0,le.work,yt),le.distbits=yt.bits,Mt){de.msg="invalid distances set",le.mode=30;break}if(le.mode=20,nt===6)break e;case 20:le.mode=21;case 21:if(6<=Oe&&258<=It){de.next_out=$t,de.avail_out=It,de.next_in=He,de.avail_in=Oe,le.hold=me,le.bits=ne,C(de,Fe),$t=de.next_out,et=de.output,It=de.avail_out,He=de.next_in,ct=de.input,Oe=de.avail_in,me=le.hold,ne=le.bits,le.mode===12&&(le.back=-1);break}for(le.back=0;Bt=(Ne=le.lencode[me&(1<<le.lenbits)-1])>>>16&255,Yt=65535&Ne,!((Vt=Ne>>>24)<=ne);){if(Oe===0)break e;Oe--,me+=ct[He++]<<ne,ne+=8}if(Bt&&(240&Bt)==0){for(Or=Vt,Ye=Bt,pn=Yt;Bt=(Ne=le.lencode[pn+((me&(1<<Or+Ye)-1)>>Or)])>>>16&255,Yt=65535&Ne,!(Or+(Vt=Ne>>>24)<=ne);){if(Oe===0)break e;Oe--,me+=ct[He++]<<ne,ne+=8}me>>>=Or,ne-=Or,le.back+=Or}if(me>>>=Vt,ne-=Vt,le.back+=Vt,le.length=Yt,Bt===0){le.mode=26;break}if(32&Bt){le.back=-1,le.mode=12;break}if(64&Bt){de.msg="invalid literal/length code",le.mode=30;break}le.extra=15&Bt,le.mode=22;case 22:if(le.extra){for(Ee=le.extra;ne<Ee;){if(Oe===0)break e;Oe--,me+=ct[He++]<<ne,ne+=8}le.length+=me&(1<<le.extra)-1,me>>>=le.extra,ne-=le.extra,le.back+=le.extra}le.was=le.length,le.mode=23;case 23:for(;Bt=(Ne=le.distcode[me&(1<<le.distbits)-1])>>>16&255,Yt=65535&Ne,!((Vt=Ne>>>24)<=ne);){if(Oe===0)break e;Oe--,me+=ct[He++]<<ne,ne+=8}if((240&Bt)==0){for(Or=Vt,Ye=Bt,pn=Yt;Bt=(Ne=le.distcode[pn+((me&(1<<Or+Ye)-1)>>Or)])>>>16&255,Yt=65535&Ne,!(Or+(Vt=Ne>>>24)<=ne);){if(Oe===0)break e;Oe--,me+=ct[He++]<<ne,ne+=8}me>>>=Or,ne-=Or,le.back+=Or}if(me>>>=Vt,ne-=Vt,le.back+=Vt,64&Bt){de.msg="invalid distance code",le.mode=30;break}le.offset=Yt,le.extra=15&Bt,le.mode=24;case 24:if(le.extra){for(Ee=le.extra;ne<Ee;){if(Oe===0)break e;Oe--,me+=ct[He++]<<ne,ne+=8}le.offset+=me&(1<<le.extra)-1,me>>>=le.extra,ne-=le.extra,le.back+=le.extra}if(le.offset>le.dmax){de.msg="invalid distance too far back",le.mode=30;break}le.mode=25;case 25:if(It===0)break e;if(Re=Fe-It,le.offset>Re){if((Re=le.offset-Re)>le.whave&&le.sane){de.msg="invalid distance too far back",le.mode=30;break}bt=Re>le.wnext?(Re-=le.wnext,le.wsize-Re):le.wnext-Re,Re>le.length&&(Re=le.length),Gt=le.window}else Gt=et,bt=$t-le.offset,Re=le.length;for(It<Re&&(Re=It),It-=Re,le.length-=Re;et[$t++]=Gt[bt++],--Re;);le.length===0&&(le.mode=21);break;case 26:if(It===0)break e;et[$t++]=le.length,It--,le.mode=21;break;case 27:if(le.wrap){for(;ne<32;){if(Oe===0)break e;Oe--,me|=ct[He++]<<ne,ne+=8}if(Fe-=It,de.total_out+=Fe,le.total+=Fe,Fe&&(de.adler=le.check=le.flags?s(le.check,et,Fe,$t-Fe):_(le.check,et,Fe,$t-Fe)),Fe=It,(le.flags?me:Z(me))!==le.check){de.msg="incorrect data check",le.mode=30;break}ne=me=0}le.mode=28;case 28:if(le.wrap&&le.flags){for(;ne<32;){if(Oe===0)break e;Oe--,me+=ct[He++]<<ne,ne+=8}if(me!==(4294967295&le.total)){de.msg="incorrect length check",le.mode=30;break}ne=me=0}le.mode=29;case 29:Mt=1;break e;case 30:Mt=-3;break e;case 31:return-4;default:return j}return de.next_out=$t,de.avail_out=It,de.next_in=He,de.avail_in=Oe,le.hold=me,le.bits=ne,(le.wsize||Fe!==de.avail_out&&le.mode<30&&(le.mode<27||nt!==4))&&$e(de,de.output,de.next_out,Fe-de.avail_out)?(le.mode=31,-4):(Ue-=de.avail_in,Fe-=de.avail_out,de.total_in+=Ue,de.total_out+=Fe,le.total+=Fe,le.wrap&&Fe&&(de.adler=le.check=le.flags?s(le.check,et,Fe,de.next_out-Fe):_(le.check,et,Fe,de.next_out-Fe)),de.data_type=le.bits+(le.last?64:0)+(le.mode===12?128:0)+(le.mode===20||le.mode===15?256:0),(Ue==0&&Fe===0||nt===4)&&Mt===U&&(Mt=-5),Mt)},p.inflateEnd=function(de){if(!de||!de.state)return j;var nt=de.state;return nt.window&&(nt.window=null),de.state=null,U},p.inflateGetHeader=function(de,nt){var le;return de&&de.state?(2&(le=de.state).wrap)==0?j:((le.head=nt).done=!1,U):j},p.inflateSetDictionary=function(de,nt){var le,ct=nt.length;return de&&de.state?(le=de.state).wrap!==0&&le.mode!==11?j:le.mode===11&&_(1,nt,ct,0)!==le.check?-3:$e(de,nt,ct,ct)?(le.mode=31,-4):(le.havedict=1,U):j},p.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(l,f,p){var b=l("../utils/common"),_=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],C=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],M=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];f.exports=function(D,B,U,j,H,O,N,Z){var J,X,pe,ge,ve,re,Ce,xe,Ge,$e=Z.bits,de=0,nt=0,le=0,ct=0,et=0,He=0,$t=0,Oe=0,It=0,me=0,ne=null,Ue=0,Fe=new b.Buf16(16),Re=new b.Buf16(16),bt=null,Gt=0;for(de=0;de<=15;de++)Fe[de]=0;for(nt=0;nt<j;nt++)Fe[B[U+nt]]++;for(et=$e,ct=15;1<=ct&&Fe[ct]===0;ct--);if(ct<et&&(et=ct),ct===0)return H[O++]=20971520,H[O++]=20971520,Z.bits=1,0;for(le=1;le<ct&&Fe[le]===0;le++);for(et<le&&(et=le),de=Oe=1;de<=15;de++)if(Oe<<=1,(Oe-=Fe[de])<0)return-1;if(0<Oe&&(D===0||ct!==1))return-1;for(Re[1]=0,de=1;de<15;de++)Re[de+1]=Re[de]+Fe[de];for(nt=0;nt<j;nt++)B[U+nt]!==0&&(N[Re[B[U+nt]]++]=nt);if(re=D===0?(ne=bt=N,19):D===1?(ne=_,Ue-=257,bt=s,Gt-=257,256):(ne=C,bt=M,-1),de=le,ve=O,$t=nt=me=0,pe=-1,ge=(It=1<<(He=et))-1,D===1&&852<It||D===2&&592<It)return 1;for(;;){for(Ce=de-$t,Ge=N[nt]<re?(xe=0,N[nt]):N[nt]>re?(xe=bt[Gt+N[nt]],ne[Ue+N[nt]]):(xe=96,0),J=1<<de-$t,le=X=1<<He;H[ve+(me>>$t)+(X-=J)]=Ce<<24|xe<<16|Ge|0,X!==0;);for(J=1<<de-1;me&J;)J>>=1;if(J!==0?(me&=J-1,me+=J):me=0,nt++,--Fe[de]==0){if(de===ct)break;de=B[U+N[nt]]}if(et<de&&(me&ge)!==pe){for($t===0&&($t=et),ve+=le,Oe=1<<(He=de-$t);He+$t<ct&&!((Oe-=Fe[He+$t])<=0);)He++,Oe<<=1;if(It+=1<<He,D===1&&852<It||D===2&&592<It)return 1;H[pe=me&ge]=et<<24|He<<16|ve-O|0}}return me!==0&&(H[ve+me]=de-$t<<24|64<<16|0),Z.bits=et,0}},{"../utils/common":41}],51:[function(l,f,p){f.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(l,f,p){var b=l("../utils/common"),_=0,s=1;function C(Ne){for(var pt=Ne.length;0<=--pt;)Ne[pt]=0}var M=0,D=29,B=256,U=B+1+D,j=30,H=19,O=2*U+1,N=15,Z=16,J=7,X=256,pe=16,ge=17,ve=18,re=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Ce=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],xe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Ge=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],$e=new Array(2*(U+2));C($e);var de=new Array(2*j);C(de);var nt=new Array(512);C(nt);var le=new Array(256);C(le);var ct=new Array(D);C(ct);var et,He,$t,Oe=new Array(j);function It(Ne,pt,Jt,Kt,Et){this.static_tree=Ne,this.extra_bits=pt,this.extra_base=Jt,this.elems=Kt,this.max_length=Et,this.has_stree=Ne&&Ne.length}function me(Ne,pt){this.dyn_tree=Ne,this.max_code=0,this.stat_desc=pt}function ne(Ne){return Ne<256?nt[Ne]:nt[256+(Ne>>>7)]}function Ue(Ne,pt){Ne.pending_buf[Ne.pending++]=255&pt,Ne.pending_buf[Ne.pending++]=pt>>>8&255}function Fe(Ne,pt,Jt){Ne.bi_valid>Z-Jt?(Ne.bi_buf|=pt<<Ne.bi_valid&65535,Ue(Ne,Ne.bi_buf),Ne.bi_buf=pt>>Z-Ne.bi_valid,Ne.bi_valid+=Jt-Z):(Ne.bi_buf|=pt<<Ne.bi_valid&65535,Ne.bi_valid+=Jt)}function Re(Ne,pt,Jt){Fe(Ne,Jt[2*pt],Jt[2*pt+1])}function bt(Ne,pt){for(var Jt=0;Jt|=1&Ne,Ne>>>=1,Jt<<=1,0<--pt;);return Jt>>>1}function Gt(Ne,pt,Jt){var Kt,Et,lr=new Array(N+1),pr=0;for(Kt=1;Kt<=N;Kt++)lr[Kt]=pr=pr+Jt[Kt-1]<<1;for(Et=0;Et<=pt;Et++){var ir=Ne[2*Et+1];ir!==0&&(Ne[2*Et]=bt(lr[ir]++,ir))}}function Vt(Ne){var pt;for(pt=0;pt<U;pt++)Ne.dyn_ltree[2*pt]=0;for(pt=0;pt<j;pt++)Ne.dyn_dtree[2*pt]=0;for(pt=0;pt<H;pt++)Ne.bl_tree[2*pt]=0;Ne.dyn_ltree[2*X]=1,Ne.opt_len=Ne.static_len=0,Ne.last_lit=Ne.matches=0}function Bt(Ne){8<Ne.bi_valid?Ue(Ne,Ne.bi_buf):0<Ne.bi_valid&&(Ne.pending_buf[Ne.pending++]=Ne.bi_buf),Ne.bi_buf=0,Ne.bi_valid=0}function Yt(Ne,pt,Jt,Kt){var Et=2*pt,lr=2*Jt;return Ne[Et]<Ne[lr]||Ne[Et]===Ne[lr]&&Kt[pt]<=Kt[Jt]}function Or(Ne,pt,Jt){for(var Kt=Ne.heap[Jt],Et=Jt<<1;Et<=Ne.heap_len&&(Et<Ne.heap_len&&Yt(pt,Ne.heap[Et+1],Ne.heap[Et],Ne.depth)&&Et++,!Yt(pt,Kt,Ne.heap[Et],Ne.depth));)Ne.heap[Jt]=Ne.heap[Et],Jt=Et,Et<<=1;Ne.heap[Jt]=Kt}function Ye(Ne,pt,Jt){var Kt,Et,lr,pr,ir=0;if(Ne.last_lit!==0)for(;Kt=Ne.pending_buf[Ne.d_buf+2*ir]<<8|Ne.pending_buf[Ne.d_buf+2*ir+1],Et=Ne.pending_buf[Ne.l_buf+ir],ir++,Kt===0?Re(Ne,Et,pt):(Re(Ne,(lr=le[Et])+B+1,pt),(pr=re[lr])!==0&&Fe(Ne,Et-=ct[lr],pr),Re(Ne,lr=ne(--Kt),Jt),(pr=Ce[lr])!==0&&Fe(Ne,Kt-=Oe[lr],pr)),ir<Ne.last_lit;);Re(Ne,X,pt)}function pn(Ne,pt){var Jt,Kt,Et,lr=pt.dyn_tree,pr=pt.stat_desc.static_tree,ir=pt.stat_desc.has_stree,st=pt.stat_desc.elems,fe=-1;for(Ne.heap_len=0,Ne.heap_max=O,Jt=0;Jt<st;Jt++)lr[2*Jt]!==0?(Ne.heap[++Ne.heap_len]=fe=Jt,Ne.depth[Jt]=0):lr[2*Jt+1]=0;for(;Ne.heap_len<2;)lr[2*(Et=Ne.heap[++Ne.heap_len]=fe<2?++fe:0)]=1,Ne.depth[Et]=0,Ne.opt_len--,ir&&(Ne.static_len-=pr[2*Et+1]);for(pt.max_code=fe,Jt=Ne.heap_len>>1;1<=Jt;Jt--)Or(Ne,lr,Jt);for(Et=st;Jt=Ne.heap[1],Ne.heap[1]=Ne.heap[Ne.heap_len--],Or(Ne,lr,1),Kt=Ne.heap[1],Ne.heap[--Ne.heap_max]=Jt,Ne.heap[--Ne.heap_max]=Kt,lr[2*Et]=lr[2*Jt]+lr[2*Kt],Ne.depth[Et]=(Ne.depth[Jt]>=Ne.depth[Kt]?Ne.depth[Jt]:Ne.depth[Kt])+1,lr[2*Jt+1]=lr[2*Kt+1]=Et,Ne.heap[1]=Et++,Or(Ne,lr,1),2<=Ne.heap_len;);Ne.heap[--Ne.heap_max]=Ne.heap[1],(function(he,we){var Ve,Xe,xt,ot,it,vt,zt=we.dyn_tree,Wt=we.max_code,mr=we.stat_desc.static_tree,kr=we.stat_desc.has_stree,Kr=we.stat_desc.extra_bits,yn=we.stat_desc.extra_base,hn=we.stat_desc.max_length,ht=0;for(ot=0;ot<=N;ot++)he.bl_count[ot]=0;for(zt[2*he.heap[he.heap_max]+1]=0,Ve=he.heap_max+1;Ve<O;Ve++)hn<(ot=zt[2*zt[2*(Xe=he.heap[Ve])+1]+1]+1)&&(ot=hn,ht++),zt[2*Xe+1]=ot,Wt<Xe||(he.bl_count[ot]++,it=0,yn<=Xe&&(it=Kr[Xe-yn]),vt=zt[2*Xe],he.opt_len+=vt*(ot+it),kr&&(he.static_len+=vt*(mr[2*Xe+1]+it)));if(ht!==0){do{for(ot=hn-1;he.bl_count[ot]===0;)ot--;he.bl_count[ot]--,he.bl_count[ot+1]+=2,he.bl_count[hn]--,ht-=2}while(0<ht);for(ot=hn;ot!==0;ot--)for(Xe=he.bl_count[ot];Xe!==0;)Wt<(xt=he.heap[--Ve])||(zt[2*xt+1]!==ot&&(he.opt_len+=(ot-zt[2*xt+1])*zt[2*xt],zt[2*xt+1]=ot),Xe--)}})(Ne,pt),Gt(lr,fe,Ne.bl_count)}function se(Ne,pt,Jt){var Kt,Et,lr=-1,pr=pt[1],ir=0,st=7,fe=4;for(pr===0&&(st=138,fe=3),pt[2*(Jt+1)+1]=65535,Kt=0;Kt<=Jt;Kt++)Et=pr,pr=pt[2*(Kt+1)+1],++ir<st&&Et===pr||(ir<fe?Ne.bl_tree[2*Et]+=ir:Et!==0?(Et!==lr&&Ne.bl_tree[2*Et]++,Ne.bl_tree[2*pe]++):ir<=10?Ne.bl_tree[2*ge]++:Ne.bl_tree[2*ve]++,lr=Et,fe=(ir=0)===pr?(st=138,3):Et===pr?(st=6,3):(st=7,4))}function Mt(Ne,pt,Jt){var Kt,Et,lr=-1,pr=pt[1],ir=0,st=7,fe=4;for(pr===0&&(st=138,fe=3),Kt=0;Kt<=Jt;Kt++)if(Et=pr,pr=pt[2*(Kt+1)+1],!(++ir<st&&Et===pr)){if(ir<fe)for(;Re(Ne,Et,Ne.bl_tree),--ir!=0;);else Et!==0?(Et!==lr&&(Re(Ne,Et,Ne.bl_tree),ir--),Re(Ne,pe,Ne.bl_tree),Fe(Ne,ir-3,2)):ir<=10?(Re(Ne,ge,Ne.bl_tree),Fe(Ne,ir-3,3)):(Re(Ne,ve,Ne.bl_tree),Fe(Ne,ir-11,7));lr=Et,fe=(ir=0)===pr?(st=138,3):Et===pr?(st=6,3):(st=7,4)}}C(Oe);var yt=!1;function Ee(Ne,pt,Jt,Kt){Fe(Ne,(M<<1)+(Kt?1:0),3),(function(Et,lr,pr,ir){Bt(Et),Ue(Et,pr),Ue(Et,~pr),b.arraySet(Et.pending_buf,Et.window,lr,pr,Et.pending),Et.pending+=pr})(Ne,pt,Jt)}p._tr_init=function(Ne){yt||((function(){var pt,Jt,Kt,Et,lr,pr=new Array(N+1);for(Et=Kt=0;Et<D-1;Et++)for(ct[Et]=Kt,pt=0;pt<1<<re[Et];pt++)le[Kt++]=Et;for(le[Kt-1]=Et,Et=lr=0;Et<16;Et++)for(Oe[Et]=lr,pt=0;pt<1<<Ce[Et];pt++)nt[lr++]=Et;for(lr>>=7;Et<j;Et++)for(Oe[Et]=lr<<7,pt=0;pt<1<<Ce[Et]-7;pt++)nt[256+lr++]=Et;for(Jt=0;Jt<=N;Jt++)pr[Jt]=0;for(pt=0;pt<=143;)$e[2*pt+1]=8,pt++,pr[8]++;for(;pt<=255;)$e[2*pt+1]=9,pt++,pr[9]++;for(;pt<=279;)$e[2*pt+1]=7,pt++,pr[7]++;for(;pt<=287;)$e[2*pt+1]=8,pt++,pr[8]++;for(Gt($e,U+1,pr),pt=0;pt<j;pt++)de[2*pt+1]=5,de[2*pt]=bt(pt,5);et=new It($e,re,B+1,U,N),He=new It(de,Ce,0,j,N),$t=new It(new Array(0),xe,0,H,J)})(),yt=!0),Ne.l_desc=new me(Ne.dyn_ltree,et),Ne.d_desc=new me(Ne.dyn_dtree,He),Ne.bl_desc=new me(Ne.bl_tree,$t),Ne.bi_buf=0,Ne.bi_valid=0,Vt(Ne)},p._tr_stored_block=Ee,p._tr_flush_block=function(Ne,pt,Jt,Kt){var Et,lr,pr=0;0<Ne.level?(Ne.strm.data_type===2&&(Ne.strm.data_type=(function(ir){var st,fe=4093624447;for(st=0;st<=31;st++,fe>>>=1)if(1&fe&&ir.dyn_ltree[2*st]!==0)return _;if(ir.dyn_ltree[18]!==0||ir.dyn_ltree[20]!==0||ir.dyn_ltree[26]!==0)return s;for(st=32;st<B;st++)if(ir.dyn_ltree[2*st]!==0)return s;return _})(Ne)),pn(Ne,Ne.l_desc),pn(Ne,Ne.d_desc),pr=(function(ir){var st;for(se(ir,ir.dyn_ltree,ir.l_desc.max_code),se(ir,ir.dyn_dtree,ir.d_desc.max_code),pn(ir,ir.bl_desc),st=H-1;3<=st&&ir.bl_tree[2*Ge[st]+1]===0;st--);return ir.opt_len+=3*(st+1)+5+5+4,st})(Ne),Et=Ne.opt_len+3+7>>>3,(lr=Ne.static_len+3+7>>>3)<=Et&&(Et=lr)):Et=lr=Jt+5,Jt+4<=Et&&pt!==-1?Ee(Ne,pt,Jt,Kt):Ne.strategy===4||lr===Et?(Fe(Ne,2+(Kt?1:0),3),Ye(Ne,$e,de)):(Fe(Ne,4+(Kt?1:0),3),(function(ir,st,fe,he){var we;for(Fe(ir,st-257,5),Fe(ir,fe-1,5),Fe(ir,he-4,4),we=0;we<he;we++)Fe(ir,ir.bl_tree[2*Ge[we]+1],3);Mt(ir,ir.dyn_ltree,st-1),Mt(ir,ir.dyn_dtree,fe-1)})(Ne,Ne.l_desc.max_code+1,Ne.d_desc.max_code+1,pr+1),Ye(Ne,Ne.dyn_ltree,Ne.dyn_dtree)),Vt(Ne),Kt&&Bt(Ne)},p._tr_tally=function(Ne,pt,Jt){return Ne.pending_buf[Ne.d_buf+2*Ne.last_lit]=pt>>>8&255,Ne.pending_buf[Ne.d_buf+2*Ne.last_lit+1]=255&pt,Ne.pending_buf[Ne.l_buf+Ne.last_lit]=255&Jt,Ne.last_lit++,pt===0?Ne.dyn_ltree[2*Jt]++:(Ne.matches++,pt--,Ne.dyn_ltree[2*(le[Jt]+B+1)]++,Ne.dyn_dtree[2*ne(pt)]++),Ne.last_lit===Ne.lit_bufsize-1},p._tr_align=function(Ne){Fe(Ne,2,3),Re(Ne,X,$e),(function(pt){pt.bi_valid===16?(Ue(pt,pt.bi_buf),pt.bi_buf=0,pt.bi_valid=0):8<=pt.bi_valid&&(pt.pending_buf[pt.pending++]=255&pt.bi_buf,pt.bi_buf>>=8,pt.bi_valid-=8)})(Ne)}},{"../utils/common":41}],53:[function(l,f,p){f.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(l,f,p){(function(b){(function(_,s){if(!_.setImmediate){var C,M,D,B,U=1,j={},H=!1,O=_.document,N=Object.getPrototypeOf&&Object.getPrototypeOf(_);N=N&&N.setTimeout?N:_,C={}.toString.call(_.process)==="[object process]"?function(pe){process.nextTick(function(){J(pe)})}:(function(){if(_.postMessage&&!_.importScripts){var pe=!0,ge=_.onmessage;return _.onmessage=function(){pe=!1},_.postMessage("","*"),_.onmessage=ge,pe}})()?(B="setImmediate$"+Math.random()+"$",_.addEventListener?_.addEventListener("message",X,!1):_.attachEvent("onmessage",X),function(pe){_.postMessage(B+pe,"*")}):_.MessageChannel?((D=new MessageChannel).port1.onmessage=function(pe){J(pe.data)},function(pe){D.port2.postMessage(pe)}):O&&"onreadystatechange"in O.createElement("script")?(M=O.documentElement,function(pe){var ge=O.createElement("script");ge.onreadystatechange=function(){J(pe),ge.onreadystatechange=null,M.removeChild(ge),ge=null},M.appendChild(ge)}):function(pe){setTimeout(J,0,pe)},N.setImmediate=function(pe){typeof pe!="function"&&(pe=new Function(""+pe));for(var ge=new Array(arguments.length-1),ve=0;ve<ge.length;ve++)ge[ve]=arguments[ve+1];var re={callback:pe,args:ge};return j[U]=re,C(U),U++},N.clearImmediate=Z}function Z(pe){delete j[pe]}function J(pe){if(H)setTimeout(J,0,pe);else{var ge=j[pe];if(ge){H=!0;try{(function(ve){var re=ve.callback,Ce=ve.args;switch(Ce.length){case 0:re();break;case 1:re(Ce[0]);break;case 2:re(Ce[0],Ce[1]);break;case 3:re(Ce[0],Ce[1],Ce[2]);break;default:re.apply(s,Ce)}})(ge)}finally{Z(pe),H=!1}}}}function X(pe){pe.source===_&&typeof pe.data=="string"&&pe.data.indexOf(B)===0&&J(+pe.data.slice(B.length))}})(typeof self>"u"?b===void 0?this:b:self)}).call(this,typeof xd<"u"?xd:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Sy)),Sy.exports}var jD=ND();const Tw=Fx(jD);var mx={exports:{}},UD=mx.exports,ub;function VD(){return ub||(ub=1,(function(r,u){(function(l,f){f()})(UD,function(){function l(M,D){return typeof D>"u"?D={autoBom:!1}:typeof D!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),D={autoBom:!D}),D.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(M.type)?new Blob(["\uFEFF",M],{type:M.type}):M}function f(M,D,B){var U=new XMLHttpRequest;U.open("GET",M),U.responseType="blob",U.onload=function(){C(U.response,D,B)},U.onerror=function(){console.error("could not download file")},U.send()}function p(M){var D=new XMLHttpRequest;D.open("HEAD",M,!1);try{D.send()}catch{}return 200<=D.status&&299>=D.status}function b(M){try{M.dispatchEvent(new MouseEvent("click"))}catch{var D=document.createEvent("MouseEvents");D.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),M.dispatchEvent(D)}}var _=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof xd=="object"&&xd.global===xd?xd:void 0,s=_.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),C=_.saveAs||(typeof window!="object"||window!==_?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(M,D,B){var U=_.URL||_.webkitURL,j=document.createElement("a");D=D||M.name||"download",j.download=D,j.rel="noopener",typeof M=="string"?(j.href=M,j.origin===location.origin?b(j):p(j.href)?f(M,D,B):b(j,j.target="_blank")):(j.href=U.createObjectURL(M),setTimeout(function(){U.revokeObjectURL(j.href)},4e4),setTimeout(function(){b(j)},0))}:"msSaveOrOpenBlob"in navigator?function(M,D,B){if(D=D||M.name||"download",typeof M!="string")navigator.msSaveOrOpenBlob(l(M,B),D);else if(p(M))f(M,D,B);else{var U=document.createElement("a");U.href=M,U.target="_blank",setTimeout(function(){b(U)})}}:function(M,D,B,U){if(U=U||open("","_blank"),U&&(U.document.title=U.document.body.innerText="downloading..."),typeof M=="string")return f(M,D,B);var j=M.type==="application/octet-stream",H=/constructor/i.test(_.HTMLElement)||_.safari,O=/CriOS\/[\d]+/.test(navigator.userAgent);if((O||j&&H||s)&&typeof FileReader<"u"){var N=new FileReader;N.onloadend=function(){var X=N.result;X=O?X:X.replace(/^data:[^;]*;/,"data:attachment/file;"),U?U.location.href=X:location=X,U=null},N.readAsDataURL(M)}else{var Z=_.URL||_.webkitURL,J=Z.createObjectURL(M);U?U.location=J:location.href=J,U=null,setTimeout(function(){Z.revokeObjectURL(J)},4e4)}});_.saveAs=C.saveAs=C,r.exports=C})})(mx)),mx.exports}var Sw=VD();const GD=()=>{const[r,u]=ke.useState(null),[l,f]=ke.useState([]),[p,b]=ke.useState(""),[_,s]=ke.useState(!1),[C,M]=ke.useState([]),[D,B]=ke.useState(!1),U=ke.useRef(null),j=ge=>M(ve=>[...ve,`${new Date().toLocaleTimeString("he-IL")}: ${ge}`]),H=ge=>ge?String(ge).trim().replace(/[\u200B-\u200D\uFEFF]/g,""):"",O=(ge,ve)=>{for(const Ce of ve)if(ge[Ce]!==void 0&&ge[Ce]!==null)return String(ge[Ce]).trim();const re=Object.keys(ge);for(const Ce of ve){const xe=re.find(Ge=>Ge.trim().toLowerCase()===Ce.toLowerCase().trim());if(xe&&ge[xe])return String(ge[xe]).trim()}return""},N=ge=>{if(!ge)return"";const ve=ge.trim().replace(/['`"]/g,"");return ve===""?"A":ve===""?"B":ve===""?"C":ve},Z=ge=>{const ve=ge.target.files?.[0];if(!ve)return;const re=new FileReader;re.onload=Ce=>{try{const xe=Ce.target?.result,Ge=Gy(xe,{type:"binary"});let $e="",de=[],nt=[];for(const He of Ge.SheetNames){const $t=Ge.Sheets[He],Oe=lb.sheet_to_json($t);if(Oe.length>0){const It=Object.keys(Oe[0]);if(It.some(ne=>ne.toUpperCase().includes("REC_INACCURATE")||ne.toUpperCase().includes("INACCURATE")||ne.includes("")||ne.toLowerCase().includes("task"))&&!It.includes("Participant_ID")){$e=He,de=Oe,nt=It;break}}}$e||($e=Ge.SheetNames[0],de=lb.sheet_to_json(Ge.Sheets[$e]),de.length>0&&(nt=Object.keys(de[0]))),j(`  : "${$e}"`),j(`  : ${nt.join(", ")}`);const le={};let ct=0;de.forEach((He,$t)=>{const Oe=O(He,["Scenario_ID","Scenario ID","ID","m_ID"]);if(!Oe)return;const It=H(Oe),me=O(He,["REC_INACCURATE","Rec_Inaccurate","Inaccurate","Rec Inaccurate","REC INACCURATE"]),ne=N(me);$t<3&&console.log(`Row ${$t}: ID=${It}, RawInaccurate="${me}", Mapped="${ne}"`);const Ue={id:It,taskText:O(He,["Task","TASK","","TaskText"]),requirements:O(He,["Priority_Task","Priority Task","Participant_Task","Requirements"]),correctRoute:N(O(He,["CORRECT_ROUTE","Correct_Route","Correct"])),inaccurateRoute:ne};le[It]=Ue,le[`${It}_H`]=Ue,le[`${It}_R`]=Ue,le[`${It}_S`]=Ue,ct++}),u(le),j(`  ${ct} .`);const et=Object.keys(le)[0];et&&le[et].inaccurateRoute?j(` :  ${et},   : "${le[et].inaccurateRoute}"`):j("  :       .     .")}catch(xe){console.error(xe),j("   .")}},re.readAsBinaryString(ve)},J=ge=>{if(ge.target.files){const ve=Array.from(ge.target.files).filter(re=>re.name.toLowerCase().endsWith(".html"));f(ve),j(`  ${ve.length}  HTML.`)}},X=async()=>{if(!r||l.length===0){alert("    .");return}s(!0);const ge=new Tw;let ve=0;const re=D?ge.folder("Correct"):ge,Ce=D?ge.folder("Inaccurate"):null;j("---   ---");for(const Ge of l)try{const $e=await Ge.text(),de=/(const|var|let)\s+DATA\s*=\s*({[\s\S]*?});/,nt=$e.match(de);let le=$e,ct=$e;if(nt){const et=nt[2];let He;try{He=JSON.parse(et)}catch{try{He=new Function("return "+et)()}catch{re&&re.file(Ge.name,$e);continue}}let $t=He.scenarioName?String(He.scenarioName):"",Oe=H($t);if(Oe){let It=r[Oe];if(!It&&Oe.includes("_")){const me=Oe.split("_");if(me.length>=2){const ne=me.slice(0,me.length-1).join("_");It=r[ne]}}if(It){const me={...He};if(It.taskText&&(me.taskText=It.taskText),It.requirements&&(me.requirementsText=It.requirements),It.correctRoute&&(me.recVal=It.correctRoute),le=le.replace(et,JSON.stringify(me,null,2)),D&&Ce){const ne={...He};It.taskText&&(ne.taskText=It.taskText),It.requirements&&(ne.requirementsText=It.requirements),It.inaccurateRoute&&(ne.recVal=It.inaccurateRoute),ct=ct.replace(et,JSON.stringify(ne,null,2))}ve++}else j(` ${Ge.name} (${Oe}):   .`)}}if(p.trim()){const et=`
<style>
${p}
</style>
</head>`;le=le.replace("</head>",et),D&&(ct=ct.replace("</head>",et))}re&&re.file(Ge.name,le),D&&Ce&&Ce.file(Ge.name,ct)}catch($e){console.error(`Error processing ${Ge.name}`,$e)}const xe=await ge.generateAsync({type:"blob"});Sw.saveAs(xe,D?"Scenarios_Correct_Inaccurate.zip":"Scenarios_Updated.zip"),j(` : ${ve}  .`),s(!1)},pe={container:{padding:"20px 30px",direction:"rtl",fontFamily:"Segoe UI, Tahoma, sans-serif",maxWidth:"900px",margin:"0 auto",marginTop:"20px",height:"calc(100% - 40px)",overflowY:"auto",backgroundColor:"#0f172a",color:"#e2e8f0",borderRadius:"8px",boxSizing:"border-box",border:"1px solid #334155"},header:{marginBottom:"20px",borderBottom:"2px solid #3b82f6",paddingBottom:"10px"},card:{background:"#1e293b",padding:"20px",borderRadius:"12px",border:"1px solid #334155",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.5)",marginBottom:"20px"},cardHeader:{display:"flex",alignItems:"center",marginBottom:"15px"},stepIcon:{background:"rgba(59, 130, 246, 0.2)",color:"#60a5fa",width:"32px",height:"32px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",marginLeft:"12px",flexShrink:0},input:{width:"100%",padding:"12px",background:"#0f172a",border:"1px solid #475569",color:"#f1f5f9",borderRadius:"6px",marginTop:"10px",boxSizing:"border-box",outline:"none"},checkboxContainer:{marginTop:"15px",padding:"12px",background:"rgba(59, 130, 246, 0.1)",border:"1px solid #1e40af",borderRadius:"6px",display:"flex",alignItems:"flex-start",gap:"10px"},button:{width:"100%",padding:"15px",background:_?"#475569":"linear-gradient(to left, #2563EB, #3b82f6)",color:"white",fontWeight:"bold",border:"none",borderRadius:"10px",cursor:_?"not-allowed":"pointer",fontSize:"18px",marginTop:"10px",transition:"all 0.2s",boxShadow:"0 4px 12px rgba(37, 99, 235, 0.3)"},logBox:{background:"#020617",color:"#4ade80",padding:"15px",borderRadius:"12px",fontSize:"13px",fontFamily:"Consolas, monospace",height:"200px",overflowY:"auto",direction:"ltr",border:"1px solid #334155"}};return Y.jsxs("div",{style:pe.container,children:[Y.jsxs("header",{style:pe.header,children:[Y.jsx("h1",{style:{margin:0,fontSize:"22px",color:"#f8fafc"},children:"  "}),Y.jsx("p",{style:{margin:"5px 0 0 0",color:"#94a3b8",fontSize:"14px"},children:": Priority_Task, REC_INACCURATE  ."})]}),Y.jsxs("div",{children:[Y.jsxs("section",{style:pe.card,children:[Y.jsxs("div",{style:pe.cardHeader,children:[Y.jsx("div",{style:pe.stepIcon,children:"1"}),Y.jsx("h3",{style:{margin:0,fontSize:"18px"},children:"  (Excel)"})]}),Y.jsxs("div",{style:{fontSize:"13px",color:"#cbd5e1",marginBottom:"15px",lineHeight:"1.6"},children:["  : ",Y.jsx("b",{children:"Scenario_ID, Task, Priority_Task, Correct_Route, REC_INACCURATE"})]}),Y.jsx("input",{type:"file",accept:".xlsx, .xls, .csv",onChange:Z,style:pe.input}),Y.jsxs("div",{style:pe.checkboxContainer,children:[Y.jsx("input",{type:"checkbox",id:"inaccurateMode",checked:D,onChange:ge=>B(ge.target.checked),style:{width:"20px",height:"20px",cursor:"pointer",marginTop:"2px"}}),Y.jsx("label",{htmlFor:"inaccurateMode",style:{cursor:"pointer",fontSize:"14px"},children:Y.jsx("b",{children:"   (Correct / Inaccurate)"})})]}),r&&Y.jsxs("div",{style:{marginTop:"10px",color:"#4ade80",fontSize:"14px",fontWeight:"bold"},children:["  ",Object.keys(r).length,"  ."]})]}),Y.jsxs("section",{style:pe.card,children:[Y.jsxs("div",{style:pe.cardHeader,children:[Y.jsx("div",{style:pe.stepIcon,children:"2"}),Y.jsx("h3",{style:{margin:0,fontSize:"18px"},children:"  (HTML)"})]}),"//@ts-expect-error",Y.jsx("input",{type:"file",webkitdirectory:"true",multiple:!0,onChange:J,style:pe.input}),l.length>0&&Y.jsxs("div",{style:{marginTop:"10px",color:"#4ade80"},children:["  ",l.length," "]})]}),Y.jsxs("section",{style:pe.card,children:[Y.jsxs("div",{style:pe.cardHeader,children:[Y.jsx("div",{style:pe.stepIcon,children:"3"}),Y.jsx("h3",{style:{margin:0,fontSize:"18px"},children:"  (CSS)"})]}),Y.jsx("textarea",{rows:3,placeholder:": body { background: #1a1a1a; }",value:p,onChange:ge=>b(ge.target.value),style:{...pe.input,fontFamily:"monospace",direction:"ltr",resize:"vertical"}})]}),Y.jsx("button",{onClick:X,disabled:_||!r||l.length===0,style:pe.button,children:_?" ...":"  "}),Y.jsxs("div",{style:{marginTop:"20px"},children:[Y.jsx("label",{style:{color:"#94a3b8",fontSize:"14px",marginBottom:"5px",display:"block"},children:" :"}),Y.jsxs("div",{style:pe.logBox,children:[C.length===0?Y.jsx("span",{style:{opacity:.5},children:">  ..."}):C.map((ge,ve)=>Y.jsx("div",{style:{marginBottom:"4px",borderBottom:"1px solid #1e293b"},children:"> "+ge},ve)),Y.jsx("div",{ref:U})]})]})]})]})};var gx={exports:{}};var HD=gx.exports,hb;function qD(){return hb||(hb=1,(function(r,u){(function(l,f){r.exports=f()})(HD,(function(){var l={},f={};function p(_,s,C){if(f[_]=C,_==="index"){var M="var sharedModule = {}; ("+f.shared+")(sharedModule); ("+f.worker+")(sharedModule);",D={};return f.shared(D),f.index(l,D),typeof window<"u"&&l.setWorkerUrl(window.URL.createObjectURL(new Blob([M],{type:"text/javascript"}))),l}}p("shared",["exports"],(function(_){function s(a,e,n,h){return new(n||(n=Promise))((function(m,y){function v(P){try{k(h.next(P))}catch(z){y(z)}}function E(P){try{k(h.throw(P))}catch(z){y(z)}}function k(P){var z;P.done?m(P.value):(z=P.value,z instanceof n?z:new n((function(G){G(z)}))).then(v,E)}k((h=h.apply(a,e||[])).next())}))}function C(a,e){this.x=a,this.y=e}function M(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var D,B;typeof SuppressedError=="function"&&SuppressedError,C.prototype={clone(){return new C(this.x,this.y)},add(a){return this.clone()._add(a)},sub(a){return this.clone()._sub(a)},multByPoint(a){return this.clone()._multByPoint(a)},divByPoint(a){return this.clone()._divByPoint(a)},mult(a){return this.clone()._mult(a)},div(a){return this.clone()._div(a)},rotate(a){return this.clone()._rotate(a)},rotateAround(a,e){return this.clone()._rotateAround(a,e)},matMult(a){return this.clone()._matMult(a)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(a){return this.x===a.x&&this.y===a.y},dist(a){return Math.sqrt(this.distSqr(a))},distSqr(a){const e=a.x-this.x,n=a.y-this.y;return e*e+n*n},angle(){return Math.atan2(this.y,this.x)},angleTo(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith(a){return this.angleWithSep(a.x,a.y)},angleWithSep(a,e){return Math.atan2(this.x*e-this.y*a,this.x*a+this.y*e)},_matMult(a){const e=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=e,this},_add(a){return this.x+=a.x,this.y+=a.y,this},_sub(a){return this.x-=a.x,this.y-=a.y,this},_mult(a){return this.x*=a,this.y*=a,this},_div(a){return this.x/=a,this.y/=a,this},_multByPoint(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint(a){return this.x/=a.x,this.y/=a.y,this},_unit(){return this._div(this.mag()),this},_perp(){const a=this.y;return this.y=this.x,this.x=-a,this},_rotate(a){const e=Math.cos(a),n=Math.sin(a),h=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=h,this},_rotateAround(a,e){const n=Math.cos(a),h=Math.sin(a),m=e.y+h*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-h*(this.y-e.y),this.y=m,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:C},C.convert=function(a){if(a instanceof C)return a;if(Array.isArray(a))return new C(+a[0],+a[1]);if(a.x!==void 0&&a.y!==void 0)return new C(+a.x,+a.y);throw new Error("Expected [x, y] or {x, y} point format")};var U=(function(){if(B)return D;function a(e,n,h,m){this.cx=3*e,this.bx=3*(h-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(m-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=n,this.p2x=h,this.p2y=m}return B=1,D=a,a.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,n){if(n===void 0&&(n=1e-6),e<0)return 0;if(e>1)return 1;for(var h=e,m=0;m<8;m++){var y=this.sampleCurveX(h)-e;if(Math.abs(y)<n)return h;var v=this.sampleCurveDerivativeX(h);if(Math.abs(v)<1e-6)break;h-=y/v}var E=0,k=1;for(h=e,m=0;m<20&&(y=this.sampleCurveX(h),!(Math.abs(y-e)<n));m++)e>y?E=h:k=h,h=.5*(k-E)+E;return h},solve:function(e,n){return this.sampleCurveY(this.solveCurveX(e,n))}},D})(),j=M(U);let H,O;function N(){return H==null&&(H=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),H}function Z(){if(O==null&&(O=!1,N())){const e=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(e){for(let h=0;h<25;h++){const m=4*h;e.fillStyle=`rgb(${m},${m+1},${m+2})`,e.fillRect(h%5,Math.floor(h/5),1,1)}const n=e.getImageData(0,0,5,5).data;for(let h=0;h<100;h++)if(h%4!=3&&n[h]!==h){O=!0;break}}}return O||!1}var J=1e-6,X=typeof Float32Array<"u"?Float32Array:Array;function pe(){var a=new X(9);return X!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function ge(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function ve(){var a=new X(3);return X!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function re(a){var e=a[0],n=a[1],h=a[2];return Math.sqrt(e*e+n*n+h*h)}function Ce(a,e,n){var h=new X(3);return h[0]=a,h[1]=e,h[2]=n,h}function xe(a,e,n){return a[0]=e[0]+n[0],a[1]=e[1]+n[1],a[2]=e[2]+n[2],a}function Ge(a,e,n){return a[0]=e[0]*n,a[1]=e[1]*n,a[2]=e[2]*n,a}function $e(a,e,n){var h=e[0],m=e[1],y=e[2],v=n[0],E=n[1],k=n[2];return a[0]=m*k-y*E,a[1]=y*v-h*k,a[2]=h*E-m*v,a}var de,nt=re;function le(a,e,n){var h=e[0],m=e[1],y=e[2],v=e[3];return a[0]=n[0]*h+n[4]*m+n[8]*y+n[12]*v,a[1]=n[1]*h+n[5]*m+n[9]*y+n[13]*v,a[2]=n[2]*h+n[6]*m+n[10]*y+n[14]*v,a[3]=n[3]*h+n[7]*m+n[11]*y+n[15]*v,a}function ct(){var a=new X(4);return X!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function et(a,e,n,h){var m=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",y=Math.PI/360;e*=y,h*=y,n*=y;var v=Math.sin(e),E=Math.cos(e),k=Math.sin(n),P=Math.cos(n),z=Math.sin(h),G=Math.cos(h);switch(m){case"xyz":a[0]=v*P*G+E*k*z,a[1]=E*k*G-v*P*z,a[2]=E*P*z+v*k*G,a[3]=E*P*G-v*k*z;break;case"xzy":a[0]=v*P*G-E*k*z,a[1]=E*k*G-v*P*z,a[2]=E*P*z+v*k*G,a[3]=E*P*G+v*k*z;break;case"yxz":a[0]=v*P*G+E*k*z,a[1]=E*k*G-v*P*z,a[2]=E*P*z-v*k*G,a[3]=E*P*G+v*k*z;break;case"yzx":a[0]=v*P*G+E*k*z,a[1]=E*k*G+v*P*z,a[2]=E*P*z-v*k*G,a[3]=E*P*G-v*k*z;break;case"zxy":a[0]=v*P*G-E*k*z,a[1]=E*k*G+v*P*z,a[2]=E*P*z+v*k*G,a[3]=E*P*G-v*k*z;break;case"zyx":a[0]=v*P*G-E*k*z,a[1]=E*k*G+v*P*z,a[2]=E*P*z-v*k*G,a[3]=E*P*G+v*k*z;break;default:throw new Error("Unknown angle order "+m)}return a}function He(){var a=new X(2);return X!=Float32Array&&(a[0]=0,a[1]=0),a}function $t(a,e){var n=new X(2);return n[0]=a,n[1]=e,n}ve(),de=new X(4),X!=Float32Array&&(de[0]=0,de[1]=0,de[2]=0,de[3]=0),ve(),Ce(1,0,0),Ce(0,1,0),ct(),ct(),pe(),He();const Oe=8192;function It(a,e,n){return e*(Oe/(a.tileSize*Math.pow(2,n-a.tileID.overscaledZ)))}function me(a,e){return(a%e+e)%e}function ne(a,e,n){return a*(1-n)+e*n}function Ue(a){if(a<=0)return 0;if(a>=1)return 1;const e=a*a,n=e*a;return 4*(a<.5?n:3*(a-e)+n-.75)}function Fe(a,e,n,h){const m=new j(a,e,n,h);return y=>m.solve(y)}const Re=Fe(.25,.1,.25,1);function bt(a,e,n){return Math.min(n,Math.max(e,a))}function Gt(a,e,n){const h=n-e,m=((a-e)%h+h)%h+e;return m===e?n:m}function Vt(a,...e){for(const n of e)for(const h in n)a[h]=n[h];return a}let Bt=1;function Yt(a,e,n){const h={};for(const m in a)h[m]=e.call(this,a[m],m,a);return h}function Or(a,e,n){const h={};for(const m in a)e.call(this,a[m],m,a)&&(h[m]=a[m]);return h}function Ye(a){return Array.isArray(a)?a.map(Ye):typeof a=="object"&&a?Yt(a,Ye):a}const pn={};function se(a){pn[a]||(typeof console<"u"&&console.warn(a),pn[a]=!0)}function Mt(a,e,n){return(n.y-a.y)*(e.x-a.x)>(e.y-a.y)*(n.x-a.x)}function yt(a){return typeof WorkerGlobalScope<"u"&&a!==void 0&&a instanceof WorkerGlobalScope}let Ee=null;function Ne(a){return typeof ImageBitmap<"u"&&a instanceof ImageBitmap}const pt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Jt(a,e,n,h,m){return s(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const y=new VideoFrame(a,{timestamp:0});try{const v=y?.format;if(!v||!v.startsWith("BGR")&&!v.startsWith("RGB"))throw new Error(`Unrecognized format ${v}`);const E=v.startsWith("BGR"),k=new Uint8ClampedArray(h*m*4);if(yield y.copyTo(k,(function(P,z,G,W,K){const ie=4*Math.max(-z,0),oe=(Math.max(0,G)-G)*W*4+ie,ue=4*W,be=Math.max(0,z),We=Math.max(0,G);return{rect:{x:be,y:We,width:Math.min(P.width,z+W)-be,height:Math.min(P.height,G+K)-We},layout:[{offset:oe,stride:ue}]}})(a,e,n,h,m)),E)for(let P=0;P<k.length;P+=4){const z=k[P];k[P]=k[P+2],k[P+2]=z}return k}finally{y.close()}}))}let Kt,Et;function lr(a,e,n,h){return a.addEventListener(e,n,h),{unsubscribe:()=>{a.removeEventListener(e,n,h)}}}function pr(a){return a*Math.PI/180}function ir(a){return a/Math.PI*180}const st={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},fe={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},he="AbortError";class we extends Error{constructor(e=he){super(e instanceof Error?e.message:e),this.name=he,e instanceof Error&&e.stack&&(this.stack=e.stack)}}function Ve(a){return a.name===he}const Xe={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function xt(a){return Xe.REGISTERED_PROTOCOLS[a.substring(0,a.indexOf("://"))]}const ot="global-dispatcher";class it extends Error{constructor(e,n,h,m){super(`AJAXError: ${n} (${e}): ${h}`),this.status=e,this.statusText=n,this.url=h,this.body=m}}const vt=()=>yt(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,zt=function(a,e){if(/:\/\//.test(a.url)&&!/^https?:|^file:/.test(a.url)){const h=xt(a.url);if(h)return h(a,e);if(yt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,targetMapId:ot},e)}if(!(/^file:/.test(n=a.url)||/^file:/.test(vt())&&!/^\w+:/.test(n))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(h,m){return s(this,void 0,void 0,(function*(){const y=new Request(h.url,{method:h.method||"GET",body:h.body,credentials:h.credentials,headers:h.headers,cache:h.cache,referrer:vt(),signal:m.signal});let v,E;h.type!=="json"||y.headers.has("Accept")||y.headers.set("Accept","application/json");try{v=yield fetch(y)}catch(P){throw Ve(P)?P:new it(0,P.message,h.url,new Blob)}if(!v.ok){const P=yield v.blob();throw new it(v.status,v.statusText,h.url,P)}E=h.type==="arrayBuffer"||h.type==="image"?v.arrayBuffer():h.type==="json"?v.json():v.text();const k=yield E;return m.signal.throwIfAborted(),{data:k,cacheControl:v.headers.get("Cache-Control"),expires:v.headers.get("Expires")}}))})(a,e);if(yt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,mustQueue:!0,targetMapId:ot},e)}var n;return(function(h,m){return new Promise(((y,v)=>{var E;const k=new XMLHttpRequest;k.open(h.method||"GET",h.url,!0),h.type!=="arrayBuffer"&&h.type!=="image"||(k.responseType="arraybuffer");for(const P in h.headers)k.setRequestHeader(P,h.headers[P]);h.type==="json"&&(k.responseType="text",!((E=h.headers)===null||E===void 0)&&E.Accept||k.setRequestHeader("Accept","application/json")),k.withCredentials=h.credentials==="include",k.onerror=()=>{v(new Error(k.statusText))},k.onload=()=>{if(!m.signal.aborted)if((k.status>=200&&k.status<300||k.status===0)&&k.response!==null){let P=k.response;if(h.type==="json")try{P=JSON.parse(k.response)}catch(z){return void v(z)}y({data:P,cacheControl:k.getResponseHeader("Cache-Control"),expires:k.getResponseHeader("Expires")})}else{const P=new Blob([k.response],{type:k.getResponseHeader("Content-Type")});v(new it(k.status,k.statusText,h.url,P))}},m.signal.addEventListener("abort",(()=>{k.abort(),v(new we(m.signal.reason))})),k.send(h.body)}))})(a,e)};function Wt(a){if(!a||a.indexOf("://")<=0||a.indexOf("data:image/")===0||a.indexOf("blob:")===0)return!0;const e=new URL(a),n=window.location;return e.protocol===n.protocol&&e.host===n.host}function mr(a,e,n){n[a]&&n[a].indexOf(e)!==-1||(n[a]=n[a]||[],n[a].push(e))}function kr(a,e,n){if(n&&n[a]){const h=n[a].indexOf(e);h!==-1&&n[a].splice(h,1)}}class Kr{constructor(e,n={}){Vt(this,n),this.type=e}}class yn extends Kr{constructor(e,n={}){super("error",Vt({error:e},n))}}class hn{on(e,n){return this._listeners=this._listeners||{},mr(e,n,this._listeners),{unsubscribe:()=>{this.off(e,n)}}}off(e,n){return kr(e,n,this._listeners),kr(e,n,this._oneTimeListeners),this}once(e,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},mr(e,n,this._oneTimeListeners),this):new Promise((h=>this.once(e,h)))}fire(e,n){typeof e=="string"&&(e=new Kr(e,n||{}));const h=e.type;if(this.listens(h)){e.target=this;const m=this._listeners&&this._listeners[h]?this._listeners[h].slice():[];for(const E of m)E.call(this,e);const y=this._oneTimeListeners&&this._oneTimeListeners[h]?this._oneTimeListeners[h].slice():[];for(const E of y)kr(h,E,this._oneTimeListeners),E.call(this,e);const v=this._eventedParent;v&&(Vt(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),v.fire(e))}else e instanceof yn&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,n){return this._eventedParent=e,this._eventedParentData=n,this}}var ht={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number",length:2},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},encoding:{type:"enum",values:{mvt:{},mlt:{}},default:"mvt"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"filter"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},filter:{type:"boolean",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"expression_name",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}},interpolation:{type:"array",value:"interpolation_name",minimum:1},interpolation_name:{type:"enum",values:{linear:{syntax:{overloads:[{parameters:[],"output-type":"interpolation"}],parameters:[]}},exponential:{syntax:{overloads:[{parameters:["base"],"output-type":"interpolation"}],parameters:[{name:"base",type:"number literal"}]}},"cubic-bezier":{syntax:{overloads:[{parameters:["x1","y1","x2","y2"],"output-type":"interpolation"}],parameters:[{name:"x1",type:"number literal"},{name:"y1",type:"number literal"},{name:"x2",type:"number literal"},{name:"y2",type:"number literal"}]}}}}};const En=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Kn(a,e){const n={};for(const h in a)h!=="ref"&&(n[h]=a[h]);return En.forEach((h=>{h in e&&(n[h]=e[h])})),n}function Qr(a,e){if(Array.isArray(a)){if(!Array.isArray(e)||a.length!==e.length)return!1;for(let n=0;n<a.length;n++)if(!Qr(a[n],e[n]))return!1;return!0}if(typeof a=="object"&&a!==null&&e!==null){if(typeof e!="object"||Object.keys(a).length!==Object.keys(e).length)return!1;for(const n in a)if(!Qr(a[n],e[n]))return!1;return!0}return a===e}function Ln(a,e){a.push(e)}function Ba(a,e,n){Ln(n,{command:"addSource",args:[a,e[a]]})}function zn(a,e,n){Ln(e,{command:"removeSource",args:[a]}),n[a]=!0}function tn(a,e,n,h){zn(a,n,h),Ba(a,e,n)}function Bn(a,e,n){let h;for(h in a[n])if(Object.prototype.hasOwnProperty.call(a[n],h)&&h!=="data"&&!Qr(a[n][h],e[n][h]))return!1;for(h in e[n])if(Object.prototype.hasOwnProperty.call(e[n],h)&&h!=="data"&&!Qr(a[n][h],e[n][h]))return!1;return!0}function ba(a,e,n,h,m,y){a=a||{},e=e||{};for(const v in a)Object.prototype.hasOwnProperty.call(a,v)&&(Qr(a[v],e[v])||n.push({command:y,args:[h,v,e[v],m]}));for(const v in e)Object.prototype.hasOwnProperty.call(e,v)&&!Object.prototype.hasOwnProperty.call(a,v)&&(Qr(a[v],e[v])||n.push({command:y,args:[h,v,e[v],m]}))}function El(a){return a.id}function Zo(a,e){return a[e.id]=e,a}class Qt{constructor(e,n,h,m){this.message=(e?`${e}: `:"")+h,m&&(this.identifier=m),n!=null&&n.__line__&&(this.line=n.__line__)}}function ye(a,...e){for(const n of e)for(const h in n)a[h]=n[h];return a}class je extends Error{constructor(e,n){super(n),this.message=n,this.key=e}}class Le{constructor(e,n=[]){this.parent=e,this.bindings={};for(const[h,m]of n)this.bindings[h]=m}concat(e){return new Le(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const Me={kind:"null"},Te={kind:"number"},Pe={kind:"string"},gt={kind:"boolean"},jt={kind:"color"},Dt={kind:"projectionDefinition"},At={kind:"object"},_t={kind:"value"},or={kind:"collator"},yr={kind:"formatted"},vr={kind:"padding"},fr={kind:"colorArray"},_r={kind:"numberArray"},Ur={kind:"resolvedImage"},Tn={kind:"variableAnchorOffsetCollection"};function vn(a,e){return{kind:"array",itemType:a,N:e}}function Zr(a){if(a.kind==="array"){const e=Zr(a.itemType);return typeof a.N=="number"?`array<${e}, ${a.N}>`:a.itemType.kind==="value"?"array":`array<${e}>`}return a.kind}const Mi=[Me,Te,Pe,gt,jt,Dt,yr,At,vn(_t),vr,_r,fr,Ur,Tn];function Fs(a,e){if(e.kind==="error")return null;if(a.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!Fs(a.itemType,e.itemType))&&(typeof a.N!="number"||a.N===e.N))return null}else{if(a.kind===e.kind)return null;if(a.kind==="value"){for(const n of Mi)if(!Fs(n,e))return null}}return`Expected ${Zr(a)} but found ${Zr(e)} instead.`}function pi(a,e){return e.some((n=>n.kind===a.kind))}function bi(a,e){return e.some((n=>n==="null"?a===null:n==="array"?Array.isArray(a):n==="object"?a&&!Array.isArray(a)&&typeof a=="object":n===typeof a))}function oi(a,e){return a.kind==="array"&&e.kind==="array"?a.itemType.kind===e.itemType.kind&&typeof a.N=="number":a.kind===e.kind}const Di=.96422,wi=.82521,bs=4/29,bn=6/29,lu=3*bn*bn,kc=bn*bn*bn,Wo=Math.PI/180,cu=180/Math.PI;function uu(a){return(a%=360)<0&&(a+=360),a}function Cc([a,e,n,h]){let m,y;const v=Mc((.2225045*(a=Na(a))+.7168786*(e=Na(e))+.0606169*(n=Na(n)))/1);a===e&&e===n?m=y=v:(m=Mc((.4360747*a+.3850649*e+.1430804*n)/Di),y=Mc((.0139322*a+.0971045*e+.7141733*n)/wi));const E=116*v-16;return[E<0?0:E,500*(m-v),200*(v-y),h]}function Na(a){return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function Mc(a){return a>kc?Math.pow(a,1/3):a/lu+bs}function Wl([a,e,n,h]){let m=(a+16)/116,y=isNaN(e)?m:m+e/500,v=isNaN(n)?m:m-n/200;return m=1*mo(m),y=Di*mo(y),v=wi*mo(v),[hu(3.1338561*y-1.6168667*m-.4906146*v),hu(-.9787684*y+1.9161415*m+.033454*v),hu(.0719453*y-.2289914*m+1.4052427*v),h]}function hu(a){return(a=a<=.00304?12.92*a:1.055*Math.pow(a,1/2.4)-.055)<0?0:a>1?1:a}function mo(a){return a>bn?a*a*a:lu*(a-bs)}const Df=Object.hasOwn||function(a,e){return Object.prototype.hasOwnProperty.call(a,e)};function $o(a,e){return Df(a,e)?a[e]:void 0}function go(a){return parseInt(a.padEnd(2,a),16)/255}function Rf(a,e){return Xo(e?a/100:a,0,1)}function Xo(a,e,n){return Math.min(Math.max(e,a),n)}function fu(a){return!a.some(Number.isNaN)}const Yo={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Al(a,e,n){return a+n*(e-a)}function Ko(a,e,n){return a.map(((h,m)=>Al(h,e[m],n)))}class ln{constructor(e,n,h,m=1,y=!0){this.r=e,this.g=n,this.b=h,this.a=m,y||(this.r*=m,this.g*=m,this.b*=m,m||this.overwriteGetter("rgb",[e,n,h,m]))}static parse(e){if(e instanceof ln)return e;if(typeof e!="string")return;const n=(function(h){if((h=h.toLowerCase().trim())==="transparent")return[0,0,0,0];const m=$o(Yo,h);if(m){const[v,E,k]=m;return[v/255,E/255,k/255,1]}if(h.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(h)){const v=h.length<6?1:2;let E=1;return[go(h.slice(E,E+=v)),go(h.slice(E,E+=v)),go(h.slice(E,E+=v)),go(h.slice(E,E+v)||"ff")]}if(h.startsWith("rgb")){const v=h.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(v){const[E,k,P,z,G,W,K,ie,oe,ue,be,We]=v,Se=[z||" ",K||" ",ue].join("");if(Se==="  "||Se==="  /"||Se===",,"||Se===",,,"){const De=[P,W,oe].join(""),Je=De==="%%%"?100:De===""?255:0;if(Je){const at=[Xo(+k/Je,0,1),Xo(+G/Je,0,1),Xo(+ie/Je,0,1),be?Rf(+be,We):1];if(fu(at))return at}}return}}const y=h.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){const[v,E,k,P,z,G,W,K,ie]=y,oe=[k||" ",z||" ",W].join("");if(oe==="  "||oe==="  /"||oe===",,"||oe===",,,"){const ue=[+E,Xo(+P,0,100),Xo(+G,0,100),K?Rf(+K,ie):1];if(fu(ue))return(function([be,We,Se,De]){function Je(at){const St=(at+be/30)%12,Xt=We*Math.min(Se,1-Se);return Se-Xt*Math.max(-1,Math.min(St-3,9-St,1))}return be=uu(be),We/=100,Se/=100,[Je(0),Je(8),Je(4),De]})(ue)}}})(e);return n?new ln(...n,!1):void 0}get rgb(){const{r:e,g:n,b:h,a:m}=this,y=m||1/0;return this.overwriteGetter("rgb",[e/y,n/y,h/y,m])}get hcl(){return this.overwriteGetter("hcl",(function(e){const[n,h,m,y]=Cc(e),v=Math.sqrt(h*h+m*m);return[Math.round(1e4*v)?uu(Math.atan2(m,h)*cu):NaN,v,n,y]})(this.rgb))}get lab(){return this.overwriteGetter("lab",Cc(this.rgb))}overwriteGetter(e,n){return Object.defineProperty(this,e,{value:n}),n}toString(){const[e,n,h,m]=this.rgb;return`rgba(${[e,n,h].map((y=>Math.round(255*y))).join(",")},${m})`}static interpolate(e,n,h,m="rgb"){switch(m){case"rgb":{const[y,v,E,k]=Ko(e.rgb,n.rgb,h);return new ln(y,v,E,k,!1)}case"hcl":{const[y,v,E,k]=e.hcl,[P,z,G,W]=n.hcl;let K,ie;if(isNaN(y)||isNaN(P))isNaN(y)?isNaN(P)?K=NaN:(K=P,E!==1&&E!==0||(ie=z)):(K=y,G!==1&&G!==0||(ie=v));else{let Se=P-y;P>y&&Se>180?Se-=360:P<y&&y-P>180&&(Se+=360),K=y+h*Se}const[oe,ue,be,We]=(function([Se,De,Je,at]){return Se=isNaN(Se)?0:Se*Wo,Wl([Je,Math.cos(Se)*De,Math.sin(Se)*De,at])})([K,ie??Al(v,z,h),Al(E,G,h),Al(k,W,h)]);return new ln(oe,ue,be,We,!1)}case"lab":{const[y,v,E,k]=Wl(Ko(e.lab,n.lab,h));return new ln(y,v,E,k,!1)}}}}ln.black=new ln(0,0,0,1),ln.white=new ln(1,1,1,1),ln.transparent=new ln(0,0,0,0),ln.red=new ln(1,0,0,1);class _o{constructor(e,n,h){this.sensitivity=e?n?"variant":"case":n?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,n){return this.collator.compare(e,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const nh=["bottom","center","top"];class Dc{constructor(e,n,h,m,y,v){this.text=e,this.image=n,this.scale=h,this.fontStack=m,this.textColor=y,this.verticalAlign=v}}class Ma{constructor(e){this.sections=e}static fromString(e){return new Ma([new Dc(e,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((e=>e.text.length!==0||e.image&&e.image.name.length!==0))}static factory(e){return e instanceof Ma?e:Ma.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map((e=>e.text)).join("")}}class qa{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof qa)return e;if(typeof e=="number")return new qa([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const n of e)if(typeof n!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new qa(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,n,h){return new qa(Ko(e.values,n.values,h))}}class Hn{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Hn)return e;if(typeof e=="number")return new Hn([e]);if(Array.isArray(e)){for(const n of e)if(typeof n!="number")return;return new Hn(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,n,h){return new Hn(Ko(e.values,n.values,h))}}class en{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof en)return e;if(typeof e=="string"){const h=ln.parse(e);return h?new en([h]):void 0}if(!Array.isArray(e))return;const n=[];for(const h of e){if(typeof h!="string")return;const m=ln.parse(h);if(!m)return;n.push(m)}return new en(n)}toString(){return JSON.stringify(this.values)}static interpolate(e,n,h,m="rgb"){const y=[];if(e.values.length!=n.values.length)throw new Error(`colorArray: Arrays have mismatched length (${e.values.length} vs. ${n.values.length}), cannot interpolate.`);for(let v=0;v<e.values.length;v++)y.push(ln.interpolate(e.values[v],n.values[v],h,m));return new en(y)}}class Jn extends Error{constructor(e){super(e),this.name="RuntimeError"}toJSON(){return this.message}}const os=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Da{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Da)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2==0){for(let n=0;n<e.length;n+=2){const h=e[n],m=e[n+1];if(typeof h!="string"||!os.has(h)||!Array.isArray(m)||m.length!==2||typeof m[0]!="number"||typeof m[1]!="number")return}return new Da(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,n,h){const m=e.values,y=n.values;if(m.length!==y.length)throw new Jn(`Cannot interpolate values of different length. from: ${e.toString()}, to: ${n.toString()}`);const v=[];for(let E=0;E<m.length;E+=2){if(m[E]!==y[E])throw new Jn(`Cannot interpolate values containing mismatched anchors. from[${E}]: ${m[E]}, to[${E}]: ${y[E]}`);v.push(m[E]);const[k,P]=m[E+1],[z,G]=y[E+1];v.push([Al(k,z,h),Al(P,G,h)])}return new Da(v)}}class Ri{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Ri({name:e,available:!1}):null}}class $n{constructor(e,n,h){this.from=e,this.to=n,this.transition=h}static interpolate(e,n,h){return new $n(e,n,h)}static parse(e){return e instanceof $n?e:Array.isArray(e)&&e.length===3&&typeof e[0]=="string"&&typeof e[1]=="string"&&typeof e[2]=="number"?new $n(e[0],e[1],e[2]):typeof e=="object"&&typeof e.from=="string"&&typeof e.to=="string"&&typeof e.transition=="number"?new $n(e.from,e.to,e.transition):typeof e=="string"?new $n(e,e,1):void 0}}function ei(a,e,n,h){return typeof a=="number"&&a>=0&&a<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof n=="number"&&n>=0&&n<=255?h===void 0||typeof h=="number"&&h>=0&&h<=1?null:`Invalid rgba value [${[a,e,n,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof h=="number"?[a,e,n,h]:[a,e,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function mi(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof $n||a instanceof ln||a instanceof _o||a instanceof Ma||a instanceof qa||a instanceof Hn||a instanceof en||a instanceof Da||a instanceof Ri)return!0;if(Array.isArray(a)){for(const e of a)if(!mi(e))return!1;return!0}if(typeof a=="object"){for(const e in a)if(!mi(a[e]))return!1;return!0}return!1}function kn(a){if(a===null)return Me;if(typeof a=="string")return Pe;if(typeof a=="boolean")return gt;if(typeof a=="number")return Te;if(a instanceof ln)return jt;if(a instanceof $n)return Dt;if(a instanceof _o)return or;if(a instanceof Ma)return yr;if(a instanceof qa)return vr;if(a instanceof Hn)return _r;if(a instanceof en)return fr;if(a instanceof Da)return Tn;if(a instanceof Ri)return Ur;if(Array.isArray(a)){const e=a.length;let n;for(const h of a){const m=kn(h);if(n){if(n===m)continue;n=_t;break}n=m}return vn(n||_t,e)}return At}function kl(a){const e=typeof a;return a===null?"":e==="string"||e==="number"||e==="boolean"?String(a):a instanceof ln||a instanceof $n||a instanceof Ma||a instanceof qa||a instanceof Hn||a instanceof en||a instanceof Da||a instanceof Ri?a.toString():JSON.stringify(a)}class Ea{constructor(e,n){this.type=e,this.value=n}static parse(e,n){if(e.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!mi(e[1]))return n.error("invalid value");const h=e[1];let m=kn(h);const y=n.expectedType;return m.kind!=="array"||m.N!==0||!y||y.kind!=="array"||typeof y.N=="number"&&y.N!==0||(m=y),new Ea(m,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Ii={string:Pe,number:Te,boolean:gt,object:At};class ja{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");let h,m=1;const y=e[0];if(y==="array"){let E,k;if(e.length>2){const P=e[1];if(typeof P!="string"||!(P in Ii)||P==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);E=Ii[P],m++}else E=_t;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return n.error('The length argument to "array" must be a positive integer literal',2);k=e[2],m++}h=vn(E,k)}else{if(!Ii[y])throw new Error(`Types doesn't contain name = ${y}`);h=Ii[y]}const v=[];for(;m<e.length;m++){const E=n.parse(e[m],m,_t);if(!E)return null;v.push(E)}return new ja(h,v)}evaluate(e){for(let n=0;n<this.args.length;n++){const h=this.args[n].evaluate(e);if(!Fs(this.type,kn(h)))return h;if(n===this.args.length-1)throw new Jn(`Expected value to be of type ${Zr(this.type)}, but found ${Zr(kn(h))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const Ra={"to-boolean":gt,"to-color":jt,"to-number":Te,"to-string":Pe};class Pi{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const h=e[0];if(!Ra[h])throw new Error(`Can't parse ${h} as it is not part of the known types`);if((h==="to-boolean"||h==="to-string")&&e.length!==2)return n.error("Expected one argument.");const m=Ra[h],y=[];for(let v=1;v<e.length;v++){const E=n.parse(e[v],v,_t);if(!E)return null;y.push(E)}return new Pi(m,y)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let n,h;for(const m of this.args){if(n=m.evaluate(e),h=null,n instanceof ln)return n;if(typeof n=="string"){const y=e.parseColor(n);if(y)return y}else if(Array.isArray(n)&&(h=n.length<3||n.length>4?`Invalid rgba value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:ei(n[0],n[1],n[2],n[3]),!h))return new ln(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new Jn(h||`Could not parse color from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"padding":{let n;for(const h of this.args){n=h.evaluate(e);const m=qa.parse(n);if(m)return m}throw new Jn(`Could not parse padding from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"numberArray":{let n;for(const h of this.args){n=h.evaluate(e);const m=Hn.parse(n);if(m)return m}throw new Jn(`Could not parse numberArray from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"colorArray":{let n;for(const h of this.args){n=h.evaluate(e);const m=en.parse(n);if(m)return m}throw new Jn(`Could not parse colorArray from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"variableAnchorOffsetCollection":{let n;for(const h of this.args){n=h.evaluate(e);const m=Da.parse(n);if(m)return m}throw new Jn(`Could not parse variableAnchorOffsetCollection from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"number":{let n=null;for(const h of this.args){if(n=h.evaluate(e),n===null)return 0;const m=Number(n);if(!isNaN(m))return m}throw new Jn(`Could not convert ${JSON.stringify(n)} to number.`)}case"formatted":return Ma.fromString(kl(this.args[0].evaluate(e)));case"resolvedImage":return Ri.fromString(kl(this.args[0].evaluate(e)));case"projectionDefinition":return this.args[0].evaluate(e);default:return kl(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const Rc=["Unknown","Point","LineString","Polygon"];class Ki{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Rc[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let n=this._parseColorCache.get(e);return n||(n=ln.parse(e),this._parseColorCache.set(e,n)),n}}class xo{constructor(e,n,h=[],m,y=new Le,v=[]){this.registry=e,this.path=h,this.key=h.map((E=>`[${E}]`)).join(""),this.scope=y,this.errors=v,this.expectedType=m,this._isConstant=n}parse(e,n,h,m,y={}){return n?this.concat(n,h,m)._parse(e,y):this._parse(e,y)}_parse(e,n){function h(m,y,v){return v==="assert"?new ja(y,[m]):v==="coerce"?new Pi(y,[m]):m}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=e[0];if(typeof m!="string")return this.error(`Expression name must be a string, but found ${typeof m} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const y=this.registry[m];if(y){let v=y.parse(e,this);if(!v)return null;if(this.expectedType){const E=this.expectedType,k=v.type;if(E.kind!=="string"&&E.kind!=="number"&&E.kind!=="boolean"&&E.kind!=="object"&&E.kind!=="array"||k.kind!=="value"){if(E.kind==="projectionDefinition"&&["string","array"].includes(k.kind)||["color","formatted","resolvedImage"].includes(E.kind)&&["value","string"].includes(k.kind)||["padding","numberArray"].includes(E.kind)&&["value","number","array"].includes(k.kind)||E.kind==="colorArray"&&["value","string","array"].includes(k.kind)||E.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(k.kind))v=h(v,E,n.typeAnnotation||"coerce");else if(this.checkSubtype(E,k))return null}else v=h(v,E,n.typeAnnotation||"assert")}if(!(v instanceof Ea)&&v.type.kind!=="resolvedImage"&&this._isConstant(v)){const E=new Ki;try{v=new Ea(v.type,v.evaluate(E))}catch(k){return this.error(k.message),null}}return v}return this.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,n,h){const m=typeof e=="number"?this.path.concat(e):this.path,y=h?this.scope.concat(h):this.scope;return new xo(this.registry,this._isConstant,m,n||null,y,this.errors)}error(e,...n){const h=`${this.key}${n.map((m=>`[${m}]`)).join("")}`;this.errors.push(new je(h,e))}checkSubtype(e,n){const h=Fs(e,n);return h&&this.error(h),h}}class qn{constructor(e,n){this.type=n.type,this.bindings=[].concat(e),this.result=n}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const n of this.bindings)e(n[1]);e(this.result)}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const h=[];for(let y=1;y<e.length-1;y+=2){const v=e[y];if(typeof v!="string")return n.error(`Expected string, but found ${typeof v} instead.`,y);if(/[^a-zA-Z0-9_]/.test(v))return n.error("Variable names must contain only alphanumeric characters or '_'.",y);const E=n.parse(e[y+1],y+1);if(!E)return null;h.push([v,E])}const m=n.parse(e[e.length-1],e.length-1,n.expectedType,h);return m?new qn(h,m):null}outputDefined(){return this.result.outputDefined()}}class Ji{constructor(e,n){this.type=n.type,this.name=e,this.boundExpression=n}static parse(e,n){if(e.length!==2||typeof e[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");const h=e[1];return n.scope.has(h)?new Ji(h,n.scope.get(h)):n.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class _n{constructor(e,n,h){this.type=e,this.index=n,this.input=h}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const h=n.parse(e[1],1,Te),m=n.parse(e[2],2,vn(n.expectedType||_t));return h&&m?new _n(m.type.itemType,h,m):null}evaluate(e){const n=this.index.evaluate(e),h=this.input.evaluate(e);if(n<0)throw new Jn(`Array index out of bounds: ${n} < 0.`);if(n>=h.length)throw new Jn(`Array index out of bounds: ${n} > ${h.length-1}.`);if(n!==Math.floor(n))throw new Jn(`Array index must be an integer, but found ${n} instead.`);return h[n]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class cn{constructor(e,n){this.type=gt,this.needle=e,this.haystack=n}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const h=n.parse(e[1],1,_t),m=n.parse(e[2],2,_t);return h&&m?pi(h.type,[gt,Pe,Te,Me,_t])?new cn(h,m):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Zr(h.type)} instead`):null}evaluate(e){const n=this.needle.evaluate(e),h=this.haystack.evaluate(e);if(!h)return!1;if(!bi(n,["boolean","string","number","null"]))throw new Jn(`Expected first argument to be of type boolean, string, number or null, but found ${Zr(kn(n))} instead.`);if(!bi(h,["string","array"]))throw new Jn(`Expected second argument to be of type array or string, but found ${Zr(kn(h))} instead.`);return h.indexOf(n)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class ls{constructor(e,n,h){this.type=Te,this.needle=e,this.haystack=n,this.fromIndex=h}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 2 or 3 arguments, but found ${e.length-1} instead.`);const h=n.parse(e[1],1,_t),m=n.parse(e[2],2,_t);if(!h||!m)return null;if(!pi(h.type,[gt,Pe,Te,Me,_t]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Zr(h.type)} instead`);if(e.length===4){const y=n.parse(e[3],3,Te);return y?new ls(h,m,y):null}return new ls(h,m)}evaluate(e){const n=this.needle.evaluate(e),h=this.haystack.evaluate(e);if(!bi(n,["boolean","string","number","null"]))throw new Jn(`Expected first argument to be of type boolean, string, number or null, but found ${Zr(kn(n))} instead.`);let m;if(this.fromIndex&&(m=this.fromIndex.evaluate(e)),bi(h,["string"])){const y=h.indexOf(n,m);return y===-1?-1:[...h.slice(0,y)].length}if(bi(h,["array"]))return h.indexOf(n,m);throw new Jn(`Expected second argument to be of type array or string, but found ${Zr(kn(h))} instead.`)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class Cn{constructor(e,n,h,m,y,v){this.inputType=e,this.type=n,this.input=h,this.cases=m,this.outputs=y,this.otherwise=v}static parse(e,n){if(e.length<5)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return n.error("Expected an even number of arguments.");let h,m;n.expectedType&&n.expectedType.kind!=="value"&&(m=n.expectedType);const y={},v=[];for(let P=2;P<e.length-1;P+=2){let z=e[P];const G=e[P+1];Array.isArray(z)||(z=[z]);const W=n.concat(P);if(z.length===0)return W.error("Expected at least one branch label.");for(const ie of z){if(typeof ie!="number"&&typeof ie!="string")return W.error("Branch labels must be numbers or strings.");if(typeof ie=="number"&&Math.abs(ie)>Number.MAX_SAFE_INTEGER)return W.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof ie=="number"&&Math.floor(ie)!==ie)return W.error("Numeric branch labels must be integer values.");if(h){if(W.checkSubtype(h,kn(ie)))return null}else h=kn(ie);if(y[String(ie)]!==void 0)return W.error("Branch labels must be unique.");y[String(ie)]=v.length}const K=n.parse(G,P,m);if(!K)return null;m=m||K.type,v.push(K)}const E=n.parse(e[1],1,_t);if(!E)return null;const k=n.parse(e[e.length-1],e.length-1,m);return k?E.type.kind!=="value"&&n.concat(1).checkSubtype(h,E.type)?null:new Cn(h,m,E,y,v,k):null}evaluate(e){const n=this.input.evaluate(e);return(kn(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))&&this.otherwise.outputDefined()}}class Cl{constructor(e,n,h){this.type=e,this.branches=n,this.otherwise=h}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return n.error("Expected an odd number of arguments.");let h;n.expectedType&&n.expectedType.kind!=="value"&&(h=n.expectedType);const m=[];for(let v=1;v<e.length-1;v+=2){const E=n.parse(e[v],v,gt);if(!E)return null;const k=n.parse(e[v+1],v+1,h);if(!k)return null;m.push([E,k]),h=h||k.type}const y=n.parse(e[e.length-1],e.length-1,h);if(!y)return null;if(!h)throw new Error("Can't infer output type");return new Cl(h,m,y)}evaluate(e){for(const[n,h]of this.branches)if(n.evaluate(e))return h.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[n,h]of this.branches)e(n),e(h);e(this.otherwise)}outputDefined(){return this.branches.every((([e,n])=>n.outputDefined()))&&this.otherwise.outputDefined()}}class Ti{constructor(e,n,h,m){this.type=e,this.input=n,this.beginIndex=h,this.endIndex=m}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 2 or 3 arguments, but found ${e.length-1} instead.`);const h=n.parse(e[1],1,_t),m=n.parse(e[2],2,Te);if(!h||!m)return null;if(!pi(h.type,[vn(_t),Pe,_t]))return n.error(`Expected first argument to be of type array or string, but found ${Zr(h.type)} instead`);if(e.length===4){const y=n.parse(e[3],3,Te);return y?new Ti(h.type,h,m,y):null}return new Ti(h.type,h,m)}evaluate(e){const n=this.input.evaluate(e),h=this.beginIndex.evaluate(e);let m;if(this.endIndex&&(m=this.endIndex.evaluate(e)),bi(n,["string"]))return[...n].slice(h,m).join("");if(bi(n,["array"]))return n.slice(h,m);throw new Jn(`Expected first argument to be of type array or string, but found ${Zr(kn(n))} instead.`)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function Jo(a,e){const n=a.length-1;let h,m,y=0,v=n,E=0;for(;y<=v;)if(E=Math.floor((y+v)/2),h=a[E],m=a[E+1],h<=e){if(E===n||e<m)return E;y=E+1}else{if(!(h>e))throw new Jn("Input is not a number.");v=E-1}return 0}class cs{constructor(e,n,h){this.type=e,this.input=n,this.labels=[],this.outputs=[];for(const[m,y]of h)this.labels.push(m),this.outputs.push(y)}static parse(e,n){if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");const h=n.parse(e[1],1,Te);if(!h)return null;const m=[];let y=null;n.expectedType&&n.expectedType.kind!=="value"&&(y=n.expectedType);for(let v=1;v<e.length;v+=2){const E=v===1?-1/0:e[v],k=e[v+1],P=v,z=v+1;if(typeof E!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',P);if(m.length&&m[m.length-1][0]>=E)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',P);const G=n.parse(k,z,y);if(!G)return null;y=y||G.type,m.push([E,G])}return new cs(y,h,m)}evaluate(e){const n=this.labels,h=this.outputs;if(n.length===1)return h[0].evaluate(e);const m=this.input.evaluate(e);if(m<=n[0])return h[0].evaluate(e);const y=n.length;return m>=n[y-1]?h[y-1].evaluate(e):h[Jo(n,m)].evaluate(e)}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}function Ic(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var Ls,du,Qo=(function(){if(du)return Ls;function a(e,n,h,m){this.cx=3*e,this.bx=3*(h-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(m-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=n,this.p2x=h,this.p2y=m}return du=1,Ls=a,a.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,n){if(n===void 0&&(n=1e-6),e<0)return 0;if(e>1)return 1;for(var h=e,m=0;m<8;m++){var y=this.sampleCurveX(h)-e;if(Math.abs(y)<n)return h;var v=this.sampleCurveDerivativeX(h);if(Math.abs(v)<1e-6)break;h-=y/v}var E=0,k=1;for(h=e,m=0;m<20&&(y=this.sampleCurveX(h),!(Math.abs(y-e)<n));m++)e>y?E=h:k=h,h=.5*(k-E)+E;return h},solve:function(e,n){return this.sampleCurveY(this.solveCurveX(e,n))}},Ls})(),$l=Ic(Qo);class ti{constructor(e,n,h,m,y){this.type=e,this.operator=n,this.interpolation=h,this.input=m,this.labels=[],this.outputs=[];for(const[v,E]of y)this.labels.push(v),this.outputs.push(E)}static interpolationFactor(e,n,h,m){let y=0;if(e.name==="exponential")y=zs(n,e.base,h,m);else if(e.name==="linear")y=zs(n,1,h,m);else if(e.name==="cubic-bezier"){const v=e.controlPoints;y=new $l(v[0],v[1],v[2],v[3]).solve(zs(n,1,h,m))}return y}static parse(e,n){let[h,m,y,...v]=e;if(!Array.isArray(m)||m.length===0)return n.error("Expected an interpolation type expression.",1);if(m[0]==="linear")m={name:"linear"};else if(m[0]==="exponential"){const P=m[1];if(typeof P!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:P}}else{if(m[0]!=="cubic-bezier")return n.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const P=m.slice(1);if(P.length!==4||P.some((z=>typeof z!="number"||z<0||z>1)))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:P}}}if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(y=n.parse(y,2,Te),!y)return null;const E=[];let k=null;h!=="interpolate-hcl"&&h!=="interpolate-lab"||n.expectedType==fr?n.expectedType&&n.expectedType.kind!=="value"&&(k=n.expectedType):k=jt;for(let P=0;P<v.length;P+=2){const z=v[P],G=v[P+1],W=P+3,K=P+4;if(typeof z!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',W);if(E.length&&E[E.length-1][0]>=z)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',W);const ie=n.parse(G,K,k);if(!ie)return null;k=k||ie.type,E.push([z,ie])}return oi(k,Te)||oi(k,Dt)||oi(k,jt)||oi(k,vr)||oi(k,_r)||oi(k,fr)||oi(k,Tn)||oi(k,vn(Te))?new ti(k,h,m,y,E):n.error(`Type ${Zr(k)} is not interpolatable.`)}evaluate(e){const n=this.labels,h=this.outputs;if(n.length===1)return h[0].evaluate(e);const m=this.input.evaluate(e);if(m<=n[0])return h[0].evaluate(e);const y=n.length;if(m>=n[y-1])return h[y-1].evaluate(e);const v=Jo(n,m),E=ti.interpolationFactor(this.interpolation,m,n[v],n[v+1]),k=h[v].evaluate(e),P=h[v+1].evaluate(e);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Al(k,P,E);case"color":return ln.interpolate(k,P,E);case"padding":return qa.interpolate(k,P,E);case"colorArray":return en.interpolate(k,P,E);case"numberArray":return Hn.interpolate(k,P,E);case"variableAnchorOffsetCollection":return Da.interpolate(k,P,E);case"array":return Ko(k,P,E);case"projectionDefinition":return $n.interpolate(k,P,E)}case"interpolate-hcl":switch(this.type.kind){case"color":return ln.interpolate(k,P,E,"hcl");case"colorArray":return en.interpolate(k,P,E,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return ln.interpolate(k,P,E,"lab");case"colorArray":return en.interpolate(k,P,E,"lab")}}}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}function zs(a,e,n,h){const m=h-n,y=a-n;return m===0?0:e===1?y/m:(Math.pow(e,y)-1)/(Math.pow(e,m)-1)}const ya={color:ln.interpolate,number:Al,padding:qa.interpolate,numberArray:Hn.interpolate,colorArray:en.interpolate,variableAnchorOffsetCollection:Da.interpolate,array:Ko};class Fi{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");let h=null;const m=n.expectedType;m&&m.kind!=="value"&&(h=m);const y=[];for(const E of e.slice(1)){const k=n.parse(E,1+y.length,h,void 0,{typeAnnotation:"omit"});if(!k)return null;h=h||k.type,y.push(k)}if(!h)throw new Error("No output type");const v=m&&y.some((E=>Fs(m,E.type)));return new Fi(v?_t:h,y)}evaluate(e){let n,h=null,m=0;for(const y of this.args)if(m++,h=y.evaluate(e),h&&h instanceof Ri&&!h.available&&(n||(n=h.name),h=null,m===this.args.length&&(h=n)),h!==null)break;return h}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}function Xl(a,e){return a==="=="||a==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function Yl(a,e,n,h){return h.compare(e,n)===0}function ua(a,e,n){const h=a!=="=="&&a!=="!=";return class Ew{constructor(y,v,E){this.type=gt,this.lhs=y,this.rhs=v,this.collator=E,this.hasUntypedArgument=y.type.kind==="value"||v.type.kind==="value"}static parse(y,v){if(y.length!==3&&y.length!==4)return v.error("Expected two or three arguments.");const E=y[0];let k=v.parse(y[1],1,_t);if(!k)return null;if(!Xl(E,k.type))return v.concat(1).error(`"${E}" comparisons are not supported for type '${Zr(k.type)}'.`);let P=v.parse(y[2],2,_t);if(!P)return null;if(!Xl(E,P.type))return v.concat(2).error(`"${E}" comparisons are not supported for type '${Zr(P.type)}'.`);if(k.type.kind!==P.type.kind&&k.type.kind!=="value"&&P.type.kind!=="value")return v.error(`Cannot compare types '${Zr(k.type)}' and '${Zr(P.type)}'.`);h&&(k.type.kind==="value"&&P.type.kind!=="value"?k=new ja(P.type,[k]):k.type.kind!=="value"&&P.type.kind==="value"&&(P=new ja(k.type,[P])));let z=null;if(y.length===4){if(k.type.kind!=="string"&&P.type.kind!=="string"&&k.type.kind!=="value"&&P.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(z=v.parse(y[3],3,or),!z)return null}return new Ew(k,P,z)}evaluate(y){const v=this.lhs.evaluate(y),E=this.rhs.evaluate(y);if(h&&this.hasUntypedArgument){const k=kn(v),P=kn(E);if(k.kind!==P.kind||k.kind!=="string"&&k.kind!=="number")throw new Jn(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${k.kind}, ${P.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){const k=kn(v),P=kn(E);if(k.kind!=="string"||P.kind!=="string")return e(y,v,E)}return this.collator?n(y,v,E,this.collator.evaluate(y)):e(y,v,E)}eachChild(y){y(this.lhs),y(this.rhs),this.collator&&y(this.collator)}outputDefined(){return!0}}}const If=ua("==",(function(a,e,n){return e===n}),Yl),Pc=ua("!=",(function(a,e,n){return e!==n}),(function(a,e,n,h){return!Yl(0,e,n,h)})),Hh=ua("<",(function(a,e,n){return e<n}),(function(a,e,n,h){return h.compare(e,n)<0})),na=ua(">",(function(a,e,n){return e>n}),(function(a,e,n,h){return h.compare(e,n)>0})),el=ua("<=",(function(a,e,n){return e<=n}),(function(a,e,n,h){return h.compare(e,n)<=0})),Zn=ua(">=",(function(a,e,n){return e>=n}),(function(a,e,n,h){return h.compare(e,n)>=0}));class yo{constructor(e,n,h){this.type=or,this.locale=h,this.caseSensitive=e,this.diacriticSensitive=n}static parse(e,n){if(e.length!==2)return n.error("Expected one argument.");const h=e[1];if(typeof h!="object"||Array.isArray(h))return n.error("Collator options argument must be an object.");const m=n.parse(h["case-sensitive"]!==void 0&&h["case-sensitive"],1,gt);if(!m)return null;const y=n.parse(h["diacritic-sensitive"]!==void 0&&h["diacritic-sensitive"],1,gt);if(!y)return null;let v=null;return h.locale&&(v=n.parse(h.locale,1,Pe),!v)?null:new yo(m,y,v)}evaluate(e){return new _o(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}class Kl{constructor(e,n,h,m,y){this.type=Pe,this.number=e,this.locale=n,this.currency=h,this.minFractionDigits=m,this.maxFractionDigits=y}static parse(e,n){if(e.length!==3)return n.error("Expected two arguments.");const h=n.parse(e[1],1,Te);if(!h)return null;const m=e[2];if(typeof m!="object"||Array.isArray(m))return n.error("NumberFormat options argument must be an object.");let y=null;if(m.locale&&(y=n.parse(m.locale,1,Pe),!y))return null;let v=null;if(m.currency&&(v=n.parse(m.currency,1,Pe),!v))return null;let E=null;if(m["min-fraction-digits"]&&(E=n.parse(m["min-fraction-digits"],1,Te),!E))return null;let k=null;return m["max-fraction-digits"]&&(k=n.parse(m["max-fraction-digits"],1,Te),!k)?null:new Kl(h,y,v,E,k)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class Jl{constructor(e){this.type=yr,this.sections=e}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const h=e[1];if(!Array.isArray(h)&&typeof h=="object")return n.error("First argument must be an image or text section.");const m=[];let y=!1;for(let v=1;v<=e.length-1;++v){const E=e[v];if(y&&typeof E=="object"&&!Array.isArray(E)){y=!1;let k=null;if(E["font-scale"]&&(k=n.parse(E["font-scale"],1,Te),!k))return null;let P=null;if(E["text-font"]&&(P=n.parse(E["text-font"],1,vn(Pe)),!P))return null;let z=null;if(E["text-color"]&&(z=n.parse(E["text-color"],1,jt),!z))return null;let G=null;if(E["vertical-align"]){if(typeof E["vertical-align"]=="string"&&!nh.includes(E["vertical-align"]))return n.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${E["vertical-align"]}' instead.`);if(G=n.parse(E["vertical-align"],1,Pe),!G)return null}const W=m[m.length-1];W.scale=k,W.font=P,W.textColor=z,W.verticalAlign=G}else{const k=n.parse(e[v],1,_t);if(!k)return null;const P=k.type.kind;if(P!=="string"&&P!=="value"&&P!=="null"&&P!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,m.push({content:k,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Jl(m)}evaluate(e){return new Ma(this.sections.map((n=>{const h=n.content.evaluate(e);return kn(h)===Ur?new Dc("",h,null,null,null,n.verticalAlign?n.verticalAlign.evaluate(e):null):new Dc(kl(h),null,n.scale?n.scale.evaluate(e):null,n.font?n.font.evaluate(e).join(","):null,n.textColor?n.textColor.evaluate(e):null,n.verticalAlign?n.verticalAlign.evaluate(e):null)})))}eachChild(e){for(const n of this.sections)e(n.content),n.scale&&e(n.scale),n.font&&e(n.font),n.textColor&&e(n.textColor),n.verticalAlign&&e(n.verticalAlign)}outputDefined(){return!1}}class Js{constructor(e){this.type=Ur,this.input=e}static parse(e,n){if(e.length!==2)return n.error("Expected two arguments.");const h=n.parse(e[1],1,Pe);return h?new Js(h):n.error("No image name provided.")}evaluate(e){const n=this.input.evaluate(e),h=Ri.fromString(n);return h&&e.availableImages&&(h.available=e.availableImages.indexOf(n)>-1),h}eachChild(e){e(this.input)}outputDefined(){return!1}}class Ml{constructor(e){this.type=Te,this.input=e}static parse(e,n){if(e.length!==2)return n.error(`Expected 1 argument, but found ${e.length-1} instead.`);const h=n.parse(e[1],1);return h?h.type.kind!=="array"&&h.type.kind!=="string"&&h.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${Zr(h.type)} instead.`):new Ml(h):null}evaluate(e){const n=this.input.evaluate(e);if(typeof n=="string")return[...n].length;if(Array.isArray(n))return n.length;throw new Jn(`Expected value to be of type string or array, but found ${Zr(kn(n))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const wa=8192;function Ql(a,e){const n=(180+a[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,m=Math.pow(2,e.z);return[Math.round(n*m*wa),Math.round(h*m*wa)]}function ec(a,e){const n=Math.pow(2,e.z);return[(m=(a[0]/wa+e.x)/n,360*m-180),(h=(a[1]/wa+e.y)/n,360/Math.PI*Math.atan(Math.exp((180-360*h)*Math.PI/180))-90)];var h,m}function vo(a,e){a[0]=Math.min(a[0],e[0]),a[1]=Math.min(a[1],e[1]),a[2]=Math.max(a[2],e[0]),a[3]=Math.max(a[3],e[1])}function tl(a,e){return!(a[0]<=e[0]||a[2]>=e[2]||a[1]<=e[1]||a[3]>=e[3])}function Fc(a,e,n){const h=a[0]-e[0],m=a[1]-e[1],y=a[0]-n[0],v=a[1]-n[1];return h*v-y*m==0&&h*y<=0&&m*v<=0}function rl(a,e,n,h){return(m=[h[0]-n[0],h[1]-n[1]])[0]*(y=[e[0]-a[0],e[1]-a[1]])[1]-m[1]*y[0]!=0&&!(!Ia(a,e,n,h)||!Ia(n,h,a,e));var m,y}function ah(a,e,n){for(const h of n)for(let m=0;m<h.length-1;++m)if(rl(a,e,h[m],h[m+1]))return!0;return!1}function us(a,e,n=!1){let h=!1;for(const E of e)for(let k=0;k<E.length-1;k++){if(Fc(a,E[k],E[k+1]))return n;(y=E[k])[1]>(m=a)[1]!=(v=E[k+1])[1]>m[1]&&m[0]<(v[0]-y[0])*(m[1]-y[1])/(v[1]-y[1])+y[0]&&(h=!h)}var m,y,v;return h}function pu(a,e){for(const n of e)if(us(a,n))return!0;return!1}function qh(a,e){for(const n of a)if(!us(n,e))return!1;for(let n=0;n<a.length-1;++n)if(ah(a[n],a[n+1],e))return!1;return!0}function Zh(a,e){for(const n of e)if(qh(a,n))return!0;return!1}function Ia(a,e,n,h){const m=h[0]-n[0],y=h[1]-n[1],v=(a[0]-n[0])*y-m*(a[1]-n[1]),E=(e[0]-n[0])*y-m*(e[1]-n[1]);return v>0&&E<0||v<0&&E>0}function Qs(a,e,n){const h=[];for(let m=0;m<a.length;m++){const y=[];for(let v=0;v<a[m].length;v++){const E=Ql(a[m][v],n);vo(e,E),y.push(E)}h.push(y)}return h}function ha(a,e,n){const h=[];for(let m=0;m<a.length;m++){const y=Qs(a[m],e,n);h.push(y)}return h}function Qi(a,e,n,h){if(a[0]<n[0]||a[0]>n[2]){const m=.5*h;let y=a[0]-n[0]>m?-h:n[0]-a[0]>m?h:0;y===0&&(y=a[0]-n[2]>m?-h:n[2]-a[0]>m?h:0),a[0]+=y}vo(e,a)}function tc(a,e,n,h){const m=Math.pow(2,h.z)*wa,y=[h.x*wa,h.y*wa],v=[];for(const E of a)for(const k of E){const P=[k.x+y[0],k.y+y[1]];Qi(P,e,n,m),v.push(P)}return v}function rc(a,e,n,h){const m=Math.pow(2,h.z)*wa,y=[h.x*wa,h.y*wa],v=[];for(const k of a){const P=[];for(const z of k){const G=[z.x+y[0],z.y+y[1]];vo(e,G),P.push(G)}v.push(P)}if(e[2]-e[0]<=m/2){(E=e)[0]=E[1]=1/0,E[2]=E[3]=-1/0;for(const k of v)for(const P of k)Qi(P,e,n,m)}var E;return v}class Os{constructor(e,n){this.type=gt,this.geojson=e,this.geometries=n}static parse(e,n){if(e.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(mi(e[1])){const h=e[1];if(h.type==="FeatureCollection"){const m=[];for(const y of h.features){const{type:v,coordinates:E}=y.geometry;v==="Polygon"&&m.push(E),v==="MultiPolygon"&&m.push(...E)}if(m.length)return new Os(h,{type:"MultiPolygon",coordinates:m})}else if(h.type==="Feature"){const m=h.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Os(h,h.geometry)}else if(h.type==="Polygon"||h.type==="MultiPolygon")return new Os(h,h)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return(function(n,h){const m=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],v=n.canonicalID();if(h.type==="Polygon"){const E=Qs(h.coordinates,y,v),k=tc(n.geometry(),m,y,v);if(!tl(m,y))return!1;for(const P of k)if(!us(P,E))return!1}if(h.type==="MultiPolygon"){const E=ha(h.coordinates,y,v),k=tc(n.geometry(),m,y,v);if(!tl(m,y))return!1;for(const P of k)if(!pu(P,E))return!1}return!0})(e,this.geometries);if(e.geometryType()==="LineString")return(function(n,h){const m=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],v=n.canonicalID();if(h.type==="Polygon"){const E=Qs(h.coordinates,y,v),k=rc(n.geometry(),m,y,v);if(!tl(m,y))return!1;for(const P of k)if(!qh(P,E))return!1}if(h.type==="MultiPolygon"){const E=ha(h.coordinates,y,v),k=rc(n.geometry(),m,y,v);if(!tl(m,y))return!1;for(const P of k)if(!Zh(P,E))return!1}return!0})(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let ws=class{constructor(a=[],e=(n,h)=>n<h?-1:n>h?1:0){if(this.data=a,this.length=this.data.length,this.compare=e,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(a){this.data.push(a),this._up(this.length++)}pop(){if(this.length===0)return;const a=this.data[0],e=this.data.pop();return--this.length>0&&(this.data[0]=e,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:e,compare:n}=this,h=e[a];for(;a>0;){const m=a-1>>1,y=e[m];if(n(h,y)>=0)break;e[a]=y,a=m}e[a]=h}_down(a){const{data:e,compare:n}=this,h=this.length>>1,m=e[a];for(;a<h;){let y=1+(a<<1);const v=y+1;if(v<this.length&&n(e[v],e[y])<0&&(y=v),n(e[y],m)>=0)break;e[a]=e[y],a=y}e[a]=m}};function Lc(a,e,n=0,h=a.length-1,m=mu){for(;h>n;){if(h-n>600){const k=h-n+1,P=e-n+1,z=Math.log(k),G=.5*Math.exp(2*z/3),W=.5*Math.sqrt(z*G*(k-G)/k)*(P-k/2<0?-1:1);Lc(a,e,Math.max(n,Math.floor(e-P*G/k+W)),Math.min(h,Math.floor(e+(k-P)*G/k+W)),m)}const y=a[e];let v=n,E=h;for(Ts(a,n,e),m(a[h],y)>0&&Ts(a,n,h);v<E;){for(Ts(a,v,E),v++,E--;m(a[v],y)<0;)v++;for(;m(a[E],y)>0;)E--}m(a[n],y)===0?Ts(a,n,E):(E++,Ts(a,E,h)),E<=e&&(n=E+1),e<=E&&(h=E-1)}}function Ts(a,e,n){const h=a[e];a[e]=a[n],a[n]=h}function mu(a,e){return a<e?-1:a>e?1:0}function zc(a,e){if(a.length<=1)return[a];const n=[];let h,m;for(const y of a){const v=Pf(y);v!==0&&(y.area=Math.abs(v),m===void 0&&(m=v<0),m===v<0?(h&&n.push(h),h=[y]):h.push(y))}if(h&&n.push(h),e>1)for(let y=0;y<n.length;y++)n[y].length<=e||(Lc(n[y],e,1,n[y].length-1,bo),n[y]=n[y].slice(0,e));return n}function bo(a,e){return e.area-a.area}function Pf(a){let e=0;for(let n,h,m=0,y=a.length,v=y-1;m<y;v=m++)n=a[m],h=a[v],e+=(h.x-n.x)*(n.y+h.y);return e}const Oc=1/298.257223563,Bs=Oc*(2-Oc),ih=Math.PI/180;class wo{constructor(e){const n=6378.137*ih*1e3,h=Math.cos(e*ih),m=1/(1-Bs*(1-h*h)),y=Math.sqrt(m);this.kx=n*y*h,this.ky=n*y*m*(1-Bs)}distance(e,n){const h=this.wrap(e[0]-n[0])*this.kx,m=(e[1]-n[1])*this.ky;return Math.sqrt(h*h+m*m)}pointOnLine(e,n){let h,m,y,v,E=1/0;for(let k=0;k<e.length-1;k++){let P=e[k][0],z=e[k][1],G=this.wrap(e[k+1][0]-P)*this.kx,W=(e[k+1][1]-z)*this.ky,K=0;G===0&&W===0||(K=(this.wrap(n[0]-P)*this.kx*G+(n[1]-z)*this.ky*W)/(G*G+W*W),K>1?(P=e[k+1][0],z=e[k+1][1]):K>0&&(P+=G/this.kx*K,z+=W/this.ky*K)),G=this.wrap(n[0]-P)*this.kx,W=(n[1]-z)*this.ky;const ie=G*G+W*W;ie<E&&(E=ie,h=P,m=z,y=k,v=K)}return{point:[h,m],index:y,t:Math.max(0,Math.min(1,v))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}}function Pa(a,e){return e[0]-a[0]}function eo(a){return a[1]-a[0]+1}function Ss(a,e){return a[1]>=a[0]&&a[1]<e}function gu(a,e){if(a[0]>a[1])return[null,null];const n=eo(a);if(e){if(n===2)return[a,null];const m=Math.floor(n/2);return[[a[0],a[0]+m],[a[0]+m,a[1]]]}if(n===1)return[a,null];const h=Math.floor(n/2)-1;return[[a[0],a[0]+h],[a[0]+h+1,a[1]]]}function sh(a,e){if(!Ss(e,a.length))return[1/0,1/0,-1/0,-1/0];const n=[1/0,1/0,-1/0,-1/0];for(let h=e[0];h<=e[1];++h)vo(n,a[h]);return n}function oh(a){const e=[1/0,1/0,-1/0,-1/0];for(const n of a)for(const h of n)vo(e,h);return e}function _u(a){return a[0]!==-1/0&&a[1]!==-1/0&&a[2]!==1/0&&a[3]!==1/0}function xu(a,e,n){if(!_u(a)||!_u(e))return NaN;let h=0,m=0;return a[2]<e[0]&&(h=e[0]-a[2]),a[0]>e[2]&&(h=a[0]-e[2]),a[1]>e[3]&&(m=a[1]-e[3]),a[3]<e[1]&&(m=e[1]-a[3]),n.distance([0,0],[h,m])}function es(a,e,n){const h=n.pointOnLine(e,a);return n.distance(a,h.point)}function nc(a,e,n,h,m){const y=Math.min(es(a,[n,h],m),es(e,[n,h],m)),v=Math.min(es(n,[a,e],m),es(h,[a,e],m));return Math.min(y,v)}function Bc(a,e,n,h,m){if(!Ss(e,a.length)||!Ss(h,n.length))return 1/0;let y=1/0;for(let v=e[0];v<e[1];++v){const E=a[v],k=a[v+1];for(let P=h[0];P<h[1];++P){const z=n[P],G=n[P+1];if(rl(E,k,z,G))return 0;y=Math.min(y,nc(E,k,z,G,m))}}return y}function Nc(a,e,n,h,m){if(!Ss(e,a.length)||!Ss(h,n.length))return NaN;let y=1/0;for(let v=e[0];v<=e[1];++v)for(let E=h[0];E<=h[1];++E)if(y=Math.min(y,m.distance(a[v],n[E])),y===0)return y;return y}function lh(a,e,n){if(us(a,e,!0))return 0;let h=1/0;for(const m of e){const y=m[0],v=m[m.length-1];if(y!==v&&(h=Math.min(h,es(a,[v,y],n)),h===0))return h;const E=n.pointOnLine(m,a);if(h=Math.min(h,n.distance(a,E.point)),h===0)return h}return h}function Dl(a,e,n,h){if(!Ss(e,a.length))return NaN;for(let y=e[0];y<=e[1];++y)if(us(a[y],n,!0))return 0;let m=1/0;for(let y=e[0];y<e[1];++y){const v=a[y],E=a[y+1];for(const k of n)for(let P=0,z=k.length,G=z-1;P<z;G=P++){const W=k[G],K=k[P];if(rl(v,E,W,K))return 0;m=Math.min(m,nc(v,E,W,K,h))}}return m}function To(a,e){for(const n of a)for(const h of n)if(us(h,e,!0))return!0;return!1}function Wh(a,e,n,h=1/0){const m=oh(a),y=oh(e);if(h!==1/0&&xu(m,y,n)>=h)return h;if(tl(m,y)){if(To(a,e))return 0}else if(To(e,a))return 0;let v=1/0;for(const E of a)for(let k=0,P=E.length,z=P-1;k<P;z=k++){const G=E[z],W=E[k];for(const K of e)for(let ie=0,oe=K.length,ue=oe-1;ie<oe;ue=ie++){const be=K[ue],We=K[ie];if(rl(G,W,be,We))return 0;v=Math.min(v,nc(G,W,be,We,n))}}return v}function Fn(a,e,n,h,m,y){if(!y)return;const v=xu(sh(h,y),m,n);v<e&&a.push([v,y,[0,0]])}function Es(a,e,n,h,m,y,v){if(!y||!v)return;const E=xu(sh(h,y),sh(m,v),n);E<e&&a.push([E,y,v])}function nl(a,e,n,h,m=1/0){let y=Math.min(h.distance(a[0],n[0][0]),m);if(y===0)return y;const v=new ws([[0,[0,a.length-1],[0,0]]],Pa),E=oh(n);for(;v.length>0;){const k=v.pop();if(k[0]>=y)continue;const P=k[1],z=e?50:100;if(eo(P)<=z){if(!Ss(P,a.length))return NaN;if(e){const G=Dl(a,P,n,h);if(isNaN(G)||G===0)return G;y=Math.min(y,G)}else for(let G=P[0];G<=P[1];++G){const W=lh(a[G],n,h);if(y=Math.min(y,W),y===0)return 0}}else{const G=gu(P,e);Fn(v,y,h,a,E,G[0]),Fn(v,y,h,a,E,G[1])}}return y}function yu(a,e,n,h,m,y=1/0){let v=Math.min(y,m.distance(a[0],n[0]));if(v===0)return v;const E=new ws([[0,[0,a.length-1],[0,n.length-1]]],Pa);for(;E.length>0;){const k=E.pop();if(k[0]>=v)continue;const P=k[1],z=k[2],G=e?50:100,W=h?50:100;if(eo(P)<=G&&eo(z)<=W){if(!Ss(P,a.length)&&Ss(z,n.length))return NaN;let K;if(e&&h)K=Bc(a,P,n,z,m),v=Math.min(v,K);else if(e&&!h){const ie=a.slice(P[0],P[1]+1);for(let oe=z[0];oe<=z[1];++oe)if(K=es(n[oe],ie,m),v=Math.min(v,K),v===0)return v}else if(!e&&h){const ie=n.slice(z[0],z[1]+1);for(let oe=P[0];oe<=P[1];++oe)if(K=es(a[oe],ie,m),v=Math.min(v,K),v===0)return v}else K=Nc(a,P,n,z,m),v=Math.min(v,K)}else{const K=gu(P,e),ie=gu(z,h);Es(E,v,m,a,n,K[0],ie[0]),Es(E,v,m,a,n,K[0],ie[1]),Es(E,v,m,a,n,K[1],ie[0]),Es(E,v,m,a,n,K[1],ie[1])}}return v}function ch(a){return a.type==="MultiPolygon"?a.coordinates.map((e=>({type:"Polygon",coordinates:e}))):a.type==="MultiLineString"?a.coordinates.map((e=>({type:"LineString",coordinates:e}))):a.type==="MultiPoint"?a.coordinates.map((e=>({type:"Point",coordinates:e}))):[a]}class ac{constructor(e,n){this.type=Te,this.geojson=e,this.geometries=n}static parse(e,n){if(e.length!==2)return n.error(`'distance' expression requires exactly one argument, but found ${e.length-1} instead.`);if(mi(e[1])){const h=e[1];if(h.type==="FeatureCollection")return new ac(h,h.features.map((m=>ch(m.geometry))).flat());if(h.type==="Feature")return new ac(h,ch(h.geometry));if("type"in h&&"coordinates"in h)return new ac(h,ch(h))}return n.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return(function(n,h){const m=n.geometry(),y=m.flat().map((k=>ec([k.x,k.y],n.canonical)));if(m.length===0)return NaN;const v=new wo(y[0][1]);let E=1/0;for(const k of h){switch(k.type){case"Point":E=Math.min(E,yu(y,!1,[k.coordinates],!1,v,E));break;case"LineString":E=Math.min(E,yu(y,!1,k.coordinates,!0,v,E));break;case"Polygon":E=Math.min(E,nl(y,!1,k.coordinates,v,E))}if(E===0)return E}return E})(e,this.geometries);if(e.geometryType()==="LineString")return(function(n,h){const m=n.geometry(),y=m.flat().map((k=>ec([k.x,k.y],n.canonical)));if(m.length===0)return NaN;const v=new wo(y[0][1]);let E=1/0;for(const k of h){switch(k.type){case"Point":E=Math.min(E,yu(y,!0,[k.coordinates],!1,v,E));break;case"LineString":E=Math.min(E,yu(y,!0,k.coordinates,!0,v,E));break;case"Polygon":E=Math.min(E,nl(y,!0,k.coordinates,v,E))}if(E===0)return E}return E})(e,this.geometries);if(e.geometryType()==="Polygon")return(function(n,h){const m=n.geometry();if(m.length===0||m[0].length===0)return NaN;const y=zc(m,0).map((k=>k.map((P=>P.map((z=>ec([z.x,z.y],n.canonical))))))),v=new wo(y[0][0][0][1]);let E=1/0;for(const k of h)for(const P of y){switch(k.type){case"Point":E=Math.min(E,nl([k.coordinates],!1,P,v,E));break;case"LineString":E=Math.min(E,nl(k.coordinates,!0,P,v,E));break;case"Polygon":E=Math.min(E,Wh(P,k.coordinates,v,E))}if(E===0)return E}return E})(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class vu{constructor(e){this.type=_t,this.key=e}static parse(e,n){if(e.length!==2)return n.error(`Expected 1 argument, but found ${e.length-1} instead.`);const h=e[1];return h==null?n.error("Global state property must be defined."):typeof h!="string"?n.error(`Global state property must be string, but found ${typeof e[1]} instead.`):new vu(h)}evaluate(e){var n;const h=(n=e.globals)===null||n===void 0?void 0:n.globalState;return h&&Object.keys(h).length!==0?$o(h,this.key):null}eachChild(){}outputDefined(){return!1}}const jc={"==":If,"!=":Pc,">":na,"<":Hh,">=":Zn,"<=":el,array:ja,at:_n,boolean:ja,case:Cl,coalesce:Fi,collator:yo,format:Jl,image:Js,in:cn,"index-of":ls,interpolate:ti,"interpolate-hcl":ti,"interpolate-lab":ti,length:Ml,let:qn,literal:Ea,match:Cn,number:ja,"number-format":Kl,object:ja,slice:Ti,step:cs,string:ja,"to-boolean":Pi,"to-color":Pi,"to-number":Pi,"to-string":Pi,var:Ji,within:Os,distance:ac,"global-state":vu};class gi{constructor(e,n,h,m){this.name=e,this.type=n,this._evaluate=h,this.args=m}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,n){const h=e[0],m=gi.definitions[h];if(!m)return n.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);const y=Array.isArray(m)?m[0]:m.type,v=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,E=v.filter((([P])=>!Array.isArray(P)||P.length===e.length-1));let k=null;for(const[P,z]of E){k=new xo(n.registry,Li,n.path,null,n.scope);const G=[];let W=!1;for(let K=1;K<e.length;K++){const ie=e[K],oe=Array.isArray(P)?P[K-1]:P.type,ue=k.parse(ie,1+G.length,oe);if(!ue){W=!0;break}G.push(ue)}if(!W)if(Array.isArray(P)&&P.length!==G.length)k.error(`Expected ${P.length} arguments, but found ${G.length} instead.`);else{for(let K=0;K<G.length;K++){const ie=Array.isArray(P)?P[K]:P.type,oe=G[K];k.concat(K+1).checkSubtype(ie,oe.type)}if(k.errors.length===0)return new gi(h,y,z,G)}}if(E.length===1)n.errors.push(...k.errors);else{const P=(E.length?E:v).map((([G])=>{return W=G,Array.isArray(W)?`(${W.map(Zr).join(", ")})`:`(${Zr(W.type)}...)`;var W})).join(" | "),z=[];for(let G=1;G<e.length;G++){const W=n.parse(e[G],1+z.length);if(!W)return null;z.push(Zr(W.type))}n.error(`Expected arguments of type ${P}, but found (${z.join(", ")}) instead.`)}return null}static register(e,n){gi.definitions=n;for(const h in n)e[h]=gi}}function uh(a,[e,n,h,m]){e=e.evaluate(a),n=n.evaluate(a),h=h.evaluate(a);const y=m?m.evaluate(a):1,v=ei(e,n,h,y);if(v)throw new Jn(v);return new ln(e/255,n/255,h/255,y,!1)}function ic(a,e){return a in e}function hs(a,e){const n=e[a];return n===void 0?null:n}function ts(a){return{type:a}}function Li(a){if(a instanceof Ji)return Li(a.boundExpression);if(a instanceof gi&&a.name==="error"||a instanceof yo||a instanceof Os||a instanceof ac||a instanceof vu)return!1;const e=a instanceof Pi||a instanceof ja;let n=!0;return a.eachChild((h=>{n=e?n&&Li(h):n&&h instanceof Ea})),!!n&&to(a)&&il(a,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function to(a){if(a instanceof gi&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof Os||a instanceof ac)return!1;let e=!0;return a.eachChild((n=>{e&&!to(n)&&(e=!1)})),e}function al(a){if(a instanceof gi&&a.name==="feature-state")return!1;let e=!0;return a.eachChild((n=>{e&&!al(n)&&(e=!1)})),e}function il(a,e){if(a instanceof gi&&e.indexOf(a.name)>=0)return!1;let n=!0;return a.eachChild((h=>{n&&!il(h,e)&&(n=!1)})),n}function bu(a){return{result:"success",value:a}}function Rl(a){return{result:"error",value:a}}function Ns(a){return a["property-type"]==="data-driven"||a["property-type"]==="cross-faded-data-driven"}function Uc(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function Vc(a){return!!a.expression&&a.expression.interpolated}function dn(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}function hh(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)&&kn(a)===At}function As(a){return a}function fh(a,e){const n=a.stops&&typeof a.stops[0][0]=="object",h=n||!(n||a.property!==void 0),m=a.type||(Vc(e)?"exponential":"interval"),y=(function(z){switch(z.type){case"color":return ln.parse;case"padding":return qa.parse;case"numberArray":return Hn.parse;case"colorArray":return en.parse;default:return null}})(e);if(y&&((a=ye({},a)).stops&&(a.stops=a.stops.map((z=>[z[0],y(z[1])]))),a.default=y(a.default?a.default:e.default)),a.colorSpace&&(v=a.colorSpace)!=="rgb"&&v!=="hcl"&&v!=="lab")throw new Error(`Unknown color space: "${a.colorSpace}"`);var v;const E=(function(z){switch(z){case"exponential":return Ht;case"interval":return ft;case"categorical":return Qe;case"identity":return Nt;default:throw new Error(`Unknown function type "${z}"`)}})(m);let k,P;if(m==="categorical"){k=Object.create(null);for(const z of a.stops)k[z[0]]=z[1];P=typeof a.stops[0][0]}if(n){const z={},G=[];for(let ie=0;ie<a.stops.length;ie++){const oe=a.stops[ie],ue=oe[0].zoom;z[ue]===void 0&&(z[ue]={zoom:ue,type:a.type,property:a.property,default:a.default,stops:[]},G.push(ue)),z[ue].stops.push([oe[0].value,oe[1]])}const W=[];for(const ie of G)W.push([z[ie].zoom,fh(z[ie],e)]);const K={name:"linear"};return{kind:"composite",interpolationType:K,interpolationFactor:ti.interpolationFactor.bind(void 0,K),zoomStops:W.map((ie=>ie[0])),evaluate:({zoom:ie},oe)=>Ht({stops:W,base:a.base},e,ie).evaluate(ie,oe)}}if(h){const z=m==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:z,interpolationFactor:ti.interpolationFactor.bind(void 0,z),zoomStops:a.stops.map((G=>G[0])),evaluate:({zoom:G})=>E(a,e,G,k,P)}}return{kind:"source",evaluate(z,G){const W=G&&G.properties?G.properties[a.property]:void 0;return W===void 0?Q(a.default,e.default):E(a,e,W,k,P)}}}function Q(a,e,n){return a!==void 0?a:e!==void 0?e:n!==void 0?n:void 0}function Qe(a,e,n,h,m){return Q(typeof n===m?h[n]:void 0,a.default,e.default)}function ft(a,e,n){if(dn(n)!=="number")return Q(a.default,e.default);const h=a.stops.length;if(h===1||n<=a.stops[0][0])return a.stops[0][1];if(n>=a.stops[h-1][0])return a.stops[h-1][1];const m=Jo(a.stops.map((y=>y[0])),n);return a.stops[m][1]}function Ht(a,e,n){const h=a.base!==void 0?a.base:1;if(dn(n)!=="number")return Q(a.default,e.default);const m=a.stops.length;if(m===1||n<=a.stops[0][0])return a.stops[0][1];if(n>=a.stops[m-1][0])return a.stops[m-1][1];const y=Jo(a.stops.map((z=>z[0])),n),v=(function(z,G,W,K){const ie=K-W,oe=z-W;return ie===0?0:G===1?oe/ie:(Math.pow(G,oe)-1)/(Math.pow(G,ie)-1)})(n,h,a.stops[y][0],a.stops[y+1][0]),E=a.stops[y][1],k=a.stops[y+1][1],P=ya[e.type]||As;return typeof E.evaluate=="function"?{evaluate(...z){const G=E.evaluate.apply(void 0,z),W=k.evaluate.apply(void 0,z);if(G!==void 0&&W!==void 0)return P(G,W,v,a.colorSpace)}}:P(E,k,v,a.colorSpace)}function Nt(a,e,n){switch(e.type){case"color":n=ln.parse(n);break;case"formatted":n=Ma.fromString(n.toString());break;case"resolvedImage":n=Ri.fromString(n.toString());break;case"padding":n=qa.parse(n);break;case"colorArray":n=en.parse(n);break;case"numberArray":n=Hn.parse(n);break;default:dn(n)===e.type||e.type==="enum"&&e.values[n]||(n=void 0)}return Q(n,a.default,e.default)}gi.register(jc,{error:[{kind:"error"},[Pe],(a,[e])=>{throw new Jn(e.evaluate(a))}],typeof:[Pe,[_t],(a,[e])=>Zr(kn(e.evaluate(a)))],"to-rgba":[vn(Te,4),[jt],(a,[e])=>{const[n,h,m,y]=e.evaluate(a).rgb;return[255*n,255*h,255*m,y]}],rgb:[jt,[Te,Te,Te],uh],rgba:[jt,[Te,Te,Te,Te],uh],has:{type:gt,overloads:[[[Pe],(a,[e])=>ic(e.evaluate(a),a.properties())],[[Pe,At],(a,[e,n])=>ic(e.evaluate(a),n.evaluate(a))]]},get:{type:_t,overloads:[[[Pe],(a,[e])=>hs(e.evaluate(a),a.properties())],[[Pe,At],(a,[e,n])=>hs(e.evaluate(a),n.evaluate(a))]]},"feature-state":[_t,[Pe],(a,[e])=>hs(e.evaluate(a),a.featureState||{})],properties:[At,[],a=>a.properties()],"geometry-type":[Pe,[],a=>a.geometryType()],id:[_t,[],a=>a.id()],zoom:[Te,[],a=>a.globals.zoom],"heatmap-density":[Te,[],a=>a.globals.heatmapDensity||0],elevation:[Te,[],a=>a.globals.elevation||0],"line-progress":[Te,[],a=>a.globals.lineProgress||0],accumulated:[_t,[],a=>a.globals.accumulated===void 0?null:a.globals.accumulated],"+":[Te,ts(Te),(a,e)=>{let n=0;for(const h of e)n+=h.evaluate(a);return n}],"*":[Te,ts(Te),(a,e)=>{let n=1;for(const h of e)n*=h.evaluate(a);return n}],"-":{type:Te,overloads:[[[Te,Te],(a,[e,n])=>e.evaluate(a)-n.evaluate(a)],[[Te],(a,[e])=>-e.evaluate(a)]]},"/":[Te,[Te,Te],(a,[e,n])=>e.evaluate(a)/n.evaluate(a)],"%":[Te,[Te,Te],(a,[e,n])=>e.evaluate(a)%n.evaluate(a)],ln2:[Te,[],()=>Math.LN2],pi:[Te,[],()=>Math.PI],e:[Te,[],()=>Math.E],"^":[Te,[Te,Te],(a,[e,n])=>Math.pow(e.evaluate(a),n.evaluate(a))],sqrt:[Te,[Te],(a,[e])=>Math.sqrt(e.evaluate(a))],log10:[Te,[Te],(a,[e])=>Math.log(e.evaluate(a))/Math.LN10],ln:[Te,[Te],(a,[e])=>Math.log(e.evaluate(a))],log2:[Te,[Te],(a,[e])=>Math.log(e.evaluate(a))/Math.LN2],sin:[Te,[Te],(a,[e])=>Math.sin(e.evaluate(a))],cos:[Te,[Te],(a,[e])=>Math.cos(e.evaluate(a))],tan:[Te,[Te],(a,[e])=>Math.tan(e.evaluate(a))],asin:[Te,[Te],(a,[e])=>Math.asin(e.evaluate(a))],acos:[Te,[Te],(a,[e])=>Math.acos(e.evaluate(a))],atan:[Te,[Te],(a,[e])=>Math.atan(e.evaluate(a))],min:[Te,ts(Te),(a,e)=>Math.min(...e.map((n=>n.evaluate(a))))],max:[Te,ts(Te),(a,e)=>Math.max(...e.map((n=>n.evaluate(a))))],abs:[Te,[Te],(a,[e])=>Math.abs(e.evaluate(a))],round:[Te,[Te],(a,[e])=>{const n=e.evaluate(a);return n<0?-Math.round(-n):Math.round(n)}],floor:[Te,[Te],(a,[e])=>Math.floor(e.evaluate(a))],ceil:[Te,[Te],(a,[e])=>Math.ceil(e.evaluate(a))],"filter-==":[gt,[Pe,_t],(a,[e,n])=>a.properties()[e.value]===n.value],"filter-id-==":[gt,[_t],(a,[e])=>a.id()===e.value],"filter-type-==":[gt,[Pe],(a,[e])=>a.geometryType()===e.value],"filter-<":[gt,[Pe,_t],(a,[e,n])=>{const h=a.properties()[e.value],m=n.value;return typeof h==typeof m&&h<m}],"filter-id-<":[gt,[_t],(a,[e])=>{const n=a.id(),h=e.value;return typeof n==typeof h&&n<h}],"filter->":[gt,[Pe,_t],(a,[e,n])=>{const h=a.properties()[e.value],m=n.value;return typeof h==typeof m&&h>m}],"filter-id->":[gt,[_t],(a,[e])=>{const n=a.id(),h=e.value;return typeof n==typeof h&&n>h}],"filter-<=":[gt,[Pe,_t],(a,[e,n])=>{const h=a.properties()[e.value],m=n.value;return typeof h==typeof m&&h<=m}],"filter-id-<=":[gt,[_t],(a,[e])=>{const n=a.id(),h=e.value;return typeof n==typeof h&&n<=h}],"filter->=":[gt,[Pe,_t],(a,[e,n])=>{const h=a.properties()[e.value],m=n.value;return typeof h==typeof m&&h>=m}],"filter-id->=":[gt,[_t],(a,[e])=>{const n=a.id(),h=e.value;return typeof n==typeof h&&n>=h}],"filter-has":[gt,[_t],(a,[e])=>e.value in a.properties()],"filter-has-id":[gt,[],a=>a.id()!==null&&a.id()!==void 0],"filter-type-in":[gt,[vn(Pe)],(a,[e])=>e.value.indexOf(a.geometryType())>=0],"filter-id-in":[gt,[vn(_t)],(a,[e])=>e.value.indexOf(a.id())>=0],"filter-in-small":[gt,[Pe,vn(_t)],(a,[e,n])=>n.value.indexOf(a.properties()[e.value])>=0],"filter-in-large":[gt,[Pe,vn(_t)],(a,[e,n])=>(function(h,m,y,v){for(;y<=v;){const E=y+v>>1;if(m[E]===h)return!0;m[E]>h?v=E-1:y=E+1}return!1})(a.properties()[e.value],n.value,0,n.value.length-1)],all:{type:gt,overloads:[[[gt,gt],(a,[e,n])=>e.evaluate(a)&&n.evaluate(a)],[ts(gt),(a,e)=>{for(const n of e)if(!n.evaluate(a))return!1;return!0}]]},any:{type:gt,overloads:[[[gt,gt],(a,[e,n])=>e.evaluate(a)||n.evaluate(a)],[ts(gt),(a,e)=>{for(const n of e)if(n.evaluate(a))return!0;return!1}]]},"!":[gt,[gt],(a,[e])=>!e.evaluate(a)],"is-supported-script":[gt,[Pe],(a,[e])=>{const n=a.globals&&a.globals.isSupportedScript;return!n||n(e.evaluate(a))}],upcase:[Pe,[Pe],(a,[e])=>e.evaluate(a).toUpperCase()],downcase:[Pe,[Pe],(a,[e])=>e.evaluate(a).toLowerCase()],concat:[Pe,ts(_t),(a,e)=>e.map((n=>kl(n.evaluate(a)))).join("")],"resolved-locale":[Pe,[or],(a,[e])=>e.evaluate(a).resolvedLocale()]});class gr{constructor(e,n,h){this.expression=e,this._warningHistory={},this._evaluator=new Ki,this._defaultValue=n?(function(m){if(m.type==="color"&&hh(m.default))return new ln(0,0,0,0);switch(m.type){case"color":return ln.parse(m.default)||null;case"padding":return qa.parse(m.default)||null;case"numberArray":return Hn.parse(m.default)||null;case"colorArray":return en.parse(m.default)||null;case"variableAnchorOffsetCollection":return Da.parse(m.default)||null;case"projectionDefinition":return $n.parse(m.default)||null;default:return m.default===void 0?null:m.default}})(n):null,this._enumValues=n&&n.type==="enum"?n.values:null,this._globalState=h}evaluateWithoutErrorHandling(e,n,h,m,y,v){return this._globalState&&(e=Dr(e,this._globalState)),this._evaluator.globals=e,this._evaluator.feature=n,this._evaluator.featureState=h,this._evaluator.canonical=m,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=v,this.expression.evaluate(this._evaluator)}evaluate(e,n,h,m,y,v){this._globalState&&(e=Dr(e,this._globalState)),this._evaluator.globals=e,this._evaluator.feature=n||null,this._evaluator.featureState=h||null,this._evaluator.canonical=m,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=v||null;try{const E=this.expression.evaluate(this._evaluator);if(E==null||typeof E=="number"&&E!=E)return this._defaultValue;if(this._enumValues&&!(E in this._enumValues))throw new Jn(`Expected value to be one of ${Object.keys(this._enumValues).map((k=>JSON.stringify(k))).join(", ")}, but found ${JSON.stringify(E)} instead.`);return E}catch(E){return this._warningHistory[E.message]||(this._warningHistory[E.message]=!0,typeof console<"u"&&console.warn(E.message)),this._defaultValue}}}function Jr(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in jc}function mn(a,e,n){const h=new xo(jc,Li,[],e?(function(y){const v={color:jt,string:Pe,number:Te,enum:Pe,boolean:gt,formatted:yr,padding:vr,numberArray:_r,colorArray:fr,projectionDefinition:Dt,resolvedImage:Ur,variableAnchorOffsetCollection:Tn};return y.type==="array"?vn(v[y.value]||_t,y.length):v[y.type]})(e):void 0),m=h.parse(a,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return m?bu(new gr(m,e,n)):Rl(h.errors)}class Vr{constructor(e,n,h){this.kind=e,this._styleExpression=n,this.isStateDependent=e!=="constant"&&!al(n.expression),this.globalStateRefs=Tr(n.expression),this._globalState=h}evaluateWithoutErrorHandling(e,n,h,m,y,v){return this._globalState&&(e=Dr(e,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(e,n,h,m,y,v)}evaluate(e,n,h,m,y,v){return this._globalState&&(e=Dr(e,this._globalState)),this._styleExpression.evaluate(e,n,h,m,y,v)}}class Hr{constructor(e,n,h,m,y){this.kind=e,this.zoomStops=h,this._styleExpression=n,this.isStateDependent=e!=="camera"&&!al(n.expression),this.globalStateRefs=Tr(n.expression),this.interpolationType=m,this._globalState=y}evaluateWithoutErrorHandling(e,n,h,m,y,v){return this._globalState&&(e=Dr(e,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(e,n,h,m,y,v)}evaluate(e,n,h,m,y,v){return this._globalState&&(e=Dr(e,this._globalState)),this._styleExpression.evaluate(e,n,h,m,y,v)}interpolationFactor(e,n,h){return this.interpolationType?ti.interpolationFactor(this.interpolationType,e,n,h):0}}function Pr(a,e,n){const h=mn(a,e,n);if(h.result==="error")return h;const m=h.value.expression,y=to(m);if(!y&&!Ns(e))return Rl([new je("","data expressions not supported")]);const v=il(m,["zoom"]);if(!v&&!Uc(e))return Rl([new je("","zoom expressions not supported")]);const E=dr(m);return E||v?E instanceof je?Rl([E]):E instanceof ti&&!Vc(e)?Rl([new je("",'"interpolate" expressions cannot be used with this property')]):bu(E?new Hr(y?"camera":"composite",h.value,E.labels,E instanceof ti?E.interpolation:void 0,n):new Vr(y?"constant":"source",h.value,n)):Rl([new je("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Wr{constructor(e,n){this._parameters=e,this._specification=n,ye(this,fh(this._parameters,this._specification))}static deserialize(e){return new Wr(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function dr(a){let e=null;if(a instanceof qn)e=dr(a.result);else if(a instanceof Fi){for(const n of a.args)if(e=dr(n),e)break}else(a instanceof cs||a instanceof ti)&&a.input instanceof gi&&a.input.name==="zoom"&&(e=a);return e instanceof je||a.eachChild((n=>{const h=dr(n);h instanceof je?e=h:!e&&h?e=new je("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&h&&e!==h&&(e=new je("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),e}function Tr(a,e=new Set){return a instanceof vu&&e.add(a.key),a.eachChild((n=>{Tr(n,e)})),e}function Dr(a,e){const{zoom:n,heatmapDensity:h,elevation:m,lineProgress:y,isSupportedScript:v,accumulated:E}=a??{};return{zoom:n,heatmapDensity:h,elevation:m,lineProgress:y,isSupportedScript:v,accumulated:E,globalState:e}}function zr(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const e of a.slice(1))if(!zr(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}const Fr={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function sn(a,e){if(a==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};zr(a)||(a=nn(a));const n=mn(a,Fr,e);if(n.result==="error")throw new Error(n.value.map((h=>`${h.key}: ${h.message}`)).join(", "));return{filter:(h,m,y)=>n.value.evaluate(h,m,{},y),needGeometry:Sr(a),getGlobalStateRefs:()=>Tr(n.value.expression)}}function xr(a,e){return a<e?-1:a>e?1:0}function Sr(a){if(!Array.isArray(a))return!1;if(a[0]==="within"||a[0]==="distance")return!0;for(let e=1;e<a.length;e++)if(Sr(a[e]))return!0;return!1}function nn(a){if(!a)return!0;const e=a[0];return a.length<=1?e!=="any":e==="=="?qr(a[1],a[2],"=="):e==="!="?Br(qr(a[1],a[2],"==")):e==="<"||e===">"||e==="<="||e===">="?qr(a[1],a[2],e):e==="any"?(n=a.slice(1),["any"].concat(n.map(nn))):e==="all"?["all"].concat(a.slice(1).map(nn)):e==="none"?["all"].concat(a.slice(1).map(nn).map(Br)):e==="in"?un(a[1],a.slice(2)):e==="!in"?Br(un(a[1],a.slice(2))):e==="has"?Er(a[1]):e!=="!has"||Br(Er(a[1]));var n}function qr(a,e,n){switch(a){case"$type":return[`filter-type-${n}`,e];case"$id":return[`filter-id-${n}`,e];default:return[`filter-${n}`,a,e]}}function un(a,e){if(e.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((n=>typeof n!=typeof e[0]))?["filter-in-large",a,["literal",e.sort(xr)]]:["filter-in-small",a,["literal",e]]}}function Er(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function Br(a){return["!",a]}function Nr(a){const e=typeof a;if(e==="number"||e==="boolean"||e==="string"||a==null)return JSON.stringify(a);if(Array.isArray(a)){let m="[";for(const y of a)m+=`${Nr(y)},`;return`${m}]`}const n=Object.keys(a).sort();let h="{";for(let m=0;m<n.length;m++)h+=`${JSON.stringify(n[m])}:${Nr(a[n[m]])},`;return`${h}}`}function Wn(a){let e="";for(const n of En)e+=`/${Nr(a[n])}`;return e}function Gr(a){const e=a.value;return e?[new Qt(a.key,e,"constants have been deprecated as of v8")]:[]}function gn(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function fa(a){if(Array.isArray(a))return a.map(fa);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const e={};for(const n in a)e[n]=fa(a[n]);return e}return gn(a)}function Za(a){const e=a.key,n=a.value,h=a.valueSpec||{},m=a.objectElementValidators||{},y=a.style,v=a.styleSpec,E=a.validateSpec;let k=[];const P=dn(n);if(P!=="object")return[new Qt(e,n,`object expected, ${P} found`)];for(const z in n){const G=z.split(".")[0],W=$o(h,G)||h["*"];let K;if($o(m,G))K=m[G];else if($o(h,G)){if(n[z]===void 0)continue;K=E}else if(m["*"])K=m["*"];else{if(!h["*"]){k.push(new Qt(e,n[z],`unknown property "${z}"`));continue}K=E}k=k.concat(K({key:(e&&`${e}.`)+z,value:n[z],valueSpec:W,style:y,styleSpec:v,object:n,objectKey:z,validateSpec:E},n))}for(const z in h)m[z]||h[z].required&&h[z].default===void 0&&n[z]===void 0&&k.push(new Qt(e,n,`missing required property "${z}"`));return k}function js(a){const e=a.value,n=a.valueSpec,h=a.style,m=a.styleSpec,y=a.key,v=a.arrayElementValidator||a.validateSpec;if(dn(e)!=="array")return[new Qt(y,e,`array expected, ${dn(e)} found`)];if(n.length&&e.length!==n.length)return[new Qt(y,e,`array length ${n.length} expected, length ${e.length} found`)];let E={type:n.value,values:n.values};m.$version<7&&(E.function=n.function),dn(n.value)==="object"&&(E=n.value);let k=[];for(let P=0;P<e.length;P++)k=k.concat(v({array:e,arrayIndex:P,value:e[P],valueSpec:E,validateSpec:a.validateSpec,style:h,styleSpec:m,key:`${y}[${P}]`}));return k}function fs(a){const e=a.key,n=a.value,h=a.valueSpec;let m=dn(n);return m==="number"&&n!=n&&(m="NaN"),m!=="number"?[new Qt(e,n,`number expected, ${m} found`)]:"minimum"in h&&n<h.minimum?[new Qt(e,n,`${n} is less than the minimum value ${h.minimum}`)]:"maximum"in h&&n>h.maximum?[new Qt(e,n,`${n} is greater than the maximum value ${h.maximum}`)]:[]}function zi(a){const e=a.valueSpec,n=gn(a.value.type);let h,m,y,v={};const E=n!=="categorical"&&a.value.property===void 0,k=!E,P=dn(a.value.stops)==="array"&&dn(a.value.stops[0])==="array"&&dn(a.value.stops[0][0])==="object",z=Za({key:a.key,value:a.value,valueSpec:a.styleSpec.function,validateSpec:a.validateSpec,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(K){if(n==="identity")return[new Qt(K.key,K.value,'identity function may not have a "stops" property')];let ie=[];const oe=K.value;return ie=ie.concat(js({key:K.key,value:oe,valueSpec:K.valueSpec,validateSpec:K.validateSpec,style:K.style,styleSpec:K.styleSpec,arrayElementValidator:G})),dn(oe)==="array"&&oe.length===0&&ie.push(new Qt(K.key,oe,"array must have at least one stop")),ie},default:function(K){return K.validateSpec({key:K.key,value:K.value,valueSpec:e,validateSpec:K.validateSpec,style:K.style,styleSpec:K.styleSpec})}}});return n==="identity"&&E&&z.push(new Qt(a.key,a.value,'missing required property "property"')),n==="identity"||a.value.stops||z.push(new Qt(a.key,a.value,'missing required property "stops"')),n==="exponential"&&a.valueSpec.expression&&!Vc(a.valueSpec)&&z.push(new Qt(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(k&&!Ns(a.valueSpec)?z.push(new Qt(a.key,a.value,"property functions not supported")):E&&!Uc(a.valueSpec)&&z.push(new Qt(a.key,a.value,"zoom functions not supported"))),n!=="categorical"&&!P||a.value.property!==void 0||z.push(new Qt(a.key,a.value,'"property" property is required')),z;function G(K){let ie=[];const oe=K.value,ue=K.key;if(dn(oe)!=="array")return[new Qt(ue,oe,`array expected, ${dn(oe)} found`)];if(oe.length!==2)return[new Qt(ue,oe,`array length 2 expected, length ${oe.length} found`)];if(P){if(dn(oe[0])!=="object")return[new Qt(ue,oe,`object expected, ${dn(oe[0])} found`)];if(oe[0].zoom===void 0)return[new Qt(ue,oe,"object stop key must have zoom")];if(oe[0].value===void 0)return[new Qt(ue,oe,"object stop key must have value")];if(y&&y>gn(oe[0].zoom))return[new Qt(ue,oe[0].zoom,"stop zoom values must appear in ascending order")];gn(oe[0].zoom)!==y&&(y=gn(oe[0].zoom),m=void 0,v={}),ie=ie.concat(Za({key:`${ue}[0]`,value:oe[0],valueSpec:{zoom:{}},validateSpec:K.validateSpec,style:K.style,styleSpec:K.styleSpec,objectElementValidators:{zoom:fs,value:W}}))}else ie=ie.concat(W({key:`${ue}[0]`,value:oe[0],validateSpec:K.validateSpec,style:K.style,styleSpec:K.styleSpec},oe));return Jr(fa(oe[1]))?ie.concat([new Qt(`${ue}[1]`,oe[1],"expressions are not allowed in function stops.")]):ie.concat(K.validateSpec({key:`${ue}[1]`,value:oe[1],valueSpec:e,validateSpec:K.validateSpec,style:K.style,styleSpec:K.styleSpec}))}function W(K,ie){const oe=dn(K.value),ue=gn(K.value),be=K.value!==null?K.value:ie;if(h){if(oe!==h)return[new Qt(K.key,be,`${oe} stop domain type must match previous stop domain type ${h}`)]}else h=oe;if(oe!=="number"&&oe!=="string"&&oe!=="boolean")return[new Qt(K.key,be,"stop domain value must be a number, string, or boolean")];if(oe!=="number"&&n!=="categorical"){let We=`number expected, ${oe} found`;return Ns(e)&&n===void 0&&(We+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Qt(K.key,be,We)]}return n!=="categorical"||oe!=="number"||isFinite(ue)&&Math.floor(ue)===ue?n!=="categorical"&&oe==="number"&&m!==void 0&&ue<m?[new Qt(K.key,be,"stop domain values must appear in ascending order")]:(m=ue,n==="categorical"&&ue in v?[new Qt(K.key,be,"stop domain values must be unique")]:(v[ue]=!0,[])):[new Qt(K.key,be,`integer expected, found ${ue}`)]}}function Oi(a){const e=(a.expressionContext==="property"?Pr:mn)(fa(a.value),a.valueSpec);if(e.result==="error")return e.value.map((h=>new Qt(`${a.key}${h.key}`,a.value,h.message)));const n=e.value.expression||e.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!n.outputDefined())return[new Qt(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!al(n))return[new Qt(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter"&&!al(n))return[new Qt(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!il(n,["zoom","feature-state"]))return[new Qt(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!to(n))return[new Qt(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ro(a){const e=a.key,n=a.value,h=dn(n);return h!=="string"?[new Qt(e,n,`color expected, ${h} found`)]:ln.parse(String(n))?[]:[new Qt(e,n,`color expected, "${n}" found`)]}function no(a){const e=a.key,n=a.value,h=a.valueSpec,m=[];return Array.isArray(h.values)?h.values.indexOf(gn(n))===-1&&m.push(new Qt(e,n,`expected one of [${h.values.join(", ")}], ${JSON.stringify(n)} found`)):Object.keys(h.values).indexOf(gn(n))===-1&&m.push(new Qt(e,n,`expected one of [${Object.keys(h.values).join(", ")}], ${JSON.stringify(n)} found`)),m}function ds(a){return zr(fa(a.value))?Oi(ye({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):ri(a)}function ri(a){const e=a.value,n=a.key;if(dn(e)!=="array")return[new Qt(n,e,`array expected, ${dn(e)} found`)];const h=a.styleSpec;let m,y=[];if(e.length<1)return[new Qt(n,e,"filter array must have at least 1 element")];switch(y=y.concat(no({key:`${n}[0]`,value:e[0],valueSpec:h.filter_operator,style:a.style,styleSpec:a.styleSpec})),gn(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&gn(e[1])==="$type"&&y.push(new Qt(n,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&y.push(new Qt(n,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(m=dn(e[1]),m!=="string"&&y.push(new Qt(`${n}[1]`,e[1],`string expected, ${m} found`)));for(let v=2;v<e.length;v++)m=dn(e[v]),gn(e[1])==="$type"?y=y.concat(no({key:`${n}[${v}]`,value:e[v],valueSpec:h.geometry_type,style:a.style,styleSpec:a.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&y.push(new Qt(`${n}[${v}]`,e[v],`string, number, or boolean expected, ${m} found`));break;case"any":case"all":case"none":for(let v=1;v<e.length;v++)y=y.concat(ri({key:`${n}[${v}]`,value:e[v],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":m=dn(e[1]),e.length!==2?y.push(new Qt(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):m!=="string"&&y.push(new Qt(`${n}[1]`,e[1],`string expected, ${m} found`))}return y}function Bi(a,e){const n=a.key,h=a.validateSpec,m=a.style,y=a.styleSpec,v=a.value,E=a.objectKey,k=y[`${e}_${a.layerType}`];if(!k)return[];const P=E.match(/^(.*)-transition$/);if(e==="paint"&&P&&k[P[1]]&&k[P[1]].transition)return h({key:n,value:v,valueSpec:y.transition,style:m,styleSpec:y});const z=a.valueSpec||k[E];if(!z)return[new Qt(n,v,`unknown property "${E}"`)];let G;if(dn(v)==="string"&&Ns(z)&&!z.tokens&&(G=/^{([^}]+)}$/.exec(v)))return[new Qt(n,v,`"${E}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(G[1])} }\`.`)];const W=[];return a.layerType==="symbol"&&E==="text-font"&&hh(fa(v))&&gn(v.type)==="identity"&&W.push(new Qt(n,v,'"text-font" does not support identity functions')),W.concat(h({key:a.key,value:v,valueSpec:z,style:m,styleSpec:y,expressionContext:"property",propertyType:e,propertyKey:E}))}function Si(a){return Bi(a,"paint")}function ks(a){return Bi(a,"layout")}function Il(a){let e=[];const n=a.value,h=a.key,m=a.style,y=a.styleSpec;if(dn(n)!=="object")return[new Qt(h,n,`object expected, ${dn(n)} found`)];n.type||n.ref||e.push(new Qt(h,n,'either "type" or "ref" is required'));let v=gn(n.type);const E=gn(n.ref);if(n.id){const k=gn(n.id);for(let P=0;P<a.arrayIndex;P++){const z=m.layers[P];gn(z.id)===k&&e.push(new Qt(h,n.id,`duplicate layer id "${n.id}", previously used at line ${z.id.__line__}`))}}if("ref"in n){let k;["type","source","source-layer","filter","layout"].forEach((P=>{P in n&&e.push(new Qt(h,n[P],`"${P}" is prohibited for ref layers`))})),m.layers.forEach((P=>{gn(P.id)===E&&(k=P)})),k?k.ref?e.push(new Qt(h,n.ref,"ref cannot reference another ref layer")):v=gn(k.type):e.push(new Qt(h,n.ref,`ref layer "${E}" not found`))}else if(v!=="background")if(n.source){const k=m.sources&&m.sources[n.source],P=k&&gn(k.type);k?P==="vector"&&v==="raster"?e.push(new Qt(h,n.source,`layer "${n.id}" requires a raster source`)):P!=="raster-dem"&&v==="hillshade"||P!=="raster-dem"&&v==="color-relief"?e.push(new Qt(h,n.source,`layer "${n.id}" requires a raster-dem source`)):P==="raster"&&v!=="raster"?e.push(new Qt(h,n.source,`layer "${n.id}" requires a vector source`)):P!=="vector"||n["source-layer"]?P==="raster-dem"&&v!=="hillshade"&&v!=="color-relief"?e.push(new Qt(h,n.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):v!=="line"||!n.paint||!n.paint["line-gradient"]||P==="geojson"&&k.lineMetrics||e.push(new Qt(h,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Qt(h,n,`layer "${n.id}" must specify a "source-layer"`)):e.push(new Qt(h,n.source,`source "${n.source}" not found`))}else e.push(new Qt(h,n,'missing required property "source"'));return e=e.concat(Za({key:h,value:n,valueSpec:y.layer,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,objectElementValidators:{"*":()=>[],type:()=>a.validateSpec({key:`${h}.type`,value:n.type,valueSpec:y.layer.type,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,object:n,objectKey:"type"}),filter:ds,layout:k=>Za({layer:n,key:k.key,value:k.value,style:k.style,styleSpec:k.styleSpec,validateSpec:k.validateSpec,objectElementValidators:{"*":P=>ks(ye({layerType:v},P))}}),paint:k=>Za({layer:n,key:k.key,value:k.value,style:k.style,styleSpec:k.styleSpec,validateSpec:k.validateSpec,objectElementValidators:{"*":P=>Si(ye({layerType:v},P))}})}})),e}function Cs(a){const e=a.value,n=a.key,h=dn(e);return h!=="string"?[new Qt(n,e,`string expected, ${h} found`)]:[]}const sc={promoteId:function({key:a,value:e}){if(dn(e)==="string")return Cs({key:a,value:e});{const n=[];for(const h in e)n.push(...Cs({key:`${a}.${h}`,value:e[h]}));return n}}};function So(a){const e=a.value,n=a.key,h=a.styleSpec,m=a.style,y=a.validateSpec;if(!e.type)return[new Qt(n,e,'"type" is required')];const v=gn(e.type);let E;switch(v){case"vector":case"raster":return E=Za({key:n,value:e,valueSpec:h[`source_${v.replace("-","_")}`],style:a.style,styleSpec:h,objectElementValidators:sc,validateSpec:y}),E;case"raster-dem":return E=(function(k){var P;const z=(P=k.sourceName)!==null&&P!==void 0?P:"",G=k.value,W=k.styleSpec,K=W.source_raster_dem,ie=k.style;let oe=[];const ue=dn(G);if(G===void 0)return oe;if(ue!=="object")return oe.push(new Qt("source_raster_dem",G,`object expected, ${ue} found`)),oe;const be=gn(G.encoding)==="custom",We=["redFactor","greenFactor","blueFactor","baseShift"],Se=k.value.encoding?`"${k.value.encoding}"`:"Default";for(const De in G)!be&&We.includes(De)?oe.push(new Qt(De,G[De],`In "${z}": "${De}" is only valid when "encoding" is set to "custom". ${Se} encoding found`)):K[De]?oe=oe.concat(k.validateSpec({key:De,value:G[De],valueSpec:K[De],validateSpec:k.validateSpec,style:ie,styleSpec:W})):oe.push(new Qt(De,G[De],`unknown property "${De}"`));return oe})({sourceName:n,value:e,style:a.style,styleSpec:h,validateSpec:y}),E;case"geojson":if(E=Za({key:n,value:e,valueSpec:h.source_geojson,style:m,styleSpec:h,validateSpec:y,objectElementValidators:sc}),e.cluster)for(const k in e.clusterProperties){const[P,z]=e.clusterProperties[k],G=typeof P=="string"?[P,["accumulated"],["get",k]]:P;E.push(...Oi({key:`${n}.${k}.map`,value:z,expressionContext:"cluster-map"})),E.push(...Oi({key:`${n}.${k}.reduce`,value:G,expressionContext:"cluster-reduce"}))}return E;case"video":return Za({key:n,value:e,valueSpec:h.source_video,style:m,validateSpec:y,styleSpec:h});case"image":return Za({key:n,value:e,valueSpec:h.source_image,style:m,validateSpec:y,styleSpec:h});case"canvas":return[new Qt(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return no({key:`${n}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Wa(a){const e=a.value,n=a.styleSpec,h=n.light,m=a.style;let y=[];const v=dn(e);if(e===void 0)return y;if(v!=="object")return y=y.concat([new Qt("light",e,`object expected, ${v} found`)]),y;for(const E in e){const k=E.match(/^(.*)-transition$/);y=y.concat(k&&h[k[1]]&&h[k[1]].transition?a.validateSpec({key:E,value:e[E],valueSpec:n.transition,validateSpec:a.validateSpec,style:m,styleSpec:n}):h[E]?a.validateSpec({key:E,value:e[E],valueSpec:h[E],validateSpec:a.validateSpec,style:m,styleSpec:n}):[new Qt(E,e[E],`unknown property "${E}"`)])}return y}function wu(a){const e=a.value,n=a.styleSpec,h=n.sky,m=a.style,y=dn(e);if(e===void 0)return[];if(y!=="object")return[new Qt("sky",e,`object expected, ${y} found`)];let v=[];for(const E in e)v=v.concat(h[E]?a.validateSpec({key:E,value:e[E],valueSpec:h[E],style:m,styleSpec:n}):[new Qt(E,e[E],`unknown property "${E}"`)]);return v}function dh(a){const e=a.value,n=a.styleSpec,h=n.terrain,m=a.style;let y=[];const v=dn(e);if(e===void 0)return y;if(v!=="object")return y=y.concat([new Qt("terrain",e,`object expected, ${v} found`)]),y;for(const E in e)y=y.concat(h[E]?a.validateSpec({key:E,value:e[E],valueSpec:h[E],validateSpec:a.validateSpec,style:m,styleSpec:n}):[new Qt(E,e[E],`unknown property "${E}"`)]);return y}function $h(a){let e=[];const n=a.value,h=a.key;if(Array.isArray(n)){const m=[],y=[];for(const v in n)n[v].id&&m.includes(n[v].id)&&e.push(new Qt(h,n,`all the sprites' ids must be unique, but ${n[v].id} is duplicated`)),m.push(n[v].id),n[v].url&&y.includes(n[v].url)&&e.push(new Qt(h,n,`all the sprites' URLs must be unique, but ${n[v].url} is duplicated`)),y.push(n[v].url),e=e.concat(Za({key:`${h}[${v}]`,value:n[v],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:a.validateSpec}));return e}return Cs({key:h,value:n})}function Tu(a){return!!a&&a.constructor===Object}function ph(a){return Tu(a.value)?[]:[new Qt(a.key,a.value,`object expected, ${dn(a.value)} found`)]}const Ua={"*":()=>[],array:js,boolean:function(a){const e=a.value,n=a.key,h=dn(e);return h!=="boolean"?[new Qt(n,e,`boolean expected, ${h} found`)]:[]},number:fs,color:ro,constants:Gr,enum:no,filter:ds,function:zi,layer:Il,object:Za,source:So,light:Wa,sky:wu,terrain:dh,projection:function(a){const e=a.value,n=a.styleSpec,h=n.projection,m=a.style,y=dn(e);if(e===void 0)return[];if(y!=="object")return[new Qt("projection",e,`object expected, ${y} found`)];let v=[];for(const E in e)v=v.concat(h[E]?a.validateSpec({key:E,value:e[E],valueSpec:h[E],style:m,styleSpec:n}):[new Qt(E,e[E],`unknown property "${E}"`)]);return v},projectionDefinition:function(a){const e=a.key;let n=a.value;n=n instanceof String?n.valueOf():n;const h=dn(n);return h!=="array"||(function(m){return Array.isArray(m)&&m.length===3&&typeof m[0]=="string"&&typeof m[1]=="string"&&typeof m[2]=="number"})(n)||(function(m){return!!["interpolate","step","literal"].includes(m[0])})(n)?["array","string"].includes(h)?[]:[new Qt(e,n,`projection expected, invalid type "${h}" found`)]:[new Qt(e,n,`projection expected, invalid array ${JSON.stringify(n)} found`)]},string:Cs,formatted:function(a){return Cs(a).length===0?[]:Oi(a)},resolvedImage:function(a){return Cs(a).length===0?[]:Oi(a)},padding:function(a){const e=a.key,n=a.value;if(dn(n)==="array"){if(n.length<1||n.length>4)return[new Qt(e,n,`padding requires 1 to 4 values; ${n.length} values found`)];const h={type:"number"};let m=[];for(let y=0;y<n.length;y++)m=m.concat(a.validateSpec({key:`${e}[${y}]`,value:n[y],validateSpec:a.validateSpec,valueSpec:h}));return m}return fs({key:e,value:n,valueSpec:{}})},numberArray:function(a){const e=a.key,n=a.value;if(dn(n)==="array"){const h={type:"number"};if(n.length<1)return[new Qt(e,n,"array length at least 1 expected, length 0 found")];let m=[];for(let y=0;y<n.length;y++)m=m.concat(a.validateSpec({key:`${e}[${y}]`,value:n[y],validateSpec:a.validateSpec,valueSpec:h}));return m}return fs({key:e,value:n,valueSpec:{}})},colorArray:function(a){const e=a.key,n=a.value;if(dn(n)==="array"){if(n.length<1)return[new Qt(e,n,"array length at least 1 expected, length 0 found")];let h=[];for(let m=0;m<n.length;m++)h=h.concat(ro({key:`${e}[${m}]`,value:n[m]}));return h}return ro({key:e,value:n})},variableAnchorOffsetCollection:function(a){const e=a.key,n=a.value,h=dn(n),m=a.styleSpec;if(h!=="array"||n.length<1||n.length%2!=0)return[new Qt(e,n,"variableAnchorOffsetCollection requires a non-empty array of even length")];let y=[];for(let v=0;v<n.length;v+=2)y=y.concat(no({key:`${e}[${v}]`,value:n[v],valueSpec:m.layout_symbol["text-anchor"]})),y=y.concat(js({key:`${e}[${v+1}]`,value:n[v+1],valueSpec:{length:2,value:"number"},validateSpec:a.validateSpec,style:a.style,styleSpec:m}));return y},sprite:$h,state:ph,fontFaces:function(a){const e=a.key,n=a.value,h=a.validateSpec,m=a.styleSpec,y=a.style;if(!Tu(n))return[new Qt(e,n,`object expected, ${dn(n)} found`)];const v=[];for(const E in n){const k=n[E],P=dn(k);if(P==="string")v.push(...Cs({key:`${e}.${E}`,value:k}));else if(P==="array"){const z={url:{type:"string",required:!0},"unicode-range":{type:"array",value:"string"}};for(const[G,W]of k.entries())v.push(...Za({key:`${e}.${E}[${G}]`,value:W,valueSpec:z,styleSpec:m,style:y,validateSpec:h}))}else v.push(new Qt(`${e}.${E}`,k,`string or array expected, ${P} found`))}return v}};function Eo(a){const e=a.value,n=a.valueSpec,h=a.styleSpec;return a.validateSpec=Eo,n.expression&&hh(gn(e))?zi(a):n.expression&&Jr(fa(e))?Oi(a):n.type&&Ua[n.type]?Ua[n.type](a):Za(ye({},a,{valueSpec:n.type?h[n.type]:n}))}function Pl(a){const e=a.value,n=a.key,h=Cs(a);return h.length||(e.indexOf("{fontstack}")===-1&&h.push(new Qt(n,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&h.push(new Qt(n,e,'"glyphs" url must include a "{range}" token'))),h}function Ei(a,e=ht){let n=[];return n=n.concat(Eo({key:"",value:a,valueSpec:e.$root,styleSpec:e,style:a,validateSpec:Eo,objectElementValidators:{glyphs:Pl,"*":()=>[]}})),a.constants&&(n=n.concat(Gr({key:"constants",value:a.constants}))),oc(n)}function Ms(a){return function(e){return a(Object.assign({},e,{validateSpec:Eo}))}}function oc(a){return[].concat(a).sort(((e,n)=>e.line-n.line))}function Ai(a){return function(...e){return oc(a.apply(this,e))}}Ei.source=Ai(Ms(So)),Ei.sprite=Ai(Ms($h)),Ei.glyphs=Ai(Ms(Pl)),Ei.light=Ai(Ms(Wa)),Ei.sky=Ai(Ms(wu)),Ei.terrain=Ai(Ms(dh)),Ei.state=Ai(Ms(ph)),Ei.layer=Ai(Ms(Il)),Ei.filter=Ai(Ms(ds)),Ei.paintProperty=Ai(Ms(Si)),Ei.layoutProperty=Ai(Ms(ks));const Ff={type:"enum","property-type":"data-constant",expression:{interpolated:!1,parameters:["global-state"]},values:{visible:{},none:{}},transition:!1,default:"visible"};class lc{constructor(e,n){this._globalState=n,this.setValue(e)}evaluate(){var e;return(e=this._literalValue)!==null&&e!==void 0?e:this._compiledValue.evaluate({})}setValue(e){if(e==null||e==="visible"||e==="none")return this._literalValue=e==="none"?"none":"visible",this._compiledValue=void 0,void(this._globalStateRefs=new Set);const n=mn(e,Ff,this._globalState);if(n.result==="error")throw this._literalValue="visible",this._compiledValue=void 0,new Error(n.value.map((h=>`${h.key}: ${h.message}`)).join(", "));this._literalValue=void 0,this._compiledValue=n.value,this._globalStateRefs=Tr(n.value.expression)}getGlobalStateRefs(){return this._globalStateRefs}}const Su=ht,li=Ei,sl=li.light,Lf=li.sky,zf=li.paintProperty,Fp=li.layoutProperty;function ol(a,e){let n=!1;if(e&&e.length)for(const h of e)a.fire(new yn(new Error(h.message))),n=!0;return n}class Gc{constructor(e,n,h){const m=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const v=new Int32Array(this.arrayBuffer);e=v[0],this.d=(n=v[1])+2*(h=v[2]);for(let k=0;k<this.d*this.d;k++){const P=v[3+k],z=v[3+k+1];m.push(P===z?null:v.subarray(P,z))}const E=v[3+m.length+1];this.keys=v.subarray(v[3+m.length],E),this.bboxes=v.subarray(E),this.insert=this._insertReadonly}else{this.d=n+2*h;for(let v=0;v<this.d*this.d;v++)m.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=e,this.padding=h,this.scale=n/e,this.uid=0;const y=h/n*e;this.min=-y,this.max=e+y}insert(e,n,h,m,y){this._forEachCell(n,h,m,y,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(n),this.bboxes.push(h),this.bboxes.push(m),this.bboxes.push(y)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,n,h,m,y,v){this.cells[y].push(v)}query(e,n,h,m,y){const v=this.min,E=this.max;if(e<=v&&n<=v&&E<=h&&E<=m&&!y)return Array.prototype.slice.call(this.keys);{const k=[];return this._forEachCell(e,n,h,m,this._queryCell,k,{},y),k}}_queryCell(e,n,h,m,y,v,E,k){const P=this.cells[y];if(P!==null){const z=this.keys,G=this.bboxes;for(let W=0;W<P.length;W++){const K=P[W];if(E[K]===void 0){const ie=4*K;(k?k(G[ie+0],G[ie+1],G[ie+2],G[ie+3]):e<=G[ie+2]&&n<=G[ie+3]&&h>=G[ie+0]&&m>=G[ie+1])?(E[K]=!0,v.push(z[K])):E[K]=!1}}}}_forEachCell(e,n,h,m,y,v,E,k){const P=this._convertToCellCoord(e),z=this._convertToCellCoord(n),G=this._convertToCellCoord(h),W=this._convertToCellCoord(m);for(let K=P;K<=G;K++)for(let ie=z;ie<=W;ie++){const oe=this.d*ie+K;if((!k||k(this._convertFromCellCoord(K),this._convertFromCellCoord(ie),this._convertFromCellCoord(K+1),this._convertFromCellCoord(ie+1)))&&y.call(this,e,n,h,m,oe,v,E,k))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,n=3+this.cells.length+1+1;let h=0;for(let v=0;v<this.cells.length;v++)h+=this.cells[v].length;const m=new Int32Array(n+h+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;let y=n;for(let v=0;v<e.length;v++){const E=e[v];m[3+v]=y,m.set(E,y),y+=E.length}return m[3+e.length]=y,m.set(this.keys,y),y+=this.keys.length,m[3+e.length+1]=y,m.set(this.bboxes,y),y+=this.bboxes.length,m.buffer}static serialize(e,n){const h=e.toArrayBuffer();return n&&n.push(h),{buffer:h}}static deserialize(e){return new Gc(e.buffer)}}const Us={};function Cr(a,e,n={}){if(Us[a])throw new Error(`${a} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:a,writeable:!1}),Us[a]={klass:e,omit:n.omit||[],shallow:n.shallow||[]}}Cr("Object",Object),Cr("Set",Set),Cr("TransferableGridIndex",Gc),Cr("Color",ln),Cr("Error",Error),Cr("AJAXError",it),Cr("ResolvedImage",Ri),Cr("StylePropertyFunction",Wr),Cr("StyleExpression",gr,{omit:["_evaluator"]}),Cr("ZoomDependentExpression",Hr),Cr("ZoomConstantExpression",Vr),Cr("CompoundExpression",gi,{omit:["_evaluate"]});for(const a in jc)jc[a]._classRegistryKey||Cr(`Expression_${a}`,jc[a]);function Xh(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function Of(a){return a.$name||a.constructor._classRegistryKey}function Ao(a){return!(function(e){if(e===null||typeof e!="object")return!1;const n=Of(e);return!(!n||n==="Object")})(a)&&(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob||a instanceof Error||Xh(a)||Ne(a)||ArrayBuffer.isView(a)||a instanceof ImageData)}function ll(a,e){if(Ao(a))return(Xh(a)||Ne(a))&&e&&e.push(a),ArrayBuffer.isView(a)&&e&&e.push(a.buffer),a instanceof ImageData&&e&&e.push(a.data.buffer),a;if(Array.isArray(a)){const y=[];for(const v of a)y.push(ll(v,e));return y}if(typeof a!="object")throw new Error("can't serialize object of type "+typeof a);const n=Of(a);if(!n)throw new Error(`can't serialize object of unregistered class ${a.constructor.name}`);if(!Us[n])throw new Error(`${n} is not registered.`);const{klass:h}=Us[n],m=h.serialize?h.serialize(a,e):{};if(h.serialize){if(e&&m===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const y in a){if(!a.hasOwnProperty(y)||Us[n].omit.indexOf(y)>=0)continue;const v=a[y];m[y]=Us[n].shallow.indexOf(y)>=0?v:ll(v,e)}a instanceof Error&&(m.message=a.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return n!=="Object"&&(m.$name=n),m}function mh(a){if(Ao(a))return a;if(Array.isArray(a))return a.map(mh);if(typeof a!="object")throw new Error("can't deserialize object of type "+typeof a);const e=Of(a)||"Object";if(!Us[e])throw new Error(`can't deserialize unregistered class ${e}`);const{klass:n}=Us[e];if(!n)throw new Error(`can't deserialize unregistered class ${e}`);if(n.deserialize)return n.deserialize(a);const h=Object.create(n.prototype);for(const m of Object.keys(a)){if(m==="$name")continue;const y=a[m];h[m]=Us[e].shallow.indexOf(m)>=0?y:mh(y)}return h}class Bf{constructor(){this.first=!0}update(e,n){const h=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=h,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=h,!0):(this.lastFloorZoom>h?(this.lastIntegerZoom=h+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<h&&(this.lastIntegerZoom=h,this.lastIntegerZoomTime=n),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=h,!0))}}function Fl(a){return/[\u02EA\u02EB\u2E80-\u2FDF\u2FF0-\u303F\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FD-\u30FF\u3105-\u312F\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(a))}function Eu(a){return/[\u02EA\u02EB\u1100-\u11FF\u1400-\u167F\u18B0-\u18F5\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u3007\u3012\u3013\u3020-\u302F\u3031-\u303F\u3041-\u3096\u309D-\u30FB\u30FD-\u30FF\u3105-\u312F\u3131-\u318E\u3190-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE48\uFE50-\uFE57\uFE5F-\uFE62\uFE67-\uFE6F\uFF00-\uFF07\uFF0A-\uFF0C\uFF0E-\uFF19\uFF1F-\uFF3A\uFF3C\uFF3E\uFF40-\uFF5A\uFFE0-\uFFE2\uFFE4-\uFFE7]|\uD802[\uDD80-\uDD9F]|\uD805[\uDD80-\uDDFF]|\uD806[\uDE00-\uDEBF]|\uD811[\uDC00-\uDE7F]|\uD81B[\uDFE0-\uDFE4\uDFF0-\uDFF6]|[\uD81C-\uD822\uD83D\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD30-\uDEFB]|\uD833[\uDEC0-\uDFCF]|\uD834[\uDC00-\uDDFF\uDEE0-\uDF7F]|\uD836[\uDC00-\uDEAF]|\uD83C[\uDC00-\uDE00\uDF00-\uDFFF]|\uD83E[\uDD00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(a))}function Yh(a){return/\s/u.test(String.fromCodePoint(a))}function Ll(a){for(const e of a)if(Eu(e.codePointAt(0)))return!0;return!1}function Nf(a){for(const e of a)if(!Ad(e.codePointAt(0)))return!1;return!0}function Kh(a){const e=a.map((n=>{try{return new RegExp(`\\p{sc=${n}}`,"u").source}catch{return null}})).filter((n=>n));return new RegExp(e.join("|"),"u")}const zl=Kh(["Arab","Dupl","Mong","Ougr","Syrc"]);function Ad(a){return!zl.test(String.fromCodePoint(a))}function Ol(a){return!(Eu(a)||(e=a,/[\xA7\xA9\xAE\xB1\xBC-\xBE\xD7\xF7\u2016\u2020\u2021\u2030\u2031\u203B\u203C\u2042\u2047-\u2049\u2051\u2100-\u218F\u221E\u2234\u2235\u2300-\u2307\u230C-\u231F\u2324-\u2328\u232B\u237D-\u239A\u23BE-\u23CD\u23CF\u23D1-\u23DB\u23E2-\u2422\u2424-\u24FF\u25A0-\u2619\u2620-\u2767\u2776-\u2793\u2B12-\u2B2F\u2B50-\u2B59\u2BB8-\u2BEB\u3000-\u303F\u30A0-\u30FF\uE000-\uF8FF\uFE30-\uFE6F\uFF00-\uFFEF\uFFFC\uFFFD]|[\uDB80-\uDBFF][\uDC00-\uDFFF]/gim.test(String.fromCodePoint(e))));var e}const jf=Kh(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Jh(a){return jf.test(String.fromCodePoint(a))}function Bl(a,e){return!(!e&&Jh(a)||/[\u0900-\u0DFF\u0F00-\u109F\u1780-\u17FF]/gim.test(String.fromCodePoint(a)))}function cc(a){for(const e of a)if(Jh(e.codePointAt(0)))return!0;return!1}const ko=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(a){this.pluginStatus=a.pluginStatus,this.pluginURL=a.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(a){if(ko.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=a.applyArabicShaping,this.processBidirectionalText=a.processBidirectionalText,this.processStyledBidirectionalText=a.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(a,e){return s(this,void 0,void 0,(function*(){if(this.isParsed())return this.getState();if(a.pluginStatus!=="loading")return this.setState(a),a;const n=a.pluginURL,h=new Promise((y=>{this.loadScriptResolve=y}));e(n);const m=new Promise((y=>setTimeout((()=>y()),this.TIMEOUT)));if(yield Promise.race([h,m]),this.isParsed()){const y={pluginStatus:"loaded",pluginURL:n};return this.setState(y),y}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${n}`)}))}};class Qn{constructor(e,n){this.isSupportedScript=kd,this.zoom=e,n?(this.now=n.now||0,this.fadeDuration=n.fadeDuration||0,this.zoomHistory=n.zoomHistory||new Bf,this.transition=n.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Bf,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,n=e-Math.floor(e),h=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*h}:{fromScale:.5,toScale:1,t:1-(1-h)*n}}}function kd(a){return(function(e,n){for(const h of e)if(!Bl(h.codePointAt(0),n))return!1;return!0})(a,ko.getRTLTextPluginStatus()==="loaded")}const uc="-transition";class Hc{constructor(e,n,h){this.property=e,this.value=n,this.expression=(function(m,y,v){if(hh(m))return new Wr(m,y);if(Jr(m)){const E=Pr(m,y,v);if(E.result==="error")throw new Error(E.value.map((k=>`${k.key}: ${k.message}`)).join(", "));return E.value}{let E=m;return y.type==="color"&&typeof m=="string"?E=ln.parse(m):y.type!=="padding"||typeof m!="number"&&!Array.isArray(m)?y.type!=="numberArray"||typeof m!="number"&&!Array.isArray(m)?y.type!=="colorArray"||typeof m!="string"&&!Array.isArray(m)?y.type==="variableAnchorOffsetCollection"&&Array.isArray(m)?E=Da.parse(m):y.type==="projectionDefinition"&&typeof m=="string"&&(E=$n.parse(m)):E=en.parse(m):E=Hn.parse(m):E=qa.parse(m),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>E}}})(n===void 0?e.specification.default:n,e.specification,h)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(e,n,h){return this.property.possiblyEvaluate(this,e,n,h)}}class Qh{constructor(e,n){this.property=e,this.value=new Hc(e,void 0,n)}transitioned(e,n){return new Au(this.property,this.value,n,Vt({},e.transition,this.transition),e.now)}untransitioned(){return new Au(this.property,this.value,null,{},0)}}class Uf{constructor(e,n){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues),this._globalState=n}getValue(e){return Ye(this._values[e].value.value)}setValue(e,n){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Qh(this._values[e].property,this._globalState)),this._values[e].value=new Hc(this._values[e].property,n===null?void 0:Ye(n),this._globalState)}getTransition(e){return Ye(this._values[e].transition)}setTransition(e,n){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Qh(this._values[e].property,this._globalState)),this._values[e].transition=Ye(n)||void 0}serialize(){const e={};for(const n of Object.keys(this._values)){const h=this.getValue(n);h!==void 0&&(e[n]=h);const m=this.getTransition(n);m!==void 0&&(e[`${n}${uc}`]=m)}return e}transitioned(e,n){const h=new ef(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].transitioned(e,n._values[m]);return h}untransitioned(){const e=new ef(this._properties);for(const n of Object.keys(this._values))e._values[n]=this._values[n].untransitioned();return e}}class Au{constructor(e,n,h,m,y){this.property=e,this.value=n,this.begin=y+m.delay||0,this.end=this.begin+m.duration||0,e.specification.transition&&(m.delay||m.duration)&&(this.prior=h)}possiblyEvaluate(e,n,h){const m=e.now||0,y=this.value.possiblyEvaluate(e,n,h),v=this.prior;if(v){if(m>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(m<this.begin)return v.possiblyEvaluate(e,n,h);{const E=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(e,n,h),y,Ue(E))}}return y}}class ef{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,n,h){const m=new ku(this._properties);for(const y of Object.keys(this._values))m._values[y]=this._values[y].possiblyEvaluate(e,n,h);return m}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Cd{constructor(e,n){this._properties=e,this._values=Object.create(e.defaultPropertyValues),this._globalState=n}hasValue(e){return this._values[e].value!==void 0}getValue(e){return Ye(this._values[e].value)}setValue(e,n){this._values[e]=new Hc(this._values[e].property,n===null?void 0:Ye(n),this._globalState)}serialize(){const e={};for(const n of Object.keys(this._values)){const h=this.getValue(n);h!==void 0&&(e[n]=h)}return e}possiblyEvaluate(e,n,h){const m=new ku(this._properties);for(const y of Object.keys(this._values))m._values[y]=this._values[y].possiblyEvaluate(e,n,h);return m}}class ao{constructor(e,n,h){this.property=e,this.value=n,this.parameters=h}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,n,h,m){return this.property.evaluate(this.value,this.parameters,e,n,h,m)}}class ku{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Rr{constructor(e){this.specification=e}possiblyEvaluate(e,n){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(n)}interpolate(e,n,h){const m=ya[this.specification.type];return m?m(e,n,h):e}}class jr{constructor(e,n){this.specification=e,this.overrides=n}possiblyEvaluate(e,n,h,m){return new ao(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(n,null,{},h,m)}:e.expression,n)}interpolate(e,n,h){if(e.value.kind!=="constant"||n.value.kind!=="constant")return e;if(e.value.value===void 0||n.value.value===void 0)return new ao(this,{kind:"constant",value:void 0},e.parameters);const m=ya[this.specification.type];if(m){const y=m(e.value.value,n.value.value,h);return new ao(this,{kind:"constant",value:y},e.parameters)}return e}evaluate(e,n,h,m,y,v){return e.kind==="constant"?e.value:e.evaluate(n,h,m,y,v)}}class Co extends jr{possiblyEvaluate(e,n,h,m){if(e.value===void 0)return new ao(this,{kind:"constant",value:void 0},n);if(e.expression.kind==="constant"){const y=e.expression.evaluate(n,null,{},h,m),v=e.property.specification.type==="resolvedImage"&&typeof y!="string"?y.name:y,E=this._calculate(v,v,v,n);return new ao(this,{kind:"constant",value:E},n)}if(e.expression.kind==="camera"){const y=this._calculate(e.expression.evaluate({zoom:n.zoom-1}),e.expression.evaluate({zoom:n.zoom}),e.expression.evaluate({zoom:n.zoom+1}),n);return new ao(this,{kind:"constant",value:y},n)}return new ao(this,e.expression,n)}evaluate(e,n,h,m,y,v){if(e.kind==="source"){const E=e.evaluate(n,h,m,y,v);return this._calculate(E,E,E,n)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(n.zoom)-1},h,m),e.evaluate({zoom:Math.floor(n.zoom)},h,m),e.evaluate({zoom:Math.floor(n.zoom)+1},h,m),n):e.value}_calculate(e,n,h,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:e,to:n}:{from:h,to:n}}interpolate(e){return e}}class gh{constructor(e){this.specification=e}possiblyEvaluate(e,n,h,m){if(e.value!==void 0){if(e.expression.kind==="constant"){const y=e.expression.evaluate(n,null,{},h,m);return this._calculate(y,y,y,n)}return this._calculate(e.expression.evaluate(new Qn(Math.floor(n.zoom-1),n)),e.expression.evaluate(new Qn(Math.floor(n.zoom),n)),e.expression.evaluate(new Qn(Math.floor(n.zoom+1),n)),n)}}_calculate(e,n,h,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:e,to:n}:{from:h,to:n}}interpolate(e){return e}}class tf{constructor(e){this.specification=e}possiblyEvaluate(e,n,h,m){return!!e.expression.evaluate(n,null,{},h,m)}interpolate(){return!1}}class ni{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const n in e){const h=e[n];h.specification.overridable&&this.overridableProperties.push(n);const m=this.defaultPropertyValues[n]=new Hc(h,void 0,void 0),y=this.defaultTransitionablePropertyValues[n]=new Qh(h,void 0);this.defaultTransitioningPropertyValues[n]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=m.possiblyEvaluate({})}}}Cr("DataDrivenProperty",jr),Cr("DataConstantProperty",Rr),Cr("CrossFadedDataDrivenProperty",Co),Cr("CrossFadedProperty",gh),Cr("ColorRampProperty",tf);class Va extends hn{constructor(e,n,h){if(super(),this.id=e.id,this.type=e.type,this._globalState=h,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,this._visibilityExpression=(function(m,y){return new lc(m,y)})(this.visibility,h),e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter,this._featureFilter=sn(e.filter,h)),n.layout&&(this._unevaluatedLayout=new Cd(n.layout,h)),n.paint)){this._transitionablePaint=new Uf(n.paint,h);for(const m in e.paint)this.setPaintProperty(m,e.paint[m],{validate:!1});for(const m in e.layout)this.setLayoutProperty(m,e.layout[m],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ku(n.paint)}}setFilter(e){this.filter=e,this._featureFilter=sn(e,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}getLayoutAffectingGlobalStateRefs(){const e=new Set;for(const n of this._visibilityExpression.getGlobalStateRefs())e.add(n);if(this._unevaluatedLayout)for(const n in this._unevaluatedLayout._values){const h=this._unevaluatedLayout._values[n];for(const m of h.getGlobalStateRefs())e.add(m)}for(const n of this._featureFilter.getGlobalStateRefs())e.add(n);return e}getPaintAffectingGlobalStateRefs(){var e;const n=new globalThis.Map;if(this._transitionablePaint)for(const h in this._transitionablePaint._values){const m=this._transitionablePaint._values[h].value;for(const y of m.getGlobalStateRefs()){const v=(e=n.get(y))!==null&&e!==void 0?e:[];v.push({name:h,value:m.value}),n.set(y,v)}}return n}getVisibilityAffectingGlobalStateRefs(){return this._visibilityExpression.getGlobalStateRefs()}setLayoutProperty(e,n,h={}){if(n==null||!this._validate(Fp,`layers.${this.id}.layout.${e}`,e,n,h))return e==="visibility"?(this.visibility=n,this._visibilityExpression.setValue(n),void this.recalculateVisibility()):void this._unevaluatedLayout.setValue(e,n)}getPaintProperty(e){return e.endsWith(uc)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,n,h={}){if(n!=null&&this._validate(zf,`layers.${this.id}.paint.${e}`,e,n,h))return!1;if(e.endsWith(uc))return this._transitionablePaint.setTransition(e.slice(0,-11),n||void 0),!1;{const m=this._transitionablePaint._values[e],y=m.property.specification["property-type"]==="cross-faded-data-driven",v=m.value.isDataDriven(),E=m.value;this._transitionablePaint.setValue(e,n),this._handleSpecialPaintPropertyUpdate(e);const k=this._transitionablePaint._values[e].value;return k.isDataDriven()||v||y||this._handleOverridablePaintPropertyUpdate(e,E,k)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,n,h){return!1}isHidden(e=this.minzoom,n=!1){return!!(this.minzoom&&e<(n?Math.floor(this.minzoom):this.minzoom))||!!(this.maxzoom&&e>=this.maxzoom)||this._evaluatedVisibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculateVisibility(){this._evaluatedVisibility=this._visibilityExpression.evaluate()}recalculate(e,n){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,n)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Or(e,((n,h)=>!(n===void 0||h==="layout"&&!Object.keys(n).length||h==="paint"&&!Object.keys(n).length)))}_validate(e,n,h,m,y={}){return(!y||y.validate!==!1)&&ol(this,e.call(li,{key:n,layerType:this.type,objectKey:h,value:m,styleSpec:ht,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const n=this.paint.get(e);if(n instanceof ao&&Ns(n.property.specification)&&(n.value.kind==="source"||n.value.kind==="composite")&&n.value.isStateDependent)return!0}return!1}}let $a;var rf={get paint(){return $a=$a||new ni({"raster-opacity":new Rr(ht.paint_raster["raster-opacity"]),"raster-hue-rotate":new Rr(ht.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Rr(ht.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Rr(ht.paint_raster["raster-brightness-max"]),"raster-saturation":new Rr(ht.paint_raster["raster-saturation"]),"raster-contrast":new Rr(ht.paint_raster["raster-contrast"]),"raster-resampling":new Rr(ht.paint_raster["raster-resampling"]),"raster-fade-duration":new Rr(ht.paint_raster["raster-fade-duration"])})}};class hc extends Va{constructor(e,n){super(e,rf,n)}}const Sn={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Xn{constructor(e,n){this._structArray=e,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class wn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,n){return e._trim(),n&&(e.isTransferred=!0,n.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const n=Object.create(this.prototype);return n.arrayBuffer=e.arrayBuffer,n.length=e.length,n.capacity=e.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Fa(a,e=1){let n=0,h=0;return{members:a.map((m=>{const y=Sn[m.type].BYTES_PER_ELEMENT,v=n=Mo(n,Math.max(e,y)),E=m.components||1;return h=Math.max(h,y),n+=y*E,{name:m.name,type:m.type,components:E,offset:v}})),size:Mo(n,Math.max(h,e)),alignment:e}}function Mo(a,e){return Math.ceil(a/e)*e}class cl extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n){const h=this.length;return this.resize(h+1),this.emplace(h,e,n)}emplace(e,n,h){const m=2*e;return this.int16[m+0]=n,this.int16[m+1]=h,e}}cl.prototype.bytesPerElement=4,Cr("StructArrayLayout2i4",cl);class Cu extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,n,h)}emplace(e,n,h,m){const y=3*e;return this.int16[y+0]=n,this.int16[y+1]=h,this.int16[y+2]=m,e}}Cu.prototype.bytesPerElement=6,Cr("StructArrayLayout3i6",Cu);class Mu extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,h,m){const y=this.length;return this.resize(y+1),this.emplace(y,e,n,h,m)}emplace(e,n,h,m,y){const v=4*e;return this.int16[v+0]=n,this.int16[v+1]=h,this.int16[v+2]=m,this.int16[v+3]=y,e}}Mu.prototype.bytesPerElement=8,Cr("StructArrayLayout4i8",Mu);class fc extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,h,m,y,v){const E=this.length;return this.resize(E+1),this.emplace(E,e,n,h,m,y,v)}emplace(e,n,h,m,y,v,E){const k=6*e;return this.int16[k+0]=n,this.int16[k+1]=h,this.int16[k+2]=m,this.int16[k+3]=y,this.int16[k+4]=v,this.int16[k+5]=E,e}}fc.prototype.bytesPerElement=12,Cr("StructArrayLayout2i4i12",fc);class Md extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,h,m,y,v){const E=this.length;return this.resize(E+1),this.emplace(E,e,n,h,m,y,v)}emplace(e,n,h,m,y,v,E){const k=4*e,P=8*e;return this.int16[k+0]=n,this.int16[k+1]=h,this.uint8[P+4]=m,this.uint8[P+5]=y,this.uint8[P+6]=v,this.uint8[P+7]=E,e}}Md.prototype.bytesPerElement=8,Cr("StructArrayLayout2i4ub8",Md);class Aa extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n){const h=this.length;return this.resize(h+1),this.emplace(h,e,n)}emplace(e,n,h){const m=2*e;return this.float32[m+0]=n,this.float32[m+1]=h,e}}Aa.prototype.bytesPerElement=8,Cr("StructArrayLayout2f8",Aa);class ul extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,h,m,y,v,E,k,P,z){const G=this.length;return this.resize(G+1),this.emplace(G,e,n,h,m,y,v,E,k,P,z)}emplace(e,n,h,m,y,v,E,k,P,z,G){const W=10*e;return this.uint16[W+0]=n,this.uint16[W+1]=h,this.uint16[W+2]=m,this.uint16[W+3]=y,this.uint16[W+4]=v,this.uint16[W+5]=E,this.uint16[W+6]=k,this.uint16[W+7]=P,this.uint16[W+8]=z,this.uint16[W+9]=G,e}}ul.prototype.bytesPerElement=20,Cr("StructArrayLayout10ui20",ul);class _h extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,h,m,y,v,E,k){const P=this.length;return this.resize(P+1),this.emplace(P,e,n,h,m,y,v,E,k)}emplace(e,n,h,m,y,v,E,k,P){const z=8*e;return this.uint16[z+0]=n,this.uint16[z+1]=h,this.uint16[z+2]=m,this.uint16[z+3]=y,this.uint16[z+4]=v,this.uint16[z+5]=E,this.uint16[z+6]=k,this.uint16[z+7]=P,e}}_h.prototype.bytesPerElement=16,Cr("StructArrayLayout8ui16",_h);class xh extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,h,m,y,v,E,k,P,z,G,W){const K=this.length;return this.resize(K+1),this.emplace(K,e,n,h,m,y,v,E,k,P,z,G,W)}emplace(e,n,h,m,y,v,E,k,P,z,G,W,K){const ie=12*e;return this.int16[ie+0]=n,this.int16[ie+1]=h,this.int16[ie+2]=m,this.int16[ie+3]=y,this.uint16[ie+4]=v,this.uint16[ie+5]=E,this.uint16[ie+6]=k,this.uint16[ie+7]=P,this.int16[ie+8]=z,this.int16[ie+9]=G,this.int16[ie+10]=W,this.int16[ie+11]=K,e}}xh.prototype.bytesPerElement=24,Cr("StructArrayLayout4i4ui4i24",xh);class nf extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,n,h)}emplace(e,n,h,m){const y=3*e;return this.float32[y+0]=n,this.float32[y+1]=h,this.float32[y+2]=m,e}}nf.prototype.bytesPerElement=12,Cr("StructArrayLayout3f12",nf);class af extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint32[1*e+0]=n,e}}af.prototype.bytesPerElement=4,Cr("StructArrayLayout1ul4",af);class sf extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,h,m,y,v,E,k,P){const z=this.length;return this.resize(z+1),this.emplace(z,e,n,h,m,y,v,E,k,P)}emplace(e,n,h,m,y,v,E,k,P,z){const G=10*e,W=5*e;return this.int16[G+0]=n,this.int16[G+1]=h,this.int16[G+2]=m,this.int16[G+3]=y,this.int16[G+4]=v,this.int16[G+5]=E,this.uint32[W+3]=k,this.uint16[G+8]=P,this.uint16[G+9]=z,e}}sf.prototype.bytesPerElement=20,Cr("StructArrayLayout6i1ul2ui20",sf);class qc extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,h,m,y,v){const E=this.length;return this.resize(E+1),this.emplace(E,e,n,h,m,y,v)}emplace(e,n,h,m,y,v,E){const k=6*e;return this.int16[k+0]=n,this.int16[k+1]=h,this.int16[k+2]=m,this.int16[k+3]=y,this.int16[k+4]=v,this.int16[k+5]=E,e}}qc.prototype.bytesPerElement=12,Cr("StructArrayLayout2i2i2i12",qc);class dc extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,h,m,y){const v=this.length;return this.resize(v+1),this.emplace(v,e,n,h,m,y)}emplace(e,n,h,m,y,v){const E=4*e,k=8*e;return this.float32[E+0]=n,this.float32[E+1]=h,this.float32[E+2]=m,this.int16[k+6]=y,this.int16[k+7]=v,e}}dc.prototype.bytesPerElement=16,Cr("StructArrayLayout2f1f2i16",dc);class rs extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,h,m,y,v){const E=this.length;return this.resize(E+1),this.emplace(E,e,n,h,m,y,v)}emplace(e,n,h,m,y,v,E){const k=16*e,P=4*e,z=8*e;return this.uint8[k+0]=n,this.uint8[k+1]=h,this.float32[P+1]=m,this.float32[P+2]=y,this.int16[z+6]=v,this.int16[z+7]=E,e}}rs.prototype.bytesPerElement=16,Cr("StructArrayLayout2ub2f2i16",rs);class La extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,n,h)}emplace(e,n,h,m){const y=3*e;return this.uint16[y+0]=n,this.uint16[y+1]=h,this.uint16[y+2]=m,e}}La.prototype.bytesPerElement=6,Cr("StructArrayLayout3ui6",La);class Nl extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,h,m,y,v,E,k,P,z,G,W,K,ie,oe,ue,be){const We=this.length;return this.resize(We+1),this.emplace(We,e,n,h,m,y,v,E,k,P,z,G,W,K,ie,oe,ue,be)}emplace(e,n,h,m,y,v,E,k,P,z,G,W,K,ie,oe,ue,be,We){const Se=24*e,De=12*e,Je=48*e;return this.int16[Se+0]=n,this.int16[Se+1]=h,this.uint16[Se+2]=m,this.uint16[Se+3]=y,this.uint32[De+2]=v,this.uint32[De+3]=E,this.uint32[De+4]=k,this.uint16[Se+10]=P,this.uint16[Se+11]=z,this.uint16[Se+12]=G,this.float32[De+7]=W,this.float32[De+8]=K,this.uint8[Je+36]=ie,this.uint8[Je+37]=oe,this.uint8[Je+38]=ue,this.uint32[De+10]=be,this.int16[Se+22]=We,e}}Nl.prototype.bytesPerElement=48,Cr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Nl);class Du extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,h,m,y,v,E,k,P,z,G,W,K,ie,oe,ue,be,We,Se,De,Je,at,St,Xt,Ut,rr,wr,ar){const Zt=this.length;return this.resize(Zt+1),this.emplace(Zt,e,n,h,m,y,v,E,k,P,z,G,W,K,ie,oe,ue,be,We,Se,De,Je,at,St,Xt,Ut,rr,wr,ar)}emplace(e,n,h,m,y,v,E,k,P,z,G,W,K,ie,oe,ue,be,We,Se,De,Je,at,St,Xt,Ut,rr,wr,ar,Zt){const Ft=32*e,Ir=16*e;return this.int16[Ft+0]=n,this.int16[Ft+1]=h,this.int16[Ft+2]=m,this.int16[Ft+3]=y,this.int16[Ft+4]=v,this.int16[Ft+5]=E,this.int16[Ft+6]=k,this.int16[Ft+7]=P,this.uint16[Ft+8]=z,this.uint16[Ft+9]=G,this.uint16[Ft+10]=W,this.uint16[Ft+11]=K,this.uint16[Ft+12]=ie,this.uint16[Ft+13]=oe,this.uint16[Ft+14]=ue,this.uint16[Ft+15]=be,this.uint16[Ft+16]=We,this.uint16[Ft+17]=Se,this.uint16[Ft+18]=De,this.uint16[Ft+19]=Je,this.uint16[Ft+20]=at,this.uint16[Ft+21]=St,this.uint16[Ft+22]=Xt,this.uint32[Ir+12]=Ut,this.float32[Ir+13]=rr,this.float32[Ir+14]=wr,this.uint16[Ft+30]=ar,this.uint16[Ft+31]=Zt,e}}Du.prototype.bytesPerElement=64,Cr("StructArrayLayout8i15ui1ul2f2ui64",Du);class Ru extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.float32[1*e+0]=n,e}}Ru.prototype.bytesPerElement=4,Cr("StructArrayLayout1f4",Ru);class yh extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,n,h)}emplace(e,n,h,m){const y=3*e;return this.uint16[6*e+0]=n,this.float32[y+1]=h,this.float32[y+2]=m,e}}yh.prototype.bytesPerElement=12,Cr("StructArrayLayout1ui2f12",yh);class hl extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,n,h)}emplace(e,n,h,m){const y=4*e;return this.uint32[2*e+0]=n,this.uint16[y+2]=h,this.uint16[y+3]=m,e}}hl.prototype.bytesPerElement=8,Cr("StructArrayLayout1ul2ui8",hl);class w extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n){const h=this.length;return this.resize(h+1),this.emplace(h,e,n)}emplace(e,n,h){const m=2*e;return this.uint16[m+0]=n,this.uint16[m+1]=h,e}}w.prototype.bytesPerElement=4,Cr("StructArrayLayout2ui4",w);class t extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint16[1*e+0]=n,e}}t.prototype.bytesPerElement=2,Cr("StructArrayLayout1ui2",t);class o extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,h,m){const y=this.length;return this.resize(y+1),this.emplace(y,e,n,h,m)}emplace(e,n,h,m,y){const v=4*e;return this.float32[v+0]=n,this.float32[v+1]=h,this.float32[v+2]=m,this.float32[v+3]=y,e}}o.prototype.bytesPerElement=16,Cr("StructArrayLayout4f16",o);class d extends Xn{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new C(this.anchorPointX,this.anchorPointY)}}d.prototype.size=20;class x extends sf{get(e){return new d(this,e)}}Cr("CollisionBoxArray",x);class S extends Xn{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}S.prototype.size=48;class A extends Nl{get(e){return new S(this,e)}}Cr("PlacedSymbolArray",A);class R extends Xn{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}R.prototype.size=64;class F extends Du{get(e){return new R(this,e)}}Cr("SymbolInstanceArray",F);class V extends Ru{getoffsetX(e){return this.float32[1*e+0]}}Cr("GlyphOffsetArray",V);class q extends Cu{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}Cr("SymbolLineVertexArray",q);class te extends Xn{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}te.prototype.size=12;class ee extends yh{get(e){return new te(this,e)}}Cr("TextAnchorOffsetArray",ee);class ce extends Xn{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}ce.prototype.size=8;class _e extends hl{get(e){return new ce(this,e)}}Cr("FeatureIndexArray",_e);class Ie extends cl{}class Be extends cl{}class ze extends cl{}class Ze extends fc{}class rt extends Md{}class qe extends Aa{}class tt extends ul{}class lt extends _h{}class Ke extends xh{}class dt extends nf{}class Rt extends af{}class Tt extends qc{}class kt extends rs{}class Ct extends La{}class ur extends w{}const hr=Fa([{name:"a_pos",components:2,type:"Int16"}],4),{members:tr}=hr;class br{constructor(e=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=e}prepareSegment(e,n,h,m){const y=this.segments[this.segments.length-1];return e>br.MAX_VERTEX_ARRAY_LENGTH&&se(`Max vertices per segment is ${br.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${br.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!y||y.vertexLength+e>br.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==m?this.createNewSegment(n,h,m):y}createNewSegment(e,n,h){const m={vertexOffset:e.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0,vaos:{}};return h!==void 0&&(m.sortKey=h),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(m),m}getOrCreateLatestSegment(e,n,h){return this.prepareSegment(0,e,n,h)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const e of this.segments)for(const n in e.vaos)e.vaos[n].destroy()}static simpleSegment(e,n,h,m){return new br([{vertexOffset:e,primitiveOffset:n,vertexLength:h,primitiveLength:m,vaos:{},sortKey:0}])}}function fn(a,e){return 256*(a=bt(Math.floor(a),0,255))+bt(Math.floor(e),0,255)}br.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Cr("SegmentVector",br);const Yn=Fa([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),va=Fa([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);var da,ka,aa,Ga={exports:{}},Ca={exports:{}},Ni={exports:{}},Xa=(function(){if(aa)return Ga.exports;aa=1;var a=(da||(da=1,Ca.exports=function(n,h){var m,y,v,E,k,P,z,G;for(y=n.length-(m=3&n.length),v=h,k=3432918353,P=461845907,G=0;G<y;)z=255&n.charCodeAt(G)|(255&n.charCodeAt(++G))<<8|(255&n.charCodeAt(++G))<<16|(255&n.charCodeAt(++G))<<24,++G,v=27492+(65535&(E=5*(65535&(v=(v^=z=(65535&(z=(z=(65535&z)*k+(((z>>>16)*k&65535)<<16)&4294967295)<<15|z>>>17))*P+(((z>>>16)*P&65535)<<16)&4294967295)<<13|v>>>19))+((5*(v>>>16)&65535)<<16)&4294967295))+((58964+(E>>>16)&65535)<<16);switch(z=0,m){case 3:z^=(255&n.charCodeAt(G+2))<<16;case 2:z^=(255&n.charCodeAt(G+1))<<8;case 1:v^=z=(65535&(z=(z=(65535&(z^=255&n.charCodeAt(G)))*k+(((z>>>16)*k&65535)<<16)&4294967295)<<15|z>>>17))*P+(((z>>>16)*P&65535)<<16)&4294967295}return v^=n.length,v=2246822507*(65535&(v^=v>>>16))+((2246822507*(v>>>16)&65535)<<16)&4294967295,v=3266489909*(65535&(v^=v>>>13))+((3266489909*(v>>>16)&65535)<<16)&4294967295,(v^=v>>>16)>>>0}),Ca.exports),e=(ka||(ka=1,Ni.exports=function(n,h){for(var m,y=n.length,v=h^y,E=0;y>=4;)m=1540483477*(65535&(m=255&n.charCodeAt(E)|(255&n.charCodeAt(++E))<<8|(255&n.charCodeAt(++E))<<16|(255&n.charCodeAt(++E))<<24))+((1540483477*(m>>>16)&65535)<<16),v=1540483477*(65535&v)+((1540483477*(v>>>16)&65535)<<16)^(m=1540483477*(65535&(m^=m>>>24))+((1540483477*(m>>>16)&65535)<<16)),y-=4,++E;switch(y){case 3:v^=(255&n.charCodeAt(E+2))<<16;case 2:v^=(255&n.charCodeAt(E+1))<<8;case 1:v=1540483477*(65535&(v^=255&n.charCodeAt(E)))+((1540483477*(v>>>16)&65535)<<16)}return v=1540483477*(65535&(v^=v>>>13))+((1540483477*(v>>>16)&65535)<<16),(v^=v>>>15)>>>0}),Ni.exports);return Ga.exports=a,Ga.exports.murmur3=a,Ga.exports.murmur2=e,Ga.exports})(),Ya=M(Xa);class ji{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,n,h,m){this.ids.push(jl(e)),this.positions.push(n,h,m)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const n=jl(e);let h=0,m=this.ids.length-1;for(;h<m;){const v=h+m>>1;this.ids[v]>=n?m=v:h=v+1}const y=[];for(;this.ids[h]===n;)y.push({index:this.positions[3*h],start:this.positions[3*h+1],end:this.positions[3*h+2]}),h++;return y}static serialize(e,n){const h=new Float64Array(e.ids),m=new Uint32Array(e.positions);return Ul(h,m,0,h.length-1),n&&n.push(h.buffer,m.buffer),{ids:h,positions:m}}static deserialize(e){const n=new ji;return n.ids=e.ids,n.positions=e.positions,n.indexed=!0,n}}function jl(a){const e=+a;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:Ya(String(a))}function Ul(a,e,n,h){for(;n<h;){const m=a[n+h>>1];let y=n-1,v=h+1;for(;;){do y++;while(a[y]<m);do v--;while(a[v]>m);if(y>=v)break;fl(a,y,v),fl(e,3*y,3*v),fl(e,3*y+1,3*v+1),fl(e,3*y+2,3*v+2)}v-n<h-v?(Ul(a,e,n,v),n=v+1):(Ul(a,e,v+1,h),h=v)}}function fl(a,e,n){const h=a[e];a[e]=a[n],a[n]=h}Cr("FeaturePositionMap",ji);class Vs{constructor(e,n){this.gl=e.gl,this.location=n}}class Iu extends Vs{constructor(e,n){super(e,n),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class vh extends Vs{constructor(e,n){super(e,n),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class dl extends Vs{constructor(e,n){super(e,n),this.current=ln.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const Gs=new Float32Array(16);function io(a){return[fn(255*a.r,255*a.g),fn(255*a.b,255*a.a)]}class Do{constructor(e,n,h){this.value=e,this.uniformNames=n.map((m=>`u_${m}`)),this.type=h}setUniform(e,n,h){e.set(h.constantOr(this.value))}getBinding(e,n,h){return this.type==="color"?new dl(e,n):new Iu(e,n)}}class Ro{constructor(e,n){this.uniformNames=n.map((h=>`u_${h}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,n){this.pixelRatioFrom=n.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=n.tlbr,this.patternTo=e.tlbr}setConstantDashPositions(e,n){this.dashTo=[0,e.y,e.height,e.width],this.dashFrom=[0,n.y,n.height,n.width]}setUniform(e,n,h,m){let y=null;m==="u_pattern_to"?y=this.patternTo:m==="u_pattern_from"?y=this.patternFrom:m==="u_dasharray_to"?y=this.dashTo:m==="u_dasharray_from"?y=this.dashFrom:m==="u_pixel_ratio_to"?y=this.pixelRatioTo:m==="u_pixel_ratio_from"&&(y=this.pixelRatioFrom),y!==null&&e.set(y)}getBinding(e,n,h){return h.substr(0,9)==="u_pattern"||h.substr(0,12)==="u_dasharray_"?new vh(e,n):new Iu(e,n)}}class ea{constructor(e,n,h,m){this.expression=e,this.type=h,this.maxValue=0,this.paintVertexAttributes=n.map((y=>({name:`a_${y}`,type:"Float32",components:h==="color"?2:1,offset:0}))),this.paintVertexArray=new m}populatePaintArray(e,n,h){const m=this.paintVertexArray.length,y=this.expression.evaluate(new Qn(0,h),n,{},h.canonical,[],h.formattedSection);this.paintVertexArray.resize(e),this._setPaintValue(m,e,y)}updatePaintArray(e,n,h,m,y){const v=this.expression.evaluate(new Qn(0,y),h,m);this._setPaintValue(e,n,v)}_setPaintValue(e,n,h){if(this.type==="color"){const m=io(h);for(let y=e;y<n;y++)this.paintVertexArray.emplace(y,m[0],m[1])}else{for(let m=e;m<n;m++)this.paintVertexArray.emplace(m,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class pa{constructor(e,n,h,m,y,v){this.expression=e,this.uniformNames=n.map((E=>`u_${E}_t`)),this.type=h,this.useIntegerZoom=m,this.zoom=y,this.maxValue=0,this.paintVertexAttributes=n.map((E=>({name:`a_${E}`,type:"Float32",components:h==="color"?4:2,offset:0}))),this.paintVertexArray=new v}populatePaintArray(e,n,h){const m=this.expression.evaluate(new Qn(this.zoom,h),n,{},h.canonical,[],h.formattedSection),y=this.expression.evaluate(new Qn(this.zoom+1,h),n,{},h.canonical,[],h.formattedSection),v=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(v,e,m,y)}updatePaintArray(e,n,h,m,y){const v=this.expression.evaluate(new Qn(this.zoom,y),h,m),E=this.expression.evaluate(new Qn(this.zoom+1,y),h,m);this._setPaintValue(e,n,v,E)}_setPaintValue(e,n,h,m){if(this.type==="color"){const y=io(h),v=io(m);for(let E=e;E<n;E++)this.paintVertexArray.emplace(E,y[0],y[1],v[0],v[1])}else{for(let y=e;y<n;y++)this.paintVertexArray.emplace(y,h,m);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(m))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,n){const h=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,m=bt(this.expression.interpolationFactor(h,this.zoom,this.zoom+1),0,1);e.set(m)}getBinding(e,n,h){return new Iu(e,n)}}class ci{constructor(e,n,h,m,y,v){this.expression=e,this.type=n,this.useIntegerZoom=h,this.zoom=m,this.layerId=v,this.zoomInPaintVertexArray=new y,this.zoomOutPaintVertexArray=new y}populatePaintArray(e,n,h){const m=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(m,e,this.getPositionIds(n),h)}updatePaintArray(e,n,h,m,y){this._setPaintValues(e,n,this.getPositionIds(h),y)}_setPaintValues(e,n,h,m){const y=this.getPositions(m);if(!y||!h)return;const v=y[h.min],E=y[h.mid],k=y[h.max];if(v&&E&&k)for(let P=e;P<n;P++)this.emplace(this.zoomInPaintVertexArray,P,E,v),this.emplace(this.zoomOutPaintVertexArray,P,E,k)}upload(e){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){const n=this.getVertexAttributes();this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,n,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,n,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class _i extends ci{getPositions(e){return e.imagePositions}getPositionIds(e){return e.patterns&&e.patterns[this.layerId]}getVertexAttributes(){return Yn.members}emplace(e,n,h,m){e.emplace(n,h.tlbr[0],h.tlbr[1],h.tlbr[2],h.tlbr[3],m.tlbr[0],m.tlbr[1],m.tlbr[2],m.tlbr[3],h.pixelRatio,m.pixelRatio)}}class Vf extends ci{getPositions(e){return e.dashPositions}getPositionIds(e){return e.dashes&&e.dashes[this.layerId]}getVertexAttributes(){return va.members}emplace(e,n,h,m){e.emplace(n,0,h.y,h.height,h.width,0,m.y,m.height,m.width)}}class Gf{constructor(e,n,h){this.binders={},this._buffers=[];const m=[];for(const y in e.paint._values){if(!h(y))continue;const v=e.paint.get(y);if(!(v instanceof ao&&Ns(v.property.specification)))continue;const E=Lp(y,e.type),k=v.value,P=v.property.specification.type,z=v.property.useIntegerZoom,G=v.property.specification["property-type"],W=G==="cross-faded"||G==="cross-faded-data-driven";if(k.kind==="constant")this.binders[y]=W?new Ro(k.value,E):new Do(k.value,E,P),m.push(`/u_${y}`);else if(k.kind==="source"||W){const K=Wc(y,P,"source");this.binders[y]=W?y==="line-dasharray"?new Vf(k,P,z,n,K,e.id):new _i(k,P,z,n,K,e.id):new ea(k,E,P,K),m.push(`/a_${y}`)}else{const K=Wc(y,P,"composite");this.binders[y]=new pa(k,E,P,z,n,K),m.push(`/z_${y}`)}}this.cacheKey=m.sort().join("")}getMaxValue(e){const n=this.binders[e];return n instanceof ea||n instanceof pa?n.maxValue:0}populatePaintArrays(e,n,h){for(const m in this.binders){const y=this.binders[m];(y instanceof ea||y instanceof pa||y instanceof ci)&&y.populatePaintArray(e,n,h)}}setConstantPatternPositions(e,n){for(const h in this.binders){const m=this.binders[h];m instanceof Ro&&m.setConstantPatternPositions(e,n)}}setConstantDashPositions(e,n){for(const h in this.binders){const m=this.binders[h];m instanceof Ro&&m.setConstantDashPositions(e,n)}}updatePaintArrays(e,n,h,m,y){let v=!1;for(const E in e){const k=n.getPositions(E);for(const P of k){const z=h.feature(P.index);for(const G in this.binders){const W=this.binders[G];if((W instanceof ea||W instanceof pa||W instanceof ci)&&W.expression.isStateDependent===!0){const K=m.paint.get(G);W.expression=K.value,W.updatePaintArray(P.start,P.end,z,e[E],y),v=!0}}}}return v}defines(){const e=[];for(const n in this.binders){const h=this.binders[n];(h instanceof Do||h instanceof Ro)&&e.push(...h.uniformNames.map((m=>`#define HAS_UNIFORM_${m}`)))}return e}getBinderAttributes(){const e=[];for(const n in this.binders){const h=this.binders[n];if(h instanceof ea||h instanceof pa)for(let m=0;m<h.paintVertexAttributes.length;m++)e.push(h.paintVertexAttributes[m].name);else if(h instanceof ci){const m=h.getVertexAttributes();for(const y of m)e.push(y.name)}}return e}getBinderUniforms(){const e=[];for(const n in this.binders){const h=this.binders[n];if(h instanceof Do||h instanceof Ro||h instanceof pa)for(const m of h.uniformNames)e.push(m)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,n){const h=[];for(const m in this.binders){const y=this.binders[m];if(y instanceof Do||y instanceof Ro||y instanceof pa){for(const v of y.uniformNames)if(n[v]){const E=y.getBinding(e,n[v],v);h.push({name:v,property:m,binding:E})}}}return h}setUniforms(e,n,h,m){for(const{name:y,property:v,binding:E}of n)this.binders[v].setUniform(E,m,h.get(v),y)}updatePaintBuffers(e){this._buffers=[];for(const n in this.binders){const h=this.binders[n];if(e&&h instanceof ci){const m=e.fromScale===2?h.zoomInPaintVertexBuffer:h.zoomOutPaintVertexBuffer;m&&this._buffers.push(m)}else(h instanceof ea||h instanceof pa)&&h.paintVertexBuffer&&this._buffers.push(h.paintVertexBuffer)}}upload(e){for(const n in this.binders){const h=this.binders[n];(h instanceof ea||h instanceof pa||h instanceof ci)&&h.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const n=this.binders[e];(n instanceof ea||n instanceof pa||n instanceof ci)&&n.destroy()}}}class Zc{constructor(e,n,h=()=>!0){this.programConfigurations={};for(const m of e)this.programConfigurations[m.id]=new Gf(m,n,h);this.needsUpload=!1,this._featureMap=new ji,this._bufferOffset=0}populatePaintArrays(e,n,h,m){for(const y in this.programConfigurations)this.programConfigurations[y].populatePaintArrays(e,n,m);n.id!==void 0&&this._featureMap.add(n.id,h,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,n,h,m){for(const y of h)this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(e,this._featureMap,n,y,m)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function Lp(a,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[a]||[a.replace(`${e}-`,"").replace(/-/g,"_")]}function Wc(a,e,n){const h={color:{source:Aa,composite:o},number:{source:Ru,composite:Aa}},m=(function(y){return{"line-pattern":{source:tt,composite:tt},"fill-pattern":{source:tt,composite:tt},"fill-extrusion-pattern":{source:tt,composite:tt},"line-dasharray":{source:lt,composite:lt}}[y]})(a);return m&&m[n]||h[e][n]}Cr("ConstantBinder",Do),Cr("CrossFadedConstantBinder",Ro),Cr("SourceExpressionBinder",ea),Cr("CrossFadedPatternBinder",_i),Cr("CrossFadedDasharrayBinder",Vf),Cr("CompositeExpressionBinder",pa),Cr("ProgramConfiguration",Gf,{omit:["_buffers"]}),Cr("ProgramConfigurationSet",Zc);const Hf=Math.pow(2,14)-1,pc=-Hf-1;function mc(a){const e=Oe/a.extent,n=a.loadGeometry();for(let h=0;h<n.length;h++){const m=n[h];for(let y=0;y<m.length;y++){const v=m[y],E=Math.round(v.x*e),k=Math.round(v.y*e);v.x=bt(E,pc,Hf),v.y=bt(k,pc,Hf),(E<v.x||E>v.x+1||k<v.y||k>v.y+1)&&se("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return n}function pl(a,e){return{type:a.type,id:a.id,properties:a.properties,geometry:e?mc(a):[]}}const qf=-32768;function of(a,e,n,h,m){a.emplaceBack(qf+8*e+h,qf+8*n+m)}class lf{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((n=>n.id)),this.index=e.index,this.hasDependencies=!1,this.layoutVertexArray=new Be,this.indexArray=new Ct,this.segments=new br,this.programConfigurations=new Zc(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter((n=>n.isStateDependent())).map((n=>n.id))}populate(e,n,h){const m=this.layers[0],y=[];let v=null,E=!1,k=m.type==="heatmap";if(m.type==="circle"){const z=m;v=z.layout.get("circle-sort-key"),E=!v.isConstant(),k=k||z.paint.get("circle-pitch-alignment")==="map"}const P=k?n.subdivisionGranularity.circle:1;for(const{feature:z,id:G,index:W,sourceLayerIndex:K}of e){const ie=this.layers[0]._featureFilter.needGeometry,oe=pl(z,ie);if(!this.layers[0]._featureFilter.filter(new Qn(this.zoom),oe,h))continue;const ue=E?v.evaluate(oe,{},h):void 0,be={id:G,properties:z.properties,type:z.type,sourceLayerIndex:K,index:W,geometry:ie?oe.geometry:mc(z),patterns:{},sortKey:ue};y.push(be)}E&&y.sort(((z,G)=>z.sortKey-G.sortKey));for(const z of y){const{geometry:G,index:W,sourceLayerIndex:K}=z,ie=e[W].feature;this.addFeature(z,G,W,h,P),n.featureIndex.insert(ie,G,W,K,this.index)}}update(e,n,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,{imagePositions:h})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,tr),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,n,h,m,y=1){let v;switch(y){case 1:v=[0,7];break;case 3:v=[0,2,5,7];break;case 5:v=[0,1,3,4,6,7];break;case 7:v=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${y}; valid values are 1, 3, 5, 7.`)}const E=v.length;for(const k of n)for(const P of k){const z=P.x,G=P.y;if(z<0||z>=Oe||G<0||G>=Oe)continue;const W=this.segments.prepareSegment(E*E,this.layoutVertexArray,this.indexArray,e.sortKey),K=W.vertexLength;for(let ie=0;ie<E;ie++)for(let oe=0;oe<E;oe++)of(this.layoutVertexArray,z,G,v[oe],v[ie]);for(let ie=0;ie<E-1;ie++)for(let oe=0;oe<E-1;oe++){const ue=K+ie*E+oe,be=K+(ie+1)*E+oe;this.indexArray.emplaceBack(ue,be+1,ue+1),this.indexArray.emplaceBack(ue,be,be+1)}W.vertexLength+=E*E,W.primitiveLength+=(E-1)*(E-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,h,{imagePositions:{},canonical:m})}}function cf(a,e){for(let n=0;n<a.length;n++)if($c(e,a[n]))return!0;for(let n=0;n<e.length;n++)if($c(a,e[n]))return!0;return!!ns(a,e)}function zp(a,e,n){return!!$c(a,e)||!!Bp(e,a,n)}function Op(a,e){if(a.length===1)return lm(e,a[0]);for(let n=0;n<e.length;n++){const h=e[n];for(let m=0;m<h.length;m++)if($c(a,h[m]))return!0}for(let n=0;n<a.length;n++)if(lm(e,a[n]))return!0;for(let n=0;n<e.length;n++)if(ns(a,e[n]))return!0;return!1}function Ui(a,e,n){if(a.length>1){if(ns(a,e))return!0;for(let h=0;h<e.length;h++)if(Bp(e[h],a,n))return!0}for(let h=0;h<a.length;h++)if(Bp(a[h],e,n))return!0;return!1}function ns(a,e){if(a.length===0||e.length===0)return!1;for(let n=0;n<a.length-1;n++){const h=a[n],m=a[n+1];for(let y=0;y<e.length-1;y++)if(Yg(h,m,e[y],e[y+1]))return!0}return!1}function Yg(a,e,n,h){return Mt(a,n,h)!==Mt(e,n,h)&&Mt(a,e,n)!==Mt(a,e,h)}function Bp(a,e,n){const h=n*n;if(e.length===1)return a.distSqr(e[0])<h;for(let m=1;m<e.length;m++)if(om(a,e[m-1],e[m])<h)return!0;return!1}function om(a,e,n){const h=e.distSqr(n);if(h===0)return a.distSqr(e);const m=((a.x-e.x)*(n.x-e.x)+(a.y-e.y)*(n.y-e.y))/h;return a.distSqr(m<0?e:m>1?n:n.sub(e)._mult(m)._add(e))}function lm(a,e){let n,h,m,y=!1;for(let v=0;v<a.length;v++){n=a[v];for(let E=0,k=n.length-1;E<n.length;k=E++)h=n[E],m=n[k],h.y>e.y!=m.y>e.y&&e.x<(m.x-h.x)*(e.y-h.y)/(m.y-h.y)+h.x&&(y=!y)}return y}function $c(a,e){let n=!1;for(let h=0,m=a.length-1;h<a.length;m=h++){const y=a[h],v=a[m];y.y>e.y!=v.y>e.y&&e.x<(v.x-y.x)*(e.y-y.y)/(v.y-y.y)+y.x&&(n=!n)}return n}function Kg(a,e,n){const h=n[0],m=n[2];if(a.x<h.x&&e.x<h.x||a.x>m.x&&e.x>m.x||a.y<h.y&&e.y<h.y||a.y>m.y&&e.y>m.y)return!1;const y=Mt(a,e,n[0]);return y!==Mt(a,e,n[1])||y!==Mt(a,e,n[2])||y!==Mt(a,e,n[3])}function Pu(a,e,n){const h=e.paint.get(a).value;return h.kind==="constant"?h.value:n.programConfigurations.get(e.id).getMaxValue(a)}function Dd(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function Np(a,e,n,h,m){if(!e[0]&&!e[1])return a;const y=C.convert(e)._mult(m);n==="viewport"&&y._rotate(-h);const v=[];for(let E=0;E<a.length;E++)v.push(a[E].sub(y));return v}function jp(a){const e=[];for(let n=0;n<a.length;n++){const h=a[n],m=e.at(-1);(n===0||m&&!h.equals(m))&&e.push(h)}return e}function cm({queryGeometry:a,size:e},n){return zp(a,n,e)}function Jg({queryGeometry:a,size:e,transform:n,unwrappedTileID:h,getElevation:m},y){return zp(a,y,e*(n.projectTileCoordinates(y.x,y.y,h,m).signedDistanceFromCamera/n.cameraToCenterDistance))}function Qg({queryGeometry:a,size:e,transform:n,unwrappedTileID:h,getElevation:m},y){const v=n.projectTileCoordinates(y.x,y.y,h,m).signedDistanceFromCamera,E=e*(n.cameraToCenterDistance/v);return zp(a,Rd(y,n,h,m),E)}function e_({queryGeometry:a,size:e,transform:n,unwrappedTileID:h,getElevation:m},y){return zp(a,Rd(y,n,h,m),e)}function Up({queryGeometry:a,size:e,transform:n,unwrappedTileID:h,getElevation:m,pitchAlignment:y="map",pitchScale:v="map"},E){const k=y==="map"?v==="map"?cm:Jg:v==="map"?Qg:e_,P={queryGeometry:a,size:e,transform:n,unwrappedTileID:h,getElevation:m};for(const z of E)for(const G of z)if(k(P,G))return!0;return!1}function Rd(a,e,n,h){const m=e.projectTileCoordinates(a.x,a.y,n,h).point;return new C((.5*m.x+.5)*e.width,(.5*-m.y+.5)*e.height)}let Vp,um;Cr("CircleBucket",lf,{omit:["layers"]});var hm={get paint(){return um=um||new ni({"circle-radius":new jr(ht.paint_circle["circle-radius"]),"circle-color":new jr(ht.paint_circle["circle-color"]),"circle-blur":new jr(ht.paint_circle["circle-blur"]),"circle-opacity":new jr(ht.paint_circle["circle-opacity"]),"circle-translate":new Rr(ht.paint_circle["circle-translate"]),"circle-translate-anchor":new Rr(ht.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Rr(ht.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Rr(ht.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new jr(ht.paint_circle["circle-stroke-width"]),"circle-stroke-color":new jr(ht.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new jr(ht.paint_circle["circle-stroke-opacity"])})},get layout(){return Vp=Vp||new ni({"circle-sort-key":new jr(ht.layout_circle["circle-sort-key"])})}};class Gp extends Va{constructor(e,n){super(e,hm,n)}createBucket(e){return new lf(e)}queryRadius(e){const n=e;return Pu("circle-radius",this,n)+Pu("circle-stroke-width",this,n)+Dd(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:e,feature:n,featureState:h,geometry:m,transform:y,pixelsToTileUnits:v,unwrappedTileID:E,getElevation:k}){const P=Np(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-y.bearingInRadians,v),z=this.paint.get("circle-radius").evaluate(n,h)+this.paint.get("circle-stroke-width").evaluate(n,h),G=this.paint.get("circle-pitch-scale"),W=this.paint.get("circle-pitch-alignment");let K,ie;return W==="map"?(K=P,ie=z*v):(K=(function(oe,ue,be,We){return oe.map((Se=>Rd(Se,ue,be,We)))})(P,y,E,k),ie=z),Up({queryGeometry:K,size:ie,transform:y,unwrappedTileID:E,getElevation:k,pitchAlignment:W,pitchScale:G},m)}}class Hp extends lf{}let fm;Cr("HeatmapBucket",Hp,{omit:["layers"]});var dm={get paint(){return fm=fm||new ni({"heatmap-radius":new jr(ht.paint_heatmap["heatmap-radius"]),"heatmap-weight":new jr(ht.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Rr(ht.paint_heatmap["heatmap-intensity"]),"heatmap-color":new tf(ht.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Rr(ht.paint_heatmap["heatmap-opacity"])})}};function qp(a,{width:e,height:n},h,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==e*n*h)throw new RangeError(`mismatched image size. expected: ${m.length} but got: ${e*n*h}`)}else m=new Uint8Array(e*n*h);return a.width=e,a.height=n,a.data=m,a}function Xc(a,{width:e,height:n},h){if(e===a.width&&n===a.height)return;const m=qp({},{width:e,height:n},h);Id(a,m,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,e),height:Math.min(a.height,n)},h),a.width=e,a.height=n,a.data=m.data}function Id(a,e,n,h,m,y){if(m.width===0||m.height===0)return e;if(m.width>a.width||m.height>a.height||n.x>a.width-m.width||n.y>a.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>e.width||m.height>e.height||h.x>e.width-m.width||h.y>e.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const v=a.data,E=e.data;if(v===E)throw new Error("srcData equals dstData, so image is already copied");for(let k=0;k<m.height;k++){const P=((n.y+k)*a.width+n.x)*y,z=((h.y+k)*e.width+h.x)*y;for(let G=0;G<m.width*y;G++)E[z+G]=v[P+G]}return e}class Pd{constructor(e,n){qp(this,e,1,n)}resize(e){Xc(this,e,1)}clone(){return new Pd({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,h,m,y){Id(e,n,h,m,y,1)}}class Hs{constructor(e,n){qp(this,e,4,n)}resize(e){Xc(this,e,4)}replace(e,n){n?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Hs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,h,m,y){Id(e,n,h,m,y,4)}setPixel(e,n,h){const m=4*(e*this.width+n);this.data[m+0]=Math.round(255*h.r/h.a),this.data[m+1]=Math.round(255*h.g/h.a),this.data[m+2]=Math.round(255*h.b/h.a),this.data[m+3]=Math.round(255*h.a)}}function Yc(a){const e={},n=a.resolution||256,h=a.clips?a.clips.length:1,m=a.image||new Hs({width:n,height:h});if(Math.log(n)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${n}`);const y=(v,E,k)=>{e[a.evaluationKey]=k;const P=a.expression.evaluate(e);m.setPixel(v/4/n,E/4,P)};if(a.clips)for(let v=0,E=0;v<h;++v,E+=4*n)for(let k=0,P=0;k<n;k++,P+=4){const z=k/(n-1),{start:G,end:W}=a.clips[v];y(E,P,G*(1-z)+W*z)}else for(let v=0,E=0;v<n;v++,E+=4)y(0,E,v/(n-1));return m}Cr("AlphaImage",Pd),Cr("RGBAImage",Hs);const Fd="big-fb";class t_ extends Va{createBucket(e){return new Hp(e)}constructor(e,n){super(e,dm,n),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Yc({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Fd)&&this.heatmapFbos.delete(Fd)}queryRadius(e){return Pu("heatmap-radius",this,e)}queryIntersectsFeature({queryGeometry:e,feature:n,featureState:h,geometry:m,transform:y,pixelsToTileUnits:v,unwrappedTileID:E,getElevation:k}){return Up({queryGeometry:e,size:this.paint.get("heatmap-radius").evaluate(n,h)*v,transform:y,unwrappedTileID:E,getElevation:k},m)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&!this.isHidden()}}let Ld;var zd={get paint(){return Ld=Ld||new ni({"hillshade-illumination-direction":new Rr(ht.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Rr(ht.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Rr(ht.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Rr(ht.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Rr(ht.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Rr(ht.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Rr(ht.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Rr(ht.paint_hillshade["hillshade-method"])})}};class Ka extends Va{constructor(e,n){super(e,zd,n),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let e=this.paint.get("hillshade-illumination-direction").values,n=this.paint.get("hillshade-illumination-altitude").values,h=this.paint.get("hillshade-highlight-color").values,m=this.paint.get("hillshade-shadow-color").values;const y=Math.max(e.length,n.length,h.length,m.length);e=e.concat(Array(y-e.length).fill(e.at(-1))),n=n.concat(Array(y-n.length).fill(n.at(-1))),h=h.concat(Array(y-h.length).fill(h.at(-1))),m=m.concat(Array(y-m.length).fill(m.at(-1)));const v=n.map(pr);return{directionRadians:e.map(pr),altitudeRadians:v,shadowColor:m,highlightColor:h}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&!this.isHidden()}}let r_;var Vx={get paint(){return r_=r_||new ni({"color-relief-opacity":new Rr(ht["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new tf(ht["paint_color-relief"]["color-relief-color"])})}};class Zp{constructor(e,n,h,m){this.context=e,this.format=h,this.texture=e.gl.createTexture(),this.update(n,m)}update(e,n,h){const{width:m,height:y}=e,v=!(this.size&&this.size[0]===m&&this.size[1]===y||h),{context:E}=this,{gl:k}=E;if(this.useMipmap=!!(n&&n.useMipmap),k.bindTexture(k.TEXTURE_2D,this.texture),E.pixelStoreUnpackFlipY.set(!1),E.pixelStoreUnpack.set(1),E.pixelStoreUnpackPremultiplyAlpha.set(this.format===k.RGBA&&(!n||n.premultiply!==!1)),v)this.size=[m,y],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||Ne(e)?k.texImage2D(k.TEXTURE_2D,0,this.format,this.format,k.UNSIGNED_BYTE,e):k.texImage2D(k.TEXTURE_2D,0,this.format,m,y,0,this.format,k.UNSIGNED_BYTE,e.data);else{const{x:P,y:z}=h||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||Ne(e)?k.texSubImage2D(k.TEXTURE_2D,0,P,z,k.RGBA,k.UNSIGNED_BYTE,e):k.texSubImage2D(k.TEXTURE_2D,0,P,z,m,y,k.RGBA,k.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&k.generateMipmap(k.TEXTURE_2D),E.pixelStoreUnpackFlipY.setDefault(),E.pixelStoreUnpack.setDefault(),E.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(e,n,h){const{context:m}=this,{gl:y}=m;y.bindTexture(y.TEXTURE_2D,this.texture),h!==y.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(h=y.LINEAR),e!==this.filter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,e),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,h||e),this.filter=e),n!==this.wrap&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,n),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,n),this.wrap=n)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class Zf{constructor(e,n,h,m=1,y=1,v=1,E=0){if(this.uid=e,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(h&&!["mapbox","terrarium","custom"].includes(h))return void se(`"${h}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=n.height;const k=this.dim=n.height-2;switch(this.data=new Uint32Array(n.data.buffer),h){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=m,this.greenFactor=y,this.blueFactor=v,this.baseShift=E;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let P=0;P<k;P++)this.data[this._idx(-1,P)]=this.data[this._idx(0,P)],this.data[this._idx(k,P)]=this.data[this._idx(k-1,P)],this.data[this._idx(P,-1)]=this.data[this._idx(P,0)],this.data[this._idx(P,k)]=this.data[this._idx(P,k-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(k,-1)]=this.data[this._idx(k-1,0)],this.data[this._idx(-1,k)]=this.data[this._idx(0,k-1)],this.data[this._idx(k,k)]=this.data[this._idx(k-1,k-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let P=0;P<k;P++)for(let z=0;z<k;z++){const G=this.get(P,z);G>this.max&&(this.max=G),G<this.min&&(this.min=G)}}get(e,n){const h=new Uint8Array(this.data.buffer),m=4*this._idx(e,n);return this.unpack(h[m],h[m+1],h[m+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,n){if(e<-1||e>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError(`Out of range source coordinates for DEM data. x: ${e}, y: ${n}, dim: ${this.dim}`);return(n+1)*this.stride+(e+1)}unpack(e,n,h){return e*this.redFactor+n*this.greenFactor+h*this.blueFactor-this.baseShift}pack(e){return Fu(e,this.getUnpackVector())}getPixels(){return new Hs({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,n,h){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let m=n*this.dim,y=n*this.dim+this.dim,v=h*this.dim,E=h*this.dim+this.dim;switch(n){case-1:m=y-1;break;case 1:y=m+1}switch(h){case-1:v=E-1;break;case 1:E=v+1}const k=-n*this.dim,P=-h*this.dim;for(let z=v;z<E;z++)for(let G=m;G<y;G++)this.data[this._idx(G,z)]=e.data[this._idx(G+k,z+P)]}}function Fu(a,e){const n=e[0],h=e[1],m=e[2],y=e[3],v=Math.min(n,h,m),E=Math.round((a+y)/v);return{r:Math.floor(E*v/n)%256,g:Math.floor(E*v/h)%256,b:Math.floor(E*v/m)%256}}Cr("DEMData",Zf);class n_ extends Va{constructor(e,n){super(e,Vx,n)}_createColorRamp(e){const n={elevationStops:[],colorStops:[]},h=this._transitionablePaint._values["color-relief-color"].value.expression;if(h instanceof Vr&&h._styleExpression.expression instanceof ti){this.colorRampExpression=h;const v=h._styleExpression.expression;n.elevationStops=v.labels,n.colorStops=[];for(const E of n.elevationStops)n.colorStops.push(v.evaluate({globals:{elevation:E}}))}if(n.elevationStops.length<1&&(n.elevationStops=[0],n.colorStops=[ln.transparent]),n.elevationStops.length<2&&(n.elevationStops.push(n.elevationStops[0]+1),n.colorStops.push(n.colorStops[0])),n.elevationStops.length<=e)return n;const m={elevationStops:[],colorStops:[]},y=(n.elevationStops.length-1)/(e-1);for(let v=0;v<n.elevationStops.length-.5;v+=y)m.elevationStops.push(n.elevationStops[Math.round(v)]),m.colorStops.push(n.colorStops[Math.round(v)]);return se(`Too many colors in specification of ${this.id} color-relief layer, may not render properly. Max possible colors: ${e}, provided: ${n.elevationStops.length}`),m}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(e,n,h){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const m=this._createColorRamp(n),y=new Hs({width:m.colorStops.length,height:1}),v=new Hs({width:m.colorStops.length,height:1});for(let E=0;E<m.elevationStops.length;E++){const k=Fu(m.elevationStops[E],h);v.setPixel(0,E,new ln(k.r/255,k.g/255,k.b/255,1)),y.setPixel(0,E,m.colorStops[E])}return this.colorRampTextures={elevationTexture:new Zp(e,v,e.gl.RGBA),colorTexture:new Zp(e,y,e.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return!this.isHidden()&&!!this.colorRampTextures}}const a_=Fa([{name:"a_pos",components:2,type:"Int16"}],4),{members:Od}=a_;function ml(a,e,n){const h=n.patternDependencies;let m=!1;for(const y of e){const v=y.paint.get(`${a}-pattern`);v.isConstant()||(m=!0);const E=v.constantOr(null);E&&(m=!0,h[E.to]=!0,h[E.from]=!0)}return m}function Wp(a,e,n,h,m){const{zoom:y}=h,v=m.patternDependencies;for(const E of e){const k=E.paint.get(`${a}-pattern`).value;if(k.kind!=="constant"){let P=k.evaluate({zoom:y-1},n,{},m.availableImages),z=k.evaluate({zoom:y},n,{},m.availableImages),G=k.evaluate({zoom:y+1},n,{},m.availableImages);P=P&&P.name?P.name:P,z=z&&z.name?z.name:z,G=G&&G.name?G.name:G,v[P]=!0,v[z]=!0,v[G]=!0,n.patterns[E.id]={min:P,mid:z,max:G}}}return n}function $p(a,e,n,h,m){let y;if(m===(function(v,E,k,P){let z=0;for(let G=E,W=k-P;G<k;G+=P)z+=(v[W]-v[G])*(v[G+1]+v[W+1]),W=G;return z})(a,e,n,h)>0)for(let v=e;v<n;v+=h)y=so(v/h|0,a[v],a[v+1],y);else for(let v=n-h;v>=e;v-=h)y=so(v/h|0,a[v],a[v+1],y);return y&&Io(y,y.next)&&(oo(y),y=y.next),y}function bh(a,e){if(!a)return a;e||(e=a);let n,h=a;do if(n=!1,h.steiner||!Io(h,h.next)&&Vn(h.prev,h,h.next)!==0)h=h.next;else{if(oo(h),h=e=h.prev,h===h.next)break;n=!0}while(n||h!==e);return e}function uf(a,e,n,h,m,y,v){if(!a)return;!v&&y&&(function(k,P,z,G){let W=k;do W.z===0&&(W.z=Gi(W.x,W.y,P,z,G)),W.prevZ=W.prev,W.nextZ=W.next,W=W.next;while(W!==k);W.prevZ.nextZ=null,W.prevZ=null,(function(K){let ie,oe=1;do{let ue,be=K;K=null;let We=null;for(ie=0;be;){ie++;let Se=be,De=0;for(let at=0;at<oe&&(De++,Se=Se.nextZ,Se);at++);let Je=oe;for(;De>0||Je>0&&Se;)De!==0&&(Je===0||!Se||be.z<=Se.z)?(ue=be,be=be.nextZ,De--):(ue=Se,Se=Se.nextZ,Je--),We?We.nextZ=ue:K=ue,ue.prevZ=We,We=ue;be=Se}We.nextZ=null,oe*=2}while(ie>1)})(W)})(a,h,m,y);let E=a;for(;a.prev!==a.next;){const k=a.prev,P=a.next;if(y?Xp(a,h,m,y):pm(a))e.push(k.i,a.i,P.i),oo(a),a=P.next,E=P.next;else if((a=P)===E){v?v===1?uf(a=i_(bh(a),e),e,n,h,m,y,2):v===2&&Lu(a,e,n,h,m,y):uf(bh(a),e,n,h,m,y,1);break}}}function pm(a){const e=a.prev,n=a,h=a.next;if(Vn(e,n,h)>=0)return!1;const m=e.x,y=n.x,v=h.x,E=e.y,k=n.y,P=h.y,z=Math.min(m,y,v),G=Math.min(E,k,P),W=Math.max(m,y,v),K=Math.max(E,k,P);let ie=h.next;for(;ie!==e;){if(ie.x>=z&&ie.x<=W&&ie.y>=G&&ie.y<=K&&Wf(m,E,y,k,v,P,ie.x,ie.y)&&Vn(ie.prev,ie,ie.next)>=0)return!1;ie=ie.next}return!0}function Xp(a,e,n,h){const m=a.prev,y=a,v=a.next;if(Vn(m,y,v)>=0)return!1;const E=m.x,k=y.x,P=v.x,z=m.y,G=y.y,W=v.y,K=Math.min(E,k,P),ie=Math.min(z,G,W),oe=Math.max(E,k,P),ue=Math.max(z,G,W),be=Gi(K,ie,e,n,h),We=Gi(oe,ue,e,n,h);let Se=a.prevZ,De=a.nextZ;for(;Se&&Se.z>=be&&De&&De.z<=We;){if(Se.x>=K&&Se.x<=oe&&Se.y>=ie&&Se.y<=ue&&Se!==m&&Se!==v&&Wf(E,z,k,G,P,W,Se.x,Se.y)&&Vn(Se.prev,Se,Se.next)>=0||(Se=Se.prevZ,De.x>=K&&De.x<=oe&&De.y>=ie&&De.y<=ue&&De!==m&&De!==v&&Wf(E,z,k,G,P,W,De.x,De.y)&&Vn(De.prev,De,De.next)>=0))return!1;De=De.nextZ}for(;Se&&Se.z>=be;){if(Se.x>=K&&Se.x<=oe&&Se.y>=ie&&Se.y<=ue&&Se!==m&&Se!==v&&Wf(E,z,k,G,P,W,Se.x,Se.y)&&Vn(Se.prev,Se,Se.next)>=0)return!1;Se=Se.prevZ}for(;De&&De.z<=We;){if(De.x>=K&&De.x<=oe&&De.y>=ie&&De.y<=ue&&De!==m&&De!==v&&Wf(E,z,k,G,P,W,De.x,De.y)&&Vn(De.prev,De,De.next)>=0)return!1;De=De.nextZ}return!0}function i_(a,e){let n=a;do{const h=n.prev,m=n.next.next;!Io(h,m)&&_m(h,n,n.next,m)&&jd(h,m)&&jd(m,h)&&(e.push(h.i,n.i,m.i),oo(n),oo(n.next),n=a=m),n=n.next}while(n!==a);return bh(n)}function Lu(a,e,n,h,m,y){let v=a;do{let E=v.next.next;for(;E!==v.prev;){if(v.i!==E.i&&ai(v,E)){let k=Ud(v,E);return v=bh(v,v.next),k=bh(k,k.next),uf(v,e,n,h,m,y,0),void uf(k,e,n,h,m,y,0)}E=E.next}v=v.next}while(v!==a)}function Vi(a,e){let n=a.x-e.x;return n===0&&(n=a.y-e.y,n===0)&&(n=(a.next.y-a.y)/(a.next.x-a.x)-(e.next.y-e.y)/(e.next.x-e.x)),n}function mm(a,e){const n=(function(m,y){let v=y;const E=m.x,k=m.y;let P,z=-1/0;if(Io(m,v))return v;do{if(Io(m,v.next))return v.next;if(k<=v.y&&k>=v.next.y&&v.next.y!==v.y){const oe=v.x+(k-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(oe<=E&&oe>z&&(z=oe,P=v.x<v.next.x?v:v.next,oe===E))return P}v=v.next}while(v!==y);if(!P)return null;const G=P,W=P.x,K=P.y;let ie=1/0;v=P;do{if(E>=v.x&&v.x>=W&&E!==v.x&&gm(k<K?E:z,k,W,K,k<K?z:E,k,v.x,v.y)){const oe=Math.abs(k-v.y)/(E-v.x);jd(v,m)&&(oe<ie||oe===ie&&(v.x>P.x||v.x===P.x&&s_(P,v)))&&(P=v,ie=oe)}v=v.next}while(v!==G);return P})(a,e);if(!n)return e;const h=Ud(n,a);return bh(h,h.next),bh(n,n.next)}function s_(a,e){return Vn(a.prev,a,e.prev)<0&&Vn(e.next,a,a.next)<0}function Gi(a,e,n,h,m){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-n)*m|0)|a<<8))|a<<4))|a<<2))|a<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-h)*m|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Gx(a){let e=a,n=a;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==a);return n}function gm(a,e,n,h,m,y,v,E){return(m-v)*(e-E)>=(a-v)*(y-E)&&(a-v)*(h-E)>=(n-v)*(e-E)&&(n-v)*(y-E)>=(m-v)*(h-E)}function Wf(a,e,n,h,m,y,v,E){return!(a===v&&e===E)&&gm(a,e,n,h,m,y,v,E)}function ai(a,e){return a.next.i!==e.i&&a.prev.i!==e.i&&!(function(n,h){let m=n;do{if(m.i!==n.i&&m.next.i!==n.i&&m.i!==h.i&&m.next.i!==h.i&&_m(m,m.next,n,h))return!0;m=m.next}while(m!==n);return!1})(a,e)&&(jd(a,e)&&jd(e,a)&&(function(n,h){let m=n,y=!1;const v=(n.x+h.x)/2,E=(n.y+h.y)/2;do m.y>E!=m.next.y>E&&m.next.y!==m.y&&v<(m.next.x-m.x)*(E-m.y)/(m.next.y-m.y)+m.x&&(y=!y),m=m.next;while(m!==n);return y})(a,e)&&(Vn(a.prev,a,e.prev)||Vn(a,e.prev,e))||Io(a,e)&&Vn(a.prev,a,a.next)>0&&Vn(e.prev,e,e.next)>0)}function Vn(a,e,n){return(e.y-a.y)*(n.x-e.x)-(e.x-a.x)*(n.y-e.y)}function Io(a,e){return a.x===e.x&&a.y===e.y}function _m(a,e,n,h){const m=Nd(Vn(a,e,n)),y=Nd(Vn(a,e,h)),v=Nd(Vn(n,h,a)),E=Nd(Vn(n,h,e));return m!==y&&v!==E||!(m!==0||!Bd(a,n,e))||!(y!==0||!Bd(a,h,e))||!(v!==0||!Bd(n,a,h))||!(E!==0||!Bd(n,e,h))}function Bd(a,e,n){return e.x<=Math.max(a.x,n.x)&&e.x>=Math.min(a.x,n.x)&&e.y<=Math.max(a.y,n.y)&&e.y>=Math.min(a.y,n.y)}function Nd(a){return a>0?1:a<0?-1:0}function jd(a,e){return Vn(a.prev,a,a.next)<0?Vn(a,e,a.next)>=0&&Vn(a,a.prev,e)>=0:Vn(a,e,a.prev)<0||Vn(a,a.next,e)<0}function Ud(a,e){const n=Yp(a.i,a.x,a.y),h=Yp(e.i,e.x,e.y),m=a.next,y=e.prev;return a.next=e,e.prev=a,n.next=m,m.prev=n,h.next=n,n.prev=h,y.next=h,h.prev=y,h}function so(a,e,n,h){const m=Yp(a,e,n);return h?(m.next=h.next,m.prev=h,h.next.prev=m,h.next=m):(m.prev=m,m.next=m),m}function oo(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function Yp(a,e,n){return{i:a,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class as{constructor(e,n){if(n>e)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=e,this._minGranularity=n}getGranularityForZoomLevel(e){return Math.max(Math.floor(this._baseZoomGranularity/(1<<e)),this._minGranularity,1)}}class Vd{constructor(e){this.fill=e.fill,this.line=e.line,this.tile=e.tile,this.stencil=e.stencil,this.circle=e.circle}}Vd.noSubdivision=new Vd({fill:new as(0,0),line:new as(0,0),tile:new as(0,0),stencil:new as(0,0),circle:1}),Cr("SubdivisionGranularityExpression",as),Cr("SubdivisionGranularitySetting",Vd);const Po=-32768,gc=32767;class zu{constructor(e,n){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=e,this._granularityCellSize=Oe/e,this._canonical=n}_getKey(e,n){return(e+=32768)<<16|n+32768}_vertexToIndex(e,n){if(e<-32768||n<-32768||e>32767||n>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const h=0|Math.round(e),m=0|Math.round(n),y=this._getKey(h,m);if(this._vertexDictionary.has(y))return this._vertexDictionary.get(y);const v=this._vertexBuffer.length/2;return this._vertexDictionary.set(y,v),this._vertexBuffer.push(h,m),v}_subdivideTrianglesScanline(e){if(this._granularity<2)return(function(m,y){const v=[];for(let E=0;E<y.length;E+=3){const k=y[E],P=y[E+1],z=y[E+2],G=m[2*k],W=m[2*k+1];(m[2*P]-G)*(m[2*z+1]-W)-(m[2*P+1]-W)*(m[2*z]-G)>0?(v.push(k),v.push(z),v.push(P)):(v.push(k),v.push(P),v.push(z))}return v})(this._vertexBuffer,e);const n=[],h=e.length;for(let m=0;m<h;m+=3){const y=[e[m+0],e[m+1],e[m+2]],v=[this._vertexBuffer[2*e[m+0]+0],this._vertexBuffer[2*e[m+0]+1],this._vertexBuffer[2*e[m+1]+0],this._vertexBuffer[2*e[m+1]+1],this._vertexBuffer[2*e[m+2]+0],this._vertexBuffer[2*e[m+2]+1]];let E=1/0,k=1/0,P=-1/0,z=-1/0;for(let oe=0;oe<3;oe++){const ue=v[2*oe],be=v[2*oe+1];E=Math.min(E,ue),P=Math.max(P,ue),k=Math.min(k,be),z=Math.max(z,be)}if(E===P||k===z)continue;const G=Math.floor(E/this._granularityCellSize),W=Math.ceil(P/this._granularityCellSize),K=Math.floor(k/this._granularityCellSize),ie=Math.ceil(z/this._granularityCellSize);if(G!==W||K!==ie)for(let oe=K;oe<ie;oe++){const ue=this._scanlineGenerateVertexRingForCellRow(oe,v,y);_c(this._vertexBuffer,ue,n)}else n.push(...y)}return n}_scanlineGenerateVertexRingForCellRow(e,n,h){const m=e*this._granularityCellSize,y=m+this._granularityCellSize,v=[];for(let E=0;E<3;E++){const k=n[2*E],P=n[2*E+1],z=n[2*(E+1)%6],G=n[(2*(E+1)+1)%6],W=n[2*(E+2)%6],K=n[(2*(E+2)+1)%6],ie=z-k,oe=G-P,ue=ie===0,be=oe===0,We=(m-P)/oe,Se=(y-P)/oe,De=Math.min(We,Se),Je=Math.max(We,Se);if(!be&&(De>=1||Je<=0)||be&&(P<m||P>y)){G>=m&&G<=y&&v.push(h[(E+1)%3]);continue}!be&&De>0&&v.push(this._vertexToIndex(k+ie*De,P+oe*De));const at=k+ie*Math.max(De,0),St=k+ie*Math.min(Je,1);ue||this._generateIntraEdgeVertices(v,k,P,z,G,at,St),!be&&Je<1&&v.push(this._vertexToIndex(k+ie*Je,P+oe*Je)),(be||G>=m&&G<=y)&&v.push(h[(E+1)%3]),!be&&(G<=m||G>=y)&&this._generateInterEdgeVertices(v,k,P,z,G,W,K,St,m,y)}return v}_generateIntraEdgeVertices(e,n,h,m,y,v,E){const k=m-n,P=y-h,z=P===0,G=z?Math.min(n,m):Math.min(v,E),W=z?Math.max(n,m):Math.max(v,E),K=Math.floor(G/this._granularityCellSize)+1,ie=Math.ceil(W/this._granularityCellSize)-1;if(z?n<m:v<E)for(let oe=K;oe<=ie;oe++){const ue=oe*this._granularityCellSize;e.push(this._vertexToIndex(ue,h+P*(ue-n)/k))}else for(let oe=ie;oe>=K;oe--){const ue=oe*this._granularityCellSize;e.push(this._vertexToIndex(ue,h+P*(ue-n)/k))}}_generateInterEdgeVertices(e,n,h,m,y,v,E,k,P,z){const G=y-h,W=v-m,K=E-y,ie=(P-y)/K,oe=(z-y)/K,ue=Math.min(ie,oe),be=Math.max(ie,oe),We=m+W*ue;let Se=Math.floor(Math.min(We,k)/this._granularityCellSize)+1,De=Math.ceil(Math.max(We,k)/this._granularityCellSize)-1,Je=k<We;const at=K===0;if(at&&(E===P||E===z))return;if(at||ue>=1||be<=0){const Xt=h-E,Ut=v+(n-v)*Math.min((P-E)/Xt,(z-E)/Xt);Se=Math.floor(Math.min(Ut,k)/this._granularityCellSize)+1,De=Math.ceil(Math.max(Ut,k)/this._granularityCellSize)-1,Je=k<Ut}const St=G>0?z:P;if(Je)for(let Xt=Se;Xt<=De;Xt++)e.push(this._vertexToIndex(Xt*this._granularityCellSize,St));else for(let Xt=De;Xt>=Se;Xt--)e.push(this._vertexToIndex(Xt*this._granularityCellSize,St))}_generateOutline(e){const n=[];for(const h of e){const m=Ou(h,this._granularity,!0),y=this._pointArrayToIndices(m),v=[];for(let E=1;E<y.length;E++)v.push(y[E-1]),v.push(y[E]);n.push(v)}return n}_handlePoles(e){let n=!1,h=!1;this._canonical&&(this._canonical.y===0&&(n=!0),this._canonical.y===(1<<this._canonical.z)-1&&(h=!0)),(n||h)&&this._fillPoles(e,n,h)}_ensureNoPoleVertices(){const e=this._vertexBuffer;for(let n=0;n<e.length;n+=2){const h=e[n+1];h===Po&&(e[n+1]=-32767),h===gc&&(e[n+1]=32766)}}_generatePoleQuad(e,n,h,m,y,v){m>y!=(v===Po)?(e.push(n),e.push(h),e.push(this._vertexToIndex(m,v)),e.push(h),e.push(this._vertexToIndex(y,v)),e.push(this._vertexToIndex(m,v))):(e.push(h),e.push(n),e.push(this._vertexToIndex(m,v)),e.push(this._vertexToIndex(y,v)),e.push(h),e.push(this._vertexToIndex(m,v)))}_fillPoles(e,n,h){const m=this._vertexBuffer,y=Oe,v=e.length;for(let E=2;E<v;E+=3){const k=e[E-2],P=e[E-1],z=e[E],G=m[2*k],W=m[2*k+1],K=m[2*P],ie=m[2*P+1],oe=m[2*z],ue=m[2*z+1];n&&(W===0&&ie===0&&this._generatePoleQuad(e,k,P,G,K,Po),ie===0&&ue===0&&this._generatePoleQuad(e,P,z,K,oe,Po),ue===0&&W===0&&this._generatePoleQuad(e,z,k,oe,G,Po)),h&&(W===y&&ie===y&&this._generatePoleQuad(e,k,P,G,K,gc),ie===y&&ue===y&&this._generatePoleQuad(e,P,z,K,oe,gc),ue===y&&W===y&&this._generatePoleQuad(e,z,k,oe,G,gc))}}_initializeVertices(e){for(let n=0;n<e.length;n+=2)this._vertexToIndex(e[n],e[n+1])}subdividePolygonInternal(e,n){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:h,holeIndices:m}=(function(E){const k=[],P=[];for(const z of E)if(z.length!==0){z!==E[0]&&k.push(P.length/2);for(let G=0;G<z.length;G++)P.push(z[G].x),P.push(z[G].y)}return{flattened:P,holeIndices:k}})(e);let y;this._initializeVertices(h);try{const E=(function(P,z,G=2){const W=z&&z.length,K=W?z[0]*G:P.length;let ie=$p(P,0,K,G,!0);const oe=[];if(!ie||ie.next===ie.prev)return oe;let ue,be,We;if(W&&(ie=(function(Se,De,Je,at){const St=[];for(let Xt=0,Ut=De.length;Xt<Ut;Xt++){const rr=$p(Se,De[Xt]*at,Xt<Ut-1?De[Xt+1]*at:Se.length,at,!1);rr===rr.next&&(rr.steiner=!0),St.push(Gx(rr))}St.sort(Vi);for(let Xt=0;Xt<St.length;Xt++)Je=mm(St[Xt],Je);return Je})(P,z,ie,G)),P.length>80*G){ue=P[0],be=P[1];let Se=ue,De=be;for(let Je=G;Je<K;Je+=G){const at=P[Je],St=P[Je+1];at<ue&&(ue=at),St<be&&(be=St),at>Se&&(Se=at),St>De&&(De=St)}We=Math.max(Se-ue,De-be),We=We!==0?32767/We:0}return uf(ie,oe,G,ue,be,We,0),oe})(h,m),k=this._convertIndices(h,E);y=this._subdivideTrianglesScanline(k)}catch(E){console.error(E)}let v=[];return n&&(v=this._generateOutline(e)),this._ensureNoPoleVertices(),this._handlePoles(y),{verticesFlattened:this._vertexBuffer,indicesTriangles:y,indicesLineList:v}}_convertIndices(e,n){const h=[];for(let m=0;m<n.length;m++)h.push(this._vertexToIndex(e[2*n[m]],e[2*n[m]+1]));return h}_pointArrayToIndices(e){const n=[];for(let h=0;h<e.length;h++){const m=e[h];n.push(this._vertexToIndex(m.x,m.y))}return n}}function Kp(a,e,n,h=!0){return new zu(n,e).subdividePolygonInternal(a,h)}function Ou(a,e,n=!1){if(!a||a.length<1)return[];if(a.length<2)return[];const h=a[0],m=a[a.length-1],y=n&&(h.x!==m.x||h.y!==m.y);if(e<2)return y?[...a,a[0]]:[...a];const v=Math.floor(Oe/e),E=[];E.push(new C(a[0].x,a[0].y));const k=a.length,P=y?k:k-1;for(let z=0;z<P;z++){const G=a[z],W=z<k-1?a[z+1]:a[0],K=G.x,ie=G.y,oe=W.x,ue=W.y,be=K!==oe,We=ie!==ue;if(!be&&!We)continue;const Se=oe-K,De=ue-ie,Je=Math.abs(Se),at=Math.abs(De);let St=K,Xt=ie;for(;;){const rr=Se>0?(Math.floor(St/v)+1)*v:(Math.ceil(St/v)-1)*v,wr=De>0?(Math.floor(Xt/v)+1)*v:(Math.ceil(Xt/v)-1)*v,ar=Math.abs(St-rr),Zt=Math.abs(Xt-wr),Ft=Math.abs(St-oe),Ir=Math.abs(Xt-ue),Mr=be?ar/Je:Number.POSITIVE_INFINITY,Lr=We?Zt/at:Number.POSITIVE_INFINITY;if((Ft<=ar||!be)&&(Ir<=Zt||!We))break;if(Mr<Lr&&be||!We){St=rr,Xt+=De*Mr;const Ar=new C(St,Math.round(Xt));E[E.length-1].x===Ar.x&&E[E.length-1].y===Ar.y||E.push(Ar)}else{St+=Se*Lr,Xt=wr;const Ar=new C(Math.round(St),Xt);E[E.length-1].x===Ar.x&&E[E.length-1].y===Ar.y||E.push(Ar)}}const Ut=new C(oe,ue);E[E.length-1].x===Ut.x&&E[E.length-1].y===Ut.y||E.push(Ut)}return E}function _c(a,e,n){if(e.length===0)throw new Error("Subdivision vertex ring is empty.");let h=0,m=a[2*e[0]];for(let k=1;k<e.length;k++){const P=a[2*e[k]];P<m&&(m=P,h=k)}const y=e.length;let v=h,E=(v+1)%y;for(;;){const k=v-1>=0?v-1:y-1,P=(E+1)%y,z=a[2*e[k]],G=a[2*e[P]],W=a[2*e[v]],K=a[2*e[v]+1],ie=a[2*e[E]+1];let oe=!1;if(z<G)oe=!0;else if(z>G)oe=!1;else{const ue=ie-K,be=-(a[2*e[E]]-W),We=K<ie?1:-1;((z-W)*ue+(a[2*e[k]+1]-K)*be)*We>((G-W)*ue+(a[2*e[P]+1]-K)*be)*We&&(oe=!0)}if(oe){const ue=e[k],be=e[v],We=e[E];ue!==be&&ue!==We&&be!==We&&n.push(We,be,ue),v--,v<0&&(v=y-1)}else{const ue=e[P],be=e[v],We=e[E];ue!==be&&ue!==We&&be!==We&&n.push(We,be,ue),E++,E>=y&&(E=0)}if(k===P)break}}function xm(a,e,n,h,m,y,v,E,k){const P=m.length/2,z=v&&E&&k;if(P<br.MAX_VERTEX_ARRAY_LENGTH){const G=e.prepareSegment(P,n,h),W=G.vertexLength;for(let oe=0;oe<y.length;oe+=3)h.emplaceBack(W+y[oe],W+y[oe+1],W+y[oe+2]);let K,ie;G.vertexLength+=P,G.primitiveLength+=y.length/3,z&&(ie=v.prepareSegment(P,n,E),K=ie.vertexLength,ie.vertexLength+=P);for(let oe=0;oe<m.length;oe+=2)a(m[oe],m[oe+1]);if(z)for(let oe=0;oe<k.length;oe++){const ue=k[oe];for(let be=1;be<ue.length;be+=2)E.emplaceBack(K+ue[be-1],K+ue[be]);ie.primitiveLength+=ue.length/2}}else(function(G,W,K,ie,oe,ue){const be=[];for(let at=0;at<ie.length/2;at++)be.push(-1);const We={count:0};let Se=0,De=G.getOrCreateLatestSegment(W,K),Je=De.vertexLength;for(let at=2;at<oe.length;at+=3){const St=oe[at-2],Xt=oe[at-1],Ut=oe[at];let rr=be[St]<Se,wr=be[Xt]<Se,ar=be[Ut]<Se;De.vertexLength+((rr?1:0)+(wr?1:0)+(ar?1:0))>br.MAX_VERTEX_ARRAY_LENGTH&&(De=G.createNewSegment(W,K),Se=We.count,rr=!0,wr=!0,ar=!0,Je=0);const Zt=Kc(be,ie,ue,We,St,rr,De),Ft=Kc(be,ie,ue,We,Xt,wr,De),Ir=Kc(be,ie,ue,We,Ut,ar,De);K.emplaceBack(Je+Zt-Se,Je+Ft-Se,Je+Ir-Se),De.primitiveLength++}})(e,n,h,m,y,a),z&&(function(G,W,K,ie,oe,ue){const be=[];for(let at=0;at<ie.length/2;at++)be.push(-1);const We={count:0};let Se=0,De=G.getOrCreateLatestSegment(W,K),Je=De.vertexLength;for(let at=0;at<oe.length;at++){const St=oe[at];for(let Xt=1;Xt<oe[at].length;Xt+=2){const Ut=St[Xt-1],rr=St[Xt];let wr=be[Ut]<Se,ar=be[rr]<Se;De.vertexLength+((wr?1:0)+(ar?1:0))>br.MAX_VERTEX_ARRAY_LENGTH&&(De=G.createNewSegment(W,K),Se=We.count,wr=!0,ar=!0,Je=0);const Zt=Kc(be,ie,ue,We,Ut,wr,De),Ft=Kc(be,ie,ue,We,rr,ar,De);K.emplaceBack(Je+Zt-Se,Je+Ft-Se),De.primitiveLength++}}})(v,n,E,m,k,a),e.forceNewSegmentOnNextPrepare(),v?.forceNewSegmentOnNextPrepare()}function Kc(a,e,n,h,m,y,v){if(y){const E=h.count;return n(e[2*m],e[2*m+1]),a[m]=h.count,h.count++,v.vertexLength++,E}return a[m]}class hf{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((n=>n.id)),this.index=e.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new ze,this.indexArray=new Ct,this.indexArray2=new ur,this.programConfigurations=new Zc(e.layers,e.zoom),this.segments=new br,this.segments2=new br,this.stateDependentLayerIds=this.layers.filter((n=>n.isStateDependent())).map((n=>n.id))}populate(e,n,h){this.hasDependencies=ml("fill",this.layers,n);const m=this.layers[0].layout.get("fill-sort-key"),y=!m.isConstant(),v=[];for(const{feature:E,id:k,index:P,sourceLayerIndex:z}of e){const G=this.layers[0]._featureFilter.needGeometry,W=pl(E,G);if(!this.layers[0]._featureFilter.filter(new Qn(this.zoom),W,h))continue;const K=y?m.evaluate(W,{},h,n.availableImages):void 0,ie={id:k,properties:E.properties,type:E.type,sourceLayerIndex:z,index:P,geometry:G?W.geometry:mc(E),patterns:{},sortKey:K};v.push(ie)}y&&v.sort(((E,k)=>E.sortKey-k.sortKey));for(const E of v){const{geometry:k,index:P,sourceLayerIndex:z}=E;if(this.hasDependencies){const G=Wp("fill",this.layers,E,{zoom:this.zoom},n);this.patternFeatures.push(G)}else this.addFeature(E,k,P,h,{},n.subdivisionGranularity);n.featureIndex.insert(e[P].feature,k,P,z,this.index)}}update(e,n,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,{imagePositions:h})}addFeatures(e,n,h){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,n,h,e.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Od),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,n,h,m,y,v){for(const E of zc(n,500)){const k=Kp(E,m,v.fill.getGranularityForZoomLevel(m.z)),P=this.layoutVertexArray;xm(((z,G)=>{P.emplaceBack(z,G)}),this.segments,this.layoutVertexArray,this.indexArray,k.verticesFlattened,k.indicesTriangles,this.segments2,this.indexArray2,k.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,h,{imagePositions:y,canonical:m})}}let $f,ff;Cr("FillBucket",hf,{omit:["layers","patternFeatures"]});var o_={get paint(){return ff=ff||new ni({"fill-antialias":new Rr(ht.paint_fill["fill-antialias"]),"fill-opacity":new jr(ht.paint_fill["fill-opacity"]),"fill-color":new jr(ht.paint_fill["fill-color"]),"fill-outline-color":new jr(ht.paint_fill["fill-outline-color"]),"fill-translate":new Rr(ht.paint_fill["fill-translate"]),"fill-translate-anchor":new Rr(ht.paint_fill["fill-translate-anchor"]),"fill-pattern":new Co(ht.paint_fill["fill-pattern"])})},get layout(){return $f=$f||new ni({"fill-sort-key":new jr(ht.layout_fill["fill-sort-key"])})}};class l_ extends Va{constructor(e,n){super(e,o_,n)}recalculate(e,n){super.recalculate(e,n);const h=this.paint._values["fill-outline-color"];h.value.kind==="constant"&&h.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new hf(e)}queryRadius(){return Dd(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:e,geometry:n,transform:h,pixelsToTileUnits:m}){return Op(Np(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-h.bearingInRadians,m),n)}isTileClipped(){return!0}}const Gd=Fa([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),c_=Fa([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Jp}=Gd;class Xf{constructor(e,n,h,m,y){this.properties={},this.extent=h,this.type=0,this.id=void 0,this._pbf=e,this._geometry=-1,this._keys=m,this._values=y,e.readFields(Hx,this,n)}loadGeometry(){const e=this._pbf;e.pos=this._geometry;const n=e.readVarint()+e.pos,h=[];let m,y=1,v=0,E=0,k=0;for(;e.pos<n;){if(v<=0){const P=e.readVarint();y=7&P,v=P>>3}if(v--,y===1||y===2)E+=e.readSVarint(),k+=e.readSVarint(),y===1&&(m&&h.push(m),m=[]),m&&m.push(new C(E,k));else{if(y!==7)throw new Error(`unknown command ${y}`);m&&m.push(m[0].clone())}}return m&&h.push(m),h}bbox(){const e=this._pbf;e.pos=this._geometry;const n=e.readVarint()+e.pos;let h=1,m=0,y=0,v=0,E=1/0,k=-1/0,P=1/0,z=-1/0;for(;e.pos<n;){if(m<=0){const G=e.readVarint();h=7&G,m=G>>3}if(m--,h===1||h===2)y+=e.readSVarint(),v+=e.readSVarint(),y<E&&(E=y),y>k&&(k=y),v<P&&(P=v),v>z&&(z=v);else if(h!==7)throw new Error(`unknown command ${h}`)}return[E,P,k,z]}toGeoJSON(e,n,h){const m=this.extent*Math.pow(2,h),y=this.extent*e,v=this.extent*n,E=this.loadGeometry();function k(W){return[360*(W.x+y)/m-180,360/Math.PI*Math.atan(Math.exp((1-2*(W.y+v)/m)*Math.PI))-90]}function P(W){return W.map(k)}let z;if(this.type===1){const W=[];for(const ie of E)W.push(ie[0]);const K=P(W);z=W.length===1?{type:"Point",coordinates:K[0]}:{type:"MultiPoint",coordinates:K}}else if(this.type===2){const W=E.map(P);z=W.length===1?{type:"LineString",coordinates:W[0]}:{type:"MultiLineString",coordinates:W}}else{if(this.type!==3)throw new Error("unknown feature type");{const W=u_(E),K=[];for(const ie of W)K.push(ie.map(P));z=K.length===1?{type:"Polygon",coordinates:K[0]}:{type:"MultiPolygon",coordinates:K}}}const G={type:"Feature",geometry:z,properties:this.properties};return this.id!=null&&(G.id=this.id),G}}function Hx(a,e,n){a===1?e.id=n.readVarint():a===2?(function(h,m){const y=h.readVarint()+h.pos;for(;h.pos<y;){const v=m._keys[h.readVarint()],E=m._values[h.readVarint()];m.properties[v]=E}})(n,e):a===3?e.type=n.readVarint():a===4&&(e._geometry=n.pos)}function u_(a){const e=a.length;if(e<=1)return[a];const n=[];let h,m;for(let y=0;y<e;y++){const v=ma(a[y]);v!==0&&(m===void 0&&(m=v<0),m===v<0?(h&&n.push(h),h=[a[y]]):h&&h.push(a[y]))}return h&&n.push(h),n}function ma(a){let e=0;for(let n,h,m=0,y=a.length,v=y-1;m<y;v=m++)n=a[m],h=a[v],e+=(h.x-n.x)*(n.y+h.y);return e}Xf.types=["Unknown","Point","LineString","Polygon"];class za{constructor(e,n){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Nn,this,n),this.length=this._features.length}feature(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];const n=this._pbf.readVarint()+this._pbf.pos;return new Xf(this._pbf,n,this.extent,this._keys,this._values)}}function Nn(a,e,n){a===15?e.version=n.readVarint():a===1?e.name=n.readString():a===5?e.extent=n.readVarint():a===2?e._features.push(n.pos):a===3?e._keys.push(n.readString()):a===4&&e._values.push((function(h){let m=null;const y=h.readVarint()+h.pos;for(;h.pos<y;){const v=h.readVarint()>>3;m=v===1?h.readString():v===2?h.readFloat():v===3?h.readDouble():v===4?h.readVarint64():v===5?h.readVarint():v===6?h.readSVarint():v===7?h.readBoolean():null}if(m==null)throw new Error("unknown feature value");return m})(n))}class jn{constructor(e,n){this.layers=e.readFields(Ta,{},n)}}function Ta(a,e,n){if(a===3){const h=new za(n,n.readVarint()+n.pos);h.length&&(e[h.name]=h)}}const lo=Math.pow(2,13);function Vl(a,e,n,h,m,y,v,E){a.emplaceBack(e,n,2*Math.floor(h*lo)+v,m*lo*2,y*lo*2,Math.round(E))}class wh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((n=>n.id)),this.index=e.index,this.hasDependencies=!1,this.layoutVertexArray=new Ze,this.centroidVertexArray=new Ie,this.indexArray=new Ct,this.programConfigurations=new Zc(e.layers,e.zoom),this.segments=new br,this.stateDependentLayerIds=this.layers.filter((n=>n.isStateDependent())).map((n=>n.id))}populate(e,n,h){this.features=[],this.hasDependencies=ml("fill-extrusion",this.layers,n);for(const{feature:m,id:y,index:v,sourceLayerIndex:E}of e){const k=this.layers[0]._featureFilter.needGeometry,P=pl(m,k);if(!this.layers[0]._featureFilter.filter(new Qn(this.zoom),P,h))continue;const z={id:y,sourceLayerIndex:E,index:v,geometry:k?P.geometry:mc(m),properties:m.properties,type:m.type,patterns:{}};this.hasDependencies?this.features.push(Wp("fill-extrusion",this.layers,z,{zoom:this.zoom},n)):this.addFeature(z,z.geometry,v,h,{},n.subdivisionGranularity),n.featureIndex.insert(m,z.geometry,v,E,this.index,!0)}}addFeatures(e,n,h){for(const m of this.features){const{geometry:y}=m;this.addFeature(m,y,m.index,n,h,e.subdivisionGranularity)}}update(e,n,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,{imagePositions:h})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Jp),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,c_.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,n,h,m,y,v){for(const E of zc(n,500)){const k={x:0,y:0,sampleCount:0},P=this.layoutVertexArray.length;this.processPolygon(k,m,e,E,v);const z=this.layoutVertexArray.length-P,G=Math.floor(k.x/k.sampleCount),W=Math.floor(k.y/k.sampleCount);for(let K=0;K<z;K++)this.centroidVertexArray.emplaceBack(G,W)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,h,{imagePositions:y,canonical:m})}processPolygon(e,n,h,m,y){if(m.length<1||ui(m[0]))return;for(const G of m)G.length!==0&&ym(e,G);const v={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},E=y.fill.getGranularityForZoomLevel(n.z),k=Xf.types[h.type]==="Polygon";for(const G of m){if(G.length===0||ui(G))continue;const W=Ou(G,E,k);this._generateSideFaces(W,v)}if(!k)return;const P=Kp(m,n,E,!1),z=this.layoutVertexArray;xm(((G,W)=>{Vl(z,G,W,0,0,1,1,0)}),this.segments,this.layoutVertexArray,this.indexArray,P.verticesFlattened,P.indicesTriangles)}_generateSideFaces(e,n){let h=0;for(let m=1;m<e.length;m++){const y=e[m],v=e[m-1];if(Bu(y,v))continue;n.segment.vertexLength+4>br.MAX_VERTEX_ARRAY_LENGTH&&(n.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const E=y.sub(v)._perp()._unit(),k=v.dist(y);h+k>32768&&(h=0),Vl(this.layoutVertexArray,y.x,y.y,E.x,E.y,0,0,h),Vl(this.layoutVertexArray,y.x,y.y,E.x,E.y,0,1,h),h+=k,Vl(this.layoutVertexArray,v.x,v.y,E.x,E.y,0,0,h),Vl(this.layoutVertexArray,v.x,v.y,E.x,E.y,0,1,h);const P=n.segment.vertexLength;this.indexArray.emplaceBack(P,P+2,P+1),this.indexArray.emplaceBack(P+1,P+2,P+3),n.segment.vertexLength+=4,n.segment.primitiveLength+=2}}}function ym(a,e){for(let n=0;n<e.length;n++){const h=e[n];n===e.length-1&&e[0].x===h.x&&e[0].y===h.y||(a.x+=h.x,a.y+=h.y,a.sampleCount++)}}function Bu(a,e){return a.x===e.x&&(a.x<0||a.x>Oe)||a.y===e.y&&(a.y<0||a.y>Oe)}function ui(a){return a.every((e=>e.x<0))||a.every((e=>e.x>Oe))||a.every((e=>e.y<0))||a.every((e=>e.y>Oe))}let Nu;Cr("FillExtrusionBucket",wh,{omit:["layers","features"]});var df={get paint(){return Nu=Nu||new ni({"fill-extrusion-opacity":new Rr(ht["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new jr(ht["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Rr(ht["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Rr(ht["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Co(ht["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new jr(ht["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new jr(ht["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Rr(ht["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class vm extends Va{constructor(e,n){super(e,df,n)}createBucket(e){return new wh(e)}queryRadius(){return Dd(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:e,feature:n,featureState:h,geometry:m,transform:y,pixelsToTileUnits:v,pixelPosMatrix:E}){const k=Np(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-y.bearingInRadians,v),P=this.paint.get("fill-extrusion-height").evaluate(n,h),z=this.paint.get("fill-extrusion-base").evaluate(n,h),G=(function(K,ie){const oe=[];for(const ue of K){const be=[ue.x,ue.y,0,1];le(be,be,ie),oe.push(new C(be[0]/be[3],be[1]/be[3]))}return oe})(k,E),W=(function(K,ie,oe,ue){const be=[],We=[],Se=ue[8]*ie,De=ue[9]*ie,Je=ue[10]*ie,at=ue[11]*ie,St=ue[8]*oe,Xt=ue[9]*oe,Ut=ue[10]*oe,rr=ue[11]*oe;for(const wr of K){const ar=[],Zt=[];for(const Ft of wr){const Ir=Ft.x,Mr=Ft.y,Lr=ue[0]*Ir+ue[4]*Mr+ue[12],Ar=ue[1]*Ir+ue[5]*Mr+ue[13],Yr=ue[2]*Ir+ue[6]*Mr+ue[14],Gn=ue[3]*Ir+ue[7]*Mr+ue[15],Rn=Yr+Je,Ja=Gn+at,$s=Lr+St,Wi=Ar+Xt,Qa=Yr+Ut,Ha=Gn+rr,oa=new C((Lr+Se)/Ja,(Ar+De)/Ja);oa.z=Rn/Ja,ar.push(oa);const hi=new C($s/Ha,Wi/Ha);hi.z=Qa/Ha,Zt.push(hi)}be.push(ar),We.push(Zt)}return[be,We]})(m,z,P,E);return(function(K,ie,oe){let ue=1/0;Op(oe,ie)&&(ue=pf(oe,ie[0]));for(let be=0;be<ie.length;be++){const We=ie[be],Se=K[be];for(let De=0;De<We.length-1;De++){const Je=We[De],at=[Je,We[De+1],Se[De+1],Se[De],Je];cf(oe,at)&&(ue=Math.min(ue,pf(oe,at)))}}return ue!==1/0&&ue})(W[0],W[1],G)}}function Ds(a,e){return a.x*e.x+a.y*e.y}function pf(a,e){if(a.length===1){let n=0;const h=e[n++];let m;for(;!m||h.equals(m);)if(m=e[n++],!m)return 1/0;for(;n<e.length;n++){const y=e[n],v=a[0],E=m.sub(h),k=y.sub(h),P=v.sub(h),z=Ds(E,E),G=Ds(E,k),W=Ds(k,k),K=Ds(P,E),ie=Ds(P,k),oe=z*W-G*G,ue=(W*K-G*ie)/oe,be=(z*ie-G*K)/oe,We=h.z*(1-ue-be)+m.z*ue+y.z*be;if(isFinite(We))return We}return 1/0}{let n=1/0;for(const h of e)n=Math.min(n,h.z);return n}}const Hd=Fa([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Fo}=Hd,bm=Fa([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Qp}=bm,h_=Math.cos(Math.PI/180*37.5),qd=Math.pow(2,14)/.5;class Yf{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((n=>n.id)),this.index=e.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((n=>{this.gradients[n.id]={}})),this.layoutVertexArray=new rt,this.layoutVertexArray2=new qe,this.indexArray=new Ct,this.programConfigurations=new Zc(e.layers,e.zoom),this.segments=new br,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((n=>n.isStateDependent())).map((n=>n.id))}populate(e,n,h){this.hasDependencies=ml("line",this.layers,n)||this.hasLineDasharray(this.layers);const m=this.layers[0].layout.get("line-sort-key"),y=!m.isConstant(),v=[];for(const{feature:E,id:k,index:P,sourceLayerIndex:z}of e){const G=this.layers[0]._featureFilter.needGeometry,W=pl(E,G);if(!this.layers[0]._featureFilter.filter(new Qn(this.zoom),W,h))continue;const K=y?m.evaluate(W,{},h):void 0,ie={id:k,properties:E.properties,type:E.type,sourceLayerIndex:z,index:P,geometry:G?W.geometry:mc(E),patterns:{},dashes:{},sortKey:K};v.push(ie)}y&&v.sort(((E,k)=>E.sortKey-k.sortKey));for(const E of v){const{geometry:k,index:P,sourceLayerIndex:z}=E;this.hasDependencies?(ml("line",this.layers,n)?Wp("line",this.layers,E,{zoom:this.zoom},n):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,E,this.zoom,n),this.patternFeatures.push(E)):this.addFeature(E,k,P,h,{},{},n.subdivisionGranularity),n.featureIndex.insert(e[P].feature,k,P,z,this.index)}}update(e,n,h,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,{imagePositions:h,dashPositions:m})}addFeatures(e,n,h,m){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,n,h,m,e.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Qp)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Fo),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,n,h,m,y,v,E){const k=this.layers[0].layout,P=k.get("line-join").evaluate(e,{}),z=k.get("line-cap"),G=k.get("line-miter-limit"),W=k.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const K of n)this.addLine(K,e,P,z,G,W,m,E);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,h,{imagePositions:y,dashPositions:v,canonical:m})}addLine(e,n,h,m,y,v,E,k){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,e=Ou(e,E?k.line.getGranularityForZoomLevel(E.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Se=0;Se<e.length-1;Se++)this.totalDistance+=e[Se].dist(e[Se+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const P=Xf.types[n.type]==="Polygon";let z=e.length;for(;z>=2&&e[z-1].equals(e[z-2]);)z--;let G=0;for(;G<z-1&&e[G].equals(e[G+1]);)G++;if(z<(P?3:2))return;h==="bevel"&&(y=1.05);const W=this.overscaling<=16?122880/(512*this.overscaling):0,K=this.segments.prepareSegment(10*z,this.layoutVertexArray,this.indexArray);let ie,oe,ue,be,We;this.e1=this.e2=-1,P&&(ie=e[z-2],We=e[G].sub(ie)._unit()._perp());for(let Se=G;Se<z;Se++){if(ue=Se===z-1?P?e[G+1]:void 0:e[Se+1],ue&&e[Se].equals(ue))continue;We&&(be=We),ie&&(oe=ie),ie=e[Se],We=ue?ue.sub(ie)._unit()._perp():be,be=be||We;let De=be.add(We);De.x===0&&De.y===0||De._unit();const Je=be.x*We.x+be.y*We.y,at=De.x*We.x+De.y*We.y,St=at!==0?1/at:1/0,Xt=2*Math.sqrt(2-2*at),Ut=at<h_&&oe&&ue,rr=be.x*We.y-be.y*We.x>0;if(Ut&&Se>G){const Zt=ie.dist(oe);if(Zt>2*W){const Ft=ie.sub(ie.sub(oe)._mult(W/Zt)._round());this.updateDistance(oe,Ft),this.addCurrentVertex(Ft,be,0,0,K),oe=Ft}}const wr=oe&&ue;let ar=wr?h:P?"butt":m;if(wr&&ar==="round"&&(St<v?ar="miter":St<=2&&(ar="fakeround")),ar==="miter"&&St>y&&(ar="bevel"),ar==="bevel"&&(St>2&&(ar="flipbevel"),St<y&&(ar="miter")),oe&&this.updateDistance(oe,ie),ar==="miter")De._mult(St),this.addCurrentVertex(ie,De,0,0,K);else if(ar==="flipbevel"){if(St>100)De=We.mult(-1);else{const Zt=St*be.add(We).mag()/be.sub(We).mag();De._perp()._mult(Zt*(rr?-1:1))}this.addCurrentVertex(ie,De,0,0,K),this.addCurrentVertex(ie,De.mult(-1),0,0,K)}else if(ar==="bevel"||ar==="fakeround"){const Zt=-Math.sqrt(St*St-1),Ft=rr?Zt:0,Ir=rr?0:Zt;if(oe&&this.addCurrentVertex(ie,be,Ft,Ir,K),ar==="fakeround"){const Mr=Math.round(180*Xt/Math.PI/20);for(let Lr=1;Lr<Mr;Lr++){let Ar=Lr/Mr;if(Ar!==.5){const Gn=Ar-.5;Ar+=Ar*Gn*(Ar-1)*((1.0904+Je*(Je*(3.55645-1.43519*Je)-3.2452))*Gn*Gn+(.848013+Je*(.215638*Je-1.06021)))}const Yr=We.sub(be)._mult(Ar)._add(be)._unit()._mult(rr?-1:1);this.addHalfVertex(ie,Yr.x,Yr.y,!1,rr,0,K)}}ue&&this.addCurrentVertex(ie,We,-Ft,-Ir,K)}else if(ar==="butt")this.addCurrentVertex(ie,De,0,0,K);else if(ar==="square"){const Zt=oe?1:-1;this.addCurrentVertex(ie,De,Zt,Zt,K)}else ar==="round"&&(oe&&(this.addCurrentVertex(ie,be,0,0,K),this.addCurrentVertex(ie,be,1,1,K,!0)),ue&&(this.addCurrentVertex(ie,We,-1,-1,K,!0),this.addCurrentVertex(ie,We,0,0,K)));if(Ut&&Se<z-1){const Zt=ie.dist(ue);if(Zt>2*W){const Ft=ie.add(ue.sub(ie)._mult(W/Zt)._round());this.updateDistance(ie,Ft),this.addCurrentVertex(Ft,We,0,0,K),ie=Ft}}}}addCurrentVertex(e,n,h,m,y,v=!1){const E=n.y*m-n.x,k=-n.y-n.x*m;this.addHalfVertex(e,n.x+n.y*h,n.y-n.x*h,v,!1,h,y),this.addHalfVertex(e,E,k,v,!0,-m,y),this.distance>qd/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,n,h,m,y,v))}addHalfVertex({x:e,y:n},h,m,y,v,E,k){const P=.5*(this.lineClips?this.scaledDistance*(qd-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(y?1:0),(n<<1)+(v?1:0),Math.round(63*h)+128,Math.round(63*m)+128,1+(E===0?0:E<0?-1:1)|(63&P)<<2,P>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const z=k.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,z,this.e2),k.primitiveLength++),v?this.e2=z:this.e1=z}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,n){this.distance+=e.dist(n),this.updateScaledDistance()}hasLineDasharray(e){for(const n of e){const h=n.paint.get("line-dasharray");if(h&&!h.isConstant())return!0}return!1}addLineDashDependencies(e,n,h,m){for(const y of e){const v=y.paint.get("line-dasharray");if(!v||v.value.kind==="constant")continue;const E=y.layout.get("line-cap")==="round",k={dasharray:v.value.evaluate({zoom:h-1},n,{}),round:E},P={dasharray:v.value.evaluate({zoom:h},n,{}),round:E},z={dasharray:v.value.evaluate({zoom:h+1},n,{}),round:E},G=`${k.dasharray.join(",")},${k.round}`,W=`${P.dasharray.join(",")},${P.round}`,K=`${z.dasharray.join(",")},${z.round}`;m.dashDependencies[G]=k,m.dashDependencies[W]=P,m.dashDependencies[K]=z,n.dashes[y.id]={min:G,mid:W,max:K}}}}let ju,Hi;Cr("LineBucket",Yf,{omit:["layers","patternFeatures"]});var Uu={get paint(){return Hi=Hi||new ni({"line-opacity":new jr(ht.paint_line["line-opacity"]),"line-color":new jr(ht.paint_line["line-color"]),"line-translate":new Rr(ht.paint_line["line-translate"]),"line-translate-anchor":new Rr(ht.paint_line["line-translate-anchor"]),"line-width":new jr(ht.paint_line["line-width"]),"line-gap-width":new jr(ht.paint_line["line-gap-width"]),"line-offset":new jr(ht.paint_line["line-offset"]),"line-blur":new jr(ht.paint_line["line-blur"]),"line-dasharray":new Co(ht.paint_line["line-dasharray"]),"line-pattern":new Co(ht.paint_line["line-pattern"]),"line-gradient":new tf(ht.paint_line["line-gradient"])})},get layout(){return ju=ju||new ni({"line-cap":new Rr(ht.layout_line["line-cap"]),"line-join":new jr(ht.layout_line["line-join"]),"line-miter-limit":new Rr(ht.layout_line["line-miter-limit"]),"line-round-limit":new Rr(ht.layout_line["line-round-limit"]),"line-sort-key":new jr(ht.layout_line["line-sort-key"])})}};class Kf extends jr{possiblyEvaluate(e,n){return n=new Qn(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,zoomHistory:n.zoomHistory,transition:n.transition}),super.possiblyEvaluate(e,n)}evaluate(e,n,h,m){return n=Vt({},n,{zoom:Math.floor(n.zoom)}),super.evaluate(e,n,h,m)}}let Gl;class wm extends Va{constructor(e,n){super(e,Uu,n),this.gradientVersion=0,Gl||(Gl=new Kf(Uu.paint.properties["line-width"].specification),Gl.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if(e==="line-gradient"){const n=this.gradientExpression();this.stepInterpolant=!!(function(h){return h._styleExpression!==void 0})(n)&&n._styleExpression.expression instanceof cs,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,n){super.recalculate(e,n),this.paint._values["line-floorwidth"]=Gl.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new Yf(e)}queryRadius(e){const n=e,h=e0(Pu("line-width",this,n),Pu("line-gap-width",this,n)),m=Pu("line-offset",this,n);return h/2+Math.abs(m)+Dd(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:e,feature:n,featureState:h,geometry:m,transform:y,pixelsToTileUnits:v}){const E=Np(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-y.bearingInRadians,v),k=v/2*e0(this.paint.get("line-width").evaluate(n,h),this.paint.get("line-gap-width").evaluate(n,h)),P=this.paint.get("line-offset").evaluate(n,h);return P&&(m=(function(z,G){const W=[];for(let K=0;K<z.length;K++){const ie=jp(z[K]),oe=[];for(let ue=0;ue<ie.length;ue++){const be=ie[ue],We=ie[ue-1],Se=ie[ue+1],De=ue===0?new C(0,0):be.sub(We)._unit()._perp(),Je=ue===ie.length-1?new C(0,0):Se.sub(be)._unit()._perp(),at=De._add(Je)._unit(),St=at.x*Je.x+at.y*Je.y;St!==0&&at._mult(1/St),oe.push(at._mult(G)._add(be))}W.push(oe)}return W})(m,P*v)),(function(z,G,W){for(let K=0;K<G.length;K++){const ie=G[K];if(z.length>=3){for(let oe=0;oe<ie.length;oe++)if($c(z,ie[oe]))return!0}if(Ui(z,ie,W))return!0}return!1})(E,m,k)}isTileClipped(){return!0}}function e0(a,e){return e>0?e+2*a:a}const f_=Fa([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Zd=Fa([{name:"a_projected_pos",components:3,type:"Float32"}],4);Fa([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Tm=Fa([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Fa([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Lo=Fa([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),d_=Fa([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function zo(a,e,n){return a.sections.forEach((h=>{h.text=(function(m,y,v){const E=y.layout.get("text-transform").evaluate(v,{});return E==="uppercase"?m=m.toLocaleUpperCase():E==="lowercase"&&(m=m.toLocaleLowerCase()),ko.applyArabicShaping&&(m=ko.applyArabicShaping(m)),m})(h.text,e,n)})),a}Fa([{name:"triangle",components:3,type:"Uint16"}]),Fa([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Fa([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Fa([{type:"Float32",name:"offsetX"}]),Fa([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Fa([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);var ki=24;const Jf={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},qx={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Th={40:!0};function Wd(a,e,n,h,m,y){if("fontStack"in e){const v=n[e.fontStack],E=v&&v[a];return E?E.metrics.advance*e.scale+m:0}{const v=h[e.imageName];return v?v.displaySize[0]*e.scale*ki/y+m:0}}function t0(a,e,n,h){const m=Math.pow(a-e,2);return h?a<e?m/2:2*m:m+Math.abs(n)*n}function Qf(a,e,n){let h=0;return a===10&&(h-=1e4),n&&(h+=150),a!==40&&a!==65288||(h+=50),e!==41&&e!==65289||(h+=50),h}function Sm(a,e,n,h,m,y){let v=null,E=t0(e,n,m,y);for(const k of h){const P=t0(e-k.x,n,m,y)+k.badness;P<=E&&(v=k,E=P)}return{index:a,x:e,priorBreak:v,badness:E}}function Em(a){return a?Em(a.priorBreak).concat(a.index):[]}class mf{constructor(e="",n=[],h=[]){this.text=e,this.sections=n,this.sectionIndex=h,this.imageSectionID=null}static fromFeature(e,n){const h=new mf;for(let m=0;m<e.sections.length;m++){const y=e.sections[m];y.image?h.addImageSection(y):h.addTextSection(y,n)}return h}length(){return[...this.text].length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}verticalizePunctuation(){this.text=(function(e){let n="",h={premature:!0,value:void 0};const m=e[Symbol.iterator]();let y=m.next();const v=e[Symbol.iterator]();v.next();let E=v.next();for(;!y.done;)n+=!E.done&&Ol(E.value.codePointAt(0))&&!Jf[E.value]||!h.premature&&Ol(h.value.codePointAt(0))&&!Jf[h.value]||!Jf[y.value]?y.value:Jf[y.value],h={value:y.value,premature:!1},y=m.next(),E=v.next();return n})(this.text)}hasZeroWidthSpaces(){return this.text.includes("")}trim(){const e=this.text.match(/^\s*/),n=e?e[0].length:0,h=this.text.match(/\S\s*$/),m=h?h[0].length-1:0;this.text=this.text.substring(n,this.text.length-m),this.sectionIndex=this.sectionIndex.slice(n,this.sectionIndex.length-m)}substring(e,n){const h=[...this.text].slice(e,n).join(""),m=this.sectionIndex.slice(e,n);return new mf(h,this.sections,m)}toCodeUnitIndex(e){return[...this.text].slice(0,e).join("").length}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((e,n)=>Math.max(e,this.sections[n].scale)),0)}getMaxImageSize(e){let n=0,h=0;for(let m=0;m<this.length();m++){const y=this.getSection(m);if("imageName"in y){const v=e[y.imageName];if(!v)continue;const E=v.displaySize;n=Math.max(n,E[0]),h=Math.max(h,E[1])}}return{maxImageWidth:n,maxImageHeight:h}}addTextSection(e,n){this.text+=e.text,this.sections.push({scale:e.scale||1,verticalAlign:e.verticalAlign||"bottom",fontStack:e.fontStack||n});const h=this.sections.length-1;this.sectionIndex.push(...[...e.text].map((()=>h)))}addImageSection(e){const n=e.image?e.image.name:"";if(n.length===0)return void se("Can't add FormattedSection with an empty image.");const h=this.getNextImageSectionCharCode();h?(this.text+=String.fromCharCode(h),this.sections.push({scale:1,verticalAlign:e.verticalAlign||"bottom",imageName:n}),this.sectionIndex.push(this.sections.length-1)):se("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}determineLineBreaks(e,n,h,m,y){const v=[],E=this.determineAverageLineWidth(e,n,h,m,y),k=this.hasZeroWidthSpaces();let P=0,z=0;const G=this.text[Symbol.iterator]();let W=G.next();const K=this.text[Symbol.iterator]();K.next();let ie=K.next();const oe=this.text[Symbol.iterator]();oe.next(),oe.next();let ue=oe.next();for(;!W.done;){const be=this.getSection(z),We=W.value.codePointAt(0);if(Yh(We)||(P+=Wd(We,be,h,m,e,y)),!ie.done){const Se=Fl(We),De=ie.value.codePointAt(0);(qx[We]||Se||"imageName"in be||!ue.done&&Th[De])&&v.push(Sm(z+1,P,E,v,Qf(We,De,Se&&k),!1))}z++,W=G.next(),ie=K.next(),ue=oe.next()}return Em(Sm(this.length(),P,E,v,0,!0))}determineAverageLineWidth(e,n,h,m,y){let v=0,E=0;for(const k of this.text){const P=this.getSection(E);v+=Wd(k.codePointAt(0),P,h,m,e,y),E++}return v/Math.max(1,Math.ceil(v/n))}}const r0=4294967296,$d=1/r0,n0=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class a0{constructor(e=new Uint8Array(16)){this.buf=ArrayBuffer.isView(e)?e:new Uint8Array(e),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(e,n,h=this.length){for(;this.pos<h;){const m=this.readVarint(),y=m>>3,v=this.pos;this.type=7&m,e(y,n,this),this.pos===v&&this.skip(m)}return n}readMessage(e,n){return this.readFields(e,n,this.readVarint()+this.pos)}readFixed32(){const e=this.dataView.getUint32(this.pos,!0);return this.pos+=4,e}readSFixed32(){const e=this.dataView.getInt32(this.pos,!0);return this.pos+=4,e}readFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*r0;return this.pos+=8,e}readSFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*r0;return this.pos+=8,e}readFloat(){const e=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,e}readDouble(){const e=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,e}readVarint(e){const n=this.buf;let h,m;return m=n[this.pos++],h=127&m,m<128?h:(m=n[this.pos++],h|=(127&m)<<7,m<128?h:(m=n[this.pos++],h|=(127&m)<<14,m<128?h:(m=n[this.pos++],h|=(127&m)<<21,m<128?h:(m=n[this.pos],h|=(15&m)<<28,(function(y,v,E){const k=E.buf;let P,z;if(z=k[E.pos++],P=(112&z)>>4,z<128||(z=k[E.pos++],P|=(127&z)<<3,z<128)||(z=k[E.pos++],P|=(127&z)<<10,z<128)||(z=k[E.pos++],P|=(127&z)<<17,z<128)||(z=k[E.pos++],P|=(127&z)<<24,z<128)||(z=k[E.pos++],P|=(1&z)<<31,z<128))return ed(y,P,v);throw new Error("Expected varint not more than 10 bytes")})(h,e,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const e=this.readVarint();return e%2==1?(e+1)/-2:e/2}readBoolean(){return!!this.readVarint()}readString(){const e=this.readVarint()+this.pos,n=this.pos;return this.pos=e,e-n>=12&&n0?n0.decode(this.buf.subarray(n,e)):(function(h,m,y){let v="",E=m;for(;E<y;){const k=h[E];let P,z,G,W=null,K=k>239?4:k>223?3:k>191?2:1;if(E+K>y)break;K===1?k<128&&(W=k):K===2?(P=h[E+1],(192&P)==128&&(W=(31&k)<<6|63&P,W<=127&&(W=null))):K===3?(P=h[E+1],z=h[E+2],(192&P)==128&&(192&z)==128&&(W=(15&k)<<12|(63&P)<<6|63&z,(W<=2047||W>=55296&&W<=57343)&&(W=null))):K===4&&(P=h[E+1],z=h[E+2],G=h[E+3],(192&P)==128&&(192&z)==128&&(192&G)==128&&(W=(15&k)<<18|(63&P)<<12|(63&z)<<6|63&G,(W<=65535||W>=1114112)&&(W=null))),W===null?(W=65533,K=1):W>65535&&(W-=65536,v+=String.fromCharCode(W>>>10&1023|55296),W=56320|1023&W),v+=String.fromCharCode(W),E+=K}return v})(this.buf,n,e)}readBytes(){const e=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,e);return this.pos=e,n}readPackedVarint(e=[],n){const h=this.readPackedEnd();for(;this.pos<h;)e.push(this.readVarint(n));return e}readPackedSVarint(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readSVarint());return e}readPackedBoolean(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readBoolean());return e}readPackedFloat(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readFloat());return e}readPackedDouble(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readDouble());return e}readPackedFixed32(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readFixed32());return e}readPackedSFixed32(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readSFixed32());return e}readPackedFixed64(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readFixed64());return e}readPackedSFixed64(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readSFixed64());return e}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(e){const n=7&e;if(n===0)for(;this.buf[this.pos++]>127;);else if(n===2)this.pos=this.readVarint()+this.pos;else if(n===5)this.pos+=4;else{if(n!==1)throw new Error(`Unimplemented type: ${n}`);this.pos+=8}}writeTag(e,n){this.writeVarint(e<<3|n)}realloc(e){let n=this.length||16;for(;n<this.pos+e;)n*=2;if(n!==this.length){const h=new Uint8Array(n);h.set(this.buf),this.buf=h,this.dataView=new DataView(h.buffer),this.length=n}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeSFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,-1&e,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*$d),!0),this.pos+=8}writeSFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,-1&e,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*$d),!0),this.pos+=8}writeVarint(e){(e=+e||0)>268435455||e<0?(function(n,h){let m,y;if(n>=0?(m=n%4294967296|0,y=n/4294967296|0):(m=~(-n%4294967296),y=~(-n/4294967296),4294967295^m?m=m+1|0:(m=0,y=y+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");h.realloc(10),(function(v,E,k){k.buf[k.pos++]=127&v|128,v>>>=7,k.buf[k.pos++]=127&v|128,v>>>=7,k.buf[k.pos++]=127&v|128,v>>>=7,k.buf[k.pos++]=127&v|128,k.buf[k.pos]=127&(v>>>=7)})(m,0,h),(function(v,E){const k=(7&v)<<4;E.buf[E.pos++]|=k|((v>>>=3)?128:0),v&&(E.buf[E.pos++]=127&v|((v>>>=7)?128:0),v&&(E.buf[E.pos++]=127&v|((v>>>=7)?128:0),v&&(E.buf[E.pos++]=127&v|((v>>>=7)?128:0),v&&(E.buf[E.pos++]=127&v|((v>>>=7)?128:0),v&&(E.buf[E.pos++]=127&v)))))})(y,h)})(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))}writeSVarint(e){this.writeVarint(e<0?2*-e-1:2*e)}writeBoolean(e){this.writeVarint(+e)}writeString(e){e=String(e),this.realloc(4*e.length),this.pos++;const n=this.pos;this.pos=(function(m,y,v){for(let E,k,P=0;P<y.length;P++){if(E=y.charCodeAt(P),E>55295&&E<57344){if(!k){E>56319||P+1===y.length?(m[v++]=239,m[v++]=191,m[v++]=189):k=E;continue}if(E<56320){m[v++]=239,m[v++]=191,m[v++]=189,k=E;continue}E=k-55296<<10|E-56320|65536,k=null}else k&&(m[v++]=239,m[v++]=191,m[v++]=189,k=null);E<128?m[v++]=E:(E<2048?m[v++]=E>>6|192:(E<65536?m[v++]=E>>12|224:(m[v++]=E>>18|240,m[v++]=E>>12&63|128),m[v++]=E>>6&63|128),m[v++]=63&E|128)}return v})(this.buf,e,this.pos);const h=this.pos-n;h>=128&&p_(n,h,this),this.pos=n-1,this.writeVarint(h),this.pos+=h}writeFloat(e){this.realloc(4),this.dataView.setFloat32(this.pos,e,!0),this.pos+=4}writeDouble(e){this.realloc(8),this.dataView.setFloat64(this.pos,e,!0),this.pos+=8}writeBytes(e){const n=e.length;this.writeVarint(n),this.realloc(n);for(let h=0;h<n;h++)this.buf[this.pos++]=e[h]}writeRawMessage(e,n){this.pos++;const h=this.pos;e(n,this);const m=this.pos-h;m>=128&&p_(h,m,this),this.pos=h-1,this.writeVarint(m),this.pos+=m}writeMessage(e,n,h){this.writeTag(e,2),this.writeRawMessage(n,h)}writePackedVarint(e,n){n.length&&this.writeMessage(e,m_,n)}writePackedSVarint(e,n){n.length&&this.writeMessage(e,g_,n)}writePackedBoolean(e,n){n.length&&this.writeMessage(e,__,n)}writePackedFloat(e,n){n.length&&this.writeMessage(e,td,n)}writePackedDouble(e,n){n.length&&this.writeMessage(e,i0,n)}writePackedFixed32(e,n){n.length&&this.writeMessage(e,x_,n)}writePackedSFixed32(e,n){n.length&&this.writeMessage(e,y_,n)}writePackedFixed64(e,n){n.length&&this.writeMessage(e,v_,n)}writePackedSFixed64(e,n){n.length&&this.writeMessage(e,b_,n)}writeBytesField(e,n){this.writeTag(e,2),this.writeBytes(n)}writeFixed32Field(e,n){this.writeTag(e,5),this.writeFixed32(n)}writeSFixed32Field(e,n){this.writeTag(e,5),this.writeSFixed32(n)}writeFixed64Field(e,n){this.writeTag(e,1),this.writeFixed64(n)}writeSFixed64Field(e,n){this.writeTag(e,1),this.writeSFixed64(n)}writeVarintField(e,n){this.writeTag(e,0),this.writeVarint(n)}writeSVarintField(e,n){this.writeTag(e,0),this.writeSVarint(n)}writeStringField(e,n){this.writeTag(e,2),this.writeString(n)}writeFloatField(e,n){this.writeTag(e,5),this.writeFloat(n)}writeDoubleField(e,n){this.writeTag(e,1),this.writeDouble(n)}writeBooleanField(e,n){this.writeVarintField(e,+n)}}function ed(a,e,n){return n?4294967296*e+(a>>>0):4294967296*(e>>>0)+(a>>>0)}function p_(a,e,n){const h=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(h);for(let m=n.pos-1;m>=a;m--)n.buf[m+h]=n.buf[m]}function m_(a,e){for(let n=0;n<a.length;n++)e.writeVarint(a[n])}function g_(a,e){for(let n=0;n<a.length;n++)e.writeSVarint(a[n])}function td(a,e){for(let n=0;n<a.length;n++)e.writeFloat(a[n])}function i0(a,e){for(let n=0;n<a.length;n++)e.writeDouble(a[n])}function __(a,e){for(let n=0;n<a.length;n++)e.writeBoolean(a[n])}function x_(a,e){for(let n=0;n<a.length;n++)e.writeFixed32(a[n])}function y_(a,e){for(let n=0;n<a.length;n++)e.writeSFixed32(a[n])}function v_(a,e){for(let n=0;n<a.length;n++)e.writeFixed64(a[n])}function b_(a,e){for(let n=0;n<a.length;n++)e.writeSFixed64(a[n])}function w_(a,e,n){a===1&&n.readMessage(s0,e)}function s0(a,e,n){if(a===3){const{id:h,bitmap:m,width:y,height:v,left:E,top:k,advance:P}=n.readMessage(T_,{});e.push({id:h,bitmap:new Pd({width:y+6,height:v+6},m),metrics:{width:y,height:v,left:E,top:k,advance:P}})}}function T_(a,e,n){a===1?e.id=n.readVarint():a===2?e.bitmap=n.readBytes():a===3?e.width=n.readVarint():a===4?e.height=n.readVarint():a===5?e.left=n.readSVarint():a===6?e.top=n.readSVarint():a===7&&(e.advance=n.readVarint())}function Am(a){let e=0,n=0;for(const v of a)e+=v.w*v.h,n=Math.max(n,v.w);a.sort(((v,E)=>E.h-v.h));const h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}];let m=0,y=0;for(const v of a)for(let E=h.length-1;E>=0;E--){const k=h[E];if(!(v.w>k.w||v.h>k.h)){if(v.x=k.x,v.y=k.y,y=Math.max(y,v.y+v.h),m=Math.max(m,v.x+v.w),v.w===k.w&&v.h===k.h){const P=h.pop();P&&E<h.length&&(h[E]=P)}else v.h===k.h?(k.x+=v.w,k.w-=v.w):v.w===k.w?(k.y+=v.h,k.h-=v.h):(h.push({x:k.x+v.w,y:k.y,w:k.w-v.w,h:v.h}),k.y+=v.h,k.h-=v.h);break}}return{w:m,h:y,fill:e/(m*y)||0}}class ga{constructor(e,{pixelRatio:n,version:h,stretchX:m,stretchY:y,content:v,textFitWidth:E,textFitHeight:k}){this.paddedRect=e,this.pixelRatio=n,this.stretchX=m,this.stretchY=y,this.content=v,this.version=h,this.textFitWidth=E,this.textFitHeight=k}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class o0{constructor(e,n){const h={},m={};this.haveRenderCallbacks=[];const y=[];this.addImages(e,h,y),this.addImages(n,m,y);const{w:v,h:E}=Am(y),k=new Hs({width:v||1,height:E||1});for(const P in e){const z=e[P],G=h[P].paddedRect;Hs.copy(z.data,k,{x:0,y:0},{x:G.x+1,y:G.y+1},z.data)}for(const P in n){const z=n[P],G=m[P].paddedRect,W=G.x+1,K=G.y+1,ie=z.data.width,oe=z.data.height;Hs.copy(z.data,k,{x:0,y:0},{x:W,y:K},z.data),Hs.copy(z.data,k,{x:0,y:oe-1},{x:W,y:K-1},{width:ie,height:1}),Hs.copy(z.data,k,{x:0,y:0},{x:W,y:K+oe},{width:ie,height:1}),Hs.copy(z.data,k,{x:ie-1,y:0},{x:W-1,y:K},{width:1,height:oe}),Hs.copy(z.data,k,{x:0,y:0},{x:W+ie,y:K},{width:1,height:oe})}this.image=k,this.iconPositions=h,this.patternPositions=m}addImages(e,n,h){for(const m in e){const y=e[m],v={x:0,y:0,w:y.data.width+2,h:y.data.height+2};h.push(v),n[m]=new ga(v,y),y.hasRenderCallback&&this.haveRenderCallbacks.push(m)}}patchUpdatedImages(e,n){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const h in e.updatedImages)this.patchUpdatedImage(this.iconPositions[h],e.getImage(h),n),this.patchUpdatedImage(this.patternPositions[h],e.getImage(h),n)}patchUpdatedImage(e,n,h){if(!e||!n||e.version===n.version)return;e.version=n.version;const[m,y]=e.tl;h.update(n.data,void 0,{x:m,y})}}var Sh;function Xd(a,e,n,h,m,y,v,E,k,P,z,G,W,K,ie){const oe=mf.fromFeature(a,m);let ue;G===_.az.vertical&&oe.verticalizePunctuation();let be=oe.determineLineBreaks(P,y,e,h,K);const{processBidirectionalText:We,processStyledBidirectionalText:Se}=ko;if(We&&oe.sections.length===1){ue=[],be=be.map((St=>oe.toCodeUnitIndex(St)));const at=We(oe.toString(),be);for(const St of at){const Xt=[...St].map((()=>0));ue.push(new mf(St,oe.sections,Xt))}}else if(Se){ue=[],be=be.map((Ut=>oe.toCodeUnitIndex(Ut)));let at=0;const St=[];for(const Ut of oe.text)St.push(...Array(Ut.length).fill(oe.sectionIndex[at])),at++;const Xt=Se(oe.text,St,be);for(const Ut of Xt){const rr=[];let wr="";for(const ar of Ut[0])rr.push(Ut[1][wr.length]),wr+=ar;ue.push(new mf(Ut[0],oe.sections,rr))}}else ue=(function(at,St){const Xt=[];let Ut=0;for(const rr of St)Xt.push(at.substring(Ut,rr)),Ut=rr;return Ut<at.length()&&Xt.push(at.substring(Ut,at.length())),Xt})(oe,be);const De=[],Je={positionedLines:De,text:oe.toString(),top:z[1],bottom:z[1],left:z[0],right:z[0],writingMode:G,iconsInText:!1,verticalizable:!1};return(function(at,St,Xt,Ut,rr,wr,ar,Zt,Ft,Ir,Mr,Lr){let Ar=0,Yr=0,Gn=0,Rn=0;const Ja=Zt==="right"?1:Zt==="left"?0:.5,$s=ki/Lr;let Wi=0;for(const oa of rr){oa.trim();const hi=oa.getMaxScale(),yi={positionedGlyphs:[],lineOffset:0};at.positionedLines[Wi]=yi;const Oa=yi.positionedGlyphs;let xl=0;if(!oa.length()){Yr+=wr,++Wi;continue}const Xs=Zx(Ut,oa,$s);let yl=0;for(const gs of oa.text){const ii=oa.getSection(yl),$i=gs.codePointAt(0),fi=l0(Ft,Mr,$i),_s={glyph:$i,imageName:null,x:Ar,y:Yr+-17,vertical:fi,scale:1,fontStack:"",sectionIndex:oa.getSectionIndex(yl),metrics:null,rect:null};let yf;if("fontStack"in ii){if(yf=rd(ii,$i,fi,Xs,St,Xt),!yf)continue;_s.fontStack=ii.fontStack}else{if(at.iconsInText=!0,ii.scale*=$s,yf=Cm(ii,fi,hi,Xs,Ut),!yf)continue;xl=Math.max(xl,yf.imageOffset),_s.imageName=ii.imageName}const{rect:Wu,metrics:lg,baselineOffset:fd}=yf;_s.y+=fd,_s.scale=ii.scale,_s.metrics=lg,_s.rect=Wu,Oa.push(_s),fi?(at.verticalizable=!0,Ar+=("imageName"in ii?lg.advance:ki)*ii.scale+Ir):Ar+=lg.advance*ii.scale+Ir,yl++}Oa.length!==0&&(Gn=Math.max(Ar-Ir,Gn),c0(Oa,0,Oa.length-1,Ja)),Ar=0,yi.lineOffset=Math.max(xl,(hi-1)*ki);const eu=wr*hi+xl;Yr+=eu,Rn=Math.max(eu,Rn),++Wi}const{horizontalAlign:Qa,verticalAlign:Ha}=km(ar);(function(oa,hi,yi,Oa,xl,Xs,yl,eu,gs){const ii=(hi-yi)*xl;let $i=0;$i=Xs!==yl?-eu*Oa- -17:-Oa*gs*yl+.5*yl;for(const fi of oa)for(const _s of fi.positionedGlyphs)_s.x+=ii,_s.y+=$i})(at.positionedLines,Ja,Qa,Ha,Gn,Rn,wr,Yr,rr.length),at.top+=-Ha*Yr,at.bottom=at.top+Yr,at.left+=-Qa*Gn,at.right=at.left+Gn})(Je,e,n,h,ue,v,E,k,G,P,W,ie),!(function(at){for(const St of at)if(St.positionedGlyphs.length!==0)return!1;return!0})(De)&&Je}function km(a){let e=.5,n=.5;switch(a){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function Zx(a,e,n){const h=e.getMaxScale()*ki,{maxImageWidth:m,maxImageHeight:y}=e.getMaxImageSize(a),v=Math.max(h,y*n);return{verticalLineContentWidth:Math.max(h,m*n),horizontalLineContentHeight:v}}function S_(a){switch(a){case"top":return 0;case"center":return .5;default:return 1}}function l0(a,e,n){return!(a===_.az.horizontal||!e&&!Eu(n)||e&&(Yh(n)||(h=n,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(h)))));var h}function rd(a,e,n,h,m,y){const v=y[a.fontStack],E=(function(P,z,G,W){if(P&&P.rect)return P;const K=z[G.fontStack],ie=K&&K[W];return ie?{rect:null,metrics:ie.metrics}:null})(v&&v[e],m,a,e);if(E===null)return null;let k;if(n)k=h.verticalLineContentWidth-a.scale*ki;else{const P=S_(a.verticalAlign);k=(h.horizontalLineContentHeight-a.scale*ki)*P}return{rect:E.rect,metrics:E.metrics,baselineOffset:k}}function Cm(a,e,n,h,m){const y=m[a.imageName];if(!y)return null;const v=y.paddedRect,E=y.displaySize,k={width:E[0],height:E[1],left:1,top:-3,advance:e?E[1]:E[0]};let P;if(e)P=h.verticalLineContentWidth-E[1]*a.scale;else{const z=S_(a.verticalAlign);P=(h.horizontalLineContentHeight-E[1]*a.scale)*z}return{rect:v,metrics:k,baselineOffset:P,imageOffset:(e?E[0]:E[1])*a.scale-ki*n}}function c0(a,e,n,h){if(h===0)return;const m=a[n],y=(a[n].x+m.metrics.advance*m.scale)*h;for(let v=e;v<=n;v++)a[v].x-=y}function Mm(a,e,n){const{horizontalAlign:h,verticalAlign:m}=km(n),y=e[0]-a.displaySize[0]*h,v=e[1]-a.displaySize[1]*m;return{image:a,top:v,bottom:v+a.displaySize[1],left:y,right:y+a.displaySize[0]}}function Vu(a){var e,n;let h=a.left,m=a.top,y=a.right-h,v=a.bottom-m;const E=(e=a.image.textFitWidth)!==null&&e!==void 0?e:"stretchOrShrink",k=(n=a.image.textFitHeight)!==null&&n!==void 0?n:"stretchOrShrink",P=(a.image.content[2]-a.image.content[0])/(a.image.content[3]-a.image.content[1]);if(k==="proportional"){if(E==="stretchOnly"&&y/v<P||E==="proportional"){const z=Math.ceil(v*P);h*=z/y,y=z}}else if(E==="proportional"&&k==="stretchOnly"&&P!==0&&y/v>P){const z=Math.ceil(y/P);m*=z/v,v=z}return{x1:h,y1:m,x2:h+y,y2:m+v}}function xc(a,e,n,h,m,y){const v=a.image;let E;if(v.content){const ue=v.content,be=v.pixelRatio||1;E=[ue[0]/be,ue[1]/be,v.displaySize[0]-ue[2]/be,v.displaySize[1]-ue[3]/be]}const k=e.left*y,P=e.right*y;let z,G,W,K;n==="width"||n==="both"?(K=m[0]+k-h[3],G=m[0]+P+h[1]):(K=m[0]+(k+P-v.displaySize[0])/2,G=K+v.displaySize[0]);const ie=e.top*y,oe=e.bottom*y;return n==="height"||n==="both"?(z=m[1]+ie-h[0],W=m[1]+oe+h[2]):(z=m[1]+(ie+oe-v.displaySize[1])/2,W=z+v.displaySize[1]),{image:v,top:z,right:G,bottom:W,left:K,collisionPadding:E}}Cr("ImagePosition",ga),Cr("ImageAtlas",o0),_.az=void 0,(Sh=_.az||(_.az={}))[Sh.none=0]="none",Sh[Sh.horizontal=1]="horizontal",Sh[Sh.vertical=2]="vertical",Sh[Sh.horizontalOnly=3]="horizontalOnly";const gl=128,Eh=32640;function Dm(a,e){const{expression:n}=e;if(n.kind==="constant")return{kind:"constant",layoutSize:n.evaluate(new Qn(a+1))};if(n.kind==="source")return{kind:"source"};{const{zoomStops:h,interpolationType:m}=n;let y=0;for(;y<h.length&&h[y]<=a;)y++;y=Math.max(0,y-1);let v=y;for(;v<h.length&&h[v]<a+1;)v++;v=Math.min(h.length-1,v);const E=h[y],k=h[v];return n.kind==="composite"?{kind:"composite",minZoom:E,maxZoom:k,interpolationType:m}:{kind:"camera",minZoom:E,maxZoom:k,minSize:n.evaluate(new Qn(E)),maxSize:n.evaluate(new Qn(k)),interpolationType:m}}}function u0(a,e,n){let h="never";const m=a.get(e);return m?h=m:a.get(n)&&(h="always"),h}const E_=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Yd(a,e,n,h,m,y,v,E,k,P,z,G,W){const K=E?Math.min(Eh,Math.round(E[0])):0,ie=E?Math.min(Eh,Math.round(E[1])):0;a.emplaceBack(e,n,Math.round(32*h),Math.round(32*m),y,v,(K<<1)+(k?1:0),ie,16*P,16*z,256*G,256*W)}function Rm(a,e,n){a.emplaceBack(e.x,e.y,n),a.emplaceBack(e.x,e.y,n),a.emplaceBack(e.x,e.y,n),a.emplaceBack(e.x,e.y,n)}function Im(a){for(const e of a.sections)if(cc(e.text))return!0;return!1}class h0{constructor(e){this.layoutVertexArray=new Ke,this.indexArray=new Ct,this.programConfigurations=e,this.segments=new br,this.dynamicLayoutVertexArray=new dt,this.opacityVertexArray=new Rt,this.hasVisibleVertices=!1,this.placedSymbolArray=new A}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,n,h,m){this.isEmpty()||(h&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,f_.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Zd.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,E_,!0),this.opacityVertexBuffer.itemSize=1),(h||m)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Cr("SymbolBuffers",h0);class f0{constructor(e,n,h){this.layoutVertexArray=new e,this.layoutAttributes=n,this.indexArray=new h,this.segments=new br,this.collisionVertexArray=new kt}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Tm.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Cr("CollisionBuffers",f0);class nd{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((v=>v.id)),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Dm(this.zoom,n["text-size"]),this.iconSizeData=Dm(this.zoom,n["icon-size"]);const h=this.layers[0].layout,m=h.get("symbol-sort-key"),y=h.get("symbol-z-order");this.canOverlap=u0(h,"text-overlap","text-allow-overlap")!=="never"||u0(h,"icon-overlap","icon-allow-overlap")!=="never"||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey=y!=="viewport-y"&&!m.isConstant(),this.sortFeaturesByY=(y==="viewport-y"||y==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,h.get("symbol-placement")==="point"&&(this.writingModes=h.get("text-writing-mode").map((v=>_.az[v]))),this.stateDependentLayerIds=this.layers.filter((v=>v.isStateDependent())).map((v=>v.id)),this.sourceID=e.sourceID}createArrays(){this.text=new h0(new Zc(this.layers,this.zoom,(e=>/^text/.test(e)))),this.icon=new h0(new Zc(this.layers,this.zoom,(e=>/^icon/.test(e)))),this.glyphOffsetArray=new V,this.lineVertexArray=new q,this.symbolInstances=new F,this.textAnchorOffsets=new ee}calculateGlyphDependencies(e,n,h,m,y){for(const v of e)if(n[v.codePointAt(0)]=!0,(h||m)&&y){const E=Jf[v];E&&(n[E.codePointAt(0)]=!0)}}populate(e,n,h){const m=this.layers[0],y=m.layout,v=y.get("text-font"),E=y.get("text-field"),k=y.get("icon-image"),P=(E.value.kind!=="constant"||E.value.value instanceof Ma&&!E.value.value.isEmpty()||E.value.value.toString().length>0)&&(v.value.kind!=="constant"||v.value.value.length>0),z=k.value.kind!=="constant"||!!k.value.value||Object.keys(k.parameters).length>0,G=y.get("symbol-sort-key");if(this.features=[],!P&&!z)return;const W=n.iconDependencies,K=n.glyphDependencies,ie=n.availableImages,oe=new Qn(this.zoom);for(const{feature:ue,id:be,index:We,sourceLayerIndex:Se}of e){const De=m._featureFilter.needGeometry,Je=pl(ue,De);if(!m._featureFilter.filter(oe,Je,h))continue;let at,St;if(De||(Je.geometry=mc(ue)),P){const Ut=m.getValueAndResolveTokens("text-field",Je,h,ie),rr=Ma.factory(Ut),wr=this.hasRTLText=this.hasRTLText||Im(rr);(!wr||ko.getRTLTextPluginStatus()==="unavailable"||wr&&ko.isParsed())&&(at=zo(rr,m,Je))}if(z){const Ut=m.getValueAndResolveTokens("icon-image",Je,h,ie);St=Ut instanceof Ri?Ut:Ri.fromString(Ut)}if(!at&&!St)continue;const Xt=this.sortFeaturesByKey?G.evaluate(Je,{},h):void 0;if(this.features.push({id:be,text:at,icon:St,index:We,sourceLayerIndex:Se,geometry:Je.geometry,properties:ue.properties,type:Xf.types[ue.type],sortKey:Xt}),St&&(W[St.name]=!0),at){const Ut=v.evaluate(Je,{},h).join(","),rr=y.get("text-rotation-alignment")!=="viewport"&&y.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(_.az.vertical)>=0;for(const wr of at.sections)if(wr.image)W[wr.image.name]=!0;else{const ar=Ll(at.toString()),Zt=wr.fontStack||Ut,Ft=K[Zt]=K[Zt]||{};this.calculateGlyphDependencies(wr.text,Ft,rr,this.allowVerticalPlacement,ar)}}}y.get("symbol-placement")==="line"&&(this.features=(function(ue){const be={},We={},Se=[];let De=0;function Je(Ut){Se.push(ue[Ut]),De++}function at(Ut,rr,wr){const ar=We[Ut];return delete We[Ut],We[rr]=ar,Se[ar].geometry[0].pop(),Se[ar].geometry[0]=Se[ar].geometry[0].concat(wr[0]),ar}function St(Ut,rr,wr){const ar=be[rr];return delete be[rr],be[Ut]=ar,Se[ar].geometry[0].shift(),Se[ar].geometry[0]=wr[0].concat(Se[ar].geometry[0]),ar}function Xt(Ut,rr,wr){const ar=wr?rr[0][rr[0].length-1]:rr[0][0];return`${Ut}:${ar.x}:${ar.y}`}for(let Ut=0;Ut<ue.length;Ut++){const rr=ue[Ut],wr=rr.geometry,ar=rr.text?rr.text.toString():null;if(!ar){Je(Ut);continue}const Zt=Xt(ar,wr),Ft=Xt(ar,wr,!0);if(Zt in We&&Ft in be&&We[Zt]!==be[Ft]){const Ir=St(Zt,Ft,wr),Mr=at(Zt,Ft,Se[Ir].geometry);delete be[Zt],delete We[Ft],We[Xt(ar,Se[Mr].geometry,!0)]=Mr,Se[Ir].geometry=null}else Zt in We?at(Zt,Ft,wr):Ft in be?St(Zt,Ft,wr):(Je(Ut),be[Zt]=De-1,We[Ft]=De-1)}return Se.filter((Ut=>Ut.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((ue,be)=>ue.sortKey-be.sortKey))}update(e,n,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,n,this.layers,{imagePositions:h}),this.icon.programConfigurations.updatePaintArrays(e,n,this.layers,{imagePositions:h}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,n){const h=this.lineVertexArray.length;if(e.segment!==void 0){let m=e.dist(n[e.segment+1]),y=e.dist(n[e.segment]);const v={};for(let E=e.segment+1;E<n.length;E++)v[E]={x:n[E].x,y:n[E].y,tileUnitDistanceFromAnchor:m},E<n.length-1&&(m+=n[E+1].dist(n[E]));for(let E=e.segment||0;E>=0;E--)v[E]={x:n[E].x,y:n[E].y,tileUnitDistanceFromAnchor:y},E>0&&(y+=n[E-1].dist(n[E]));for(let E=0;E<n.length;E++){const k=v[E];this.lineVertexArray.emplaceBack(k.x,k.y,k.tileUnitDistanceFromAnchor)}}return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(e,n,h,m,y,v,E,k,P,z,G,W){const K=e.indexArray,ie=e.layoutVertexArray,oe=e.segments.prepareSegment(4*n.length,ie,K,this.canOverlap?v.sortKey:void 0),ue=this.glyphOffsetArray.length,be=oe.vertexLength,We=this.allowVerticalPlacement&&E===_.az.vertical?Math.PI/2:0,Se=v.text&&v.text.sections;for(let De=0;De<n.length;De++){const{tl:Je,tr:at,bl:St,br:Xt,tex:Ut,pixelOffsetTL:rr,pixelOffsetBR:wr,minFontScaleX:ar,minFontScaleY:Zt,glyphOffset:Ft,isSDF:Ir,sectionIndex:Mr}=n[De],Lr=oe.vertexLength,Ar=Ft[1];Yd(ie,k.x,k.y,Je.x,Ar+Je.y,Ut.x,Ut.y,h,Ir,rr.x,rr.y,ar,Zt),Yd(ie,k.x,k.y,at.x,Ar+at.y,Ut.x+Ut.w,Ut.y,h,Ir,wr.x,rr.y,ar,Zt),Yd(ie,k.x,k.y,St.x,Ar+St.y,Ut.x,Ut.y+Ut.h,h,Ir,rr.x,wr.y,ar,Zt),Yd(ie,k.x,k.y,Xt.x,Ar+Xt.y,Ut.x+Ut.w,Ut.y+Ut.h,h,Ir,wr.x,wr.y,ar,Zt),Rm(e.dynamicLayoutVertexArray,k,We),K.emplaceBack(Lr,Lr+2,Lr+1),K.emplaceBack(Lr+1,Lr+2,Lr+3),oe.vertexLength+=4,oe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ft[0]),De!==n.length-1&&Mr===n[De+1].sectionIndex||e.programConfigurations.populatePaintArrays(ie.length,v,v.index,{imagePositions:{},canonical:W,formattedSection:Se&&Se[Mr]})}e.placedSymbolArray.emplaceBack(k.x,k.y,ue,this.glyphOffsetArray.length-ue,be,P,z,k.segment,h?h[0]:0,h?h[1]:0,m[0],m[1],E,0,!1,0,G)}_addCollisionDebugVertex(e,n,h,m,y,v){return n.emplaceBack(0,0),e.emplaceBack(h.x,h.y,m,y,Math.round(v.x),Math.round(v.y))}addCollisionDebugVertices(e,n,h,m,y,v,E){const k=y.segments.prepareSegment(4,y.layoutVertexArray,y.indexArray),P=k.vertexLength,z=y.layoutVertexArray,G=y.collisionVertexArray,W=E.anchorX,K=E.anchorY;this._addCollisionDebugVertex(z,G,v,W,K,new C(e,n)),this._addCollisionDebugVertex(z,G,v,W,K,new C(h,n)),this._addCollisionDebugVertex(z,G,v,W,K,new C(h,m)),this._addCollisionDebugVertex(z,G,v,W,K,new C(e,m)),k.vertexLength+=4;const ie=y.indexArray;ie.emplaceBack(P,P+1),ie.emplaceBack(P+1,P+2),ie.emplaceBack(P+2,P+3),ie.emplaceBack(P+3,P),k.primitiveLength+=4}addDebugCollisionBoxes(e,n,h,m){for(let y=e;y<n;y++){const v=this.collisionBoxArray.get(y);this.addCollisionDebugVertices(v.x1,v.y1,v.x2,v.y2,m?this.textCollisionBox:this.iconCollisionBox,v.anchorPoint,h)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new f0(Tt,Lo.members,ur),this.iconCollisionBox=new f0(Tt,Lo.members,ur);for(let e=0;e<this.symbolInstances.length;e++){const n=this.symbolInstances.get(e);this.addDebugCollisionBoxes(n.textBoxStartIndex,n.textBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.iconBoxStartIndex,n.iconBoxEndIndex,n,!1),this.addDebugCollisionBoxes(n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex,n,!1)}}_deserializeCollisionBoxesForSymbol(e,n,h,m,y,v,E,k,P){const z={};for(let G=n;G<h;G++){const W=e.get(G);z.textBox={x1:W.x1,y1:W.y1,x2:W.x2,y2:W.y2,anchorPointX:W.anchorPointX,anchorPointY:W.anchorPointY},z.textFeatureIndex=W.featureIndex;break}for(let G=m;G<y;G++){const W=e.get(G);z.verticalTextBox={x1:W.x1,y1:W.y1,x2:W.x2,y2:W.y2,anchorPointX:W.anchorPointX,anchorPointY:W.anchorPointY},z.verticalTextFeatureIndex=W.featureIndex;break}for(let G=v;G<E;G++){const W=e.get(G);z.iconBox={x1:W.x1,y1:W.y1,x2:W.x2,y2:W.y2,anchorPointX:W.anchorPointX,anchorPointY:W.anchorPointY},z.iconFeatureIndex=W.featureIndex;break}for(let G=k;G<P;G++){const W=e.get(G);z.verticalIconBox={x1:W.x1,y1:W.y1,x2:W.x2,y2:W.y2,anchorPointX:W.anchorPointX,anchorPointY:W.anchorPointY},z.verticalIconFeatureIndex=W.featureIndex;break}return z}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const h=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,n){const h=e.placedSymbolArray.get(n),m=h.vertexStartIndex+4*h.numGlyphs;for(let y=h.vertexStartIndex;y<m;y+=4)e.indexArray.emplaceBack(y,y+2,y+1),e.indexArray.emplaceBack(y+1,y+2,y+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const n=Math.sin(e),h=Math.cos(e),m=[],y=[],v=[];for(let E=0;E<this.symbolInstances.length;++E){v.push(E);const k=this.symbolInstances.get(E);m.push(0|Math.round(n*k.anchorX+h*k.anchorY)),y.push(k.featureIndex)}return v.sort(((E,k)=>m[E]-m[k]||y[k]-y[E])),v}addToSortKeyRanges(e,n){const h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===n?h.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const h=this.symbolInstances.get(n);this.featureSortOrder.push(h.featureIndex),[h.rightJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.leftJustifiedTextSymbolIndex].forEach(((m,y,v)=>{m>=0&&v.indexOf(m)===y&&this.addIndicesForPlacedSymbol(this.text,m)})),h.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,h.verticalPlacedTextSymbolIndex),h.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.placedIconSymbolIndex),h.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let d0,p0;Cr("SymbolBucket",nd,{omit:["layers","collisionBoxArray","features","compareText"]}),nd.MAX_GLYPHS=65535,nd.addDynamicAttributes=Rm;var Pm={get paint(){return p0=p0||new ni({"icon-opacity":new jr(ht.paint_symbol["icon-opacity"]),"icon-color":new jr(ht.paint_symbol["icon-color"]),"icon-halo-color":new jr(ht.paint_symbol["icon-halo-color"]),"icon-halo-width":new jr(ht.paint_symbol["icon-halo-width"]),"icon-halo-blur":new jr(ht.paint_symbol["icon-halo-blur"]),"icon-translate":new Rr(ht.paint_symbol["icon-translate"]),"icon-translate-anchor":new Rr(ht.paint_symbol["icon-translate-anchor"]),"text-opacity":new jr(ht.paint_symbol["text-opacity"]),"text-color":new jr(ht.paint_symbol["text-color"],{runtimeType:jt,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new jr(ht.paint_symbol["text-halo-color"]),"text-halo-width":new jr(ht.paint_symbol["text-halo-width"]),"text-halo-blur":new jr(ht.paint_symbol["text-halo-blur"]),"text-translate":new Rr(ht.paint_symbol["text-translate"]),"text-translate-anchor":new Rr(ht.paint_symbol["text-translate-anchor"])})},get layout(){return d0=d0||new ni({"symbol-placement":new Rr(ht.layout_symbol["symbol-placement"]),"symbol-spacing":new Rr(ht.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Rr(ht.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new jr(ht.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Rr(ht.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Rr(ht.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Rr(ht.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Rr(ht.layout_symbol["icon-ignore-placement"]),"icon-optional":new Rr(ht.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Rr(ht.layout_symbol["icon-rotation-alignment"]),"icon-size":new jr(ht.layout_symbol["icon-size"]),"icon-text-fit":new Rr(ht.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Rr(ht.layout_symbol["icon-text-fit-padding"]),"icon-image":new jr(ht.layout_symbol["icon-image"]),"icon-rotate":new jr(ht.layout_symbol["icon-rotate"]),"icon-padding":new jr(ht.layout_symbol["icon-padding"]),"icon-keep-upright":new Rr(ht.layout_symbol["icon-keep-upright"]),"icon-offset":new jr(ht.layout_symbol["icon-offset"]),"icon-anchor":new jr(ht.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Rr(ht.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Rr(ht.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Rr(ht.layout_symbol["text-rotation-alignment"]),"text-field":new jr(ht.layout_symbol["text-field"]),"text-font":new jr(ht.layout_symbol["text-font"]),"text-size":new jr(ht.layout_symbol["text-size"]),"text-max-width":new jr(ht.layout_symbol["text-max-width"]),"text-line-height":new Rr(ht.layout_symbol["text-line-height"]),"text-letter-spacing":new jr(ht.layout_symbol["text-letter-spacing"]),"text-justify":new jr(ht.layout_symbol["text-justify"]),"text-radial-offset":new jr(ht.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Rr(ht.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new jr(ht.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new jr(ht.layout_symbol["text-anchor"]),"text-max-angle":new Rr(ht.layout_symbol["text-max-angle"]),"text-writing-mode":new Rr(ht.layout_symbol["text-writing-mode"]),"text-rotate":new jr(ht.layout_symbol["text-rotate"]),"text-padding":new Rr(ht.layout_symbol["text-padding"]),"text-keep-upright":new Rr(ht.layout_symbol["text-keep-upright"]),"text-transform":new jr(ht.layout_symbol["text-transform"]),"text-offset":new jr(ht.layout_symbol["text-offset"]),"text-allow-overlap":new Rr(ht.layout_symbol["text-allow-overlap"]),"text-overlap":new Rr(ht.layout_symbol["text-overlap"]),"text-ignore-placement":new Rr(ht.layout_symbol["text-ignore-placement"]),"text-optional":new Rr(ht.layout_symbol["text-optional"])})}};class A_{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:Me,this.defaultValue=e}evaluate(e){if(e.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(e.formattedSection))return n.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Cr("FormatSectionOverride",A_,{omit:["defaultValue"]});class Ah extends Va{constructor(e,n){super(e,Pm,n)}recalculate(e,n){if(super.recalculate(e,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const h=this.layout.get("text-writing-mode");if(h){const m=[];for(const y of h)m.indexOf(y)<0&&m.push(y);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,n,h,m){const y=this.layout.get(e).evaluate(n,{},h,m),v=this._unevaluatedLayout._values[e];return v.isDataDriven()||Jr(v.value)||!y?y:(function(E,k){return k.replace(/{([^{}]+)}/g,((P,z)=>E&&z in E?String(E[z]):""))})(n.properties,y)}createBucket(e){return new nd(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of Pm.paint.overridableProperties){if(!Ah.hasPaintOverride(this.layout,e))continue;const n=this.paint.get(e),h=new A_(n),m=new gr(h,n.property.specification);let y=null;y=n.value.kind==="constant"||n.value.kind==="source"?new Vr("source",m):new Hr("composite",m,n.value.zoomStops),this.paint._values[e]=new ao(n.property,y,n.parameters)}}_handleOverridablePaintPropertyUpdate(e,n,h){return!(!this.layout||n.isDataDriven()||h.isDataDriven())&&Ah.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,n){const h=e.get("text-field"),m=Pm.paint.properties[n];let y=!1;const v=E=>{for(const k of E)if(m.overrides&&m.overrides.hasOverride(k))return void(y=!0)};if(h.value.kind==="constant"&&h.value.value instanceof Ma)v(h.value.value.sections);else if(h.value.kind==="source"||h.value.kind==="composite"){const E=P=>{y||(P instanceof Ea&&kn(P.value)===yr?v(P.value.sections):P instanceof Jl?v(P.sections):P.eachChild(E))},k=h.value;k._styleExpression&&E(k._styleExpression.expression)}return y}}let k_;var C_={get paint(){return k_=k_||new ni({"background-color":new Rr(ht.paint_background["background-color"]),"background-pattern":new gh(ht.paint_background["background-pattern"]),"background-opacity":new Rr(ht.paint_background["background-opacity"])})}};class Un extends Va{constructor(e,n){super(e,C_,n)}}class Fm extends Va{constructor(e,n){super(e,{},n),this.onAdd=h=>{this.implementation.onAdd&&this.implementation.onAdd(h,h.painter.context.gl)},this.onRemove=h=>{this.implementation.onRemove&&this.implementation.onRemove(h,h.painter.context.gl)},this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class m0{constructor(e){this._methodToThrottle=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Lm={once:!0},g0=63710088e-1;class Jc{constructor(e,n){if(isNaN(e)||isNaN(n))throw new Error(`Invalid LngLat object: (${e}, ${n})`);if(this.lng=+e,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Jc(Gt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const n=Math.PI/180,h=this.lat*n,m=e.lat*n,y=Math.sin(h)*Math.sin(m)+Math.cos(h)*Math.cos(m)*Math.cos((e.lng-this.lng)*n);return g0*Math.acos(Math.min(y,1))}static convert(e){if(e instanceof Jc)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Jc(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Jc(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const ad=2*Math.PI*g0;function Kd(a){return ad*Math.cos(a*Math.PI/180)}function M_(a){return(180+a)/360}function zm(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function D_(a,e){return a/Kd(e)}function R_(a){return 360*a-180}function Jd(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}function Om(a,e){return a*Kd(Jd(e))}class ia{constructor(e,n,h=0){this.x=+e,this.y=+n,this.z=+h}static fromLngLat(e,n=0){const h=Jc.convert(e);return new ia(M_(h.lng),zm(h.lat),D_(n,h.lat))}toLngLat(){return new Jc(R_(this.x),Jd(this.y))}toAltitude(){return Om(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/ad*(e=Jd(this.y),1/Math.cos(e*Math.PI/180));var e}}function _0(a,e,n){var h=2*Math.PI*6378137/256/Math.pow(2,n);return[a*h-2*Math.PI*6378137/2,e*h-2*Math.PI*6378137/2]}class is{constructor(e,n,h){if(!(function(m,y,v){return!(m<0||m>25||v<0||v>=Math.pow(2,m)||y<0||y>=Math.pow(2,m))})(e,n,h))throw new Error(`x=${n}, y=${h}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=n,this.y=h,this.key=id(0,e,e,n,h)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,n,h){const m=(function(v,E,k){var P=_0(256*v,256*(E=Math.pow(2,k)-E-1),k),z=_0(256*(v+1),256*(E+1),k);return P[0]+","+P[1]+","+z[0]+","+z[1]})(this.x,this.y,this.z),y=(function(v,E,k){let P,z="";for(let G=v;G>0;G--)P=1<<G-1,z+=(E&P?1:0)+(k&P?2:0);return z})(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(h==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,n>1?"@2x":"").replace(/{quadkey}/g,y).replace(/{bbox-epsg-3857}/g,m)}isChildOf(e){const n=this.z-e.z;return n>0&&e.x===this.x>>n&&e.y===this.y>>n}getTilePoint(e){const n=Math.pow(2,this.z);return new C((e.x*n-this.x)*Oe,(e.y*n-this.y)*Oe)}toString(){return`${this.z}/${this.x}/${this.y}`}}class I_{constructor(e,n){this.wrap=e,this.canonical=n,this.key=id(e,n.z,n.z,n.x,n.y)}}class Oo{constructor(e,n,h,m,y){if(this.terrainRttPosMatrix32f=null,e<h)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${h}`);this.overscaledZ=e,this.wrap=n,this.canonical=new is(h,+m,+y),this.key=id(n,e,h,m,y)}clone(){return new Oo(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const n=this.canonical.z-e;return e>this.canonical.z?new Oo(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Oo(e,this.wrap,e,this.canonical.x>>n,this.canonical.y>>n)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(e,n){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-e;return e>this.canonical.z?id(this.wrap*+n,e,this.canonical.z,this.canonical.x,this.canonical.y):id(this.wrap*+n,e,e,this.canonical.x>>h,this.canonical.y>>h)}isChildOf(e){if(e.wrap!==this.wrap||this.overscaledZ-e.overscaledZ<=0)return!1;if(e.overscaledZ===0)return this.overscaledZ>0;const n=this.canonical.z-e.canonical.z;return!(n<0)&&e.canonical.x===this.canonical.x>>n&&e.canonical.y===this.canonical.y>>n}children(e){if(this.overscaledZ>=e)return[new Oo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,h=2*this.canonical.x,m=2*this.canonical.y;return[new Oo(n,this.wrap,n,h,m),new Oo(n,this.wrap,n,h+1,m),new Oo(n,this.wrap,n,h,m+1),new Oo(n,this.wrap,n,h+1,m+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Oo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Oo(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new I_(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new ia(e.x-this.wrap,e.y))}}function id(a,e,n,h,m){(a*=2)<0&&(a=-1*a-1);const y=1<<n;return(y*y*a+y*m+h).toString(36)+n.toString(36)+e.toString(36)}function Qd(a,e){return e?a.properties[e]:a.id}function Bm(a,e){const n={id:a.id};if(e.removeAllProperties&&(delete a.removeProperties,delete a.addOrUpdateProperties,delete e.removeProperties),e.removeProperties)for(const h of e.removeProperties){const m=a.addOrUpdateProperties.findIndex((y=>y.key===h));m>-1&&a.addOrUpdateProperties.splice(m,1)}return(a.removeAllProperties||e.removeAllProperties)&&(n.removeAllProperties=!0),(a.removeProperties||e.removeProperties)&&(n.removeProperties=[...a.removeProperties||[],...e.removeProperties||[]]),(a.addOrUpdateProperties||e.addOrUpdateProperties)&&(n.addOrUpdateProperties=[...a.addOrUpdateProperties||[],...e.addOrUpdateProperties||[]]),(a.newGeometry||e.newGeometry)&&(n.newGeometry=e.newGeometry||a.newGeometry),n}function ep(a){var e,n;if(!a)return{};const h={};return h.removeAll=a.removeAll,h.remove=new Set(a.remove||[]),h.add=new Map((e=a.add)===null||e===void 0?void 0:e.map((m=>[m.id,m]))),h.update=new Map((n=a.update)===null||n===void 0?void 0:n.map((m=>[m.id,m]))),h}Cr("CanonicalTileID",is),Cr("OverscaledTileID",Oo,{omit:["terrainRttPosMatrix32f"]});class kh{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(e){return this.minX=Math.min(this.minX,e.x),this.minY=Math.min(this.minY,e.y),this.maxX=Math.max(this.maxX,e.x),this.maxY=Math.max(this.maxY,e.y),this}expandBy(e){return this.minX-=e,this.minY-=e,this.maxX+=e,this.maxY+=e,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(e){return this.expandBy(-e)}map(e){const n=new kh;return n.extend(e(new C(this.minX,this.minY))),n.extend(e(new C(this.maxX,this.minY))),n.extend(e(new C(this.minX,this.maxY))),n.extend(e(new C(this.maxX,this.maxY))),n}static fromPoints(e){const n=new kh;for(const h of e)n.extend(h);return n}contains(e){return e.x>=this.minX&&e.x<=this.maxX&&e.y>=this.minY&&e.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(e){return!this.empty()&&!e.empty()&&e.minX>=this.minX&&e.maxX<=this.maxX&&e.minY>=this.minY&&e.maxY<=this.maxY}intersects(e){return!this.empty()&&!e.empty()&&e.minX<=this.maxX&&e.maxX>=this.minX&&e.minY<=this.maxY&&e.maxY>=this.minY}}class Nm{constructor(e){this._stringToNumber={},this._numberToString=[];for(let n=0;n<e.length;n++){const h=e[n];this._stringToNumber[h]=n,this._numberToString[n]=h}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class x0{constructor(e,n,h,m,y){this.type="Feature",this._vectorTileFeature=e,this._x=h,this._y=m,this._z=n,this.properties=e.properties,this.id=y}projectPoint(e,n,h,m){return[360*(e.x+n)/m-180,360/Math.PI*Math.atan(Math.exp((1-2*(e.y+h)/m)*Math.PI))-90]}projectLine(e,n,h,m){return e.map((y=>this.projectPoint(y,n,h,m)))}get geometry(){if(this._geometry)return this._geometry;const e=this._vectorTileFeature,n=e.extent*Math.pow(2,this._z),h=e.extent*this._x,m=e.extent*this._y,y=e.loadGeometry();switch(e.type){case 1:{const v=[];for(const k of y)v.push(k[0]);const E=this.projectLine(v,h,m,n);this._geometry=v.length===1?{type:"Point",coordinates:E[0]}:{type:"MultiPoint",coordinates:E};break}case 2:{const v=y.map((E=>this.projectLine(E,h,m,n)));this._geometry=v.length===1?{type:"LineString",coordinates:v[0]}:{type:"MultiLineString",coordinates:v};break}case 3:{const v=u_(y),E=[];for(const k of v)E.push(k.map((P=>this.projectLine(P,h,m,n))));this._geometry=E.length===1?{type:"Polygon",coordinates:E[0]}:{type:"MultiPolygon",coordinates:E};break}default:throw new Error(`unknown feature type: ${e.type}`)}return this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const n in this)n!=="_geometry"&&n!=="_vectorTileFeature"&&n!=="_x"&&n!=="_y"&&n!=="_z"&&(e[n]=this[n]);return e}}class Ch{_name;dataBuffer;nullabilityBuffer;_size;constructor(e,n,h){this._name=e,this.dataBuffer=n,typeof h=="number"?this._size=h:(this.nullabilityBuffer=h,this._size=h.size())}getValue(e){return this.nullabilityBuffer&&!this.nullabilityBuffer.get(e)?null:this.getValueFromBuffer(e)}has(e){return this.nullabilityBuffer&&this.nullabilityBuffer.get(e)||!this.nullabilityBuffer}get name(){return this._name}get size(){return this._size}}class y0 extends Ch{}class v0 extends y0{getValueFromBuffer(e){return this.dataBuffer[e]}}class jm extends y0{getValueFromBuffer(e){return this.dataBuffer[e]}}class Um extends Ch{delta;constructor(e,n,h,m){super(e,n,m),this.delta=h}}class Vm extends Um{constructor(e,n,h,m){super(e,Int32Array.of(n),h,m)}getValueFromBuffer(e){return this.dataBuffer[0]+e*this.delta}}class Gm extends Ch{constructor(e,n,h){super(e,Int32Array.of(n),h)}getValueFromBuffer(e){return this.dataBuffer[0]}}class Mh{_name;_geometryVector;_idVector;_propertyVectors;_extent;propertyVectorsMap;constructor(e,n,h,m,y=4096){this._name=e,this._geometryVector=n,this._idVector=h,this._propertyVectors=m,this._extent=y}get name(){return this._name}get idVector(){return this._idVector}get geometryVector(){return this._geometryVector}get propertyVectors(){return this._propertyVectors}getPropertyVector(e){return this.propertyVectorsMap||(this.propertyVectorsMap=new Map(this._propertyVectors.map((n=>[n.name,n])))),this.propertyVectorsMap.get(e)}*[Symbol.iterator](){const e=this.geometryVector[Symbol.iterator]();let n=0;for(;n<this.numFeatures;){let h;this.idVector&&(h=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(n)):this.idVector.getValue(n));const m=e?.next().value,y={};for(const v of this.propertyVectors){if(!v)continue;const E=v.name,k=v.getValue(n);k!==null&&(y[E]=k)}n++,yield{id:h,geometry:m,properties:y}}}get numFeatures(){return this.geometryVector.numGeometries}get extent(){return this._extent}getFeatures(){const e=[],n=this.geometryVector.getGeometries();for(let h=0;h<this.numFeatures;h++){let m;this.idVector&&(m=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(h)):this.idVector.getValue(h));const y={coordinates:n[h],type:this.geometryVector.geometryType(h)},v={};for(const E of this.propertyVectors){if(!E)continue;const k=E.name,P=E.getValue(h);P!==null&&(v[k]=P)}e.push({id:m,geometry:y,properties:v})}return e}containsMaxSaveIntegerValues(e){return e instanceof v0||e instanceof Gm&&e instanceof Vm||e instanceof jm}}class P_{value;constructor(e){this.value=e}get(){return this.value}set(e){this.value=e}increment(){return this.value++}add(e){this.value+=e}}var An,yc,ps,vc,Dh,qs,xi,qi,_l,co;function Zi(a,e,n){const h=new Int32Array(n);let m=0,y=e.get();for(let v=0;v<h.length;v++){let E=a[y++],k=127&E;E<128||(E=a[y++],k|=(127&E)<<7,E<128||(E=a[y++],k|=(127&E)<<14,E<128||(E=a[y++],k|=(127&E)<<21,E<128||(E=a[y++],k|=(15&E)<<28)))),h[m++]=k}return e.set(y),h}function tp(a,e,n){const h=new BigInt64Array(n);for(let m=0;m<h.length;m++)h[m]=b0(a,e);return h}function F_(a,e){let n,h;return h=a[e.get()],e.increment(),n=127&h,h<128?n:(h=a[e.get()],e.increment(),n|=(127&h)<<7,h<128?n:(h=a[e.get()],e.increment(),n|=(127&h)<<14,h<128?n:(h=a[e.get()],e.increment(),n|=(127&h)<<21,h<128?n:(h=a[e.get()],n|=(15&h)<<28,(function(m,y,v){let E,k;if(k=y[v.get()],v.increment(),E=(112&k)>>4,k<128||(k=y[v.get()],v.increment(),E|=(127&k)<<3,k<128)||(k=y[v.get()],v.increment(),E|=(127&k)<<10,k<128)||(k=y[v.get()],v.increment(),E|=(127&k)<<17,k<128)||(k=y[v.get()],v.increment(),E|=(127&k)<<24,k<128)||(k=y[v.get()],v.increment(),E|=(1&k)<<31,k<128))return 4294967296*E+(m>>>0);throw new Error("Expected varint not more than 10 bytes")})(n,a,e)))))}function sd(a,e,n,h){throw new Error("FastPFor is not implemented yet.")}function ms(a){return a>>>1^-(1&a)}function gf(a){return a>>1n^-(1n&a)}function b0(a,e){let n=0n,h=0,m=e.get();for(;m<a.length;){const y=a[m++];if(n|=BigInt(127&y)<<BigInt(h),!(128&y))break;if(h+=7,h>=64)throw new Error("Varint too long")}return e.set(m),n}function Qc(a,e,n){const h=new Int32Array(n);let m=0;for(let y=0;y<e;y++){const v=a[y];h.fill(a[y+e],m,m+v),m+=v}return h}function L_(a,e,n){const h=new BigInt64Array(n);let m=0;for(let y=0;y<e;y++){const v=Number(a[y]);h.fill(a[y+e],m,m+v),m+=v}return h}function z_(a,e,n){const h=new Float64Array(n);let m=0;for(let y=0;y<e;y++){const v=a[y];h.fill(a[y+e],m,m+v),m+=v}return h}function Rh(a){const e=a.length/4*4;let n=1;if(e>=4)for(let h=a[0];n<e-4;n+=4)h=a[n]+=h,h=a[n+1]+=h,h=a[n+2]+=h,h=a[n+3]+=h;for(;n!=a.length;)a[n]+=a[n-1],++n}function Hm(a){a[0]=a[0]>>>1^-(1&a[0]),a[1]=a[1]>>>1^-(1&a[1]);const e=a.length/4*4;let n=2;if(e>=4)for(;n<e-4;n+=4){const h=a[n],m=a[n+1],y=a[n+2],v=a[n+3];a[n]=(h>>>1^-(1&h))+a[n-2],a[n+1]=(m>>>1^-(1&m))+a[n-1],a[n+2]=(y>>>1^-(1&y))+a[n],a[n+3]=(v>>>1^-(1&v))+a[n+1]}for(;n!=a.length;n+=2)a[n]=(a[n]>>>1^-(1&a[n]))+a[n-2],a[n+1]=(a[n+1]>>>1^-(1&a[n+1]))+a[n-1]}(function(a){a.NONE="NONE",a.DELTA="DELTA",a.COMPONENTWISE_DELTA="COMPONENTWISE_DELTA",a.RLE="RLE",a.MORTON="MORTON",a.PDE="PDE"})(An||(An={})),(function(a){a.NONE="NONE",a.FAST_PFOR="FAST_PFOR",a.VARINT="VARINT",a.ALP="ALP"})(yc||(yc={})),(function(a){a.PRESENT="PRESENT",a.DATA="DATA",a.OFFSET="OFFSET",a.LENGTH="LENGTH"})(ps||(ps={}));class qm{_dictionaryType;_offsetType;_lengthType;constructor(e,n,h){this._dictionaryType=e,this._offsetType=n,this._lengthType=h}get dictionaryType(){return this._dictionaryType}get offsetType(){return this._offsetType}get lengthType(){return this._lengthType}}function Zs(a,e){const n=(function(h,m){const y=h[m.get()],v=Object.values(ps)[y>>4];let E=null;switch(v){case ps.DATA:E=new qm(Object.values(vc)[15&y]);break;case ps.OFFSET:E=new qm(null,Object.values(Dh)[15&y]);break;case ps.LENGTH:E=new qm(null,null,Object.values(qs)[15&y])}m.increment();const k=h[m.get()],P=Object.values(An)[k>>5],z=Object.values(An)[k>>2&7],G=Object.values(yc)[3&k];m.increment();const W=Zi(h,m,2),K=W[0];return{physicalStreamType:v,logicalStreamType:E,logicalLevelTechnique1:P,logicalLevelTechnique2:z,physicalLevelTechnique:G,numValues:K,byteLength:W[1],decompressedCount:K}})(a,e);return n.logicalLevelTechnique1===An.MORTON?(function(h,m,y){const v=Zi(m,y,2);return{physicalStreamType:h.physicalStreamType,logicalStreamType:h.logicalStreamType,logicalLevelTechnique1:h.logicalLevelTechnique1,logicalLevelTechnique2:h.logicalLevelTechnique2,physicalLevelTechnique:h.physicalLevelTechnique,numValues:h.numValues,byteLength:h.byteLength,decompressedCount:h.decompressedCount,numBits:v[0],coordinateShift:v[1]}})(n,a,e):An.RLE!==n.logicalLevelTechnique1&&An.RLE!==n.logicalLevelTechnique2||yc.NONE===n.physicalLevelTechnique?n:(function(h,m,y){const v=Zi(m,y,2);return{physicalStreamType:h.physicalStreamType,logicalStreamType:h.logicalStreamType,logicalLevelTechnique1:h.logicalLevelTechnique1,logicalLevelTechnique2:h.logicalLevelTechnique2,physicalLevelTechnique:h.physicalLevelTechnique,numValues:h.numValues,byteLength:h.byteLength,decompressedCount:v[1],runs:v[0],numRleValues:v[1]}})(n,a,e)}(function(a){a.NONE="NONE",a.SINGLE="SINGLE",a.SHARED="SHARED",a.VERTEX="VERTEX",a.MORTON="MORTON",a.FSST="FSST"})(vc||(vc={})),(function(a){a.VERTEX="VERTEX",a.INDEX="INDEX",a.STRING="STRING",a.KEY="KEY"})(Dh||(Dh={})),(function(a){a.VAR_BINARY="VAR_BINARY",a.GEOMETRIES="GEOMETRIES",a.PARTS="PARTS",a.RINGS="RINGS",a.TRIANGLES="TRIANGLES",a.SYMBOL="SYMBOL",a.DICTIONARY="DICTIONARY"})(qs||(qs={})),(function(a){a[a.FLAT=0]="FLAT",a[a.CONST=1]="CONST",a[a.SEQUENCE=2]="SEQUENCE",a[a.DICTIONARY=3]="DICTIONARY",a[a.FSST_DICTIONARY=4]="FSST_DICTIONARY"})(xi||(xi={}));class bc{values;_size;constructor(e,n){this.values=e,this._size=n}get(e){const n=Math.floor(e/8);return(this.values[n]>>e%8&1)==1}set(e,n){const h=Math.floor(e/8);this.values[h]=this.values[h]|(n?1:0)<<e%8}getInt(e){const n=Math.floor(e/8);return this.values[n]>>e%8&1}size(){return this._size}getBuffer(){return this.values}}function Ws(a,e,n,h,m){return(function(y,v,E){switch(v.logicalLevelTechnique1){case An.DELTA:return v.logicalLevelTechnique2===An.RLE?(function(k,P,z){const G=new Int32Array(z);let W=0,K=0;for(let ie=0;ie<P;ie++){const oe=k[ie],ue=ms(k[ie+P]);for(let be=0;be<oe;be++)K+=ue,G[W++]=K}return G})(y,v.runs,v.numRleValues):((function(k){k[0]=k[0]>>>1^-(1&k[0]);const P=k.length/4*4;let z=1;if(P>=4)for(;z<P-4;z+=4){const G=k[z],W=k[z+1],K=k[z+2],ie=k[z+3];k[z]=(G>>>1^-(1&G))+k[z-1],k[z+1]=(W>>>1^-(1&W))+k[z],k[z+2]=(K>>>1^-(1&K))+k[z+1],k[z+3]=(ie>>>1^-(1&ie))+k[z+2]}for(;z!=k.length;++z)k[z]=(k[z]>>>1^-(1&k[z]))+k[z-1]})(y),y);case An.RLE:return(function(k,P,z){return z?(function(G,W,K){const ie=new Int32Array(K);let oe=0;for(let ue=0;ue<W;ue++){const be=G[ue];let We=G[ue+W];We=We>>>1^-(1&We),ie.fill(We,oe,oe+be),oe+=be}return ie})(k,P.runs,P.numRleValues):Qc(k,P.runs,P.numRleValues)})(y,v,E);case An.MORTON:return Rh(y),y;case An.COMPONENTWISE_DELTA:return Hm(y),y;case An.NONE:return E&&(function(k){for(let P=0;P<k.length;P++){const z=k[P];k[P]=z>>>1^-(1&z)}})(y),y;default:throw new Error(`The specified Logical level technique is not supported: ${v.logicalLevelTechnique1}`)}})(w0(a,e,n),n,h)}function Ih(a,e,n){return(function(h,m){if(m.logicalLevelTechnique1===An.DELTA&&m.logicalLevelTechnique2===An.NONE)return(function(v){const E=new Int32Array(v.length+1);E[0]=0,E[1]=ms(v[0]);let k=E[1],P=2;for(;P!=E.length;++P){const z=v[P-1];k+=z>>>1^-(1&z),E[P]=E[P-1]+k}return E})(h);if(m.logicalLevelTechnique1===An.RLE&&m.logicalLevelTechnique2===An.NONE)return(function(v,E,k){const P=new Int32Array(k+1);P[0]=0;let z=1,G=P[0];for(let W=0;W<E;W++){const K=v[W],ie=v[W+E];for(let oe=z;oe<z+K;oe++)P[oe]=ie+G,G=P[oe];z+=K}return P})(h,m.runs,m.numRleValues);if(m.logicalLevelTechnique1===An.NONE&&m.logicalLevelTechnique2===An.NONE){(function(v){let E=0;for(let k=0;k<v.length;k++)v[k]+=E,E=v[k]})(h);const y=new Int32Array(m.numValues+1);return y[0]=0,y.set(h,1),y}if(m.logicalLevelTechnique1===An.DELTA&&m.logicalLevelTechnique2===An.RLE){const y=(function(v,E,k){const P=new Int32Array(k+1);P[0]=0;let z=1,G=P[0];for(let W=0;W<E;W++){const K=v[W];let ie=v[W+E];ie=ie>>>1^-(1&ie);for(let oe=z;oe<z+K;oe++)P[oe]=ie+G,G=P[oe];z+=K}return P})(h,m.runs,m.numRleValues);return Rh(y),y}throw new Error("Only delta encoding is supported for transforming length to offset streams yet.")})(w0(a,e,n),n)}function w0(a,e,n){const h=n.physicalLevelTechnique;if(h===yc.FAST_PFOR)return sd();if(h===yc.VARINT)return Zi(a,e,n.numValues);if(h===yc.NONE){const m=e.get();e.add(n.byteLength);const y=a.subarray(m,e.get());return new Int32Array(y)}throw new Error("Specified physicalLevelTechnique is not supported (yet).")}function Zm(a,e,n,h){const m=w0(a,e,n);if(m.length===1){const y=m[0];return h?ms(y):y}return h?(function(y){return ms(y[1])})(m):(function(y){return y[1]})(m)}function Wm(a,e,n){return(function(h){if(h.length==2){const m=ms(h[1]);return[m,m]}return[ms(h[2]),ms(h[3])]})(w0(a,e,n))}function _f(a,e,n){return(function(h){if(h.length==2){const m=gf(h[1]);return[m,m]}return[gf(h[2]),gf(h[3])]})(tp(a,e,n.numValues))}function od(a,e,n,h){return(function(m,y,v){switch(y.logicalLevelTechnique1){case An.DELTA:return y.logicalLevelTechnique2===An.RLE?(function(E,k,P){const z=new BigInt64Array(P);let G=0,W=0n;for(let K=0;K<k;K++){const ie=Number(E[K]),oe=gf(E[K+k]);for(let ue=0;ue<ie;ue++)W+=oe,z[G++]=W}return z})(m,y.runs,y.numRleValues):((function(E){E[0]=E[0]>>1n^-(1n&E[0]);const k=E.length/4*4;let P=1;if(k>=4)for(;P<k-4;P+=4){const z=E[P],G=E[P+1],W=E[P+2],K=E[P+3];E[P]=(z>>1n^-(1n&z))+E[P-1],E[P+1]=(G>>1n^-(1n&G))+E[P],E[P+2]=(W>>1n^-(1n&W))+E[P+1],E[P+3]=(K>>1n^-(1n&K))+E[P+2]}for(;P!=E.length;++P)E[P]=(E[P]>>1n^-(1n&E[P]))+E[P-1]})(m),m);case An.RLE:return(function(E,k,P){return P?(function(z,G,W){const K=new BigInt64Array(W);let ie=0;for(let oe=0;oe<G;oe++){const ue=Number(z[oe]);let be=z[oe+G];be=be>>1n^-(1n&be),K.fill(be,ie,ie+ue),ie+=ue}return K})(E,k.runs,k.numRleValues):L_(E,k.runs,k.numRleValues)})(m,y,v);case An.NONE:return v&&(function(E){for(let k=0;k<E.length;k++){const P=E[k];E[k]=P>>1n^-(1n&P)}})(m),m;default:throw new Error(`The specified Logical level technique is not supported: ${y.logicalLevelTechnique1}`)}})(tp(a,e,n.numValues),n,h)}function $m(a,e,n,h){const m=tp(a,e,n.numValues);if(m.length===1){const y=m[0];return h?gf(y):y}return h?(function(y){return gf(y[1])})(m):(function(y){return y[1]})(m)}function Xm(a,e,n,h,m){return(function(y,v,E,k){switch(v.logicalLevelTechnique1){case An.DELTA:return v.logicalLevelTechnique2===An.RLE&&(y=Qc(y,v.runs,v.numRleValues)),(function(P,z){const G=new Int32Array(P.size());let W=0;P.get(0)?(G[0]=P.get(0)?z[0]>>>1^-(1&z[0]):0,W=1):G[0]=0;let K=1;for(;K!=G.length;++K)G[K]=P.get(K)?G[K-1]+(z[W]>>>1^-(1&z[W++])):G[K-1];return G})(k,y);case An.RLE:return(function(P,z,G,W){const K=z;return G?(function(ie,oe,ue){const be=new Int32Array(ie.size());let We=0;for(let Se=0;Se<ue;Se++){const De=oe[Se];let Je=oe[Se+ue];Je=Je>>>1^-(1&Je);for(let at=We;at<We+De;at++)ie.get(at)?be[at]=Je:(be[at]=0,We++);We+=De}return be})(W,P,K.runs):(function(ie,oe,ue){const be=new Int32Array(ie.size());let We=0;for(let Se=0;Se<ue;Se++){const De=oe[Se],Je=oe[Se+ue];for(let at=We;at<We+De;at++)ie.get(at)?be[at]=Je:(be[at]=0,We++);We+=De}return be})(W,P,K.runs)})(y,v,E,k);case An.MORTON:return Rh(y),y;case An.COMPONENTWISE_DELTA:return Hm(y),y;case An.NONE:return y=E?(function(P,z){const G=new Int32Array(P.size());let W=0,K=0;for(;K!=G.length;++K)if(P.get(K)){const ie=z[W++];G[K]=ie>>>1^-(1&ie)}else G[K]=0;return G})(k,y):(function(P,z){const G=new Int32Array(P.size());let W=0,K=0;for(;K!=G.length;++K)G[K]=P.get(K)?z[W++]:0;return G})(k,y),y;default:throw new Error("The specified Logical level technique is not supported")}})(n.physicalLevelTechnique===yc.FAST_PFOR?sd():Zi(a,e,n.numValues),n,h,m)}function Gu(a,e,n,h){const m=a.logicalLevelTechnique1;if(m===An.RLE)return a.runs===1?xi.CONST:xi.FLAT;const y=e instanceof bc?e.size():e;if(m===An.DELTA&&a.logicalLevelTechnique2===An.RLE){const v=a.runs,E=2;if(a.numRleValues!==y)return xi.FLAT;if(v===1)return xi.SEQUENCE;if(v===2){const k=h.get();let P;if(a.physicalLevelTechnique===yc.VARINT)P=Zi(n,h,4);else{const z=h.get();P=new Int32Array(n.buffer,n.byteOffset+z,4)}if(h.set(k),P[2]===E&&P[3]===E)return xi.SEQUENCE}}return a.numValues===1?xi.CONST:xi.FLAT}class ld extends y0{getValueFromBuffer(e){return this.dataBuffer[e]}}class Ym extends Um{constructor(e,n,h,m){super(e,BigInt64Array.of(n),h,m)}getValueFromBuffer(e){return this.dataBuffer[0]+BigInt(e)*this.delta}}class Hu{_geometryOffsets;_partOffsets;_ringOffsets;constructor(e,n,h){this._geometryOffsets=e,this._partOffsets=n,this._ringOffsets=h}get geometryOffsets(){return this._geometryOffsets}get partOffsets(){return this._partOffsets}get ringOffsets(){return this._ringOffsets}}function rp(a,e,n){return{x:T0(a,e)-n,y:T0(a>>1,e)-n}}function T0(a,e){let n=0;for(let h=0;h<e;h++)n|=(a&1<<2*h)>>h;return n}(function(a){a[a.POINT=0]="POINT",a[a.LINESTRING=1]="LINESTRING",a[a.POLYGON=2]="POLYGON",a[a.MULTIPOINT=3]="MULTIPOINT",a[a.MULTILINESTRING=4]="MULTILINESTRING",a[a.MULTIPOLYGON=5]="MULTIPOLYGON"})(qi||(qi={})),(function(a){a[a.POINT=0]="POINT",a[a.LINESTRING=1]="LINESTRING",a[a.POLYGON=2]="POLYGON"})(_l||(_l={})),(function(a){a[a.MORTON=0]="MORTON",a[a.VEC_2=1]="VEC_2",a[a.VEC_3=2]="VEC_3"})(co||(co={}));class S0{createPoint(e){return[[e]]}createMultiPoint(e){return e.map((n=>[n]))}createLineString(e){return[e]}createMultiLineString(e){return e}createPolygon(e,n){return[e].concat(n)}createMultiPolygon(e){return e.flat()}}function Km(a){const e=new Array(a.numGeometries);let n=1,h=1,m=1,y=0;const v=new S0;let E=0,k=0;const P=a.mortonSettings,z=a.topologyVector,G=z.geometryOffsets,W=z.partOffsets,K=z.ringOffsets,ie=a.vertexOffsets,oe=a.containsPolygonGeometry(),ue=a.vertexBuffer;for(let be=0;be<a.numGeometries;be++){const We=a.geometryType(be);if(We===qi.POINT){if(ie&&ie.length!==0)if(a.vertexBufferType===co.VEC_2){const Se=2*ie[k++],De=new C(ue[Se],ue[Se+1]);e[y++]=v.createPoint(De)}else{const Se=rp(ue[ie[k++]],P.numBits,P.coordinateShift),De=new C(Se.x,Se.y);e[y++]=v.createPoint(De)}else{const Se=new C(ue[E++],ue[E++]);e[y++]=v.createPoint(Se)}G&&m++,W&&n++,K&&h++}else if(We===qi.MULTIPOINT){const Se=G[m]-G[m-1];m++;const De=new Array(Se);if(ie&&ie.length!==0){for(let Je=0;Je<Se;Je++){const at=2*ie[k++];De[Je]=new C(ue[at],ue[at+1])}e[y++]=v.createMultiPoint(De)}else{for(let Je=0;Je<Se;Je++){const at=ue[E++],St=ue[E++];De[Je]=new C(at,St)}e[y++]=v.createMultiPoint(De)}}else if(We===qi.LINESTRING){let Se,De=0;oe?(De=K[h]-K[h-1],h++):De=W[n]-W[n-1],n++,ie&&ie.length!==0?(Se=a.vertexBufferType===co.VEC_2?ip(ue,ie,k,De,!1):Qm(ue,ie,k,De,!1,P),k+=De):(Se=Jm(ue,E,De,!1),E+=2*De),e[y++]=v.createLineString(Se),G&&m++}else if(We===qi.POLYGON){const Se=W[n]-W[n-1];n++;const De=new Array(Se-1);let Je=K[h]-K[h-1];if(h++,ie&&ie.length!==0){const at=a.vertexBufferType===co.VEC_2?E0(ue,ie,k,Je):ap(ue,ie,k,Je,0,P);k+=Je;for(let St=0;St<De.length;St++)Je=K[h]-K[h-1],h++,De[St]=a.vertexBufferType===co.VEC_2?E0(ue,ie,k,Je):ap(ue,ie,k,Je,0,P),k+=Je;e[y++]=v.createPolygon(at,De)}else{const at=np(ue,E,Je);E+=2*Je;for(let St=0;St<De.length;St++)Je=K[h]-K[h-1],h++,De[St]=np(ue,E,Je),E+=2*Je;e[y++]=v.createPolygon(at,De)}G&&m++}else if(We===qi.MULTILINESTRING){const Se=G[m]-G[m-1];m++;const De=new Array(Se);if(ie&&ie.length!==0){for(let Je=0;Je<Se;Je++){let at=0;oe?(at=K[h]-K[h-1],h++):at=W[n]-W[n-1],n++;const St=a.vertexBufferType===co.VEC_2?ip(ue,ie,k,at,!1):Qm(ue,ie,k,at,!1,P);De[Je]=St,k+=at}e[y++]=v.createMultiLineString(De)}else{for(let Je=0;Je<Se;Je++){let at=0;oe?(at=K[h]-K[h-1],h++):at=W[n]-W[n-1],n++,De[Je]=Jm(ue,E,at,!1),E+=2*at}e[y++]=v.createMultiLineString(De)}}else{if(We!==qi.MULTIPOLYGON)throw new Error("The specified geometry type is currently not supported.");{const Se=G[m]-G[m-1];m++;const De=new Array(Se);let Je=0;if(ie&&ie.length!==0){for(let at=0;at<Se;at++){const St=W[n]-W[n-1];n++;const Xt=new Array(St-1);Je=K[h]-K[h-1],h++;const Ut=a.vertexBufferType===co.VEC_2?E0(ue,ie,k,Je):ap(ue,ie,k,Je,0,P);k+=Je;for(let rr=0;rr<Xt.length;rr++)Je=K[h]-K[h-1],h++,Xt[rr]=a.vertexBufferType===co.VEC_2?E0(ue,ie,k,Je):ap(ue,ie,k,Je,0,P),k+=Je;De[at]=v.createPolygon(Ut,Xt)}e[y++]=v.createMultiPolygon(De)}else{for(let at=0;at<Se;at++){const St=W[n]-W[n-1];n++;const Xt=new Array(St-1);Je=K[h]-K[h-1],h++;const Ut=np(ue,E,Je);E+=2*Je;for(let rr=0;rr<Xt.length;rr++){const wr=K[h]-K[h-1];h++,Xt[rr]=np(ue,E,wr),E+=2*wr}De[at]=v.createPolygon(Ut,Xt)}e[y++]=v.createMultiPolygon(De)}}}}return e}function np(a,e,n){return Jm(a,e,n,!0)}function E0(a,e,n,h){return ip(a,e,n,h,!0)}function ap(a,e,n,h,m,y){return Qm(a,e,n,h,!0,y)}function Jm(a,e,n,h){const m=new Array(h?n+1:n);for(let y=0;y<2*n;y+=2)m[y/2]=new C(a[e+y],a[e+y+1]);return h&&(m[m.length-1]=m[0]),m}function ip(a,e,n,h,m){const y=new Array(m?h+1:h);for(let v=0;v<2*h;v+=2){const E=2*e[n+v/2];y[v/2]=new C(a[E],a[E+1])}return m&&(y[y.length-1]=y[0]),y}function Qm(a,e,n,h,m,y){const v=new Array(m?h+1:h);for(let E=0;E<h;E++){const k=rp(a[e[n+E]],y.numBits,y.coordinateShift);v[E]=new C(k.x,k.y)}return m&&(v[v.length-1]=v[0]),v}class sp{_vertexBufferType;_topologyVector;_vertexOffsets;_vertexBuffer;_mortonSettings;constructor(e,n,h,m,y){this._vertexBufferType=e,this._topologyVector=n,this._vertexOffsets=h,this._vertexBuffer=m,this._mortonSettings=y}get vertexBufferType(){return this._vertexBufferType}get topologyVector(){return this._topologyVector}get vertexOffsets(){return this._vertexOffsets}get vertexBuffer(){return this._vertexBuffer}*[Symbol.iterator](){const e=Km(this);let n=0;for(;n<this.numGeometries;)yield{coordinates:e[n],type:this.geometryType(n)},n++}getSimpleEncodedVertex(e){const n=this.vertexOffsets?2*this.vertexOffsets[e]:2*e;return[this.vertexBuffer[n],this.vertexBuffer[n+1]]}getVertex(e){if(this.vertexOffsets&&this.mortonSettings){const h=rp(this.vertexBuffer[this.vertexOffsets[e]],this.mortonSettings.numBits,this.mortonSettings.coordinateShift);return[h.x,h.y]}const n=this.vertexOffsets?2*this.vertexOffsets[e]:2*e;return[this.vertexBuffer[n],this.vertexBuffer[n+1]]}getGeometries(){return Km(this)}get mortonSettings(){return this._mortonSettings}}class op extends sp{_numGeometries;_geometryType;constructor(e,n,h,m,y,v,E){super(h,m,y,v,E),this._numGeometries=e,this._geometryType=n}geometryType(e){return this._geometryType}get numGeometries(){return this._numGeometries}containsPolygonGeometry(){return this._geometryType===qi.POLYGON||this._geometryType===qi.MULTIPOLYGON}containsSingleGeometryType(){return!0}}class lp extends sp{_geometryTypes;constructor(e,n,h,m,y,v){super(e,h,m,y,v),this._geometryTypes=n}geometryType(e){return this._geometryTypes[e]}get numGeometries(){return this._geometryTypes.length}containsPolygonGeometry(){for(let e=0;e<this.numGeometries;e++)if(this.geometryType(e)===qi.POLYGON||this.geometryType(e)===qi.MULTIPOLYGON)return!0;return!1}containsSingleGeometryType(){return!1}}class O_{_triangleOffsets;_indexBuffer;_vertexBuffer;_topologyVector;constructor(e,n,h,m){this._triangleOffsets=e,this._indexBuffer=n,this._vertexBuffer=h,this._topologyVector=m}get triangleOffsets(){return this._triangleOffsets}get indexBuffer(){return this._indexBuffer}get vertexBuffer(){return this._vertexBuffer}get topologyVector(){return this._topologyVector}getGeometries(){if(!this._topologyVector)throw new Error("Cannot convert GpuVector to coordinates without topology information");const e=new Array(this.numGeometries),n=this._topologyVector,h=n.partOffsets,m=n.ringOffsets,y=n.geometryOffsets;let v=0,E=1,k=1,P=1;for(let z=0;z<this.numGeometries;z++)switch(this.geometryType(z)){case qi.POLYGON:{const G=h[E]-h[E-1];E++;const W=[];for(let K=0;K<G;K++){const ie=m[k]-m[k-1];k++;const oe=[];for(let ue=0;ue<ie;ue++){const be=this._vertexBuffer[v++],We=this._vertexBuffer[v++];oe.push(new C(be,We))}oe.length>0&&oe.push(oe[0]),W.push(oe)}e[z]=W,y&&P++}break;case qi.MULTIPOLYGON:{const G=y[P]-y[P-1];P++;const W=[];for(let K=0;K<G;K++){const ie=h[E]-h[E-1];E++;for(let oe=0;oe<ie;oe++){const ue=m[k]-m[k-1];k++;const be=[];for(let We=0;We<ue;We++){const Se=this._vertexBuffer[v++],De=this._vertexBuffer[v++];be.push(new C(Se,De))}be.length>0&&be.push(be[0]),W.push(be)}}e[z]=W}}return e}[Symbol.iterator](){return null}}function cd(a,e,n,h,m,y){return new Wx(a,e,n,h,m,y)}class Wx extends O_{_numGeometries;_geometryType;constructor(e,n,h,m,y,v){super(h,m,y,v),this._numGeometries=e,this._geometryType=n}geometryType(e){return this._geometryType}get numGeometries(){return this._numGeometries}containsSingleGeometryType(){return!0}}function eg(a,e,n,h,m){return new B_(a,e,n,h,m)}class B_ extends O_{_geometryTypes;constructor(e,n,h,m,y){super(n,h,m,y),this._geometryTypes=e}geometryType(e){return this._geometryTypes[e]}get numGeometries(){return this._geometryTypes.length}containsSingleGeometryType(){return!1}}function N_(a,e,n,h,m){const y=Zs(a,n);let v=null,E=null,k=null,P=null,z=null,G=null,W=null,K=null;if(Gu(y,h,a,n)===xi.CONST){const oe=Zm(a,n,y,!1);for(let ue=0;ue<e-1;ue++){const be=Zs(a,n);switch(be.physicalStreamType){case ps.LENGTH:switch(be.logicalStreamType.lengthType){case qs.GEOMETRIES:v=Ih(a,n,be);break;case qs.PARTS:E=Ih(a,n,be);break;case qs.RINGS:k=Ih(a,n,be);break;case qs.TRIANGLES:W=Ih(a,n,be)}break;case ps.OFFSET:switch(be.logicalStreamType.offsetType){case Dh.VERTEX:P=Ws(a,n,be,!1);break;case Dh.INDEX:K=Ws(a,n,be,!1)}break;case ps.DATA:vc.VERTEX===be.logicalStreamType.dictionaryType?z=Ws(a,n,be,!0):(G={numBits:be.numBits,coordinateShift:be.coordinateShift},z=Ws(a,n,be,!1))}}return K!==null?v!=null||E!=null?cd(h,oe,W,K,z,new Hu(v,E,k)):cd(h,oe,W,K,z):G===null?(function(ue,be,We,Se,De){return new op(ue,be,co.VEC_2,We,Se,De)})(h,oe,new Hu(v,E,k),P,z):(function(ue,be,We,Se,De,Je){return new op(ue,be,co.MORTON,We,Se,De,Je)})(h,oe,new Hu(v,E,k),P,z,G)}const ie=Ws(a,n,y,!1);for(let oe=0;oe<e-1;oe++){const ue=Zs(a,n);switch(ue.physicalStreamType){case ps.LENGTH:switch(ue.logicalStreamType.lengthType){case qs.GEOMETRIES:v=Ws(a,n,ue,!1);break;case qs.PARTS:E=Ws(a,n,ue,!1);break;case qs.RINGS:k=Ws(a,n,ue,!1);break;case qs.TRIANGLES:W=Ih(a,n,ue)}break;case ps.OFFSET:switch(ue.logicalStreamType.offsetType){case Dh.VERTEX:P=Ws(a,n,ue,!1);break;case Dh.INDEX:K=Ws(a,n,ue,!1)}break;case ps.DATA:vc.VERTEX===ue.logicalStreamType.dictionaryType?z=Ws(a,n,ue,!0):(G={numBits:ue.numBits,coordinateShift:ue.coordinateShift},z=Ws(a,n,ue,!1))}}return K!==null&&E===null?eg(ie,W,K,z):(v!==null?(v=A0(ie,v,2),E!==null&&k!==null?(E=k0(ie,v,E,!1),k=(function(oe,ue,be,We){const Se=new Int32Array(be[be.length-1]+1);let De=0;Se[0]=De;let Je=1,at=1,St=0;for(let Xt=0;Xt<oe.length;Xt++){const Ut=oe[Xt],rr=ue[Xt+1]-ue[Xt];if(Ut!==0&&Ut!==3)for(let wr=0;wr<rr;wr++){const ar=be[Je]-be[Je-1];Je++;for(let Zt=0;Zt<ar;Zt++)De=Se[at++]=De+We[St++]}else for(let wr=0;wr<rr;wr++)Se[at++]=++De,Je++}return Se})(ie,v,E,k)):E!==null&&(E=(function(oe,ue,be){const We=new Int32Array(ue[ue.length-1]+1);let Se=0;We[0]=Se;let De=1,Je=0;for(let at=0;at<oe.length;at++){const St=oe[at],Xt=ue[at+1]-ue[at];if(St===4||St===1)for(let Ut=0;Ut<Xt;Ut++)Se=We[De++]=Se+be[Je++];else for(let Ut=0;Ut<Xt;Ut++)We[De++]=++Se}return We})(ie,v,E))):E!==null&&k!==null?(E=A0(ie,E,1),k=k0(ie,E,k,!0)):E!==null&&(E=A0(ie,E,0)),K!==null?eg(ie,W,K,z,new Hu(v,E,k)):G===null?(function(oe,ue,be,We){return new lp(co.VEC_2,oe,ue,be,We)})(ie,new Hu(v,E,k),P,z):(function(oe,ue,be,We,Se){return new lp(co.MORTON,oe,ue,be,We,Se)})(ie,new Hu(v,E,k),P,z,G))}function A0(a,e,n){const h=new Int32Array(a.length+1);let m=0;h[0]=m;let y=0;for(let v=0;v<a.length;v++)m=h[v+1]=m+(a[v]>n?e[y++]:1);return h}function k0(a,e,n,h){const m=new Int32Array(e[e.length-1]+1);let y=0;m[0]=y;let v=1,E=0;for(let k=0;k<a.length;k++){const P=a[k],z=e[k+1]-e[k];if(P===5||P===2||h&&(P===4||P===1))for(let G=0;G<z;G++)y=m[v++]=y+n[E++];else for(let G=0;G<z;G++)m[v++]=++y}return m}class j_ extends Ch{dataVector;constructor(e,n,h){super(e,n.getBuffer(),h),this.dataVector=n}getValueFromBuffer(e){return this.dataVector.get(e)}}class U_ extends y0{getValueFromBuffer(e){return this.dataBuffer[e]}}class cp extends Ch{constructor(e,n,h){super(e,BigInt64Array.of(n),h)}getValueFromBuffer(e){return this.dataBuffer[0]}}function up(a,e,n){return V_(a,Math.ceil(e/8),n)}function V_(a,e,n){const h=new Uint8Array(e);let m=0;for(;m<e;){const y=a[n.increment()];if(y<=127){const v=y+3,E=a[n.increment()],k=m+v;h.fill(E,m,k),m=k}else{const v=256-y;for(let E=0;E<v;E++)h[m++]=a[n.increment()]}}return h}const tg=new TextDecoder;function hp(a,e,n){return n-e>=12?tg.decode(a.subarray(e,n)):(function(h,m,y){let v="",E=m;for(;E<y;){const k=h[E];let P,z,G,W=null,K=k>239?4:k>223?3:k>191?2:1;if(E+K>y)break;K===1?k<128&&(W=k):K===2?(P=h[E+1],(192&P)==128&&(W=(31&k)<<6|63&P,W<=127&&(W=null))):K===3?(P=h[E+1],z=h[E+2],(192&P)==128&&(192&z)==128&&(W=(15&k)<<12|(63&P)<<6|63&z,(W<=2047||W>=55296&&W<=57343)&&(W=null))):K===4&&(P=h[E+1],z=h[E+2],G=h[E+3],(192&P)==128&&(192&z)==128&&(192&G)==128&&(W=(15&k)<<18|(63&P)<<12|(63&z)<<6|63&G,(W<=65535||W>=1114112)&&(W=null))),W===null?(W=65533,K=1):W>65535&&(W-=65536,v+=String.fromCharCode(W>>>10&1023|55296),W=56320|1023&W),v+=String.fromCharCode(W),E+=K}return v})(a,e,n)}class ud extends Ch{offsetBuffer;constructor(e,n,h,m){super(e,h,m),this.offsetBuffer=n}}class C0 extends ud{textEncoder;constructor(e,n,h,m){super(e,n,h,m??n.length-1),this.textEncoder=new TextEncoder}getValueFromBuffer(e){return hp(this.dataBuffer,this.offsetBuffer[e],this.offsetBuffer[e+1])}}class xf extends ud{indexBuffer;textEncoder;constructor(e,n,h,m,y){super(e,h,m,y??n.length),this.indexBuffer=n,this.indexBuffer=n,this.textEncoder=new TextEncoder}getValueFromBuffer(e){const n=this.indexBuffer[e];return hp(this.dataBuffer,this.offsetBuffer[n],this.offsetBuffer[n+1])}}class M0 extends ud{indexBuffer;symbolOffsetBuffer;symbolTableBuffer;textEncoder;symbolLengthBuffer;lengthBuffer;decodedDictionary;constructor(e,n,h,m,y,v,E){super(e,h,m,E),this.indexBuffer=n,this.symbolOffsetBuffer=y,this.symbolTableBuffer=v,this.textEncoder=new TextEncoder}getValueFromBuffer(e){this.decodedDictionary==null&&(this.symbolLengthBuffer==null&&(this.symbolLengthBuffer=this.offsetToLengthBuffer(this.symbolOffsetBuffer),this.lengthBuffer=this.offsetToLengthBuffer(this.offsetBuffer)),this.decodedDictionary=(function(h,m,y){const v=[],E=new Array(m.length).fill(0);for(let k=1;k<m.length;k++)E[k]=E[k-1]+m[k-1];for(let k=0;k<y.length;k++)if(y[k]===255)v.push(y[++k]);else{const P=m[y[k]],z=E[y[k]];for(let G=0;G<P;G++)v.push(h[z+G])}return new Uint8Array(v)})(this.symbolTableBuffer,this.symbolLengthBuffer,this.dataBuffer));const n=this.indexBuffer[e];return hp(this.decodedDictionary,this.offsetBuffer[n],this.offsetBuffer[n+1])}offsetToLengthBuffer(e){const n=new Uint32Array(e.length-1);let h=e[0];for(let m=1;m<e.length;m++){const y=e[m];n[m-1]=y-h,h=y}return n}}function Ph(a,e,n,h,m,y){return n.type==="scalarType"?(function(v,E,k,P,z,G){let W=null,K=0;if(v===0)return null;if(G.nullable){const oe=Zs(E,k);K=oe.numValues;const ue=k.get(),be=up(E,K,k);k.set(ue+oe.byteLength),W=new bc(be,oe.numValues)}const ie=W??P;switch(z.physicalType){case 4:case 3:return(function(oe,ue,be,We,Se){const De=Zs(oe,ue),Je=Gu(De,Se,oe,ue),at=We.physicalType===3;if(Je===xi.FLAT){const St=Hl(Se)?Xm(oe,ue,De,at,Se):Ws(oe,ue,De,at);return new v0(be.name,St,Se)}if(Je===xi.SEQUENCE){const St=Wm(oe,ue,De);return new Vm(be.name,St[0],St[1],De.numRleValues)}{const St=Zm(oe,ue,De,at);return new Gm(be.name,St,Se)}})(E,k,G,z,ie);case 9:return(function(oe,ue,be,We,Se){let De=null,Je=null,at=null,St=null,Xt=null,Ut=null,rr=null,wr=null;for(let ar=0;ar<We;ar++){const Zt=Zs(ue,be);if(Zt.byteLength!==0)switch(Zt.physicalStreamType){case ps.PRESENT:{const Ft=up(ue,Zt.numValues,be);Ut=new bc(Ft,Zt.numValues);break}case ps.OFFSET:Je=Se!=null||Ut!=null?Xm(ue,be,Zt,!1,Se??Ut):Ws(ue,be,Zt,!1);break;case ps.LENGTH:{const Ft=Ih(ue,be,Zt);qs.DICTIONARY===Zt.logicalStreamType.lengthType?De=Ft:qs.SYMBOL===Zt.logicalStreamType.lengthType?St=Ft:rr=Ft;break}case ps.DATA:{const Ft=ue.subarray(be.get(),be.get()+Zt.byteLength);be.add(Zt.byteLength);const Ir=Zt.logicalStreamType.dictionaryType;vc.FSST===Ir?Xt=Ft:vc.SINGLE===Ir||vc.SHARED===Ir?at=Ft:vc.NONE===Ir&&(wr=Ft);break}}}return(function(ar,Zt,Ft,Ir,Mr,Lr,Ar){return Zt?new M0(ar,Ft,Ir,Mr,Lr,Zt,Ar):null})(oe,Xt,Je,De,at,St,Se??Ut)??(function(ar,Zt,Ft,Ir,Mr){return Zt?Mr?new xf(ar,Ft,Ir,Zt,Mr):new xf(ar,Ft,Ir,Zt):null})(oe,at,Je,De,Se??Ut)??(function(ar,Zt,Ft,Ir,Mr){if(!Zt||!Ft)return null;if(Ir)return Mr?new xf(ar,Ir,Zt,Ft,Mr):new xf(ar,Ir,Zt,Ft);if(Mr&&Mr.size()!==Zt.length-1){const Lr=new Int32Array(Mr.size());let Ar=0;for(let Yr=0;Yr<Mr.size();Yr++)Lr[Yr]=Mr.get(Yr)?Ar++:0;return new xf(ar,Lr,Zt,Ft,Mr)}return Mr?new C0(ar,Zt,Ft,Mr):new C0(ar,Zt,Ft)})(oe,rr,wr,Je,Se??Ut)})(G.name,E,k,G.nullable?v-1:v,W);case 0:return(function(oe,ue,be,We,Se){const De=Zs(oe,ue),Je=De.numValues,at=ue.get(),St=Hl(Se)?(function(Ut,rr,wr,ar){const Zt=V_(Ut,Math.ceil(rr/8),wr),Ft=new bc(Zt,rr),Ir=ar.size(),Mr=new bc(new Uint8Array(Ir),Ir);let Lr=0;for(let Ar=0;Ar<ar.size();Ar++){const Yr=!!ar.get(Ar)&&Ft.get(Lr++);Mr.set(Ar,Yr)}return Mr.getBuffer()})(oe,Je,ue,Se):up(oe,Je,ue);ue.set(at+De.byteLength);const Xt=new bc(St,Je);return new j_(be.name,Xt,Se)})(E,k,G,0,ie);case 6:case 5:return(function(oe,ue,be,We,Se){const De=Zs(oe,ue),Je=Gu(De,We,oe,ue),at=Se.physicalType===5;if(Je===xi.FLAT){const St=Hl(We)?(function(Xt,Ut,rr,wr,ar){return(function(Zt,Ft,Ir,Mr){switch(Ft.logicalLevelTechnique1){case An.DELTA:return Ft.logicalLevelTechnique2===An.RLE&&(Zt=L_(Zt,Ft.runs,Ft.numRleValues)),(function(Lr,Ar){const Yr=new BigInt64Array(Lr.size());let Gn=0;Lr.get(0)?(Yr[0]=Lr.get(0)?Ar[0]>>1n^-(1n&Ar[0]):0n,Gn=1):Yr[0]=0n;let Rn=1;for(;Rn!=Yr.length;++Rn)Yr[Rn]=Lr.get(Rn)?Yr[Rn-1]+(Ar[Gn]>>1n^-(1n&Ar[Gn++])):Yr[Rn-1];return Yr})(Mr,Zt);case An.RLE:return(function(Lr,Ar,Yr,Gn){const Rn=Ar;return Yr?(function(Ja,$s,Wi){const Qa=new BigInt64Array(Ja.size());let Ha=0;for(let oa=0;oa<Wi;oa++){const hi=Number($s[oa]);let yi=$s[oa+Wi];yi=yi>>1n^-(1n&yi);for(let Oa=Ha;Oa<Ha+hi;Oa++)Ja.get(Oa)?Qa[Oa]=yi:(Qa[Oa]=0n,Ha++);Ha+=hi}return Qa})(Gn,Lr,Rn.runs):(function(Ja,$s,Wi){const Qa=new BigInt64Array(Ja.size());let Ha=0;for(let oa=0;oa<Wi;oa++){const hi=Number($s[oa]),yi=$s[oa+Wi];for(let Oa=Ha;Oa<Ha+hi;Oa++)Ja.get(Oa)?Qa[Oa]=yi:(Qa[Oa]=0n,Ha++);Ha+=hi}return Qa})(Gn,Lr,Rn.runs)})(Zt,Ft,Ir,Mr);case An.NONE:return Zt=Ir?(function(Lr,Ar){const Yr=new BigInt64Array(Lr.size());let Gn=0,Rn=0;for(;Rn!=Yr.length;++Rn)if(Lr.get(Rn)){const Ja=Ar[Gn++];Yr[Rn]=Ja>>1n^-(1n&Ja)}else Yr[Rn]=0n;return Yr})(Mr,Zt):(function(Lr,Ar){const Yr=new BigInt64Array(Lr.size());let Gn=0,Rn=0;for(;Rn!=Yr.length;++Rn)Yr[Rn]=Lr.get(Rn)?Ar[Gn++]:0n;return Yr})(Mr,Zt),Zt;default:throw new Error("The specified Logical level technique is not supported")}})(tp(Xt,Ut,rr.numValues),rr,wr,ar)})(oe,ue,De,at,We):od(oe,ue,De,at);return new ld(be.name,St,We)}if(Je===xi.SEQUENCE){const St=_f(oe,ue,De);return new Ym(be.name,St[0],St[1],De.numRleValues)}{const St=$m(oe,ue,De,at);return new cp(be.name,St,We)}})(E,k,G,ie,z);case 7:return(function(oe,ue,be,We){const Se=Zs(oe,ue),De=Hl(We)?(function(Je,at,St,Xt){const Ut=at.get(),rr=Ut+Xt*Float32Array.BYTES_PER_ELEMENT,wr=new Uint8Array(Je.subarray(Ut,rr)).buffer,ar=new Float32Array(wr);at.set(rr);const Zt=St.size(),Ft=new Float32Array(Zt);let Ir=0;for(let Mr=0;Mr<Zt;Mr++)Ft[Mr]=St.get(Mr)?ar[Ir++]:0;return Ft})(oe,ue,We,Se.numValues):(function(Je,at,St){const Xt=at.get(),Ut=Xt+St*Float32Array.BYTES_PER_ELEMENT,rr=new Uint8Array(Je.subarray(Xt,Ut)).buffer,wr=new Float32Array(rr);return at.set(Ut),wr})(oe,ue,Se.numValues);return new U_(be.name,De,We)})(E,k,G,ie);case 8:return(function(oe,ue,be,We){const Se=Zs(oe,ue),De=Hl(We)?(function(Je,at,St,Xt){const Ut=at.get(),rr=Ut+Xt*Float64Array.BYTES_PER_ELEMENT,wr=new Uint8Array(Je.subarray(Ut,rr)).buffer,ar=new Float64Array(wr);at.set(rr);const Zt=St.size(),Ft=new Float64Array(Zt);let Ir=0;for(let Mr=0;Mr<Zt;Mr++)Ft[Mr]=St.get(Mr)?ar[Ir++]:0;return Ft})(oe,ue,We,Se.numValues):(function(Je,at,St){const Xt=at.get(),Ut=Xt+St*Float64Array.BYTES_PER_ELEMENT,rr=new Uint8Array(Je.subarray(Xt,Ut)).buffer,wr=new Float64Array(rr);return at.set(Ut),wr})(oe,ue,Se.numValues);return new jm(be.name,De,We)})(E,k,G,ie);default:throw new Error(`The specified data type for the field is currently not supported: ${z}`)}})(h,a,e,m,n.scalarType,n):h!=1?null:(function(v,E,k,P){let z=null,G=null,W=null,K=null,ie=!1;for(;!ie;){const We=Zs(v,E);switch(We.physicalStreamType){case ps.LENGTH:qs.DICTIONARY===We.logicalStreamType.lengthType?z=Ih(v,E,We):W=Ih(v,E,We);break;case ps.DATA:vc.SINGLE===We.logicalStreamType.dictionaryType||vc.SHARED===We.logicalStreamType.dictionaryType?(G=v.subarray(E.get(),E.get()+We.byteLength),ie=!0):K=v.subarray(E.get(),E.get()+We.byteLength),E.add(We.byteLength)}}const oe=k.complexType.children,ue=[];let be=0;for(const We of oe){const Se=Zi(v,E,1)[0];if(Se==0)continue;const De=`${k.name}${We.name==="default"?"":":"+We.name}`;if(Se!==2||We.type!=="scalarField"||We.scalarField.physicalType!==9)throw new Error("Currently only optional string fields are implemented for a struct.");const Je=Zs(v,E),at=up(v,Je.numValues,E),St=Zs(v,E),Xt=St.decompressedCount!==P?Xm(v,E,St,!1,new bc(at,Je.numValues)):Ws(v,E,St,!1);ue[be++]=K?new M0(De,Xt,z,G,W,K,new bc(at,Je.numValues)):new xf(De,Xt,z,G,new bc(at,Je.numValues))}return ue})(a,e,n,m)}function Hl(a){return a instanceof bc}function Fh(a){if(a.name==="id")return!1;if(a.type==="scalarType"){const e=a.scalarType;if(e.type==="physicalType")switch(e.physicalType){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:default:return!1;case 9:return!0}else if(e.type==="logicalType")return!1}else if(a.type==="complexType"){const e=a.complexType;if(e.type==="physicalType")switch(e.physicalType){case 0:case 1:return!0;default:return!1}}return console.warn("Unexpected column type in hasStreamCount",a),!1}const fp=new TextDecoder;function hd(a,e){const n=Zi(a,e,1)[0];if(n===0)return"";const h=e.get(),m=a.subarray(h,h+n);return e.add(n),fp.decode(m)}function qu(a,e){const n=Zi(a,e,1)[0]>>>0,h=!!(4&n),m=!!(2&n),y=Zi(a,e,1)[0]>>>0,v={};if(1&n&&(v.nullable=!0),m){const E={};if(h?(E.type="logicalType",E.logicalType=y):(E.type="physicalType",E.physicalType=y),8&n){const k=Zi(a,e,1)[0]>>>0;E.children=new Array(k);for(let P=0;P<k;P++)E.children[P]=qu(a,e)}v.type="complexField",v.complexField=E}else{const E={};h?(E.type="logicalType",E.logicalType=y):(E.type="physicalType",E.physicalType=y),v.type="scalarField",v.scalarField=E}return v}function $x(a,e){const n=Zi(a,e,1)[0]>>>0,h=(function(m){switch(m){case 0:case 1:case 2:case 3:{const y={};y.nullable=!!(1&m),y.columnScope=0;const v={};return v.physicalType=m>1?6:4,v.type="physicalType",y.scalarType=v,y.type="scalarType",y}case 4:{const y={nullable:!1,columnScope:0},v={type:"physicalType",physicalType:0};return y.type="complexType",y.complexType=v,y}case 30:{const y={nullable:!1,columnScope:0},v={type:"physicalType",physicalType:1};return y.type="complexType",y.complexType=v,y}default:return(function(y){let v=null;switch(y){case 10:case 11:v=0;break;case 12:case 13:v=1;break;case 14:case 15:v=2;break;case 16:case 17:v=3;break;case 18:case 19:v=4;break;case 20:case 21:v=5;break;case 22:case 23:v=6;break;case 24:case 25:v=7;break;case 26:case 27:v=8;break;case 28:case 29:v=9;break;default:return null}const E={};E.nullable=!!(1&y),E.columnScope=0;const k={type:"physicalType"};return k.physicalType=v,E.type="scalarType",E.scalarType=k,E})(m)}})(n);if(!h)throw new Error(`Unsupported column type code: ${n}`);if((function(m){return m>=10})(n)?h.name=hd(a,e):n>=0&&n<=3?h.name="id":n===4&&(h.name="geometry"),(function(m){return m===30})(n)){const m=Zi(a,e,1)[0]>>>0,y=h.complexType;y.children=new Array(m);for(let v=0;v<m;v++)y.children[v]=qu(a,e)}return h}function G_(a,e){const n={featureTables:[]},h={};h.name=hd(a,e);const m=Zi(a,e,1)[0]>>>0,y=Zi(a,e,1)[0]>>>0;h.columns=new Array(y);for(let v=0;v<y;v++)h.columns[v]=$x(a,e);return n.featureTables.push(h),[n,m]}function dp(a,e,n,h,m,y,v=!1){const E=e.scalarType.physicalType,k=Gu(m,y,a,n);if(E===4)switch(k){case xi.FLAT:{const P=Ws(a,n,m,!1);return new v0(h,P,y)}case xi.SEQUENCE:{const P=Wm(a,n,m);return new Vm(h,P[0],P[1],m.numRleValues)}case xi.CONST:{const P=Zm(a,n,m,!1);return new Gm(h,P,y)}}else switch(k){case xi.FLAT:{if(v){const z=(function(G,W,K,ie){const oe=(function(ue,be,We){const Se=new Float64Array(be);for(let De=0;De<be;De++)Se[De]=F_(ue,We);return Se})(G,K.numValues,W);return(function(ue,be,We){switch(be.logicalLevelTechnique1){case An.DELTA:return be.logicalLevelTechnique2===An.RLE&&(ue=z_(ue,be.runs,be.numRleValues)),(function(Se){Se[0]=Se[0]%2==1?(Se[0]+1)/-2:Se[0]/2;const De=Se.length/4*4;let Je=1;if(De>=4)for(;Je<De-4;Je+=4){const at=Se[Je],St=Se[Je+1],Xt=Se[Je+2],Ut=Se[Je+3];Se[Je]=(at%2==1?(at+1)/-2:at/2)+Se[Je-1],Se[Je+1]=(St%2==1?(St+1)/-2:St/2)+Se[Je],Se[Je+2]=(Xt%2==1?(Xt+1)/-2:Xt/2)+Se[Je+1],Se[Je+3]=(Ut%2==1?(Ut+1)/-2:Ut/2)+Se[Je+2]}for(;Je!=Se.length;++Je)Se[Je]=(Se[Je]%2==1?(Se[Je]+1)/-2:Se[Je]/2)+Se[Je-1]})(ue),ue;case An.RLE:return(function(Se,De,Je){return z_(Se,De.runs,De.numRleValues)})(ue,be);case An.NONE:return ue;default:throw new Error(`The specified Logical level technique is not supported: ${be.logicalLevelTechnique1}`)}})(oe,K)})(a,n,m);return new jm(h,z,y)}const P=od(a,n,m,!1);return new ld(h,P,y)}case xi.SEQUENCE:{const P=_f(a,n,m);return new Ym(h,P[0],P[1],m.numRleValues)}case xi.CONST:{const P=$m(a,n,m,!1);return new cp(h,P,y)}}throw new Error("Vector type not supported for id column.")}class Xx{constructor(e,n){var h;switch(this._featureData=e,this.properties=this._featureData.properties||{},(h=this._featureData.geometry)===null||h===void 0?void 0:h.type){case qi.POINT:case qi.MULTIPOINT:this.type=1;break;case qi.LINESTRING:case qi.MULTILINESTRING:this.type=2;break;case qi.POLYGON:case qi.MULTIPOLYGON:this.type=3;break;default:this.type=0}this.extent=n,this.id=Number(this._featureData.id)}loadGeometry(){const e=[];for(const n of this._featureData.geometry.coordinates){const h=[];for(const m of n)h.push(new C(m.x,m.y));e.push(h)}return e}}class H_{constructor(e){this.features=[],this.featureTable=e,this.name=e.name,this.extent=e.extent,this.version=2,this.features=e.getFeatures(),this.length=this.features.length}feature(e){return new Xx(this.features[e],this.extent)}}class pp{constructor(e){this.layers={};const n=(function(h,m,y=!0){const v=new P_(0),E=[];for(;v.get()<h.length;){const k=Zi(h,v,1)[0]>>>0,P=v.get()+k;if(P>h.length)throw new Error(`Block overruns tile: ${P} > ${h.length}`);if(Zi(h,v,1)[0]>>>0!=1){v.set(P);continue}const z=G_(h,v),G=z[1],W=z[0].featureTables[0];let K=null,ie=null;const oe=[];let ue=0;for(const We of W.columns){const Se=We.name;if(Se==="id"){let De=null;if(We.nullable){const at=Zs(h,v),St=v.get(),Xt=up(h,at.numValues,v);v.set(St+at.byteLength),De=new bc(Xt,at.numValues)}const Je=Zs(h,v);ue=Je.decompressedCount,K=dp(h,We,v,Se,Je,De??ue,y)}else if(Se==="geometry"){const De=Zi(h,v,1)[0];if(ue===0){const Je=v.get();ue=Zs(h,v).decompressedCount,v.set(Je)}ie=N_(h,De,v,ue)}else{const De=Fh(We)?Zi(h,v,1)[0]:1;if(De===0&&We.type==="scalarType")continue;const Je=Ph(h,v,We,De,ue);if(Je)if(Array.isArray(Je))for(const at of Je)oe.push(at);else oe.push(Je)}}const be=new Mh(W.name,ie,K,oe,G);E.push(be),v.set(P)}return E})(new Uint8Array(e));this.layers=n.reduce(((h,m)=>Object.assign(Object.assign({},h),{[m.name]:new H_(m)})),{})}}class q_{constructor(e,n){this.feature=e,this.type=e.type,this.properties=e.tags?e.tags:{},this.extent=n,"id"in e&&(typeof e.id=="string"?this.id=parseInt(e.id,10):typeof e.id!="number"||isNaN(e.id)||(this.id=e.id))}loadGeometry(){const e=[],n=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const h of n){const m=[];for(const y of h)m.push(new C(y[0],y[1]));e.push(m)}return e}}const mp="_geojsonTileLayer";function D0(a,e){e.writeVarintField(15,a.version||1),e.writeStringField(1,a.name||""),e.writeVarintField(5,a.extent||4096);const n={keys:[],values:[],keycache:{},valuecache:{}};for(let y=0;y<a.length;y++)n.feature=a.feature(y),e.writeMessage(2,R0,n);const h=n.keys;for(const y of h)e.writeStringField(3,y);const m=n.values;for(const y of m)e.writeMessage(4,I0,y)}function R0(a,e){if(!a.feature)return;const n=a.feature;n.id!==void 0&&e.writeVarintField(1,n.id),e.writeMessage(2,Z_,a),e.writeVarintField(3,n.type),e.writeMessage(4,ng,n)}function Z_(a,e){for(const n in a.feature?.properties){let h=a.feature.properties[n],m=a.keycache[n];if(h==null)continue;m===void 0&&(a.keys.push(n),m=a.keys.length-1,a.keycache[n]=m),e.writeVarint(m),typeof h!="string"&&typeof h!="boolean"&&typeof h!="number"&&(h=JSON.stringify(h));const y=typeof h+":"+h;let v=a.valuecache[y];v===void 0&&(a.values.push(h),v=a.values.length-1,a.valuecache[y]=v),e.writeVarint(v)}}function Lh(a,e){return(e<<3)+(7&a)}function rg(a){return a<<1^a>>31}function ng(a,e){const n=a.loadGeometry(),h=a.type;let m=0,y=0;for(const v of n){let E=1;h===1&&(E=v.length),e.writeVarint(Lh(1,E));const k=h===3?v.length-1:v.length;for(let P=0;P<k;P++){P===1&&h!==1&&e.writeVarint(Lh(2,k-1));const z=v[P].x-m,G=v[P].y-y;e.writeVarint(rg(z)),e.writeVarint(rg(G)),m+=z,y+=G}a.type===3&&e.writeVarint(Lh(7,1))}}function I0(a,e){const n=typeof a;n==="string"?e.writeStringField(1,a):n==="boolean"?e.writeBooleanField(7,a):n==="number"&&(a%1!=0?e.writeDoubleField(3,a):a<0?e.writeSVarintField(6,a):e.writeVarintField(5,a))}class ag{constructor(e,n){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Gc(Oe,16,0),this.grid3D=new Gc(Oe,16,0),this.featureIndexArray=new _e,this.promoteId=n}insert(e,n,h,m,y,v){const E=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,m,y);const k=v?this.grid3D:this.grid;for(let P=0;P<n.length;P++){const z=n[P],G=[1/0,1/0,-1/0,-1/0];for(let W=0;W<z.length;W++){const K=z[W];G[0]=Math.min(G[0],K.x),G[1]=Math.min(G[1],K.y),G[2]=Math.max(G[2],K.x),G[3]=Math.max(G[3],K.y)}G[0]<Oe&&G[1]<Oe&&G[2]>=0&&G[3]>=0&&k.insert(E,G[0],G[1],G[2],G[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=this.encoding!=="mlt"?new jn(new a0(this.rawTileData)).layers:new pp(this.rawTileData).layers,this.sourceLayerCoder=new Nm(this.vtLayers?Object.keys(this.vtLayers).sort():[mp])),this.vtLayers}query(e,n,h,m){this.loadVTLayers();const y=e.params,v=Oe/e.tileSize/e.scale,E=sn(y.filter,y.globalState),k=e.queryGeometry,P=e.queryPadding*v,z=kh.fromPoints(k),G=this.grid.query(z.minX-P,z.minY-P,z.maxX+P,z.maxY+P),W=kh.fromPoints(e.cameraQueryGeometry).expandBy(P),K=this.grid3D.query(W.minX,W.minY,W.maxX,W.maxY,((ue,be,We,Se)=>(function(De,Je,at,St,Xt){for(const rr of De)if(Je<=rr.x&&at<=rr.y&&St>=rr.x&&Xt>=rr.y)return!0;const Ut=[new C(Je,at),new C(Je,Xt),new C(St,Xt),new C(St,at)];if(De.length>2){for(const rr of Ut)if($c(De,rr))return!0}for(let rr=0;rr<De.length-1;rr++)if(Kg(De[rr],De[rr+1],Ut))return!0;return!1})(e.cameraQueryGeometry,ue-P,be-P,We+P,Se+P)));for(const ue of K)G.push(ue);G.sort(P0);const ie={};let oe;for(let ue=0;ue<G.length;ue++){const be=G[ue];if(be===oe)continue;oe=be;const We=this.featureIndexArray.get(be);let Se=null;this.loadMatchingFeature(ie,We.bucketIndex,We.sourceLayerIndex,We.featureIndex,E,y.layers,y.availableImages,n,h,m,((De,Je,at)=>(Se||(Se=mc(De)),Je.queryIntersectsFeature({queryGeometry:k,feature:De,featureState:at,geometry:Se,zoom:this.z,transform:e.transform,pixelsToTileUnits:v,pixelPosMatrix:e.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:e.getElevation}))))}return ie}loadMatchingFeature(e,n,h,m,y,v,E,k,P,z,G){const W=this.bucketLayerIDs[n];if(v&&!W.some((ue=>v.has(ue))))return;const K=this.sourceLayerCoder.decode(h),ie=this.vtLayers[K].feature(m);if(y.needGeometry){const ue=pl(ie,!0);if(!y.filter(new Qn(this.tileID.overscaledZ),ue,this.tileID.canonical))return}else if(!y.filter(new Qn(this.tileID.overscaledZ),ie))return;const oe=this.getId(ie,K);for(let ue=0;ue<W.length;ue++){const be=W[ue];if(v&&!v.has(be))continue;const We=k[be];if(!We)continue;let Se={};oe&&z&&(Se=z.getState(We.sourceLayer||mp,oe));const De=Vt({},P[be]);De.paint=W_(De.paint,We.paint,ie,Se,E),De.layout=W_(De.layout,We.layout,ie,Se,E);const Je=!G||G(ie,We,Se);if(!Je)continue;const at=new x0(ie,this.z,this.x,this.y,oe);at.layer=De;let St=e[be];St===void 0&&(St=e[be]=[]),St.push({featureIndex:m,feature:at,intersectionZ:Je})}}lookupSymbolFeatures(e,n,h,m,y,v,E,k){const P={};this.loadVTLayers();const z=sn(y.filterSpec,y.globalState);for(const G of e)this.loadMatchingFeature(P,h,m,G,z,v,E,k,n);return P}hasLayer(e){for(const n of this.bucketLayerIDs)for(const h of n)if(e===h)return!0;return!1}getId(e,n){var h;let m=e.id;return this.promoteId&&(m=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[n]],typeof m=="boolean"&&(m=Number(m)),m===void 0&&(!((h=e.properties)===null||h===void 0)&&h.cluster)&&this.promoteId&&(m=Number(e.properties.cluster_id))),m}}function W_(a,e,n,h,m){return Yt(a,((y,v)=>{const E=e instanceof ku?e.get(v):null;return E&&E.evaluate?E.evaluate(n,h,m):E}))}function P0(a,e){return e-a}function i(a,e,n,h,m){const y=[];for(let v=0;v<a.length;v++){const E=a[v];let k;for(let P=0;P<E.length-1;P++){let z=E[P],G=E[P+1];z.x<e&&G.x<e||(z.x<e?z=new C(e,z.y+(e-z.x)/(G.x-z.x)*(G.y-z.y))._round():G.x<e&&(G=new C(e,z.y+(e-z.x)/(G.x-z.x)*(G.y-z.y))._round()),z.y<n&&G.y<n||(z.y<n?z=new C(z.x+(n-z.y)/(G.y-z.y)*(G.x-z.x),n)._round():G.y<n&&(G=new C(z.x+(n-z.y)/(G.y-z.y)*(G.x-z.x),n)._round()),z.x>=h&&G.x>=h||(z.x>=h?z=new C(h,z.y+(h-z.x)/(G.x-z.x)*(G.y-z.y))._round():G.x>=h&&(G=new C(h,z.y+(h-z.x)/(G.x-z.x)*(G.y-z.y))._round()),z.y>=m&&G.y>=m||(z.y>=m?z=new C(z.x+(m-z.y)/(G.y-z.y)*(G.x-z.x),m)._round():G.y>=m&&(G=new C(z.x+(m-z.y)/(G.y-z.y)*(G.x-z.x),m)._round()),k&&z.equals(k[k.length-1])||(k=[z],y.push(k)),k.push(G)))))}}return y}function c(a,e,n,h,m){switch(e){case 1:return(function(y,v,E,k){const P=[];for(const z of y)for(const G of z){const W=k===0?G.x:G.y;W>=v&&W<=E&&P.push([G])}return P})(a,n,h,m);case 2:return T(a,n,h,m,!1);case 3:return T(a,n,h,m,!0)}return[]}function g(a,e,n,h,m){const y=h===0?I:L;let v=[];const E=[];for(let z=0;z<a.length-1;z++){const G=a[z],W=a[z+1],K=h===0?G.x:G.y,ie=h===0?W.x:W.y;let oe=!1;K<e?ie>e&&v.push(y(G,W,e)):K>n?ie<n&&v.push(y(G,W,n)):v.push(G),ie<e&&K>=e&&(v.push(y(G,W,e)),oe=!0),ie>n&&K<=n&&(v.push(y(G,W,n)),oe=!0),!m&&oe&&(E.push(v),v=[])}const k=a.length-1,P=h===0?a[k].x:a[k].y;return P>=e&&P<=n&&v.push(a[k]),m&&v.length>0&&!v[0].equals(v[v.length-1])&&v.push(new C(v[0].x,v[0].y)),v.length>0&&E.push(v),E}function T(a,e,n,h,m){const y=[];for(const v of a){const E=g(v,e,n,h,m);E.length>0&&y.push(...E)}return y}function I(a,e,n){return new C(n,a.y+(n-a.x)/(e.x-a.x)*(e.y-a.y))}function L(a,e,n){return new C(a.x+(n-a.y)/(e.y-a.y)*(e.x-a.x),n)}Cr("FeatureIndex",ag,{omit:["rawTileData","sourceLayerCoder"]});class ae extends C{constructor(e,n,h,m){super(e,n),this.angle=h,m!==void 0&&(this.segment=m)}clone(){return new ae(this.x,this.y,this.angle,this.segment)}}function Ae(a,e,n,h,m){if(e.segment===void 0||n===0)return!0;let y=e,v=e.segment+1,E=0;for(;E>-n/2;){if(v--,v<0)return!1;E-=a[v].dist(y),y=a[v]}E+=a[v].dist(a[v+1]),v++;const k=[];let P=0;for(;E<n/2;){const z=a[v],G=a[v+1];if(!G)return!1;let W=a[v-1].angleTo(z)-z.angleTo(G);for(W=Math.abs((W+3*Math.PI)%(2*Math.PI)-Math.PI),k.push({distance:E,angleDelta:W}),P+=W;E-k[0].distance>h;)P-=k.shift().angleDelta;if(P>m)return!1;v++,E+=z.dist(G)}return!0}function ut(a){let e=0;for(let n=0;n<a.length-1;n++)e+=a[n].dist(a[n+1]);return e}function Lt(a,e,n){return a?.6*e*n:0}function er(a,e){return Math.max(a?a.right-a.left:0,e?e.right-e.left:0)}function sr(a,e,n,h,m,y){const v=Lt(n,m,y),E=er(n,h)*y;let k=0;const P=ut(a)/2;for(let z=0;z<a.length-1;z++){const G=a[z],W=a[z+1],K=G.dist(W);if(k+K>P){const ie=(P-k)/K,oe=ya.number(G.x,W.x,ie),ue=ya.number(G.y,W.y,ie),be=new ae(oe,ue,W.angleTo(G),z);return be._round(),!v||Ae(a,be,E,v,e)?be:void 0}k+=K}}function Ot(a,e,n,h,m,y,v,E,k){const P=Lt(h,y,v),z=er(h,m),G=z*v,W=a[0].x===0||a[0].x===k||a[0].y===0||a[0].y===k;return e-G<e/4&&(e=G+e/4),qt(a,W?e/2*E%e:(z/2+2*y)*v*E%e,e,P,n,G,W,!1,k)}function qt(a,e,n,h,m,y,v,E,k){const P=y/2,z=ut(a);let G=0,W=e-n,K=[];for(let ie=0;ie<a.length-1;ie++){const oe=a[ie],ue=a[ie+1],be=oe.dist(ue),We=ue.angleTo(oe);for(;W+n<G+be;){W+=n;const Se=(W-G)/be,De=ya.number(oe.x,ue.x,Se),Je=ya.number(oe.y,ue.y,Se);if(De>=0&&De<k&&Je>=0&&Je<k&&W-P>=0&&W+P<=z){const at=new ae(De,Je,We,ie);at._round(),h&&!Ae(a,at,y,h,m)||K.push(at)}}G+=be}return E||K.length||v||(K=qt(a,G/2,n,h,m,y,v,!0,k)),K}function $r(a,e,n,h){const m=[],y=a.image,v=y.pixelRatio,E=y.paddedRect.w-2,k=y.paddedRect.h-2;let P={x1:a.left,y1:a.top,x2:a.right,y2:a.bottom};const z=y.stretchX||[[0,E]],G=y.stretchY||[[0,k]],W=(Ft,Ir)=>Ft+Ir[1]-Ir[0],K=z.reduce(W,0),ie=G.reduce(W,0),oe=E-K,ue=k-ie;let be=0,We=K,Se=0,De=ie,Je=0,at=oe,St=0,Xt=ue;if(y.content&&h){const Ft=y.content,Ir=Ft[2]-Ft[0],Mr=Ft[3]-Ft[1];(y.textFitWidth||y.textFitHeight)&&(P=Vu(a)),be=on(z,0,Ft[0]),Se=on(G,0,Ft[1]),We=on(z,Ft[0],Ft[2]),De=on(G,Ft[1],Ft[3]),Je=Ft[0]-be,St=Ft[1]-Se,at=Ir-We,Xt=Mr-De}const Ut=P.x1,rr=P.y1,wr=P.x2-Ut,ar=P.y2-rr,Zt=(Ft,Ir,Mr,Lr)=>{const Ar=wt(Ft.stretch-be,We,wr,Ut),Yr=mt(Ft.fixed-Je,at,Ft.stretch,K),Gn=wt(Ir.stretch-Se,De,ar,rr),Rn=mt(Ir.fixed-St,Xt,Ir.stretch,ie),Ja=wt(Mr.stretch-be,We,wr,Ut),$s=mt(Mr.fixed-Je,at,Mr.stretch,K),Wi=wt(Lr.stretch-Se,De,ar,rr),Qa=mt(Lr.fixed-St,Xt,Lr.stretch,ie),Ha=new C(Ar,Gn),oa=new C(Ja,Gn),hi=new C(Ja,Wi),yi=new C(Ar,Wi),Oa=new C(Yr/v,Rn/v),xl=new C($s/v,Qa/v),Xs=e*Math.PI/180;if(Xs){const gs=Math.sin(Xs),ii=Math.cos(Xs),$i=[ii,-gs,gs,ii];Ha._matMult($i),oa._matMult($i),yi._matMult($i),hi._matMult($i)}const yl=Ft.stretch+Ft.fixed,eu=Ir.stretch+Ir.fixed;return{tl:Ha,tr:oa,bl:yi,br:hi,tex:{x:y.paddedRect.x+1+yl,y:y.paddedRect.y+1+eu,w:Mr.stretch+Mr.fixed-yl,h:Lr.stretch+Lr.fixed-eu},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Oa,pixelOffsetBR:xl,minFontScaleX:at/v/wr,minFontScaleY:Xt/v/ar,isSDF:n}};if(h&&(y.stretchX||y.stretchY)){const Ft=Sa(z,oe,K),Ir=Sa(G,ue,ie);for(let Mr=0;Mr<Ft.length-1;Mr++){const Lr=Ft[Mr],Ar=Ft[Mr+1];for(let Yr=0;Yr<Ir.length-1;Yr++)m.push(Zt(Lr,Ir[Yr],Ar,Ir[Yr+1]))}}else m.push(Zt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:E+1},{fixed:0,stretch:k+1}));return m}function on(a,e,n){let h=0;for(const m of a)h+=Math.max(e,Math.min(n,m[1]))-Math.max(e,Math.min(n,m[0]));return h}function Sa(a,e,n){const h=[{fixed:-1,stretch:0}];for(const[m,y]of a){const v=h[h.length-1];h.push({fixed:m-v.stretch,stretch:v.stretch}),h.push({fixed:m-v.stretch,stretch:v.stretch+(y-m)})}return h.push({fixed:e+1,stretch:n}),h}function wt(a,e,n,h){return a/e*n+h}function mt(a,e,n,h){return a-e*n/h}Cr("Anchor",ae);class Pt{constructor(e,n,h,m,y,v,E,k,P,z){var G;if(this.boxStartIndex=e.length,P){let W=v.top,K=v.bottom;const ie=v.collisionPadding;ie&&(W-=ie[1],K+=ie[3]);let oe=K-W;oe>0&&(oe=Math.max(10,oe),this.circleDiameter=oe)}else{const W=!((G=v.image)===null||G===void 0)&&G.content&&(v.image.textFitWidth||v.image.textFitHeight)?Vu(v):{x1:v.left,y1:v.top,x2:v.right,y2:v.bottom};W.y1=W.y1*E-k[0],W.y2=W.y2*E+k[2],W.x1=W.x1*E-k[3],W.x2=W.x2*E+k[1];const K=v.collisionPadding;if(K&&(W.x1-=K[0]*E,W.y1-=K[1]*E,W.x2+=K[2]*E,W.y2+=K[3]*E),z){const ie=new C(W.x1,W.y1),oe=new C(W.x2,W.y1),ue=new C(W.x1,W.y2),be=new C(W.x2,W.y2),We=z*Math.PI/180;ie._rotate(We),oe._rotate(We),ue._rotate(We),be._rotate(We),W.x1=Math.min(ie.x,oe.x,ue.x,be.x),W.x2=Math.max(ie.x,oe.x,ue.x,be.x),W.y1=Math.min(ie.y,oe.y,ue.y,be.y),W.y2=Math.max(ie.y,oe.y,ue.y,be.y)}e.emplaceBack(n.x,n.y,W.x1,W.y1,W.x2,W.y2,h,m,y)}this.boxEndIndex=e.length}}class nr{constructor(e=[],n=(h,m)=>h<m?-1:h>m?1:0){if(this.data=e,this.length=this.data.length,this.compare=n,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;const e=this.data[0],n=this.data.pop();return--this.length>0&&(this.data[0]=n,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:n,compare:h}=this,m=n[e];for(;e>0;){const y=e-1>>1,v=n[y];if(h(m,v)>=0)break;n[e]=v,e=y}n[e]=m}_down(e){const{data:n,compare:h}=this,m=this.length>>1,y=n[e];for(;e<m;){let v=1+(e<<1);const E=v+1;if(E<this.length&&h(n[E],n[v])<0&&(v=E),h(n[v],y)>=0)break;n[e]=n[v],e=v}n[e]=y}}function an(a,e=1,n=!1){const h=kh.fromPoints(a[0]),m=Math.min(h.width(),h.height());let y=m/2;const v=new nr([],sa),{minX:E,minY:k,maxX:P,maxY:z}=h;if(m===0)return new C(E,k);for(let K=E;K<P;K+=m)for(let ie=k;ie<z;ie+=m)v.push(new Xr(K+y,ie+y,y,a));let G=(function(K){let ie=0,oe=0,ue=0;const be=K[0];for(let We=0,Se=be.length,De=Se-1;We<Se;De=We++){const Je=be[We],at=be[De],St=Je.x*at.y-at.x*Je.y;oe+=(Je.x+at.x)*St,ue+=(Je.y+at.y)*St,ie+=3*St}return new Xr(oe/ie,ue/ie,0,K)})(a),W=v.length;for(;v.length;){const K=v.pop();(K.d>G.d||!G.d)&&(G=K,n&&console.log("found best %d after %d probes",Math.round(1e4*K.d)/1e4,W)),K.max-G.d<=e||(y=K.h/2,v.push(new Xr(K.p.x-y,K.p.y-y,y,a)),v.push(new Xr(K.p.x+y,K.p.y-y,y,a)),v.push(new Xr(K.p.x-y,K.p.y+y,y,a)),v.push(new Xr(K.p.x+y,K.p.y+y,y,a)),W+=4)}return n&&(console.log(`num probes: ${W}`),console.log(`best distance: ${G.d}`)),G.p}function sa(a,e){return e.max-a.max}function Xr(a,e,n,h){this.p=new C(a,e),this.h=n,this.d=(function(m,y){let v=!1,E=1/0;for(let k=0;k<y.length;k++){const P=y[k];for(let z=0,G=P.length,W=G-1;z<G;W=z++){const K=P[z],ie=P[W];K.y>m.y!=ie.y>m.y&&m.x<(ie.x-K.x)*(m.y-K.y)/(ie.y-K.y)+K.x&&(v=!v),E=Math.min(E,om(m,K,ie))}}return(v?1:-1)*Math.sqrt(E)})(this.p,h),this.max=this.d+this.h*Math.SQRT2}var rn;_.aP=void 0,(rn=_.aP||(_.aP={}))[rn.center=1]="center",rn[rn.left=2]="left",rn[rn.right=3]="right",rn[rn.top=4]="top",rn[rn.bottom=5]="bottom",rn[rn["top-left"]=6]="top-left",rn[rn["top-right"]=7]="top-right",rn[rn["bottom-left"]=8]="bottom-left",rn[rn["bottom-right"]=9]="bottom-right";const On=Number.POSITIVE_INFINITY;function ta(a,e){return e[1]!==On?(function(n,h,m){let y=0,v=0;switch(h=Math.abs(h),m=Math.abs(m),n){case"top-right":case"top-left":case"top":v=m-7;break;case"bottom-right":case"bottom-left":case"bottom":v=7-m}switch(n){case"top-right":case"bottom-right":case"right":y=-h;break;case"top-left":case"bottom-left":case"left":y=h}return[y,v]})(a,e[0],e[1]):(function(n,h){let m=0,y=0;h<0&&(h=0);const v=h/Math.SQRT2;switch(n){case"top-right":case"top-left":y=v-7;break;case"bottom-right":case"bottom-left":y=7-v;break;case"bottom":y=7-h;break;case"top":y=h-7}switch(n){case"top-right":case"bottom-right":m=-v;break;case"top-left":case"bottom-left":m=v;break;case"left":m=h;break;case"right":m=-h}return[m,y]})(a,e[0])}function Zu(a,e,n){var h;const m=a.layout,y=(h=m.get("text-variable-anchor-offset"))===null||h===void 0?void 0:h.evaluate(e,{},n);if(y){const E=y.values,k=[];for(let P=0;P<E.length;P+=2){const z=k[P]=E[P],G=E[P+1].map((W=>W*ki));z.startsWith("top")?G[1]-=7:z.startsWith("bottom")&&(G[1]+=7),k[P+1]=G}return new Da(k)}const v=m.get("text-variable-anchor");if(v){let E;E=a._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[m.get("text-radial-offset").evaluate(e,{},n)*ki,On]:m.get("text-offset").evaluate(e,{},n).map((P=>P*ki));const k=[];for(const P of v)k.push(P,ta(P,E));return new Da(k)}return null}function ig(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Lw(a,e,n,h,m,y,v,E,k,P,z,G){let W=y.textMaxSize.evaluate(e,{});W===void 0&&(W=v);const K=a.layers[0].layout,ie=K.get("icon-offset").evaluate(e,{},z),oe=I1(n.horizontal),ue=v/24,be=a.tilePixelRatio*ue,We=a.tilePixelRatio*W/24,Se=a.tilePixelRatio*E,De=a.tilePixelRatio*K.get("symbol-spacing"),Je=K.get("text-padding")*a.tilePixelRatio,at=(function(Mr,Lr,Ar,Yr=1){const Gn=Mr.get("icon-padding").evaluate(Lr,{},Ar),Rn=Gn&&Gn.values;return[Rn[0]*Yr,Rn[1]*Yr,Rn[2]*Yr,Rn[3]*Yr]})(K,e,z,a.tilePixelRatio),St=K.get("text-max-angle")/180*Math.PI,Xt=K.get("text-rotation-alignment")!=="viewport"&&K.get("symbol-placement")!=="point",Ut=K.get("icon-rotation-alignment")==="map"&&K.get("symbol-placement")!=="point",rr=K.get("symbol-placement"),wr=De/2,ar=K.get("icon-text-fit");let Zt;h&&ar!=="none"&&(a.allowVerticalPlacement&&n.vertical&&(Zt=xc(h,n.vertical,ar,K.get("icon-text-fit-padding"),ie,ue)),oe&&(h=xc(h,oe,ar,K.get("icon-text-fit-padding"),ie,ue)));const Ft=z?G.line.getGranularityForZoomLevel(z.z):1,Ir=(Mr,Lr)=>{Lr.x<0||Lr.x>=Oe||Lr.y<0||Lr.y>=Oe||(function(Ar,Yr,Gn,Rn,Ja,$s,Wi,Qa,Ha,oa,hi,yi,Oa,xl,Xs,yl,eu,gs,ii,$i,fi,_s,yf,Wu,lg){const fd=Ar.addToLineVertexArray(Yr,Gn);let gp,F0,L0,z0,z1=0,O1=0,B1=0,N1=0,ny=-1,ay=-1;const vf={};let j1=Ya("");if(Ar.allowVerticalPlacement&&Rn.vertical){const uo=Qa.layout.get("text-rotate").evaluate(fi,{},Wu)+90;L0=new Pt(Ha,Yr,oa,hi,yi,Rn.vertical,Oa,xl,Xs,uo),Wi&&(z0=new Pt(Ha,Yr,oa,hi,yi,Wi,eu,gs,Xs,uo))}if(Ja){const uo=Qa.layout.get("icon-rotate").evaluate(fi,{}),wc=Qa.layout.get("icon-text-fit")!=="none",_p=$r(Ja,uo,yf,wc),Xu=Wi?$r(Wi,uo,yf,wc):void 0;F0=new Pt(Ha,Yr,oa,hi,yi,Ja,eu,gs,!1,uo),z1=4*_p.length;const xp=Ar.iconSizeData;let zh=null;xp.kind==="source"?(zh=[gl*Qa.layout.get("icon-size").evaluate(fi,{})],zh[0]>Eh&&se(`${Ar.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):xp.kind==="composite"&&(zh=[gl*_s.compositeIconSizes[0].evaluate(fi,{},Wu),gl*_s.compositeIconSizes[1].evaluate(fi,{},Wu)],(zh[0]>Eh||zh[1]>Eh)&&se(`${Ar.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Ar.addSymbols(Ar.icon,_p,zh,$i,ii,fi,_.az.none,Yr,fd.lineStartIndex,fd.lineLength,-1,Wu),ny=Ar.icon.placedSymbolArray.length-1,Xu&&(O1=4*Xu.length,Ar.addSymbols(Ar.icon,Xu,zh,$i,ii,fi,_.az.vertical,Yr,fd.lineStartIndex,fd.lineLength,-1,Wu),ay=Ar.icon.placedSymbolArray.length-1)}const U1=Object.keys(Rn.horizontal);for(const uo of U1){const wc=Rn.horizontal[uo];if(!gp){j1=Ya(wc.text);const Xu=Qa.layout.get("text-rotate").evaluate(fi,{},Wu);gp=new Pt(Ha,Yr,oa,hi,yi,wc,Oa,xl,Xs,Xu)}const _p=wc.positionedLines.length===1;if(B1+=R1(Ar,Yr,wc,$s,Qa,Xs,fi,yl,fd,Rn.vertical?_.az.horizontal:_.az.horizontalOnly,_p?U1:[uo],vf,ny,_s,Wu),_p)break}Rn.vertical&&(N1+=R1(Ar,Yr,Rn.vertical,$s,Qa,Xs,fi,yl,fd,_.az.vertical,["vertical"],vf,ay,_s,Wu));const Bw=gp?gp.boxStartIndex:Ar.collisionBoxArray.length,Nw=gp?gp.boxEndIndex:Ar.collisionBoxArray.length,jw=L0?L0.boxStartIndex:Ar.collisionBoxArray.length,Uw=L0?L0.boxEndIndex:Ar.collisionBoxArray.length,Vw=F0?F0.boxStartIndex:Ar.collisionBoxArray.length,Gw=F0?F0.boxEndIndex:Ar.collisionBoxArray.length,Hw=z0?z0.boxStartIndex:Ar.collisionBoxArray.length,qw=z0?z0.boxEndIndex:Ar.collisionBoxArray.length;let $u=-1;const X_=(uo,wc)=>uo&&uo.circleDiameter?Math.max(uo.circleDiameter,wc):wc;$u=X_(gp,$u),$u=X_(L0,$u),$u=X_(F0,$u),$u=X_(z0,$u);const V1=$u>-1?1:0;V1&&($u*=lg/ki),Ar.glyphOffsetArray.length>=nd.MAX_GLYPHS&&se("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),fi.sortKey!==void 0&&Ar.addToSortKeyRanges(Ar.symbolInstances.length,fi.sortKey);const Zw=Zu(Qa,fi,Wu),[Ww,$w]=(function(uo,wc){const _p=uo.length,Xu=wc?.values;if(Xu?.length>0)for(let xp=0;xp<Xu.length;xp+=2){const zh=Xu[xp+1];uo.emplaceBack(_.aP[Xu[xp]],zh[0],zh[1])}return[_p,uo.length]})(Ar.textAnchorOffsets,Zw);Ar.symbolInstances.emplaceBack(Yr.x,Yr.y,vf.right>=0?vf.right:-1,vf.center>=0?vf.center:-1,vf.left>=0?vf.left:-1,vf.vertical||-1,ny,ay,j1,Bw,Nw,jw,Uw,Vw,Gw,Hw,qw,oa,B1,N1,z1,O1,V1,0,Oa,$u,Ww,$w)})(a,Lr,Mr,n,h,m,Zt,a.layers[0],a.collisionBoxArray,e.index,e.sourceLayerIndex,a.index,be,[Je,Je,Je,Je],Xt,k,Se,at,Ut,ie,e,y,P,z,v)};if(rr==="line")for(const Mr of i(e.geometry,0,0,Oe,Oe)){const Lr=Ou(Mr,Ft),Ar=Ot(Lr,De,St,n.vertical||oe,h,24,We,a.overscaling,Oe);for(const Yr of Ar)oe&&zw(a,oe.text,wr,Yr)||Ir(Lr,Yr)}else if(rr==="line-center"){for(const Mr of e.geometry)if(Mr.length>1){const Lr=Ou(Mr,Ft),Ar=sr(Lr,St,n.vertical||oe,h,24,We);Ar&&Ir(Lr,Ar)}}else if(e.type==="Polygon")for(const Mr of zc(e.geometry,0)){const Lr=an(Mr,16);Ir(Ou(Mr[0],Ft,!0),new ae(Lr.x,Lr.y,0))}else if(e.type==="LineString")for(const Mr of e.geometry){const Lr=Ou(Mr,Ft);Ir(Lr,new ae(Lr[0].x,Lr[0].y,0))}else if(e.type==="Point")for(const Mr of e.geometry)for(const Lr of Mr)Ir([Lr],new ae(Lr.x,Lr.y,0))}function R1(a,e,n,h,m,y,v,E,k,P,z,G,W,K,ie){const oe=(function(We,Se,De,Je,at,St,Xt,Ut){const rr=Je.layout.get("text-rotate").evaluate(St,{})*Math.PI/180,wr=[];for(const ar of Se.positionedLines)for(const Zt of ar.positionedGlyphs){if(!Zt.rect)continue;const Ft=Zt.rect||{};let Ir=4,Mr=!0,Lr=1,Ar=0;const Yr=(at||Ut)&&Zt.vertical,Gn=Zt.metrics.advance*Zt.scale/2;if(Ut&&Se.verticalizable&&(Ar=ar.lineOffset/2-(Zt.imageName?-(ki-Zt.metrics.width*Zt.scale)/2:(Zt.scale-1)*ki)),Zt.imageName){const gs=Xt[Zt.imageName];Mr=gs.sdf,Lr=gs.pixelRatio,Ir=1/Lr}const Rn=at?[Zt.x+Gn,Zt.y]:[0,0];let Ja=at?[0,0]:[Zt.x+Gn+De[0],Zt.y+De[1]-Ar],$s=[0,0];Yr&&($s=Ja,Ja=[0,0]);const Wi=Zt.metrics.isDoubleResolution?2:1,Qa=(Zt.metrics.left-Ir)*Zt.scale-Gn+Ja[0],Ha=(-Zt.metrics.top-Ir)*Zt.scale+Ja[1],oa=Qa+Ft.w/Wi*Zt.scale/Lr,hi=Ha+Ft.h/Wi*Zt.scale/Lr,yi=new C(Qa,Ha),Oa=new C(oa,Ha),xl=new C(Qa,hi),Xs=new C(oa,hi);if(Yr){const gs=new C(-Gn,Gn- -17),ii=-Math.PI/2,$i=12-Gn,fi=new C(22-$i,-(Zt.imageName?$i:0)),_s=new C(...$s);yi._rotateAround(ii,gs)._add(fi)._add(_s),Oa._rotateAround(ii,gs)._add(fi)._add(_s),xl._rotateAround(ii,gs)._add(fi)._add(_s),Xs._rotateAround(ii,gs)._add(fi)._add(_s)}if(rr){const gs=Math.sin(rr),ii=Math.cos(rr),$i=[ii,-gs,gs,ii];yi._matMult($i),Oa._matMult($i),xl._matMult($i),Xs._matMult($i)}const yl=new C(0,0),eu=new C(0,0);wr.push({tl:yi,tr:Oa,bl:xl,br:Xs,tex:Ft,writingMode:Se.writingMode,glyphOffset:Rn,sectionIndex:Zt.sectionIndex,isSDF:Mr,pixelOffsetTL:yl,pixelOffsetBR:eu,minFontScaleX:0,minFontScaleY:0})}return wr})(0,n,E,m,y,v,h,a.allowVerticalPlacement),ue=a.textSizeData;let be=null;ue.kind==="source"?(be=[gl*m.layout.get("text-size").evaluate(v,{})],be[0]>Eh&&se(`${a.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ue.kind==="composite"&&(be=[gl*K.compositeTextSizes[0].evaluate(v,{},ie),gl*K.compositeTextSizes[1].evaluate(v,{},ie)],(be[0]>Eh||be[1]>Eh)&&se(`${a.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),a.addSymbols(a.text,oe,be,E,y,v,P,e,k.lineStartIndex,k.lineLength,W,ie);for(const We of z)G[We]=a.text.placedSymbolArray.length-1;return 4*oe.length}function I1(a){for(const e in a)return a[e];return null}function zw(a,e,n,h){const m=a.compareText;if(e in m){const y=m[e];for(let v=y.length-1;v>=0;v--)if(h.dist(y[v])<n)return!0}else m[e]=[];return m[e].push(h),!1}const P1=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Yx{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[n,h]=new Uint8Array(e,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");const m=h>>4;if(m!==1)throw new Error(`Got v${m} data when expected v1.`);const y=P1[15&h];if(!y)throw new Error("Unrecognized array type.");const[v]=new Uint16Array(e,2,1),[E]=new Uint32Array(e,4,1);return new Yx(E,v,y,e)}constructor(e,n=64,h=Float64Array,m){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=h,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const y=P1.indexOf(this.ArrayType),v=2*e*this.ArrayType.BYTES_PER_ELEMENT,E=e*this.IndexArrayType.BYTES_PER_ELEMENT,k=(8-E%8)%8;if(y<0)throw new Error(`Unexpected typed array class: ${h}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+E+k,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+v+E+k),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+E+k,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+y]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=e)}add(e,n){const h=this._pos>>1;return this.ids[h]=h,this.coords[this._pos++]=e,this.coords[this._pos++]=n,h}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return Kx(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,n,h,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:v,nodeSize:E}=this,k=[0,y.length-1,0],P=[];for(;k.length;){const z=k.pop()||0,G=k.pop()||0,W=k.pop()||0;if(G-W<=E){for(let ue=W;ue<=G;ue++){const be=v[2*ue],We=v[2*ue+1];be>=e&&be<=h&&We>=n&&We<=m&&P.push(y[ue])}continue}const K=W+G>>1,ie=v[2*K],oe=v[2*K+1];ie>=e&&ie<=h&&oe>=n&&oe<=m&&P.push(y[K]),(z===0?e<=ie:n<=oe)&&(k.push(W),k.push(K-1),k.push(1-z)),(z===0?h>=ie:m>=oe)&&(k.push(K+1),k.push(G),k.push(1-z))}return P}within(e,n,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:y,nodeSize:v}=this,E=[0,m.length-1,0],k=[],P=h*h;for(;E.length;){const z=E.pop()||0,G=E.pop()||0,W=E.pop()||0;if(G-W<=v){for(let ue=W;ue<=G;ue++)L1(y[2*ue],y[2*ue+1],e,n)<=P&&k.push(m[ue]);continue}const K=W+G>>1,ie=y[2*K],oe=y[2*K+1];L1(ie,oe,e,n)<=P&&k.push(m[K]),(z===0?e-h<=ie:n-h<=oe)&&(E.push(W),E.push(K-1),E.push(1-z)),(z===0?e+h>=ie:n+h>=oe)&&(E.push(K+1),E.push(G),E.push(1-z))}return k}}function Kx(a,e,n,h,m,y){if(m-h<=n)return;const v=h+m>>1;F1(a,e,v,h,m,y),Kx(a,e,n,h,v-1,1-y),Kx(a,e,n,v+1,m,1-y)}function F1(a,e,n,h,m,y){for(;m>h;){if(m-h>600){const P=m-h+1,z=n-h+1,G=Math.log(P),W=.5*Math.exp(2*G/3),K=.5*Math.sqrt(G*W*(P-W)/P)*(z-P/2<0?-1:1);F1(a,e,n,Math.max(h,Math.floor(n-z*W/P+K)),Math.min(m,Math.floor(n+(P-z)*W/P+K)),y)}const v=e[2*n+y];let E=h,k=m;for(sg(a,e,h,n),e[2*m+y]>v&&sg(a,e,h,m);E<k;){for(sg(a,e,E,k),E++,k--;e[2*E+y]<v;)E++;for(;e[2*k+y]>v;)k--}e[2*h+y]===v?sg(a,e,h,k):(k++,sg(a,e,k,m)),k<=n&&(h=k+1),n<=k&&(m=k-1)}}function sg(a,e,n,h){Jx(a,n,h),Jx(e,2*n,2*h),Jx(e,2*n+1,2*h+1)}function Jx(a,e,n){const h=a[e];a[e]=a[n],a[n]=h}function L1(a,e,n,h){const m=a-n,y=e-h;return m*m+y*y}var Qx;_.cH=void 0,(Qx=_.cH||(_.cH={})).create="create",Qx.load="load",Qx.fullLoad="fullLoad";let $_=null,og=[];const ey=1e3/60,ty="loadTime",ry="fullLoadTime",Ow={mark(a){performance.mark(a)},frame(a){const e=a;$_!=null&&og.push(e-$_),$_=e},clearMetrics(){$_=null,og=[],performance.clearMeasures(ty),performance.clearMeasures(ry);for(const a in _.cH)performance.clearMarks(_.cH[a])},getPerformanceMetrics(){performance.measure(ty,_.cH.create,_.cH.load),performance.measure(ry,_.cH.create,_.cH.fullLoad);const a=performance.getEntriesByName(ty)[0].duration,e=performance.getEntriesByName(ry)[0].duration,n=og.length,h=1/(og.reduce(((y,v)=>y+v),0)/n/1e3),m=og.filter((y=>y>ey)).reduce(((y,v)=>y+(v-ey)/ey),0);return{loadTime:a,fullLoadTime:e,fps:h,percentDroppedFrames:m/(n+m)*100,totalFrames:n}}};_.$=N,_.A=X,_.B=ol,_.C=li,_.D=Rr,_.E=hn,_.F=function([a,e,n]){return e+=90,e*=Math.PI/180,n*=Math.PI/180,{x:a*Math.cos(e)*Math.sin(n),y:a*Math.sin(e)*Math.sin(n),z:a*Math.cos(n)}},_.G=ya,_.H=Qn,_.I=ga,_.J=Lf,_.K=function(a){if(Ee==null){const e=a.navigator?a.navigator.userAgent:null;Ee=!!a.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Ee},_.L=class{constructor(a,e){this.target=a,this.mapId=e,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new m0((()=>this.process())),this.subscription=lr(this.target,"message",(n=>this.receive(n)),!1),this.globalScope=yt(self)?a:window}registerMessageHandler(a,e){this.messageHandlers[a]=e}unregisterMessageHandler(a){delete this.messageHandlers[a]}sendAsync(a,e){return new Promise(((n,h)=>{const m=Math.round(1e18*Math.random()).toString(36).substring(0,10),y=e?lr(e.signal,"abort",(()=>{y?.unsubscribe(),delete this.resolveRejects[m];const k={id:m,type:"<cancel>",origin:location.origin,targetMapId:a.targetMapId,sourceMapId:this.mapId};this.target.postMessage(k)}),Lm):null;this.resolveRejects[m]={resolve:k=>{y?.unsubscribe(),n(k)},reject:k=>{y?.unsubscribe(),h(k)}};const v=[],E=Object.assign(Object.assign({},a),{id:m,sourceMapId:this.mapId,origin:location.origin,data:ll(a.data,v)});this.target.postMessage(E,{transfer:v})}))}receive(a){const e=a.data,n=e.id;if(!(e.origin!=="file://"&&location.origin!=="file://"&&e.origin!=="resource://android"&&location.origin!=="resource://android"&&e.origin!==location.origin||e.targetMapId&&this.mapId!==e.targetMapId)){if(e.type==="<cancel>"){delete this.tasks[n];const h=this.abortControllers[n];return delete this.abortControllers[n],void(h&&h.abort())}if(yt(self)||e.mustQueue)return this.tasks[n]=e,this.taskQueue.push(n),void this.invoker.trigger();this.processTask(n,e)}}process(){if(this.taskQueue.length===0)return;const a=this.taskQueue.shift(),e=this.tasks[a];delete this.tasks[a],this.taskQueue.length>0&&this.invoker.trigger(),e&&this.processTask(a,e)}processTask(a,e){return s(this,void 0,void 0,(function*(){if(e.type==="<response>"){const m=this.resolveRejects[a];return delete this.resolveRejects[a],m?void(e.error?m.reject(mh(e.error)):m.resolve(mh(e.data))):void 0}if(!this.messageHandlers[e.type])return void this.completeTask(a,new Error(`Could not find a registered handler for ${e.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const n=mh(e.data),h=new AbortController;this.abortControllers[a]=h;try{const m=yield this.messageHandlers[e.type](e.sourceMapId,n,h);this.completeTask(a,null,m)}catch(m){this.completeTask(a,m)}}))}completeTask(a,e,n){const h=[];delete this.abortControllers[a];const m={id:a,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:e?ll(e):null,data:ll(n,h)};this.target.postMessage(m,{transfer:h})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},_.M=ot,_.N=function(){var a=new X(16);return X!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},_.O=function(a,e,n){var h,m,y,v,E,k,P,z,G,W,K,ie,oe=n[0],ue=n[1],be=n[2];return e===a?(a[12]=e[0]*oe+e[4]*ue+e[8]*be+e[12],a[13]=e[1]*oe+e[5]*ue+e[9]*be+e[13],a[14]=e[2]*oe+e[6]*ue+e[10]*be+e[14],a[15]=e[3]*oe+e[7]*ue+e[11]*be+e[15]):(m=e[1],y=e[2],v=e[3],E=e[4],k=e[5],P=e[6],z=e[7],G=e[8],W=e[9],K=e[10],ie=e[11],a[0]=h=e[0],a[1]=m,a[2]=y,a[3]=v,a[4]=E,a[5]=k,a[6]=P,a[7]=z,a[8]=G,a[9]=W,a[10]=K,a[11]=ie,a[12]=h*oe+E*ue+G*be+e[12],a[13]=m*oe+k*ue+W*be+e[13],a[14]=y*oe+P*ue+K*be+e[14],a[15]=v*oe+z*ue+ie*be+e[15]),a},_.P=C,_.Q=function(a,e,n){var h=n[0],m=n[1],y=n[2];return a[0]=e[0]*h,a[1]=e[1]*h,a[2]=e[2]*h,a[3]=e[3]*h,a[4]=e[4]*m,a[5]=e[5]*m,a[6]=e[6]*m,a[7]=e[7]*m,a[8]=e[8]*y,a[9]=e[9]*y,a[10]=e[10]*y,a[11]=e[11]*y,a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15],a},_.R=Hs,_.S=function(a,e,n){var h=e[0],m=e[1],y=e[2],v=e[3],E=e[4],k=e[5],P=e[6],z=e[7],G=e[8],W=e[9],K=e[10],ie=e[11],oe=e[12],ue=e[13],be=e[14],We=e[15],Se=n[0],De=n[1],Je=n[2],at=n[3];return a[0]=Se*h+De*E+Je*G+at*oe,a[1]=Se*m+De*k+Je*W+at*ue,a[2]=Se*y+De*P+Je*K+at*be,a[3]=Se*v+De*z+Je*ie+at*We,a[4]=(Se=n[4])*h+(De=n[5])*E+(Je=n[6])*G+(at=n[7])*oe,a[5]=Se*m+De*k+Je*W+at*ue,a[6]=Se*y+De*P+Je*K+at*be,a[7]=Se*v+De*z+Je*ie+at*We,a[8]=(Se=n[8])*h+(De=n[9])*E+(Je=n[10])*G+(at=n[11])*oe,a[9]=Se*m+De*k+Je*W+at*ue,a[10]=Se*y+De*P+Je*K+at*be,a[11]=Se*v+De*z+Je*ie+at*We,a[12]=(Se=n[12])*h+(De=n[13])*E+(Je=n[14])*G+(at=n[15])*oe,a[13]=Se*m+De*k+Je*W+at*ue,a[14]=Se*y+De*P+Je*K+at*be,a[15]=Se*v+De*z+Je*ie+at*We,a},_.T=Zp,_.U=function(a,e){const n={};for(let h=0;h<e.length;h++){const m=e[h];m in a&&(n[m]=a[m])}return n},_.V=Jc,_.W=Gt,_.X=zm,_.Y=M_,_.Z=Ve,_._=s,_.a=we,_.a$=Ge,_.a0=Z,_.a1=Jt,_.a2=Oo,_.a3=R_,_.a4=Jd,_.a5=Oe,_.a6=function(a,e,n){if(!a)return e||{};if(!e)return a||{};const h=ep(a),m=ep(e);(function(v,E){E.removeAll&&(v.add.clear(),v.update.clear(),v.remove.clear(),E.remove.clear());for(const k of E.remove)v.add.delete(k),v.update.delete(k);for(const[k,P]of E.update){const z=v.update.get(k);z&&(E.update.set(k,Bm(z,P)),v.update.delete(k))}})(h,m);const y={};if((h.removeAll||m.removeAll)&&(y.removeAll=!0),y.remove=new Set([...h.remove,...m.remove]),y.add=new Map([...h.add,...m.add]),y.update=new Map([...h.update,...m.update]),y.remove.size&&y.add.size)for(const v of y.add.keys())y.remove.delete(v);return(function(v){const E={};return v.removeAll&&(E.removeAll=v.removeAll),v.remove&&(E.remove=Array.from(v.remove)),v.add&&(E.add=Array.from(v.add.values())),v.update&&(E.update=Array.from(v.update.values())),E})(y)},_.a7=function(a,e){const n=new Map;if(a==null||a.type==null)return n;if(a.type==="Feature"){const h=Qd(a,e);return h==null?void 0:(n.set(h,a),n)}if(a.type==="FeatureCollection"){const h=new Set;for(const m of a.features){const y=Qd(m,e);if(y==null||h.has(y))return;h.add(y),n.set(y,m)}return n}},_.a8=function(a,e,n){var h,m;const y=[];if(e.removeAll)a.clear();else if(e.remove)for(const v of e.remove){const E=a.get(v);E&&(y.push(E.geometry),a.delete(v))}if(e.add)for(const v of e.add){const E=Qd(v,n);if(E==null)continue;const k=a.get(E);k&&y.push(k.geometry),y.push(v.geometry),a.set(E,v)}if(e.update)for(const v of e.update){const E=a.get(v.id);if(!E)continue;const k=!!v.newGeometry,P=v.removeAllProperties||((h=v.removeProperties)===null||h===void 0?void 0:h.length)>0||((m=v.addOrUpdateProperties)===null||m===void 0?void 0:m.length)>0;if(!k&&!P)continue;y.push(E.geometry);const z=Object.assign({},E);if(a.set(v.id,z),k&&(y.push(v.newGeometry),z.geometry=v.newGeometry),P){if(z.properties=v.removeAllProperties?{}:Object.assign({},z.properties||{}),v.removeProperties)for(const G of v.removeProperties)delete z.properties[G];if(v.addOrUpdateProperties)for(const{key:G,value:W}of v.addOrUpdateProperties)z.properties[G]=W}}return y},_.a9=ia,_.aA=function(a,{uSize:e,uSizeT:n},{lowerSize:h,upperSize:m}){return a.kind==="source"?h/gl:a.kind==="composite"?ya.number(h/gl,m/gl,n):e},_.aB=function(a,e){var n=e[0],h=e[1],m=e[2],y=e[3],v=e[4],E=e[5],k=e[6],P=e[7],z=e[8],G=e[9],W=e[10],K=e[11],ie=e[12],oe=e[13],ue=e[14],be=e[15],We=n*E-h*v,Se=n*k-m*v,De=n*P-y*v,Je=h*k-m*E,at=h*P-y*E,St=m*P-y*k,Xt=z*oe-G*ie,Ut=z*ue-W*ie,rr=z*be-K*ie,wr=G*ue-W*oe,ar=G*be-K*oe,Zt=W*be-K*ue,Ft=We*Zt-Se*ar+De*wr+Je*rr-at*Ut+St*Xt;return Ft?(a[0]=(E*Zt-k*ar+P*wr)*(Ft=1/Ft),a[1]=(m*ar-h*Zt-y*wr)*Ft,a[2]=(oe*St-ue*at+be*Je)*Ft,a[3]=(W*at-G*St-K*Je)*Ft,a[4]=(k*rr-v*Zt-P*Ut)*Ft,a[5]=(n*Zt-m*rr+y*Ut)*Ft,a[6]=(ue*De-ie*St-be*Se)*Ft,a[7]=(z*St-W*De+K*Se)*Ft,a[8]=(v*ar-E*rr+P*Xt)*Ft,a[9]=(h*rr-n*ar-y*Xt)*Ft,a[10]=(ie*at-oe*De+be*We)*Ft,a[11]=(G*De-z*at-K*We)*Ft,a[12]=(E*Ut-v*wr-k*Xt)*Ft,a[13]=(n*wr-h*Ut+m*Xt)*Ft,a[14]=(oe*Se-ie*Je-ue*We)*Ft,a[15]=(z*Je-G*Se+W*We)*Ft,a):null},_.aC=He,_.aD=function(a){var e=a[0],n=a[1];return Math.sqrt(e*e+n*n)},_.aE=function(a){return a[0]=0,a[1]=0,a},_.aF=function(a,e,n){return a[0]=e[0]*n,a[1]=e[1]*n,a},_.aG=Rm,_.aH=le,_.aI=function(a,e,n,h){const m=e.y-a.y,y=e.x-a.x,v=h.y-n.y,E=h.x-n.x,k=v*y-E*m;if(k===0)return null;const P=(E*(a.y-n.y)-v*(a.x-n.x))/k;return new C(a.x+P*y,a.y+P*m)},_.aJ=i,_.aK=cf,_.aL=function(a){let e=1/0,n=1/0,h=-1/0,m=-1/0;for(const y of a)e=Math.min(e,y.x),n=Math.min(n,y.y),h=Math.max(h,y.x),m=Math.max(m,y.y);return[e,n,h,m]},_.aM=ki,_.aN=It,_.aO=function(a,e,n,h,m=!1){if(!n[0]&&!n[1])return[0,0];const y=m?h==="map"?-a.bearingInRadians:0:h==="viewport"?a.bearingInRadians:0;if(y){const v=Math.sin(y),E=Math.cos(y);n=[n[0]*E-n[1]*v,n[0]*v+n[1]*E]}return[m?n[0]:It(e,n[0],a.zoom),m?n[1]:It(e,n[1],a.zoom)]},_.aQ=u0,_.aR=ig,_.aS=km,_.aT=Yx,_.aU=Fa,_.aV=Vd,_.aW=Ie,_.aX=br,_.aY=Ct,_.aZ=ir,_.a_=Om,_.aa=kh,_.ab=25,_.ac=is,_.ad=a=>{const e=window.document.createElement("video");return e.muted=!0,new Promise((n=>{e.onloadstart=()=>{n(e)};for(const h of a){const m=window.document.createElement("source");Wt(h)||(e.crossOrigin="Anonymous"),m.src=h,e.appendChild(m)}}))},_.ae=Qt,_.af=function(){return Bt++},_.ag=x,_.ah=nd,_.ai=mp,_.aj=sn,_.ak=pl,_.al=x0,_.am=function(a){const e={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((n,h,m,y)=>{const v=m||y;return e[h]=!v||v.toLowerCase(),""})),e["max-age"]){const n=parseInt(e["max-age"],10);isNaN(n)?delete e["max-age"]:e["max-age"]=n}return e},_.an=bt,_.ao=85.051129,_.ap=pr,_.aq=function(a){return Math.pow(2,a)},_.ar=ge,_.as=D_,_.at=function(a){return Math.log(a)/Math.LN2},_.au=function(a){var e=a[0],n=a[1];return e*e+n*n},_.av=function(a){if(!a.length)return new Set;const e=Math.max(...a.map((k=>k.canonical.z)));let n=1/0,h=-1/0,m=1/0,y=-1/0;const v=[];for(const k of a){const{x:P,y:z,z:G}=k.canonical,W=Math.pow(2,e-G),K=P*W,ie=z*W;v.push({id:k,x:K,y:ie}),K<n&&(n=K),K>h&&(h=K),ie<m&&(m=ie),ie>y&&(y=ie)}const E=new Set;for(const k of v)k.x!==n&&k.x!==h&&k.y!==m&&k.y!==y||E.add(k.id);return E},_.aw=function(a,e){const n=Math.abs(2*a.wrap)-+(a.wrap<0),h=Math.abs(2*e.wrap)-+(e.wrap<0);return a.overscaledZ-e.overscaledZ||h-n||e.canonical.y-a.canonical.y||e.canonical.x-a.canonical.x},_.ax=class{constructor(a,e){this.max=a,this.onRemove=e,this.reset()}reset(){for(const a in this.data)for(const e of this.data[a])e.timeout&&clearTimeout(e.timeout),this.onRemove(e.value);return this.data={},this.order=[],this}add(a,e,n){const h=a.wrapped().key;this.data[h]===void 0&&(this.data[h]=[]);const m={value:e,timeout:void 0};if(n!==void 0&&(m.timeout=setTimeout((()=>{this.remove(a,m)}),n)),this.data[h].push(m),this.order.push(h),this.order.length>this.max){const y=this._getAndRemoveByKey(this.order[0]);y&&this.onRemove(y)}return this}has(a){return a.wrapped().key in this.data}getAndRemove(a){return this.has(a)?this._getAndRemoveByKey(a.wrapped().key):null}_getAndRemoveByKey(a){const e=this.data[a].shift();return e.timeout&&clearTimeout(e.timeout),this.data[a].length===0&&delete this.data[a],this.order.splice(this.order.indexOf(a),1),e.value}getByKey(a){const e=this.data[a];return e?e[0].value:null}get(a){return this.has(a)?this.data[a.wrapped().key][0].value:null}remove(a,e){if(!this.has(a))return this;const n=a.wrapped().key,h=e===void 0?0:this.data[n].indexOf(e),m=this.data[n][h];return this.data[n].splice(h,1),m.timeout&&clearTimeout(m.timeout),this.data[n].length===0&&delete this.data[n],this.onRemove(m.value),this.order.splice(this.order.indexOf(n),1),this}setMaxSize(a){for(this.max=a;this.order.length>this.max;){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}filter(a){const e=[];for(const n in this.data)for(const h of this.data[n])a(h.value)||e.push(h);for(const n of e)this.remove(n.value.tileID,n)}},_.ay=function(a,e){let n=0,h=0;if(a.kind==="constant")h=a.layoutSize;else if(a.kind!=="source"){const{interpolationType:m,minZoom:y,maxZoom:v}=a,E=m?bt(ti.interpolationFactor(m,e,y,v),0,1):0;a.kind==="camera"?h=ya.number(a.minSize,a.maxSize,E):n=E}return{uSizeT:n,uSize:h}},_.b=Ne,_.b$=dl,_.b0=xe,_.b1=function(a){var e=new X(3);return e[0]=a[0],e[1]=a[1],e[2]=a[2],e},_.b2=function(a,e,n){return a[0]=e[0]-n[0],a[1]=e[1]-n[1],a[2]=e[2]-n[2],a},_.b3=function(a,e){var n=e[0],h=e[1],m=e[2],y=n*n+h*h+m*m;return y>0&&(y=1/Math.sqrt(y)),a[0]=e[0]*y,a[1]=e[1]*y,a[2]=e[2]*y,a},_.b4=$e,_.b5=function(a,e){return a[0]*e[0]+a[1]*e[1]+a[2]*e[2]},_.b6=function(a,e,n){return a[0]=e[0]*n[0],a[1]=e[1]*n[1],a[2]=e[2]*n[2],a[3]=e[3]*n[3],a},_.b7=re,_.b8=function(a,e,n){const h=e[0]*n[0]+e[1]*n[1]+e[2]*n[2];return h===0?null:(-(a[0]*n[0]+a[1]*n[1]+a[2]*n[2])-n[3])/h},_.b9=nt,_.bA=function(a,e,n,h){return a[0]=e[0]+n[0]*h,a[1]=e[1]+n[1]*h,a[2]=e[2]+n[2]*h,a},_.bB=et,_.bC=function(a,e,n){var h=n[0],m=n[1],y=n[2],v=n[3],E=e[0],k=e[1],P=e[2],z=m*P-y*k,G=y*E-h*P,W=h*k-m*E;return a[0]=E+v*(z+=z)+m*(W+=W)-y*(G+=G),a[1]=k+v*G+y*z-h*W,a[2]=P+v*W+h*G-m*z,a},_.bD=function(a,e,n){const h=(function(k){var P=k[3],z=k[4],G=k[5],W=k[6],K=k[7],ie=k[8];return k[0]*(ie*z-G*K)+k[1]*(-ie*P+G*W)+k[2]*(K*P-z*W)})([a[0],a[1],a[2],e[0],e[1],e[2],n[0],n[1],n[2]]);if(h===0)return null;const m=$e([],[e[0],e[1],e[2]],[n[0],n[1],n[2]]),y=$e([],[n[0],n[1],n[2]],[a[0],a[1],a[2]]),v=$e([],[a[0],a[1],a[2]],[e[0],e[1],e[2]]),E=Ge([],m,-a[3]);return xe(E,E,Ge([],y,-e[3])),xe(E,E,Ge([],v,-n[3])),Ge(E,E,1/h),E},_.bE=g0,_.bF=function(){return new Float64Array(4)},_.bG=function(a,e,n,h){var m=[],y=[];return m[0]=e[0]-n[0],m[1]=e[1]-n[1],m[2]=e[2]-n[2],y[0]=m[0]*Math.cos(h)-m[1]*Math.sin(h),y[1]=m[0]*Math.sin(h)+m[1]*Math.cos(h),y[2]=m[2],a[0]=y[0]+n[0],a[1]=y[1]+n[1],a[2]=y[2]+n[2],a},_.bH=function(a,e,n,h){var m=[],y=[];return m[0]=e[0]-n[0],m[1]=e[1]-n[1],m[2]=e[2]-n[2],y[0]=m[0],y[1]=m[1]*Math.cos(h)-m[2]*Math.sin(h),y[2]=m[1]*Math.sin(h)+m[2]*Math.cos(h),a[0]=y[0]+n[0],a[1]=y[1]+n[1],a[2]=y[2]+n[2],a},_.bI=function(a,e,n,h){var m=[],y=[];return m[0]=e[0]-n[0],m[1]=e[1]-n[1],m[2]=e[2]-n[2],y[0]=m[2]*Math.sin(h)+m[0]*Math.cos(h),y[1]=m[1],y[2]=m[2]*Math.cos(h)-m[0]*Math.sin(h),a[0]=y[0]+n[0],a[1]=y[1]+n[1],a[2]=y[2]+n[2],a},_.bJ=function(a,e,n){var h=Math.sin(n),m=Math.cos(n),y=e[0],v=e[1],E=e[2],k=e[3],P=e[8],z=e[9],G=e[10],W=e[11];return e!==a&&(a[4]=e[4],a[5]=e[5],a[6]=e[6],a[7]=e[7],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15]),a[0]=y*m-P*h,a[1]=v*m-z*h,a[2]=E*m-G*h,a[3]=k*m-W*h,a[8]=y*h+P*m,a[9]=v*h+z*m,a[10]=E*h+G*m,a[11]=k*h+W*m,a},_.bK=function(a,e){const n=me(a,360),h=me(e,360),m=h-n,y=h>n?m-360:m+360;return Math.abs(m)<Math.abs(y)?m:y},_.bL=function(a){return a[0]=0,a[1]=0,a[2]=0,a},_.bM=function(a,e,n,h){const m=Math.sqrt(a*a+e*e),y=Math.sqrt(n*n+h*h);a/=m,e/=m,n/=y,h/=y;const v=Math.acos(a*n+e*h);return-e*n+a*h>0?v:-v},_.bN=function(a,e){const n=me(a,2*Math.PI),h=me(e,2*Math.PI);return Math.min(Math.abs(n-h),Math.abs(n-h+2*Math.PI),Math.abs(n-h-2*Math.PI))},_.bO=function(){const a={},e=ht.$version;for(const n in ht.$root){const h=ht.$root[n];if(h.required){let m=null;m=n==="version"?e:h.type==="array"?[]:{},m!=null&&(a[n]=m)}}return a},_.bP=vt,_.bQ=Bf,_.bR=function a(e,n){if(Array.isArray(e)){if(!Array.isArray(n)||e.length!==n.length)return!1;for(let h=0;h<e.length;h++)if(!a(e[h],n[h]))return!1;return!0}if(typeof e=="object"&&e!==null&&n!==null){if(typeof n!="object"||Object.keys(e).length!==Object.keys(n).length)return!1;for(const h in e)if(!a(e[h],n[h]))return!1;return!0}return e===n},_.bS=function(a){a=a.slice();const e=Object.create(null);for(let n=0;n<a.length;n++)e[a[n].id]=a[n];for(let n=0;n<a.length;n++)"ref"in a[n]&&(a[n]=Kn(a[n],e[a[n].ref]));return a},_.bT=function(a,e){if(a.type==="custom")return new Fm(a,e);switch(a.type){case"background":return new Un(a,e);case"circle":return new Gp(a,e);case"color-relief":return new n_(a,e);case"fill":return new l_(a,e);case"fill-extrusion":return new vm(a,e);case"heatmap":return new t_(a,e);case"hillshade":return new Ka(a,e);case"line":return new wm(a,e);case"raster":return new hc(a,e);case"symbol":return new Ah(a,e)}},_.bU=a=>a.type==="raster",_.bV=Ye,_.bW=function(a,e){if(!a)return[{command:"setStyle",args:[e]}];let n=[];try{if(!Qr(a.version,e.version))return[{command:"setStyle",args:[e]}];Qr(a.center,e.center)||n.push({command:"setCenter",args:[e.center]}),Qr(a.state,e.state)||n.push({command:"setGlobalState",args:[e.state]}),Qr(a.centerAltitude,e.centerAltitude)||n.push({command:"setCenterAltitude",args:[e.centerAltitude]}),Qr(a.zoom,e.zoom)||n.push({command:"setZoom",args:[e.zoom]}),Qr(a.bearing,e.bearing)||n.push({command:"setBearing",args:[e.bearing]}),Qr(a.pitch,e.pitch)||n.push({command:"setPitch",args:[e.pitch]}),Qr(a.roll,e.roll)||n.push({command:"setRoll",args:[e.roll]}),Qr(a.sprite,e.sprite)||n.push({command:"setSprite",args:[e.sprite]}),Qr(a.glyphs,e.glyphs)||n.push({command:"setGlyphs",args:[e.glyphs]}),Qr(a.transition,e.transition)||n.push({command:"setTransition",args:[e.transition]}),Qr(a.light,e.light)||n.push({command:"setLight",args:[e.light]}),Qr(a.terrain,e.terrain)||n.push({command:"setTerrain",args:[e.terrain]}),Qr(a.sky,e.sky)||n.push({command:"setSky",args:[e.sky]}),Qr(a.projection,e.projection)||n.push({command:"setProjection",args:[e.projection]});const h={},m=[];(function(v,E,k,P){let z;for(z in E=E||{},v=v||{})Object.prototype.hasOwnProperty.call(v,z)&&(Object.prototype.hasOwnProperty.call(E,z)||zn(z,k,P));for(z in E)Object.prototype.hasOwnProperty.call(E,z)&&(Object.prototype.hasOwnProperty.call(v,z)?Qr(v[z],E[z])||(v[z].type==="geojson"&&E[z].type==="geojson"&&Bn(v,E,z)?Ln(k,{command:"setGeoJSONSourceData",args:[z,E[z].data]}):tn(z,E,k,P)):Ba(z,E,k))})(a.sources,e.sources,m,h);const y=[];a.layers&&a.layers.forEach((v=>{"source"in v&&h[v.source]?n.push({command:"removeLayer",args:[v.id]}):y.push(v)})),n=n.concat(m),(function(v,E,k){E=E||[];const P=(v=v||[]).map(El),z=E.map(El),G=v.reduce(Zo,{}),W=E.reduce(Zo,{}),K=P.slice(),ie=Object.create(null);let oe,ue,be,We,Se;for(let De=0,Je=0;De<P.length;De++)oe=P[De],Object.prototype.hasOwnProperty.call(W,oe)?Je++:(Ln(k,{command:"removeLayer",args:[oe]}),K.splice(K.indexOf(oe,Je),1));for(let De=0,Je=0;De<z.length;De++)oe=z[z.length-1-De],K[K.length-1-De]!==oe&&(Object.prototype.hasOwnProperty.call(G,oe)?(Ln(k,{command:"removeLayer",args:[oe]}),K.splice(K.lastIndexOf(oe,K.length-Je),1)):Je++,We=K[K.length-De],Ln(k,{command:"addLayer",args:[W[oe],We]}),K.splice(K.length-De,0,oe),ie[oe]=!0);for(let De=0;De<z.length;De++)if(oe=z[De],ue=G[oe],be=W[oe],!ie[oe]&&!Qr(ue,be))if(Qr(ue.source,be.source)&&Qr(ue["source-layer"],be["source-layer"])&&Qr(ue.type,be.type)){for(Se in ba(ue.layout,be.layout,k,oe,null,"setLayoutProperty"),ba(ue.paint,be.paint,k,oe,null,"setPaintProperty"),Qr(ue.filter,be.filter)||Ln(k,{command:"setFilter",args:[oe,be.filter]}),Qr(ue.minzoom,be.minzoom)&&Qr(ue.maxzoom,be.maxzoom)||Ln(k,{command:"setLayerZoomRange",args:[oe,be.minzoom,be.maxzoom]}),ue)Object.prototype.hasOwnProperty.call(ue,Se)&&Se!=="layout"&&Se!=="paint"&&Se!=="filter"&&Se!=="metadata"&&Se!=="minzoom"&&Se!=="maxzoom"&&(Se.indexOf("paint.")===0?ba(ue[Se],be[Se],k,oe,Se.slice(6),"setPaintProperty"):Qr(ue[Se],be[Se])||Ln(k,{command:"setLayerProperty",args:[oe,Se,be[Se]]}));for(Se in be)Object.prototype.hasOwnProperty.call(be,Se)&&!Object.prototype.hasOwnProperty.call(ue,Se)&&Se!=="layout"&&Se!=="paint"&&Se!=="filter"&&Se!=="metadata"&&Se!=="minzoom"&&Se!=="maxzoom"&&(Se.indexOf("paint.")===0?ba(ue[Se],be[Se],k,oe,Se.slice(6),"setPaintProperty"):Qr(ue[Se],be[Se])||Ln(k,{command:"setLayerProperty",args:[oe,Se,be[Se]]}))}else Ln(k,{command:"removeLayer",args:[oe]}),We=K[K.lastIndexOf(oe)+1],Ln(k,{command:"addLayer",args:[be,We]})})(y,e.layers,n)}catch(h){console.warn("Unable to compute style diff:",h),n=[{command:"setStyle",args:[e]}]}return n},_.bX=function(a){const e=[],n=a.id;return n===void 0&&e.push({message:`layers.${n}: missing required property "id"`}),a.render===void 0&&e.push({message:`layers.${n}: missing required method "render"`}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&e.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),e},_.bY=Yt,_.bZ=Or,_.b_=class extends Vs{constructor(a,e){super(a,e),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},_.ba=function(a,e,n){return a[0]=e[0]*n,a[1]=e[1]*n,a[2]=e[2]*n,a[3]=e[3]*n,a},_.bb=function(a,e){return a[0]*e[0]+a[1]*e[1]+a[2]*e[2]+a[3]},_.bc=I_,_.bd=id,_.be=function(a,e,n,h,m){var y=1/Math.tan(e/2);if(a[0]=y/n,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=y,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,m!=null&&m!==1/0){var v=1/(h-m);a[10]=(m+h)*v,a[14]=2*m*h*v}else a[10]=-1,a[14]=-2*h;return a},_.bf=function(a){var e=new X(16);return e[0]=a[0],e[1]=a[1],e[2]=a[2],e[3]=a[3],e[4]=a[4],e[5]=a[5],e[6]=a[6],e[7]=a[7],e[8]=a[8],e[9]=a[9],e[10]=a[10],e[11]=a[11],e[12]=a[12],e[13]=a[13],e[14]=a[14],e[15]=a[15],e},_.bg=function(a,e,n){var h=Math.sin(n),m=Math.cos(n),y=e[0],v=e[1],E=e[2],k=e[3],P=e[4],z=e[5],G=e[6],W=e[7];return e!==a&&(a[8]=e[8],a[9]=e[9],a[10]=e[10],a[11]=e[11],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15]),a[0]=y*m+P*h,a[1]=v*m+z*h,a[2]=E*m+G*h,a[3]=k*m+W*h,a[4]=P*m-y*h,a[5]=z*m-v*h,a[6]=G*m-E*h,a[7]=W*m-k*h,a},_.bh=function(a,e,n){var h=Math.sin(n),m=Math.cos(n),y=e[4],v=e[5],E=e[6],k=e[7],P=e[8],z=e[9],G=e[10],W=e[11];return e!==a&&(a[0]=e[0],a[1]=e[1],a[2]=e[2],a[3]=e[3],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15]),a[4]=y*m+P*h,a[5]=v*m+z*h,a[6]=E*m+G*h,a[7]=k*m+W*h,a[8]=P*m-y*h,a[9]=z*m-v*h,a[10]=G*m-E*h,a[11]=W*m-k*h,a},_.bi=function(){const a=new Float32Array(16);return ge(a),a},_.bj=function(){const a=new Float64Array(16);return ge(a),a},_.bk=function(){return new Float64Array(16)},_.bl=function(a,e,n){const h=new Float64Array(4);return et(h,a,e-90,n),h},_.bm=function(a,e,n,h){var m,y,v,E,k,P=e[0],z=e[1],G=e[2],W=e[3],K=n[0],ie=n[1],oe=n[2],ue=n[3];return(y=P*K+z*ie+G*oe+W*ue)<0&&(y=-y,K=-K,ie=-ie,oe=-oe,ue=-ue),1-y>J?(m=Math.acos(y),v=Math.sin(m),E=Math.sin((1-h)*m)/v,k=Math.sin(h*m)/v):(E=1-h,k=h),a[0]=E*P+k*K,a[1]=E*z+k*ie,a[2]=E*G+k*oe,a[3]=E*W+k*ue,a},_.bn=function(a){const e=new Float64Array(9);(function(y,v){var E=v[0],k=v[1],P=v[2],z=v[3],G=E+E,W=k+k,K=P+P,ie=E*G,oe=k*G,ue=k*W,be=P*G,We=P*W,Se=P*K,De=z*G,Je=z*W,at=z*K;y[0]=1-ue-Se,y[3]=oe-at,y[6]=be+Je,y[1]=oe+at,y[4]=1-ie-Se,y[7]=We-De,y[2]=be-Je,y[5]=We+De,y[8]=1-ie-ue})(e,a);const n=ir(-Math.asin(bt(e[2],-1,1)));let h,m;return Math.hypot(e[5],e[8])<.001?(h=0,m=-ir(Math.atan2(e[3],e[4]))):(h=ir(e[5]===0&&e[8]===0?0:Math.atan2(e[5],e[8])),m=ir(e[1]===0&&e[0]===0?0:Math.atan2(e[1],e[0]))),{roll:h,pitch:n+90,bearing:m}},_.bo=function(a,e){return a.roll==e.roll&&a.pitch==e.pitch&&a.bearing==e.bearing},_.bp=ln,_.bq=Iu,_.br=Po,_.bs=gc,_.bt=as,_.bu=ne,_.bv=Ue,_.bw=$n,_.bx=function(a,e,n,h,m){return ne(h,m,bt((a-e)/(n-e),0,1))},_.by=me,_.bz=function(){return new Float64Array(3)},_.c=Xe,_.c$=function(a,e,n,h,m){return s(this,void 0,void 0,(function*(){if(Z())try{return yield Jt(a,e,n,h,m)}catch{}return(function(y,v,E,k,P){const z=y.width,G=y.height;Kt&&Et||(Kt=new OffscreenCanvas(z,G),Et=Kt.getContext("2d",{willReadFrequently:!0})),Kt.width=z,Kt.height=G,Et.drawImage(y,0,0,z,G);const W=Et.getImageData(v,E,k,P);return Et.clearRect(0,0,z,G),W.data})(a,e,n,h,m)}))},_.c0=class extends Vs{constructor(a,e){super(a,e),this.current=Gs}set(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let e=1;e<16;e++)if(a[e]!==this.current[e]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}},_.c1=vh,_.c2=class extends Vs{constructor(a,e){super(a,e),this.current=[0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))}},_.c3=class extends Vs{constructor(a,e){super(a,e),this.current=[0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))}},_.c4=pe,_.c5=function(a,e){var n=Math.sin(e),h=Math.cos(e);return a[0]=h,a[1]=n,a[2]=0,a[3]=-n,a[4]=h,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},_.c6=function(a,e,n){var h=e[0],m=e[1],y=e[2];return a[0]=h*n[0]+m*n[3]+y*n[6],a[1]=h*n[1]+m*n[4]+y*n[7],a[2]=h*n[2]+m*n[5]+y*n[8],a},_.c7=function(a,e,n,h,m,y,v){var E=1/(e-n),k=1/(h-m),P=1/(y-v);return a[0]=-2*E,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*k,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*P,a[11]=0,a[12]=(e+n)*E,a[13]=(m+h)*k,a[14]=(v+y)*P,a[15]=1,a},_.c8=class extends Vs{constructor(a,e){super(a,e),this.current=new Array}set(a){if(a!=this.current){this.current=a;const e=new Float32Array(4*a.length);for(let n=0;n<a.length;n++)e[4*n]=a[n].r,e[4*n+1]=a[n].g,e[4*n+2]=a[n].b,e[4*n+3]=a[n].a;this.gl.uniform4fv(this.location,e)}}},_.c9=class extends Vs{constructor(a,e){super(a,e),this.current=new Array}set(a){if(a!=this.current){this.current=a;const e=new Float32Array(a);this.gl.uniform1fv(this.location,e)}}},_.cA=function(a,e){return st[e]&&"touches"in a},_.cB=function(a){return st[a]||fe[a]},_.cC=function(a,e,n){var h=e[0],m=e[1];return a[0]=n[0]*h+n[4]*m+n[12],a[1]=n[1]*h+n[5]*m+n[13],a},_.cD=function(a,e){const{x:n,y:h}=ia.fromLngLat(e);return!(a<0||a>25||h<0||h>=1||n<0||n>=1)},_.cE=function(a,e){return a[0]=e[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=e[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=e[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},_.cF=class extends Cu{},_.cG=Ow,_.cI=it,_.cJ=function(a,e){Xe.REGISTERED_PROTOCOLS[a]=e},_.cK=function(a){delete Xe.REGISTERED_PROTOCOLS[a]},_.cL=function(a,e){const n={};for(let m=0;m<a.length;m++){const y=e&&e[a[m].id]||Wn(a[m]);e&&(e[a[m].id]=y);let v=n[y];v||(v=n[y]=[]),v.push(a[m])}const h=[];for(const m in n)h.push(n[m]);return h},_.cM=Cr,_.cN=Nm,_.cO=ag,_.cP=o0,_.cQ=function(a){a.bucket.createArrays(),a.bucket.tilePixelRatio=Oe/(512*a.bucket.overscaling),a.bucket.compareText={},a.bucket.iconsNeedLinear=!1;const e=a.bucket.layers[0],n=e.layout,h=e._unevaluatedLayout._values,m={layoutIconSize:h["icon-size"].possiblyEvaluate(new Qn(a.bucket.zoom+1),a.canonical),layoutTextSize:h["text-size"].possiblyEvaluate(new Qn(a.bucket.zoom+1),a.canonical),textMaxSize:h["text-size"].possiblyEvaluate(new Qn(18))};if(a.bucket.textSizeData.kind==="composite"){const{minZoom:P,maxZoom:z}=a.bucket.textSizeData;m.compositeTextSizes=[h["text-size"].possiblyEvaluate(new Qn(P),a.canonical),h["text-size"].possiblyEvaluate(new Qn(z),a.canonical)]}if(a.bucket.iconSizeData.kind==="composite"){const{minZoom:P,maxZoom:z}=a.bucket.iconSizeData;m.compositeIconSizes=[h["icon-size"].possiblyEvaluate(new Qn(P),a.canonical),h["icon-size"].possiblyEvaluate(new Qn(z),a.canonical)]}const y=n.get("text-line-height")*ki,v=n.get("text-rotation-alignment")!=="viewport"&&n.get("symbol-placement")!=="point",E=n.get("text-keep-upright"),k=n.get("text-size");for(const P of a.bucket.features){const z=n.get("text-font").evaluate(P,{},a.canonical).join(","),G=k.evaluate(P,{},a.canonical),W=m.layoutTextSize.evaluate(P,{},a.canonical),K=m.layoutIconSize.evaluate(P,{},a.canonical),ie={horizontal:{},vertical:void 0},oe=P.text;let ue,be=[0,0];if(oe){const De=oe.toString(),Je=n.get("text-letter-spacing").evaluate(P,{},a.canonical)*ki,at=Nf(De)?Je:0,St=n.get("text-anchor").evaluate(P,{},a.canonical),Xt=Zu(e,P,a.canonical);if(!Xt){const ar=n.get("text-radial-offset").evaluate(P,{},a.canonical);be=ar?ta(St,[ar*ki,On]):n.get("text-offset").evaluate(P,{},a.canonical).map((Zt=>Zt*ki))}let Ut=v?"center":n.get("text-justify").evaluate(P,{},a.canonical);const rr=n.get("symbol-placement")==="point"?n.get("text-max-width").evaluate(P,{},a.canonical)*ki:1/0,wr=()=>{a.bucket.allowVerticalPlacement&&Ll(De)&&(ie.vertical=Xd(oe,a.glyphMap,a.glyphPositions,a.imagePositions,z,rr,y,St,"left",at,be,_.az.vertical,!0,W,G))};if(!v&&Xt){const ar=new Set;if(Ut==="auto")for(let Ft=0;Ft<Xt.values.length;Ft+=2)ar.add(ig(Xt.values[Ft]));else ar.add(Ut);let Zt=!1;for(const Ft of ar)if(!ie.horizontal[Ft])if(Zt)ie.horizontal[Ft]=ie.horizontal[0];else{const Ir=Xd(oe,a.glyphMap,a.glyphPositions,a.imagePositions,z,rr,y,"center",Ft,at,be,_.az.horizontal,!1,W,G);Ir&&(ie.horizontal[Ft]=Ir,Zt=Ir.positionedLines.length===1)}wr()}else{Ut==="auto"&&(Ut=ig(St));const ar=Xd(oe,a.glyphMap,a.glyphPositions,a.imagePositions,z,rr,y,St,Ut,at,be,_.az.horizontal,!1,W,G);ar&&(ie.horizontal[Ut]=ar),wr(),Ll(De)&&v&&E&&(ie.vertical=Xd(oe,a.glyphMap,a.glyphPositions,a.imagePositions,z,rr,y,St,Ut,at,be,_.az.vertical,!1,W,G))}}let We=!1;if(P.icon&&P.icon.name){const De=a.imageMap[P.icon.name];De&&(ue=Mm(a.imagePositions[P.icon.name],n.get("icon-offset").evaluate(P,{},a.canonical),n.get("icon-anchor").evaluate(P,{},a.canonical)),We=!!De.sdf,a.bucket.sdfIcons===void 0?a.bucket.sdfIcons=We:a.bucket.sdfIcons!==We&&se("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(De.pixelRatio!==a.bucket.pixelRatio||n.get("icon-rotate").constantOr(1)!==0)&&(a.bucket.iconsNeedLinear=!0))}const Se=I1(ie.horizontal)||ie.vertical;a.bucket.iconsInText=!!Se&&Se.iconsInText,(Se||ue)&&Lw(a.bucket,P,ie,ue,a.imageMap,m,W,K,be,We,a.canonical,a.subdivisionGranularity)}a.showCollisionBoxes&&a.bucket.generateCollisionDebugBuffers()},_.cR=hf,_.cS=wh,_.cT=Yf,_.cU=function(a){const e=new a0;return(function(n,h){for(const m in n.layers)h.writeMessage(3,D0,n.layers[m])})(a,e),e.finish()},_.cV=function(a,e,n,h,m,y){let v=c(a,e,n,m,0);return v=c(v,e,h,y,1),v},_.cW=class{constructor(a){this.maxEntries=a,this.map=new Map}get(a){const e=this.map.get(a);return e!==void 0&&(this.map.delete(a),this.map.set(a,e)),e}set(a,e){if(this.map.has(a))this.map.delete(a);else if(this.map.size>=this.maxEntries){const n=this.map.keys().next().value;this.map.delete(n)}this.map.set(a,e)}clear(){this.map.clear()}},_.cX=jn,_.cY=a0,_.cZ=pp,_.c_=class{constructor(a){this._marks={start:[a.url,"start"].join("#"),end:[a.url,"end"].join("#"),measure:a.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let a=performance.getEntriesByName(this._marks.measure);return a.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),a=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),a}},_.ca=class extends dc{},_.cb=d_,_.cc=class extends La{},_.cd=Fd,_.ce=function(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},_.cf=Yc,_.cg=function(a,e,n){var h=e[0],m=e[1],y=e[2],v=n[3]*h+n[7]*m+n[11]*y+n[15];return a[0]=(n[0]*h+n[4]*m+n[8]*y+n[12])/(v=v||1),a[1]=(n[1]*h+n[5]*m+n[9]*y+n[13])/v,a[2]=(n[2]*h+n[6]*m+n[10]*y+n[14])/v,a},_.ch=class extends Mu{},_.ci=class extends t{},_.cj=function(a,e){return a[0]===e[0]&&a[1]===e[1]&&a[2]===e[2]&&a[3]===e[3]&&a[4]===e[4]&&a[5]===e[5]&&a[6]===e[6]&&a[7]===e[7]&&a[8]===e[8]&&a[9]===e[9]&&a[10]===e[10]&&a[11]===e[11]&&a[12]===e[12]&&a[13]===e[13]&&a[14]===e[14]&&a[15]===e[15]},_.ck=function(a,e){var n=a[0],h=a[1],m=a[2],y=a[3],v=a[4],E=a[5],k=a[6],P=a[7],z=a[8],G=a[9],W=a[10],K=a[11],ie=a[12],oe=a[13],ue=a[14],be=a[15],We=e[0],Se=e[1],De=e[2],Je=e[3],at=e[4],St=e[5],Xt=e[6],Ut=e[7],rr=e[8],wr=e[9],ar=e[10],Zt=e[11],Ft=e[12],Ir=e[13],Mr=e[14],Lr=e[15];return Math.abs(n-We)<=J*Math.max(1,Math.abs(n),Math.abs(We))&&Math.abs(h-Se)<=J*Math.max(1,Math.abs(h),Math.abs(Se))&&Math.abs(m-De)<=J*Math.max(1,Math.abs(m),Math.abs(De))&&Math.abs(y-Je)<=J*Math.max(1,Math.abs(y),Math.abs(Je))&&Math.abs(v-at)<=J*Math.max(1,Math.abs(v),Math.abs(at))&&Math.abs(E-St)<=J*Math.max(1,Math.abs(E),Math.abs(St))&&Math.abs(k-Xt)<=J*Math.max(1,Math.abs(k),Math.abs(Xt))&&Math.abs(P-Ut)<=J*Math.max(1,Math.abs(P),Math.abs(Ut))&&Math.abs(z-rr)<=J*Math.max(1,Math.abs(z),Math.abs(rr))&&Math.abs(G-wr)<=J*Math.max(1,Math.abs(G),Math.abs(wr))&&Math.abs(W-ar)<=J*Math.max(1,Math.abs(W),Math.abs(ar))&&Math.abs(K-Zt)<=J*Math.max(1,Math.abs(K),Math.abs(Zt))&&Math.abs(ie-Ft)<=J*Math.max(1,Math.abs(ie),Math.abs(Ft))&&Math.abs(oe-Ir)<=J*Math.max(1,Math.abs(oe),Math.abs(Ir))&&Math.abs(ue-Mr)<=J*Math.max(1,Math.abs(ue),Math.abs(Mr))&&Math.abs(be-Lr)<=J*Math.max(1,Math.abs(be),Math.abs(Lr))},_.cl=function(a,e){return a[0]=e[0],a[1]=e[1],a[2]=e[2],a[3]=e[3],a[4]=e[4],a[5]=e[5],a[6]=e[6],a[7]=e[7],a[8]=e[8],a[9]=e[9],a[10]=e[10],a[11]=e[11],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15],a},_.cm=a=>a.type==="symbol",_.cn=a=>a.type==="circle",_.co=a=>a.type==="heatmap",_.cp=a=>a.type==="line",_.cq=a=>a.type==="fill",_.cr=a=>a.type==="fill-extrusion",_.cs=a=>a.type==="hillshade",_.ct=a=>a.type==="color-relief",_.cu=a=>a.type==="background",_.cv=a=>a.type==="custom",_.cw=Fe,_.cx=function(a,e,n){const h=$t(e.x-n.x,e.y-n.y),m=$t(a.x-n.x,a.y-n.y),y=Math.atan2(h[0]*m[1]-h[1]*m[0],(function(v,E){return v[0]*E[0]+v[1]*E[1]})(h,m));return ir(y)},_.cy=Re,_.cz=function(a,e){return fe[e]&&(a instanceof MouseEvent||a instanceof WheelEvent)},_.d=Wt,_.d0=Zf,_.d1=M,_.d2=class{constructor(a,e){this.layers={[mp]:this},this.name=mp,this.version=e?e.version:1,this.extent=e?e.extent:4096,this.length=a.length,this.features=a}feature(a){return new q_(this.features[a],this.extent)}},_.d3=mn,_.d4=ko,_.e=Vt,_.f=a=>s(void 0,void 0,void 0,(function*(){if(a.byteLength===0)return createImageBitmap(new ImageData(1,1));const e=new Blob([new Uint8Array(a)],{type:"image/png"});try{return createImageBitmap(e)}catch(n){throw new Error(`Could not load image because of ${n.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),_.g=xt,_.h=a=>new Promise(((e,n)=>{const h=new Image;h.onload=()=>{e(h),URL.revokeObjectURL(h.src),h.onload=null,window.requestAnimationFrame((()=>{h.src=pt}))},h.onerror=()=>n(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const m=new Blob([new Uint8Array(a)],{type:"image/png"});h.src=a.byteLength?URL.createObjectURL(m):pt})),_.i=yt,_.j=(a,e)=>zt(Vt(a,{type:"json"}),e),_.k=yn,_.l=Kr,_.m=zt,_.n=(a,e)=>zt(Vt(a,{type:"arrayBuffer"}),e),_.o=function(a){return new a0(a).readFields(w_,[])},_.p=Am,_.q=function(a){return/[\u02EA\u02EB\u1100-\u11FF\u2E80-\u2FDF\u3000-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(a))},_.r=Pd,_.s=lr,_.t=ni,_.u=ht,_.v=Su,_.w=se,_.x=Uf,_.y=sl,_.z=uc})),p("worker",["./shared"],(function(_){class s{constructor(fe,he){this.keyCache={},fe&&this.replace(fe,he)}replace(fe,he){this._layerConfigs={},this._layers={},this.update(fe,[],he)}update(fe,he,we){for(const Xe of fe){this._layerConfigs[Xe.id]=Xe;const xt=this._layers[Xe.id]=_.bT(Xe,we);xt._featureFilter=_.aj(xt.filter,we),this.keyCache[Xe.id]&&delete this.keyCache[Xe.id]}for(const Xe of he)delete this.keyCache[Xe],delete this._layerConfigs[Xe],delete this._layers[Xe];this.familiesBySource={};const Ve=_.cL(Object.values(this._layerConfigs),this.keyCache);for(const Xe of Ve){const xt=Xe.map((mr=>this._layers[mr.id])),ot=xt[0];if(ot.isHidden())continue;const it=ot.source||"";let vt=this.familiesBySource[it];vt||(vt=this.familiesBySource[it]={});const zt=ot.sourceLayer||_.ai;let Wt=vt[zt];Wt||(Wt=vt[zt]=[]),Wt.push(xt)}}}class C{constructor(fe){const he={},we=[];for(const ot in fe){const it=fe[ot],vt=he[ot]={};for(const zt in it){const Wt=it[+zt];if(!Wt||Wt.bitmap.width===0||Wt.bitmap.height===0)continue;const mr={x:0,y:0,w:Wt.bitmap.width+2,h:Wt.bitmap.height+2};we.push(mr),vt[zt]={rect:mr,metrics:Wt.metrics}}}const{w:Ve,h:Xe}=_.p(we),xt=new _.r({width:Ve||1,height:Xe||1});for(const ot in fe){const it=fe[ot];for(const vt in it){const zt=it[+vt];if(!zt||zt.bitmap.width===0||zt.bitmap.height===0)continue;const Wt=he[ot][vt].rect;_.r.copy(zt.bitmap,xt,{x:0,y:0},{x:Wt.x+1,y:Wt.y+1},zt.bitmap)}}this.image=xt,this.positions=he}}_.cM("GlyphAtlas",C);class M{constructor(fe){this.tileID=new _.a2(fe.tileID.overscaledZ,fe.tileID.wrap,fe.tileID.canonical.z,fe.tileID.canonical.x,fe.tileID.canonical.y),this.uid=fe.uid,this.zoom=fe.zoom,this.pixelRatio=fe.pixelRatio,this.tileSize=fe.tileSize,this.source=fe.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=fe.showCollisionBoxes,this.collectResourceTiming=!!fe.collectResourceTiming,this.returnDependencies=!!fe.returnDependencies,this.promoteId=fe.promoteId,this.inFlightDependencies=[]}parse(fe,he,we,Ve,Xe){return _._(this,void 0,void 0,(function*(){this.status="parsing",this.data=fe,this.collisionBoxArray=new _.ag;const xt=new _.cN(Object.keys(fe.layers).sort()),ot=new _.cO(this.tileID,this.promoteId);ot.bucketLayerIDs=[];const it={},vt={featureIndex:ot,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:we,subdivisionGranularity:Xe},zt=he.familiesBySource[this.source];for(const Bn in zt){const ba=fe.layers[Bn];if(!ba)continue;ba.version===1&&_.w(`Vector tile source "${this.source}" layer "${Bn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const El=xt.encode(Bn),Zo=[];for(let Qt=0;Qt<ba.length;Qt++){const ye=ba.feature(Qt),je=ot.getId(ye,Bn);Zo.push({feature:ye,id:je,index:Qt,sourceLayerIndex:El})}for(const Qt of zt[Bn]){const ye=Qt[0];ye.source!==this.source&&_.w(`layer.source = ${ye.source} does not equal this.source = ${this.source}`),ye.isHidden(this.zoom,!0)||(D(Qt,this.zoom,we),(it[ye.id]=ye.createBucket({index:ot.bucketLayerIDs.length,layers:Qt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:El,sourceID:this.source})).populate(Zo,vt,this.tileID.canonical),ot.bucketLayerIDs.push(Qt.map((je=>je.id))))}}const Wt=_.bY(vt.glyphDependencies,(Bn=>Object.keys(Bn).map(Number)));this.inFlightDependencies.forEach((Bn=>Bn?.abort())),this.inFlightDependencies=[];let mr=Promise.resolve({});if(Object.keys(Wt).length){const Bn=new AbortController;this.inFlightDependencies.push(Bn),mr=Ve.sendAsync({type:"GG",data:{stacks:Wt,source:this.source,tileID:this.tileID,type:"glyphs"}},Bn)}const kr=Object.keys(vt.iconDependencies);let Kr=Promise.resolve({});if(kr.length){const Bn=new AbortController;this.inFlightDependencies.push(Bn),Kr=Ve.sendAsync({type:"GI",data:{icons:kr,source:this.source,tileID:this.tileID,type:"icons"}},Bn)}const yn=Object.keys(vt.patternDependencies);let hn=Promise.resolve({});if(yn.length){const Bn=new AbortController;this.inFlightDependencies.push(Bn),hn=Ve.sendAsync({type:"GI",data:{icons:yn,source:this.source,tileID:this.tileID,type:"patterns"}},Bn)}const ht=vt.dashDependencies;let En=Promise.resolve({});if(Object.keys(ht).length){const Bn=new AbortController;this.inFlightDependencies.push(Bn),En=Ve.sendAsync({type:"GDA",data:{dashes:ht}},Bn)}const[Kn,Qr,Ln,Ba]=yield Promise.all([mr,Kr,hn,En]),zn=new C(Kn),tn=new _.cP(Qr,Ln);for(const Bn in it){const ba=it[Bn];ba instanceof _.ah?(D(ba.layers,this.zoom,we),_.cQ({bucket:ba,glyphMap:Kn,glyphPositions:zn.positions,imageMap:Qr,imagePositions:tn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:vt.subdivisionGranularity})):ba.hasDependencies&&(ba instanceof _.cR||ba instanceof _.cS||ba instanceof _.cT)&&(D(ba.layers,this.zoom,we),ba.addFeatures(vt,this.tileID.canonical,tn.patternPositions,Ba))}return this.status="done",{buckets:Object.values(it).filter((Bn=>!Bn.isEmpty())),featureIndex:ot,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:zn.image,imageAtlas:tn,dashPositions:Ba,glyphMap:this.returnDependencies?Kn:null,iconMap:this.returnDependencies?Qr:null,glyphPositions:this.returnDependencies?zn.positions:null}}))}}function D(st,fe,he){const we=new _.H(fe);for(const Ve of st)Ve.recalculate(we,he)}class B{constructor(fe,he,we,Ve,Xe){this.type=fe,this.properties=we||{},this.extent=Xe,this.pointsArray=he,this.id=Ve}loadGeometry(){return this.pointsArray.map((fe=>fe.map((he=>new _.P(he.x,he.y)))))}}class U{constructor(fe,he,we){this.version=2,this._myFeatures=fe,this.name=he,this.length=fe.length,this.extent=we}feature(fe){return this._myFeatures[fe]}}class j{constructor(){this.layers={}}addLayer(fe){this.layers[fe.name]=fe}}function H(st){let fe=_.cU(st);return fe.byteOffset===0&&fe.byteLength===fe.buffer.byteLength||(fe=new Uint8Array(fe)),{vectorTile:st,rawData:fe.buffer}}function O(st,fe,he){const{extent:we}=st,Ve=Math.pow(2,he.z-fe.z),Xe=(he.x-fe.x*Ve)*we,xt=(he.y-fe.y*Ve)*we,ot=[];for(let it=0;it<st.length;it++){const vt=st.feature(it);let zt=vt.loadGeometry();for(const mr of zt)for(const kr of mr)kr.x=kr.x*Ve-Xe,kr.y=kr.y*Ve-xt;const Wt=128;zt=_.cV(zt,vt.type,-Wt,-Wt,we+Wt,we+Wt),zt.length!==0&&ot.push(new B(vt.type,zt,vt.properties,vt.id,we))}return new U(ot,st.name,we)}class N{constructor(fe,he,we){this.actor=fe,this.layerIndex=he,this.availableImages=we,this.fetching={},this.loading={},this.loaded={},this.overzoomedTileResultCache=new _.cW(1e3)}loadVectorTile(fe,he){return _._(this,void 0,void 0,(function*(){const we=yield _.n(fe.request,he);try{return{vectorTile:fe.encoding!=="mlt"?new _.cX(new _.cY(we.data)):new _.cZ(we.data),rawData:we.data,cacheControl:we.cacheControl,expires:we.expires}}catch(Ve){const Xe=new Uint8Array(we.data);let xt=`Unable to parse the tile at ${fe.request.url}, `;throw xt+=Xe[0]===31&&Xe[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${Ve.message}`,new Error(xt)}}))}loadTile(fe){return _._(this,void 0,void 0,(function*(){const{uid:he,overzoomParameters:we}=fe;we&&(fe.request=we.overzoomRequest);const Ve=!!(fe&&fe.request&&fe.request.collectResourceTiming)&&new _.c_(fe.request),Xe=new M(fe);this.loading[he]=Xe;const xt=new AbortController;Xe.abort=xt;try{const ot=yield this.loadVectorTile(fe,xt);if(delete this.loading[he],!ot)return null;if(we){const mr=this._getOverzoomTile(fe,ot.vectorTile);ot.rawData=mr.rawData,ot.vectorTile=mr.vectorTile}const it=ot.rawData,vt={};ot.expires&&(vt.expires=ot.expires),ot.cacheControl&&(vt.cacheControl=ot.cacheControl);const zt={};if(Ve){const mr=Ve.finish();mr&&(zt.resourceTiming=JSON.parse(JSON.stringify(mr)))}Xe.vectorTile=ot.vectorTile;const Wt=Xe.parse(ot.vectorTile,this.layerIndex,this.availableImages,this.actor,fe.subdivisionGranularity);this.loaded[he]=Xe,this.fetching[he]={rawTileData:it,cacheControl:vt,resourceTiming:zt};try{const mr=yield Wt;return _.e({rawTileData:it.slice(0),encoding:fe.encoding},mr,vt,zt)}finally{delete this.fetching[he]}}catch(ot){throw delete this.loading[he],Xe.status="done",this.loaded[he]=Xe,ot}}))}_getOverzoomTile(fe,he){const{tileID:we,source:Ve,overzoomParameters:Xe}=fe,{maxZoomTileID:xt}=Xe,ot=`${xt.key}_${we.key}`,it=this.overzoomedTileResultCache.get(ot);if(it)return it;const vt=new j,zt=this.layerIndex.familiesBySource[Ve];for(const mr in zt){const kr=he.layers[mr];if(!kr)continue;const Kr=O(kr,xt,we.canonical);Kr.length>0&&vt.addLayer(Kr)}const Wt=H(vt);return this.overzoomedTileResultCache.set(ot,Wt),Wt}reloadTile(fe){return _._(this,void 0,void 0,(function*(){const he=fe.uid;if(!this.loaded||!this.loaded[he])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const we=this.loaded[he];if(we.showCollisionBoxes=fe.showCollisionBoxes,we.status==="parsing"){const Ve=yield we.parse(we.vectorTile,this.layerIndex,this.availableImages,this.actor,fe.subdivisionGranularity);let Xe;if(this.fetching[he]){const{rawTileData:xt,cacheControl:ot,resourceTiming:it}=this.fetching[he];delete this.fetching[he],Xe=_.e({rawTileData:xt.slice(0),encoding:fe.encoding},Ve,ot,it)}else Xe=Ve;return Xe}if(we.status==="done"&&we.vectorTile)return we.parse(we.vectorTile,this.layerIndex,this.availableImages,this.actor,fe.subdivisionGranularity)}))}abortTile(fe){return _._(this,void 0,void 0,(function*(){const he=this.loading,we=fe.uid;he&&he[we]&&he[we].abort&&(he[we].abort.abort(),delete he[we])}))}removeTile(fe){return _._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[fe.uid]&&delete this.loaded[fe.uid]}))}}class Z{constructor(){this.loaded={}}loadTile(fe){return _._(this,void 0,void 0,(function*(){const{uid:he,encoding:we,rawImageData:Ve,redFactor:Xe,greenFactor:xt,blueFactor:ot,baseShift:it}=fe,vt=Ve.width+2,zt=Ve.height+2,Wt=_.b(Ve)?new _.R({width:vt,height:zt},yield _.c$(Ve,-1,-1,vt,zt)):Ve,mr=new _.d0(he,Wt,we,Xe,xt,ot,it);return this.loaded=this.loaded||{},this.loaded[he]=mr,mr}))}removeTile(fe){const he=this.loaded,we=fe.uid;he&&he[we]&&delete he[we]}}var J,X,pe=(function(){if(X)return J;function st(he,we){if(he.length!==0){fe(he[0],we);for(var Ve=1;Ve<he.length;Ve++)fe(he[Ve],!we)}}function fe(he,we){for(var Ve=0,Xe=0,xt=0,ot=he.length,it=ot-1;xt<ot;it=xt++){var vt=(he[xt][0]-he[it][0])*(he[it][1]+he[xt][1]),zt=Ve+vt;Xe+=Math.abs(Ve)>=Math.abs(vt)?Ve-zt+vt:vt-zt+Ve,Ve=zt}Ve+Xe>=0!=!!we&&he.reverse()}return X=1,J=function he(we,Ve){var Xe,xt=we&&we.type;if(xt==="FeatureCollection")for(Xe=0;Xe<we.features.length;Xe++)he(we.features[Xe],Ve);else if(xt==="GeometryCollection")for(Xe=0;Xe<we.geometries.length;Xe++)he(we.geometries[Xe],Ve);else if(xt==="Feature")he(we.geometry,Ve);else if(xt==="Polygon")st(we.coordinates,Ve);else if(xt==="MultiPolygon")for(Xe=0;Xe<we.coordinates.length;Xe++)st(we.coordinates[Xe],Ve);return we}})(),ge=_.d1(pe);const ve={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:st=>st},re=Math.fround||(Ce=new Float32Array(1),st=>(Ce[0]=+st,Ce[0]));var Ce;class xe{constructor(fe){this.options=Object.assign(Object.create(ve),fe),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(fe){const{log:he,minZoom:we,maxZoom:Ve}=this.options;he&&console.time("total time");const Xe=`prepare ${fe.length} points`;he&&console.time(Xe),this.points=fe;const xt=[];for(let it=0;it<fe.length;it++){const vt=fe[it];if(!vt.geometry)continue;const[zt,Wt]=vt.geometry.coordinates,mr=re(de(zt)),kr=re(nt(Wt));xt.push(mr,kr,1/0,it,-1,1),this.options.reduce&&xt.push(0)}let ot=this.trees[Ve+1]=this._createTree(xt);he&&console.timeEnd(Xe);for(let it=Ve;it>=we;it--){const vt=+Date.now();ot=this.trees[it]=this._createTree(this._cluster(ot,it)),he&&console.log("z%d: %d clusters in %dms",it,ot.numItems,+Date.now()-vt)}return he&&console.timeEnd("total time"),this}getClusters(fe,he){let we=((fe[0]+180)%360+360)%360-180;const Ve=Math.max(-90,Math.min(90,fe[1]));let Xe=fe[2]===180?180:((fe[2]+180)%360+360)%360-180;const xt=Math.max(-90,Math.min(90,fe[3]));if(fe[2]-fe[0]>=360)we=-180,Xe=180;else if(we>Xe){const Wt=this.getClusters([we,Ve,180,xt],he),mr=this.getClusters([-180,Ve,Xe,xt],he);return Wt.concat(mr)}const ot=this.trees[this._limitZoom(he)],it=ot.range(de(we),nt(xt),de(Xe),nt(Ve)),vt=ot.data,zt=[];for(const Wt of it){const mr=this.stride*Wt;zt.push(vt[mr+5]>1?Ge(vt,mr,this.clusterProps):this.points[vt[mr+3]])}return zt}getChildren(fe){const he=this._getOriginId(fe),we=this._getOriginZoom(fe),Ve="No cluster with the specified id.",Xe=this.trees[we];if(!Xe)throw new Error(Ve);const xt=Xe.data;if(he*this.stride>=xt.length)throw new Error(Ve);const ot=this.options.radius/(this.options.extent*Math.pow(2,we-1)),it=Xe.within(xt[he*this.stride],xt[he*this.stride+1],ot),vt=[];for(const zt of it){const Wt=zt*this.stride;xt[Wt+4]===fe&&vt.push(xt[Wt+5]>1?Ge(xt,Wt,this.clusterProps):this.points[xt[Wt+3]])}if(vt.length===0)throw new Error(Ve);return vt}getLeaves(fe,he,we){const Ve=[];return this._appendLeaves(Ve,fe,he=he||10,we=we||0,0),Ve}getTile(fe,he,we){const Ve=this.trees[this._limitZoom(fe)],Xe=Math.pow(2,fe),{extent:xt,radius:ot}=this.options,it=ot/xt,vt=(we-it)/Xe,zt=(we+1+it)/Xe,Wt={features:[]};return this._addTileFeatures(Ve.range((he-it)/Xe,vt,(he+1+it)/Xe,zt),Ve.data,he,we,Xe,Wt),he===0&&this._addTileFeatures(Ve.range(1-it/Xe,vt,1,zt),Ve.data,Xe,we,Xe,Wt),he===Xe-1&&this._addTileFeatures(Ve.range(0,vt,it/Xe,zt),Ve.data,-1,we,Xe,Wt),Wt.features.length?Wt:null}getClusterExpansionZoom(fe){let he=this._getOriginZoom(fe)-1;for(;he<=this.options.maxZoom;){const we=this.getChildren(fe);if(he++,we.length!==1)break;fe=we[0].properties.cluster_id}return he}_appendLeaves(fe,he,we,Ve,Xe){const xt=this.getChildren(he);for(const ot of xt){const it=ot.properties;if(it&&it.cluster?Xe+it.point_count<=Ve?Xe+=it.point_count:Xe=this._appendLeaves(fe,it.cluster_id,we,Ve,Xe):Xe<Ve?Xe++:fe.push(ot),fe.length===we)break}return Xe}_createTree(fe){const he=new _.aT(fe.length/this.stride|0,this.options.nodeSize,Float32Array);for(let we=0;we<fe.length;we+=this.stride)he.add(fe[we],fe[we+1]);return he.finish(),he.data=fe,he}_addTileFeatures(fe,he,we,Ve,Xe,xt){for(const ot of fe){const it=ot*this.stride,vt=he[it+5]>1;let zt,Wt,mr;if(vt)zt=$e(he,it,this.clusterProps),Wt=he[it],mr=he[it+1];else{const yn=this.points[he[it+3]];zt=yn.properties;const[hn,ht]=yn.geometry.coordinates;Wt=de(hn),mr=nt(ht)}const kr={type:1,geometry:[[Math.round(this.options.extent*(Wt*Xe-we)),Math.round(this.options.extent*(mr*Xe-Ve))]],tags:zt};let Kr;Kr=vt||this.options.generateId?he[it+3]:this.points[he[it+3]].id,Kr!==void 0&&(kr.id=Kr),xt.features.push(kr)}}_limitZoom(fe){return Math.max(this.options.minZoom,Math.min(Math.floor(+fe),this.options.maxZoom+1))}_cluster(fe,he){const{radius:we,extent:Ve,reduce:Xe,minPoints:xt}=this.options,ot=we/(Ve*Math.pow(2,he)),it=fe.data,vt=[],zt=this.stride;for(let Wt=0;Wt<it.length;Wt+=zt){if(it[Wt+2]<=he)continue;it[Wt+2]=he;const mr=it[Wt],kr=it[Wt+1],Kr=fe.within(it[Wt],it[Wt+1],ot),yn=it[Wt+5];let hn=yn;for(const ht of Kr){const En=ht*zt;it[En+2]>he&&(hn+=it[En+5])}if(hn>yn&&hn>=xt){let ht,En=mr*yn,Kn=kr*yn,Qr=-1;const Ln=(Wt/zt<<5)+(he+1)+this.points.length;for(const Ba of Kr){const zn=Ba*zt;if(it[zn+2]<=he)continue;it[zn+2]=he;const tn=it[zn+5];En+=it[zn]*tn,Kn+=it[zn+1]*tn,it[zn+4]=Ln,Xe&&(ht||(ht=this._map(it,Wt,!0),Qr=this.clusterProps.length,this.clusterProps.push(ht)),Xe(ht,this._map(it,zn)))}it[Wt+4]=Ln,vt.push(En/hn,Kn/hn,1/0,Ln,-1,hn),Xe&&vt.push(Qr)}else{for(let ht=0;ht<zt;ht++)vt.push(it[Wt+ht]);if(hn>1)for(const ht of Kr){const En=ht*zt;if(!(it[En+2]<=he)){it[En+2]=he;for(let Kn=0;Kn<zt;Kn++)vt.push(it[En+Kn])}}}}return vt}_getOriginId(fe){return fe-this.points.length>>5}_getOriginZoom(fe){return(fe-this.points.length)%32}_map(fe,he,we){if(fe[he+5]>1){const xt=this.clusterProps[fe[he+6]];return we?Object.assign({},xt):xt}const Ve=this.points[fe[he+3]].properties,Xe=this.options.map(Ve);return we&&Xe===Ve?Object.assign({},Xe):Xe}}function Ge(st,fe,he){return{type:"Feature",id:st[fe+3],properties:$e(st,fe,he),geometry:{type:"Point",coordinates:[(we=st[fe],360*(we-.5)),le(st[fe+1])]}};var we}function $e(st,fe,he){const we=st[fe+5],Ve=we>=1e4?`${Math.round(we/1e3)}k`:we>=1e3?Math.round(we/100)/10+"k":we,Xe=st[fe+6],xt=Xe===-1?{}:Object.assign({},he[Xe]);return Object.assign(xt,{cluster:!0,cluster_id:st[fe+3],point_count:we,point_count_abbreviated:Ve})}function de(st){return st/360+.5}function nt(st){const fe=Math.sin(st*Math.PI/180),he=.5-.25*Math.log((1+fe)/(1-fe))/Math.PI;return he<0?0:he>1?1:he}function le(st){const fe=(180-360*st)*Math.PI/180;return 360*Math.atan(Math.exp(fe))/Math.PI-90}function ct(st,fe,he,we){let Ve=we;const Xe=fe+(he-fe>>1);let xt,ot=he-fe;const it=st[fe],vt=st[fe+1],zt=st[he],Wt=st[he+1];for(let mr=fe+3;mr<he;mr+=3){const kr=et(st[mr],st[mr+1],it,vt,zt,Wt);if(kr>Ve)xt=mr,Ve=kr;else if(kr===Ve){const Kr=Math.abs(mr-Xe);Kr<ot&&(xt=mr,ot=Kr)}}Ve>we&&(xt-fe>3&&ct(st,fe,xt,we),st[xt+2]=Ve,he-xt>3&&ct(st,xt,he,we))}function et(st,fe,he,we,Ve,Xe){let xt=Ve-he,ot=Xe-we;if(xt!==0||ot!==0){const it=((st-he)*xt+(fe-we)*ot)/(xt*xt+ot*ot);it>1?(he=Ve,we=Xe):it>0&&(he+=xt*it,we+=ot*it)}return xt=st-he,ot=fe-we,xt*xt+ot*ot}function He(st,fe,he,we){const Ve={id:st??null,type:fe,geometry:he,tags:we,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(fe==="Point"||fe==="MultiPoint"||fe==="LineString")$t(Ve,he);else if(fe==="Polygon")$t(Ve,he[0]);else if(fe==="MultiLineString")for(const Xe of he)$t(Ve,Xe);else if(fe==="MultiPolygon")for(const Xe of he)$t(Ve,Xe[0]);return Ve}function $t(st,fe){for(let he=0;he<fe.length;he+=3)st.minX=Math.min(st.minX,fe[he]),st.minY=Math.min(st.minY,fe[he+1]),st.maxX=Math.max(st.maxX,fe[he]),st.maxY=Math.max(st.maxY,fe[he+1])}function Oe(st,fe,he,we){if(!fe.geometry)return;const Ve=fe.geometry.coordinates;if(Ve&&Ve.length===0)return;const Xe=fe.geometry.type,xt=Math.pow(he.tolerance/((1<<he.maxZoom)*he.extent),2);let ot=[],it=fe.id;if(he.promoteId?it=fe.properties[he.promoteId]:he.generateId&&(it=we||0),Xe==="Point")It(Ve,ot);else if(Xe==="MultiPoint")for(const vt of Ve)It(vt,ot);else if(Xe==="LineString")me(Ve,ot,xt,!1);else if(Xe==="MultiLineString"){if(he.lineMetrics){for(const vt of Ve)ot=[],me(vt,ot,xt,!1),st.push(He(it,"LineString",ot,fe.properties));return}ne(Ve,ot,xt,!1)}else if(Xe==="Polygon")ne(Ve,ot,xt,!0);else{if(Xe!=="MultiPolygon"){if(Xe==="GeometryCollection"){for(const vt of fe.geometry.geometries)Oe(st,{id:it,geometry:vt,properties:fe.properties},he,we);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const vt of Ve){const zt=[];ne(vt,zt,xt,!0),ot.push(zt)}}st.push(He(it,Xe,ot,fe.properties))}function It(st,fe){fe.push(Ue(st[0]),Fe(st[1]),0)}function me(st,fe,he,we){let Ve,Xe,xt=0;for(let it=0;it<st.length;it++){const vt=Ue(st[it][0]),zt=Fe(st[it][1]);fe.push(vt,zt,0),it>0&&(xt+=we?(Ve*zt-vt*Xe)/2:Math.sqrt(Math.pow(vt-Ve,2)+Math.pow(zt-Xe,2))),Ve=vt,Xe=zt}const ot=fe.length-3;fe[2]=1,ct(fe,0,ot,he),fe[ot+2]=1,fe.size=Math.abs(xt),fe.start=0,fe.end=fe.size}function ne(st,fe,he,we){for(let Ve=0;Ve<st.length;Ve++){const Xe=[];me(st[Ve],Xe,he,we),fe.push(Xe)}}function Ue(st){return st/360+.5}function Fe(st){const fe=Math.sin(st*Math.PI/180),he=.5-.25*Math.log((1+fe)/(1-fe))/Math.PI;return he<0?0:he>1?1:he}function Re(st,fe,he,we,Ve,Xe,xt,ot){if(we/=fe,Xe>=(he/=fe)&&xt<we)return st;if(xt<he||Xe>=we)return null;const it=[];for(const vt of st){const zt=vt.geometry;let Wt=vt.type;const mr=Ve===0?vt.minX:vt.minY,kr=Ve===0?vt.maxX:vt.maxY;if(mr>=he&&kr<we){it.push(vt);continue}if(kr<he||mr>=we)continue;let Kr=[];if(Wt==="Point"||Wt==="MultiPoint")bt(zt,Kr,he,we,Ve);else if(Wt==="LineString")Gt(zt,Kr,he,we,Ve,!1,ot.lineMetrics);else if(Wt==="MultiLineString")Bt(zt,Kr,he,we,Ve,!1);else if(Wt==="Polygon")Bt(zt,Kr,he,we,Ve,!0);else if(Wt==="MultiPolygon")for(const yn of zt){const hn=[];Bt(yn,hn,he,we,Ve,!0),hn.length&&Kr.push(hn)}if(Kr.length){if(ot.lineMetrics&&Wt==="LineString"){for(const yn of Kr)it.push(He(vt.id,Wt,yn,vt.tags));continue}Wt!=="LineString"&&Wt!=="MultiLineString"||(Kr.length===1?(Wt="LineString",Kr=Kr[0]):Wt="MultiLineString"),Wt!=="Point"&&Wt!=="MultiPoint"||(Wt=Kr.length===3?"Point":"MultiPoint"),it.push(He(vt.id,Wt,Kr,vt.tags))}}return it.length?it:null}function bt(st,fe,he,we,Ve){for(let Xe=0;Xe<st.length;Xe+=3){const xt=st[Xe+Ve];xt>=he&&xt<=we&&Yt(fe,st[Xe],st[Xe+1],st[Xe+2])}}function Gt(st,fe,he,we,Ve,Xe,xt){let ot=Vt(st);const it=Ve===0?Or:Ye;let vt,zt,Wt=st.start;for(let hn=0;hn<st.length-3;hn+=3){const ht=st[hn],En=st[hn+1],Kn=st[hn+2],Qr=st[hn+3],Ln=st[hn+4],Ba=Ve===0?ht:En,zn=Ve===0?Qr:Ln;let tn=!1;xt&&(vt=Math.sqrt(Math.pow(ht-Qr,2)+Math.pow(En-Ln,2))),Ba<he?zn>he&&(zt=it(ot,ht,En,Qr,Ln,he),xt&&(ot.start=Wt+vt*zt)):Ba>we?zn<we&&(zt=it(ot,ht,En,Qr,Ln,we),xt&&(ot.start=Wt+vt*zt)):Yt(ot,ht,En,Kn),zn<he&&Ba>=he&&(zt=it(ot,ht,En,Qr,Ln,he),tn=!0),zn>we&&Ba<=we&&(zt=it(ot,ht,En,Qr,Ln,we),tn=!0),!Xe&&tn&&(xt&&(ot.end=Wt+vt*zt),fe.push(ot),ot=Vt(st)),xt&&(Wt+=vt)}let mr=st.length-3;const kr=st[mr],Kr=st[mr+1],yn=Ve===0?kr:Kr;yn>=he&&yn<=we&&Yt(ot,kr,Kr,st[mr+2]),mr=ot.length-3,Xe&&mr>=3&&(ot[mr]!==ot[0]||ot[mr+1]!==ot[1])&&Yt(ot,ot[0],ot[1],ot[2]),ot.length&&fe.push(ot)}function Vt(st){const fe=[];return fe.size=st.size,fe.start=st.start,fe.end=st.end,fe}function Bt(st,fe,he,we,Ve,Xe){for(const xt of st)Gt(xt,fe,he,we,Ve,Xe,!1)}function Yt(st,fe,he,we){st.push(fe,he,we)}function Or(st,fe,he,we,Ve,Xe){const xt=(Xe-fe)/(we-fe);return Yt(st,Xe,he+(Ve-he)*xt,1),xt}function Ye(st,fe,he,we,Ve,Xe){const xt=(Xe-he)/(Ve-he);return Yt(st,fe+(we-fe)*xt,Xe,1),xt}function pn(st,fe){const he=[];for(let we=0;we<st.length;we++){const Ve=st[we],Xe=Ve.type;let xt;if(Xe==="Point"||Xe==="MultiPoint"||Xe==="LineString")xt=se(Ve.geometry,fe);else if(Xe==="MultiLineString"||Xe==="Polygon"){xt=[];for(const ot of Ve.geometry)xt.push(se(ot,fe))}else if(Xe==="MultiPolygon"){xt=[];for(const ot of Ve.geometry){const it=[];for(const vt of ot)it.push(se(vt,fe));xt.push(it)}}he.push(He(Ve.id,Xe,xt,Ve.tags))}return he}function se(st,fe){const he=[];he.size=st.size,st.start!==void 0&&(he.start=st.start,he.end=st.end);for(let we=0;we<st.length;we+=3)he.push(st[we]+fe,st[we+1],st[we+2]);return he}function Mt(st,fe){if(st.transformed)return st;const he=1<<st.z,we=st.x,Ve=st.y;for(const Xe of st.features){const xt=Xe.geometry,ot=Xe.type;if(Xe.geometry=[],ot===1)for(let it=0;it<xt.length;it+=2)Xe.geometry.push(yt(xt[it],xt[it+1],fe,he,we,Ve));else for(let it=0;it<xt.length;it++){const vt=[];for(let zt=0;zt<xt[it].length;zt+=2)vt.push(yt(xt[it][zt],xt[it][zt+1],fe,he,we,Ve));Xe.geometry.push(vt)}}return st.transformed=!0,st}function yt(st,fe,he,we,Ve,Xe){return[Math.round(he*(st*we-Ve)),Math.round(he*(fe*we-Xe))]}function Ee(st,fe,he,we,Ve){const Xe=fe===Ve.maxZoom?0:Ve.tolerance/((1<<fe)*Ve.extent),xt={features:[],numPoints:0,numSimplified:0,numFeatures:st.length,source:null,x:he,y:we,z:fe,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const ot of st)Ne(xt,ot,Xe,Ve);return xt}function Ne(st,fe,he,we){const Ve=fe.geometry,Xe=fe.type,xt=[];if(st.minX=Math.min(st.minX,fe.minX),st.minY=Math.min(st.minY,fe.minY),st.maxX=Math.max(st.maxX,fe.maxX),st.maxY=Math.max(st.maxY,fe.maxY),Xe==="Point"||Xe==="MultiPoint")for(let ot=0;ot<Ve.length;ot+=3)xt.push(Ve[ot],Ve[ot+1]),st.numPoints++,st.numSimplified++;else if(Xe==="LineString")pt(xt,Ve,st,he,!1,!1);else if(Xe==="MultiLineString"||Xe==="Polygon")for(let ot=0;ot<Ve.length;ot++)pt(xt,Ve[ot],st,he,Xe==="Polygon",ot===0);else if(Xe==="MultiPolygon")for(let ot=0;ot<Ve.length;ot++){const it=Ve[ot];for(let vt=0;vt<it.length;vt++)pt(xt,it[vt],st,he,!0,vt===0)}if(xt.length){let ot=fe.tags||null;if(Xe==="LineString"&&we.lineMetrics){ot={};for(const vt in fe.tags)ot[vt]=fe.tags[vt];ot.mapbox_clip_start=Ve.start/Ve.size,ot.mapbox_clip_end=Ve.end/Ve.size}const it={geometry:xt,type:Xe==="Polygon"||Xe==="MultiPolygon"?3:Xe==="LineString"||Xe==="MultiLineString"?2:1,tags:ot};fe.id!==null&&(it.id=fe.id),st.features.push(it)}}function pt(st,fe,he,we,Ve,Xe){const xt=we*we;if(we>0&&fe.size<(Ve?xt:we))return void(he.numPoints+=fe.length/3);const ot=[];for(let it=0;it<fe.length;it+=3)(we===0||fe[it+2]>xt)&&(he.numSimplified++,ot.push(fe[it],fe[it+1])),he.numPoints++;Ve&&(function(it,vt){let zt=0;for(let Wt=0,mr=it.length,kr=mr-2;Wt<mr;kr=Wt,Wt+=2)zt+=(it[Wt]-it[kr])*(it[Wt+1]+it[kr+1]);if(zt>0===vt)for(let Wt=0,mr=it.length;Wt<mr/2;Wt+=2){const kr=it[Wt],Kr=it[Wt+1];it[Wt]=it[mr-2-Wt],it[Wt+1]=it[mr-1-Wt],it[mr-2-Wt]=kr,it[mr-1-Wt]=Kr}})(ot,Xe),st.push(ot)}const Jt={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Kt{constructor(fe,he){const we=(he=this.options=(function(Xe,xt){for(const ot in xt)Xe[ot]=xt[ot];return Xe})(Object.create(Jt),he)).debug;if(we&&console.time("preprocess data"),he.maxZoom<0||he.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(he.promoteId&&he.generateId)throw new Error("promoteId and generateId cannot be used together.");let Ve=(function(Xe,xt){const ot=[];if(Xe.type==="FeatureCollection")for(let it=0;it<Xe.features.length;it++)Oe(ot,Xe.features[it],xt,it);else Oe(ot,Xe.type==="Feature"?Xe:{geometry:Xe},xt);return ot})(fe,he);this.tiles={},this.tileCoords=[],we&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",he.indexMaxZoom,he.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Ve=(function(Xe,xt){const ot=xt.buffer/xt.extent;let it=Xe;const vt=Re(Xe,1,-1-ot,ot,0,-1,2,xt),zt=Re(Xe,1,1-ot,2+ot,0,-1,2,xt);return(vt||zt)&&(it=Re(Xe,1,-ot,1+ot,0,-1,2,xt)||[],vt&&(it=pn(vt,1).concat(it)),zt&&(it=it.concat(pn(zt,-1)))),it})(Ve,he),Ve.length&&this.splitTile(Ve,0,0,0),we&&(Ve.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(fe,he,we,Ve,Xe,xt,ot){const it=[fe,he,we,Ve],vt=this.options,zt=vt.debug;for(;it.length;){Ve=it.pop(),we=it.pop(),he=it.pop(),fe=it.pop();const Wt=1<<he,mr=Et(he,we,Ve);let kr=this.tiles[mr];if(!kr&&(zt>1&&console.time("creation"),kr=this.tiles[mr]=Ee(fe,he,we,Ve,vt),this.tileCoords.push({z:he,x:we,y:Ve}),zt)){zt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",he,we,Ve,kr.numFeatures,kr.numPoints,kr.numSimplified),console.timeEnd("creation"));const tn=`z${he}`;this.stats[tn]=(this.stats[tn]||0)+1,this.total++}if(kr.source=fe,Xe==null){if(he===vt.indexMaxZoom||kr.numPoints<=vt.indexMaxPoints)continue}else{if(he===vt.maxZoom||he===Xe)continue;if(Xe!=null){const tn=Xe-he;if(we!==xt>>tn||Ve!==ot>>tn)continue}}if(kr.source=null,fe.length===0)continue;zt>1&&console.time("clipping");const Kr=.5*vt.buffer/vt.extent,yn=.5-Kr,hn=.5+Kr,ht=1+Kr;let En=null,Kn=null,Qr=null,Ln=null,Ba=Re(fe,Wt,we-Kr,we+hn,0,kr.minX,kr.maxX,vt),zn=Re(fe,Wt,we+yn,we+ht,0,kr.minX,kr.maxX,vt);fe=null,Ba&&(En=Re(Ba,Wt,Ve-Kr,Ve+hn,1,kr.minY,kr.maxY,vt),Kn=Re(Ba,Wt,Ve+yn,Ve+ht,1,kr.minY,kr.maxY,vt),Ba=null),zn&&(Qr=Re(zn,Wt,Ve-Kr,Ve+hn,1,kr.minY,kr.maxY,vt),Ln=Re(zn,Wt,Ve+yn,Ve+ht,1,kr.minY,kr.maxY,vt),zn=null),zt>1&&console.timeEnd("clipping"),it.push(En||[],he+1,2*we,2*Ve),it.push(Kn||[],he+1,2*we,2*Ve+1),it.push(Qr||[],he+1,2*we+1,2*Ve),it.push(Ln||[],he+1,2*we+1,2*Ve+1)}}getTile(fe,he,we){fe=+fe,he=+he,we=+we;const Ve=this.options,{extent:Xe,debug:xt}=Ve;if(fe<0||fe>24)return null;const ot=1<<fe,it=Et(fe,he=he+ot&ot-1,we);if(this.tiles[it])return Mt(this.tiles[it],Xe);xt>1&&console.log("drilling down to z%d-%d-%d",fe,he,we);let vt,zt=fe,Wt=he,mr=we;for(;!vt&&zt>0;)zt--,Wt>>=1,mr>>=1,vt=this.tiles[Et(zt,Wt,mr)];return vt&&vt.source?(xt>1&&(console.log("found parent tile z%d-%d-%d",zt,Wt,mr),console.time("drilling down")),this.splitTile(vt.source,zt,Wt,mr,fe,he,we),xt>1&&console.timeEnd("drilling down"),this.tiles[it]?Mt(this.tiles[it],Xe):null):null}}function Et(st,fe,he){return 32*((1<<st)*he+fe)+st}class lr extends N{constructor(fe,he,we,Ve=pr){super(fe,he,we),this._dataUpdateable=new Map,this._createGeoJSONIndex=Ve}loadVectorTile(fe,he){return _._(this,void 0,void 0,(function*(){const we=fe.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const Ve=this._geoJSONIndex.getTile(we.z,we.x,we.y);return Ve?H(new _.d2(Ve.features,{version:2,extent:_.a5})):null}))}loadData(fe){return _._(this,void 0,void 0,(function*(){var he;(he=this._pendingRequest)===null||he===void 0||he.abort();const we=this._startPerformance(fe);this._pendingRequest=new AbortController;try{(!this._pendingData||fe.request||fe.data||fe.dataDiff)&&(this._pendingData=this.loadAndProcessGeoJSON(fe,this._pendingRequest));const Ve=yield this._pendingData;this._geoJSONIndex=this._createGeoJSONIndex(Ve,fe),this.loaded={};const Xe={};return fe.request&&(Xe.data=Ve),this._finishPerformance(we,fe,Xe),Xe}catch(Ve){if(delete this._pendingRequest,_.Z(Ve))return{abandoned:!0};throw Ve}}))}_startPerformance(fe){var he;if(!((he=fe?.request)===null||he===void 0)&&he.collectResourceTiming)return new _.c_(fe.request)}_finishPerformance(fe,he,we){if(!fe)return;const Ve=fe.finish();Ve&&(we.resourceTiming={},we.resourceTiming[he.source]=JSON.parse(JSON.stringify(Ve)))}getData(){return _._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(fe){const he=this.loaded;return he&&he[fe.uid]?super.reloadTile(fe):this.loadTile(fe)}loadAndProcessGeoJSON(fe,he){return _._(this,void 0,void 0,(function*(){let we;if(fe.request?we=yield this.loadGeoJSONFromUrl(fe.request,fe.promoteId,he):fe.data?we=this._loadGeoJSONFromObject(fe.data,fe.promoteId):fe.dataDiff&&(we=this._loadGeoJSONFromDiff(fe.dataDiff,fe.promoteId,fe.source)),delete this._pendingRequest,typeof we!="object")throw new Error(`Input data given to '${fe.source}' is not a valid GeoJSON object.`);return ge(we,!0),fe.filter&&(we=this._filterGeoJSON(we,fe.filter)),we}))}loadGeoJSONFromUrl(fe,he,we){return _._(this,void 0,void 0,(function*(){const Ve=yield _.j(fe,we);return this._dataUpdateable=_.a7(Ve.data,he),Ve.data}))}_loadGeoJSONFromObject(fe,he){return this._dataUpdateable=_.a7(fe,he),fe}_loadGeoJSONFromDiff(fe,he,we){if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${we}`);_.a8(this._dataUpdateable,fe,he);const Ve=Array.from(this._dataUpdateable.values());return this._toFeatureCollection(Ve)}_filterGeoJSON(fe,he){const we=_.d3(he,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(we.result==="error")throw new Error(we.value.map((Xe=>`${Xe.key}: ${Xe.message}`)).join(", "));const Ve=fe.features.filter((Xe=>we.value.evaluate({zoom:0},Xe)));return this._toFeatureCollection(Ve)}_toFeatureCollection(fe){return{type:"FeatureCollection",features:fe}}removeSource(fe){return _._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(fe){return this._geoJSONIndex.getClusterExpansionZoom(fe.clusterId)}getClusterChildren(fe){return this._geoJSONIndex.getChildren(fe.clusterId)}getClusterLeaves(fe){return this._geoJSONIndex.getLeaves(fe.clusterId,fe.limit,fe.offset)}}function pr(st,fe){return fe.cluster?new xe((function({superclusterOptions:he,clusterProperties:we}){if(!we||!he)return he;const Ve={},Xe={},xt={accumulated:null,zoom:0},ot={properties:null},it=Object.keys(we);for(const vt of it){const[zt,Wt]=we[vt],mr=_.d3(Wt),kr=_.d3(typeof zt=="string"?[zt,["accumulated"],["get",vt]]:zt);Ve[vt]=mr.value,Xe[vt]=kr.value}return he.map=vt=>{ot.properties=vt;const zt={};for(const Wt of it)zt[Wt]=Ve[Wt].evaluate(xt,ot);return zt},he.reduce=(vt,zt)=>{ot.properties=zt;for(const Wt of it)xt.accumulated=vt[Wt],vt[Wt]=Xe[Wt].evaluate(xt,ot)},he})(fe)).load(st.features):(function(he,we){return new Kt(he,we)})(st,fe.geojsonVtOptions)}class ir{constructor(fe){this.self=fe,this.actor=new _.L(fe),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(he,we)=>{if(this.externalWorkerSourceTypes[he])throw new Error(`Worker source with name "${he}" already registered.`);this.externalWorkerSourceTypes[he]=we},this.self.addProtocol=_.cJ,this.self.removeProtocol=_.cK,this.self.registerRTLTextPlugin=he=>{_.d4.setMethods(he)},this.actor.registerMessageHandler("LDT",((he,we)=>this._getDEMWorkerSource(he,we.source).loadTile(we))),this.actor.registerMessageHandler("RDT",((he,we)=>_._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(he,we.source).removeTile(we)})))),this.actor.registerMessageHandler("GCEZ",((he,we)=>_._(this,void 0,void 0,(function*(){return this._getWorkerSource(he,we.type,we.source).getClusterExpansionZoom(we)})))),this.actor.registerMessageHandler("GCC",((he,we)=>_._(this,void 0,void 0,(function*(){return this._getWorkerSource(he,we.type,we.source).getClusterChildren(we)})))),this.actor.registerMessageHandler("GCL",((he,we)=>_._(this,void 0,void 0,(function*(){return this._getWorkerSource(he,we.type,we.source).getClusterLeaves(we)})))),this.actor.registerMessageHandler("LD",((he,we)=>this._getWorkerSource(he,we.type,we.source).loadData(we))),this.actor.registerMessageHandler("GD",((he,we)=>this._getWorkerSource(he,we.type,we.source).getData())),this.actor.registerMessageHandler("LT",((he,we)=>this._getWorkerSource(he,we.type,we.source).loadTile(we))),this.actor.registerMessageHandler("RT",((he,we)=>this._getWorkerSource(he,we.type,we.source).reloadTile(we))),this.actor.registerMessageHandler("AT",((he,we)=>this._getWorkerSource(he,we.type,we.source).abortTile(we))),this.actor.registerMessageHandler("RMT",((he,we)=>this._getWorkerSource(he,we.type,we.source).removeTile(we))),this.actor.registerMessageHandler("RS",((he,we)=>_._(this,void 0,void 0,(function*(){if(!this.workerSources[he]||!this.workerSources[he][we.type]||!this.workerSources[he][we.type][we.source])return;const Ve=this.workerSources[he][we.type][we.source];delete this.workerSources[he][we.type][we.source],Ve.removeSource!==void 0&&Ve.removeSource(we)})))),this.actor.registerMessageHandler("RM",(he=>_._(this,void 0,void 0,(function*(){delete this.layerIndexes[he],delete this.availableImages[he],delete this.workerSources[he],delete this.demWorkerSources[he],this.globalStates.delete(he)})))),this.actor.registerMessageHandler("SR",((he,we)=>_._(this,void 0,void 0,(function*(){this.referrer=we})))),this.actor.registerMessageHandler("SRPS",((he,we)=>this._syncRTLPluginState(he,we))),this.actor.registerMessageHandler("IS",((he,we)=>_._(this,void 0,void 0,(function*(){this.self.importScripts(we)})))),this.actor.registerMessageHandler("SI",((he,we)=>this._setImages(he,we))),this.actor.registerMessageHandler("UL",((he,we)=>_._(this,void 0,void 0,(function*(){this._getLayerIndex(he).update(we.layers,we.removedIds,this._getGlobalState(he))})))),this.actor.registerMessageHandler("UGS",((he,we)=>_._(this,void 0,void 0,(function*(){const Ve=this._getGlobalState(he);for(const Xe in we)Ve[Xe]=we[Xe]})))),this.actor.registerMessageHandler("SL",((he,we)=>_._(this,void 0,void 0,(function*(){this._getLayerIndex(he).replace(we,this._getGlobalState(he))}))))}_getGlobalState(fe){let he=this.globalStates.get(fe);return he||(he={},this.globalStates.set(fe,he)),he}_setImages(fe,he){return _._(this,void 0,void 0,(function*(){this.availableImages[fe]=he;for(const we in this.workerSources[fe]){const Ve=this.workerSources[fe][we];for(const Xe in Ve)Ve[Xe].availableImages=he}}))}_syncRTLPluginState(fe,he){return _._(this,void 0,void 0,(function*(){return yield _.d4.syncState(he,this.self.importScripts)}))}_getAvailableImages(fe){let he=this.availableImages[fe];return he||(he=[]),he}_getLayerIndex(fe){let he=this.layerIndexes[fe];return he||(he=this.layerIndexes[fe]=new s),he}_getWorkerSource(fe,he,we){if(this.workerSources[fe]||(this.workerSources[fe]={}),this.workerSources[fe][he]||(this.workerSources[fe][he]={}),!this.workerSources[fe][he][we]){const Ve={sendAsync:(Xe,xt)=>(Xe.targetMapId=fe,this.actor.sendAsync(Xe,xt))};switch(he){case"vector":this.workerSources[fe][he][we]=new N(Ve,this._getLayerIndex(fe),this._getAvailableImages(fe));break;case"geojson":this.workerSources[fe][he][we]=new lr(Ve,this._getLayerIndex(fe),this._getAvailableImages(fe));break;default:this.workerSources[fe][he][we]=new this.externalWorkerSourceTypes[he](Ve,this._getLayerIndex(fe),this._getAvailableImages(fe))}}return this.workerSources[fe][he][we]}_getDEMWorkerSource(fe,he){return this.demWorkerSources[fe]||(this.demWorkerSources[fe]={}),this.demWorkerSources[fe][he]||(this.demWorkerSources[fe][he]=new Z),this.demWorkerSources[fe][he]}}return _.i(self)&&(self.worker=new ir(self)),ir})),p("index",["exports","./shared"],(function(_,s){var C="5.15.0";function M(){var w=new s.A(4);return s.A!=Float32Array&&(w[1]=0,w[2]=0),w[0]=1,w[3]=1,w}let D,B,U;const j={frame(w,t,o){const d=requestAnimationFrame((S=>{x(),t(S)})),{unsubscribe:x}=s.s(w.signal,"abort",(()=>{x(),cancelAnimationFrame(d),o(new s.a(w.signal.reason))}),!1)},frameAsync(w){return new Promise(((t,o)=>{this.frame(w,t,o)}))},getImageData(w,t=0){return this.getImageCanvasContext(w).getImageData(-t,-t,w.width+2*t,w.height+2*t)},getImageCanvasContext(w){const t=window.document.createElement("canvas"),o=t.getContext("2d",{willReadFrequently:!0});if(!o)throw new Error("failed to create canvas 2d context");return t.width=w.width,t.height=w.height,o.drawImage(w,0,0,w.width,w.height),o},resolveURL:w=>(D||(D=document.createElement("a")),D.href=w,D.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return U!==void 0?U:!!matchMedia&&(B==null&&(B=matchMedia("(prefers-reduced-motion: reduce)")),B.matches)},set prefersReducedMotion(w){U=w}},H=new class{constructor(){this._realTime=typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),this._frozenAt=null}getCurrentTime(){return this._frozenAt!==null?this._frozenAt:this._realTime()}setNow(w){this._frozenAt=w}restoreNow(){this._frozenAt=null}isFrozen(){return this._frozenAt!==null}};function O(){return H.getCurrentTime()}class N{static testProp(t){if(!N.docStyle)return t[0];for(let o=0;o<t.length;o++)if(t[o]in N.docStyle)return t[o];return t[0]}static create(t,o,d){const x=window.document.createElement(t);return o!==void 0&&(x.className=o),d&&d.appendChild(x),x}static createNS(t,o){return window.document.createElementNS(t,o)}static disableDrag(){N.docStyle&&N.selectProp&&(N.userSelect=N.docStyle[N.selectProp],N.docStyle[N.selectProp]="none")}static enableDrag(){N.docStyle&&N.selectProp&&(N.docStyle[N.selectProp]=N.userSelect)}static setTransform(t,o){t.style[N.transformProp]=o}static addEventListener(t,o,d,x={}){t.addEventListener(o,d,"passive"in x?x:x.capture)}static removeEventListener(t,o,d,x={}){t.removeEventListener(o,d,"passive"in x?x:x.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",N.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",N.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",N.suppressClickInternal,!0)}),0)}static getScale(t){const o=t.getBoundingClientRect();return{x:o.width/t.offsetWidth||1,y:o.height/t.offsetHeight||1,boundingClientRect:o}}static getPoint(t,o,d){const x=o.boundingClientRect;return new s.P((d.clientX-x.left)/o.x-t.clientLeft,(d.clientY-x.top)/o.y-t.clientTop)}static mousePos(t,o){const d=N.getScale(t);return N.getPoint(t,d,o)}static touchPos(t,o){const d=[],x=N.getScale(t);for(let S=0;S<o.length;S++)d.push(N.getPoint(t,x,o[S]));return d}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}static sanitize(t){const o=new DOMParser().parseFromString(t,"text/html").body||document.createElement("body"),d=o.querySelectorAll("script");for(const x of d)x.remove();return N.clean(o),o.innerHTML}static isPossiblyDangerous(t,o){const d=o.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(t)||!d.includes("javascript:")&&!d.includes("data:"))||!!t.startsWith("on")||void 0}static clean(t){const o=t.children;for(const d of o)N.removeAttributes(d),N.clean(d)}static removeAttributes(t){for(const{name:o,value:d}of t.attributes)N.isPossiblyDangerous(o,d)&&t.removeAttribute(o)}}N.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,N.selectProp=N.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),N.transformProp=N.testProp(["transform","WebkitTransform"]);const Z={supported:!1,testSupport:function(w){!pe&&X&&(ge?ve(w):J=w)}};let J,X,pe=!1,ge=!1;function ve(w){const t=w.createTexture();w.bindTexture(w.TEXTURE_2D,t);try{if(w.texImage2D(w.TEXTURE_2D,0,w.RGBA,w.RGBA,w.UNSIGNED_BYTE,X),w.isContextLost())return;Z.supported=!0}catch{}w.deleteTexture(t),pe=!0}var re;typeof document<"u"&&(X=document.createElement("img"),X.onload=()=>{J&&ve(J),J=null,ge=!0},X.onerror=()=>{pe=!0,J=null},X.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(w){let t,o,d,x;w.resetRequestQueue=()=>{t=[],o=0,d=0,x={}},w.addThrottleControl=F=>{const V=d++;return x[V]=F,V},w.removeThrottleControl=F=>{delete x[F],A()},w.getImage=(F,V,q=!0)=>new Promise(((te,ee)=>{Z.supported&&(F.headers||(F.headers={}),F.headers.accept="image/webp,*/*"),s.e(F,{type:"image"}),t.push({abortController:V,requestParameters:F,supportImageRefresh:q,state:"queued",onError:ce=>{ee(ce)},onSuccess:ce=>{te(ce)}}),A()}));const S=F=>s._(this,void 0,void 0,(function*(){F.state="running";const{requestParameters:V,supportImageRefresh:q,onError:te,onSuccess:ee,abortController:ce}=F,_e=q===!1&&!s.i(self)&&!s.g(V.url)&&(!V.headers||Object.keys(V.headers).reduce(((ze,Ze)=>ze&&Ze==="accept"),!0));o++;const Ie=_e?R(V,ce):s.m(V,ce);try{const ze=yield Ie;delete F.abortController,F.state="completed",ze.data instanceof HTMLImageElement||s.b(ze.data)?ee(ze):ze.data&&ee({data:yield(Be=ze.data,typeof createImageBitmap=="function"?s.f(Be):s.h(Be)),cacheControl:ze.cacheControl,expires:ze.expires})}catch(ze){delete F.abortController,te(ze)}finally{o--,A()}var Be})),A=()=>{const F=(()=>{for(const V of Object.keys(x))if(x[V]())return!0;return!1})()?s.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:s.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let V=o;V<F&&t.length>0;V++){const q=t.shift();q.abortController.signal.aborted?V--:S(q)}},R=(F,V)=>new Promise(((q,te)=>{const ee=new Image,ce=F.url,_e=F.credentials;_e&&_e==="include"?ee.crossOrigin="use-credentials":(_e&&_e==="same-origin"||!s.d(ce))&&(ee.crossOrigin="anonymous"),V.signal.addEventListener("abort",(()=>{ee.src="",te(new s.a(V.signal.reason))})),ee.fetchPriority="high",ee.onload=()=>{ee.onerror=ee.onload=null,q({data:ee})},ee.onerror=()=>{ee.onerror=ee.onload=null,V.signal.aborted||te(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},ee.src=ce}))})(re||(re={})),re.resetRequestQueue();class Ce{constructor(t){this._transformRequestFn=t??null}transformRequest(t,o){return this._transformRequestFn&&this._transformRequestFn(t,o)||{url:t}}setTransformRequest(t){this._transformRequestFn=t}}function xe(w){const t=[];if(typeof w=="string")t.push({id:"default",url:w});else if(w&&w.length>0){const o=[];for(const{id:d,url:x}of w){const S=`${d}${x}`;o.indexOf(S)===-1&&(o.push(S),t.push({id:d,url:x}))}}return t}function Ge(w,t,o){try{const d=new URL(w);return d.pathname+=`${t}${o}`,d.toString()}catch{throw new Error(`Invalid sprite URL "${w}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function $e(w){const{userImage:t}=w;return!!(t&&t.render&&t.render())&&(w.data.replace(new Uint8Array(t.data.buffer)),!0)}class de extends s.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.R({width:1,height:1}),this.dirty=!0}destroy(){this.atlasTexture&&(this.atlasTexture.destroy(),this.atlasTexture=null);for(const t of Object.keys(this.images))this.removeImage(t);this.patterns={},this.atlasImage=new s.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:o,promiseResolve:d}of this.requestors)d(this._getImagesForIds(o));this.requestors=[]}}getImage(t){const o=this.images[t];if(o&&!o.data&&o.spriteData){const d=o.spriteData;o.data=new s.R({width:d.width,height:d.height},d.context.getImageData(d.x,d.y,d.width,d.height).data),o.spriteData=null}return o}addImage(t,o){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,o)&&(this.images[t]=o)}_validate(t,o){let d=!0;const x=o.data||o.spriteData;return this._validateStretch(o.stretchX,x&&x.width)||(this.fire(new s.k(new Error(`Image "${t}" has invalid "stretchX" value`))),d=!1),this._validateStretch(o.stretchY,x&&x.height)||(this.fire(new s.k(new Error(`Image "${t}" has invalid "stretchY" value`))),d=!1),this._validateContent(o.content,o)||(this.fire(new s.k(new Error(`Image "${t}" has invalid "content" value`))),d=!1),d}_validateStretch(t,o){if(!t)return!0;let d=0;for(const x of t){if(x[0]<d||x[1]<x[0]||o<x[1])return!1;d=x[1]}return!0}_validateContent(t,o){if(!t)return!0;if(t.length!==4)return!1;const d=o.spriteData,x=d&&d.width||o.data.width,S=d&&d.height||o.data.height;return!(t[0]<0||x<t[0]||t[1]<0||S<t[1]||t[2]<0||x<t[2]||t[3]<0||S<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,o,d=!0){const x=this.getImage(t);if(d&&(x.data.width!==o.data.width||x.data.height!==o.data.height))throw new Error(`size mismatch between old image (${x.data.width}x${x.data.height}) and new image (${o.data.width}x${o.data.height}).`);o.version=x.version+1,this.images[t]=o,this.updatedImages[t]=!0}removeImage(t){const o=this.images[t];delete this.images[t],delete this.patterns[t],o.userImage&&o.userImage.onRemove&&o.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t){return new Promise(((o,d)=>{let x=!0;if(!this.isLoaded())for(const S of t)this.images[S]||(x=!1);this.isLoaded()||x?o(this._getImagesForIds(t)):this.requestors.push({ids:t,promiseResolve:o})}))}_getImagesForIds(t){const o={};for(const d of t){let x=this.getImage(d);x||(this.fire(new s.l("styleimagemissing",{id:d})),x=this.getImage(d)),x?o[d]={data:x.data.clone(),pixelRatio:x.pixelRatio,sdf:x.sdf,version:x.version,stretchX:x.stretchX,stretchY:x.stretchY,content:x.content,textFitWidth:x.textFitWidth,textFitHeight:x.textFitHeight,hasRenderCallback:!!(x.userImage&&x.userImage.render)}:s.w(`Image "${d}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return o}getPixelSize(){const{width:t,height:o}=this.atlasImage;return{width:t,height:o}}getPattern(t){const o=this.patterns[t],d=this.getImage(t);if(!d)return null;if(o&&o.position.version===d.version)return o.position;if(o)o.position.version=d.version;else{const x={w:d.data.width+2,h:d.data.height+2,x:0,y:0},S=new s.I(x,d);this.patterns[t]={bin:x,position:S}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const o=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.T(t,this.atlasImage,o.RGBA),this.atlasTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const S in this.patterns)t.push(this.patterns[S].bin);const{w:o,h:d}=s.p(t),x=this.atlasImage;x.resize({width:o||1,height:d||1});for(const S in this.patterns){const{bin:A}=this.patterns[S],R=A.x+1,F=A.y+1,V=this.getImage(S).data,q=V.width,te=V.height;s.R.copy(V,x,{x:0,y:0},{x:R,y:F},{width:q,height:te}),s.R.copy(V,x,{x:0,y:te-1},{x:R,y:F-1},{width:q,height:1}),s.R.copy(V,x,{x:0,y:0},{x:R,y:F+te},{width:q,height:1}),s.R.copy(V,x,{x:q-1,y:0},{x:R-1,y:F},{width:1,height:te}),s.R.copy(V,x,{x:0,y:0},{x:R+q,y:F},{width:1,height:te})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const o of t){if(this.callbackDispatchedThisFrame[o])continue;this.callbackDispatchedThisFrame[o]=!0;const d=this.getImage(o);d||s.w(`Image with ID: "${o}" was not found`),$e(d)&&this.updateImage(o,d)}}cloneImages(){const t={};for(const o in this.images){const d=this.images[o];t[o]=Object.assign(Object.assign({},d),{data:d.data?d.data.clone():null})}return t}}const nt=1e20;function le(w,t,o,d,x,S,A,R,F){for(let V=t;V<t+d;V++)ct(w,o*S+V,S,x,A,R,F);for(let V=o;V<o+x;V++)ct(w,V*S+t,1,d,A,R,F)}function ct(w,t,o,d,x,S,A){S[0]=0,A[0]=-nt,A[1]=nt,x[0]=w[t];for(let R=1,F=0,V=0;R<d;R++){x[R]=w[t+R*o];const q=R*R;do{const te=S[F];V=(x[R]-x[te]+q-te*te)/(R-te)/2}while(V<=A[F]&&--F>-1);F++,S[F]=R,A[F]=V,A[F+1]=nt}for(let R=0,F=0;R<d;R++){for(;A[F+1]<R;)F++;const V=S[F],q=R-V;w[t+R*o]=x[V]+q*q}}const et=s.v.layout_symbol["text-font"].default.join(",");class He{constructor(t,o,d){this.requestManager=t,this.localIdeographFontFamily=o,this.entries={},this.lang=d}setURL(t){this.url=t}getGlyphs(t){return s._(this,void 0,void 0,(function*(){const o=[];for(const S in t)for(const A of t[S])o.push(this._getAndCacheGlyphsPromise(S,A));const d=yield Promise.all(o),x={};for(const{stack:S,id:A,glyph:R}of d)x[S]||(x[S]={}),x[S][A]=R&&{id:R.id,bitmap:R.bitmap.clone(),metrics:R.metrics};return x}))}_getAndCacheGlyphsPromise(t,o){return s._(this,void 0,void 0,(function*(){let d=this.entries[t];d||(d=this.entries[t]={glyphs:{},requests:{},ranges:{}});let x=d.glyphs[o];return x!==void 0?{stack:t,id:o,glyph:x}:!this.url||this._charUsesLocalIdeographFontFamily(o)?(x=d.glyphs[o]=this._drawGlyph(d,t,o),{stack:t,id:o,glyph:x}):yield this._downloadAndCacheRangePromise(t,o)}))}_downloadAndCacheRangePromise(t,o){return s._(this,void 0,void 0,(function*(){const d=this.entries[t],x=Math.floor(o/256);if(d.ranges[x])return{stack:t,id:o,glyph:null};if(!d.requests[x]){const S=He.loadGlyphRange(t,x,this.url,this.requestManager);d.requests[x]=S}try{const S=yield d.requests[x];for(const A in S)d.glyphs[+A]=S[+A];return d.ranges[x]=!0,{stack:t,id:o,glyph:S[o]||null}}catch(S){const A=d.glyphs[o]=this._drawGlyph(d,t,o);return this._warnOnMissingGlyphRange(A,x,o,S),{stack:t,id:o,glyph:A}}}))}_warnOnMissingGlyphRange(t,o,d,x){const S=256*o,A=S+255,R=d.toString(16).padStart(4,"0").toUpperCase();s.w(`Unable to load glyph range ${o}, ${S}-${A}. Rendering codepoint U+${R} locally instead. ${x}`)}_charUsesLocalIdeographFontFamily(t){return!!this.localIdeographFontFamily&&s.q(t)}_drawGlyph(t,o,d){const x=o===et&&this.localIdeographFontFamily!==""&&this._charUsesLocalIdeographFontFamily(d),S=x?"ideographTinySDF":"tinySDF";t[S]||(t[S]=this._createTinySDF(x?this.localIdeographFontFamily:o));const A=t[S].draw(String.fromCodePoint(d));return{id:d,bitmap:new s.r({width:A.width||60,height:A.height||60},A.data),metrics:{width:A.glyphWidth/2||24,height:A.glyphHeight/2||24,left:A.glyphLeft/2+.5||0,top:A.glyphTop/2-27.5||-8,advance:A.glyphAdvance/2||24,isDoubleResolution:!0}}}_createTinySDF(t){const o=t?t.split(","):[];o.push("sans-serif");const d=o.map((x=>/[-\w]+/.test(x)?x:`'${CSS.escape(x)}'`)).join(",");return new He.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:d,fontWeight:this._fontWeight(o[0]),fontStyle:this._fontStyle(o[0]),lang:this.lang})}_fontStyle(t){return/italic/i.test(t)?"italic":/oblique/i.test(t)?"oblique":"normal"}_fontWeight(t){const o={thin:100,hairline:100,"extra light":200,"ultra light":200,light:300,normal:400,regular:400,medium:500,semibold:600,demibold:600,bold:700,"extra bold":800,"ultra bold":800,black:900,heavy:900,"extra black":950,"ultra black":950};let d;for(const[x,S]of Object.entries(o))new RegExp(`\\b${x}\\b`,"i").test(t)&&(d=`${S}`);return d}destroy(){for(const t in this.entries){const o=this.entries[t];o.tinySDF&&(o.tinySDF=null),o.ideographTinySDF&&(o.ideographTinySDF=null),o.glyphs={},o.requests={},o.ranges={}}this.entries={}}}He.loadGlyphRange=function(w,t,o,d){return s._(this,void 0,void 0,(function*(){const x=256*t,S=x+255,A=d.transformRequest(o.replace("{fontstack}",w).replace("{range}",`${x}-${S}`),"Glyphs"),R=yield s.n(A,new AbortController);if(!R||!R.data)throw new Error(`Could not load glyph range. range: ${t}, ${x}-${S}`);const F={};for(const V of s.o(R.data))F[V.id]=V;return F}))},He.TinySDF=class{constructor({fontSize:w=24,buffer:t=3,radius:o=8,cutoff:d=.25,fontFamily:x="sans-serif",fontWeight:S="normal",fontStyle:A="normal",lang:R=null}={}){this.buffer=t,this.cutoff=d,this.radius=o,this.lang=R;const F=this.size=w+4*t,V=this._createCanvas(F),q=this.ctx=V.getContext("2d",{willReadFrequently:!0});q.font=`${A} ${S} ${w}px ${x}`,q.textBaseline="alphabetic",q.textAlign="left",q.fillStyle="black",this.gridOuter=new Float64Array(F*F),this.gridInner=new Float64Array(F*F),this.f=new Float64Array(F),this.z=new Float64Array(F+1),this.v=new Uint16Array(F)}_createCanvas(w){const t=document.createElement("canvas");return t.width=t.height=w,t}draw(w){const{width:t,actualBoundingBoxAscent:o,actualBoundingBoxDescent:d,actualBoundingBoxLeft:x,actualBoundingBoxRight:S}=this.ctx.measureText(w),A=Math.ceil(o),R=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(S-x))),F=Math.min(this.size-this.buffer,A+Math.ceil(d)),V=R+2*this.buffer,q=F+2*this.buffer,te=Math.max(V*q,0),ee=new Uint8ClampedArray(te),ce={data:ee,width:V,height:q,glyphWidth:R,glyphHeight:F,glyphTop:A,glyphLeft:0,glyphAdvance:t};if(R===0||F===0)return ce;const{ctx:_e,buffer:Ie,gridInner:Be,gridOuter:ze}=this;this.lang&&(_e.lang=this.lang),_e.clearRect(Ie,Ie,R,F),_e.fillText(w,Ie,Ie+A);const Ze=_e.getImageData(Ie,Ie,R,F);ze.fill(nt,0,te),Be.fill(0,0,te);for(let rt=0;rt<F;rt++)for(let qe=0;qe<R;qe++){const tt=Ze.data[4*(rt*R+qe)+3]/255;if(tt===0)continue;const lt=(rt+Ie)*V+qe+Ie;if(tt===1)ze[lt]=0,Be[lt]=nt;else{const Ke=.5-tt;ze[lt]=Ke>0?Ke*Ke:0,Be[lt]=Ke<0?Ke*Ke:0}}le(ze,0,0,V,q,V,this.f,this.v,this.z),le(Be,Ie,Ie,R,F,V,this.f,this.v,this.z);for(let rt=0;rt<te;rt++){const qe=Math.sqrt(ze[rt])-Math.sqrt(Be[rt]);ee[rt]=Math.round(255-255*(qe/this.radius+this.cutoff))}return ce}};class $t{constructor(){this.specification=s.u.light.position}possiblyEvaluate(t,o){return s.F(t.expression.evaluate(o))}interpolate(t,o,d){return{x:s.G.number(t.x,o.x,d),y:s.G.number(t.y,o.y,d),z:s.G.number(t.z,o.z,d)}}}let Oe;class It extends s.E{constructor(t){super(),Oe=Oe||new s.t({anchor:new s.D(s.u.light.anchor),position:new $t,color:new s.D(s.u.light.color),intensity:new s.D(s.u.light.intensity)}),this._transitionable=new s.x(Oe,void 0),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,o={}){if(!this._validate(s.y,t,o))for(const d in t){const x=t[d];d.endsWith(s.z)?this._transitionable.setTransition(d.slice(0,-s.z.length),x):this._transitionable.setValue(d,x)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,o,d){return(!d||d.validate!==!1)&&s.B(this,t.call(s.C,{value:o,style:{glyphs:!0,sprite:!0},styleSpec:s.u}))}}const me=new s.t({"sky-color":new s.D(s.u.sky["sky-color"]),"horizon-color":new s.D(s.u.sky["horizon-color"]),"fog-color":new s.D(s.u.sky["fog-color"]),"fog-ground-blend":new s.D(s.u.sky["fog-ground-blend"]),"horizon-fog-blend":new s.D(s.u.sky["horizon-fog-blend"]),"sky-horizon-blend":new s.D(s.u.sky["sky-horizon-blend"]),"atmosphere-blend":new s.D(s.u.sky["atmosphere-blend"])});class ne extends s.E{constructor(t){super(),this._transitionable=new s.x(me,void 0),this.setSky(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new s.H(0))}setSky(t,o={}){if(!this._validate(s.J,t,o)){t||(t={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const d in t){const x=t[d];d.endsWith(s.z)?this._transitionable.setTransition(d.slice(0,-s.z.length),x):this._transitionable.setValue(d,x)}}}getSky(){return this._transitionable.serialize()}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,o,d={}){return d?.validate!==!1&&s.B(this,t.call(s.C,s.e({value:o,style:{glyphs:!0,sprite:!0},styleSpec:s.u})))}calculateFogBlendOpacity(t){return t<60?0:t<70?(t-60)/10:1}}class Ue{constructor(t,o){this.width=t,this.height=o,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,o){const d=t.join(",")+String(o);return this.dashEntry[d]||(this.dashEntry[d]=this.addDash(t,o)),this.dashEntry[d]}getDashRanges(t,o,d){const x=[];let S=t.length%2==1?-t[t.length-1]*d:0,A=t[0]*d,R=!0;x.push({left:S,right:A,isDash:R,zeroLength:t[0]===0});let F=t[0];for(let V=1;V<t.length;V++){R=!R;const q=t[V];S=F*d,F+=q,A=F*d,x.push({left:S,right:A,isDash:R,zeroLength:q===0})}return x}addRoundDash(t,o,d){const x=o/2;for(let S=-d;S<=d;S++){const A=this.width*(this.nextRow+d+S);let R=0,F=t[R];for(let V=0;V<this.width;V++){V/F.right>1&&(F=t[++R]);const q=Math.abs(V-F.left),te=Math.abs(V-F.right),ee=Math.min(q,te);let ce;const _e=S/d*(x+1);if(F.isDash){const Ie=x-Math.abs(_e);ce=Math.sqrt(ee*ee+Ie*Ie)}else ce=x-Math.sqrt(ee*ee+_e*_e);this.data[A+V]=Math.max(0,Math.min(255,ce+128))}}}addRegularDash(t){for(let R=t.length-1;R>=0;--R){const F=t[R],V=t[R+1];F.zeroLength?t.splice(R,1):V&&V.isDash===F.isDash&&(V.left=F.left,t.splice(R,1))}const o=t[0],d=t[t.length-1];o.isDash===d.isDash&&(o.left=d.left-this.width,d.right=o.right+this.width);const x=this.width*this.nextRow;let S=0,A=t[S];for(let R=0;R<this.width;R++){R/A.right>1&&(A=t[++S]);const F=Math.abs(R-A.left),V=Math.abs(R-A.right),q=Math.min(F,V);this.data[x+R]=Math.max(0,Math.min(255,(A.isDash?q:-q)+128))}}addDash(t,o){const d=o?7:0,x=2*d+1;if(this.nextRow+x>this.height)return s.w("LineAtlas out of space"),null;let S=0;for(let R=0;R<t.length;R++)S+=t[R];if(S!==0){const R=this.width/S,F=this.getDashRanges(t,this.width,R);o?this.addRoundDash(F,R,d):this.addRegularDash(F)}const A={y:this.nextRow+d,height:2*d,width:S};return this.nextRow+=x,this.dirty=!0,A}bind(t){const o=t.gl;this.texture?(o.bindTexture(o.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,o.texSubImage2D(o.TEXTURE_2D,0,0,0,this.width,this.height,o.ALPHA,o.UNSIGNED_BYTE,this.data))):(this.texture=o.createTexture(),o.bindTexture(o.TEXTURE_2D,this.texture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_2D,0,o.ALPHA,this.width,this.height,0,o.ALPHA,o.UNSIGNED_BYTE,this.data))}}const Fe="maplibre_preloaded_worker_pool";class Re{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<Re.workerCount;)this.workers.push(new Worker(s.c.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach((o=>{o.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[Fe]}numActive(){return Object.keys(this.active).length}}const bt=Math.floor(j.hardwareConcurrency/2);let Gt,Vt;function Bt(){return Gt||(Gt=new Re),Gt}Re.workerCount=s.K(globalThis)?Math.max(Math.min(bt,3),1):1;class Yt{constructor(t,o){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=o;const d=this.workerPool.acquire(o);for(let x=0;x<d.length;x++){const S=new s.L(d[x],o);S.name=`Worker ${x}`,this.actors.push(S)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,o){const d=[];for(const x of this.actors)d.push(x.sendAsync({type:t,data:o}));return Promise.all(d)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach((o=>{o.remove()})),this.actors=[],t&&this.workerPool.release(this.id)}registerMessageHandler(t,o){for(const d of this.actors)d.registerMessageHandler(t,o)}unregisterMessageHandler(t){for(const o of this.actors)o.unregisterMessageHandler(t)}}function Or(){return Vt||(Vt=new Yt(Bt(),s.M),Vt.registerMessageHandler("GR",((w,t,o)=>s.m(t,o)))),Vt}function Ye(w,t){const o=s.N();return s.O(o,o,[1,1,0]),s.Q(o,o,[.5*w.width,.5*w.height,1]),w.calculatePosMatrix?s.S(o,o,w.calculatePosMatrix(t.toUnwrapped())):o}function pn(w,t,o,d,x,S,A){var R;const F=(function(ee,ce,_e){if(ee)for(const Ie of ee){const Be=ce[Ie];if(Be&&Be.source===_e&&Be.type==="fill-extrusion")return!0}else for(const Ie in ce){const Be=ce[Ie];if(Be.source===_e&&Be.type==="fill-extrusion")return!0}return!1})((R=x?.layers)!==null&&R!==void 0?R:null,t,w.id),V=S.maxPitchScaleFactor(),q=w.tilesIn(d,V,F);q.sort(se);const te=[];for(const ee of q)te.push({wrappedTileID:ee.tileID.wrapped().key,queryResults:ee.tile.queryRenderedFeatures(t,o,w.getState(),ee.queryGeometry,ee.cameraQueryGeometry,ee.scale,x,S,V,Ye(S,ee.tileID),A?(ce,_e)=>A(ee.tileID,ce,_e):void 0)});return(function(ee,ce){for(const _e in ee)for(const Ie of ee[_e])Mt(Ie,ce);return ee})((function(ee){const ce={},_e={};for(const Ie of ee){const Be=Ie.queryResults,ze=Ie.wrappedTileID,Ze=_e[ze]=_e[ze]||{};for(const rt in Be){const qe=Be[rt],tt=Ze[rt]=Ze[rt]||{},lt=ce[rt]=ce[rt]||[];for(const Ke of qe)tt[Ke.featureIndex]||(tt[Ke.featureIndex]=!0,lt.push(Ke))}}return ce})(te),w)}function se(w,t){const o=w.tileID,d=t.tileID;return o.overscaledZ-d.overscaledZ||o.canonical.y-d.canonical.y||o.wrap-d.wrap||o.canonical.x-d.canonical.x}function Mt(w,t){const o=w.feature,d=t.getFeatureState(o.layer["source-layer"],o.id);o.source=o.layer.source,o.layer["source-layer"]&&(o.sourceLayer=o.layer["source-layer"]),o.state=d}function yt(w,t,o){return s._(this,void 0,void 0,(function*(){let d=w;if(w.url?d=(yield s.j(t.transformRequest(w.url,"Source"),o)).data:yield j.frameAsync(o),!d)return null;const x=s.U(s.e(d,w),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in d&&d.vector_layers&&(x.vectorLayerIds=d.vector_layers.map((S=>S.id))),x}))}class Ee{constructor(t,o){t&&(o?this.setSouthWest(t).setNorthEast(o):Array.isArray(t)&&(t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof s.V?new s.V(t.lng,t.lat):s.V.convert(t),this}setSouthWest(t){return this._sw=t instanceof s.V?new s.V(t.lng,t.lat):s.V.convert(t),this}extend(t){const o=this._sw,d=this._ne;let x,S;if(t instanceof s.V)x=t,S=t;else{if(!(t instanceof Ee))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Ee.convert(t)):this.extend(s.V.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(s.V.convert(t)):this;if(x=t._sw,S=t._ne,!x||!S)return this}return o||d?(o.lng=Math.min(x.lng,o.lng),o.lat=Math.min(x.lat,o.lat),d.lng=Math.max(S.lng,d.lng),d.lat=Math.max(S.lat,d.lat)):(this._sw=new s.V(x.lng,x.lat),this._ne=new s.V(S.lng,S.lat)),this}getCenter(){return new s.V((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new s.V(this.getWest(),this.getNorth())}getSouthEast(){return new s.V(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:o,lat:d}=s.V.convert(t);let x=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(x=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=d&&d<=this._ne.lat&&x}intersects(t){if(!((t=Ee.convert(t)).getNorth()>=this.getSouth()&&t.getSouth()<=this.getNorth()))return!1;const o=Math.abs(this.getEast()-this.getWest()),d=Math.abs(t.getEast()-t.getWest());if(o>=360||d>=360)return!0;const x=s.W(this.getWest(),-180,180),S=s.W(this.getEast(),-180,180),A=s.W(t.getWest(),-180,180),R=s.W(t.getEast(),-180,180),F=x>=S,V=A>=R;return!(!F||!V)||(F?R>=x||A<=S:V?S>=A||x<=R:A<=S&&R>=x)}static convert(t){return t instanceof Ee?t:t&&new Ee(t)}static fromLngLat(t,o=0){const d=360*o/40075017,x=d/Math.cos(Math.PI/180*t.lat);return new Ee(new s.V(t.lng-x,t.lat-d),new s.V(t.lng+x,t.lat+d))}adjustAntiMeridian(){const t=new s.V(this._sw.lng,this._sw.lat),o=new s.V(this._ne.lng,this._ne.lat);return new Ee(t,t.lng>o.lng?new s.V(o.lng+360,o.lat):o)}}class Ne{constructor(t,o,d){this.bounds=Ee.convert(this.validateBounds(t)),this.minzoom=o||0,this.maxzoom=d||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const o=Math.pow(2,t.z),d=Math.floor(s.Y(this.bounds.getWest())*o),x=Math.floor(s.X(this.bounds.getNorth())*o),S=Math.ceil(s.Y(this.bounds.getEast())*o),A=Math.ceil(s.X(this.bounds.getSouth())*o);return t.x>=d&&t.x<S&&t.y>=x&&t.y<A}}class pt extends s.E{constructor(t,o,d,x){if(super(),this.id=t,this.dispatcher=d,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.e(this,s.U(o,["url","scheme","tileSize","promoteId","encoding"])),this._options=s.e({type:"vector"},o),this._collectResourceTiming=o.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(x)}load(){return s._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield yt(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.tileManagers[this.id].clearTiles(),t&&(s.e(this,t),t.bounds&&(this.tileBounds=new Ne(t.bounds,this.minzoom,this.maxzoom)),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.l("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this._loaded=!0,s.Z(t)||this.fire(new s.k(t))}}))}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.abort(),t(),this.load()}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return s.e({},this._options)}loadTile(t){return s._(this,void 0,void 0,(function*(){const o=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d={request:this.map._requestManager.transformRequest(o,"Tile"),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,encoding:this.encoding,overzoomParameters:this._getOverzoomParameters(t)};d.request.collectResourceTiming=this._collectResourceTiming;let x="RT";if(t.actor&&t.state!=="expired"){if(t.state==="loading")return new Promise(((S,A)=>{t.reloadPromise={resolve:S,reject:A}}))}else t.actor=this.dispatcher.getActor(),x="LT";t.abortController=new AbortController;try{const S=yield t.actor.sendAsync({type:x,data:d},t.abortController);if(delete t.abortController,t.aborted)return;this._afterTileLoadWorkerResponse(t,S)}catch(S){if(delete t.abortController,t.aborted)return;if(S&&S.status!==404)throw S;this._afterTileLoadWorkerResponse(t,null)}}))}_getOverzoomParameters(t){if(t.tileID.canonical.z<=this.maxzoom||this.map._zoomLevelsToOverscale===void 0)return;const o=t.tileID.scaledTo(this.maxzoom).canonical,d=o.url(this.tiles,this.map.getPixelRatio(),this.scheme);return{maxZoomTileID:o,overzoomRequest:this.map._requestManager.transformRequest(d,"Tile")}}_afterTileLoadWorkerResponse(t,o){if(o&&o.resourceTiming&&(t.resourceTiming=o.resourceTiming),o&&this.map._refreshExpiredTiles&&t.setExpiryData(o),t.loadVectorData(o,this.map.painter),t.reloadPromise){const d=t.reloadPromise;t.reloadPromise=null,this.loadTile(t).then(d.resolve).catch(d.reject)}}abortTile(t){return s._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.actor&&(yield t.actor.sendAsync({type:"AT",data:{uid:t.uid,type:this.type,source:this.id}}))}))}unloadTile(t){return s._(this,void 0,void 0,(function*(){t.unloadVectorData(),t.actor&&(yield t.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class Jt extends s.E{constructor(t,o,d,x){super(),this.id=t,this.dispatcher=d,this.setEventedParent(x),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.e({type:"raster"},o),s.e(this,s.U(o,["url","scheme","tileSize"]))}load(){return s._(this,arguments,void 0,(function*(t=!1){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const o=yield yt(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,o&&(s.e(this,o),o.bounds&&(this.tileBounds=new Ne(o.bounds,this.minzoom,this.maxzoom)),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:t})))}catch(o){this._tileJSONRequest=null,this._loaded=!0,s.Z(o)||this.fire(new s.k(o))}}))}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),t(),this.load(!0)}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}serialize(){return s.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t){return s._(this,void 0,void 0,(function*(){const o=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.abortController=new AbortController;try{const d=yield re.getImage(this.map._requestManager.transformRequest(o,"Tile"),t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(d&&d.data){this.map._refreshExpiredTiles&&(d.cacheControl||d.expires)&&t.setExpiryData({cacheControl:d.cacheControl,expires:d.expires});const x=this.map.painter.context,S=x.gl,A=d.data;t.texture=this.map.painter.getTileTexture(A.width),t.texture?t.texture.update(A,{useMipmap:!0}):(t.texture=new s.T(x,A,S.RGBA,{useMipmap:!0}),t.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE,S.LINEAR_MIPMAP_NEAREST)),t.state="loaded"}}catch(d){if(delete t.abortController,t.aborted)t.state="unloaded";else if(d)throw t.state="errored",d}}))}abortTile(t){return s._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController)}))}unloadTile(t){return s._(this,void 0,void 0,(function*(){t.texture&&this.map.painter.saveTileTexture(t.texture)}))}hasTransition(){return!1}}class Kt extends Jt{constructor(t,o,d,x){super(t,o,d,x),this.type="raster-dem",this.maxzoom=22,this._options=s.e({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox",this.redFactor=o.redFactor,this.greenFactor=o.greenFactor,this.blueFactor=o.blueFactor,this.baseShift=o.baseShift}loadTile(t){return s._(this,void 0,void 0,(function*(){const o=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d=this.map._requestManager.transformRequest(o,"Tile");t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.abortController=new AbortController;try{const x=yield re.getImage(d,t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(x&&x.data){const S=x.data;this.map._refreshExpiredTiles&&(x.cacheControl||x.expires)&&t.setExpiryData({cacheControl:x.cacheControl,expires:x.expires});const A=s.b(S)&&s.$()?S:yield this.readImageNow(S),R={type:this.type,uid:t.uid,source:this.id,rawImageData:A,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!t.actor||t.state==="expired"){t.actor=this.dispatcher.getActor();const F=yield t.actor.sendAsync({type:"LDT",data:R});t.dem=F,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded"}}}catch(x){if(delete t.abortController,t.aborted)t.state="unloaded";else if(x)throw t.state="errored",x}}))}readImageNow(t){return s._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&s.a0()){const o=t.width+2,d=t.height+2;try{return new s.R({width:o,height:d},yield s.a1(t,-1,-1,o,d))}catch{}}return j.getImageData(t,1)}))}_getNeighboringTiles(t){const o=t.canonical,d=Math.pow(2,o.z),x=(o.x-1+d)%d,S=o.x===0?t.wrap-1:t.wrap,A=(o.x+1+d)%d,R=o.x+1===d?t.wrap+1:t.wrap,F={};return F[new s.a2(t.overscaledZ,S,o.z,x,o.y).key]={backfilled:!1},F[new s.a2(t.overscaledZ,R,o.z,A,o.y).key]={backfilled:!1},o.y>0&&(F[new s.a2(t.overscaledZ,S,o.z,x,o.y-1).key]={backfilled:!1},F[new s.a2(t.overscaledZ,t.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},F[new s.a2(t.overscaledZ,R,o.z,A,o.y-1).key]={backfilled:!1}),o.y+1<d&&(F[new s.a2(t.overscaledZ,S,o.z,x,o.y+1).key]={backfilled:!1},F[new s.a2(t.overscaledZ,t.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},F[new s.a2(t.overscaledZ,R,o.z,A,o.y+1).key]={backfilled:!1}),F}unloadTile(t){return s._(this,void 0,void 0,(function*(){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&(yield t.actor.sendAsync({type:"RDT",data:{type:this.type,uid:t.uid,source:this.id}}))}))}}function Et(w){return w.type==="GeometryCollection"?w.geometries.map((t=>t.coordinates)).flat(1/0):w.coordinates.flat(1/0)}function lr(w){const t=new Ee;let o;switch(w.type){case"FeatureCollection":o=w.features.map((d=>Et(d.geometry))).flat(1/0);break;case"Feature":o=Et(w.geometry);break;default:o=Et(w)}if(o.length==0)return t;for(let d=0;d<o.length-1;d+=2)t.extend([o[d],o[d+1]]);return t}class pr extends s.E{constructor(t,o,d,x){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:o.data},this.actor=d.getActor(),this.setEventedParent(x),this._data=typeof o.data=="string"?{url:o.data}:{geojson:o.data},this._options=s.e({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId,o.clusterMaxZoom!==void 0&&this.maxzoom<=o.clusterMaxZoom&&s.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${o.clusterMaxZoom}".`),this.workerOptions=s.e({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(o.buffer!==void 0?o.buffer:128),tolerance:this._pixelsToTileUnits(o.tolerance!==void 0?o.tolerance:.375),extent:s.a5,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(o.clusterMaxZoom),minPoints:Math.max(2,o.clusterMinPoints||2),extent:s.a5,radius:this._pixelsToTileUnits(o.clusterRadius||50),log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_hasPendingWorkerUpdate(){return this._pendingWorkerUpdate.data!==void 0||this._pendingWorkerUpdate.diff!==void 0||this._pendingWorkerUpdate.optionsChanged}_pixelsToTileUnits(t){return t*(s.a5/this.tileSize)}_getClusterMaxZoom(t){const o=t?Math.round(t):this.maxzoom-1;return Number.isInteger(t)||t===void 0||s.w(`Integer expected for option 'clusterMaxZoom': provided value "${t}" rounded to "${o}"`),o}load(){return s._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(t){this.map=t,this.load()}setData(t,o){this._data=typeof t=="string"?{url:t}:{geojson:t},this._pendingWorkerUpdate={data:t};const d=this._updateWorkerData();return o?d:this}updateData(t,o){this._pendingWorkerUpdate.diff=s.a6(this._pendingWorkerUpdate.diff,t);const d=this._updateWorkerData();return o?d:this}getData(){return s._(this,void 0,void 0,(function*(){const t=s.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:t})}))}getBounds(){return s._(this,void 0,void 0,(function*(){return lr(yield this.getData())}))}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(t.clusterRadius)),t.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(t.clusterMaxZoom)),this._pendingWorkerUpdate.optionsChanged=!0,this._updateWorkerData(),this}getClusterExpansionZoom(t){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:t,source:this.id}})}getClusterChildren(t){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:t,source:this.id}})}getClusterLeaves(t,o,d){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:t,limit:o,offset:d}})}_updateWorkerData(){return s._(this,void 0,void 0,(function*(){if(this._isUpdatingWorker)return;if(!this._hasPendingWorkerUpdate())return void s.w(`No pending worker updates for GeoJSONSource ${this.id}.`);const{data:t,diff:o}=this._pendingWorkerUpdate,d=s.e({type:this.type},this.workerOptions);t!==void 0?(typeof t=="string"?(d.request=this.map._requestManager.transformRequest(j.resolveURL(t),"Source"),d.request.collectResourceTiming=this._collectResourceTiming):d.data=t,this._pendingWorkerUpdate.data=void 0):o&&(d.dataDiff=o,this._pendingWorkerUpdate.diff=void 0),this._pendingWorkerUpdate.optionsChanged=void 0,this._isUpdatingWorker=!0,this.fire(new s.l("dataloading",{dataType:"source"}));try{const x=yield this.actor.sendAsync({type:"LD",data:d});if(this._isUpdatingWorker=!1,this._removed||x.abandoned)return void this.fire(new s.l("dataabort",{dataType:"source"}));x.data&&(this._data={geojson:x.data});const S=this._applyDiffToSource(o),A=this._getShouldReloadTileOptions(S);let R=null;x.resourceTiming&&x.resourceTiming[this.id]&&(R=x.resourceTiming[this.id].slice(0));const F={dataType:"source"};this._collectResourceTiming&&R&&R.length>0&&s.e(F,{resourceTiming:R}),this.fire(new s.l("data",Object.assign(Object.assign({},F),{sourceDataType:"metadata"}))),this.fire(new s.l("data",Object.assign(Object.assign({},F),{sourceDataType:"content",shouldReloadTileOptions:A})))}catch(x){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new s.l("dataabort",{dataType:"source"}));this.fire(new s.k(x))}finally{this._hasPendingWorkerUpdate()&&this._updateWorkerData()}}))}_applyDiffToSource(t){if(!t)return;const o=typeof this.promoteId=="string"?this.promoteId:void 0;if(!this._data.url&&!this._data.updateable){const x=s.a7(this._data.geojson,o);if(!x)throw new Error(`GeoJSONSource "${this.id}": GeoJSON data is not compatible with updateData`);this._data={updateable:x}}if(!this._data.updateable)return;const d=s.a8(this._data.updateable,t,o);return t.removeAll||this._options.cluster?void 0:d}_getShouldReloadTileOptions(t){if(t)return{affectedBounds:t.filter(Boolean).map((o=>lr(o)))}}shouldReloadTile(t,{affectedBounds:o}){if(t.state==="loading")return!0;if(t.state==="unloaded")return!1;const{buffer:d,extent:x}=this.workerOptions.geojsonVtOptions,S=(function({x:A,y:R,z:F},V=0){const q=s.a3((A-V)/Math.pow(2,F)),te=s.a4((R+1+V)/Math.pow(2,F)),ee=s.a3((A+1+V)/Math.pow(2,F)),ce=s.a4((R-V)/Math.pow(2,F));return new Ee([q,te],[ee,ce])})(t.tileID.canonical,d/x);for(const A of o)if(S.intersects(A))return!0;return!1}loaded(){return!this._isUpdatingWorker&&!this._hasPendingWorkerUpdate()}loadTile(t){return s._(this,void 0,void 0,(function*(){const o=t.actor?"RT":"LT";t.actor=this.actor;const d={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};t.abortController=new AbortController;const x=yield this.actor.sendAsync({type:o,data:d},t.abortController);delete t.abortController,t.unloadVectorData(),t.aborted||t.loadVectorData(x,this.map.painter,o==="RT")}))}abortTile(t){return s._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.aborted=!0}))}unloadTile(t){return s._(this,void 0,void 0,(function*(){t.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return s.e({},this._options,{type:this.type,data:this._data.updateable?{type:"FeatureCollection",features:Array.from(this._data.updateable.values())}:this._data.url||this._data.geojson})}hasTransition(){return!1}}class ir extends s.E{constructor(t,o,d,x){super(),this.flippedWindingOrder=!1,this.id=t,this.dispatcher=d,this.coordinates=o.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(x),this.options=o}load(t){return s._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const o=yield re.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,o&&o.data&&(this.image=o.data,t&&(this.coordinates=t),this._finishLoading())}catch(o){this._request=null,this._loaded=!0,s.Z(o)||this.fire(new s.k(o))}}))}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=t.url,this.load(t.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(t){this.coordinates=t;const o=t.map(s.a9.fromLngLat);var d;return this.tileID=(function(x){const S=s.aa.fromPoints(x),A=S.width(),R=S.height(),F=Math.max(A,R),V=Math.max(0,Math.floor(-Math.log(F)/Math.LN2)),q=Math.pow(2,V);return new s.ac(V,Math.floor((S.minX+S.maxX)/2*q),Math.floor((S.minY+S.maxY)/2*q))})(o),this.terrainTileRanges=this._getOverlappingTileRanges(o),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=o.map((x=>this.tileID.getTilePoint(x)._round())),this.flippedWindingOrder=((d=this.tileCoords)[1].x-d[0].x)*(d[2].y-d[0].y)-(d[1].y-d[0].y)*(d[2].x-d[0].x)<0,this.fire(new s.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,o=t.gl;this.texture||(this.texture=new s.T(t,this.image,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE));let d=!1;for(const x in this.tiles){const S=this.tiles[x];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture,d=!0)}d&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(t){return s._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={}):t.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(t){const{minX:o,minY:d,maxX:x,maxY:S}=s.aa.fromPoints(t),A={};for(let R=0;R<=s.ab;R++){const F=Math.pow(2,R),V=Math.floor(o*F),q=Math.floor(d*F),te=Math.floor(x*F),ee=Math.floor(S*F);A[R]={minTileX:V,minTileY:q,maxTileX:te,maxTileY:ee}}return A}}class st extends ir{constructor(t,o,d,x){super(t,o,d,x),this.roundZoom=!0,this.type="video",this.options=o}load(){return s._(this,void 0,void 0,(function*(){this._loaded=!1;const t=this.options;this.urls=[];for(const o of t.urls)this.urls.push(this.map._requestManager.transformRequest(o,"Source").url);try{const o=yield s.ad(this.urls);if(this._loaded=!0,!o)return;this.video=o,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(o){this.fire(new s.k(o))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const o=this.video.seekable;t<o.start(0)||t>o.end(0)?this.fire(new s.k(new s.ae(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,o=t.gl;this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new s.T(t,this.video,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE));let d=!1;for(const x in this.tiles){const S=this.tiles[x];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture,d=!0)}d&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class fe extends ir{constructor(t,o,d,x){super(t,o,d,x),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some((S=>!Array.isArray(S)||S.length!==2||S.some((A=>typeof A!="number"))))||this.fire(new s.k(new s.ae(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.k(new s.ae(`sources.${t}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new s.k(new s.ae(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof HTMLCanvasElement||this.fire(new s.k(new s.ae(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.k(new s.ae(`sources.${t}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){return s._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context,d=o.gl;this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):(this.texture=new s.T(o,this.canvas,d.RGBA,{premultiply:!0}),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE));let x=!1;for(const S in this.tiles){const A=this.tiles[S];A.state!=="loaded"&&(A.state="loaded",A.texture=this.texture,x=!0)}x&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",animate:this.animate,canvas:this.options.canvas,coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const he={},we=w=>{switch(w){case"geojson":return pr;case"image":return ir;case"raster":return Jt;case"raster-dem":return Kt;case"vector":return pt;case"video":return st;case"canvas":return fe}return he[w]},Ve="RTLPluginLoaded";class Xe extends s.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Or()}_syncState(t){return this.status=t,this.dispatcher.broadcast("SRPS",{pluginStatus:t,pluginURL:this.url}).catch((o=>{throw this.status="error",o}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(t){return s._(this,arguments,void 0,(function*(o,d=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=j.resolveURL(o),!this.url)throw new Error(`requested url ${o} is invalid`);if(this.status==="unavailable"){if(!d)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return s._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new s.l(Ve))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let xt=null;function ot(){return xt||(xt=new Xe),xt}var it,vt;(function(w){w[w.Base=0]="Base",w[w.Parent=1]="Parent"})(it||(it={})),(function(w){w[w.Departing=0]="Departing",w[w.Incoming=1]="Incoming"})(vt||(vt={}));class zt{constructor(t,o){this.timeAdded=0,this.fadeEndTime=0,this.fadeOpacity=1,this.tileID=t,this.uid=s.af(),this.uses=0,this.tileSize=o,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}isRenderable(t){return this.hasData()&&(!this.fadeEndTime||this.fadeOpacity>0)&&(t||!this.holdingForSymbolFade())}setCrossFadeLogic({fadingRole:t,fadingDirection:o,fadingParentID:d,fadeEndTime:x}){this.resetFadeLogic(),this.fadingRole=t,this.fadingDirection=o,this.fadingParentID=d,this.fadeEndTime=x}setSelfFadeLogic(t){this.resetFadeLogic(),this.selfFading=!0,this.fadeEndTime=t}resetFadeLogic(){this.fadingRole=null,this.fadingDirection=null,this.fadingParentID=null,this.selfFading=!1,this.timeAdded=O(),this.fadeEndTime=0,this.fadeOpacity=1}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,o,d){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData,this.latestFeatureIndex.encoding=t.encoding):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData,this.latestFeatureIndex.encoding=this.latestEncoding)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=(function(x,S){const A={};if(!S)return A;for(const R of x){const F=R.layerIds.map((V=>S.getLayer(V))).filter(Boolean);if(F.length!==0){R.layers=F,R.stateDependentLayerIds&&(R.stateDependentLayers=R.stateDependentLayerIds.map((V=>F.filter((q=>q.id===V))[0])));for(const V of F)A[V.id]=R}}return A})(t.buckets,o?.style),this.hasSymbolBuckets=!1;for(const x in this.buckets){const S=this.buckets[x];if(S instanceof s.ah){if(this.hasSymbolBuckets=!0,!d)break;S.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const x in this.buckets){const S=this.buckets[x];if(S instanceof s.ah&&S.hasRTLText){this.hasRTLText=!0,ot().lazyLoad();break}}this.queryPadding=0;for(const x in this.buckets){const S=this.buckets[x];this.queryPadding=Math.max(this.queryPadding,o.style.getLayer(x).queryRadius(S))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),this.dashPositions=t.dashPositions}else this.collisionBoxArray=new s.ag}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const d in this.buckets){const x=this.buckets[d];x.uploadPending()&&x.upload(t)}const o=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new s.T(t,this.imageAtlas.image,o.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new s.T(t,this.glyphAtlasImage,o.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,o,d,x,S,A,R,F,V,q,te){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:x,cameraQueryGeometry:S,scale:A,tileSize:this.tileSize,pixelPosMatrix:q,transform:F,params:R,queryPadding:this.queryPadding*V,getElevation:te},t,o,d):{}}querySourceFeatures(t,o){const d=this.latestFeatureIndex;if(!d||!d.rawTileData)return;const x=d.loadVTLayers(),S=o&&o.sourceLayer?o.sourceLayer:"",A=x[s.ai]||x[S];if(!A)return;const R=s.aj(o?.filter,o?.globalState),{z:F,x:V,y:q}=this.tileID.canonical,te={z:F,x:V,y:q};for(let ee=0;ee<A.length;ee++){const ce=A.feature(ee);if(R.needGeometry){const Be=s.ak(ce,!0);if(!R.filter(new s.H(this.tileID.overscaledZ),Be,this.tileID.canonical))continue}else if(!R.filter(new s.H(this.tileID.overscaledZ),ce))continue;const _e=d.getId(ce,S),Ie=new s.al(ce,F,V,q,_e);Ie.tile=te,t.push(Ie)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const o=this.expirationTime;if(t.cacheControl){const d=s.am(t.cacheControl);d["max-age"]&&(this.expirationTime=Date.now()+1e3*d["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const d=Date.now();let x=!1;if(this.expirationTime>d)x=!1;else if(o)if(this.expirationTime<o)x=!0;else{const S=this.expirationTime-o;S?this.expirationTime=d+Math.max(S,3e4):x=!0}else x=!0;x?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,o){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const d=this.latestFeatureIndex.loadVTLayers();for(const x in this.buckets){if(!o.style.hasLayer(x))continue;const S=this.buckets[x],A=S.layers[0].sourceLayer||s.ai,R=d[A],F=t[A];if(!R||!F||Object.keys(F).length===0)continue;S.update(F,R,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});const V=o&&o.style&&o.style.getLayer(x);V&&(this.queryPadding=Math.max(this.queryPadding,V.queryRadius(S)))}}holdingForSymbolFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<O()}clearSymbolFadeHold(){this.symbolFadeHoldUntil=void 0}setSymbolHoldDuration(t){this.symbolFadeHoldUntil=O()+t}setDependencies(t,o){const d={};for(const x of o)d[x]=!0;this.dependencies[t]=d}hasDependency(t,o){for(const d of t){const x=this.dependencies[d];if(x){for(const S of o)if(x[S])return!0}}return!1}}class Wt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,o,d){const x=String(o);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][x]=this.stateChanges[t][x]||{},s.e(this.stateChanges[t][x],d),this.deletedStates[t]===null){this.deletedStates[t]={};for(const S in this.state[t])S!==x&&(this.deletedStates[t][S]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][x]===null){this.deletedStates[t][x]={};for(const S in this.state[t][x])d[S]||(this.deletedStates[t][x][S]=null)}else for(const S in d)this.deletedStates[t]&&this.deletedStates[t][x]&&this.deletedStates[t][x][S]===null&&delete this.deletedStates[t][x][S]}removeFeatureState(t,o,d){if(this.deletedStates[t]===null)return;const x=String(o);if(this.deletedStates[t]=this.deletedStates[t]||{},d&&o!==void 0)this.deletedStates[t][x]!==null&&(this.deletedStates[t][x]=this.deletedStates[t][x]||{},this.deletedStates[t][x][d]=null);else if(o!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][x])for(d in this.deletedStates[t][x]={},this.stateChanges[t][x])this.deletedStates[t][x][d]=null;else this.deletedStates[t][x]=null;else this.deletedStates[t]=null}getState(t,o){const d=String(o),x=s.e({},(this.state[t]||{})[d],(this.stateChanges[t]||{})[d]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const S=this.deletedStates[t][o];if(S===null)return{};for(const A in S)delete x[A]}return x}initializeTileState(t,o){t.setFeatureState(this.state,o)}coalesceChanges(t,o){const d={};for(const x in this.stateChanges){this.state[x]=this.state[x]||{};const S={};for(const A in this.stateChanges[x])this.state[x][A]||(this.state[x][A]={}),s.e(this.state[x][A],this.stateChanges[x][A]),S[A]=this.state[x][A];d[x]=S}for(const x in this.deletedStates){this.state[x]=this.state[x]||{};const S={};if(this.deletedStates[x]===null)for(const A in this.state[x])S[A]={},this.state[x][A]={};else for(const A in this.deletedStates[x]){if(this.deletedStates[x][A]===null)this.state[x][A]={};else for(const R of Object.keys(this.deletedStates[x][A]))delete this.state[x][A][R];S[A]=this.state[x][A]}d[x]=d[x]||{},s.e(d[x],S)}this.stateChanges={},this.deletedStates={},Object.keys(d).length!==0&&t.setFeatureState(d,o)}}const mr=89.25;function kr(w,t){const o=s.an(t.lat,-s.ao,s.ao);return new s.P(s.Y(t.lng)*w,s.X(o)*w)}function Kr(w,t){return new s.a9(t.x/w,t.y/w).toLngLat()}function yn(w){return w.cameraToCenterDistance*Math.min(.85*Math.tan(s.ap(90-w.pitch)),Math.tan(s.ap(mr-w.pitch)))}function hn(w,t){const o=w.canonical,d=t/s.aq(o.z),x=o.x+Math.pow(2,o.z)*w.wrap,S=s.ar(new Float64Array(16));return s.O(S,S,[x*d,o.y*d,0]),s.Q(S,S,[d/s.a5,d/s.a5,1]),S}function ht(w,t,o,d,x){const S=s.a9.fromLngLat(w,t),A=x*s.as(1,w.lat),{x:R,y:F,z:V}=En(o,d);return new s.a9(S.x+A*-R,S.y+A*-F,S.z+A*-V)}function En(w,t){const o=s.ap(w),d=s.ap(t),x=Math.cos(-o),S=Math.sin(o);return{x:S*Math.sin(d),y:-S*Math.cos(d),z:x}}function Kn(w,t,o){const d=t.intersectsFrustum(w);if(!o||d===0)return d;const x=t.intersectsPlane(o);return x===0?0:d===2&&x===2?2:1}function Qr(w,t,o){let d=0;const x=(o-t)/10;for(let S=0;S<10;S++)d+=x*Math.pow(Math.cos(t+(S+.5)/10*(o-t)),w);return d}function Ln(w,t){return function(o,d,x,S,A){const R=2*((w-1)/s.at(Math.cos(s.ap(mr-A))/Math.cos(s.ap(mr)))-1),F=Math.acos(x/S),V=2*Qr(R-1,0,s.ap(A/2)),q=Math.min(s.ap(mr),F+s.ap(A/2)),te=Qr(R-1,Math.min(q,F-s.ap(A/2)),q),ee=Math.atan(d/x),ce=Math.hypot(d,x);let _e=o;return _e+=s.at(S/ce/Math.max(.5,Math.cos(s.ap(A/2)))),_e+=R*s.at(Math.cos(ee))/2,_e-=s.at(Math.max(1,te/V/t))/2,_e}}const Ba=Ln(9.314,3);function zn(w,t){const o=(t.roundZoom?Math.round:Math.floor)(w.zoom+s.at(w.tileSize/t.tileSize));return Math.max(0,o)}function tn(w,t){const o=w.getCameraFrustum(),d=w.getClippingPlane(),x=w.screenPointToMercatorCoordinate(w.getCameraPoint()),S=s.a9.fromLngLat(w.center,w.elevation);x.z=S.z+Math.cos(w.pitchInRadians)*w.cameraToCenterDistance/w.worldSize;const A=w.getCoveringTilesDetailsProvider(),R=A.allowVariableZoom(w,t),F=zn(w,t),V=t.minzoom||0,q=t.maxzoom!==void 0?t.maxzoom:w.maxZoom,te=Math.min(Math.max(0,F),q),ee=Math.pow(2,te),ce=[ee*x.x,ee*x.y,0],_e=[ee*S.x,ee*S.y,0],Ie=Math.hypot(S.x-x.x,S.y-x.y),Be=Math.abs(S.z-x.z),ze=Math.hypot(Ie,Be),Ze=tt=>({zoom:0,x:0,y:0,wrap:tt,fullyVisible:!1}),rt=[],qe=[];if(w.renderWorldCopies&&A.allowWorldCopies())for(let tt=1;tt<=3;tt++)rt.push(Ze(-tt)),rt.push(Ze(tt));for(rt.push(Ze(0));rt.length>0;){const tt=rt.pop(),lt=tt.x,Ke=tt.y;let dt=tt.fullyVisible;const Rt={x:lt,y:Ke,z:tt.zoom},Tt=A.getTileBoundingVolume(Rt,tt.wrap,w.elevation,t);if(!dt){const hr=Kn(o,Tt,d);if(hr===0)continue;dt=hr===2}const kt=A.distanceToTile2d(x.x,x.y,Rt,Tt);let Ct=F;R&&(Ct=(t.calculateTileZoom||Ba)(w.zoom+s.at(w.tileSize/t.tileSize),kt,Be,ze,w.fov)),Ct=(t.roundZoom?Math.round:Math.floor)(Ct),Ct=Math.max(0,Ct);const ur=Math.min(Ct,q);if(tt.wrap=A.getWrap(S,Rt,tt.wrap),tt.zoom>=ur){if(tt.zoom<V)continue;const hr=te-tt.zoom,tr=ce[0]-.5-(lt<<hr),br=ce[1]-.5-(Ke<<hr),fn=t.reparseOverscaled?Math.max(tt.zoom,Ct):tt.zoom;qe.push({tileID:new s.a2(tt.zoom===q?fn:tt.zoom,tt.wrap,tt.zoom,lt,Ke),distanceSq:s.au([_e[0]-.5-lt,_e[1]-.5-Ke]),tileDistanceToCamera:Math.sqrt(tr*tr+br*br)})}else for(let hr=0;hr<4;hr++)rt.push({zoom:tt.zoom+1,x:(lt<<1)+hr%2,y:(Ke<<1)+(hr>>1),wrap:tt.wrap,fullyVisible:dt})}return qe.sort(((tt,lt)=>tt.distanceSq-lt.distanceSq)).map((tt=>tt.tileID))}const Bn=s.aa.fromPoints([new s.P(0,0),new s.P(s.a5,s.a5)]);function ba(w){return w==="raster"||w==="image"||w==="video"}function El(w,t,o,d,x,S,A){if(!t.hasData())return!1;const{tileID:R,fadingRole:F,fadingDirection:V,fadingParentID:q}=t;if(F===it.Base&&V===vt.Incoming&&q)return o[q.key]=q,!0;const te=Math.max(R.overscaledZ-x,S);for(let ee=R.overscaledZ-1;ee>=te;ee--){const ce=R.scaledTo(ee),_e=w.getLoadedTile(ce);if(_e)return t.setCrossFadeLogic({fadingRole:it.Base,fadingDirection:vt.Incoming,fadingParentID:_e.tileID,fadeEndTime:d+A}),_e.setCrossFadeLogic({fadingRole:it.Parent,fadingDirection:vt.Departing,fadeEndTime:d+A}),o[ce.key]=ce,!0}return!1}function Zo(w,t,o,d,x,S){if(!t.hasData())return!1;const A=t.tileID.children(x);let R=Qt(w,t,A,o,d,x,S);if(R)return!0;for(const F of A)Qt(w,t,F.children(x),o,d,x,S)&&(R=!0);return R}function Qt(w,t,o,d,x,S,A){if(o[0].overscaledZ>=S)return!1;let R=!1;for(const F of o){const V=w.getLoadedTile(F);if(!V)continue;const{fadingRole:q,fadingDirection:te,fadingParentID:ee}=V;q===it.Base&&te===vt.Departing&&ee||(V.setCrossFadeLogic({fadingRole:it.Base,fadingDirection:vt.Departing,fadingParentID:t.tileID,fadeEndTime:x+A}),t.setCrossFadeLogic({fadingRole:it.Parent,fadingDirection:vt.Incoming,fadeEndTime:x+A})),d[F.key]=F,R=!0}return R}function ye(w,t,o,d){const x=w.tileID;return!!w.selfFading||!w.hasData()&&!!t.has(x)&&(w.setSelfFadeLogic(o+d),!0)}function je(w,t){var o;w.needsHillshadePrepare=!0,w.needsTerrainPrepare=!0;let d=t.tileID.canonical.x-w.tileID.canonical.x;const x=t.tileID.canonical.y-w.tileID.canonical.y,S=Math.pow(2,w.tileID.canonical.z),A=t.tileID.key;d===0&&x===0||Math.abs(x)>1||(Math.abs(d)>1&&(Math.abs(d+S)===1?d+=S:Math.abs(d-S)===1&&(d-=S)),t.dem&&w.dem&&(w.dem.backfillBorder(t.dem,d,x),!((o=w.neighboringTiles)===null||o===void 0)&&o[A]&&(w.neighboringTiles[A].backfilled=!0)))}class Le{constructor(){this._tiles={}}handleWrapJump(t){const o={};for(const d in this._tiles){const x=this._tiles[d];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+t),o[x.tileID.key]=x}this._tiles=o}setFeatureState(t,o){for(const d in this._tiles)this._tiles[d].setFeatureState(t,o)}getAllTiles(){return Object.values(this._tiles)}getAllIds(t=!1){return t?Object.values(this._tiles).map((o=>o.tileID)).sort(s.aw).map((o=>o.key)):Object.keys(this._tiles)}getTileById(t){return this._tiles[t]}setTile(t,o){this._tiles[t]=o}deleteTileById(t){delete this._tiles[t]}getLoadedTile(t){const o=this.getTileById(t.key);return o?.hasData()?o:null}isIdRenderable(t,o=!1){var d;return(d=this.getTileById(t))===null||d===void 0?void 0:d.isRenderable(o)}getRenderableIds(t=0,o){const d=[];for(const x of this.getAllIds())this.isIdRenderable(x,o)&&d.push(this.getTileById(x));return o?d.sort(((x,S)=>{const A=x.tileID,R=S.tileID,F=new s.P(A.canonical.x,A.canonical.y)._rotate(-t),V=new s.P(R.canonical.x,R.canonical.y)._rotate(-t);return A.overscaledZ-R.overscaledZ||V.y-F.y||V.x-F.x})).map((x=>x.tileID.key)):d.map((x=>x.tileID)).sort(s.aw).map((x=>x.key))}}class Me extends s.E{constructor(t,o,d){super(),this.id=t,this.dispatcher=d,this.on("data",(x=>this._dataHandler(x))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((x,S,A,R)=>{const F=new(we(S.type))(x,S,A,R);if(F.id!==x)throw new Error(`Expected Source id to be ${x} instead of ${F.id}`);return F})(t,o,d,this),this._inViewTiles=new Le,this._outOfViewCache=new s.ax(0,(x=>this._unloadTile(x))),this._timers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._rasterFadeDuration=0,this._maxFadingAncestorLevels=5,this._state=new Wt,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){for(const o of this._inViewTiles.getAllTiles())o.unloadVectorData();this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t),this._inViewTiles=new Le}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t of this._inViewTiles.getAllTiles())if(t.state!=="loaded"&&t.state!=="errored")return!1;return!0}getSource(){return this._source}getState(){return this._state}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,o,d){return s._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(t),this._tileLoaded(t,o,d)}catch(x){t.state="errored",x.status!==404?this._source.fire(new s.k(x,{tile:t})):this.update(this.transform,this.terrain)}}))}_unloadTile(t){this._source.unloadTile&&this._source.unloadTile(t)}_abortTile(t){this._source.abortTile&&this._source.abortTile(t),this._source.fire(new s.l("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._inViewTiles,this.map?this.map.painter:null);for(const o of this._inViewTiles.getAllTiles())o.upload(t),o.prepare(this.map.style.imageManager)}getIds(){return this._inViewTiles.getAllIds(!0)}getRenderableIds(t){var o;return this._inViewTiles.getRenderableIds((o=this.transform)===null||o===void 0?void 0:o.bearingInRadians,t)}hasRenderableParent(t){const o=t.overscaledZ-1;if(o>=this._source.minzoom){const d=this.getLoadedTile(t.scaledTo(o));if(d)return this._inViewTiles.isIdRenderable(d.tileID.key)}return!1}reload(t,o=void 0){if(this._paused)this._shouldReloadOnResume=!0;else{this._outOfViewCache.reset();for(const d of this._inViewTiles.getAllIds()){const x=this._inViewTiles.getTileById(d);o&&!this._source.shouldReloadTile(x,o)||(t?this._reloadTile(d,"expired"):x.state!=="errored"&&this._reloadTile(d,"reloading"))}}}_reloadTile(t,o){return s._(this,void 0,void 0,(function*(){const d=this._inViewTiles.getTileById(t);d&&(d.state!=="loading"&&(d.state=o),yield this._loadTile(d,t,o))}))}_tileLoaded(t,o,d){t.timeAdded=O(),t.selfFading&&(t.fadeEndTime=t.timeAdded+this._rasterFadeDuration),d==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(o,t),this.getSource().type==="raster-dem"&&t.dem&&(function(x,S){var A,R;const F=S.getRenderableIds();for(const V of F){if(!x.neighboringTiles||!x.neighboringTiles[V])continue;const q=S.getTileById(V);x.neighboringTiles[V].backfilled||je(x,q),!((R=(A=q.neighboringTiles)===null||A===void 0?void 0:A[x.tileID.key])===null||R===void 0)&&R.backfilled||je(q,x)}})(t,this._inViewTiles),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new s.l("data",{dataType:"source",tile:t,coord:t.tileID}))}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._inViewTiles.getTileById(t)}_retainLoadedChildren(t,o){const d=this._getLoadedDescendents(o),x=new Set;for(const S of o){const A=d[S.key];if(!A?.length){x.add(S);continue}const R=S.overscaledZ+Me.maxOverzooming,F=A.filter((te=>te.tileID.overscaledZ<=R));if(!F.length){x.add(S);continue}const V=Math.min(...F.map((te=>te.tileID.overscaledZ))),q=F.filter((te=>te.tileID.overscaledZ===V)).map((te=>te.tileID));for(const te of q)t[te.key]=te;this._areDescendentsComplete(q,V,S.overscaledZ)||x.add(S)}return x}_getLoadedDescendents(t){var o;const d={};for(const x of this._inViewTiles.getAllTiles().filter((S=>S.hasData())))for(const S of t)x.tileID.isChildOf(S)&&(d[o=S.key]||(d[o]=[])).push(x);return d}_areDescendentsComplete(t,o,d){return t.length===1&&t[0].isOverscaled()?t[0].overscaledZ===o:Math.pow(4,o-d)===t.length}getLoadedTile(t){return this._inViewTiles.getLoadedTile(t)}updateCacheSize(t){const o=Math.ceil(t.width/this._source.tileSize)+1,d=Math.ceil(t.height/this._source.tileSize)+1,x=Math.floor(o*d*(this._maxTileCacheZoomLevels===null?s.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),S=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,x):x;this._outOfViewCache.setMaxSize(S)}handleWrapJump(t){const o=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);this._prevLng=t,o&&(this._inViewTiles.handleWrapJump(o),this._resetTileReloadTimers())}update(t,o){if(!this._sourceLoaded||this._paused)return;let d;this.transform=t,this.terrain=o,this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this.used||this.usedForTerrain?this._source.tileID?d=t.getVisibleUnwrappedCoordinates(this._source.tileID).map((F=>new s.a2(F.canonical.z,F.wrap,F.canonical.z,F.canonical.x,F.canonical.y))):(d=tn(t,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.type==="vector"&&this.map._zoomLevelsToOverscale!==void 0?t.maxZoom-this.map._zoomLevelsToOverscale:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:o,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(d=d.filter((F=>this._source.hasTile(F))))):d=[],this.usedForTerrain&&(d=this._addTerrainIdealTiles(d));const x=d.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,x&&this.fire(new s.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const S=zn(t,this._source),A=this._updateRetainedTiles(d,S),R=ba(this._source.type);R&&this._rasterFadeDuration>0&&!o&&(function(F,V,q,te,ee,ce,_e){const Ie=O(),Be=s.av(V);for(const ze of V){const Ze=F.getTileById(ze.key);Ze.fadingDirection!==vt.Departing&&Ze.fadeOpacity!==0||Ze.resetFadeLogic(),El(F,Ze,q,Ie,te,ee,_e)||Zo(F,Ze,q,Ie,ce,_e)||ye(Ze,Be,Ie,_e)||Ze.resetFadeLogic()}})(this._inViewTiles,d,A,this._maxFadingAncestorLevels,this._source.minzoom,this._source.maxzoom,this._rasterFadeDuration),R?this._cleanUpRasterTiles(A):this._cleanUpVectorTiles(A)}_cleanUpRasterTiles(t){for(const o of this._inViewTiles.getAllIds())t[o]||this._removeTile(o)}_cleanUpVectorTiles(t){for(const o of this._inViewTiles.getAllIds()){const d=this._inViewTiles.getTileById(o);t[o]?d.clearSymbolFadeHold():d.hasSymbolBuckets?d.holdingForSymbolFade()?d.symbolFadeFinished()&&this._removeTile(o):d.setSymbolHoldDuration(this.map._fadeDuration):this._removeTile(o)}}_addTerrainIdealTiles(t){const o=[];for(const d of t)if(d.canonical.z>this._source.minzoom){const x=d.scaledTo(d.canonical.z-1);o.push(x);const S=d.scaledTo(Math.max(this._source.minzoom,Math.min(d.canonical.z,5)));o.push(S)}return t.concat(o)}releaseSymbolFadeTiles(){for(const t of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(t).holdingForSymbolFade()&&this._removeTile(t)}_updateRetainedTiles(t,o){var d;const x=new Set;for(const V of t)this._addTile(V).hasData()||x.add(V);const S=t.reduce(((V,q)=>(V[q.key]=q,V)),{}),A=this._retainLoadedChildren(S,x),R={},F=Math.max(o-Me.maxUnderzooming,this._source.minzoom);for(const V of A){let q=this._inViewTiles.getTileById(V.key),te=q?.wasRequested();for(let ee=V.overscaledZ-1;ee>=F;--ee){const ce=V.scaledTo(ee);if(R[ce.key])break;if(R[ce.key]=!0,q=this.getTile(ce),!q&&te&&(q=this._addTile(ce)),q){const _e=q.hasData();if((_e||!(!((d=this.map)===null||d===void 0)&&d.cancelPendingTileRequestsWhileZooming)||te)&&(S[ce.key]=ce),te=q.wasRequested(),_e)break}}}return S}_addTile(t){let o=this._inViewTiles.getTileById(t.key);if(o)return o;o=this._outOfViewCache.getAndRemove(t),o&&(o.resetFadeLogic(),this._setTileReloadTimer(t.key,o),o.tileID=t,this._state.initializeTileState(o,this.map?this.map.painter:null));const d=o;return o||(o=new zt(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(o,t.key,o.state)),o.uses++,this._inViewTiles.setTile(t.key,o),d||this._source.fire(new s.l("dataloading",{tile:o,coord:o.tileID,dataType:"source"})),o}_setTileReloadTimer(t,o){this._clearTileReloadTimer(t);const d=o.getExpiryTimeout();d&&(this._timers[t]=setTimeout((()=>{this._reloadTile(t,"expired"),delete this._timers[t]}),d))}_clearTileReloadTimer(t){const o=this._timers[t];o&&(clearTimeout(o),delete this._timers[t])}_resetTileReloadTimers(){for(const t in this._timers)clearTimeout(this._timers[t]),delete this._timers[t];for(const t of this._inViewTiles.getAllIds()){const o=this._inViewTiles.getTileById(t);this._setTileReloadTimer(t,o)}}refreshTiles(t){for(const o of this._inViewTiles.getAllIds()){const d=this._inViewTiles.getTileById(o);(this._inViewTiles.isIdRenderable(o)||d.state=="errored")&&t.some((x=>x.equals(d.tileID.canonical)))&&this._reloadTile(o,"expired")}}_removeTile(t){const o=this._inViewTiles.getTileById(t);o&&(o.uses--,this._inViewTiles.deleteTileById(t),this._clearTileReloadTimer(t),o.uses>0||(o.hasData()&&o.state!=="reloading"?this._outOfViewCache.add(o.tileID,o,o.getExpiryTimeout()):(o.aborted=!0,this._abortTile(o),this._unloadTile(o))))}_dataHandler(t){t.dataType==="source"&&(t.sourceDataType!=="metadata"?t.sourceDataType==="content"&&this._sourceLoaded&&!this._paused&&(this.reload(t.sourceDataChanged,t.shouldReloadTileOptions),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0):this._sourceLoaded=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t of this._inViewTiles.getAllIds())this._removeTile(t);this._outOfViewCache.reset()}tilesIn(t,o,d){const x=[],S=this.transform;if(!S)return x;const A=S.getCoveringTilesDetailsProvider().allowWorldCopies(),R=d?S.getCameraQueryGeometry(t):t,F=ce=>S.screenPointToMercatorCoordinate(ce,this.terrain),V=this.transformBbox(t,F,!A),q=this.transformBbox(R,F,!A),te=this.getIds(),ee=s.aa.fromPoints(q);for(let ce=0;ce<te.length;ce++){const _e=this._inViewTiles.getTileById(te[ce]);if(_e.holdingForSymbolFade())continue;const Ie=A?[_e.tileID]:[_e.tileID.unwrapTo(-1),_e.tileID.unwrapTo(0)],Be=Math.pow(2,S.zoom-_e.tileID.overscaledZ),ze=o*_e.queryPadding*s.a5/_e.tileSize/Be;for(const Ze of Ie){const rt=ee.map((qe=>Ze.getTilePoint(new s.a9(qe.x,qe.y))));if(rt.expandBy(ze),rt.intersects(Bn)){const qe=V.map((lt=>Ze.getTilePoint(lt))),tt=q.map((lt=>Ze.getTilePoint(lt)));x.push({tile:_e,tileID:A?Ze:Ze.unwrapTo(0),queryGeometry:qe,cameraQueryGeometry:tt,scale:Be})}}}return x}transformBbox(t,o,d){let x=t.map(o);if(d){const S=s.aa.fromPoints(t);S.shrinkBy(.001*Math.min(S.width(),S.height()));const A=S.map(o);s.aa.fromPoints(x).covers(A)||(x=x.map((R=>R.x>.5?new s.a9(R.x-1,R.y,R.z):R)))}return x}getVisibleCoordinates(t){const o=this.getRenderableIds(t).map((d=>this._inViewTiles.getTileById(d).tileID));return this.transform&&this.transform.populateCache(o),o}hasTransition(){return!!this._source.hasTransition()||!(!ba(this._source.type)||!(function(t,o){if(o<=0)return!1;const d=O();for(const x of t.getAllTiles())if(x.fadeEndTime>=d)return!0;return!1})(this._inViewTiles,this._rasterFadeDuration))}setRasterFadeDuration(t){this._rasterFadeDuration=t}setFeatureState(t,o,d){this._state.updateState(t=t||s.ai,o,d)}removeFeatureState(t,o,d){this._state.removeFeatureState(t=t||s.ai,o,d)}getFeatureState(t,o){return this._state.getState(t=t||s.ai,o)}setDependencies(t,o,d){const x=this._inViewTiles.getTileById(t);x&&x.setDependencies(o,d)}reloadTilesForDependencies(t,o){for(const d of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(d).hasDependency(t,o)&&this._reloadTile(d,"reloading");this._outOfViewCache.filter((d=>!d.hasDependency(t,o)))}areTilesLoaded(){for(const t of this._inViewTiles.getAllTiles())if(t.state!=="loaded"&&t.state!=="errored")return!1;return!0}}Me.maxUnderzooming=10,Me.maxOverzooming=3;class Te{constructor(t,o){this.reset(t,o)}reset(t,o){this.points=t||[],this._distances=[0];for(let d=1;d<this.points.length;d++)this._distances[d]=this._distances[d-1]+this.points[d].dist(this.points[d-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(o||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=s.an(t,0,1);let o=1,d=this._distances[o];const x=t*this.paddedLength+this.padding;for(;d<x&&o<this._distances.length;)d=this._distances[++o];const S=o-1,A=this._distances[S],R=d-A,F=R>0?(x-A)/R:0;return this.points[S].mult(1-F).add(this.points[o].mult(F))}}function Pe(w,t){let o=!0;return w==="always"||w!=="never"&&t!=="never"||(o=!1),o}class gt{constructor(t,o,d){const x=this.boxCells=[],S=this.circleCells=[];this.xCellCount=Math.ceil(t/d),this.yCellCount=Math.ceil(o/d);for(let A=0;A<this.xCellCount*this.yCellCount;A++)x.push([]),S.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=o,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/o,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,o,d,x,S){this._forEachCell(o,d,x,S,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(o),this.bboxes.push(d),this.bboxes.push(x),this.bboxes.push(S)}insertCircle(t,o,d,x){this._forEachCell(o-x,d-x,o+x,d+x,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(o),this.circles.push(d),this.circles.push(x)}_insertBoxCell(t,o,d,x,S,A){this.boxCells[S].push(A)}_insertCircleCell(t,o,d,x,S,A){this.circleCells[S].push(A)}_query(t,o,d,x,S,A,R){if(d<0||t>this.width||x<0||o>this.height)return[];const F=[];if(t<=0&&o<=0&&this.width<=d&&this.height<=x){if(S)return[{key:null,x1:t,y1:o,x2:d,y2:x}];for(let V=0;V<this.boxKeys.length;V++)F.push({key:this.boxKeys[V],x1:this.bboxes[4*V],y1:this.bboxes[4*V+1],x2:this.bboxes[4*V+2],y2:this.bboxes[4*V+3]});for(let V=0;V<this.circleKeys.length;V++){const q=this.circles[3*V],te=this.circles[3*V+1],ee=this.circles[3*V+2];F.push({key:this.circleKeys[V],x1:q-ee,y1:te-ee,x2:q+ee,y2:te+ee})}}else this._forEachCell(t,o,d,x,this._queryCell,F,{hitTest:S,overlapMode:A,seenUids:{box:{},circle:{}}},R);return F}query(t,o,d,x){return this._query(t,o,d,x,!1,null)}hitTest(t,o,d,x,S,A){return this._query(t,o,d,x,!0,S,A).length>0}hitTestCircle(t,o,d,x,S){const A=t-d,R=t+d,F=o-d,V=o+d;if(R<0||A>this.width||V<0||F>this.height)return!1;const q=[];return this._forEachCell(A,F,R,V,this._queryCellCircle,q,{hitTest:!0,overlapMode:x,circle:{x:t,y:o,radius:d},seenUids:{box:{},circle:{}}},S),q.length>0}_queryCell(t,o,d,x,S,A,R,F){const{seenUids:V,hitTest:q,overlapMode:te}=R,ee=this.boxCells[S];if(ee!==null){const _e=this.bboxes;for(const Ie of ee)if(!V.box[Ie]){V.box[Ie]=!0;const Be=4*Ie,ze=this.boxKeys[Ie];if(t<=_e[Be+2]&&o<=_e[Be+3]&&d>=_e[Be+0]&&x>=_e[Be+1]&&(!F||F(ze))&&(!q||!Pe(te,ze.overlapMode))&&(A.push({key:ze,x1:_e[Be],y1:_e[Be+1],x2:_e[Be+2],y2:_e[Be+3]}),q))return!0}}const ce=this.circleCells[S];if(ce!==null){const _e=this.circles;for(const Ie of ce)if(!V.circle[Ie]){V.circle[Ie]=!0;const Be=3*Ie,ze=this.circleKeys[Ie];if(this._circleAndRectCollide(_e[Be],_e[Be+1],_e[Be+2],t,o,d,x)&&(!F||F(ze))&&(!q||!Pe(te,ze.overlapMode))){const Ze=_e[Be],rt=_e[Be+1],qe=_e[Be+2];if(A.push({key:ze,x1:Ze-qe,y1:rt-qe,x2:Ze+qe,y2:rt+qe}),q)return!0}}}return!1}_queryCellCircle(t,o,d,x,S,A,R,F){const{circle:V,seenUids:q,overlapMode:te}=R,ee=this.boxCells[S];if(ee!==null){const _e=this.bboxes;for(const Ie of ee)if(!q.box[Ie]){q.box[Ie]=!0;const Be=4*Ie,ze=this.boxKeys[Ie];if(this._circleAndRectCollide(V.x,V.y,V.radius,_e[Be+0],_e[Be+1],_e[Be+2],_e[Be+3])&&(!F||F(ze))&&!Pe(te,ze.overlapMode))return A.push(!0),!0}}const ce=this.circleCells[S];if(ce!==null){const _e=this.circles;for(const Ie of ce)if(!q.circle[Ie]){q.circle[Ie]=!0;const Be=3*Ie,ze=this.circleKeys[Ie];if(this._circlesCollide(_e[Be],_e[Be+1],_e[Be+2],V.x,V.y,V.radius)&&(!F||F(ze))&&!Pe(te,ze.overlapMode))return A.push(!0),!0}}}_forEachCell(t,o,d,x,S,A,R,F){const V=this._convertToXCellCoord(t),q=this._convertToYCellCoord(o),te=this._convertToXCellCoord(d),ee=this._convertToYCellCoord(x);for(let ce=V;ce<=te;ce++)for(let _e=q;_e<=ee;_e++)if(S.call(this,t,o,d,x,this.xCellCount*_e+ce,A,R,F))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,o,d,x,S,A){const R=x-t,F=S-o,V=d+A;return V*V>R*R+F*F}_circleAndRectCollide(t,o,d,x,S,A,R){const F=(A-x)/2,V=Math.abs(t-(x+F));if(V>F+d)return!1;const q=(R-S)/2,te=Math.abs(o-(S+q));if(te>q+d)return!1;if(V<=F||te<=q)return!0;const ee=V-F,ce=te-q;return ee*ee+ce*ce<=d*d}}function jt(w,t,o){const d=s.N();if(!w){const{vecSouth:te,vecEast:ee}=At(t),ce=M();ce[0]=ee[0],ce[1]=ee[1],ce[2]=te[0],ce[3]=te[1],x=ce,(q=(A=(S=ce)[0])*(V=S[3])-(F=S[2])*(R=S[1]))&&(x[0]=V*(q=1/q),x[1]=-R*q,x[2]=-F*q,x[3]=A*q),d[0]=ce[0],d[1]=ce[1],d[4]=ce[2],d[5]=ce[3]}var x,S,A,R,F,V,q;return s.Q(d,d,[1/o,1/o,1]),d}function Dt(w,t,o,d){if(w){const x=s.N();if(!t){const{vecSouth:S,vecEast:A}=At(o);x[0]=A[0],x[1]=A[1],x[4]=S[0],x[5]=S[1]}return s.Q(x,x,[d,d,1]),x}return o.pixelsToClipSpaceMatrix}function At(w){const t=Math.cos(w.rollInRadians),o=Math.sin(w.rollInRadians),d=Math.cos(w.pitchInRadians),x=Math.cos(w.bearingInRadians),S=Math.sin(w.bearingInRadians),A=s.aC();A[0]=-x*d*o-S*t,A[1]=-S*d*o+x*t;const R=s.aD(A);R<1e-9?s.aE(A):s.aF(A,A,1/R);const F=s.aC();F[0]=x*d*t-S*o,F[1]=S*d*t+x*o;const V=s.aD(F);return V<1e-9?s.aE(F):s.aF(F,F,1/V),{vecEast:F,vecSouth:A}}function _t(w,t,o,d){let x;d?(x=[w,t,d(w,t),1],s.aH(x,x,o)):(x=[w,t,0,1],bs(x,x,o));const S=x[3];return{point:new s.P(x[0]/S,x[1]/S),signedDistanceFromCamera:S,isOccluded:!1}}function or(w,t){return .5+w/t*.5}function yr(w,t){return w.x>=-t[0]&&w.x<=t[0]&&w.y>=-t[1]&&w.y<=t[1]}function vr(w,t,o,d,x,S,A,R,F,V,q,te,ee){const ce=o?w.textSizeData:w.iconSizeData,_e=s.ay(ce,t.transform.zoom),Ie=[256/t.width*2+1,256/t.height*2+1],Be=o?w.text.dynamicLayoutVertexArray:w.icon.dynamicLayoutVertexArray;Be.clear();const ze=w.lineVertexArray,Ze=o?w.text.placedSymbolArray:w.icon.placedSymbolArray,rt=t.transform.width/t.transform.height;let qe=!1;for(let tt=0;tt<Ze.length;tt++){const lt=Ze.get(tt);if(lt.hidden||lt.writingMode===s.az.vertical&&!qe){wi(lt.numGlyphs,Be);continue}qe=!1;const Ke=new s.P(lt.anchorX,lt.anchorY),dt={getElevation:ee,pitchedLabelPlaneMatrix:d,lineVertexArray:ze,pitchWithMap:S,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:t.transform,tileAnchorPoint:Ke,unwrappedTileID:F,width:V,height:q,translation:te},Rt=Fs(lt.anchorX,lt.anchorY,dt);if(!yr(Rt.point,Ie)){wi(lt.numGlyphs,Be);continue}const Tt=or(t.transform.cameraToCenterDistance,Rt.signedDistanceFromCamera),kt=s.aA(ce,_e,lt),Ct=S?kt*t.transform.getPitchedTextCorrection(lt.anchorX,lt.anchorY,F)/Tt:kt*Tt,ur=Ur({projectionContext:dt,pitchedLabelPlaneMatrixInverse:x,symbol:lt,fontSize:Ct,flip:!1,keepUpright:A,glyphOffsetArray:w.glyphOffsetArray,dynamicLayoutVertexArray:Be,aspectRatio:rt,rotateToLine:R});qe=ur.useVertical,(ur.notEnoughRoom||qe||ur.needsFlipping&&Ur({projectionContext:dt,pitchedLabelPlaneMatrixInverse:x,symbol:lt,fontSize:Ct,flip:!0,keepUpright:A,glyphOffsetArray:w.glyphOffsetArray,dynamicLayoutVertexArray:Be,aspectRatio:rt,rotateToLine:R}).notEnoughRoom)&&wi(lt.numGlyphs,Be)}o?w.text.dynamicLayoutVertexBuffer.updateData(Be):w.icon.dynamicLayoutVertexBuffer.updateData(Be)}function fr(w,t,o,d,x,S,A,R){const F=S.glyphStartIndex+S.numGlyphs,V=S.lineStartIndex,q=S.lineStartIndex+S.lineLength,te=t.getoffsetX(S.glyphStartIndex),ee=t.getoffsetX(F-1),ce=oi(w*te,o,d,x,S.segment,V,q,R,A);if(!ce)return null;const _e=oi(w*ee,o,d,x,S.segment,V,q,R,A);return _e?R.projectionCache.anyProjectionOccluded?null:{first:ce,last:_e}:null}function _r(w,t,o,d){return w===s.az.horizontal&&Math.abs(o.y-t.y)>Math.abs(o.x-t.x)*d?{useVertical:!0}:(w===s.az.vertical?t.y<o.y:t.x>o.x)?{needsFlipping:!0}:null}function Ur(w){const{projectionContext:t,pitchedLabelPlaneMatrixInverse:o,symbol:d,fontSize:x,flip:S,keepUpright:A,glyphOffsetArray:R,dynamicLayoutVertexArray:F,aspectRatio:V,rotateToLine:q}=w,te=x/24,ee=d.lineOffsetX*te,ce=d.lineOffsetY*te;let _e;if(d.numGlyphs>1){const Ie=d.glyphStartIndex+d.numGlyphs,Be=d.lineStartIndex,ze=d.lineStartIndex+d.lineLength,Ze=fr(te,R,ee,ce,S,d,q,t);if(!Ze)return{notEnoughRoom:!0};const rt=Mi(Ze.first.point.x,Ze.first.point.y,t,o),qe=Mi(Ze.last.point.x,Ze.last.point.y,t,o);if(A&&!S){const tt=_r(d.writingMode,rt,qe,V);if(tt)return tt}_e=[Ze.first];for(let tt=d.glyphStartIndex+1;tt<Ie-1;tt++){const lt=oi(te*R.getoffsetX(tt),ee,ce,S,d.segment,Be,ze,t,q);if(!lt)return{notEnoughRoom:!0};_e.push(lt)}_e.push(Ze.last)}else{if(A&&!S){const Be=Zr(t.tileAnchorPoint.x,t.tileAnchorPoint.y,t).point,ze=d.lineStartIndex+d.segment+1,Ze=new s.P(t.lineVertexArray.getx(ze),t.lineVertexArray.gety(ze)),rt=Zr(Ze.x,Ze.y,t),qe=rt.signedDistanceFromCamera>0?rt.point:Tn(t.tileAnchorPoint,Ze,Be,1,t),tt=Mi(Be.x,Be.y,t,o),lt=Mi(qe.x,qe.y,t,o),Ke=_r(d.writingMode,tt,lt,V);if(Ke)return Ke}const Ie=oi(te*R.getoffsetX(d.glyphStartIndex),ee,ce,S,d.segment,d.lineStartIndex,d.lineStartIndex+d.lineLength,t,q);if(!Ie||t.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};_e=[Ie]}for(const Ie of _e)s.aG(F,Ie.point,Ie.angle);return{}}function Tn(w,t,o,d,x){const S=w.add(w.sub(t)._unit()),A=Zr(S.x,S.y,x).point,R=o.sub(A);return o.add(R._mult(d/R.mag()))}function vn(w,t,o){const d=t.projectionCache;if(d.projections[w])return d.projections[w];const x=new s.P(t.lineVertexArray.getx(w),t.lineVertexArray.gety(w)),S=Zr(x.x,x.y,t);if(S.signedDistanceFromCamera>0)return d.projections[w]=S.point,d.anyProjectionOccluded=d.anyProjectionOccluded||S.isOccluded,S.point;const A=w-o.direction;return Tn(o.distanceFromAnchor===0?t.tileAnchorPoint:new s.P(t.lineVertexArray.getx(A),t.lineVertexArray.gety(A)),x,o.previousVertex,o.absOffsetX-o.distanceFromAnchor+1,t)}function Zr(w,t,o){const d=w+o.translation[0],x=t+o.translation[1];let S;return o.pitchWithMap?(S=_t(d,x,o.pitchedLabelPlaneMatrix,o.getElevation),S.isOccluded=!1):(S=o.transform.projectTileCoordinates(d,x,o.unwrappedTileID,o.getElevation),S.point.x=(.5*S.point.x+.5)*o.width,S.point.y=(.5*-S.point.y+.5)*o.height),S}function Mi(w,t,o,d){if(o.pitchWithMap){const x=[w,t,0,1];return s.aH(x,x,d),o.transform.projectTileCoordinates(x[0]/x[3],x[1]/x[3],o.unwrappedTileID,o.getElevation).point}return{x:w/o.width*2-1,y:1-t/o.height*2}}function Fs(w,t,o){return o.transform.projectTileCoordinates(w,t,o.unwrappedTileID,o.getElevation)}function pi(w,t,o){return w._unit()._perp()._mult(t*o)}function bi(w,t,o,d,x,S,A,R,F){if(R.projectionCache.offsets[w])return R.projectionCache.offsets[w];const V=o.add(t);if(w+F.direction<d||w+F.direction>=x)return R.projectionCache.offsets[w]=V,V;const q=vn(w+F.direction,R,F),te=pi(q.sub(o),A,F.direction),ee=o.add(te),ce=q.add(te);return R.projectionCache.offsets[w]=s.aI(S,V,ee,ce)||V,R.projectionCache.offsets[w]}function oi(w,t,o,d,x,S,A,R,F){const V=d?w-t:w+t;let q=V>0?1:-1,te=0;d&&(q*=-1,te=Math.PI),q<0&&(te+=Math.PI);let ee,ce=q>0?S+x:S+x+1;R.projectionCache.cachedAnchorPoint?ee=R.projectionCache.cachedAnchorPoint:(ee=Zr(R.tileAnchorPoint.x,R.tileAnchorPoint.y,R).point,R.projectionCache.cachedAnchorPoint=ee);let _e,Ie,Be=ee,ze=ee,Ze=0,rt=0;const qe=Math.abs(V),tt=[];let lt;for(;Ze+rt<=qe;){if(ce+=q,ce<S||ce>=A)return null;Ze+=rt,ze=Be,Ie=_e;const Rt={absOffsetX:qe,direction:q,distanceFromAnchor:Ze,previousVertex:ze};if(Be=vn(ce,R,Rt),o===0)tt.push(ze),lt=Be.sub(ze);else{let Tt;const kt=Be.sub(ze);Tt=kt.mag()===0?pi(vn(ce+q,R,Rt).sub(Be),o,q):pi(kt,o,q),Ie||(Ie=ze.add(Tt)),_e=bi(ce,Tt,Be,S,A,Ie,o,R,Rt),tt.push(Ie),lt=_e.sub(Ie)}rt=lt.mag()}const Ke=lt._mult((qe-Ze)/rt)._add(Ie||ze),dt=te+Math.atan2(Be.y-ze.y,Be.x-ze.x);return tt.push(Ke),{point:Ke,angle:F?dt:0,path:tt}}const Di=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function wi(w,t){for(let o=0;o<w;o++){const d=t.length;t.resize(d+4),t.float32.set(Di,3*d)}}function bs(w,t,o){const d=t[0],x=t[1];return w[0]=o[0]*d+o[4]*x+o[12],w[1]=o[1]*d+o[5]*x+o[13],w[3]=o[3]*d+o[7]*x+o[15],w}const bn=100;class lu{constructor(t,o=new gt(t.width+200,t.height+200,25),d=new gt(t.width+200,t.height+200,25)){this.transform=t,this.grid=o,this.ignoredGrid=d,this.pitchFactor=Math.cos(t.pitch*Math.PI/180)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+bn,this.screenBottomBoundary=t.height+bn,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,o,d,x,S,A,R,F,V,q,te,ee){const ce=this.projectAndGetPerspectiveRatio(t.anchorPointX+F[0],t.anchorPointY+F[1],S,q,ee),_e=d*ce.perspectiveRatio;let Ie;if(A||R)Ie=this._projectCollisionBox(t,_e,x,S,A,R,F,ce,q,te,ee);else{const lt=ce.x+(te?te.x*_e:0),Ke=ce.y+(te?te.y*_e:0);Ie={allPointsOccluded:!1,box:[lt+t.x1*_e,Ke+t.y1*_e,lt+t.x2*_e,Ke+t.y2*_e]}}const[Be,ze,Ze,rt]=Ie.box,qe=A?Ie.allPointsOccluded:ce.isOccluded;let tt=qe;return tt||(tt=ce.perspectiveRatio<this.perspectiveRatioCutoff),tt||(tt=!this.isInsideGrid(Be,ze,Ze,rt)),tt||o!=="always"&&this.grid.hitTest(Be,ze,Ze,rt,o,V)?{box:[Be,ze,Ze,rt],placeable:!1,offscreen:!1,occluded:qe}:{box:[Be,ze,Ze,rt],placeable:!0,offscreen:this.isOffscreen(Be,ze,Ze,rt),occluded:qe}}placeCollisionCircles(t,o,d,x,S,A,R,F,V,q,te,ee,ce,_e){const Ie=[],Be=new s.P(o.anchorX,o.anchorY),ze=this.getPerspectiveRatio(Be.x,Be.y,A,_e),Ze=(V?S*this.transform.getPitchedTextCorrection(o.anchorX,o.anchorY,A)/ze:S*ze)/s.aM,rt={getElevation:_e,pitchedLabelPlaneMatrix:R,lineVertexArray:d,pitchWithMap:V,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:Be,unwrappedTileID:A,width:this.transform.width,height:this.transform.height,translation:ce},qe=fr(Ze,x,o.lineOffsetX*Ze,o.lineOffsetY*Ze,!1,o,!1,rt);let tt=!1,lt=!1,Ke=!0;if(qe){const dt=.5*te*ze+ee,Rt=new s.P(-100,-100),Tt=new s.P(this.screenRightBoundary,this.screenBottomBoundary),kt=new Te,Ct=qe.first,ur=qe.last;let hr=[];for(let fn=Ct.path.length-1;fn>=1;fn--)hr.push(Ct.path[fn]);for(let fn=1;fn<ur.path.length;fn++)hr.push(ur.path[fn]);const tr=2.5*dt;if(V){const fn=this.projectPathToScreenSpace(hr,rt);hr=fn.some((Yn=>Yn.signedDistanceFromCamera<=0))?[]:fn.map((Yn=>Yn.point))}let br=[];if(hr.length>0){const fn=hr[0].clone(),Yn=hr[0].clone();for(let va=1;va<hr.length;va++)fn.x=Math.min(fn.x,hr[va].x),fn.y=Math.min(fn.y,hr[va].y),Yn.x=Math.max(Yn.x,hr[va].x),Yn.y=Math.max(Yn.y,hr[va].y);br=fn.x>=Rt.x&&Yn.x<=Tt.x&&fn.y>=Rt.y&&Yn.y<=Tt.y?[hr]:Yn.x<Rt.x||fn.x>Tt.x||Yn.y<Rt.y||fn.y>Tt.y?[]:s.aJ([hr],Rt.x,Rt.y,Tt.x,Tt.y)}for(const fn of br){kt.reset(fn,.25*dt);let Yn=0;Yn=kt.length<=.5*dt?1:Math.ceil(kt.paddedLength/tr)+1;for(let va=0;va<Yn;va++){const da=va/Math.max(Yn-1,1),ka=kt.lerp(da),aa=ka.x+bn,Ga=ka.y+bn;Ie.push(aa,Ga,dt,0);const Ca=aa-dt,Ni=Ga-dt,Xa=aa+dt,Ya=Ga+dt;if(Ke=Ke&&this.isOffscreen(Ca,Ni,Xa,Ya),lt=lt||this.isInsideGrid(Ca,Ni,Xa,Ya),t!=="always"&&this.grid.hitTestCircle(aa,Ga,dt,t,q)&&(tt=!0,!F))return{circles:[],offscreen:!1,collisionDetected:tt}}}}return{circles:!F&&tt||!lt||ze<this.perspectiveRatioCutoff?[]:Ie,offscreen:Ke,collisionDetected:tt}}projectPathToScreenSpace(t,o){const d=(function(x,S){const A=s.N();return s.aB(A,S.pitchedLabelPlaneMatrix),x.map((R=>{const F=_t(R.x,R.y,A,S.getElevation),V=S.transform.projectTileCoordinates(F.point.x,F.point.y,S.unwrappedTileID,S.getElevation);return V.point.x=(.5*V.point.x+.5)*S.width,V.point.y=(.5*-V.point.y+.5)*S.height,V}))})(t,o);return(function(x){let S=0,A=0,R=0,F=0;for(let V=0;V<x.length;V++)x[V].isOccluded?(R=V+1,F=0):(F++,F>A&&(A=F,S=R));return x.slice(S,S+A)})(d)}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const o=[],d=new s.aa;for(const te of t){const ee=new s.P(te.x+bn,te.y+bn);d.extend(ee),o.push(ee)}const{minX:x,minY:S,maxX:A,maxY:R}=d,F=this.grid.query(x,S,A,R).concat(this.ignoredGrid.query(x,S,A,R)),V={},q={};for(const te of F){const ee=te.key;if(V[ee.bucketInstanceId]===void 0&&(V[ee.bucketInstanceId]={}),V[ee.bucketInstanceId][ee.featureIndex])continue;const ce=[new s.P(te.x1,te.y1),new s.P(te.x2,te.y1),new s.P(te.x2,te.y2),new s.P(te.x1,te.y2)];s.aK(o,ce)&&(V[ee.bucketInstanceId][ee.featureIndex]=!0,q[ee.bucketInstanceId]===void 0&&(q[ee.bucketInstanceId]=[]),q[ee.bucketInstanceId].push(ee.featureIndex))}return q}insertCollisionBox(t,o,d,x,S,A){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:x,featureIndex:S,collisionGroupID:A,overlapMode:o},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,o,d,x,S,A){const R=d?this.ignoredGrid:this.grid,F={bucketInstanceId:x,featureIndex:S,collisionGroupID:A,overlapMode:o};for(let V=0;V<t.length;V+=4)R.insertCircle(F,t[V],t[V+1],t[V+2])}projectAndGetPerspectiveRatio(t,o,d,x,S){if(S){let A;x?(A=[t,o,x(t,o),1],s.aH(A,A,S)):(A=[t,o,0,1],bs(A,A,S));const R=A[3];return{x:(A[0]/R+1)/2*this.transform.width+bn,y:(-A[1]/R+1)/2*this.transform.height+bn,perspectiveRatio:.5+this.transform.cameraToCenterDistance/R*.5,isOccluded:!1,signedDistanceFromCamera:R}}{const A=this.transform.projectTileCoordinates(t,o,d,x);return{x:(A.point.x+1)/2*this.transform.width+bn,y:(1-A.point.y)/2*this.transform.height+bn,perspectiveRatio:.5+this.transform.cameraToCenterDistance/A.signedDistanceFromCamera*.5,isOccluded:A.isOccluded,signedDistanceFromCamera:A.signedDistanceFromCamera}}}getPerspectiveRatio(t,o,d,x){const S=this.transform.projectTileCoordinates(t,o,d,x);return .5+this.transform.cameraToCenterDistance/S.signedDistanceFromCamera*.5}isOffscreen(t,o,d,x){return d<bn||t>=this.screenRightBoundary||x<bn||o>this.screenBottomBoundary}isInsideGrid(t,o,d,x){return d>=0&&t<this.gridRightBoundary&&x>=0&&o<this.gridBottomBoundary}getViewportMatrix(){const t=s.ar([]);return s.O(t,t,[-100,-100,0]),t}_projectCollisionBox(t,o,d,x,S,A,R,F,V,q,te){let ee=1,ce=0,_e=0,Ie=1;const Be=t.anchorPointX+R[0],ze=t.anchorPointY+R[1];if(A&&!S){const hr=this.projectAndGetPerspectiveRatio(Be+1,ze,x,V,te),tr=hr.x-F.x,br=Math.atan((hr.y-F.y)/tr)+(tr<0?Math.PI:0),fn=Math.sin(br),Yn=Math.cos(br);ee=Yn,ce=fn,_e=-fn,Ie=Yn}else if(!A&&S){const hr=At(this.transform);ee=hr.vecEast[0],ce=hr.vecEast[1],_e=hr.vecSouth[0],Ie=hr.vecSouth[1]}let Ze=F.x,rt=F.y,qe=o;S&&(Ze=Be,rt=ze,qe=Math.pow(2,-(this.transform.zoom-d.overscaledZ)),qe*=this.transform.getPitchedTextCorrection(Be,ze,x),q||(qe*=s.an(.5+F.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),q&&(Ze+=ee*q.x*qe+_e*q.y*qe,rt+=ce*q.x*qe+Ie*q.y*qe);const tt=t.x1*qe,lt=t.x2*qe,Ke=(tt+lt)/2,dt=t.y1*qe,Rt=t.y2*qe,Tt=(dt+Rt)/2,kt=[{offsetX:tt,offsetY:dt},{offsetX:Ke,offsetY:dt},{offsetX:lt,offsetY:dt},{offsetX:lt,offsetY:Tt},{offsetX:lt,offsetY:Rt},{offsetX:Ke,offsetY:Rt},{offsetX:tt,offsetY:Rt},{offsetX:tt,offsetY:Tt}];let Ct=[];for(const{offsetX:hr,offsetY:tr}of kt)Ct.push(new s.P(Ze+ee*hr+_e*tr,rt+ce*hr+Ie*tr));let ur=!1;if(S){const hr=Ct.map((tr=>this.projectAndGetPerspectiveRatio(tr.x,tr.y,x,V,te)));ur=hr.some((tr=>!tr.isOccluded)),Ct=hr.map((tr=>new s.P(tr.x,tr.y)))}else ur=!0;return{box:s.aL(Ct),allPointsOccluded:!ur}}}class kc{constructor(t,o,d,x){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?o:-o))):x&&d?1:0,this.placed=d}isHidden(){return this.opacity===0&&!this.placed}}class Wo{constructor(t,o,d,x,S){this.text=new kc(t?t.text:null,o,d,S),this.icon=new kc(t?t.icon:null,o,x,S)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class cu{constructor(t,o,d){this.text=t,this.icon=o,this.skipFade=d}}class uu{constructor(t,o,d,x,S){this.bucketInstanceId=t,this.featureIndex=o,this.sourceLayerIndex=d,this.bucketIndex=x,this.tileID=S}}class Cc{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const o=++this.maxGroupID;this.collisionGroups[t]={ID:o,predicate:d=>d.collisionGroupID===o}}return this.collisionGroups[t]}}function Na(w,t,o,d,x){const{horizontalAlign:S,verticalAlign:A}=s.aS(w);return new s.P(-(S-.5)*t+d[0]*x,-(A-.5)*o+d[1]*x)}class Mc{constructor(t,o,d,x,S){this.transform=t.clone(),this.terrain=o,this.collisionIndex=new lu(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new Cc(x),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=S,S&&(S.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(t){const o=this.terrain;return o?(d,x)=>o.getElevation(t,d,x):null}getBucketParts(t,o,d,x){const S=d.getBucket(o),A=d.latestFeatureIndex;if(!S||!A||o.id!==S.layerIds[0])return;const R=d.collisionBoxArray,F=S.layers[0].layout,V=S.layers[0].paint,q=Math.pow(2,this.transform.zoom-d.tileID.overscaledZ),te=d.tileSize/s.a5,ee=d.tileID.toUnwrapped(),ce=F.get("text-rotation-alignment")==="map",_e=s.aN(d,1,this.transform.zoom),Ie=s.aO(this.collisionIndex.transform,d,V.get("text-translate"),V.get("text-translate-anchor")),Be=s.aO(this.collisionIndex.transform,d,V.get("icon-translate"),V.get("icon-translate-anchor")),ze=jt(ce,this.transform,_e);this.retainedQueryData[S.bucketInstanceId]=new uu(S.bucketInstanceId,A,S.sourceLayerIndex,S.index,d.tileID);const Ze={bucket:S,layout:F,translationText:Ie,translationIcon:Be,unwrappedTileID:ee,pitchedLabelPlaneMatrix:ze,scale:q,textPixelRatio:te,holdingForFade:d.holdingForSymbolFade(),collisionBoxArray:R,partiallyEvaluatedTextSize:s.ay(S.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(S.sourceID)};if(x)for(const rt of S.sortKeyRanges){const{sortKey:qe,symbolInstanceStart:tt,symbolInstanceEnd:lt}=rt;t.push({sortKey:qe,symbolInstanceStart:tt,symbolInstanceEnd:lt,parameters:Ze})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:S.symbolInstances.length,parameters:Ze})}attemptAnchorPlacement(t,o,d,x,S,A,R,F,V,q,te,ee,ce,_e,Ie,Be,ze,Ze,rt,qe){const tt=s.aP[t.textAnchor],lt=[t.textOffset0,t.textOffset1],Ke=Na(tt,d,x,lt,S),dt=this.collisionIndex.placeCollisionBox(o,ee,F,V,q,R,A,Be,te.predicate,rt,Ke,qe);if((!Ze||this.collisionIndex.placeCollisionBox(Ze,ee,F,V,q,R,A,ze,te.predicate,rt,Ke,qe).placeable)&&dt.placeable){let Rt;if(this.prevPlacement&&this.prevPlacement.variableOffsets[ce.crossTileID]&&this.prevPlacement.placements[ce.crossTileID]&&this.prevPlacement.placements[ce.crossTileID].text&&(Rt=this.prevPlacement.variableOffsets[ce.crossTileID].anchor),ce.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[ce.crossTileID]={textOffset:lt,width:d,height:x,anchor:tt,textBoxScale:S,prevAnchor:Rt},this.markUsedJustification(_e,tt,ce,Ie),_e.allowVerticalPlacement&&(this.markUsedOrientation(_e,Ie,ce),this.placedOrientations[ce.crossTileID]=Ie),{shift:Ke,placedGlyphBoxes:dt}}}placeLayerBucketPart(t,o,d){const{bucket:x,layout:S,translationText:A,translationIcon:R,unwrappedTileID:F,pitchedLabelPlaneMatrix:V,textPixelRatio:q,holdingForFade:te,collisionBoxArray:ee,partiallyEvaluatedTextSize:ce,collisionGroup:_e}=t.parameters,Ie=S.get("text-optional"),Be=S.get("icon-optional"),ze=s.aQ(S,"text-overlap","text-allow-overlap"),Ze=ze==="always",rt=s.aQ(S,"icon-overlap","icon-allow-overlap"),qe=rt==="always",tt=S.get("text-rotation-alignment")==="map",lt=S.get("text-pitch-alignment")==="map",Ke=S.get("icon-text-fit")!=="none",dt=S.get("symbol-z-order")==="viewport-y",Rt=Ze&&(qe||!x.hasIconData()||Be),Tt=qe&&(Ze||!x.hasTextData()||Ie);!x.collisionArrays&&ee&&x.deserializeCollisionBoxes(ee);const kt=this.retainedQueryData[x.bucketInstanceId].tileID,Ct=this._getTerrainElevationFunc(kt),ur=this.transform.getFastPathSimpleProjectionMatrix(kt),hr=(tr,br,fn)=>{var Yn,va;if(o[tr.crossTileID])return;if(te)return void(this.placements[tr.crossTileID]=new cu(!1,!1,!1));let da=!1,ka=!1,aa=!0,Ga=null,Ca={box:null,placeable:!1,offscreen:null,occluded:!1},Ni={placeable:!1},Xa=null,Ya=null,ji=null,jl=0,Ul=0,fl=0;br.textFeatureIndex?jl=br.textFeatureIndex:tr.useRuntimeCollisionCircles&&(jl=tr.featureIndex),br.verticalTextFeatureIndex&&(Ul=br.verticalTextFeatureIndex);const Vs=br.textBox;if(Vs){const Gs=ea=>{let pa=s.az.horizontal;if(x.allowVerticalPlacement&&!ea&&this.prevPlacement){const ci=this.prevPlacement.placedOrientations[tr.crossTileID];ci&&(this.placedOrientations[tr.crossTileID]=ci,pa=ci,this.markUsedOrientation(x,pa,tr))}return pa},io=(ea,pa)=>{if(x.allowVerticalPlacement&&tr.numVerticalGlyphVertices>0&&br.verticalTextBox){for(const ci of x.writingModes)if(ci===s.az.vertical?(Ca=pa(),Ni=Ca):Ca=ea(),Ca&&Ca.placeable)break}else Ca=ea()},Do=tr.textAnchorOffsetStartIndex,Ro=tr.textAnchorOffsetEndIndex;if(Ro===Do){const ea=(pa,ci)=>{const _i=this.collisionIndex.placeCollisionBox(pa,ze,q,kt,F,lt,tt,A,_e.predicate,Ct,void 0,ur);return _i&&_i.placeable&&(this.markUsedOrientation(x,ci,tr),this.placedOrientations[tr.crossTileID]=ci),_i};io((()=>ea(Vs,s.az.horizontal)),(()=>{const pa=br.verticalTextBox;return x.allowVerticalPlacement&&tr.numVerticalGlyphVertices>0&&pa?ea(pa,s.az.vertical):{box:null,offscreen:null}})),Gs(Ca&&Ca.placeable)}else{let ea=s.aP[(va=(Yn=this.prevPlacement)===null||Yn===void 0?void 0:Yn.variableOffsets[tr.crossTileID])===null||va===void 0?void 0:va.anchor];const pa=(_i,Vf,Gf)=>{const Zc=_i.x2-_i.x1,Lp=_i.y2-_i.y1,Wc=tr.textBoxScale,Hf=Ke&&rt==="never"?Vf:null;let pc=null,mc=ze==="never"?1:2,pl="never";ea&&mc++;for(let qf=0;qf<mc;qf++){for(let of=Do;of<Ro;of++){const lf=x.textAnchorOffsets.get(of);if(ea&&lf.textAnchor!==ea)continue;const cf=this.attemptAnchorPlacement(lf,_i,Zc,Lp,Wc,tt,lt,q,kt,F,_e,pl,tr,x,Gf,A,R,Hf,Ct);if(cf&&(pc=cf.placedGlyphBoxes,pc&&pc.placeable))return da=!0,Ga=cf.shift,pc}ea?ea=null:pl=ze}return d&&!pc&&(pc={box:this.collisionIndex.placeCollisionBox(Vs,"always",q,kt,F,lt,tt,A,_e.predicate,Ct,void 0,ur).box,offscreen:!1,placeable:!1,occluded:!1}),pc};io((()=>pa(Vs,br.iconBox,s.az.horizontal)),(()=>{const _i=br.verticalTextBox;return x.allowVerticalPlacement&&(!Ca||!Ca.placeable)&&tr.numVerticalGlyphVertices>0&&_i?pa(_i,br.verticalIconBox,s.az.vertical):{box:null,occluded:!0,offscreen:null}})),Ca&&(da=Ca.placeable,aa=Ca.offscreen);const ci=Gs(Ca&&Ca.placeable);if(!da&&this.prevPlacement){const _i=this.prevPlacement.variableOffsets[tr.crossTileID];_i&&(this.variableOffsets[tr.crossTileID]=_i,this.markUsedJustification(x,_i.anchor,tr,ci))}}}if(Xa=Ca,da=Xa&&Xa.placeable,aa=Xa&&Xa.offscreen,tr.useRuntimeCollisionCircles&&tr.centerJustifiedTextSymbolIndex>=0){const Gs=x.text.placedSymbolArray.get(tr.centerJustifiedTextSymbolIndex),io=s.aA(x.textSizeData,ce,Gs),Do=S.get("text-padding");Ya=this.collisionIndex.placeCollisionCircles(ze,Gs,x.lineVertexArray,x.glyphOffsetArray,io,F,V,d,lt,_e.predicate,tr.collisionCircleDiameter,Do,A,Ct),Ya.circles.length&&Ya.collisionDetected&&!d&&s.w("Collisions detected, but collision boxes are not shown"),da=Ze||Ya.circles.length>0&&!Ya.collisionDetected,aa=aa&&Ya.offscreen}if(br.iconFeatureIndex&&(fl=br.iconFeatureIndex),br.iconBox){const Gs=io=>this.collisionIndex.placeCollisionBox(io,rt,q,kt,F,lt,tt,R,_e.predicate,Ct,Ke&&Ga?Ga:void 0,ur);Ni&&Ni.placeable&&br.verticalIconBox?(ji=Gs(br.verticalIconBox),ka=ji.placeable):(ji=Gs(br.iconBox),ka=ji.placeable),aa=aa&&ji.offscreen}const Iu=Ie||tr.numHorizontalGlyphVertices===0&&tr.numVerticalGlyphVertices===0,vh=Be||tr.numIconVertices===0;Iu||vh?vh?Iu||(ka=ka&&da):da=ka&&da:ka=da=ka&&da;const dl=ka&&ji.placeable;if(da&&Xa.placeable&&this.collisionIndex.insertCollisionBox(Xa.box,ze,S.get("text-ignore-placement"),x.bucketInstanceId,Ni&&Ni.placeable&&Ul?Ul:jl,_e.ID),dl&&this.collisionIndex.insertCollisionBox(ji.box,rt,S.get("icon-ignore-placement"),x.bucketInstanceId,fl,_e.ID),Ya&&da&&this.collisionIndex.insertCollisionCircles(Ya.circles,ze,S.get("text-ignore-placement"),x.bucketInstanceId,jl,_e.ID),d&&this.storeCollisionData(x.bucketInstanceId,fn,br,Xa,ji,Ya),tr.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(x.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[tr.crossTileID]=new cu((da||Rt)&&!Xa?.occluded,(ka||Tt)&&!ji?.occluded,aa||x.justReloaded),o[tr.crossTileID]=!0};if(dt){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const tr=x.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let br=tr.length-1;br>=0;--br){const fn=tr[br];hr(x.symbolInstances.get(fn),x.collisionArrays[fn],fn)}}else for(let tr=t.symbolInstanceStart;tr<t.symbolInstanceEnd;tr++)hr(x.symbolInstances.get(tr),x.collisionArrays[tr],tr);x.justReloaded=!1}storeCollisionData(t,o,d,x,S,A){if(d.textBox||d.iconBox){let R,F;this.collisionBoxArrays.has(t)?R=this.collisionBoxArrays.get(t):(R=new Map,this.collisionBoxArrays.set(t,R)),R.has(o)?F=R.get(o):(F={text:null,icon:null},R.set(o,F)),d.textBox&&(F.text=x.box),d.iconBox&&(F.icon=S.box)}if(A){let R=this.collisionCircleArrays[t];R===void 0&&(R=this.collisionCircleArrays[t]=[]);for(let F=0;F<A.circles.length;F+=4)R.push(A.circles[F+0]-bn),R.push(A.circles[F+1]-bn),R.push(A.circles[F+2]),R.push(A.collisionDetected?1:0)}}markUsedJustification(t,o,d,x){let S;S=x===s.az.vertical?d.verticalPlacedTextSymbolIndex:{left:d.leftJustifiedTextSymbolIndex,center:d.centerJustifiedTextSymbolIndex,right:d.rightJustifiedTextSymbolIndex}[s.aR(o)];const A=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex,d.verticalPlacedTextSymbolIndex];for(const R of A)R>=0&&(t.text.placedSymbolArray.get(R).crossTileID=S>=0&&R!==S?0:d.crossTileID)}markUsedOrientation(t,o,d){const x=o===s.az.horizontal||o===s.az.horizontalOnly?o:0,S=o===s.az.vertical?o:0,A=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex];for(const R of A)t.text.placedSymbolArray.get(R).placedOrientation=x;d.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(d.verticalPlacedTextSymbolIndex).placedOrientation=S)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const o=this.prevPlacement;let d=!1;this.prevZoomAdjustment=o?o.zoomAdjustment(this.transform.zoom):0;const x=o?o.symbolFadeChange(t):1,S=o?o.opacities:{},A=o?o.variableOffsets:{},R=o?o.placedOrientations:{};for(const F in this.placements){const V=this.placements[F],q=S[F];q?(this.opacities[F]=new Wo(q,x,V.text,V.icon),d=d||V.text!==q.text.placed||V.icon!==q.icon.placed):(this.opacities[F]=new Wo(null,x,V.text,V.icon,V.skipFade),d=d||V.text||V.icon)}for(const F in S){const V=S[F];if(!this.opacities[F]){const q=new Wo(V,x,!1,!1);q.isHidden()||(this.opacities[F]=q,d=d||V.text.placed||V.icon.placed)}}for(const F in A)this.variableOffsets[F]||!this.opacities[F]||this.opacities[F].isHidden()||(this.variableOffsets[F]=A[F]);for(const F in R)this.placedOrientations[F]||!this.opacities[F]||this.opacities[F].isHidden()||(this.placedOrientations[F]=R[F]);if(o&&o.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");d?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=o?o.lastPlacementChangeTime:t)}updateLayerOpacities(t,o){const d={};for(const x of o){const S=x.getBucket(t);S&&x.latestFeatureIndex&&t.id===S.layerIds[0]&&this.updateBucketOpacities(S,x.tileID,d,x.collisionBoxArray)}}updateBucketOpacities(t,o,d,x){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const S=t.layers[0],A=S.layout,R=new Wo(null,0,!1,!1,!0),F=A.get("text-allow-overlap"),V=A.get("icon-allow-overlap"),q=S._unevaluatedLayout.hasValue("text-variable-anchor")||S._unevaluatedLayout.hasValue("text-variable-anchor-offset"),te=A.get("text-rotation-alignment")==="map",ee=A.get("text-pitch-alignment")==="map",ce=A.get("icon-text-fit")!=="none",_e=new Wo(null,0,F&&(V||!t.hasIconData()||A.get("icon-optional")),V&&(F||!t.hasTextData()||A.get("text-optional")),!0);!t.collisionArrays&&x&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(x);const Ie=(ze,Ze,rt)=>{for(let qe=0;qe<Ze/4;qe++)ze.opacityVertexArray.emplaceBack(rt);ze.hasVisibleVertices=ze.hasVisibleVertices||rt!==Yo},Be=this.collisionBoxArrays.get(t.bucketInstanceId);for(let ze=0;ze<t.symbolInstances.length;ze++){const Ze=t.symbolInstances.get(ze),{numHorizontalGlyphVertices:rt,numVerticalGlyphVertices:qe,crossTileID:tt}=Ze;let lt=this.opacities[tt];d[tt]?lt=R:lt||(lt=_e,this.opacities[tt]=lt),d[tt]=!0;const Ke=Ze.numIconVertices>0,dt=this.placedOrientations[Ze.crossTileID],Rt=dt===s.az.vertical,Tt=dt===s.az.horizontal||dt===s.az.horizontalOnly;if(rt>0||qe>0){const Ct=fu(lt.text);Ie(t.text,rt,Rt?Yo:Ct),Ie(t.text,qe,Tt?Yo:Ct);const ur=lt.text.isHidden();[Ze.rightJustifiedTextSymbolIndex,Ze.centerJustifiedTextSymbolIndex,Ze.leftJustifiedTextSymbolIndex].forEach((br=>{br>=0&&(t.text.placedSymbolArray.get(br).hidden=ur||Rt?1:0)})),Ze.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(Ze.verticalPlacedTextSymbolIndex).hidden=ur||Tt?1:0);const hr=this.variableOffsets[Ze.crossTileID];hr&&this.markUsedJustification(t,hr.anchor,Ze,dt);const tr=this.placedOrientations[Ze.crossTileID];tr&&(this.markUsedJustification(t,"left",Ze,tr),this.markUsedOrientation(t,tr,Ze))}if(Ke){const Ct=fu(lt.icon),ur=!(ce&&Ze.verticalPlacedIconSymbolIndex&&Rt);Ze.placedIconSymbolIndex>=0&&(Ie(t.icon,Ze.numIconVertices,ur?Ct:Yo),t.icon.placedSymbolArray.get(Ze.placedIconSymbolIndex).hidden=lt.icon.isHidden()),Ze.verticalPlacedIconSymbolIndex>=0&&(Ie(t.icon,Ze.numVerticalIconVertices,ur?Yo:Ct),t.icon.placedSymbolArray.get(Ze.verticalPlacedIconSymbolIndex).hidden=lt.icon.isHidden())}const kt=Be&&Be.has(ze)?Be.get(ze):{text:null,icon:null};if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const Ct=t.collisionArrays[ze];if(Ct){let ur=new s.P(0,0);if(Ct.textBox||Ct.verticalTextBox){let hr=!0;if(q){const tr=this.variableOffsets[tt];tr?(ur=Na(tr.anchor,tr.width,tr.height,tr.textOffset,tr.textBoxScale),te&&ur._rotate(ee?-this.transform.bearingInRadians:this.transform.bearingInRadians)):hr=!1}if(Ct.textBox||Ct.verticalTextBox){let tr;Ct.textBox&&(tr=Rt),Ct.verticalTextBox&&(tr=Tt),Wl(t.textCollisionBox.collisionVertexArray,lt.text.placed,!hr||tr,kt.text,ur.x,ur.y)}}if(Ct.iconBox||Ct.verticalIconBox){const hr=!!(!Tt&&Ct.verticalIconBox);let tr;Ct.iconBox&&(tr=hr),Ct.verticalIconBox&&(tr=!hr),Wl(t.iconCollisionBox.collisionVertexArray,lt.icon.placed,tr,kt.icon,ce?ur.x:0,ce?ur.y:0)}}}}if(t.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);t.bucketInstanceId in this.collisionCircleArrays&&(t.collisionCircleArray=this.collisionCircleArrays[t.bucketInstanceId],delete this.collisionCircleArrays[t.bucketInstanceId])}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,o){const d=this.zoomAtLastRecencyCheck===o?1-this.zoomAdjustment(o):1;return this.zoomAtLastRecencyCheck=o,this.commitTime+this.fadeDuration*d>t}setStale(){this.stale=!0}}function Wl(w,t,o,d,x,S){d&&d.length!==0||(d=[0,0,0,0]);const A=d[0]-bn,R=d[1]-bn,F=d[2]-bn,V=d[3]-bn;w.emplaceBack(t?1:0,o?1:0,x||0,S||0,A,R),w.emplaceBack(t?1:0,o?1:0,x||0,S||0,F,R),w.emplaceBack(t?1:0,o?1:0,x||0,S||0,F,V),w.emplaceBack(t?1:0,o?1:0,x||0,S||0,A,V)}const hu=Math.pow(2,25),mo=Math.pow(2,24),Df=Math.pow(2,17),$o=Math.pow(2,16),go=Math.pow(2,9),Rf=Math.pow(2,8),Xo=Math.pow(2,1);function fu(w){if(w.opacity===0&&!w.placed)return 0;if(w.opacity===1&&w.placed)return 4294967295;const t=w.placed?1:0,o=Math.floor(127*w.opacity);return o*hu+t*mo+o*Df+t*$o+o*go+t*Rf+o*Xo+t}const Yo=0;class Al{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,o,d,x,S){const A=this._bucketParts;for(;this._currentTileIndex<t.length;)if(o.getBucketParts(A,x,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,S())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,A.sort(((R,F)=>R.sortKey-F.sortKey)));this._currentPartIndex<A.length;)if(o.placeLayerBucketPart(A[this._currentPartIndex],this._seenCrossTileIDs,d),this._currentPartIndex++,S())return!0;return!1}}class Ko{constructor(t,o,d,x,S,A,R,F){this.placement=new Mc(t,o,A,R,F),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=x,this._showCollisionBoxes=S,this._done=!1}isDone(){return this._done}continuePlacement(t,o,d){const x=O(),S=()=>!this._forceFullPlacement&&O()-x>2;for(;this._currentPlacementIndex>=0;){const A=o[t[this._currentPlacementIndex]],R=this.placement.collisionIndex.transform.zoom;if(A.type==="symbol"&&(!A.minzoom||A.minzoom<=R)&&(!A.maxzoom||A.maxzoom>R)){if(this._inProgressLayer||(this._inProgressLayer=new Al(A)),this._inProgressLayer.continuePlacement(d[A.source],this.placement,this._showCollisionBoxes,A,S))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const ln=512/s.a5/2;class _o{constructor(t,o,d){this.tileID=t,this.bucketInstanceId=d,this._symbolsByKey={};const x=new Map;for(let S=0;S<o.length;S++){const A=o.get(S),R=A.key,F=x.get(R);F?F.push(A):x.set(R,[A])}for(const[S,A]of x){const R={positions:A.map((F=>({x:Math.floor(F.anchorX*ln),y:Math.floor(F.anchorY*ln)}))),crossTileIDs:A.map((F=>F.crossTileID))};if(R.positions.length>128){const F=new s.aT(R.positions.length,16,Uint16Array);for(const{x:V,y:q}of R.positions)F.add(V,q);F.finish(),delete R.positions,R.index=F}this._symbolsByKey[S]=R}}getScaledCoordinates(t,o){const{x:d,y:x,z:S}=this.tileID.canonical,{x:A,y:R,z:F}=o.canonical,V=ln/Math.pow(2,F-S),q=(R*s.a5+t.anchorY)*V,te=x*s.a5*ln;return{x:Math.floor((A*s.a5+t.anchorX)*V-d*s.a5*ln),y:Math.floor(q-te)}}findMatches(t,o,d){const x=this.tileID.canonical.z<o.canonical.z?1:Math.pow(2,this.tileID.canonical.z-o.canonical.z);for(let S=0;S<t.length;S++){const A=t.get(S);if(A.crossTileID)continue;const R=this._symbolsByKey[A.key];if(!R)continue;const F=this.getScaledCoordinates(A,o);if(R.index){const V=R.index.range(F.x-x,F.y-x,F.x+x,F.y+x).sort();for(const q of V){const te=R.crossTileIDs[q];if(!d[te]){d[te]=!0,A.crossTileID=te;break}}}else if(R.positions)for(let V=0;V<R.positions.length;V++){const q=R.positions[V],te=R.crossTileIDs[V];if(Math.abs(q.x-F.x)<=x&&Math.abs(q.y-F.y)<=x&&!d[te]){d[te]=!0,A.crossTileID=te;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:t})=>t))}}class nh{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Dc{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const o=Math.round((t-this.lng)/360);if(o!==0)for(const d in this.indexes){const x=this.indexes[d],S={};for(const A in x){const R=x[A];R.tileID=R.tileID.unwrapTo(R.tileID.wrap+o),S[R.tileID.key]=R}this.indexes[d]=S}this.lng=t}addBucket(t,o,d){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===o.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let S=0;S<o.symbolInstances.length;S++)o.symbolInstances.get(S).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const x=this.usedCrossTileIDs[t.overscaledZ];for(const S in this.indexes){const A=this.indexes[S];if(Number(S)>t.overscaledZ)for(const R in A){const F=A[R];F.tileID.isChildOf(t)&&F.findMatches(o.symbolInstances,t,x)}else{const R=A[t.scaledTo(Number(S)).key];R&&R.findMatches(o.symbolInstances,t,x)}}for(let S=0;S<o.symbolInstances.length;S++){const A=o.symbolInstances.get(S);A.crossTileID||(A.crossTileID=d.generate(),x[A.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new _o(t,o.symbolInstances,o.bucketInstanceId),!0}removeBucketCrossTileIDs(t,o){for(const d of o.getCrossTileIDsLists())for(const x of d)delete this.usedCrossTileIDs[t][x]}removeStaleBuckets(t){let o=!1;for(const d in this.indexes){const x=this.indexes[d];for(const S in x)t[x[S].bucketInstanceId]||(this.removeBucketCrossTileIDs(d,x[S]),delete x[S],o=!0)}return o}}class Ma{constructor(){this.layerIndexes={},this.crossTileIDs=new nh,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,o,d){let x=this.layerIndexes[t.id];x===void 0&&(x=this.layerIndexes[t.id]=new Dc);let S=!1;const A={};x.handleWrapJump(d);for(const R of o){const F=R.getBucket(t);F&&t.id===F.layerIds[0]&&(F.bucketInstanceId||(F.bucketInstanceId=++this.maxBucketInstanceId),x.addBucket(R.tileID,F,this.crossTileIDs)&&(S=!0),A[F.bucketInstanceId]=!0)}return x.removeStaleBuckets(A)&&(S=!0),S}pruneUnusedLayers(t){const o={};t.forEach((d=>{o[d]=!0}));for(const d in this.layerIndexes)o[d]||delete this.layerIndexes[d]}}var qa="void main() {fragColor=vec4(1.0);}";const Hn={prelude:en(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:en("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:en("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:en(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:en(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:en(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:en(qa,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:en(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:en(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:en("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:en("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:en(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:en("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:en(qa,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:en(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:en(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:en(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:en(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:en(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:en(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:en(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:en(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:en(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:en(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:en(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:en(`uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0/u_device_pixel_ratio)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),lineGradientSDF:en(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform sampler2D u_image_dash;uniform float u_mix;uniform lowp float u_lineatlas_width;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);float sdfdist_a=texture(u_image_dash,v_tex_a).a;float sdfdist_b=texture(u_image_dash,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);float dash_alpha=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*dash_alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;out vec2 v_tex_a;out vec2 v_tex_b;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;float texel_height=1.0/u_image_height;float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),raster:en(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:en(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:en(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:en(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:en("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:en("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:en("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:en("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:en(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:en("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function en(w,t){const o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,d=t.match(/in ([\w]+) ([\w]+)/g),x=w.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),A=S?S.concat(x):x,R={};return{fragmentSource:w=w.replace(o,((F,V,q,te,ee)=>(R[ee]=!0,V==="define"?`
#ifndef HAS_UNIFORM_u_${ee}
in ${q} ${te} ${ee};
#else
uniform ${q} ${te} u_${ee};
#endif
`:`
#ifdef HAS_UNIFORM_u_${ee}
    ${q} ${te} ${ee} = u_${ee};
#endif
`))),vertexSource:t=t.replace(o,((F,V,q,te,ee)=>{const ce=te==="float"?"vec2":"vec4",_e=ee.match(/color/)?"color":ce;return R[ee]?V==="define"?`
#ifndef HAS_UNIFORM_u_${ee}
uniform lowp float u_${ee}_t;
in ${q} ${ce} a_${ee};
out ${q} ${te} ${ee};
#else
uniform ${q} ${te} u_${ee};
#endif
`:_e==="vec4"?`
#ifndef HAS_UNIFORM_u_${ee}
    ${ee} = a_${ee};
#else
    ${q} ${te} ${ee} = u_${ee};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ee}
    ${ee} = unpack_mix_${_e}(a_${ee}, u_${ee}_t);
#else
    ${q} ${te} ${ee} = u_${ee};
#endif
`:V==="define"?`
#ifndef HAS_UNIFORM_u_${ee}
uniform lowp float u_${ee}_t;
in ${q} ${ce} a_${ee};
#else
uniform ${q} ${te} u_${ee};
#endif
`:_e==="vec4"?`
#ifndef HAS_UNIFORM_u_${ee}
    ${q} ${te} ${ee} = a_${ee};
#else
    ${q} ${te} ${ee} = u_${ee};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ee}
    ${q} ${te} ${ee} = unpack_mix_${_e}(a_${ee}, u_${ee}_t);
#else
    ${q} ${te} ${ee} = u_${ee};
#endif
`})),staticAttributes:d,staticUniforms:A}}class Jn{constructor(t,o,d){this.vertexBuffer=t,this.indexBuffer=o,this.segments=d}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var os=s.aU([{name:"a_pos",type:"Int16",components:2}]);const Da="#define PROJECTION_MERCATOR",Ri="mercator";class $n{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Ri}get shaderDefine(){return Da}get shaderPreludeCode(){return Hn.projectionMercator}get vertexShaderPreludeCode(){return Hn.projectionMercator.vertexSource}get subdivisionGranularity(){return s.aV.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(t){}getMeshFromTileID(t,o,d,x,S){if(this._cachedMesh)return this._cachedMesh;const A=new s.aW;A.emplaceBack(0,0),A.emplaceBack(s.a5,0),A.emplaceBack(0,s.a5),A.emplaceBack(s.a5,s.a5);const R=t.createVertexBuffer(A,os.members),F=s.aX.simpleSegment(0,0,4,2),V=new s.aY;V.emplaceBack(1,0,2),V.emplaceBack(1,2,3);const q=t.createIndexBuffer(V);return this._cachedMesh=new Jn(R,q,F),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(t){}}class ei{constructor(t=0,o=0,d=0,x=0){if(isNaN(t)||t<0||isNaN(o)||o<0||isNaN(d)||d<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=o,this.left=d,this.right=x}interpolate(t,o,d){return o.top!=null&&t.top!=null&&(this.top=s.G.number(t.top,o.top,d)),o.bottom!=null&&t.bottom!=null&&(this.bottom=s.G.number(t.bottom,o.bottom,d)),o.left!=null&&t.left!=null&&(this.left=s.G.number(t.left,o.left,d)),o.right!=null&&t.right!=null&&(this.right=s.G.number(t.right,o.right,d)),this}getCenter(t,o){const d=s.an((this.left+t-this.right)/2,0,t),x=s.an((this.top+o-this.bottom)/2,0,o);return new s.P(d,x)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new ei(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function mi(w,t){if(!w.renderWorldCopies||w.lngRange)return;const o=t.lng-w.center.lng;t.lng+=o>180?-360:o<-180?360:0}function kn(w){return Math.max(0,Math.floor(w))}class kl{constructor(t,o){var d;this.applyConstrain=(x,S)=>this._constrainOverride!==null?this._constrainOverride(x,S):this._callbacks.defaultConstrain(x,S),this._callbacks=t,this._tileSize=512,this._renderWorldCopies=o?.renderWorldCopies===void 0||!!o?.renderWorldCopies,this._minZoom=o?.minZoom||0,this._maxZoom=o?.maxZoom||22,this._minPitch=o?.minPitch==null?0:o?.minPitch,this._maxPitch=o?.maxPitch==null?60:o?.maxPitch,this._constrainOverride=(d=o?.constrainOverride)!==null&&d!==void 0?d:null,this.setMaxBounds(),this._width=0,this._height=0,this._center=new s.V(0,0),this._elevation=0,this._zoom=0,this._tileZoom=kn(this._zoom),this._scale=s.aq(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new ei,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(t,o,d){this._constrainOverride=t.constrainOverride,this._latRange=t.latRange,this._lngRange=t.lngRange,this._width=t.width,this._height=t.height,this._center=t.center,this._elevation=t.elevation,this._minElevationForCurrentTile=t.minElevationForCurrentTile,this._zoom=t.zoom,this._tileZoom=kn(this._zoom),this._scale=s.aq(this._zoom),this._bearingInRadians=t.bearingInRadians,this._fovInRadians=t.fovInRadians,this._pitchInRadians=t.pitchInRadians,this._rollInRadians=t.rollInRadians,this._unmodified=t.unmodified,this._edgeInsets=new ei(t.padding.top,t.padding.bottom,t.padding.left,t.padding.right),this._minZoom=t.minZoom,this._maxZoom=t.maxZoom,this._minPitch=t.minPitch,this._maxPitch=t.maxPitch,this._renderWorldCopies=t.renderWorldCopies,this._cameraToCenterDistance=t.cameraToCenterDistance,this._nearZ=t.nearZ,this._farZ=t.farZ,this._autoCalculateNearFarZ=!d&&t.autoCalculateNearFarZ,o&&this.constrainInternal(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(t){this._minElevationForCurrentTile=t}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(t){this._minZoom!==t&&(this._minZoom=t,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(t){this._minPitch!==t&&(this._minPitch=t,this.setPitch(Math.max(this.pitch,t)))}get maxPitch(){return this._maxPitch}setMaxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.setPitch(Math.min(this.pitch,t)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get constrainOverride(){return this._constrainOverride}setConstrainOverride(t){t===void 0&&(t=null),this._constrainOverride!==t&&(this._constrainOverride=t,this.constrainInternal(),this._calcMatrices())}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(t){const o=s.W(t,-180,180)*Math.PI/180;var d,x,S,A,R,F,V,q,te;this._bearingInRadians!==o&&(this._unmodified=!1,this._bearingInRadians=o,this._calcMatrices(),this._rotationMatrix=M(),d=this._rotationMatrix,S=-this._bearingInRadians,A=(x=this._rotationMatrix)[0],R=x[1],F=x[2],V=x[3],q=Math.sin(S),te=Math.cos(S),d[0]=A*te+F*q,d[1]=R*te+V*q,d[2]=A*-q+F*te,d[3]=R*-q+V*te)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(t){const o=s.an(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==o&&(this._unmodified=!1,this._pitchInRadians=o,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(t){const o=t/180*Math.PI;this._rollInRadians!==o&&(this._unmodified=!1,this._rollInRadians=o,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return s.aZ(this._fovInRadians)}setFov(t){t=s.an(t,.1,150),this.fov!==t&&(this._unmodified=!1,this._fovInRadians=s.ap(t),this._calcMatrices())}get zoom(){return this._zoom}setZoom(t){const o=this.applyConstrain(this._center,t).zoom;this._zoom!==o&&(this._unmodified=!1,this._zoom=o,this._tileZoom=Math.max(0,Math.floor(o)),this._scale=s.aq(o),this.constrainInternal(),this._calcMatrices())}get center(){return this._center}setCenter(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this.constrainInternal(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(t){t!==this._elevation&&(this._elevation=t,this.constrainInternal(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(t,o){this._autoCalculateNearFarZ=!1,this._nearZ=t,this._farZ=o,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,o,d){this._unmodified=!1,this._edgeInsets.interpolate(t,o,d),this.constrainInternal(),this._calcMatrices()}resize(t,o,d=!0){this._width=t,this._height=o,d&&this.constrainInternal(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Ee([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(t){t?(this._lngRange=[t.getWest(),t.getEast()],this._latRange=[t.getSouth(),t.getNorth()],this.constrainInternal()):(this._lngRange=null,this._latRange=[-s.ao,s.ao])}getCameraQueryGeometry(t,o){if(o.length===1)return[o[0],t];{const{minX:d,minY:x,maxX:S,maxY:A}=s.aa.fromPoints(o).extend(t);return[new s.P(d,x),new s.P(S,x),new s.P(S,A),new s.P(d,A),new s.P(d,x)]}}constrainInternal(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const t=this._unmodified,{center:o,zoom:d}=this.applyConstrain(this.center,this.zoom);this.setCenter(o),this.setZoom(d),this._unmodified=t,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let t=s.ar(new Float64Array(16));s.Q(t,t,[this._width/2,-this._height/2,1]),s.O(t,t,[1,-1,0]),this._clipSpaceToPixelsMatrix=t,t=s.ar(new Float64Array(16)),s.Q(t,t,[1,-1,1]),s.O(t,t,[-1,-1,0]),s.Q(t,t,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=t,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(t,o,d,x){const S=d!==void 0?d:this.bearing,A=x=x!==void 0?x:this.pitch,{distanceToCenter:R,clampedElevation:F}=this._distanceToCenterFromAltElevationPitch(o,this.elevation,A),{x:V,y:q}=En(A,S),te=s.a9.fromLngLat(t,o);let ee,ce,_e=s.a_(1,te.y),Ie=0;do{if(Ie+=1,Ie>10)break;ce=R/_e,ee=new s.a9(te.x+V*ce,te.y+q*ce),_e=1/ee.meterInMercatorCoordinateUnits()}while(Math.abs(R-ce*_e)>1e-12);return{center:ee.toLngLat(),elevation:F,zoom:s.at(this.height/2/Math.tan(this.fovInRadians/2)/ce/this.tileSize)}}recalculateZoomAndCenter(t){if(this.elevation-t==0)return;const o=1/this.worldSize,d=s.as(1,this.center.lat)*this.worldSize,x=s.a9.fromLngLat(this.center,this.elevation),S=x.x/o,A=x.y/o,R=x.z/o,F=this.pitch,V=this.bearing,{x:q,y:te,z:ee}=En(F,V),ce=this.cameraToCenterDistance,_e=S+ce*-q,Ie=A+ce*-te,Be=R+ce*ee,{distanceToCenter:ze,clampedElevation:Ze}=this._distanceToCenterFromAltElevationPitch(Be/d,t,F),rt=ze*d,qe=new s.a9((_e+q*rt)*o,(Ie+te*rt)*o,0).toLngLat(),tt=s.as(1,qe.lat),lt=s.at(this.height/2/Math.tan(this.fovInRadians/2)/ze/tt/this.tileSize);this._elevation=Ze,this._center=qe,this.setZoom(lt)}_distanceToCenterFromAltElevationPitch(t,o,d){const x=-Math.cos(s.ap(d)),S=t-o;let A,R=o;return x*S>=0||Math.abs(x)<.1?(A=1e4,R=t+A*x):A=-S/x,{distanceToCenter:A,clampedElevation:R}}getCameraPoint(){const t=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.P(t*Math.sin(this.rollInRadians),t*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const t=s.as(1,this.center.lat)*this.worldSize;return ht(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/t).toLngLat()}getMercatorTileCoordinates(t){if(!t)return[0,0,1,1];const o=t.canonical.z>=0?1<<t.canonical.z:Math.pow(2,t.canonical.z);return[t.canonical.x/o,t.canonical.y/o,1/o/s.a5,1/o/s.a5]}}class Ea{constructor(t,o){this.min=t,this.max=o,this.center=s.a$([],s.b0([],this.min,this.max),.5)}quadrant(t){const o=[t%2==0,t<2],d=s.b1(this.min),x=s.b1(this.max);for(let S=0;S<o.length;S++)d[S]=o[S]?this.min[S]:this.center[S],x[S]=o[S]?this.center[S]:this.max[S];return x[2]=this.max[2],new Ea(d,x)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersectsFrustum(t){let o=!0;for(let d=0;d<t.planes.length;d++){const x=this.intersectsPlane(t.planes[d]);if(x===0)return 0;x===1&&(o=!1)}return o?2:t.aabb.min[0]>this.max[0]||t.aabb.min[1]>this.max[1]||t.aabb.min[2]>this.max[2]||t.aabb.max[0]<this.min[0]||t.aabb.max[1]<this.min[1]||t.aabb.max[2]<this.min[2]?0:1}intersectsPlane(t){let o=t[3],d=t[3];for(let x=0;x<3;x++)t[x]>0?(o+=t[x]*this.min[x],d+=t[x]*this.max[x]):(d+=t[x]*this.min[x],o+=t[x]*this.max[x]);return o>=0?2:d<0?0:1}}class Ii{distanceToTile2d(t,o,d,x){const S=x.distanceX([t,o]),A=x.distanceY([t,o]);return Math.hypot(S,A)}getWrap(t,o,d){return d}getTileBoundingVolume(t,o,d,x){var S,A;let R=0,F=0;if(x?.terrain){const q=new s.a2(t.z,o,t.z,t.x,t.y),te=x.terrain.getMinMaxElevation(q);R=(S=te.minElevation)!==null&&S!==void 0?S:Math.min(0,d),F=(A=te.maxElevation)!==null&&A!==void 0?A:Math.max(0,d)}const V=1<<t.z;return new Ea([o+t.x/V,t.y/V,R],[o+(t.x+1)/V,(t.y+1)/V,F])}allowVariableZoom(t,o){const d=t.fov*(Math.abs(Math.cos(t.rollInRadians))*t.height+Math.abs(Math.sin(t.rollInRadians))*t.width)/t.height,x=s.an(78.5-d/2,0,60);return!!o.terrain||t.pitch>x}allowWorldCopies(){return!0}prepareNextFrame(){}}class ja{constructor(t,o,d){this.points=t,this.planes=o,this.aabb=d}static fromInvProjectionMatrix(t,o=1,d=0,x,S){const A=S?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],R=Math.pow(2,d),F=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((ee=>(function(ce,_e,Ie,Be){const ze=s.aH([],ce,_e),Ze=1/ze[3]/Ie*Be;return s.b6(ze,ze,[Ze,Ze,1/ze[3],Ze])})(ee,t,o,R)));x&&(function(ee,ce,_e,Ie){const Be=Ie?4:0,ze=Ie?0:4;let Ze=0;const rt=[],qe=[];for(let Ke=0;Ke<4;Ke++){const dt=s.b2([],ee[Ke+ze],ee[Ke+Be]),Rt=s.b7(dt);s.a$(dt,dt,1/Rt),rt.push(Rt),qe.push(dt)}for(let Ke=0;Ke<4;Ke++){const dt=s.b8(ee[Ke+Be],qe[Ke],_e);Ze=dt!==null&&dt>=0?Math.max(Ze,dt):Math.max(Ze,rt[Ke])}const tt=(function(Ke,dt){const Rt=s.b2([],Ke[dt[0]],Ke[dt[1]]),Tt=s.b2([],Ke[dt[2]],Ke[dt[1]]),kt=[0,0,0,0];return s.b3(kt,s.b4([],Rt,Tt)),kt[3]=-s.b5(kt,Ke[dt[0]]),kt})(ee,ce),lt=(function(Ke,dt){const Rt=s.b9(Ke),Tt=s.ba([],Ke,1/Rt),kt=s.b2([],dt,s.a$([],Tt,s.b5(dt,Tt))),Ct=s.b9(kt);if(Ct>0){const ur=Math.sqrt(1-Tt[3]*Tt[3]),hr=s.a$([],Tt,-Tt[3]),tr=s.b0([],hr,s.a$([],kt,ur/Ct));return s.bb(dt,tr)}return null})(_e,tt);if(lt!==null){const Ke=lt/s.b5(qe[0],tt);Ze=Math.min(Ze,Ke)}for(let Ke=0;Ke<4;Ke++){const dt=Math.min(Ze,rt[Ke]);ee[Ke+ze]=[ee[Ke+Be][0]+qe[Ke][0]*dt,ee[Ke+Be][1]+qe[Ke][1]*dt,ee[Ke+Be][2]+qe[Ke][2]*dt,1]}})(F,A[0],x,S);const V=A.map((ee=>{const ce=s.b2([],F[ee[0]],F[ee[1]]),_e=s.b2([],F[ee[2]],F[ee[1]]),Ie=s.b3([],s.b4([],ce,_e)),Be=-s.b5(Ie,F[ee[1]]);return Ie.concat(Be)})),q=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],te=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const ee of F)for(let ce=0;ce<3;ce++)q[ce]=Math.min(q[ce],ee[ce]),te[ce]=Math.max(te[ce],ee[ce]);return new ja(F,V,new Ea(q,te))}}class Ra{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,o,d){return this._helper.interpolatePadding(t,o,d)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,o,d=!0){this._helper.resize(t,o,d)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}setConstrainOverride(t){this._helper.setConstrainOverride(t)}overrideNearFarZ(t,o){this._helper.overrideNearFarZ(t,o)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t,o){}constructor(t){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this.defaultConstrain=(o,d)=>{d=s.an(+d,this.minZoom,this.maxZoom);const x={center:new s.V(o.lng,o.lat),zoom:d};let S=this._helper._lngRange;if(!this._helper._renderWorldCopies&&S===null){const qe=179.9999999999;S=[-qe,qe]}const A=this.tileSize*s.aq(x.zoom);let R=0,F=A,V=0,q=A,te=0,ee=0;const{x:ce,y:_e}=this.size;if(this._helper._latRange){const qe=this._helper._latRange;R=s.X(qe[1])*A,F=s.X(qe[0])*A,F-R<_e&&(te=_e/(F-R))}S&&(V=s.W(s.Y(S[0])*A,0,A),q=s.W(s.Y(S[1])*A,0,A),q<V&&(q+=A),q-V<ce&&(ee=ce/(q-V)));const{x:Ie,y:Be}=kr(A,o);let ze,Ze;const rt=Math.max(ee||0,te||0);if(rt){const qe=new s.P(ee?(q+V)/2:Ie,te?(F+R)/2:Be);return x.center=Kr(A,qe).wrap(),x.zoom+=s.at(rt),x}if(this._helper._latRange){const qe=_e/2;Be-qe<R&&(Ze=R+qe),Be+qe>F&&(Ze=F-qe)}if(S){const qe=(V+q)/2;let tt=Ie;this._helper._renderWorldCopies&&(tt=s.W(Ie,qe-A/2,qe+A/2));const lt=ce/2;tt-lt<V&&(ze=V+lt),tt+lt>q&&(ze=q-lt)}if(ze!==void 0||Ze!==void 0){const qe=new s.P(ze??Ie,Ze??Be);x.center=Kr(A,qe).wrap()}return x},this.applyConstrain=(o,d)=>this._helper.applyConstrain(o,d),this._helper=new kl({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(o,d)=>this.defaultConstrain(o,d)},t),this._coveringTilesDetailsProvider=new Ii}clone(){const t=new Ra;return t.apply(this),t}apply(t,o,d){this._helper.apply(t,o,d)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(t){const o=[new s.bc(0,t)];if(this._helper._renderWorldCopies){const d=this.screenPointToMercatorCoordinate(new s.P(0,0)),x=this.screenPointToMercatorCoordinate(new s.P(this._helper._width,0)),S=this.screenPointToMercatorCoordinate(new s.P(this._helper._width,this._helper._height)),A=this.screenPointToMercatorCoordinate(new s.P(0,this._helper._height)),R=Math.floor(Math.min(d.x,x.x,S.x,A.x)),F=Math.floor(Math.max(d.x,x.x,S.x,A.x)),V=1;for(let q=R-V;q<=F+V;q++)q!==0&&o.push(new s.bc(q,t))}return o}getCameraFrustum(){return ja.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){const o=this.screenPointToLocation(this.centerPoint,t),d=t?t.getElevationForLngLatZoom(o,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(d)}setLocationAtPoint(t,o){const d=s.as(this.elevation,this.center.lat),x=this.screenPointToMercatorCoordinateAtZ(o,d),S=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,d),A=s.a9.fromLngLat(t),R=new s.a9(A.x-(x.x-S.x),A.y-(x.y-S.y));this.setCenter(R?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(t,o){return o?this.coordinatePoint(s.a9.fromLngLat(t),o.getElevationForLngLat(t,this),this._pixelMatrix3D):this.coordinatePoint(s.a9.fromLngLat(t))}screenPointToLocation(t,o){var d;return(d=this.screenPointToMercatorCoordinate(t,o))===null||d===void 0?void 0:d.toLngLat()}screenPointToMercatorCoordinate(t,o){if(o){const d=o.pointCoordinate(t);if(d!=null)return d}return this.screenPointToMercatorCoordinateAtZ(t)}screenPointToMercatorCoordinateAtZ(t,o){const d=o||0,x=[t.x,t.y,0,1],S=[t.x,t.y,1,1];s.aH(x,x,this._pixelMatrixInverse),s.aH(S,S,this._pixelMatrixInverse);const A=x[3],R=S[3],F=x[1]/A,V=S[1]/R,q=x[2]/A,te=S[2]/R,ee=q===te?0:(d-q)/(te-q);return new s.a9(s.G.number(x[0]/A,S[0]/R,ee)/this.worldSize,s.G.number(F,V,ee)/this.worldSize,d)}coordinatePoint(t,o=0,d=this._pixelMatrix){const x=[t.x*this.worldSize,t.y*this.worldSize,o,1];return s.aH(x,x,d),new s.P(x[0]/x[3],x[1]/x[3])}getBounds(){const t=Math.max(0,this._helper._height/2-yn(this));return new Ee().extend(this.screenPointToLocation(new s.P(0,t))).extend(this.screenPointToLocation(new s.P(this._helper._width,t))).extend(this.screenPointToLocation(new s.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new s.P(0,this._helper._height)))}isPointOnMapSurface(t,o){return o?o.pointCoordinate(t)!=null:t.y>this.height/2-yn(this)}calculatePosMatrix(t,o=!1,d){var x;const S=(x=t.key)!==null&&x!==void 0?x:s.bd(t.wrap,t.canonical.z,t.canonical.z,t.canonical.x,t.canonical.y),A=o?this._alignedPosMatrixCache:this._posMatrixCache;if(A.has(S)){const V=A.get(S);return d?V.f32:V.f64}const R=hn(t,this.worldSize);s.S(R,o?this._alignedProjMatrix:this._viewProjMatrix,R);const F={f64:R,f32:new Float32Array(R)};return A.set(S,F),d?F.f32:F.f64}calculateFogMatrix(t){const o=t.key,d=this._fogMatrixCacheF32;if(d.has(o))return d.get(o);const x=hn(t,this.worldSize);return s.S(x,this._fogMatrix,x),d.set(o,new Float32Array(x)),d.get(o)}calculateCenterFromCameraLngLatAlt(t,o,d,x){return this._helper.calculateCenterFromCameraLngLatAlt(t,o,d,x)}_calculateNearFarZIfNeeded(t,o,d){if(!this._helper.autoCalculateNearFarZ)return;const x=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),S=t-x*this._helper._pixelPerMeter/Math.cos(o),A=x<0?S:t,R=Math.PI/2+this.pitchInRadians,F=s.ap(this.fov)*(Math.abs(Math.cos(s.ap(this.roll)))*this.height+Math.abs(Math.sin(s.ap(this.roll)))*this.width)/this.height*(.5+d.y/this.height),V=Math.sin(F)*A/Math.sin(s.an(Math.PI-R-F,.01,Math.PI-.01)),q=yn(this),te=Math.atan(q/this._helper.cameraToCenterDistance),ee=s.ap(.75),ce=te>ee?2*te*(.5+d.y/(2*q)):ee,_e=Math.sin(ce)*A/Math.sin(s.an(Math.PI-R-ce,.01,Math.PI-.01)),Ie=Math.min(V,_e);this._helper._farZ=1.01*(Math.cos(Math.PI/2-o)*Ie+A),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const t=this.centerOffset,o=kr(this.worldSize,this.center),d=o.x,x=o.y;this._helper._pixelPerMeter=s.as(1,this.center.lat)*this.worldSize;const S=s.ap(Math.min(this.pitch,mr)),A=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(S));let R;this._calculateNearFarZIfNeeded(A,S,t),R=new Float64Array(16),s.be(R,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),s.aB(this._invProjMatrix,R),R[8]=2*-t.x/this._helper._width,R[9]=2*t.y/this._helper._height,this._projectionMatrix=s.bf(R),s.Q(R,R,[1,-1,1]),s.O(R,R,[0,0,-this._helper.cameraToCenterDistance]),s.bg(R,R,-this.rollInRadians),s.bh(R,R,this.pitchInRadians),s.bg(R,R,-this.bearingInRadians),s.O(R,R,[-d,-x,0]),this._mercatorMatrix=s.Q([],R,[this.worldSize,this.worldSize,this.worldSize]),s.Q(R,R,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=s.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,R),s.O(R,R,[0,0,-this.elevation]),this._viewProjMatrix=R,this._invViewProjMatrix=s.aB([],R);const F=[0,0,-1,1];s.aH(F,F,this._invViewProjMatrix),this._cameraPosition=[F[0]/F[3],F[1]/F[3],F[2]/F[3]],this._fogMatrix=new Float64Array(16),s.be(this._fogMatrix,this.fovInRadians,this.width/this.height,A,this._helper._farZ),this._fogMatrix[8]=2*-t.x/this.width,this._fogMatrix[9]=2*t.y/this.height,s.Q(this._fogMatrix,this._fogMatrix,[1,-1,1]),s.O(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),s.bg(this._fogMatrix,this._fogMatrix,-this.rollInRadians),s.bh(this._fogMatrix,this._fogMatrix,this.pitchInRadians),s.bg(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),s.O(this._fogMatrix,this._fogMatrix,[-d,-x,0]),s.Q(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),s.O(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=s.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,R);const V=this._helper._width%2/2,q=this._helper._height%2/2,te=Math.cos(this.bearingInRadians),ee=Math.sin(-this.bearingInRadians),ce=d-Math.round(d)+te*V+ee*q,_e=x-Math.round(x)+te*q+ee*V,Ie=new Float64Array(R);if(s.O(Ie,Ie,[ce>.5?ce-1:ce,_e>.5?_e-1:_e,0]),this._alignedProjMatrix=Ie,R=s.aB(new Float64Array(16),this._pixelMatrix),!R)throw new Error("failed to invert matrix");this._pixelMatrixInverse=R,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const t=this.screenPointToMercatorCoordinate(new s.P(0,0)),o=[t.x*this.worldSize,t.y*this.worldSize,0,1];return s.aH(o,o,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const t=s.as(1,this.center.lat)*this.worldSize;return ht(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/t).toLngLat()}lngLatToCameraDepth(t,o){const d=s.a9.fromLngLat(t),x=[d.x*this.worldSize,d.y*this.worldSize,o,1];return s.aH(x,x,this._viewProjMatrix),x[2]/x[3]}getProjectionData(t){const{overscaledTileID:o,aligned:d,applyTerrainMatrix:x}=t,S=this._helper.getMercatorTileCoordinates(o),A=o?this.calculatePosMatrix(o,d,!0):null;let R;return R=o&&o.terrainRttPosMatrix32f&&x?o.terrainRttPosMatrix32f:A||s.bi(),{mainMatrix:R,tileMercatorCoords:S,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:R}}isLocationOccluded(t){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(t,o,d){return 1}transformLightDirection(t){return s.b1(t)}getRayDirectionFromPixel(t){throw new Error("Not implemented.")}projectTileCoordinates(t,o,d,x){const S=this.calculatePosMatrix(d);let A;x?(A=[t,o,x(t,o),1],s.aH(A,A,S)):(A=[t,o,0,1],bs(A,A,S));const R=A[3];return{point:new s.P(A[0]/R,A[1]/R),signedDistanceFromCamera:R,isOccluded:!1}}populateCache(t){for(const o of t)this.calculatePosMatrix(o)}getMatrixForModel(t,o){const d=s.a9.fromLngLat(t,o),x=d.meterInMercatorCoordinateUnits(),S=s.bj();return s.O(S,S,[d.x,d.y,d.z]),s.bg(S,S,Math.PI),s.bh(S,S,Math.PI/2),s.Q(S,S,[-x,x,x]),S}getProjectionDataForCustomLayer(t=!0){const o=new s.a2(0,0,0,0,0),d=this.getProjectionData({overscaledTileID:o,applyGlobeMatrix:t}),x=hn(o,this.worldSize);s.S(x,this._viewProjMatrix,x),d.tileMercatorCoords=[0,0,1,1];const S=[s.a5,s.a5,this.worldSize/this._helper.pixelsPerMeter],A=s.bk();return s.Q(A,x,S),d.fallbackMatrix=A,d.mainMatrix=A,d}getFastPathSimpleProjectionMatrix(t){return this.calculatePosMatrix(t)}}function Pi(){s.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Rc(w){if(w.useSlerp)if(w.k<1){const t=s.bl(w.startEulerAngles.roll,w.startEulerAngles.pitch,w.startEulerAngles.bearing),o=s.bl(w.endEulerAngles.roll,w.endEulerAngles.pitch,w.endEulerAngles.bearing),d=new Float64Array(4);s.bm(d,t,o,w.k);const x=s.bn(d);w.tr.setRoll(x.roll),w.tr.setPitch(x.pitch),w.tr.setBearing(x.bearing)}else w.tr.setRoll(w.endEulerAngles.roll),w.tr.setPitch(w.endEulerAngles.pitch),w.tr.setBearing(w.endEulerAngles.bearing);else w.tr.setRoll(s.G.number(w.startEulerAngles.roll,w.endEulerAngles.roll,w.k)),w.tr.setPitch(s.G.number(w.startEulerAngles.pitch,w.endEulerAngles.pitch,w.k)),w.tr.setBearing(s.G.number(w.startEulerAngles.bearing,w.endEulerAngles.bearing,w.k))}function Ki(w,t,o,d,x){const S=x.padding,A=kr(x.worldSize,o.getNorthWest()),R=kr(x.worldSize,o.getNorthEast()),F=kr(x.worldSize,o.getSouthEast()),V=kr(x.worldSize,o.getSouthWest()),q=s.ap(-d),te=A.rotate(q),ee=R.rotate(q),ce=F.rotate(q),_e=V.rotate(q),Ie=new s.P(Math.max(te.x,ee.x,_e.x,ce.x),Math.max(te.y,ee.y,_e.y,ce.y)),Be=new s.P(Math.min(te.x,ee.x,_e.x,ce.x),Math.min(te.y,ee.y,_e.y,ce.y)),ze=Ie.sub(Be),Ze=(x.width-(S.left+S.right+t.left+t.right))/ze.x,rt=(x.height-(S.top+S.bottom+t.top+t.bottom))/ze.y;if(rt<0||Ze<0)return void Pi();const qe=Math.min(s.at(x.scale*Math.min(Ze,rt)),w.maxZoom),tt=s.P.convert(w.offset),lt=new s.P((t.left-t.right)/2,(t.top-t.bottom)/2).rotate(s.ap(d)),Ke=tt.add(lt).mult(x.scale/s.aq(qe));return{center:Kr(x.worldSize,A.add(F).div(2).sub(Ke)),zoom:qe,bearing:d}}class xo{get useGlobeControls(){return!1}handlePanInertia(t,o){const d=t.mag(),x=Math.abs(yn(o));return{easingOffset:t.mult(Math.min(.75*x/d,1)),easingCenter:o.center}}handleMapControlsRollPitchBearingZoom(t,o){t.bearingDelta&&o.setBearing(o.bearing+t.bearingDelta),t.pitchDelta&&o.setPitch(o.pitch+t.pitchDelta),t.rollDelta&&o.setRoll(o.roll+t.rollDelta),t.zoomDelta&&o.setZoom(o.zoom+t.zoomDelta)}handleMapControlsPan(t,o,d){t.around.distSqr(o.centerPoint)<.01||o.setLocationAtPoint(d,t.around)}cameraForBoxAndBearing(t,o,d,x,S){return Ki(t,o,d,x,S)}handleJumpToCenterZoom(t,o){t.zoom!==(o.zoom!==void 0?+o.zoom:t.zoom)&&t.setZoom(+o.zoom),o.center!==void 0&&t.setCenter(s.V.convert(o.center))}handleEaseTo(t,o){const d=t.zoom,x=t.padding,S={roll:t.roll,pitch:t.pitch,bearing:t.bearing},A={roll:o.roll===void 0?t.roll:o.roll,pitch:o.pitch===void 0?t.pitch:o.pitch,bearing:o.bearing===void 0?t.bearing:o.bearing},R=o.zoom!==void 0,F=!t.isPaddingEqual(o.padding);let V=!1;const q=R?+o.zoom:t.zoom;let te=t.centerPoint.add(o.offsetAsPoint);const ee=t.screenPointToLocation(te),{center:ce,zoom:_e}=t.applyConstrain(s.V.convert(o.center||ee),q??d);mi(t,ce);const Ie=kr(t.worldSize,ee),Be=kr(t.worldSize,ce).sub(Ie),ze=s.aq(_e-d);return V=_e!==d,{easeFunc:Ze=>{if(V&&t.setZoom(s.G.number(d,_e,Ze)),s.bo(S,A)||Rc({startEulerAngles:S,endEulerAngles:A,tr:t,k:Ze,useSlerp:S.roll!=A.roll}),F&&(t.interpolatePadding(x,o.padding,Ze),te=t.centerPoint.add(o.offsetAsPoint)),o.around)t.setLocationAtPoint(o.around,o.aroundPoint);else{const rt=s.aq(t.zoom-d),qe=_e>d?Math.min(2,ze):Math.max(.5,ze),tt=Math.pow(qe,1-Ze),lt=Kr(t.worldSize,Ie.add(Be.mult(Ze*tt)).mult(rt));t.setLocationAtPoint(t.renderWorldCopies?lt.wrap():lt,te)}},isZooming:V,elevationCenter:ce}}handleFlyTo(t,o){const d=o.zoom!==void 0,x=t.zoom,S=t.applyConstrain(s.V.convert(o.center||o.locationAtOffset),d?+o.zoom:x),A=S.center,R=S.zoom;mi(t,A);const F=kr(t.worldSize,o.locationAtOffset),V=kr(t.worldSize,A).sub(F),q=V.mag(),te=s.aq(R-x);let ee;if(o.minZoom!==void 0){const ce=Math.min(+o.minZoom,x,R),_e=t.applyConstrain(A,ce).zoom;ee=s.aq(_e-x)}return{easeFunc:(ce,_e,Ie,Be)=>{t.setZoom(ce===1?R:x+s.at(_e));const ze=ce===1?A:Kr(t.worldSize,F.add(V.mult(Ie)).mult(_e));t.setLocationAtPoint(t.renderWorldCopies?ze.wrap():ze,Be)},scaleOfZoom:te,targetCenter:A,scaleOfMinZoom:ee,pixelPathLength:q}}}class qn{constructor(t,o,d){this.blendFunction=t,this.blendColor=o,this.mask=d}}qn.Replace=[1,0],qn.disabled=new qn(qn.Replace,s.bp.transparent,[!1,!1,!1,!1]),qn.unblended=new qn(qn.Replace,s.bp.transparent,[!0,!0,!0,!0]),qn.alphaBlended=new qn([1,771],s.bp.transparent,[!0,!0,!0,!0]);const Ji=2305;class _n{constructor(t,o,d){this.enable=t,this.mode=o,this.frontFace=d}}_n.disabled=new _n(!1,1029,Ji),_n.backCCW=new _n(!0,1029,Ji),_n.frontCCW=new _n(!0,1028,Ji);class cn{constructor(t,o,d){this.func=t,this.mask=o,this.range=d}}cn.ReadOnly=!1,cn.ReadWrite=!0,cn.disabled=new cn(519,cn.ReadOnly,[0,1]);const ls=7680;class Cn{constructor(t,o,d,x,S,A){this.test=t,this.ref=o,this.mask=d,this.fail=x,this.depthFail=S,this.pass=A}}Cn.disabled=new Cn({func:519,mask:0},0,0,ls,ls,ls);const Cl=new WeakMap;function Ti(w){var t;if(Cl.has(w))return Cl.get(w);{const o=(t=w.getParameter(w.VERSION))===null||t===void 0?void 0:t.startsWith("WebGL 2.0");return Cl.set(w,o),o}}class Jo{get awaitingQuery(){return!!this._readbackQueue}constructor(t){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=t;const o=t.context,d=o.gl;this._texFormat=d.RGBA,this._texType=d.UNSIGNED_BYTE;const x=new s.aW;x.emplaceBack(-1,-1),x.emplaceBack(2,-1),x.emplaceBack(-1,2);const S=new s.aY;S.emplaceBack(0,1,2),this._fullscreenTriangle=new Jn(o.createVertexBuffer(x,os.members),o.createIndexBuffer(S),s.aX.simpleSegment(0,0,x.length,S.length)),this._resultBuffer=new Uint8Array(4),o.activeTexture.set(d.TEXTURE1);const A=d.createTexture();d.bindTexture(d.TEXTURE_2D,A),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.NEAREST),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.NEAREST),d.texImage2D(d.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=o.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(A),Ti(d)&&(this._pbo=d.createBuffer(),d.bindBuffer(d.PIXEL_PACK_BUFFER,this._pbo),d.bufferData(d.PIXEL_PACK_BUFFER,4,d.STREAM_READ),d.bindBuffer(d.PIXEL_PACK_BUFFER,null))}destroy(){const t=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),t.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(t,o){const d=this._updateCount;return this._readbackQueue?d>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():d>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(t,o),this._updateCount++,this._measuredError}_bindFramebuffer(){const t=this._cachedRenderContext.context,o=t.gl;t.activeTexture.set(o.TEXTURE1),o.bindTexture(o.TEXTURE_2D,this._fbo.colorAttachment.get()),t.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(t,o){const d=this._cachedRenderContext.context,x=d.gl;if(this._bindFramebuffer(),d.viewport.set([0,0,this._texWidth,this._texHeight]),d.clear({color:s.bp.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(d,x.TRIANGLES,cn.disabled,Cn.disabled,qn.unblended,_n.disabled,((S,A)=>({u_input:S,u_output_expected:A}))(t,o),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Ti(x)){x.bindBuffer(x.PIXEL_PACK_BUFFER,this._pbo),x.readBuffer(x.COLOR_ATTACHMENT0),x.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),x.bindBuffer(x.PIXEL_PACK_BUFFER,null);const S=x.fenceSync(x.SYNC_GPU_COMMANDS_COMPLETE,0);x.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:S}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const t=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Ti(t)){const o=t.clientWaitSync(this._readbackQueue.sync,0,0);if(o===t.WAIT_FAILED)return s.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(o===t.TIMEOUT_EXPIRED)return;t.bindBuffer(t.PIXEL_PACK_BUFFER,this._pbo),t.getBufferSubData(t.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),t.bindBuffer(t.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),t.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Jo._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(t){let o=0;return o+=t[0]/256,o+=t[1]/65536,o+=t[2]/16777216,t[3]<127&&(o=-o),o/128}}const cs=s.a5/128;function Ic(w,t){const o=w.granularity!==void 0?Math.max(w.granularity,1):1,d=o+(w.generateBorders?2:0),x=o+(w.extendToNorthPole||w.generateBorders?1:0)+(w.extendToSouthPole||w.generateBorders?1:0),S=d+1,A=x+1,R=w.generateBorders?-1:0,F=w.generateBorders||w.extendToNorthPole?-1:0,V=o+(w.generateBorders?1:0),q=o+(w.generateBorders||w.extendToSouthPole?1:0),te=S*A,ee=d*x*6,ce=S*A>65536;if(ce&&t==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const _e=ce||t==="32bit",Ie=new Int16Array(2*te);let Be=0;for(let rt=F;rt<=q;rt++)for(let qe=R;qe<=V;qe++){let tt=qe/o*s.a5;qe===-1&&(tt=-cs),qe===o+1&&(tt=s.a5+cs);let lt=rt/o*s.a5;rt===-1&&(lt=w.extendToNorthPole?s.br:-cs),rt===o+1&&(lt=w.extendToSouthPole?s.bs:s.a5+cs),Ie[Be++]=tt,Ie[Be++]=lt}const ze=_e?new Uint32Array(ee):new Uint16Array(ee);let Ze=0;for(let rt=0;rt<x;rt++)for(let qe=0;qe<d;qe++){const tt=qe+1+rt*S,lt=qe+(rt+1)*S,Ke=qe+1+(rt+1)*S;ze[Ze++]=qe+rt*S,ze[Ze++]=lt,ze[Ze++]=tt,ze[Ze++]=tt,ze[Ze++]=lt,ze[Ze++]=Ke}return{vertices:Ie.buffer.slice(0),indices:ze.buffer.slice(0),uses32bitIndices:_e}}const Ls=new s.aV({fill:new s.bt(128,2),line:new s.bt(512,0),tile:new s.bt(128,32),stencil:new s.bt(128,1),circle:3});class du{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Hn.projectionGlobe}get vertexShaderPreludeCode(){return Hn.projectionMercator.vertexSource}get subdivisionGranularity(){return Ls}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(t){this._errorMeasurement||(this._errorMeasurement=new Jo(t));const o=s.X(this._errorQueryLatitudeDegrees),d=2*Math.atan(Math.exp(Math.PI-o*Math.PI*2))-.5*Math.PI,x=this._errorMeasurement.updateErrorLoop(o,d),S=O();x!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=x,this._errorMeasurementLastChangeTime=S);const A=Math.min(Math.max((S-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=s.bu(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,s.bv(A))}_getMeshKey(t){return`${t.granularity.toString(36)}_${t.generateBorders?"b":""}${t.extendToNorthPole?"n":""}${t.extendToSouthPole?"s":""}`}getMeshFromTileID(t,o,d,x,S){const A=(S==="stencil"?Ls.stencil:Ls.tile).getGranularityForZoomLevel(o.z);return this._getMesh(t,{granularity:A,generateBorders:d,extendToNorthPole:o.y===0&&x,extendToSouthPole:o.y===(1<<o.z)-1&&x})}_getMesh(t,o){const d=this._getMeshKey(o);if(d in this._tileMeshCache)return this._tileMeshCache[d];const x=(function(S,A){const R=Ic(A,"16bit"),F=s.aW.deserialize({arrayBuffer:R.vertices,length:R.vertices.byteLength/2/2}),V=s.aY.deserialize({arrayBuffer:R.indices,length:R.indices.byteLength/2/3});return new Jn(S.createVertexBuffer(F,os.members),S.createIndexBuffer(V),s.aX.simpleSegment(0,0,F.length,V.length))})(t,o);return this._tileMeshCache[d]=x,x}recalculate(t){}hasTransition(){const t=O();let o=!1;return o=o||(t-this._errorMeasurementLastChangeTime)/1e3<.7,o=o||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,o}setErrorQueryLatitudeDegrees(t){this._errorQueryLatitudeDegrees=t}}const Qo=new s.t({type:new s.D(s.u.projection.type)});class $l extends s.E{constructor(t){super(),this._transitionable=new s.x(Qo,void 0),this.setProjection(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new s.H(0)),this._mercatorProjection=new $n,this._verticalPerspectiveProjection=new du}get transitionState(){const t=this.properties.get("type");if(typeof t=="string"&&t==="mercator")return 0;if(typeof t=="string"&&t==="vertical-perspective")return 1;if(t instanceof s.bw){if(t.from==="vertical-perspective"&&t.to==="mercator")return 1-t.transition;if(t.from==="mercator"&&t.to==="vertical-perspective")return t.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(t){this._mercatorProjection.updateGPUdependent(t),this._verticalPerspectiveProjection.updateGPUdependent(t)}getMeshFromTileID(t,o,d,x,S){return this.currentProjection.getMeshFromTileID(t,o,d,x,S)}setProjection(t){this._transitionable.setValue("type",t?.type||"mercator")}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}setErrorQueryLatitudeDegrees(t){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(t),this._mercatorProjection.setErrorQueryLatitudeDegrees(t)}}function ti(w){const t=Fi(w.worldSize,w.center.lat);return 2*Math.PI*t}function zs(w,t,o,d,x){const S=1/(1<<x),A=t/s.a5*S+d*S,R=s.by((w/s.a5*S+o*S)*Math.PI*2+Math.PI,2*Math.PI),F=2*Math.atan(Math.exp(Math.PI-A*Math.PI*2))-.5*Math.PI,V=Math.cos(F),q=new Float64Array(3);return q[0]=Math.sin(R)*V,q[1]=Math.sin(F),q[2]=Math.cos(R)*V,q}function ya(w){return(function(t,o){const d=Math.cos(o),x=new Float64Array(3);return x[0]=Math.sin(t)*d,x[1]=Math.sin(o),x[2]=Math.cos(t)*d,x})(w.lng*Math.PI/180,w.lat*Math.PI/180)}function Fi(w,t){return w/(2*Math.PI)/Math.cos(t*Math.PI/180)}function Xl(w){const t=Math.asin(w[1])/Math.PI*180,o=Math.sqrt(w[0]*w[0]+w[2]*w[2]);if(o>1e-6){const d=w[0]/o,x=Math.acos(w[2]/o),S=(d>0?x:-x)/Math.PI*180;return new s.V(s.W(S,-180,180),t)}return new s.V(0,t)}function Yl(w){return Math.cos(w*Math.PI/180)}function ua(w,t){const o=Yl(w),d=Yl(t);return s.at(d/o)}function If(w,t){const o=w.rotate(t.bearingInRadians),d=t.zoom+ua(t.center.lat,0),x=s.bu(1/Yl(t.center.lat),1/Yl(Math.min(Math.abs(t.center.lat),60)),s.bx(d,7,3,0,1)),S=360/ti({worldSize:t.worldSize,center:{lat:t.center.lat}});return new s.V(t.center.lng-o.x*S*x,s.an(t.center.lat+o.y*S,-s.ao,s.ao))}function Pc(w){const t=.5*w,o=Math.sin(t),d=Math.cos(t);return Math.log(o+d)-Math.log(d-o)}function Hh(w,t,o,d){const x=w.lat+o*d;if(Math.abs(o)>1){const S=(Math.sign(w.lat+o)!==Math.sign(w.lat)?-Math.abs(w.lat):Math.abs(w.lat))*Math.PI/180,A=Math.abs(w.lat+o)*Math.PI/180,R=Pc(S+d*(A-S)),F=Pc(S),V=Pc(A);return new s.V(w.lng+t*((R-F)/(V-F)),x)}return new s.V(w.lng+t*d,x)}class na{constructor(t){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=t}swapBuffers(){if(!this._hadAnyChanges)return;const t=this._cachePrevious;this._cachePrevious=this._cache,this._cache=t,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(t,o,d,x){const S=`${t.z}_${t.x}_${t.y}_${x?.terrain?"t":""}`,A=this._cache.get(S);if(A)return A;const R=this._cachePrevious.get(S);if(R)return this._cache.set(S,R),R;const F=this._boundingVolumeFactory(t,o,d,x);return this._cache.set(S,F),this._hadAnyChanges=!0,F}}class el{constructor(t,o,d,x){this.min=d,this.max=x,this.points=t,this.planes=o}static fromAabb(t,o){const d=[];for(let x=0;x<8;x++)d.push([1&~x?t[0]:o[0],(x>>1&1)==1?o[1]:t[1],(x>>2&1)==1?o[2]:t[2]]);return new el(d,[[-1,0,0,o[0]],[1,0,0,-t[0]],[0,-1,0,o[1]],[0,1,0,-t[1]],[0,0,-1,o[2]],[0,0,1,-t[2]]],t,o)}static fromCenterSizeAngles(t,o,d){const x=s.bB([],d[0],d[1],d[2]),S=s.bC([],[o[0],0,0],x),A=s.bC([],[0,o[1],0],x),R=s.bC([],[0,0,o[2]],x),F=[...t],V=[...t];for(let te=0;te<8;te++)for(let ee=0;ee<3;ee++){const ce=t[ee]+S[ee]*(1&~te?-1:1)+A[ee]*((te>>1&1)==1?1:-1)+R[ee]*((te>>2&1)==1?1:-1);F[ee]=Math.min(F[ee],ce),V[ee]=Math.max(V[ee],ce)}const q=[];for(let te=0;te<8;te++){const ee=[...t];s.b0(ee,ee,s.a$([],S,1&~te?-1:1)),s.b0(ee,ee,s.a$([],A,(te>>1&1)==1?1:-1)),s.b0(ee,ee,s.a$([],R,(te>>2&1)==1?1:-1)),q.push(ee)}return new el(q,[[...S,-s.b5(S,q[0])],[...A,-s.b5(A,q[0])],[...R,-s.b5(R,q[0])],[-S[0],-S[1],-S[2],-s.b5(S,q[7])],[-A[0],-A[1],-A[2],-s.b5(A,q[7])],[-R[0],-R[1],-R[2],-s.b5(R,q[7])]],F,V)}intersectsFrustum(t){let o=!0;const d=this.points.length,x=this.planes.length,S=t.planes.length,A=t.points.length;for(let R=0;R<S;R++){const F=t.planes[R];let V=0;for(let q=0;q<d;q++){const te=this.points[q];F[0]*te[0]+F[1]*te[1]+F[2]*te[2]+F[3]>=0&&V++}if(V===0)return 0;V<d&&(o=!1)}if(o)return 2;for(let R=0;R<x;R++){const F=this.planes[R];let V=0;for(let q=0;q<A;q++){const te=t.points[q];F[0]*te[0]+F[1]*te[1]+F[2]*te[2]+F[3]>=0&&V++}if(V===0)return 0}return 1}intersectsPlane(t){const o=this.points.length;let d=0;for(let x=0;x<o;x++){const S=this.points[x];t[0]*S[0]+t[1]*S[1]+t[2]*S[2]+t[3]>=0&&d++}return d===o?2:d===0?0:1}}function Zn(w,t,o){const d=w-t;return d<0?-d:Math.max(0,d-o)}function yo(w,t,o,d,x){const S=w-o;let A;return A=S<0?Math.min(-S,1+S-x):S>1?Math.min(Math.max(S-x,0),1-S):0,Math.max(A,Zn(t,d,x))}class Kl{constructor(){this._boundingVolumeCache=new na(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(t,o,d,x){const S=1<<d.z,A=1/S,R=d.x/S,F=d.y/S;let V=2;return V=Math.min(V,yo(t,o,R,F,A)),V=Math.min(V,yo(t,o,R+.5,-F-A,A)),V=Math.min(V,yo(t,o,R+.5,2-F-A,A)),V}getWrap(t,o,d){const x=1<<o.z,S=1/x,A=o.x/x,R=Zn(t.x,A,S),F=Zn(t.x,A-1,S),V=Zn(t.x,A+1,S),q=Math.min(R,F,V);return q===V?1:q===F?-1:0}allowVariableZoom(t,o){return zn(t,o)>4}allowWorldCopies(){return!1}getTileBoundingVolume(t,o,d,x){return this._boundingVolumeCache.getTileBoundingVolume(t,o,d,x)}_computeTileBoundingVolume(t,o,d,x){var S,A;let R=0,F=0;if(x?.terrain){const V=new s.a2(t.z,o,t.z,t.x,t.y),q=x.terrain.getMinMaxElevation(V);R=(S=q.minElevation)!==null&&S!==void 0?S:Math.min(0,d),F=(A=q.maxElevation)!==null&&A!==void 0?A:Math.max(0,d)}if(R/=s.bE,F/=s.bE,R+=1,F+=1,t.z<=0)return el.fromAabb([-F,-F,-F],[F,F,F]);if(t.z===1)return el.fromAabb([t.x===0?-F:0,t.y===0?0:-F,-F],[t.x===0?0:F,t.y===0?F:0,F]);{const V=[zs(0,0,t.x,t.y,t.z),zs(s.a5,0,t.x,t.y,t.z),zs(s.a5,s.a5,t.x,t.y,t.z),zs(0,s.a5,t.x,t.y,t.z)],q=[];for(const kt of V)q.push(s.a$([],kt,F));if(F!==R)for(const kt of V)q.push(s.a$([],kt,R));t.y===0&&q.push([0,1,0]),t.y===(1<<t.z)-1&&q.push([0,-1,0]);const te=[1,1,1],ee=[-1,-1,-1];for(const kt of q)for(let Ct=0;Ct<3;Ct++)te[Ct]=Math.min(te[Ct],kt[Ct]),ee[Ct]=Math.max(ee[Ct],kt[Ct]);const ce=zs(s.a5/2,s.a5/2,t.x,t.y,t.z),_e=s.b4([],[0,1,0],ce);s.b3(_e,_e);const Ie=s.b4([],ce,_e);s.b3(Ie,Ie);const Be=s.b4([],V[2],V[1]);s.b3(Be,Be);const ze=s.b4([],V[0],V[3]);s.b3(ze,ze),q.push(s.a$([],ce,F)),t.y>=(1<<t.z)/2&&q.push(s.a$([],zs(s.a5/2,0,t.x,t.y,t.z),F)),t.y<(1<<t.z)/2&&q.push(s.a$([],zs(s.a5/2,s.a5,t.x,t.y,t.z),F));const Ze=Jl(ce,q),rt=Jl(Ie,q),qe=[-ce[0],-ce[1],-ce[2],Ze.max],tt=[ce[0],ce[1],ce[2],-Ze.min],lt=[-Ie[0],-Ie[1],-Ie[2],rt.max],Ke=[Ie[0],Ie[1],Ie[2],-rt.min],dt=[...Be,0],Rt=[...ze,0],Tt=[];return t.y===0?Tt.push(s.bD(Rt,dt,qe),s.bD(Rt,dt,tt)):Tt.push(s.bD(lt,dt,qe),s.bD(lt,dt,tt),s.bD(lt,Rt,qe),s.bD(lt,Rt,tt)),t.y===(1<<t.z)-1?Tt.push(s.bD(Rt,dt,qe),s.bD(Rt,dt,tt)):Tt.push(s.bD(Ke,dt,qe),s.bD(Ke,dt,tt),s.bD(Ke,Rt,qe),s.bD(Ke,Rt,tt)),new el(Tt,[qe,tt,lt,Ke,dt,Rt],te,ee)}}}function Jl(w,t){let o=1/0,d=-1/0;for(const x of t){const S=s.b5(w,x);o=Math.min(o,S),d=Math.max(d,S)}return{min:o,max:d}}class Js{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,o,d){return this._helper.interpolatePadding(t,o,d)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,o){this._helper.resize(t,o)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}setConstrainOverride(t){this._helper.setConstrainOverride(t)}overrideNearFarZ(t,o){this._helper.overrideNearFarZ(t,o)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t){}constructor(t){this._cachedClippingPlane=s.bF(),this._projectionMatrix=s.bj(),this._globeViewProjMatrix32f=s.bi(),this._globeViewProjMatrixNoCorrection=s.bj(),this._globeViewProjMatrixNoCorrectionInverted=s.bj(),this._globeProjMatrixInverted=s.bj(),this._cameraPosition=s.bz(),this._globeLatitudeErrorCorrectionRadians=0,this.defaultConstrain=(o,d)=>{const x=s.an(o.lat,-s.ao,s.ao),S=s.an(+d,this.minZoom+ua(0,x),this.maxZoom);return{center:new s.V(o.lng,x),zoom:S}},this.applyConstrain=(o,d)=>this._helper.applyConstrain(o,d),this._helper=new kl({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(o,d)=>this.defaultConstrain(o,d)},t),this._coveringTilesDetailsProvider=new Kl}clone(){const t=new Js;return t.apply(this),t}apply(t,o){this._globeLatitudeErrorCorrectionRadians=o||0,this._helper.apply(t)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const t=s.bz();return t[0]=this._cameraPosition[0],t[1]=this._cameraPosition[1],t[2]=this._cameraPosition[2],t}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(t){const{overscaledTileID:o,applyGlobeMatrix:d}=t,x=this._helper.getMercatorTileCoordinates(o);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:x,clippingPlane:this._cachedClippingPlane,projectionTransition:d?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(t){const o=this.pitchInRadians,d=this.cameraToCenterDistance/t,x=Math.sin(o)*d,S=Math.cos(o)*d+1,A=1/Math.sqrt(x*x+S*S)*1;let R=-x,F=S;const V=Math.sqrt(R*R+F*F);R/=V,F/=V;const q=[0,R,F];s.bG(q,q,[0,0,0],-this.bearingInRadians),s.bH(q,q,[0,0,0],-1*this.center.lat*Math.PI/180),s.bI(q,q,[0,0,0],this.center.lng*Math.PI/180);const te=1/s.b7(q);return s.a$(q,q,te),[...q,-A*te]}isLocationOccluded(t){return!this.isSurfacePointVisible(ya(t))}transformLightDirection(t){const o=this._helper._center.lng*Math.PI/180,d=this._helper._center.lat*Math.PI/180,x=Math.cos(d),S=[Math.sin(o)*x,Math.sin(d),Math.cos(o)*x],A=[S[2],0,-S[0]],R=[0,0,0];s.b4(R,A,S),s.b3(A,A),s.b3(R,R);const F=[0,0,0];return s.b3(F,[A[0]*t[0]+R[0]*t[1]+S[0]*t[2],A[1]*t[0]+R[1]*t[1]+S[1]*t[2],A[2]*t[0]+R[2]*t[1]+S[2]*t[2]]),F}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(t,o,d){const x=(function(R,F,V){const q=1/(1<<V.z);return new s.a9(R/s.a5*q+V.x*q,F/s.a5*q+V.y*q)})(t,o,d.canonical),S=(A=x.y,[s.by(x.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-A*Math.PI*2))-.5*Math.PI]);var A;return this.getCircleRadiusCorrection()/Math.cos(S[1])}projectTileCoordinates(t,o,d,x){const S=d.canonical,A=zs(t,o,S.x,S.y,S.z),R=1+(x?x(t,o):0)/s.bE,F=[A[0]*R,A[1]*R,A[2]*R,1];s.aH(F,F,this._globeViewProjMatrixNoCorrection);const V=this._cachedClippingPlane,q=V[0]*A[0]+V[1]*A[1]+V[2]*A[2]+V[3]<0;return{point:new s.P(F[0]/F[3],F[1]/F[3]),signedDistanceFromCamera:F[3],isOccluded:q}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const t=Fi(this.worldSize,this.center.lat),o=s.bk(),d=s.bk();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*t),s.be(o,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const x=this.centerOffset;o[8]=2*-x.x/this._helper._width,o[9]=2*x.y/this._helper._height,this._projectionMatrix=s.bf(o),this._globeProjMatrixInverted=s.bk(),s.aB(this._globeProjMatrixInverted,o),s.O(o,o,[0,0,-this.cameraToCenterDistance]),s.bg(o,o,this.rollInRadians),s.bh(o,o,-this.pitchInRadians),s.bg(o,o,this.bearingInRadians),s.O(o,o,[0,0,-t]);const S=s.bz();S[0]=t,S[1]=t,S[2]=t,s.bh(d,o,this.center.lat*Math.PI/180),s.bJ(d,d,-this.center.lng*Math.PI/180),s.Q(d,d,S),this._globeViewProjMatrixNoCorrection=d,s.bh(o,o,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),s.bJ(o,o,-this.center.lng*Math.PI/180),s.Q(o,o,S),this._globeViewProjMatrix32f=new Float32Array(o),this._globeViewProjMatrixNoCorrectionInverted=s.bk(),s.aB(this._globeViewProjMatrixNoCorrectionInverted,d);const A=s.bz();this._cameraPosition=s.bz(),this._cameraPosition[2]=this.cameraToCenterDistance/t,s.bG(this._cameraPosition,this._cameraPosition,A,-this.rollInRadians),s.bH(this._cameraPosition,this._cameraPosition,A,this.pitchInRadians),s.bG(this._cameraPosition,this._cameraPosition,A,-this.bearingInRadians),s.b0(this._cameraPosition,this._cameraPosition,[0,0,1]),s.bH(this._cameraPosition,this._cameraPosition,A,-this.center.lat*Math.PI/180),s.bI(this._cameraPosition,this._cameraPosition,A,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(t);const R=s.bf(this._globeViewProjMatrixNoCorrectionInverted);s.Q(R,R,[1,1,-1]),this._cachedFrustum=ja.fromInvProjectionMatrix(R,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(t){s.w("calculateFogMatrix is not supported on globe projection.");const o=s.bk();return s.ar(o),o}getVisibleUnwrappedCoordinates(t){return[new s.bc(0,t)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){t&&s.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,o){if(!this._globeViewProjMatrixNoCorrection)return 1;const d=ya(t);s.a$(d,d,1+o/s.bE);const x=s.bF();return s.aH(x,[d[0],d[1],d[2],1],this._globeViewProjMatrixNoCorrection),x[2]/x[3]}populateCache(t){}getBounds(){const t=.5*this.width,o=.5*this.height,d=[new s.P(0,0),new s.P(t,0),new s.P(this.width,0),new s.P(this.width,o),new s.P(this.width,this.height),new s.P(t,this.height),new s.P(0,this.height),new s.P(0,o)],x=[];for(const te of d)x.push(this.unprojectScreenPoint(te));let S=0,A=0,R=0,F=0;const V=this.center;for(const te of x){const ee=s.bK(V.lng,te.lng),ce=s.bK(V.lat,te.lat);ee<A&&(A=ee),ee>S&&(S=ee),ce<F&&(F=ce),ce>R&&(R=ce)}const q=[V.lng+A,V.lat+F,V.lng+S,V.lat+R];return this.isSurfacePointOnScreen([0,1,0])&&(q[3]=90,q[0]=-180,q[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(q[1]=-90,q[0]=-180,q[2]=180),new Ee(q)}calculateCenterFromCameraLngLatAlt(t,o,d,x){return this._helper.calculateCenterFromCameraLngLatAlt(t,o,d,x)}setLocationAtPoint(t,o){const d=ya(this.unprojectScreenPoint(o)),x=ya(t),S=s.bz();s.bL(S);const A=s.bz();s.bI(A,d,S,-this.center.lng*Math.PI/180),s.bH(A,A,S,this.center.lat*Math.PI/180);const R=x[0]*x[0]+x[2]*x[2],F=A[0]*A[0];if(R<F)return;const V=Math.sqrt(R-F),q=-V,te=s.bM(x[0],x[2],A[0],V),ee=s.bM(x[0],x[2],A[0],q),ce=s.bz();s.bI(ce,x,S,-te);const _e=s.bM(ce[1],ce[2],A[1],A[2]),Ie=s.bz();s.bI(Ie,x,S,-ee);const Be=s.bM(Ie[1],Ie[2],A[1],A[2]),ze=.5*Math.PI,Ze=_e>=-ze&&_e<=ze,rt=Be>=-ze&&Be<=ze;let qe,tt;if(Ze&&rt){const Rt=this.center.lng*Math.PI/180,Tt=this.center.lat*Math.PI/180;s.bN(te,Rt)+s.bN(_e,Tt)<s.bN(ee,Rt)+s.bN(Be,Tt)?(qe=te,tt=_e):(qe=ee,tt=Be)}else if(Ze)qe=te,tt=_e;else{if(!rt)return;qe=ee,tt=Be}const lt=qe/Math.PI*180,Ke=tt/Math.PI*180,dt=this.center.lat;this.setCenter(new s.V(lt,s.an(Ke,-90,90))),this.setZoom(this.zoom+ua(dt,this.center.lat))}locationToScreenPoint(t,o){const d=ya(t);if(o){const x=o.getElevationForLngLatZoom(t,this._helper._tileZoom);s.a$(d,d,1+x/s.bE)}return this._projectSurfacePointToScreen(d)}_projectSurfacePointToScreen(t){const o=s.bF();return s.aH(o,[...t,1],this._globeViewProjMatrixNoCorrection),o[0]/=o[3],o[1]/=o[3],new s.P((.5*o[0]+.5)*this.width,(.5*-o[1]+.5)*this.height)}screenPointToMercatorCoordinate(t,o){if(o){const d=o.pointCoordinate(t);if(d)return d}return s.a9.fromLngLat(this.unprojectScreenPoint(t))}screenPointToLocation(t,o){var d;return(d=this.screenPointToMercatorCoordinate(t,o))===null||d===void 0?void 0:d.toLngLat()}isPointOnMapSurface(t,o){const d=this._cameraPosition,x=this.getRayDirectionFromPixel(t);return!!this.rayPlanetIntersection(d,x)}getRayDirectionFromPixel(t){const o=s.bF();o[0]=t.x/this.width*2-1,o[1]=-1*(t.y/this.height*2-1),o[2]=1,o[3]=1,s.aH(o,o,this._globeViewProjMatrixNoCorrectionInverted),o[0]/=o[3],o[1]/=o[3],o[2]/=o[3];const d=s.bz();d[0]=o[0]-this._cameraPosition[0],d[1]=o[1]-this._cameraPosition[1],d[2]=o[2]-this._cameraPosition[2];const x=s.bz();return s.b3(x,d),x}isSurfacePointVisible(t){const o=this._cachedClippingPlane;return o[0]*t[0]+o[1]*t[1]+o[2]*t[2]+o[3]>=0}isSurfacePointOnScreen(t){if(!this.isSurfacePointVisible(t))return!1;const o=s.bF();return s.aH(o,[...t,1],this._globeViewProjMatrixNoCorrection),o[0]/=o[3],o[1]/=o[3],o[2]/=o[3],o[0]>-1&&o[0]<1&&o[1]>-1&&o[1]<1&&o[2]>-1&&o[2]<1}rayPlanetIntersection(t,o){const d=s.b5(t,o),x=s.bz(),S=s.bz();s.a$(S,o,d),s.b2(x,t,S);const A=1-s.b5(x,x);if(A<0)return null;const R=s.b5(t,t)-1,F=-d+(d<0?1:-1)*Math.sqrt(A),V=R/F,q=F;return{tMin:Math.min(V,q),tMax:Math.max(V,q)}}unprojectScreenPoint(t){const o=this._cameraPosition,d=this.getRayDirectionFromPixel(t),x=this.rayPlanetIntersection(o,d);if(x){const q=s.bz();s.b0(q,o,[d[0]*x.tMin,d[1]*x.tMin,d[2]*x.tMin]);const te=s.bz();return s.b3(te,q),Xl(te)}const S=this._cachedClippingPlane,A=S[0]*d[0]+S[1]*d[1]+S[2]*d[2],R=-s.bb(S,o)/A,F=s.bz();if(R>0)s.b0(F,o,[d[0]*R,d[1]*R,d[2]*R]);else{const q=s.bz();s.b0(q,o,[2*d[0],2*d[1],2*d[2]]);const te=s.bb(this._cachedClippingPlane,q);s.b2(F,q,[this._cachedClippingPlane[0]*te,this._cachedClippingPlane[1]*te,this._cachedClippingPlane[2]*te])}const V=(function(q){const te=s.bz();return te[0]=q[0]*-q[3],te[1]=q[1]*-q[3],te[2]=q[2]*-q[3],{center:te,radius:Math.sqrt(1-q[3]*q[3])}})(S);return Xl((function(q,te,ee){const ce=s.bz();s.b2(ce,ee,q);const _e=s.bz();return s.bA(_e,q,ce,te/s.b9(ce)),_e})(V.center,V.radius,F))}getMatrixForModel(t,o){const d=s.V.convert(t),x=1/s.bE,S=s.bj();return s.bJ(S,S,d.lng/180*Math.PI),s.bh(S,S,-d.lat/180*Math.PI),s.O(S,S,[0,0,1+o/s.bE]),s.bh(S,S,.5*Math.PI),s.Q(S,S,[x,x,x]),S}getProjectionDataForCustomLayer(t=!0){const o=this.getProjectionData({overscaledTileID:new s.a2(0,0,0,0,0),applyGlobeMatrix:t});return o.tileMercatorCoords=[0,0,1,1],o}getFastPathSimpleProjectionMatrix(t){}}class Ml{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,o,d){return this._helper.interpolatePadding(t,o,d)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,o,d=!0){this._helper.resize(t,o,d)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}setConstrainOverride(t){this._helper.setConstrainOverride(t)}overrideNearFarZ(t,o){this._helper.overrideNearFarZ(t,o)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(t,o){this._globeness=t,this._globeLatitudeErrorCorrectionRadians=o,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(t){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this.defaultConstrain=(o,d)=>this.currentTransform.defaultConstrain(o,d),this.applyConstrain=(o,d)=>this._helper.applyConstrain(o,d),this._helper=new kl({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(o,d)=>this.defaultConstrain(o,d)},t),this._globeness=1,this._mercatorTransform=new Ra,this._verticalPerspectiveTransform=new Js}clone(){const t=new Ml;return t._globeness=this._globeness,t._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,t.apply(this),t}apply(t){this._helper.apply(t),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(t){const o=this._mercatorTransform.getProjectionData(t),d=this._verticalPerspectiveTransform.getProjectionData(t);return{mainMatrix:this.isGlobeRendering?d.mainMatrix:o.mainMatrix,clippingPlane:d.clippingPlane,tileMercatorCoords:d.tileMercatorCoords,projectionTransition:t.applyGlobeMatrix?this._globeness:0,fallbackMatrix:o.fallbackMatrix}}isLocationOccluded(t){return this.currentTransform.isLocationOccluded(t)}transformLightDirection(t){return this.currentTransform.transformLightDirection(t)}getPixelScale(){return s.bu(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return s.bu(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(t,o,d){const x=this._mercatorTransform.getPitchedTextCorrection(t,o,d),S=this._verticalPerspectiveTransform.getPitchedTextCorrection(t,o,d);return s.bu(x,S,this._globeness)}projectTileCoordinates(t,o,d,x){return this.currentTransform.projectTileCoordinates(t,o,d,x)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(t){return this.currentTransform.calculateFogMatrix(t)}getVisibleUnwrappedCoordinates(t){return this.currentTransform.getVisibleUnwrappedCoordinates(t)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(t){this._mercatorTransform.recalculateZoomAndCenter(t),this._verticalPerspectiveTransform.recalculateZoomAndCenter(t)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,o){return this.currentTransform.lngLatToCameraDepth(t,o)}populateCache(t){this._mercatorTransform.populateCache(t),this._verticalPerspectiveTransform.populateCache(t)}getBounds(){return this.currentTransform.getBounds()}calculateCenterFromCameraLngLatAlt(t,o,d,x){return this._helper.calculateCenterFromCameraLngLatAlt(t,o,d,x)}setLocationAtPoint(t,o){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(t,o),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(t,o),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(t,o){return this.currentTransform.locationToScreenPoint(t,o)}screenPointToMercatorCoordinate(t,o){return this.currentTransform.screenPointToMercatorCoordinate(t,o)}screenPointToLocation(t,o){return this.currentTransform.screenPointToLocation(t,o)}isPointOnMapSurface(t,o){return this.currentTransform.isPointOnMapSurface(t,o)}getRayDirectionFromPixel(t){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(t)}getMatrixForModel(t,o){return this.currentTransform.getMatrixForModel(t,o)}getProjectionDataForCustomLayer(t=!0){const o=this._mercatorTransform.getProjectionDataForCustomLayer(t);if(!this.isGlobeRendering)return o;const d=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(t);return d.fallbackMatrix=o.mainMatrix,d}getFastPathSimpleProjectionMatrix(t){return this.currentTransform.getFastPathSimpleProjectionMatrix(t)}}class wa{get useGlobeControls(){return!0}handlePanInertia(t,o){const d=If(t,o);return Math.abs(d.lng-o.center.lng)>180&&(d.lng=o.center.lng+179.5*Math.sign(d.lng-o.center.lng)),{easingCenter:d,easingOffset:new s.P(0,0)}}handleMapControlsRollPitchBearingZoom(t,o){const d=t.around,x=o.screenPointToLocation(d);t.bearingDelta&&o.setBearing(o.bearing+t.bearingDelta),t.pitchDelta&&o.setPitch(o.pitch+t.pitchDelta),t.rollDelta&&o.setRoll(o.roll+t.rollDelta);const S=o.zoom;t.zoomDelta&&o.setZoom(o.zoom+t.zoomDelta);const A=o.zoom-S;if(A===0)return;const R=s.bK(o.center.lng,x.lng),F=R/(Math.abs(R/180)+1),V=s.bK(o.center.lat,x.lat),q=o.getRayDirectionFromPixel(d),te=o.cameraPosition,ee=-1*s.b5(te,q),ce=s.bz();s.b0(ce,te,[q[0]*ee,q[1]*ee,q[2]*ee]);const _e=s.b7(ce)-1,Ie=Math.exp(.5*-Math.max(_e-.3,0)),Be=Fi(o.worldSize,o.center.lat)/Math.min(o.width,o.height),ze=s.bx(Be,.9,.5,1,.25),Ze=(1-s.aq(-A))*Math.min(Ie,ze),rt=o.center.lat,qe=o.zoom,tt=new s.V(o.center.lng+F*Ze,s.an(o.center.lat+V*Ze,-s.ao,s.ao));o.setLocationAtPoint(x,d);const lt=o.center,Ke=s.bx(Math.abs(R),45,85,0,1),dt=s.bx(Be,.75,.35,0,1),Rt=Math.pow(Math.max(Ke,dt),.25),Tt=s.bK(lt.lng,tt.lng),kt=s.bK(lt.lat,tt.lat);o.setCenter(new s.V(lt.lng+Tt*Rt,lt.lat+kt*Rt).wrap()),o.setZoom(qe+ua(rt,o.center.lat))}handleMapControlsPan(t,o,d){if(!t.panDelta)return;const x=o.center.lat,S=o.zoom;o.setCenter(If(t.panDelta,o).wrap()),o.setZoom(S+ua(x,o.center.lat))}cameraForBoxAndBearing(t,o,d,x,S){const A=Ki(t,o,d,x,S),R=o.left/S.width*2-1,F=(S.width-o.right)/S.width*2-1,V=o.top/S.height*-2+1,q=(S.height-o.bottom)/S.height*-2+1,te=s.bK(d.getWest(),d.getEast())<0,ee=te?d.getEast():d.getWest(),ce=te?d.getWest():d.getEast(),_e=Math.max(d.getNorth(),d.getSouth()),Ie=Math.min(d.getNorth(),d.getSouth()),Be=ee+.5*s.bK(ee,ce),ze=_e+.5*s.bK(_e,Ie),Ze=S.clone();Ze.setCenter(A.center),Ze.setBearing(A.bearing),Ze.setPitch(0),Ze.setRoll(0),Ze.setZoom(A.zoom);const rt=Ze.modelViewProjectionMatrix,qe=[ya(d.getNorthWest()),ya(d.getNorthEast()),ya(d.getSouthWest()),ya(d.getSouthEast()),ya(new s.V(ce,ze)),ya(new s.V(ee,ze)),ya(new s.V(Be,_e)),ya(new s.V(Be,Ie))],tt=ya(A.center);let lt=Number.POSITIVE_INFINITY;for(const Ke of qe)R<0&&(lt=wa.getLesserNonNegativeNonNull(lt,wa.solveVectorScale(Ke,tt,rt,"x",R))),F>0&&(lt=wa.getLesserNonNegativeNonNull(lt,wa.solveVectorScale(Ke,tt,rt,"x",F))),V>0&&(lt=wa.getLesserNonNegativeNonNull(lt,wa.solveVectorScale(Ke,tt,rt,"y",V))),q<0&&(lt=wa.getLesserNonNegativeNonNull(lt,wa.solveVectorScale(Ke,tt,rt,"y",q)));if(Number.isFinite(lt)&&lt!==0)return A.zoom=Ze.zoom+s.at(lt),A;Pi()}handleJumpToCenterZoom(t,o){const d=t.center.lat,x=t.applyConstrain(o.center?s.V.convert(o.center):t.center,t.zoom).center;t.setCenter(x.wrap());const S=o.zoom!==void 0?+o.zoom:t.zoom+ua(d,x.lat);t.zoom!==S&&t.setZoom(S)}handleEaseTo(t,o){const d=t.zoom,x=t.center,S=t.padding,A={roll:t.roll,pitch:t.pitch,bearing:t.bearing},R={roll:o.roll===void 0?t.roll:o.roll,pitch:o.pitch===void 0?t.pitch:o.pitch,bearing:o.bearing===void 0?t.bearing:o.bearing},F=o.zoom!==void 0,V=!t.isPaddingEqual(o.padding);let q=!1;const te=o.center?s.V.convert(o.center):x,ee=t.applyConstrain(te,d).center;mi(t,ee);const ce=t.clone();ce.setCenter(ee),ce.setZoom(F?+o.zoom:d+ua(x.lat,te.lat)),ce.setBearing(o.bearing);const _e=new s.P(s.an(t.centerPoint.x+o.offsetAsPoint.x,0,t.width),s.an(t.centerPoint.y+o.offsetAsPoint.y,0,t.height));ce.setLocationAtPoint(ee,_e);const Ie=(o.offset&&o.offsetAsPoint.mag())>0?ce.center:ee,Be=F?+o.zoom:d+ua(x.lat,Ie.lat),ze=d+ua(x.lat,0),Ze=Be+ua(Ie.lat,0),rt=s.bK(x.lng,Ie.lng),qe=s.bK(x.lat,Ie.lat),tt=s.aq(Ze-ze);return q=Be!==d,{easeFunc:lt=>{if(s.bo(A,R)||Rc({startEulerAngles:A,endEulerAngles:R,tr:t,k:lt,useSlerp:A.roll!=R.roll}),V&&t.interpolatePadding(S,o.padding,lt),o.around)s.w("Easing around a point is not supported under globe projection."),t.setLocationAtPoint(o.around,o.aroundPoint);else{const Ke=Ze>ze?Math.min(2,tt):Math.max(.5,tt),dt=Math.pow(Ke,1-lt),Rt=Hh(x,rt,qe,lt*dt);t.setCenter(Rt.wrap())}if(q){const Ke=s.G.number(ze,Ze,lt)+ua(0,t.center.lat);t.setZoom(Ke)}},isZooming:q,elevationCenter:Ie}}handleFlyTo(t,o){const d=o.zoom!==void 0,x=t.center,S=t.zoom,A=t.padding,R=!t.isPaddingEqual(o.padding),F=t.applyConstrain(s.V.convert(o.center||o.locationAtOffset),S).center,V=d?+o.zoom:t.zoom+ua(t.center.lat,F.lat),q=t.clone();q.setCenter(F),q.setZoom(V),q.setBearing(o.bearing);const te=new s.P(s.an(t.centerPoint.x+o.offsetAsPoint.x,0,t.width),s.an(t.centerPoint.y+o.offsetAsPoint.y,0,t.height));q.setLocationAtPoint(F,te);const ee=q.center;mi(t,ee);const ce=(function(qe,tt,lt){const Ke=ya(tt),dt=ya(lt),Rt=s.b5(Ke,dt),Tt=Math.acos(Rt),kt=ti(qe);return Tt/(2*Math.PI)*kt})(t,x,ee),_e=S+ua(x.lat,0),Ie=V+ua(ee.lat,0),Be=s.aq(Ie-_e);let ze;if(typeof o.minZoom=="number"){const qe=+o.minZoom+ua(ee.lat,0),tt=Math.min(qe,_e,Ie)+ua(0,ee.lat),lt=t.applyConstrain(ee,tt).zoom+ua(ee.lat,0);ze=s.aq(lt-_e)}const Ze=s.bK(x.lng,ee.lng),rt=s.bK(x.lat,ee.lat);return{easeFunc:(qe,tt,lt,Ke)=>{const dt=Hh(x,Ze,rt,lt);R&&t.interpolatePadding(A,o.padding,qe);const Rt=qe===1?ee:dt;t.setCenter(Rt.wrap());const Tt=_e+s.at(tt);t.setZoom(qe===1?V:Tt+ua(0,Rt.lat))},scaleOfZoom:Be,targetCenter:ee,scaleOfMinZoom:ze,pixelPathLength:ce}}static solveVectorScale(t,o,d,x,S){const A=x==="x"?[d[0],d[4],d[8],d[12]]:[d[1],d[5],d[9],d[13]],R=[d[3],d[7],d[11],d[15]],F=t[0]*A[0]+t[1]*A[1]+t[2]*A[2],V=t[0]*R[0]+t[1]*R[1]+t[2]*R[2],q=o[0]*A[0]+o[1]*A[1]+o[2]*A[2],te=o[0]*R[0]+o[1]*R[1]+o[2]*R[2];return q+S*V===F+S*te||R[3]*(F-q)+A[3]*(te-V)+F*te==q*V?null:(q+A[3]-S*te-S*R[3])/(q-F-S*te+S*V)}static getLesserNonNegativeNonNull(t,o){return o!==null&&o>=0&&o<t?o:t}}class Ql{constructor(t){this._globe=t,this._mercatorCameraHelper=new xo,this._verticalPerspectiveCameraHelper=new wa}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(t,o){return this.currentHelper.handlePanInertia(t,o)}handleMapControlsRollPitchBearingZoom(t,o){return this.currentHelper.handleMapControlsRollPitchBearingZoom(t,o)}handleMapControlsPan(t,o,d){this.currentHelper.handleMapControlsPan(t,o,d)}cameraForBoxAndBearing(t,o,d,x,S){return this.currentHelper.cameraForBoxAndBearing(t,o,d,x,S)}handleJumpToCenterZoom(t,o){this.currentHelper.handleJumpToCenterZoom(t,o)}handleEaseTo(t,o){return this.currentHelper.handleEaseTo(t,o)}handleFlyTo(t,o){return this.currentHelper.handleFlyTo(t,o)}}const ec=(w,t)=>s.B(w,t&&t.filter((o=>o.identifier!=="source.canvas"))),vo=s.bO();class tl extends s.E{constructor(t,o={}){var d,x;super(),this._rtlPluginLoaded=()=>{for(const A in this.tileManagers){const R=this.tileManagers[A].getSource().type;R!=="vector"&&R!=="geojson"||this.tileManagers[A].reload()}},this.map=t,this.dispatcher=new Yt(Bt(),t._getMapId()),this.dispatcher.registerMessageHandler("GG",((A,R)=>this.getGlyphs(A,R))),this.dispatcher.registerMessageHandler("GI",((A,R)=>this.getImages(A,R))),this.dispatcher.registerMessageHandler("GDA",((A,R)=>this.getDashes(A,R))),this.imageManager=new de,this.imageManager.setEventedParent(this);const S=((d=t._container)===null||d===void 0?void 0:d.lang)||typeof document<"u"&&((x=document.documentElement)===null||x===void 0?void 0:x.lang)||void 0;this.glyphManager=new He(t._requestManager,o.localIdeographFontFamily,S),this.lineAtlas=new Ue(256,512),this.crossTileSymbolIndex=new Ma,this._setInitialValues(),this._resetUpdates(),this.dispatcher.broadcast("SR",s.bP()),ot().on(Ve,this._rtlPluginLoaded),this.on("data",(A=>{if(A.dataType!=="source"||A.sourceDataType!=="metadata")return;const R=this.tileManagers[A.sourceId];if(!R)return;const F=R.getSource();if(F&&F.vectorLayerIds)for(const V in this._layers){const q=this._layers[V];q.source===F.id&&this._validateLayer(q)}}))}_setInitialValues(){var t;this._spritesImagesIds={},this._layers={},this._order=[],this.tileManagers={},this.zoomHistory=new s.bQ,this._availableImages=[],this._globalState={},this._serializedLayers={},this.stylesheet=null,this.light=null,this.sky=null,this.projection&&(this.projection.destroy(),delete this.projection),this._loaded=!1,this._changed=!1,this._updatedLayers={},this._updatedSources={},this._changedImages={},this._glyphsDidChange=!1,this._updatedPaintProps={},this._layerOrderChanged=!1,this.crossTileSymbolIndex=new(((t=this.crossTileSymbolIndex)===null||t===void 0?void 0:t.constructor)||Object),this.pauseablePlacement=void 0,this.placement=void 0,this.z=0}setGlobalStateProperty(t,o){var d,x,S;this._checkLoaded();const A=o===null?(S=(x=(d=this.stylesheet.state)===null||d===void 0?void 0:d[t])===null||x===void 0?void 0:x.default)!==null&&S!==void 0?S:null:o;if(s.bR(A,this._globalState[t]))return this;this._globalState[t]=A,this._applyGlobalStateChanges([t])}getGlobalState(){return this._globalState}setGlobalState(t){this._checkLoaded();const o=[];for(const d in t)!s.bR(this._globalState[d],t[d].default)&&(o.push(d),this._globalState[d]=t[d].default);this._applyGlobalStateChanges(o)}_applyGlobalStateChanges(t){if(t.length===0)return;const o=new Set,d={};for(const x of t){d[x]=this._globalState[x];for(const S in this._layers){const A=this._layers[S],R=A.getLayoutAffectingGlobalStateRefs(),F=A.getPaintAffectingGlobalStateRefs(),V=A.getVisibilityAffectingGlobalStateRefs();if(R.has(x)&&o.add(A.source),F.has(x))for(const{name:q,value:te}of F.get(x))this._updatePaintProperty(A,q,te);V?.has(x)&&(A.recalculateVisibility(),this._updateLayer(A))}}this.dispatcher.broadcast("UGS",d);for(const x in this.tileManagers)o.has(x)&&(this._reloadSource(x),this._changed=!0)}loadURL(t,o={},d){this.fire(new s.l("dataloading",{dataType:"style"})),o.validate=typeof o.validate!="boolean"||o.validate;const x=this.map._requestManager.transformRequest(t,"Style");this._loadStyleRequest=new AbortController;const S=this._loadStyleRequest;s.j(x,this._loadStyleRequest).then((A=>{this._loadStyleRequest=null,this._load(A.data,o,d)})).catch((A=>{this._loadStyleRequest=null,A&&!S.signal.aborted&&this.fire(new s.k(A))}))}loadJSON(t,o={},d){this.fire(new s.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,j.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,o.validate=o.validate!==!1,this._load(t,o,d)})).catch((()=>{}))}loadEmpty(){this.fire(new s.l("dataloading",{dataType:"style"})),this._load(vo,{validate:!1})}_load(t,o,d){var x,S;let A=o.transformStyle?o.transformStyle(d,t):t;if(!o.validate||!ec(this,s.C(A))){A=Object.assign({},A),this._loaded=!0,this.stylesheet=A;for(const R in A.sources)this.addSource(R,A.sources[R],{validate:!1});A.sprite?this._loadSprite(A.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(A.glyphs),this._createLayers(),this.light=new It(this.stylesheet.light),this._setProjectionInternal(((x=this.stylesheet.projection)===null||x===void 0?void 0:x.type)||"mercator"),this.sky=new ne(this.stylesheet.sky),this.map.setTerrain((S=this.stylesheet.terrain)!==null&&S!==void 0?S:null),this.fire(new s.l("data",{dataType:"style"})),this.fire(new s.l("style.load"))}}_createLayers(){var t,o,d;const x=s.bS(this.stylesheet.layers);this.setGlobalState((t=this.stylesheet.state)!==null&&t!==void 0?t:null),this.dispatcher.broadcast("SL",x),this._order=x.map((S=>S.id)),this._layers={},this._serializedLayers=null;for(const S of x){const A=s.bT(S,this._globalState);if(A.setEventedParent(this,{layer:{id:S.id}}),this._layers[S.id]=A,s.bU(A)&&this.tileManagers[A.source]){const R=(d=(o=S.paint)===null||o===void 0?void 0:o["raster-fade-duration"])!==null&&d!==void 0?d:A.paint.get("raster-fade-duration");this.tileManagers[A.source].setRasterFadeDuration(R)}}}_loadSprite(t,o=!1,d=void 0){this.imageManager.setLoaded(!1);const x=new AbortController;let S;this._spriteRequest=x,(function(A,R,F,V){return s._(this,void 0,void 0,(function*(){const q=xe(A),te=F>1?"@2x":"",ee={},ce={};for(const{id:_e,url:Ie}of q){const Be=R.transformRequest(Ge(Ie,te,".json"),"SpriteJSON");ee[_e]=s.j(Be,V);const ze=R.transformRequest(Ge(Ie,te,".png"),"SpriteImage");ce[_e]=re.getImage(ze,V)}return yield Promise.all([...Object.values(ee),...Object.values(ce)]),(function(_e,Ie){return s._(this,void 0,void 0,(function*(){const Be={};for(const ze in _e){Be[ze]={};const Ze=j.getImageCanvasContext((yield Ie[ze]).data),rt=(yield _e[ze]).data;for(const qe in rt){const{width:tt,height:lt,x:Ke,y:dt,sdf:Rt,pixelRatio:Tt,stretchX:kt,stretchY:Ct,content:ur,textFitWidth:hr,textFitHeight:tr}=rt[qe];Be[ze][qe]={data:null,pixelRatio:Tt,sdf:Rt,stretchX:kt,stretchY:Ct,content:ur,textFitWidth:hr,textFitHeight:tr,spriteData:{width:tt,height:lt,x:Ke,y:dt,context:Ze}}}}return Be}))})(ee,ce)}))})(t,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((A=>{if(this._spriteRequest=null,A)for(const R in A){this._spritesImagesIds[R]=[];const F=this._spritesImagesIds[R]?this._spritesImagesIds[R].filter((V=>!(V in A))):[];for(const V of F)this.imageManager.removeImage(V),this._changedImages[V]=!0;for(const V in A[R]){const q=R==="default"?V:`${R}:${V}`;this._spritesImagesIds[R].push(q),q in this.imageManager.images?this.imageManager.updateImage(q,A[R][V],!1):this.imageManager.addImage(q,A[R][V]),o&&(this._changedImages[q]=!0)}}})).catch((A=>{this._spriteRequest=null,S=A,x.signal.aborted||this.fire(new s.k(S))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),o&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"})),d&&d(S)}))}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}_validateLayer(t){const o=this.tileManagers[t.source];if(!o)return;const d=t.sourceLayer;if(!d)return;const x=o.getSource();(x.type==="geojson"||x.vectorLayerIds&&x.vectorLayerIds.indexOf(d)===-1)&&this.fire(new s.k(new Error(`Source layer "${d}" does not exist on source "${x.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.tileManagers)if(!this.tileManagers[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t,o=!1){const d=this._serializedAllLayers();if(!t||t.length===0)return Object.values(o?s.bV(d):d);const x=[];for(const S of t)if(d[S]){const A=o?s.bV(d[S]):d[S];x.push(A)}return x}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const o=Object.keys(this._layers);for(const d of o){const x=this._layers[d];x.type!=="custom"&&(t[d]=x.serialize())}return t}hasTransitions(){var t,o,d;if(!((t=this.light)===null||t===void 0)&&t.hasTransition()||!((o=this.sky)===null||o===void 0)&&o.hasTransition()||!((d=this.projection)===null||d===void 0)&&d.hasTransition())return!0;for(const x in this.tileManagers)if(this.tileManagers[x].hasTransition())return!0;for(const x in this._layers)if(this._layers[x].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const o=this._changed;if(o){const x=Object.keys(this._updatedLayers),S=Object.keys(this._removedLayers);(x.length||S.length)&&this._updateWorkerLayers(x,S);for(const A in this._updatedSources){const R=this._updatedSources[A];if(R==="reload")this._reloadSource(A);else{if(R!=="clear")throw new Error(`Invalid action ${R}`);this._clearSource(A)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const A in this._updatedPaintProps)this._layers[A].updateTransitions(t);this.light.updateTransitions(t),this.sky.updateTransitions(t),this._resetUpdates()}const d={};for(const x in this.tileManagers){const S=this.tileManagers[x];d[x]=S.used,S.used=!1}for(const x of this._order){const S=this._layers[x];S.recalculate(t,this._availableImages),!S.isHidden(t.zoom)&&S.source&&(this.tileManagers[S.source].used=!0)}for(const x in d){const S=this.tileManagers[x];!!d[x]!=!!S.used&&S.fire(new s.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:x}))}this.light.recalculate(t),this.sky.recalculate(t),this.projection.recalculate(t),this.z=t.zoom,o&&this.fire(new s.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const o in this.tileManagers)this.tileManagers[o].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.tileManagers)this.tileManagers[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,o){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(t,!1),removedIds:o})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,o={}){var d;this._checkLoaded();const x=this.serialize();if(t=o.transformStyle?o.transformStyle(x,t):t,((d=o.validate)===null||d===void 0||d)&&ec(this,s.C(t)))return!1;(t=s.bV(t)).layers=s.bS(t.layers);const S=s.bW(x,t),A=this._getOperationsToPerform(S);if(A.unimplemented.length>0)throw new Error(`Unimplemented: ${A.unimplemented.join(", ")}.`);if(A.operations.length===0)return!1;for(const R of A.operations)R();return this.stylesheet=t,this._serializedLayers=null,!0}_getOperationsToPerform(t){const o=[],d=[];for(const x of t)switch(x.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":o.push((()=>this.addLayer.apply(this,x.args)));break;case"removeLayer":o.push((()=>this.removeLayer.apply(this,x.args)));break;case"setPaintProperty":o.push((()=>this.setPaintProperty.apply(this,x.args)));break;case"setLayoutProperty":o.push((()=>this.setLayoutProperty.apply(this,x.args)));break;case"setFilter":o.push((()=>this.setFilter.apply(this,x.args)));break;case"addSource":o.push((()=>this.addSource.apply(this,x.args)));break;case"removeSource":o.push((()=>this.removeSource.apply(this,x.args)));break;case"setLayerZoomRange":o.push((()=>this.setLayerZoomRange.apply(this,x.args)));break;case"setLight":o.push((()=>this.setLight.apply(this,x.args)));break;case"setGeoJSONSourceData":o.push((()=>this.setGeoJSONSourceData.apply(this,x.args)));break;case"setGlyphs":o.push((()=>this.setGlyphs.apply(this,x.args)));break;case"setSprite":o.push((()=>this.setSprite.apply(this,x.args)));break;case"setTerrain":o.push((()=>this.map.setTerrain.apply(this,x.args)));break;case"setSky":o.push((()=>this.setSky.apply(this,x.args)));break;case"setProjection":this.setProjection.apply(this,x.args);break;case"setGlobalState":o.push((()=>this.setGlobalState.apply(this,x.args)));break;case"setTransition":o.push((()=>{}));break;default:d.push(x.command)}return{operations:o,unimplemented:d}}addImage(t,o){if(this.getImage(t))return this.fire(new s.k(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,o),this._afterImageUpdated(t)}updateImage(t,o){this.imageManager.updateImage(t,o)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new s.k(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,o,d={}){if(this._checkLoaded(),this.tileManagers[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!o.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(o).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(o.type)>=0&&this._validate(s.C.source,`sources.${t}`,o,null,d))return;this.map&&this.map._collectResourceTiming&&(o.collectResourceTiming=!0);const x=this.tileManagers[t]=new Me(t,o,this.dispatcher);x.style=this,x.setEventedParent(this,(()=>({isSourceLoaded:x.loaded(),source:x.serialize(),sourceId:t}))),x.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.tileManagers[t]===void 0)throw new Error("There is no source with this ID");for(const d in this._layers)if(this._layers[d].source===t)return this.fire(new s.k(new Error(`Source "${t}" cannot be removed while layer "${d}" is using it.`)));const o=this.tileManagers[t];delete this.tileManagers[t],delete this._updatedSources[t],o.fire(new s.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),o.setEventedParent(null),o.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,o){if(this._checkLoaded(),this.tileManagers[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const d=this.tileManagers[t].getSource();if(d.type!=="geojson")throw new Error(`geojsonSource.type is ${d.type}, which is !== 'geojson`);d.setData(o),this._changed=!0}getSource(t){return this.tileManagers[t]&&this.tileManagers[t].getSource()}addLayer(t,o,d={}){this._checkLoaded();const x=t.id;if(this.getLayer(x))return void this.fire(new s.k(new Error(`Layer "${x}" already exists on this map.`)));let S;if(t.type==="custom"){if(ec(this,s.bX(t)))return;S=s.bT(t,this._globalState)}else{if("source"in t&&typeof t.source=="object"&&(this.addSource(x,t.source),t=s.bV(t),t=s.e(t,{source:x})),this._validate(s.C.layer,`layers.${x}`,t,{arrayIndex:-1},d))return;S=s.bT(t,this._globalState),this._validateLayer(S),S.setEventedParent(this,{layer:{id:x}})}const A=o?this._order.indexOf(o):this._order.length;if(o&&A===-1)this.fire(new s.k(new Error(`Cannot add layer "${x}" before non-existing layer "${o}".`)));else{if(this._order.splice(A,0,x),this._layerOrderChanged=!0,this._layers[x]=S,this._removedLayers[x]&&S.source&&S.type!=="custom"){const R=this._removedLayers[x];delete this._removedLayers[x],R.type!==S.type?this._updatedSources[S.source]="clear":(this._updatedSources[S.source]="reload",this.tileManagers[S.source].pause())}this._updateLayer(S),S.onAdd&&S.onAdd(this.map)}}moveLayer(t,o){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new s.k(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===o)return;const d=this._order.indexOf(t);this._order.splice(d,1);const x=o?this._order.indexOf(o):this._order.length;o&&x===-1?this.fire(new s.k(new Error(`Cannot move layer "${t}" before non-existing layer "${o}".`))):(this._order.splice(x,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const o=this._layers[t];if(!o)return void this.fire(new s.k(new Error(`Cannot remove non-existing layer "${t}".`)));o.setEventedParent(null);const d=this._order.indexOf(t);this._order.splice(d,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=o,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],o.onRemove&&o.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,o,d){this._checkLoaded();const x=this.getLayer(t);x?x.minzoom===o&&x.maxzoom===d||(o!=null&&(x.minzoom=o),d!=null&&(x.maxzoom=d),this._updateLayer(x)):this.fire(new s.k(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,o,d={}){this._checkLoaded();const x=this.getLayer(t);if(x){if(!s.bR(x.filter,o))return o==null?(x.setFilter(void 0),void this._updateLayer(x)):void(this._validate(s.C.filter,`layers.${x.id}.filter`,o,null,d)||(x.setFilter(s.bV(o)),this._updateLayer(x)))}else this.fire(new s.k(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return s.bV(this.getLayer(t).filter)}setLayoutProperty(t,o,d,x={}){this._checkLoaded();const S=this.getLayer(t);S?s.bR(S.getLayoutProperty(o),d)||(S.setLayoutProperty(o,d,x),this._updateLayer(S)):this.fire(new s.k(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,o){const d=this.getLayer(t);if(d)return d.getLayoutProperty(o);this.fire(new s.k(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,o,d,x={}){this._checkLoaded();const S=this.getLayer(t);S?s.bR(S.getPaintProperty(o),d)||this._updatePaintProperty(S,o,d,x):this.fire(new s.k(new Error(`Cannot style non-existing layer "${t}".`)))}_updatePaintProperty(t,o,d,x={}){t.setPaintProperty(o,d,x)&&this._updateLayer(t),s.bU(t)&&o==="raster-fade-duration"&&this.tileManagers[t.source].setRasterFadeDuration(d),this._changed=!0,this._updatedPaintProps[t.id]=!0,this._serializedLayers=null}getPaintProperty(t,o){return this.getLayer(t).getPaintProperty(o)}setFeatureState(t,o){this._checkLoaded();const d=t.source,x=t.sourceLayer,S=this.tileManagers[d];if(S===void 0)return void this.fire(new s.k(new Error(`The source '${d}' does not exist in the map's style.`)));const A=S.getSource().type;A==="geojson"&&x?this.fire(new s.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):A!=="vector"||x?(t.id===void 0&&this.fire(new s.k(new Error("The feature id parameter must be provided."))),S.setFeatureState(x,t.id,o)):this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,o){this._checkLoaded();const d=t.source,x=this.tileManagers[d];if(x===void 0)return void this.fire(new s.k(new Error(`The source '${d}' does not exist in the map's style.`)));const S=x.getSource().type,A=S==="vector"?t.sourceLayer:void 0;S!=="vector"||A?o&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new s.k(new Error("A feature id is required to remove its specific state property."))):x.removeFeatureState(A,t.id,o):this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const o=t.source,d=t.sourceLayer,x=this.tileManagers[o];if(x!==void 0)return x.getSource().type!=="vector"||d?(t.id===void 0&&this.fire(new s.k(new Error("The feature id parameter must be provided."))),x.getFeatureState(d,t.id)):void this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new s.k(new Error(`The source '${o}' does not exist in the map's style.`)))}getTransition(){return s.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=s.bY(this.tileManagers,(S=>S.serialize())),o=this._serializeByIds(this._order,!0),d=this.map.getTerrain()||void 0,x=this.stylesheet;return s.bZ({version:x.version,name:x.name,metadata:x.metadata,light:x.light,sky:x.sky,center:x.center,zoom:x.zoom,bearing:x.bearing,pitch:x.pitch,sprite:x.sprite,glyphs:x.glyphs,transition:x.transition,projection:x.projection,sources:t,layers:o,terrain:d},(S=>S!==void 0))}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.tileManagers[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.tileManagers[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const o=A=>this._layers[A].type==="fill-extrusion",d={},x=[];for(let A=this._order.length-1;A>=0;A--){const R=this._order[A];if(o(R)){d[R]=A;for(const F of t){const V=F[R];if(V)for(const q of V)x.push(q)}}}x.sort(((A,R)=>R.intersectionZ-A.intersectionZ));const S=[];for(let A=this._order.length-1;A>=0;A--){const R=this._order[A];if(o(R))for(let F=x.length-1;F>=0;F--){const V=x[F].feature;if(d[V.layer.id]<A)break;S.push(V),x.pop()}else for(const F of t){const V=F[R];if(V)for(const q of V)S.push(q.feature)}}return S}queryRenderedFeatures(t,o,d){o&&o.filter&&this._validate(s.C.filter,"queryRenderedFeatures.filter",o.filter,null,o);const x={};if(o&&o.layers){if(!(Array.isArray(o.layers)||o.layers instanceof Set))return this.fire(new s.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const V of o.layers){const q=this._layers[V];if(!q)return this.fire(new s.k(new Error(`The layer '${V}' does not exist in the map's style and cannot be queried for features.`))),[];x[q.source]=!0}}const S=[];o.availableImages=this._availableImages;const A=this._serializedAllLayers(),R=o.layers instanceof Set?o.layers:Array.isArray(o.layers)?new Set(o.layers):null,F=Object.assign(Object.assign({},o),{layers:R,globalState:this._globalState});for(const V in this.tileManagers)o.layers&&!x[V]||S.push(pn(this.tileManagers[V],this._layers,A,t,F,d,this.map.terrain?(q,te,ee)=>this.map.terrain.getElevation(q,te,ee):void 0));return this.placement&&S.push((function(V,q,te,ee,ce,_e,Ie){const Be={},ze=_e.queryRenderedSymbols(ee),Ze=[];for(const rt of Object.keys(ze).map(Number))Ze.push(Ie[rt]);Ze.sort(se);for(const rt of Ze){const qe=rt.featureIndex.lookupSymbolFeatures(ze[rt.bucketInstanceId],q,rt.bucketIndex,rt.sourceLayerIndex,{filterSpec:ce.filter,globalState:ce.globalState},ce.layers,ce.availableImages,V);for(const tt in qe){const lt=Be[tt]=Be[tt]||[],Ke=qe[tt];Ke.sort(((dt,Rt)=>{const Tt=rt.featureSortOrder;if(Tt){const kt=Tt.indexOf(dt.featureIndex);return Tt.indexOf(Rt.featureIndex)-kt}return Rt.featureIndex-dt.featureIndex}));for(const dt of Ke)lt.push(dt)}}return(function(rt,qe,tt){for(const lt in rt)for(const Ke of rt[lt])Mt(Ke,tt[qe[lt].source]);return rt})(Be,V,te)})(this._layers,A,this.tileManagers,t,F,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(S)}querySourceFeatures(t,o){o?.filter&&this._validate(s.C.filter,"querySourceFeatures.filter",o.filter,null,o);const d=this.tileManagers[t];return d?(function(x,S){const A=x.getRenderableIds().map((V=>x.getTileByID(V))),R=[],F={};for(let V=0;V<A.length;V++){const q=A[V],te=q.tileID.canonical.key;F[te]||(F[te]=!0,q.querySourceFeatures(R,S))}return R})(d,o?Object.assign(Object.assign({},o),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(t,o={}){this._checkLoaded();const d=this.light.getLight();let x=!1;for(const A in t)if(!s.bR(t[A],d[A])){x=!0;break}if(!x)return;const S={now:O(),transition:s.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,o),this.light.updateTransitions(S)}getProjection(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.projection}setProjection(t){if(this._checkLoaded(),this.projection){if(this.projection.name===t.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=t,this._setProjectionInternal(t.type)}getSky(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.sky}setSky(t,o={}){this._checkLoaded();const d=this.getSky();let x=!1;if(!t&&!d)return;if(t&&!d)x=!0;else if(!t&&d)x=!0;else for(const A in t)if(!s.bR(t[A],d[A])){x=!0;break}if(!x)return;const S={now:O(),transition:s.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=t,this.sky.setSky(t,o),this.sky.updateTransitions(S)}_setProjectionInternal(t){const o=(function(d,x){const S={constrainOverride:x};if(Array.isArray(d)){const A=new $l({type:d});return{projection:A,transform:new Ml(S),cameraHelper:new Ql(A)}}switch(d){case"mercator":return{projection:new $n,transform:new Ra(S),cameraHelper:new xo};case"globe":{const A=new $l({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:A,transform:new Ml(S),cameraHelper:new Ql(A)}}case"vertical-perspective":return{projection:new du,transform:new Js(S),cameraHelper:new wa};default:return s.w(`Unknown projection name: ${d}. Falling back to mercator projection.`),{projection:new $n,transform:new Ra(S),cameraHelper:new xo}}})(t,this.map.transformConstrain);this.projection=o.projection,this.map.migrateProjection(o.transform,o.cameraHelper);for(const d in this.tileManagers)this.tileManagers[d].reload()}_validate(t,o,d,x,S={}){return(!S||S.validate!==!1)&&ec(this,t.call(s.C,s.e({key:o,style:this.serialize(),value:d,styleSpec:s.u},x)))}_remove(t=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),ot().off(Ve,this._rtlPluginLoaded);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this.tileManagers){const d=this.tileManagers[o];d.setEventedParent(null),d.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),t&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(t)}_clearSource(t){this.tileManagers[t].clearTiles()}_reloadSource(t){this.tileManagers[t].resume(),this.tileManagers[t].reload()}_updateSources(t){for(const o in this.tileManagers)this.tileManagers[o].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.tileManagers)this._reloadSource(t)}_updatePlacement(t,o,d,x,S=!1){let A=!1,R=!1;const F={};for(const V of this._order){const q=this._layers[V];if(q.type!=="symbol")continue;if(!F[q.source]){const ee=this.tileManagers[q.source];F[q.source]=ee.getRenderableIds(!0).map((ce=>ee.getTileByID(ce))).sort(((ce,_e)=>_e.tileID.overscaledZ-ce.tileID.overscaledZ||(ce.tileID.isLessThan(_e.tileID)?-1:1)))}const te=this.crossTileSymbolIndex.addLayer(q,F[q.source],t.center.lng);A=A||te}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((S=S||this._layerOrderChanged||d===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(O(),t.zoom))&&(this.pauseablePlacement=new Ko(t,this.map.terrain,this._order,S,o,d,x,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,F),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(O()),R=!0),A&&this.pauseablePlacement.placement.setStale()),R||A)for(const V of this._order){const q=this._layers[V];q.type==="symbol"&&this.placement.updateLayerOpacities(q,F[q.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(O())}_releaseSymbolFadeTiles(){for(const t in this.tileManagers)this.tileManagers[t].releaseSymbolFadeTiles()}getImages(t,o){return s._(this,void 0,void 0,(function*(){const d=yield this.imageManager.getImages(o.icons);this._updateTilesForChangedImages();const x=this.tileManagers[o.source];return x&&x.setDependencies(o.tileID.key,o.type,o.icons),d}))}getGlyphs(t,o){return s._(this,void 0,void 0,(function*(){const d=yield this.glyphManager.getGlyphs(o.stacks),x=this.tileManagers[o.source];return x&&x.setDependencies(o.tileID.key,o.type,[""]),d}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,o={}){this._checkLoaded(),t&&this._validate(s.C.glyphs,"glyphs",t,null,o)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}getDashes(t,o){return s._(this,void 0,void 0,(function*(){const d={};for(const[x,S]of Object.entries(o.dashes))d[x]=this.lineAtlas.getDash(S.dasharray,S.round);return d}))}addSprite(t,o,d={},x){this._checkLoaded();const S=[{id:t,url:o}],A=[...xe(this.stylesheet.sprite),...S];this._validate(s.C.sprite,"sprite",A,null,d)||(this.stylesheet.sprite=A,this._loadSprite(S,!0,x))}removeSprite(t){this._checkLoaded();const o=xe(this.stylesheet.sprite);if(o.find((d=>d.id===t))){if(this._spritesImagesIds[t])for(const d of this._spritesImagesIds[t])this.imageManager.removeImage(d),this._changedImages[d]=!0;o.splice(o.findIndex((d=>d.id===t)),1),this.stylesheet.sprite=o.length>0?o:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}else this.fire(new s.k(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return xe(this.stylesheet.sprite)}setSprite(t,o={},d){this._checkLoaded(),t&&this._validate(s.C.sprite,"sprite",t,null,o)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,d):(this._unloadSprite(),d&&d(null)))}destroy(){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null);for(const t in this.tileManagers){const o=this.tileManagers[t];o.setEventedParent(null),o.onRemove(this.map)}this.tileManagers={},this.imageManager&&(this.imageManager.setEventedParent(null),this.imageManager.destroy(),this._availableImages=[],this._spritesImagesIds={}),this.glyphManager&&this.glyphManager.destroy();for(const t in this._layers){const o=this._layers[t];o.setEventedParent(null),o.onRemove&&o.onRemove(this.map)}this._setInitialValues(),this.setEventedParent(null),this.dispatcher.unregisterMessageHandler("GG"),this.dispatcher.unregisterMessageHandler("GI"),this.dispatcher.unregisterMessageHandler("GDA"),this.dispatcher.remove(!0),this._listeners={},this._oneTimeListeners={}}}var Fc=s.aU([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class rl{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,o,d,x,S,A,R,F,V){this.context=t;let q=this.boundPaintVertexBuffers.length!==x.length;for(let te=0;!q&&te<x.length;te++)this.boundPaintVertexBuffers[te]!==x[te]&&(q=!0);!this.vao||this.boundProgram!==o||this.boundLayoutVertexBuffer!==d||q||this.boundIndexBuffer!==S||this.boundVertexOffset!==A||this.boundDynamicVertexBuffer!==R||this.boundDynamicVertexBuffer2!==F||this.boundDynamicVertexBuffer3!==V?this.freshBind(o,d,x,S,A,R,F,V):(t.bindVertexArray.set(this.vao),R&&R.bind(),S&&S.dynamicDraw&&S.bind(),F&&F.bind(),V&&V.bind())}freshBind(t,o,d,x,S,A,R,F){const V=t.numAttributes,q=this.context,te=q.gl;this.vao&&this.destroy(),this.vao=q.createVertexArray(),q.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=o,this.boundPaintVertexBuffers=d,this.boundIndexBuffer=x,this.boundVertexOffset=S,this.boundDynamicVertexBuffer=A,this.boundDynamicVertexBuffer2=R,this.boundDynamicVertexBuffer3=F,o.enableAttributes(te,t);for(const ee of d)ee.enableAttributes(te,t);A&&A.enableAttributes(te,t),R&&R.enableAttributes(te,t),F&&F.enableAttributes(te,t),o.bind(),o.setVertexAttribPointers(te,t,S);for(const ee of d)ee.bind(),ee.setVertexAttribPointers(te,t,S);A&&(A.bind(),A.setVertexAttribPointers(te,t,S)),x&&x.bind(),R&&(R.bind(),R.setVertexAttribPointers(te,t,S)),F&&(F.bind(),F.setVertexAttribPointers(te,t,S)),q.currentNumAttributes=V}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const ah=(w,t,o,d,x)=>({u_texture:0,u_ele_delta:w,u_fog_matrix:t,u_fog_color:o?o.properties.get("fog-color"):s.bp.white,u_fog_ground_blend:o?o.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:x?0:o?o.calculateFogBlendOpacity(d):0,u_horizon_color:o?o.properties.get("horizon-color"):s.bp.white,u_horizon_fog_blend:o?o.properties.get("horizon-fog-blend"):1,u_is_globe_mode:x?1:0}),us={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function pu(w){const t=[];for(let o=0;o<w.length;o++){if(w[o]===null)continue;const d=w[o].split(" ");t.push(d.pop())}return t}class qh{constructor(t,o,d,x,S,A,R,F,V=[]){const q=t.gl;this.program=q.createProgram();const te=pu(o.staticAttributes),ee=d?d.getBinderAttributes():[],ce=te.concat(ee),_e=Hn.prelude.staticUniforms?pu(Hn.prelude.staticUniforms):[],Ie=R.staticUniforms?pu(R.staticUniforms):[],Be=o.staticUniforms?pu(o.staticUniforms):[],ze=d?d.getBinderUniforms():[],Ze=_e.concat(Ie).concat(Be).concat(ze),rt=[];for(const Tt of Ze)rt.indexOf(Tt)<0&&rt.push(Tt);const qe=d?d.defines():[];Ti(q)&&qe.unshift("#version 300 es"),S&&qe.push("#define OVERDRAW_INSPECTOR;"),A&&qe.push("#define TERRAIN3D;"),F&&qe.push(F),V&&qe.push(...V);let tt=qe.concat(Hn.prelude.fragmentSource,R.fragmentSource,o.fragmentSource).join(`
`),lt=qe.concat(Hn.prelude.vertexSource,R.vertexSource,o.vertexSource).join(`
`);Ti(q)||(tt=(function(Tt){return Tt.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")})(tt),lt=(function(Tt){return Tt.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")})(lt));const Ke=q.createShader(q.FRAGMENT_SHADER);if(q.isContextLost())return void(this.failedToCreate=!0);if(q.shaderSource(Ke,tt),q.compileShader(Ke),!q.getShaderParameter(Ke,q.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${q.getShaderInfoLog(Ke)}`);q.attachShader(this.program,Ke);const dt=q.createShader(q.VERTEX_SHADER);if(q.isContextLost())return void(this.failedToCreate=!0);if(q.shaderSource(dt,lt),q.compileShader(dt),!q.getShaderParameter(dt,q.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${q.getShaderInfoLog(dt)}`);q.attachShader(this.program,dt),this.attributes={};const Rt={};this.numAttributes=ce.length;for(let Tt=0;Tt<this.numAttributes;Tt++)ce[Tt]&&(q.bindAttribLocation(this.program,Tt,ce[Tt]),this.attributes[ce[Tt]]=Tt);if(q.linkProgram(this.program),!q.getProgramParameter(this.program,q.LINK_STATUS))throw new Error(`Program failed to link: ${q.getProgramInfoLog(this.program)}`);q.deleteShader(dt),q.deleteShader(Ke);for(let Tt=0;Tt<rt.length;Tt++){const kt=rt[Tt];if(kt&&!Rt[kt]){const Ct=q.getUniformLocation(this.program,kt);Ct&&(Rt[kt]=Ct)}}this.fixedUniforms=x(t,Rt),this.terrainUniforms=((Tt,kt)=>({u_depth:new s.b_(Tt,kt.u_depth),u_terrain:new s.b_(Tt,kt.u_terrain),u_terrain_dim:new s.bq(Tt,kt.u_terrain_dim),u_terrain_matrix:new s.c0(Tt,kt.u_terrain_matrix),u_terrain_unpack:new s.c1(Tt,kt.u_terrain_unpack),u_terrain_exaggeration:new s.bq(Tt,kt.u_terrain_exaggeration)}))(t,Rt),this.projectionUniforms=((Tt,kt)=>({u_projection_matrix:new s.c0(Tt,kt.u_projection_matrix),u_projection_tile_mercator_coords:new s.c1(Tt,kt.u_projection_tile_mercator_coords),u_projection_clipping_plane:new s.c1(Tt,kt.u_projection_clipping_plane),u_projection_transition:new s.bq(Tt,kt.u_projection_transition),u_projection_fallback_matrix:new s.c0(Tt,kt.u_projection_fallback_matrix)}))(t,Rt),this.binderUniforms=d?d.getUniforms(t,Rt):[]}draw(t,o,d,x,S,A,R,F,V,q,te,ee,ce,_e,Ie,Be,ze,Ze,rt){const qe=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(d),t.setStencilMode(x),t.setColorMode(S),t.setCullFace(A),F){t.activeTexture.set(qe.TEXTURE2),qe.bindTexture(qe.TEXTURE_2D,F.depthTexture),t.activeTexture.set(qe.TEXTURE3),qe.bindTexture(qe.TEXTURE_2D,F.texture);for(const lt in this.terrainUniforms)this.terrainUniforms[lt].set(F[lt])}if(V)for(const lt in V)this.projectionUniforms[us[lt]].set(V[lt]);if(R)for(const lt in this.fixedUniforms)this.fixedUniforms[lt].set(R[lt]);Be&&Be.setUniforms(t,this.binderUniforms,_e,{zoom:Ie});let tt=0;switch(o){case qe.LINES:tt=2;break;case qe.TRIANGLES:tt=3;break;case qe.LINE_STRIP:tt=1}for(const lt of ce.get()){const Ke=lt.vaos||(lt.vaos={});(Ke[q]||(Ke[q]=new rl)).bind(t,this,te,Be?Be.getPaintVertexBuffers():[],ee,lt.vertexOffset,ze,Ze,rt),qe.drawElements(o,lt.primitiveLength*tt,qe.UNSIGNED_SHORT,lt.primitiveOffset*tt*2)}}}function Zh(w,t,o){const d=1/s.aN(o,1,t.transform.tileZoom),x=Math.pow(2,o.tileID.overscaledZ),S=o.tileSize*Math.pow(2,t.transform.tileZoom)/x,A=S*(o.tileID.canonical.x+o.tileID.wrap*x),R=S*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[d,w.fromScale,w.toScale],u_fade:w.t,u_pixel_coord_upper:[A>>16,R>>16],u_pixel_coord_lower:[65535&A,65535&R]}}const Ia=(w,t,o,d)=>{const x=w.style.light,S=x.properties.get("position"),A=[S.x,S.y,S.z],R=s.c4();x.properties.get("anchor")==="viewport"&&s.c5(R,w.transform.bearingInRadians),s.c6(A,A,R);const F=w.transform.transformLightDirection(A),V=x.properties.get("color");return{u_lightpos:A,u_lightpos_globe:F,u_lightintensity:x.properties.get("intensity"),u_lightcolor:[V.r,V.g,V.b],u_vertical_gradient:+t,u_opacity:o,u_fill_translate:d}},Qs=(w,t,o,d,x,S,A)=>s.e(Ia(w,t,o,d),Zh(S,w,A),{u_height_factor:-Math.pow(2,x.overscaledZ)/A.tileSize/8}),ha=(w,t,o,d)=>s.e(Zh(t,w,o),{u_fill_translate:d}),Qi=(w,t)=>({u_world:w,u_fill_translate:t}),tc=(w,t,o,d,x)=>s.e(ha(w,t,o,x),{u_world:d}),rc=(w,t,o,d,x)=>{const S=w.transform;let A,R,F=0;if(o.paint.get("circle-pitch-alignment")==="map"){const V=s.aN(t,1,S.zoom);A=!0,R=[V,V],F=V/(s.a5*Math.pow(2,t.tileID.overscaledZ))*2*Math.PI*x}else A=!1,R=S.pixelsToGLUnits;return{u_camera_to_center_distance:S.cameraToCenterDistance,u_scale_with_map:+(o.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+A,u_device_pixel_ratio:w.pixelRatio,u_extrude_scale:R,u_globe_extrude_scale:F,u_translate:d}},Os=w=>({u_pixel_extrude_scale:[1/w.width,1/w.height]}),ws=w=>({u_viewport_size:[w.width,w.height]}),Lc=(w,t=1)=>({u_color:w,u_overlay:0,u_overlay_scale:t}),Ts=(w,t,o,d)=>{const x=s.aN(w,1,t)/(s.a5*Math.pow(2,w.tileID.overscaledZ))*2*Math.PI*d;return{u_extrude_scale:s.aN(w,1,t),u_intensity:o,u_globe_extrude_scale:x}},mu=(w,t,o,d)=>{const x=s.N();s.c7(x,0,w.width,w.height,0,0,1);const S=w.context.gl;return{u_matrix:x,u_world:[S.drawingBufferWidth,S.drawingBufferHeight],u_image:o,u_color_ramp:d,u_opacity:t.paint.get("heatmap-opacity")}},zc=(w,t,o)=>{const d=o.paint.get("hillshade-accent-color");let x;switch(o.paint.get("hillshade-method")){case"basic":x=4;break;case"combined":x=1;break;case"igor":x=2;break;case"multidirectional":x=3;break;default:x=0}const S=o.getIlluminationProperties();for(let A=0;A<S.directionRadians.length;A++)o.paint.get("hillshade-illumination-anchor")==="viewport"&&(S.directionRadians[A]+=w.transform.bearingInRadians);return{u_image:0,u_latrange:Pf(0,t.tileID),u_exaggeration:o.paint.get("hillshade-exaggeration"),u_altitudes:S.altitudeRadians,u_azimuths:S.directionRadians,u_accent:d,u_method:x,u_highlights:S.highlightColor,u_shadows:S.shadowColor}},bo=(w,t)=>{const o=t.stride,d=s.N();return s.c7(d,0,s.a5,-s.a5,0,0,1),s.O(d,d,[0,-s.a5,0]),{u_matrix:d,u_image:1,u_dimension:[o,o],u_zoom:w.overscaledZ,u_unpack:t.getUnpackVector()}};function Pf(w,t){const o=Math.pow(2,t.canonical.z),d=t.canonical.y;return[new s.a9(0,d/o).toLngLat().lat,new s.a9(0,(d+1)/o).toLngLat().lat]}const Oc=(w,t,o=0)=>({u_image:0,u_unpack:t.getUnpackVector(),u_dimension:[t.stride,t.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:o,u_opacity:w.paint.get("color-relief-opacity")}),Bs=(w,t,o,d)=>{const x=w.transform;return{u_translation:gu(w,t,o),u_ratio:d/s.aN(t,1,x.zoom),u_device_pixel_ratio:w.pixelRatio,u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]]}},ih=(w,t,o,d,x)=>s.e(Bs(w,t,o,d),{u_image:0,u_image_height:x}),wo=(w,t,o,d,x)=>{const S=w.transform,A=Ss(t,S);return{u_translation:gu(w,t,o),u_texsize:t.imageAtlasTexture.size,u_ratio:d/s.aN(t,1,S.zoom),u_device_pixel_ratio:w.pixelRatio,u_image:0,u_scale:[A,x.fromScale,x.toScale],u_fade:x.t,u_units_to_pixels:[1/S.pixelsToGLUnits[0],1/S.pixelsToGLUnits[1]]}},Pa=(w,t,o,d,x)=>{const S=Ss(t,w.transform);return s.e(Bs(w,t,o,d),{u_tileratio:S,u_crossfade_from:x.fromScale,u_crossfade_to:x.toScale,u_image:0,u_mix:x.t,u_lineatlas_width:w.lineAtlas.width,u_lineatlas_height:w.lineAtlas.height})},eo=(w,t,o,d,x,S)=>{const A=Ss(t,w.transform);return s.e(Bs(w,t,o,d),{u_image:0,u_image_height:S,u_tileratio:A,u_crossfade_from:x.fromScale,u_crossfade_to:x.toScale,u_image_dash:1,u_mix:x.t,u_lineatlas_width:w.lineAtlas.width,u_lineatlas_height:w.lineAtlas.height})};function Ss(w,t){return 1/s.aN(w,1,t.tileZoom)}function gu(w,t,o){return s.aO(w.transform,t,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}const sh=(w,t,o,d,x)=>{return{u_tl_parent:w,u_scale_parent:t,u_buffer_scale:1,u_fade_t:o.mix,u_opacity:o.opacity*d.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:d.paint.get("raster-brightness-min"),u_brightness_high:d.paint.get("raster-brightness-max"),u_saturation_factor:(A=d.paint.get("raster-saturation"),A>0?1-1/(1.001-A):-A),u_contrast_factor:(S=d.paint.get("raster-contrast"),S>0?1/(1-S):1+S),u_spin_weights:oh(d.paint.get("raster-hue-rotate")),u_coords_top:[x[0].x,x[0].y,x[1].x,x[1].y],u_coords_bottom:[x[3].x,x[3].y,x[2].x,x[2].y]};var S,A};function oh(w){w*=Math.PI/180;const t=Math.sin(w),o=Math.cos(w);return[(2*o+1)/3,(-Math.sqrt(3)*t-o+1)/3,(Math.sqrt(3)*t-o+1)/3]}const _u=(w,t,o,d,x,S,A,R,F,V,q,te,ee)=>{const ce=A.transform;return{u_is_size_zoom_constant:+(w==="constant"||w==="source"),u_is_size_feature_constant:+(w==="constant"||w==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:ce.cameraToCenterDistance,u_pitch:ce.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:ce.width/ce.height,u_fade_change:A.options.fadeDuration?A.symbolFadeChange:1,u_label_plane_matrix:R,u_coord_matrix:F,u_is_text:+q,u_pitch_with_map:+d,u_is_along_line:x,u_is_variable_anchor:S,u_texsize:te,u_texture:0,u_translation:V,u_pitched_scale:ee}},xu=(w,t,o,d,x,S,A,R,F,V,q,te,ee,ce)=>{const _e=A.transform;return s.e(_u(w,t,o,d,x,S,A,R,F,V,q,te,ce),{u_gamma_scale:d?Math.cos(_e.pitch*Math.PI/180)*_e.cameraToCenterDistance:1,u_device_pixel_ratio:A.pixelRatio,u_is_halo:1})},es=(w,t,o,d,x,S,A,R,F,V,q,te,ee)=>s.e(xu(w,t,o,d,x,S,A,R,F,V,!0,q,0,ee),{u_texsize_icon:te,u_texture_icon:1}),nc=(w,t)=>({u_opacity:w,u_color:t}),Bc=(w,t,o,d,x)=>s.e((function(S,A,R,F){const V=R.imageManager.getPattern(S.from.toString()),q=R.imageManager.getPattern(S.to.toString()),{width:te,height:ee}=R.imageManager.getPixelSize(),ce=Math.pow(2,F.tileID.overscaledZ),_e=F.tileSize*Math.pow(2,R.transform.tileZoom)/ce,Ie=_e*(F.tileID.canonical.x+F.tileID.wrap*ce),Be=_e*F.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:V.tl,u_pattern_br_a:V.br,u_pattern_tl_b:q.tl,u_pattern_br_b:q.br,u_texsize:[te,ee],u_mix:A.t,u_pattern_size_a:V.displaySize,u_pattern_size_b:q.displaySize,u_scale_a:A.fromScale,u_scale_b:A.toScale,u_tile_units_to_pixels:1/s.aN(F,1,R.transform.tileZoom),u_pixel_coord_upper:[Ie>>16,Be>>16],u_pixel_coord_lower:[65535&Ie,65535&Be]}})(o,x,t,d),{u_opacity:w}),Nc=(w,t)=>{},lh={fillExtrusion:(w,t)=>({u_lightpos:new s.c2(w,t.u_lightpos),u_lightpos_globe:new s.c2(w,t.u_lightpos_globe),u_lightintensity:new s.bq(w,t.u_lightintensity),u_lightcolor:new s.c2(w,t.u_lightcolor),u_vertical_gradient:new s.bq(w,t.u_vertical_gradient),u_opacity:new s.bq(w,t.u_opacity),u_fill_translate:new s.c3(w,t.u_fill_translate)}),fillExtrusionPattern:(w,t)=>({u_lightpos:new s.c2(w,t.u_lightpos),u_lightpos_globe:new s.c2(w,t.u_lightpos_globe),u_lightintensity:new s.bq(w,t.u_lightintensity),u_lightcolor:new s.c2(w,t.u_lightcolor),u_vertical_gradient:new s.bq(w,t.u_vertical_gradient),u_height_factor:new s.bq(w,t.u_height_factor),u_opacity:new s.bq(w,t.u_opacity),u_fill_translate:new s.c3(w,t.u_fill_translate),u_image:new s.b_(w,t.u_image),u_texsize:new s.c3(w,t.u_texsize),u_pixel_coord_upper:new s.c3(w,t.u_pixel_coord_upper),u_pixel_coord_lower:new s.c3(w,t.u_pixel_coord_lower),u_scale:new s.c2(w,t.u_scale),u_fade:new s.bq(w,t.u_fade)}),fill:(w,t)=>({u_fill_translate:new s.c3(w,t.u_fill_translate)}),fillPattern:(w,t)=>({u_image:new s.b_(w,t.u_image),u_texsize:new s.c3(w,t.u_texsize),u_pixel_coord_upper:new s.c3(w,t.u_pixel_coord_upper),u_pixel_coord_lower:new s.c3(w,t.u_pixel_coord_lower),u_scale:new s.c2(w,t.u_scale),u_fade:new s.bq(w,t.u_fade),u_fill_translate:new s.c3(w,t.u_fill_translate)}),fillOutline:(w,t)=>({u_world:new s.c3(w,t.u_world),u_fill_translate:new s.c3(w,t.u_fill_translate)}),fillOutlinePattern:(w,t)=>({u_world:new s.c3(w,t.u_world),u_image:new s.b_(w,t.u_image),u_texsize:new s.c3(w,t.u_texsize),u_pixel_coord_upper:new s.c3(w,t.u_pixel_coord_upper),u_pixel_coord_lower:new s.c3(w,t.u_pixel_coord_lower),u_scale:new s.c2(w,t.u_scale),u_fade:new s.bq(w,t.u_fade),u_fill_translate:new s.c3(w,t.u_fill_translate)}),circle:(w,t)=>({u_camera_to_center_distance:new s.bq(w,t.u_camera_to_center_distance),u_scale_with_map:new s.b_(w,t.u_scale_with_map),u_pitch_with_map:new s.b_(w,t.u_pitch_with_map),u_extrude_scale:new s.c3(w,t.u_extrude_scale),u_device_pixel_ratio:new s.bq(w,t.u_device_pixel_ratio),u_globe_extrude_scale:new s.bq(w,t.u_globe_extrude_scale),u_translate:new s.c3(w,t.u_translate)}),collisionBox:(w,t)=>({u_pixel_extrude_scale:new s.c3(w,t.u_pixel_extrude_scale)}),collisionCircle:(w,t)=>({u_viewport_size:new s.c3(w,t.u_viewport_size)}),debug:(w,t)=>({u_color:new s.b$(w,t.u_color),u_overlay:new s.b_(w,t.u_overlay),u_overlay_scale:new s.bq(w,t.u_overlay_scale)}),depth:Nc,clippingMask:Nc,heatmap:(w,t)=>({u_extrude_scale:new s.bq(w,t.u_extrude_scale),u_intensity:new s.bq(w,t.u_intensity),u_globe_extrude_scale:new s.bq(w,t.u_globe_extrude_scale)}),heatmapTexture:(w,t)=>({u_matrix:new s.c0(w,t.u_matrix),u_world:new s.c3(w,t.u_world),u_image:new s.b_(w,t.u_image),u_color_ramp:new s.b_(w,t.u_color_ramp),u_opacity:new s.bq(w,t.u_opacity)}),hillshade:(w,t)=>({u_image:new s.b_(w,t.u_image),u_latrange:new s.c3(w,t.u_latrange),u_exaggeration:new s.bq(w,t.u_exaggeration),u_altitudes:new s.c9(w,t.u_altitudes),u_azimuths:new s.c9(w,t.u_azimuths),u_accent:new s.b$(w,t.u_accent),u_method:new s.b_(w,t.u_method),u_shadows:new s.c8(w,t.u_shadows),u_highlights:new s.c8(w,t.u_highlights)}),hillshadePrepare:(w,t)=>({u_matrix:new s.c0(w,t.u_matrix),u_image:new s.b_(w,t.u_image),u_dimension:new s.c3(w,t.u_dimension),u_zoom:new s.bq(w,t.u_zoom),u_unpack:new s.c1(w,t.u_unpack)}),colorRelief:(w,t)=>({u_image:new s.b_(w,t.u_image),u_unpack:new s.c1(w,t.u_unpack),u_dimension:new s.c3(w,t.u_dimension),u_elevation_stops:new s.b_(w,t.u_elevation_stops),u_color_stops:new s.b_(w,t.u_color_stops),u_color_ramp_size:new s.b_(w,t.u_color_ramp_size),u_opacity:new s.bq(w,t.u_opacity)}),line:(w,t)=>({u_translation:new s.c3(w,t.u_translation),u_ratio:new s.bq(w,t.u_ratio),u_device_pixel_ratio:new s.bq(w,t.u_device_pixel_ratio),u_units_to_pixels:new s.c3(w,t.u_units_to_pixels)}),lineGradient:(w,t)=>({u_translation:new s.c3(w,t.u_translation),u_ratio:new s.bq(w,t.u_ratio),u_device_pixel_ratio:new s.bq(w,t.u_device_pixel_ratio),u_units_to_pixels:new s.c3(w,t.u_units_to_pixels),u_image:new s.b_(w,t.u_image),u_image_height:new s.bq(w,t.u_image_height)}),linePattern:(w,t)=>({u_translation:new s.c3(w,t.u_translation),u_texsize:new s.c3(w,t.u_texsize),u_ratio:new s.bq(w,t.u_ratio),u_device_pixel_ratio:new s.bq(w,t.u_device_pixel_ratio),u_image:new s.b_(w,t.u_image),u_units_to_pixels:new s.c3(w,t.u_units_to_pixels),u_scale:new s.c2(w,t.u_scale),u_fade:new s.bq(w,t.u_fade)}),lineSDF:(w,t)=>({u_translation:new s.c3(w,t.u_translation),u_ratio:new s.bq(w,t.u_ratio),u_device_pixel_ratio:new s.bq(w,t.u_device_pixel_ratio),u_units_to_pixels:new s.c3(w,t.u_units_to_pixels),u_image:new s.b_(w,t.u_image),u_mix:new s.bq(w,t.u_mix),u_tileratio:new s.bq(w,t.u_tileratio),u_crossfade_from:new s.bq(w,t.u_crossfade_from),u_crossfade_to:new s.bq(w,t.u_crossfade_to),u_lineatlas_width:new s.bq(w,t.u_lineatlas_width),u_lineatlas_height:new s.bq(w,t.u_lineatlas_height)}),lineGradientSDF:(w,t)=>({u_translation:new s.c3(w,t.u_translation),u_ratio:new s.bq(w,t.u_ratio),u_device_pixel_ratio:new s.bq(w,t.u_device_pixel_ratio),u_units_to_pixels:new s.c3(w,t.u_units_to_pixels),u_image:new s.b_(w,t.u_image),u_image_height:new s.bq(w,t.u_image_height),u_tileratio:new s.bq(w,t.u_tileratio),u_crossfade_from:new s.bq(w,t.u_crossfade_from),u_crossfade_to:new s.bq(w,t.u_crossfade_to),u_image_dash:new s.b_(w,t.u_image_dash),u_mix:new s.bq(w,t.u_mix),u_lineatlas_width:new s.bq(w,t.u_lineatlas_width),u_lineatlas_height:new s.bq(w,t.u_lineatlas_height)}),raster:(w,t)=>({u_tl_parent:new s.c3(w,t.u_tl_parent),u_scale_parent:new s.bq(w,t.u_scale_parent),u_buffer_scale:new s.bq(w,t.u_buffer_scale),u_fade_t:new s.bq(w,t.u_fade_t),u_opacity:new s.bq(w,t.u_opacity),u_image0:new s.b_(w,t.u_image0),u_image1:new s.b_(w,t.u_image1),u_brightness_low:new s.bq(w,t.u_brightness_low),u_brightness_high:new s.bq(w,t.u_brightness_high),u_saturation_factor:new s.bq(w,t.u_saturation_factor),u_contrast_factor:new s.bq(w,t.u_contrast_factor),u_spin_weights:new s.c2(w,t.u_spin_weights),u_coords_top:new s.c1(w,t.u_coords_top),u_coords_bottom:new s.c1(w,t.u_coords_bottom)}),symbolIcon:(w,t)=>({u_is_size_zoom_constant:new s.b_(w,t.u_is_size_zoom_constant),u_is_size_feature_constant:new s.b_(w,t.u_is_size_feature_constant),u_size_t:new s.bq(w,t.u_size_t),u_size:new s.bq(w,t.u_size),u_camera_to_center_distance:new s.bq(w,t.u_camera_to_center_distance),u_pitch:new s.bq(w,t.u_pitch),u_rotate_symbol:new s.b_(w,t.u_rotate_symbol),u_aspect_ratio:new s.bq(w,t.u_aspect_ratio),u_fade_change:new s.bq(w,t.u_fade_change),u_label_plane_matrix:new s.c0(w,t.u_label_plane_matrix),u_coord_matrix:new s.c0(w,t.u_coord_matrix),u_is_text:new s.b_(w,t.u_is_text),u_pitch_with_map:new s.b_(w,t.u_pitch_with_map),u_is_along_line:new s.b_(w,t.u_is_along_line),u_is_variable_anchor:new s.b_(w,t.u_is_variable_anchor),u_texsize:new s.c3(w,t.u_texsize),u_texture:new s.b_(w,t.u_texture),u_translation:new s.c3(w,t.u_translation),u_pitched_scale:new s.bq(w,t.u_pitched_scale)}),symbolSDF:(w,t)=>({u_is_size_zoom_constant:new s.b_(w,t.u_is_size_zoom_constant),u_is_size_feature_constant:new s.b_(w,t.u_is_size_feature_constant),u_size_t:new s.bq(w,t.u_size_t),u_size:new s.bq(w,t.u_size),u_camera_to_center_distance:new s.bq(w,t.u_camera_to_center_distance),u_pitch:new s.bq(w,t.u_pitch),u_rotate_symbol:new s.b_(w,t.u_rotate_symbol),u_aspect_ratio:new s.bq(w,t.u_aspect_ratio),u_fade_change:new s.bq(w,t.u_fade_change),u_label_plane_matrix:new s.c0(w,t.u_label_plane_matrix),u_coord_matrix:new s.c0(w,t.u_coord_matrix),u_is_text:new s.b_(w,t.u_is_text),u_pitch_with_map:new s.b_(w,t.u_pitch_with_map),u_is_along_line:new s.b_(w,t.u_is_along_line),u_is_variable_anchor:new s.b_(w,t.u_is_variable_anchor),u_texsize:new s.c3(w,t.u_texsize),u_texture:new s.b_(w,t.u_texture),u_gamma_scale:new s.bq(w,t.u_gamma_scale),u_device_pixel_ratio:new s.bq(w,t.u_device_pixel_ratio),u_is_halo:new s.b_(w,t.u_is_halo),u_translation:new s.c3(w,t.u_translation),u_pitched_scale:new s.bq(w,t.u_pitched_scale)}),symbolTextAndIcon:(w,t)=>({u_is_size_zoom_constant:new s.b_(w,t.u_is_size_zoom_constant),u_is_size_feature_constant:new s.b_(w,t.u_is_size_feature_constant),u_size_t:new s.bq(w,t.u_size_t),u_size:new s.bq(w,t.u_size),u_camera_to_center_distance:new s.bq(w,t.u_camera_to_center_distance),u_pitch:new s.bq(w,t.u_pitch),u_rotate_symbol:new s.b_(w,t.u_rotate_symbol),u_aspect_ratio:new s.bq(w,t.u_aspect_ratio),u_fade_change:new s.bq(w,t.u_fade_change),u_label_plane_matrix:new s.c0(w,t.u_label_plane_matrix),u_coord_matrix:new s.c0(w,t.u_coord_matrix),u_is_text:new s.b_(w,t.u_is_text),u_pitch_with_map:new s.b_(w,t.u_pitch_with_map),u_is_along_line:new s.b_(w,t.u_is_along_line),u_is_variable_anchor:new s.b_(w,t.u_is_variable_anchor),u_texsize:new s.c3(w,t.u_texsize),u_texsize_icon:new s.c3(w,t.u_texsize_icon),u_texture:new s.b_(w,t.u_texture),u_texture_icon:new s.b_(w,t.u_texture_icon),u_gamma_scale:new s.bq(w,t.u_gamma_scale),u_device_pixel_ratio:new s.bq(w,t.u_device_pixel_ratio),u_is_halo:new s.b_(w,t.u_is_halo),u_translation:new s.c3(w,t.u_translation),u_pitched_scale:new s.bq(w,t.u_pitched_scale)}),background:(w,t)=>({u_opacity:new s.bq(w,t.u_opacity),u_color:new s.b$(w,t.u_color)}),backgroundPattern:(w,t)=>({u_opacity:new s.bq(w,t.u_opacity),u_image:new s.b_(w,t.u_image),u_pattern_tl_a:new s.c3(w,t.u_pattern_tl_a),u_pattern_br_a:new s.c3(w,t.u_pattern_br_a),u_pattern_tl_b:new s.c3(w,t.u_pattern_tl_b),u_pattern_br_b:new s.c3(w,t.u_pattern_br_b),u_texsize:new s.c3(w,t.u_texsize),u_mix:new s.bq(w,t.u_mix),u_pattern_size_a:new s.c3(w,t.u_pattern_size_a),u_pattern_size_b:new s.c3(w,t.u_pattern_size_b),u_scale_a:new s.bq(w,t.u_scale_a),u_scale_b:new s.bq(w,t.u_scale_b),u_pixel_coord_upper:new s.c3(w,t.u_pixel_coord_upper),u_pixel_coord_lower:new s.c3(w,t.u_pixel_coord_lower),u_tile_units_to_pixels:new s.bq(w,t.u_tile_units_to_pixels)}),terrain:(w,t)=>({u_texture:new s.b_(w,t.u_texture),u_ele_delta:new s.bq(w,t.u_ele_delta),u_fog_matrix:new s.c0(w,t.u_fog_matrix),u_fog_color:new s.b$(w,t.u_fog_color),u_fog_ground_blend:new s.bq(w,t.u_fog_ground_blend),u_fog_ground_blend_opacity:new s.bq(w,t.u_fog_ground_blend_opacity),u_horizon_color:new s.b$(w,t.u_horizon_color),u_horizon_fog_blend:new s.bq(w,t.u_horizon_fog_blend),u_is_globe_mode:new s.bq(w,t.u_is_globe_mode)}),terrainDepth:(w,t)=>({u_ele_delta:new s.bq(w,t.u_ele_delta)}),terrainCoords:(w,t)=>({u_texture:new s.b_(w,t.u_texture),u_terrain_coords_id:new s.bq(w,t.u_terrain_coords_id),u_ele_delta:new s.bq(w,t.u_ele_delta)}),projectionErrorMeasurement:(w,t)=>({u_input:new s.bq(w,t.u_input),u_output_expected:new s.bq(w,t.u_output_expected)}),atmosphere:(w,t)=>({u_sun_pos:new s.c2(w,t.u_sun_pos),u_atmosphere_blend:new s.bq(w,t.u_atmosphere_blend),u_globe_position:new s.c2(w,t.u_globe_position),u_globe_radius:new s.bq(w,t.u_globe_radius),u_inv_proj_matrix:new s.c0(w,t.u_inv_proj_matrix)}),sky:(w,t)=>({u_sky_color:new s.b$(w,t.u_sky_color),u_horizon_color:new s.b$(w,t.u_horizon_color),u_horizon:new s.c3(w,t.u_horizon),u_horizon_normal:new s.c3(w,t.u_horizon_normal),u_sky_horizon_blend:new s.bq(w,t.u_sky_horizon_blend),u_sky_blend:new s.bq(w,t.u_sky_blend)})};class Dl{constructor(t,o,d){this.context=t;const x=t.gl;this.buffer=x.createBuffer(),this.dynamicDraw=!!d,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),x.bufferData(x.ELEMENT_ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const o=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),o.bufferSubData(o.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const To={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Wh{constructor(t,o,d,x){this.length=o.length,this.attributes=d,this.itemSize=o.bytesPerElement,this.dynamicDraw=x,this.context=t;const S=t.gl;this.buffer=S.createBuffer(),t.bindVertexBuffer.set(this.buffer),S.bufferData(S.ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const o=this.context.gl;this.bind(),o.bufferSubData(o.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,o){for(let d=0;d<this.attributes.length;d++){const x=o.attributes[this.attributes[d].name];x!==void 0&&t.enableVertexAttribArray(x)}}setVertexAttribPointers(t,o,d){for(let x=0;x<this.attributes.length;x++){const S=this.attributes[x],A=o.attributes[S.name];A!==void 0&&t.vertexAttribPointer(A,S.components,t[To[S.type]],!1,this.itemSize,S.offset+this.itemSize*(d||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Fn{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Es extends Fn{getDefault(){return s.bp.transparent}set(t){const o=this.current;(t.r!==o.r||t.g!==o.g||t.b!==o.b||t.a!==o.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class nl extends Fn{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class yu extends Fn{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class ch extends Fn{getDefault(){return[!0,!0,!0,!0]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||t[2]!==o[2]||t[3]!==o[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class ac extends Fn{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class vu extends Fn{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class jc extends Fn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const o=this.current;(t.func!==o.func||t.ref!==o.ref||t.mask!==o.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class gi extends Fn{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||t[2]!==o[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class uh extends Fn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.STENCIL_TEST):o.disable(o.STENCIL_TEST),this.current=t,this.dirty=!1}}class ic extends Fn{getDefault(){return[0,1]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class hs extends Fn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.DEPTH_TEST):o.disable(o.DEPTH_TEST),this.current=t,this.dirty=!1}}class ts extends Fn{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class Li extends Fn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.BLEND):o.disable(o.BLEND),this.current=t,this.dirty=!1}}class to extends Fn{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class al extends Fn{getDefault(){return s.bp.transparent}set(t){const o=this.current;(t.r!==o.r||t.g!==o.g||t.b!==o.b||t.a!==o.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class il extends Fn{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class bu extends Fn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.CULL_FACE):o.disable(o.CULL_FACE),this.current=t,this.dirty=!1}}class Rl extends Fn{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class Ns extends Fn{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class Uc extends Fn{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class Vc extends Fn{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class dn extends Fn{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||t[2]!==o[2]||t[3]!==o[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class hh extends Fn{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindFramebuffer(o.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class As extends Fn{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindRenderbuffer(o.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class fh extends Fn{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindTexture(o.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class Q extends Fn{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindBuffer(o.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Qe extends Fn{getDefault(){return null}set(t){const o=this.gl;o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class ft extends Fn{getDefault(){return null}set(t){var o;if(t===this.current&&!this.dirty)return;const d=this.gl;Ti(d)?d.bindVertexArray(t):(o=d.getExtension("OES_vertex_array_object"))===null||o===void 0||o.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class Ht extends Fn{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class Nt extends Fn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class gr extends Fn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class Jr extends Fn{constructor(t,o){super(t),this.context=t,this.parent=o}getDefault(){return null}}class mn extends Jr{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class Vr extends Jr{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Hr extends Jr{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,t),this.current=t,this.dirty=!1}}const Pr="Framebuffer is not complete";class Wr{constructor(t,o,d,x,S){this.context=t,this.width=o,this.height=d;const A=t.gl,R=this.framebuffer=A.createFramebuffer();if(this.colorAttachment=new mn(t,R),x)this.depthAttachment=S?new Hr(t,R):new Vr(t,R);else if(S)throw new Error("Stencil cannot be set without depth");if(A.checkFramebufferStatus(A.FRAMEBUFFER)!==A.FRAMEBUFFER_COMPLETE)throw new Error(Pr)}destroy(){const t=this.context.gl,o=this.colorAttachment.get();if(o&&t.deleteTexture(o),this.depthAttachment){const d=this.depthAttachment.get();d&&t.deleteRenderbuffer(d)}t.deleteFramebuffer(this.framebuffer)}}class dr{constructor(t){var o,d;if(this.gl=t,this.clearColor=new Es(this),this.clearDepth=new nl(this),this.clearStencil=new yu(this),this.colorMask=new ch(this),this.depthMask=new ac(this),this.stencilMask=new vu(this),this.stencilFunc=new jc(this),this.stencilOp=new gi(this),this.stencilTest=new uh(this),this.depthRange=new ic(this),this.depthTest=new hs(this),this.depthFunc=new ts(this),this.blend=new Li(this),this.blendFunc=new to(this),this.blendColor=new al(this),this.blendEquation=new il(this),this.cullFace=new bu(this),this.cullFaceSide=new Rl(this),this.frontFace=new Ns(this),this.program=new Uc(this),this.activeTexture=new Vc(this),this.viewport=new dn(this),this.bindFramebuffer=new hh(this),this.bindRenderbuffer=new As(this),this.bindTexture=new fh(this),this.bindVertexBuffer=new Q(this),this.bindElementBuffer=new Qe(this),this.bindVertexArray=new ft(this),this.pixelStoreUnpack=new Ht(this),this.pixelStoreUnpackPremultiplyAlpha=new Nt(this),this.pixelStoreUnpackFlipY=new gr(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),Ti(t)){this.HALF_FLOAT=t.HALF_FLOAT;const x=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(o=t.RGBA16F)!==null&&o!==void 0?o:x?.RGBA16F_EXT,this.RGB16F=(d=t.RGB16F)!==null&&d!==void 0?d:x?.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const x=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=x?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,o){return new Dl(this,t,o)}createVertexBuffer(t,o,d){return new Wh(this,t,o,d)}createRenderbuffer(t,o,d){const x=this.gl,S=x.createRenderbuffer();return this.bindRenderbuffer.set(S),x.renderbufferStorage(x.RENDERBUFFER,t,o,d),this.bindRenderbuffer.set(null),S}createFramebuffer(t,o,d,x){return new Wr(this,t,o,d,x)}clear({color:t,depth:o,stencil:d}){const x=this.gl;let S=0;t&&(S|=x.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(S|=x.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),d!==void 0&&(S|=x.STENCIL_BUFFER_BIT,this.clearStencil.set(d),this.stencilMask.set(255)),x.clear(S)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){s.bR(t.blendFunction,qn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return Ti(this.gl)?this.gl.createVertexArray():(t=this.gl.getExtension("OES_vertex_array_object"))===null||t===void 0?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var o;return Ti(this.gl)?this.gl.deleteVertexArray(t):(o=this.gl.getExtension("OES_vertex_array_object"))===null||o===void 0?void 0:o.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}let Tr;function Dr(w,t,o,d,x){const S=w.context,A=w.transform,R=S.gl,F=w.useProgram("collisionBox"),V=[];let q=0,te=0;for(let ze=0;ze<d.length;ze++){const Ze=d[ze],rt=t.getTile(Ze).getBucket(o);if(!rt)continue;const qe=x?rt.textCollisionBox:rt.iconCollisionBox,tt=rt.collisionCircleArray;tt.length>0&&(V.push({circleArray:tt,circleOffset:te,coord:Ze}),q+=tt.length/4,te=q),qe&&F.draw(S,R.LINES,cn.disabled,Cn.disabled,w.colorModeForRenderPass(),_n.disabled,Os(w.transform),w.style.map.terrain&&w.style.map.terrain.getTerrainData(Ze),A.getProjectionData({overscaledTileID:Ze,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),o.id,qe.layoutVertexBuffer,qe.indexBuffer,qe.segments,null,w.transform.zoom,null,null,qe.collisionVertexBuffer)}if(!x||!V.length)return;const ee=w.useProgram("collisionCircle"),ce=new s.ca;ce.resize(4*q),ce._trim();let _e=0;for(const ze of V)for(let Ze=0;Ze<ze.circleArray.length/4;Ze++){const rt=4*Ze,qe=ze.circleArray[rt+0],tt=ze.circleArray[rt+1],lt=ze.circleArray[rt+2],Ke=ze.circleArray[rt+3];ce.emplace(_e++,qe,tt,lt,Ke,0),ce.emplace(_e++,qe,tt,lt,Ke,1),ce.emplace(_e++,qe,tt,lt,Ke,2),ce.emplace(_e++,qe,tt,lt,Ke,3)}(!Tr||Tr.length<2*q)&&(Tr=(function(ze){const Ze=2*ze,rt=new s.cc;rt.resize(Ze),rt._trim();for(let qe=0;qe<Ze;qe++){const tt=6*qe;rt.uint16[tt+0]=4*qe+0,rt.uint16[tt+1]=4*qe+1,rt.uint16[tt+2]=4*qe+2,rt.uint16[tt+3]=4*qe+2,rt.uint16[tt+4]=4*qe+3,rt.uint16[tt+5]=4*qe+0}return rt})(q));const Ie=S.createIndexBuffer(Tr,!0),Be=S.createVertexBuffer(ce,s.cb.members,!0);for(const ze of V){const Ze=ws(w.transform);ee.draw(S,R.TRIANGLES,cn.disabled,Cn.disabled,w.colorModeForRenderPass(),_n.disabled,Ze,w.style.map.terrain&&w.style.map.terrain.getTerrainData(ze.coord),null,o.id,Be,Ie,s.aX.simpleSegment(0,2*ze.circleOffset,ze.circleArray.length,ze.circleArray.length/2),null,w.transform.zoom,null,null,null)}Be.destroy(),Ie.destroy()}const zr=s.ar(new Float32Array(16));function Fr(w,t,o,d,x,S){const{horizontalAlign:A,verticalAlign:R}=s.aS(w);return new s.P((-(A-.5)*t/x+d[0])*S,(-(R-.5)*o/x+d[1])*S)}function sn(w,t,o,d,x,S){const A=t.tileAnchorPoint.add(new s.P(t.translation[0],t.translation[1]));if(t.pitchWithMap){let R=d.mult(S);o||(R=R.rotate(-x));const F=A.add(R);return _t(F.x,F.y,t.pitchedLabelPlaneMatrix,t.getElevation).point}if(o){const R=Zr(t.tileAnchorPoint.x+1,t.tileAnchorPoint.y,t).point.sub(w),F=Math.atan(R.y/R.x)+(R.x<0?Math.PI:0);return w.add(d.rotate(F))}return w.add(d)}function xr(w,t,o,d,x,S,A,R,F,V,q,te){const ee=w.text.placedSymbolArray,ce=w.text.dynamicLayoutVertexArray,_e=w.icon.dynamicLayoutVertexArray,Ie={};ce.clear();for(let Be=0;Be<ee.length;Be++){const ze=ee.get(Be),Ze=ze.hidden||!ze.crossTileID||w.allowVerticalPlacement&&!ze.placedOrientation?null:d[ze.crossTileID];if(Ze){const rt=new s.P(ze.anchorX,ze.anchorY),qe={getElevation:te,width:x.width,height:x.height,pitchedLabelPlaneMatrix:S,pitchWithMap:o,transform:x,tileAnchorPoint:rt,translation:V,unwrappedTileID:q},tt=o?Fs(rt.x,rt.y,qe):Zr(rt.x,rt.y,qe),lt=or(x.cameraToCenterDistance,tt.signedDistanceFromCamera);let Ke=s.aA(w.textSizeData,R,ze)*lt/s.aM;o&&(Ke*=w.tilePixelRatio/A);const{width:dt,height:Rt,anchor:Tt,textOffset:kt,textBoxScale:Ct}=Ze,ur=Fr(Tt,dt,Rt,kt,Ct,Ke),hr=x.getPitchedTextCorrection(rt.x+V[0],rt.y+V[1],q),tr=sn(tt.point,qe,t,ur,-x.bearingInRadians,hr),br=w.allowVerticalPlacement&&ze.placedOrientation===s.az.vertical?Math.PI/2:0;for(let fn=0;fn<ze.numGlyphs;fn++)s.aG(ce,tr,br);F&&ze.associatedIconIndex>=0&&(Ie[ze.associatedIconIndex]={shiftedAnchor:tr,angle:br})}else wi(ze.numGlyphs,ce)}if(F){_e.clear();const Be=w.icon.placedSymbolArray;for(let ze=0;ze<Be.length;ze++){const Ze=Be.get(ze);if(Ze.hidden)wi(Ze.numGlyphs,_e);else{const rt=Ie[ze];if(rt)for(let qe=0;qe<Ze.numGlyphs;qe++)s.aG(_e,rt.shiftedAnchor,rt.angle);else wi(Ze.numGlyphs,_e)}}w.icon.dynamicLayoutVertexBuffer.updateData(_e)}w.text.dynamicLayoutVertexBuffer.updateData(ce)}function Sr(w,t,o){return o.iconsInText&&t?"symbolTextAndIcon":w?"symbolSDF":"symbolIcon"}function nn(w,t,o,d,x,S,A,R,F,V,q,te,ee){const ce=w.context,_e=ce.gl,Ie=w.transform,Be=R==="map",ze=F==="map",Ze=R!=="viewport"&&o.layout.get("symbol-placement")!=="point",rt=Be&&!ze&&!Ze,qe=!o.layout.get("symbol-sort-key").isConstant();let tt=!1;const lt=w.getDepthModeForSublayer(0,cn.ReadOnly),Ke=o._unevaluatedLayout.hasValue("text-variable-anchor")||o._unevaluatedLayout.hasValue("text-variable-anchor-offset"),dt=[],Rt=Ie.getCircleRadiusCorrection();for(const Tt of d){const kt=t.getTile(Tt),Ct=kt.getBucket(o);if(!Ct)continue;const ur=x?Ct.text:Ct.icon;if(!ur||!ur.segments.get().length||!ur.hasVisibleVertices)continue;const hr=ur.programConfigurations.get(o.id),tr=x||Ct.sdfIcons,br=x?Ct.textSizeData:Ct.iconSizeData,fn=ze||Ie.pitch!==0,Yn=w.useProgram(Sr(tr,x,Ct),hr),va=s.ay(br,Ie.zoom),da=w.style.map.terrain&&w.style.map.terrain.getTerrainData(Tt);let ka,aa,Ga,Ca,Ni=[0,0],Xa=null;if(x)aa=kt.glyphAtlasTexture,Ga=_e.LINEAR,ka=kt.glyphAtlasTexture.size,Ct.iconsInText&&(Ni=kt.imageAtlasTexture.size,Xa=kt.imageAtlasTexture,Ca=fn||w.options.rotating||w.options.zooming||br.kind==="composite"||br.kind==="camera"?_e.LINEAR:_e.NEAREST);else{const ea=o.layout.get("icon-size").constantOr(0)!==1||Ct.iconsNeedLinear;aa=kt.imageAtlasTexture,Ga=tr||w.options.rotating||w.options.zooming||ea||fn?_e.LINEAR:_e.NEAREST,ka=kt.imageAtlasTexture.size}const Ya=s.aN(kt,1,w.transform.zoom),ji=jt(Be,w.transform,Ya),jl=s.N();s.aB(jl,ji);const Ul=Dt(ze,Be,w.transform,Ya),fl=s.aO(Ie,kt,S,A),Vs=Ie.getProjectionData({overscaledTileID:Tt,applyGlobeMatrix:!ee,applyTerrainMatrix:!0}),Iu=Ke&&Ct.hasTextData(),vh=o.layout.get("icon-text-fit")!=="none"&&Iu&&Ct.hasIconData();if(Ze){const ea=w.style.map.terrain?(ci,_i)=>w.style.map.terrain.getElevation(Tt,ci,_i):null,pa=o.layout.get("text-rotation-alignment")==="map";vr(Ct,w,x,ji,jl,ze,V,pa,Tt.toUnwrapped(),Ie.width,Ie.height,fl,ea)}const dl=x&&Ke||vh,Gs=Ze||dl?zr:ze?ji:w.transform.clipSpaceToPixelsMatrix,io=tr&&o.paint.get(x?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Do;Do=tr?Ct.iconsInText?es(br.kind,va,rt,ze,Ze,dl,w,Gs,Ul,fl,ka,Ni,Rt):xu(br.kind,va,rt,ze,Ze,dl,w,Gs,Ul,fl,x,ka,0,Rt):_u(br.kind,va,rt,ze,Ze,dl,w,Gs,Ul,fl,x,ka,Rt);const Ro={program:Yn,buffers:ur,uniformValues:Do,projectionData:Vs,atlasTexture:aa,atlasTextureIcon:Xa,atlasInterpolation:Ga,atlasInterpolationIcon:Ca,isSDF:tr,hasHalo:io};if(qe&&Ct.canOverlap){tt=!0;const ea=ur.segments.get();for(const pa of ea)dt.push({segments:new s.aX([pa]),sortKey:pa.sortKey,state:Ro,terrainData:da})}else dt.push({segments:ur.segments,sortKey:0,state:Ro,terrainData:da})}tt&&dt.sort(((Tt,kt)=>Tt.sortKey-kt.sortKey));for(const Tt of dt){const kt=Tt.state;if(ce.activeTexture.set(_e.TEXTURE0),kt.atlasTexture.bind(kt.atlasInterpolation,_e.CLAMP_TO_EDGE),kt.atlasTextureIcon&&(ce.activeTexture.set(_e.TEXTURE1),kt.atlasTextureIcon&&kt.atlasTextureIcon.bind(kt.atlasInterpolationIcon,_e.CLAMP_TO_EDGE)),kt.isSDF){const Ct=kt.uniformValues;kt.hasHalo&&(Ct.u_is_halo=1,qr(kt.buffers,Tt.segments,o,w,kt.program,lt,q,te,Ct,kt.projectionData,Tt.terrainData)),Ct.u_is_halo=0}qr(kt.buffers,Tt.segments,o,w,kt.program,lt,q,te,kt.uniformValues,kt.projectionData,Tt.terrainData)}}function qr(w,t,o,d,x,S,A,R,F,V,q){const te=d.context;x.draw(te,te.gl.TRIANGLES,S,A,R,_n.backCCW,F,q,V,o.id,w.layoutVertexBuffer,w.indexBuffer,t,o.paint,d.transform.zoom,w.programConfigurations.get(o.id),w.dynamicLayoutVertexBuffer,w.opacityVertexBuffer)}function un(w,t,o,d,x){const S=w.context,A=S.gl,R=Cn.disabled,F=new qn([A.ONE,A.ONE],s.bp.transparent,[!0,!0,!0,!0]),V=t.getBucket(o);if(!V)return;const q=d.key;let te=o.heatmapFbos.get(q);te||(te=Br(S,t.tileSize,t.tileSize),o.heatmapFbos.set(q,te)),S.bindFramebuffer.set(te.framebuffer),S.viewport.set([0,0,t.tileSize,t.tileSize]),S.clear({color:s.bp.transparent});const ee=V.programConfigurations.get(o.id),ce=w.useProgram("heatmap",ee,!x),_e=w.transform.getProjectionData({overscaledTileID:t.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Ie=w.style.map.terrain.getTerrainData(d);ce.draw(S,A.TRIANGLES,cn.disabled,R,F,_n.disabled,Ts(t,w.transform.zoom,o.paint.get("heatmap-intensity"),1),Ie,_e,o.id,V.layoutVertexBuffer,V.indexBuffer,V.segments,o.paint,w.transform.zoom,ee)}function Er(w,t,o,d,x){const S=w.context,A=S.gl,R=w.transform;S.setColorMode(w.colorModeForRenderPass());const F=Nr(S,t),V=o.key,q=t.heatmapFbos.get(V);if(!q)return;S.activeTexture.set(A.TEXTURE0),A.bindTexture(A.TEXTURE_2D,q.colorAttachment.get()),S.activeTexture.set(A.TEXTURE1),F.bind(A.LINEAR,A.CLAMP_TO_EDGE);const te=R.getProjectionData({overscaledTileID:o,applyTerrainMatrix:x,applyGlobeMatrix:!d});w.useProgram("heatmapTexture").draw(S,A.TRIANGLES,cn.disabled,Cn.disabled,w.colorModeForRenderPass(),_n.disabled,mu(w,t,0,1),null,te,t.id,w.rasterBoundsBuffer,w.quadTriangleIndexBuffer,w.rasterBoundsSegments,t.paint,R.zoom),q.destroy(),t.heatmapFbos.delete(V)}function Br(w,t,o){var d,x;const S=w.gl,A=S.createTexture();S.bindTexture(S.TEXTURE_2D,A),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_S,S.CLAMP_TO_EDGE),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_T,S.CLAMP_TO_EDGE),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_MIN_FILTER,S.LINEAR),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_MAG_FILTER,S.LINEAR);const R=(d=w.HALF_FLOAT)!==null&&d!==void 0?d:S.UNSIGNED_BYTE,F=(x=w.RGBA16F)!==null&&x!==void 0?x:S.RGBA;S.texImage2D(S.TEXTURE_2D,0,F,t,o,0,S.RGBA,R,null);const V=w.createFramebuffer(t,o,!1,!1);return V.colorAttachment.set(A),V}function Nr(w,t){return t.colorRampTexture||(t.colorRampTexture=new s.T(w,t.colorRamp,w.gl.RGBA)),t.colorRampTexture}function Wn(w,t,o,d,x,S,A,R){let F=256;if(x.stepInterpolant){const V=t.getSource().maxzoom,q=A.canonical.z===V?Math.ceil(1<<w.transform.maxZoom-A.canonical.z):1;F=s.an(s.ce(S.maxLineLength/s.a5*1024*q),256,o.maxTextureSize)}return R.gradient=s.cf({expression:x.gradientExpression(),evaluationKey:"lineProgress",resolution:F,image:R.gradient||void 0,clips:S.lineClipsArray}),R.texture?R.texture.update(R.gradient):R.texture=new s.T(o,R.gradient,d.RGBA),R.version=x.gradientVersion,R.texture}function Gr(w,t,o,d,x){w.activeTexture.set(t.TEXTURE0),o.imageAtlasTexture.bind(t.LINEAR,t.CLAMP_TO_EDGE),d.updatePaintBuffers(x)}function gn(w,t,o,d,x,S){(x||w.lineAtlas.dirty)&&(t.activeTexture.set(o.TEXTURE0),w.lineAtlas.bind(t)),d.updatePaintBuffers(S)}function fa(w,t,o,d,x,S,A){const R=S.gradients[x.id];let F=R.texture;x.gradientVersion!==R.version&&(F=Wn(w,t,o,d,x,S,A,R)),o.activeTexture.set(d.TEXTURE0),F.bind(x.stepInterpolant?d.NEAREST:d.LINEAR,d.CLAMP_TO_EDGE)}function Za(w,t,o,d,x,S,A,R,F){const V=S.gradients[x.id];let q=V.texture;x.gradientVersion!==V.version&&(q=Wn(w,t,o,d,x,S,A,V)),o.activeTexture.set(d.TEXTURE0),q.bind(x.stepInterpolant?d.NEAREST:d.LINEAR,d.CLAMP_TO_EDGE),o.activeTexture.set(d.TEXTURE1),w.lineAtlas.bind(o),R.updatePaintBuffers(F)}function js(w,t,o,d,x){if(!o||!d||!d.imageAtlas)return;const S=d.imageAtlas.patternPositions;let A=S[o.to.toString()],R=S[o.from.toString()];if(!A&&R&&(A=R),!R&&A&&(R=A),!A||!R){const F=x.getPaintProperty(t);A=S[F],R=S[F]}A&&R&&w.setConstantPatternPositions(A,R)}function fs(w,t,o,d,x,S,A,R){const F=w.context.gl,V="fill-pattern",q=o.paint.get(V),te=q&&q.constantOr(1),ee=o.getCrossfadeParameters();let ce,_e,Ie,Be,ze;const Ze=w.transform,rt=o.paint.get("fill-translate"),qe=o.paint.get("fill-translate-anchor");A?(_e=te&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ce=F.LINES):(_e=te?"fillPattern":"fill",ce=F.TRIANGLES);const tt=q.constantOr(null);for(const lt of d){const Ke=t.getTile(lt);if(te&&!Ke.patternsLoaded())continue;const dt=Ke.getBucket(o);if(!dt)continue;const Rt=dt.programConfigurations.get(o.id),Tt=w.useProgram(_e,Rt),kt=w.style.map.terrain&&w.style.map.terrain.getTerrainData(lt);te&&(w.context.activeTexture.set(F.TEXTURE0),Ke.imageAtlasTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),Rt.updatePaintBuffers(ee)),js(Rt,V,tt,Ke,o);const Ct=Ze.getProjectionData({overscaledTileID:lt,applyGlobeMatrix:!R,applyTerrainMatrix:!0}),ur=s.aO(Ze,Ke,rt,qe);if(A){Be=dt.indexBuffer2,ze=dt.segments2;const tr=[F.drawingBufferWidth,F.drawingBufferHeight];Ie=_e==="fillOutlinePattern"&&te?tc(w,ee,Ke,tr,ur):Qi(tr,ur)}else Be=dt.indexBuffer,ze=dt.segments,Ie=te?ha(w,ee,Ke,ur):{u_fill_translate:ur};const hr=w.stencilModeForClipping(lt);Tt.draw(w.context,ce,x,hr,S,_n.backCCW,Ie,kt,Ct,o.id,dt.layoutVertexBuffer,Be,ze,o.paint,w.transform.zoom,Rt)}}function zi(w,t,o,d,x,S,A,R){const F=w.context,V=F.gl,q="fill-extrusion-pattern",te=o.paint.get(q),ee=te.constantOr(1),ce=o.getCrossfadeParameters(),_e=o.paint.get("fill-extrusion-opacity"),Ie=te.constantOr(null),Be=w.transform;for(const ze of d){const Ze=t.getTile(ze),rt=Ze.getBucket(o);if(!rt)continue;const qe=w.style.map.terrain&&w.style.map.terrain.getTerrainData(ze),tt=rt.programConfigurations.get(o.id),lt=w.useProgram(ee?"fillExtrusionPattern":"fillExtrusion",tt);ee&&(w.context.activeTexture.set(V.TEXTURE0),Ze.imageAtlasTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE),tt.updatePaintBuffers(ce));const Ke=Be.getProjectionData({overscaledTileID:ze,applyGlobeMatrix:!R,applyTerrainMatrix:!0});js(tt,q,Ie,Ze,o);const dt=s.aO(Be,Ze,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),Rt=o.paint.get("fill-extrusion-vertical-gradient"),Tt=ee?Qs(w,Rt,_e,dt,ze,ce,Ze):Ia(w,Rt,_e,dt);lt.draw(F,F.gl.TRIANGLES,x,S,A,_n.backCCW,Tt,qe,Ke,o.id,rt.layoutVertexBuffer,rt.indexBuffer,rt.segments,o.paint,w.transform.zoom,tt,w.style.map.terrain&&rt.centroidVertexBuffer)}}function Oi(w,t,o,d,x,S,A,R,F){var V;const q=w.style.projection,te=w.context,ee=w.transform,ce=te.gl,_e=[`#define NUM_ILLUMINATION_SOURCES ${o.paint.get("hillshade-highlight-color").values.length}`],Ie=w.useProgram("hillshade",null,!1,_e),Be=!w.options.moving;for(const ze of d){const Ze=t.getTile(ze),rt=Ze.fbo;if(!rt)continue;const qe=q.getMeshFromTileID(te,ze.canonical,R,!0,"raster"),tt=(V=w.style.map.terrain)===null||V===void 0?void 0:V.getTerrainData(ze);te.activeTexture.set(ce.TEXTURE0),ce.bindTexture(ce.TEXTURE_2D,rt.colorAttachment.get());const lt=ee.getProjectionData({overscaledTileID:ze,aligned:Be,applyGlobeMatrix:!F,applyTerrainMatrix:!0});Ie.draw(te,ce.TRIANGLES,S,x[ze.overscaledZ],A,_n.backCCW,zc(w,Ze,o),tt,lt,o.id,qe.vertexBuffer,qe.indexBuffer,qe.segments)}}function ro(w,t,o,d,x,S,A,R,F){var V;const q=w.style.projection,te=w.context,ee=w.transform,ce=te.gl,_e=w.useProgram("colorRelief"),Ie=!w.options.moving;let Be=!0,ze=0;for(const Ze of d){const rt=t.getTile(Ze),qe=rt.dem;if(Be){const Tt=ce.getParameter(ce.MAX_TEXTURE_SIZE),{elevationTexture:kt,colorTexture:Ct}=o.getColorRampTextures(te,Tt,qe.getUnpackVector());te.activeTexture.set(ce.TEXTURE1),kt.bind(ce.NEAREST,ce.CLAMP_TO_EDGE),te.activeTexture.set(ce.TEXTURE4),Ct.bind(ce.LINEAR,ce.CLAMP_TO_EDGE),Be=!1,ze=kt.size[0]}if(!qe||!qe.data)continue;const tt=qe.stride,lt=qe.getPixels();if(te.activeTexture.set(ce.TEXTURE0),te.pixelStoreUnpackPremultiplyAlpha.set(!1),rt.demTexture=rt.demTexture||w.getTileTexture(tt),rt.demTexture){const Tt=rt.demTexture;Tt.update(lt,{premultiply:!1}),Tt.bind(ce.LINEAR,ce.CLAMP_TO_EDGE)}else rt.demTexture=new s.T(te,lt,ce.RGBA,{premultiply:!1}),rt.demTexture.bind(ce.LINEAR,ce.CLAMP_TO_EDGE);const Ke=q.getMeshFromTileID(te,Ze.canonical,R,!0,"raster"),dt=(V=w.style.map.terrain)===null||V===void 0?void 0:V.getTerrainData(Ze),Rt=ee.getProjectionData({overscaledTileID:Ze,aligned:Ie,applyGlobeMatrix:!F,applyTerrainMatrix:!0});_e.draw(te,ce.TRIANGLES,S,x[Ze.overscaledZ],A,_n.backCCW,Oc(o,rt.dem,ze),dt,Rt,o.id,Ke.vertexBuffer,Ke.indexBuffer,Ke.segments)}}const no=[new s.P(0,0),new s.P(s.a5,0),new s.P(s.a5,s.a5),new s.P(0,s.a5)];function ds(w,t,o,d,x,S,A,R,F=!1,V=!1){const q=d[d.length-1].overscaledZ,te=w.context,ee=te.gl,ce=w.useProgram("raster"),_e=w.transform,Ie=w.style.projection,Be=w.colorModeForRenderPass(),ze=!w.options.moving,Ze=o.paint.get("raster-opacity"),rt=o.paint.get("raster-resampling"),qe=o.paint.get("raster-fade-duration"),tt=!!w.style.map.terrain;for(const lt of d){const Ke=w.getDepthModeForSublayer(lt.overscaledZ-q,Ze===1?cn.ReadWrite:cn.ReadOnly,ee.LESS),dt=t.getTile(lt),Rt=rt==="nearest"?ee.NEAREST:ee.LINEAR;te.activeTexture.set(ee.TEXTURE0),dt.texture.bind(Rt,ee.CLAMP_TO_EDGE,ee.LINEAR_MIPMAP_NEAREST),te.activeTexture.set(ee.TEXTURE1);const{parentTile:Tt,parentScaleBy:kt,parentTopLeft:Ct,fadeValues:ur}=ri(dt,t,qe,tt);dt.fadeOpacity=ur.tileOpacity,Tt?(Tt.fadeOpacity=ur.parentTileOpacity,Tt.texture.bind(Rt,ee.CLAMP_TO_EDGE,ee.LINEAR_MIPMAP_NEAREST)):dt.texture.bind(Rt,ee.CLAMP_TO_EDGE,ee.LINEAR_MIPMAP_NEAREST),dt.texture.useMipmap&&te.extTextureFilterAnisotropic&&w.transform.pitch>20&&ee.texParameterf(ee.TEXTURE_2D,te.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,te.extTextureFilterAnisotropicMax);const hr=w.style.map.terrain&&w.style.map.terrain.getTerrainData(lt),tr=_e.getProjectionData({overscaledTileID:lt,aligned:ze,applyGlobeMatrix:!V,applyTerrainMatrix:!0}),br=sh(Ct,kt,ur.fadeMix,o,R),fn=Ie.getMeshFromTileID(te,lt.canonical,S,A,"raster");ce.draw(te,ee.TRIANGLES,Ke,x?x[lt.overscaledZ]:Cn.disabled,Be,F?_n.frontCCW:_n.backCCW,br,hr,tr,o.id,fn.vertexBuffer,fn.indexBuffer,fn.segments)}}function ri(w,t,o,d){const x={parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:{tileOpacity:1,parentTileOpacity:1,fadeMix:{opacity:1,mix:0}}};if(o===0||d)return x;if(w.fadingParentID){const S=t.getLoadedTile(w.fadingParentID);if(!S)return x;const A=Math.pow(2,S.tileID.overscaledZ-w.tileID.overscaledZ),R=[w.tileID.canonical.x*A%1,w.tileID.canonical.y*A%1],F=(function(V,q,te){const ee=O(),ce=(ee-q.timeAdded)/te,_e=V.fadingDirection===vt.Incoming,Ie=s.an((ee-V.timeAdded)/te,0,1),Be=s.an(1-ce,0,1),ze=_e?Ie:Be;return{tileOpacity:ze,parentTileOpacity:_e?Be:Ie,fadeMix:{opacity:1,mix:1-ze}}})(w,S,o);return{parentTile:S,parentScaleBy:A,parentTopLeft:R,fadeValues:F}}if(w.selfFading){const S=(function(A,R){const F=(O()-A.timeAdded)/R,V=s.an(F,0,1);return{tileOpacity:V,fadeMix:{opacity:V,mix:0}}})(w,o);return{parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:S}}return x}const Bi=new s.bp(1,0,0,1),Si=new s.bp(0,1,0,1),ks=new s.bp(0,0,1,1),Il=new s.bp(1,0,1,1),Cs=new s.bp(0,1,1,1);function sc(w,t,o,d){Wa(w,0,t+o/2,w.transform.width,o,d)}function So(w,t,o,d){Wa(w,t-o/2,0,o,w.transform.height,d)}function Wa(w,t,o,d,x,S){const A=w.context,R=A.gl;R.enable(R.SCISSOR_TEST),R.scissor(t*w.pixelRatio,o*w.pixelRatio,d*w.pixelRatio,x*w.pixelRatio),A.clear({color:S}),R.disable(R.SCISSOR_TEST)}function wu(w,t,o){const d=w.context,x=d.gl,S=w.useProgram("debug"),A=cn.disabled,R=Cn.disabled,F=w.colorModeForRenderPass(),V="$debug",q=w.style.map.terrain&&w.style.map.terrain.getTerrainData(o);d.activeTexture.set(x.TEXTURE0);const te=t.getTileByID(o.key).latestRawTileData,ee=Math.floor((te&&te.byteLength||0)/1024),ce=t.getTile(o).tileSize,_e=512/Math.min(ce,512)*(o.overscaledZ/w.transform.zoom)*.5;let Ie=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(Ie+=` => ${o.overscaledZ}`),(function(ze,Ze){ze.initDebugOverlayCanvas();const rt=ze.debugOverlayCanvas,qe=ze.context.gl,tt=ze.debugOverlayCanvas.getContext("2d");tt.clearRect(0,0,rt.width,rt.height),tt.shadowColor="white",tt.shadowBlur=2,tt.lineWidth=1.5,tt.strokeStyle="white",tt.textBaseline="top",tt.font="bold 36px Open Sans, sans-serif",tt.fillText(Ze,5,5),tt.strokeText(Ze,5,5),ze.debugOverlayTexture.update(rt),ze.debugOverlayTexture.bind(qe.LINEAR,qe.CLAMP_TO_EDGE)})(w,`${Ie} ${ee}kB`);const Be=w.transform.getProjectionData({overscaledTileID:o,applyGlobeMatrix:!0,applyTerrainMatrix:!0});S.draw(d,x.TRIANGLES,A,R,qn.alphaBlended,_n.disabled,Lc(s.bp.transparent,_e),null,Be,V,w.debugBuffer,w.quadTriangleIndexBuffer,w.debugSegments),S.draw(d,x.LINE_STRIP,A,R,F,_n.disabled,Lc(s.bp.red),q,Be,V,w.debugBuffer,w.tileBorderIndexBuffer,w.debugSegments)}function dh(w,t,o,d){const{isRenderingGlobe:x}=d,S=w.context,A=S.gl,R=w.transform,F=w.colorModeForRenderPass(),V=w.getDepthModeFor3D(),q=w.useProgram("terrain");S.bindFramebuffer.set(null),S.viewport.set([0,0,w.width,w.height]);for(const te of o){const ee=t.getTerrainMesh(te.tileID),ce=w.renderToTexture.getTexture(te),_e=t.getTerrainData(te.tileID);S.activeTexture.set(A.TEXTURE0),A.bindTexture(A.TEXTURE_2D,ce.texture);const Ie=t.getMeshFrameDelta(R.zoom),Be=R.calculateFogMatrix(te.tileID.toUnwrapped()),ze=ah(Ie,Be,w.style.sky,R.pitch,x),Ze=R.getProjectionData({overscaledTileID:te.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});q.draw(S,A.TRIANGLES,V,Cn.disabled,F,_n.backCCW,ze,_e,Ze,"terrain",ee.vertexBuffer,ee.indexBuffer,ee.segments)}}function $h(w,t){if(!t.mesh){const o=new s.aW;o.emplaceBack(-1,-1),o.emplaceBack(1,-1),o.emplaceBack(1,1),o.emplaceBack(-1,1);const d=new s.aY;d.emplaceBack(0,1,2),d.emplaceBack(0,2,3),t.mesh=new Jn(w.createVertexBuffer(o,os.members),w.createIndexBuffer(d),s.aX.simpleSegment(0,0,o.length,d.length))}return t.mesh}class Tu{constructor(t,o){this.context=new dr(t),this.transform=o,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:s.ar(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Me.maxOverzooming+Me.maxUnderzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ma}resize(t,o,d){if(this.width=Math.floor(t*d),this.height=Math.floor(o*d),this.pixelRatio=d,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const x of this.style._order)this.style._layers[x].resize()}setup(){const t=this.context,o=new s.aW;o.emplaceBack(0,0),o.emplaceBack(s.a5,0),o.emplaceBack(0,s.a5),o.emplaceBack(s.a5,s.a5),this.tileExtentBuffer=t.createVertexBuffer(o,os.members),this.tileExtentSegments=s.aX.simpleSegment(0,0,4,2);const d=new s.aW;d.emplaceBack(0,0),d.emplaceBack(s.a5,0),d.emplaceBack(0,s.a5),d.emplaceBack(s.a5,s.a5),this.debugBuffer=t.createVertexBuffer(d,os.members),this.debugSegments=s.aX.simpleSegment(0,0,4,5);const x=new s.ch;x.emplaceBack(0,0,0,0),x.emplaceBack(s.a5,0,s.a5,0),x.emplaceBack(0,s.a5,0,s.a5),x.emplaceBack(s.a5,s.a5,s.a5,s.a5),this.rasterBoundsBuffer=t.createVertexBuffer(x,Fc.members),this.rasterBoundsSegments=s.aX.simpleSegment(0,0,4,2);const S=new s.aW;S.emplaceBack(0,0),S.emplaceBack(s.a5,0),S.emplaceBack(0,s.a5),S.emplaceBack(s.a5,s.a5),this.rasterBoundsBufferPosOnly=t.createVertexBuffer(S,os.members),this.rasterBoundsSegmentsPosOnly=s.aX.simpleSegment(0,0,4,5);const A=new s.aW;A.emplaceBack(0,0),A.emplaceBack(1,0),A.emplaceBack(0,1),A.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(A,os.members),this.viewportSegments=s.aX.simpleSegment(0,0,4,2);const R=new s.ci;R.emplaceBack(0),R.emplaceBack(1),R.emplaceBack(3),R.emplaceBack(2),R.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(R);const F=new s.aY;F.emplaceBack(1,0,2),F.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(F);const V=this.context.gl;this.stencilClearMode=new Cn({func:V.ALWAYS,mask:0},0,255,V.ZERO,V.ZERO,V.ZERO),this.tileExtentMesh=new Jn(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const t=this.context,o=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const d=s.N();s.c7(d,0,this.width,this.height,0,0,1),s.Q(d,d,[o.drawingBufferWidth,o.drawingBufferHeight,0]);const x={mainMatrix:d,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:d};this.useProgram("clippingMask",null,!0).draw(t,o.TRIANGLES,cn.disabled,this.stencilClearMode,qn.disabled,_n.disabled,null,null,x,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,o,d){if(this.currentStencilSource===t.source||!t.isTileClipped()||!o||!o.length)return;this.currentStencilSource=t.source,this.nextStencilID+o.length>256&&this.clearStencil();const x=this.context;x.setColorMode(qn.disabled),x.setDepthMode(cn.disabled);const S={};for(const A of o)S[A.key]=this.nextStencilID++;this._renderTileMasks(S,o,d,!0),this._renderTileMasks(S,o,d,!1),this._tileClippingMaskIDs=S}_renderTileMasks(t,o,d,x){const S=this.context,A=S.gl,R=this.style.projection,F=this.transform,V=this.useProgram("clippingMask");for(const q of o){const te=t[q.key],ee=this.style.map.terrain&&this.style.map.terrain.getTerrainData(q),ce=R.getMeshFromTileID(this.context,q.canonical,x,!0,"stencil"),_e=F.getProjectionData({overscaledTileID:q,applyGlobeMatrix:!d,applyTerrainMatrix:!0});V.draw(S,A.TRIANGLES,cn.disabled,new Cn({func:A.ALWAYS,mask:0},te,255,A.KEEP,A.KEEP,A.REPLACE),qn.disabled,d?_n.disabled:_n.backCCW,null,ee,_e,"$clipping",ce.vertexBuffer,ce.indexBuffer,ce.segments)}}_renderTilesDepthBuffer(){const t=this.context,o=t.gl,d=this.style.projection,x=this.transform,S=this.useProgram("depth"),A=this.getDepthModeFor3D(),R=tn(x,{tileSize:x.tileSize});for(const F of R){const V=this.style.map.terrain&&this.style.map.terrain.getTerrainData(F),q=d.getMeshFromTileID(this.context,F.canonical,!0,!0,"raster"),te=x.getProjectionData({overscaledTileID:F,applyGlobeMatrix:!0,applyTerrainMatrix:!0});S.draw(t,o.TRIANGLES,A,Cn.disabled,qn.disabled,_n.backCCW,null,V,te,"$clipping",q.vertexBuffer,q.indexBuffer,q.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,o=this.context.gl;return new Cn({func:o.NOTEQUAL,mask:255},t,255,o.KEEP,o.KEEP,o.REPLACE)}stencilModeForClipping(t){const o=this.context.gl;return new Cn({func:o.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,o.KEEP,o.KEEP,o.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(t){const o=this.context.gl,d=t.sort(((A,R)=>R.overscaledZ-A.overscaledZ)),x=d[d.length-1].overscaledZ,S=d[0].overscaledZ-x+1;if(S>1){this.currentStencilSource=void 0,this.nextStencilID+S>256&&this.clearStencil();const A={};for(let R=0;R<S;R++)A[R+x]=new Cn({func:o.GEQUAL,mask:255},R+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=S,[A,d]}return[{[x]:Cn.disabled},d]}stencilConfigForOverlapTwoPass(t){const o=this.context.gl,d=t.sort(((A,R)=>R.overscaledZ-A.overscaledZ)),x=d[d.length-1].overscaledZ,S=d[0].overscaledZ-x+1;if(this.clearStencil(),S>1){const A={},R={};for(let F=0;F<S;F++)A[F+x]=new Cn({func:o.GREATER,mask:255},S+1+F,255,o.KEEP,o.KEEP,o.REPLACE),R[F+x]=new Cn({func:o.GREATER,mask:255},1+F,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID=2*S+1,[A,R,d]}return this.nextStencilID=3,[{[x]:new Cn({func:o.GREATER,mask:255},2,255,o.KEEP,o.KEEP,o.REPLACE)},{[x]:new Cn({func:o.GREATER,mask:255},1,255,o.KEEP,o.KEEP,o.REPLACE)},d]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new qn([t.CONSTANT_COLOR,t.ONE],new s.bp(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?qn.unblended:qn.alphaBlended}getDepthModeForSublayer(t,o,d){if(!this.opaquePassEnabledForLayer())return cn.disabled;const x=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new cn(d||this.context.gl.LEQUAL,o,[x,x])}getDepthModeFor3D(){return new cn(this.context.gl.LEQUAL,cn.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,o){var d,x;this.style=t,this.options=o,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(O()),this.imageManager.beginFrame();const S=this.style._order,A=this.style.tileManagers,R={},F={},V={},q={isRenderingToTexture:!1,isRenderingGlobe:((d=t.projection)===null||d===void 0?void 0:d.transitionState)>0};for(const ee in A){const ce=A[ee];ce.used&&ce.prepare(this.context),R[ee]=ce.getVisibleCoordinates(!1),F[ee]=R[ee].slice().reverse(),V[ee]=ce.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let ee=0;ee<S.length;ee++)if(this.style._layers[S[ee]].is3D()){this.opaquePassCutoff=ee;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const ee of S){const ce=this.style._layers[ee];if(!ce.hasOffscreenPass()||ce.isHidden(this.transform.zoom))continue;const _e=F[ce.source];(ce.type==="custom"||_e.length)&&this.renderLayer(this,A[ce.source],ce,_e,q)}if((x=this.style.projection)===null||x===void 0||x.updateGPUdependent({context:this.context,useProgram:ee=>this.useProgram(ee)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:o.showOverdrawInspector?s.bp.black:s.bp.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(ee,ce){const _e=ee.context,Ie=_e.gl,Be=((lt,Ke,dt)=>{const Rt=Math.cos(Ke.rollInRadians),Tt=Math.sin(Ke.rollInRadians),kt=yn(Ke),Ct=Ke.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:lt.properties.get("sky-color"),u_horizon_color:lt.properties.get("horizon-color"),u_horizon:[(Ke.width/2-kt*Tt)*dt,(Ke.height/2+kt*Rt)*dt],u_horizon_normal:[-Tt,Rt],u_sky_horizon_blend:lt.properties.get("sky-horizon-blend")*Ke.height/2*dt,u_sky_blend:Ct}})(ce,ee.style.map.transform,ee.pixelRatio),ze=new cn(Ie.LEQUAL,cn.ReadWrite,[0,1]),Ze=Cn.disabled,rt=ee.colorModeForRenderPass(),qe=ee.useProgram("sky"),tt=$h(_e,ce);qe.draw(_e,Ie.TRIANGLES,ze,Ze,rt,_n.disabled,Be,null,void 0,"sky",tt.vertexBuffer,tt.indexBuffer,tt.segments)})(this,this.style.sky),this._showOverdrawInspector=o.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=S.length-1;this.currentLayer>=0;this.currentLayer--){const ee=this.style._layers[S[this.currentLayer]],ce=A[ee.source],_e=R[ee.source];this._renderTileClippingMasks(ee,_e,!1),this.renderLayer(this,ce,ee,_e,q)}this.renderPass="translucent";let te=!1;for(this.currentLayer=0;this.currentLayer<S.length;this.currentLayer++){const ee=this.style._layers[S[this.currentLayer]],ce=A[ee.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(ee,q))continue;this.opaquePassEnabledForLayer()||te||(te=!0,q.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const _e=(ee.type==="symbol"?V:F)[ee.source];this._renderTileClippingMasks(ee,R[ee.source],!!this.renderToTexture),this.renderLayer(this,ce,ee,_e,q)}if(q.isRenderingGlobe&&(function(ee,ce,_e){const Ie=ee.context,Be=Ie.gl,ze=ee.useProgram("atmosphere"),Ze=new cn(Be.LEQUAL,cn.ReadOnly,[0,1]),rt=ee.transform,qe=(function(Ct,ur){const hr=Ct.properties.get("position"),tr=[-hr.x,-hr.y,-hr.z],br=s.ar(new Float64Array(16));return Ct.properties.get("anchor")==="map"&&(s.bg(br,br,ur.rollInRadians),s.bh(br,br,-ur.pitchInRadians),s.bg(br,br,ur.bearingInRadians),s.bh(br,br,ur.center.lat*Math.PI/180),s.bJ(br,br,-ur.center.lng*Math.PI/180)),s.cg(tr,tr,br),tr})(_e,ee.transform),tt=rt.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),lt=ce.properties.get("atmosphere-blend")*tt.projectionTransition;if(lt===0)return;const Ke=Fi(rt.worldSize,rt.center.lat),dt=rt.inverseProjectionMatrix,Rt=new Float64Array(4);Rt[3]=1,s.aH(Rt,Rt,rt.modelViewProjectionMatrix),Rt[0]/=Rt[3],Rt[1]/=Rt[3],Rt[2]/=Rt[3],Rt[3]=1,s.aH(Rt,Rt,dt),Rt[0]/=Rt[3],Rt[1]/=Rt[3],Rt[2]/=Rt[3],Rt[3]=1;const Tt=((Ct,ur,hr,tr,br)=>({u_sun_pos:Ct,u_atmosphere_blend:ur,u_globe_position:hr,u_globe_radius:tr,u_inv_proj_matrix:br}))(qe,lt,[Rt[0],Rt[1],Rt[2]],Ke,dt),kt=$h(Ie,ce);ze.draw(Ie,Be.TRIANGLES,Ze,Cn.disabled,qn.alphaBlended,_n.disabled,Tt,null,null,"atmosphere",kt.vertexBuffer,kt.indexBuffer,kt.segments)})(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const ee=(function(ce,_e){let Ie=null;const Be=Object.values(ce._layers).flatMap((qe=>qe.source&&!qe.isHidden(_e)?[ce.tileManagers[qe.source]]:[])),ze=Be.filter((qe=>qe.getSource().type==="vector")),Ze=Be.filter((qe=>qe.getSource().type!=="vector")),rt=qe=>{(!Ie||Ie.getSource().maxzoom<qe.getSource().maxzoom)&&(Ie=qe)};return ze.forEach((qe=>rt(qe))),Ie||Ze.forEach((qe=>rt(qe))),Ie})(this.style,this.transform.zoom);ee&&(function(ce,_e,Ie){for(let Be=0;Be<Ie.length;Be++)wu(ce,_e,Ie[Be])})(this,ee,ee.getVisibleCoordinates())}this.options.showPadding&&(function(ee){const ce=ee.transform.padding;sc(ee,ee.transform.height-(ce.top||0),3,Bi),sc(ee,ce.bottom||0,3,Si),So(ee,ce.left||0,3,ks),So(ee,ee.transform.width-(ce.right||0),3,Il);const _e=ee.transform.centerPoint;(function(Ie,Be,ze,Ze){Wa(Ie,Be-1,ze-10,2,20,Ze),Wa(Ie,Be-10,ze-1,20,2,Ze)})(ee,_e.x,ee.transform.height-_e.y,Cs)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(t){if(!this.style||!this.style.map||!this.style.map.terrain)return;const o=this.terrainFacilitator.matrix,d=this.transform.modelViewProjectionMatrix;let x=this.terrainFacilitator.dirty;x||(x=t?!s.cj(o,d):!s.ck(o,d)),x||(x=this.style.map.terrain.tileManager.anyTilesAfterTime(this.terrainFacilitator.renderTime)),x&&(s.cl(o,d),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(S,A){const R=S.context,F=R.gl,V=S.transform,q=qn.unblended,te=new cn(F.LEQUAL,cn.ReadWrite,[0,1]),ee=A.tileManager.getRenderableTiles(),ce=S.useProgram("terrainDepth");R.bindFramebuffer.set(A.getFramebuffer("depth").framebuffer),R.viewport.set([0,0,S.width/devicePixelRatio,S.height/devicePixelRatio]),R.clear({color:s.bp.transparent,depth:1});for(const _e of ee){const Ie=A.getTerrainMesh(_e.tileID),Be=A.getTerrainData(_e.tileID),ze=V.getProjectionData({overscaledTileID:_e.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),Ze={u_ele_delta:A.getMeshFrameDelta(V.zoom)};ce.draw(R,F.TRIANGLES,te,Cn.disabled,q,_n.backCCW,Ze,Be,ze,"terrain",Ie.vertexBuffer,Ie.indexBuffer,Ie.segments)}R.bindFramebuffer.set(null),R.viewport.set([0,0,S.width,S.height])})(this,this.style.map.terrain),(function(S,A){const R=S.context,F=R.gl,V=S.transform,q=qn.unblended,te=new cn(F.LEQUAL,cn.ReadWrite,[0,1]),ee=A.getCoordsTexture(),ce=A.tileManager.getRenderableTiles(),_e=S.useProgram("terrainCoords");R.bindFramebuffer.set(A.getFramebuffer("coords").framebuffer),R.viewport.set([0,0,S.width/devicePixelRatio,S.height/devicePixelRatio]),R.clear({color:s.bp.transparent,depth:1}),A.coordsIndex=[];for(const Ie of ce){const Be=A.getTerrainMesh(Ie.tileID),ze=A.getTerrainData(Ie.tileID);R.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,ee.texture);const Ze={u_terrain_coords_id:(255-A.coordsIndex.length)/255,u_texture:0,u_ele_delta:A.getMeshFrameDelta(V.zoom)},rt=V.getProjectionData({overscaledTileID:Ie.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});_e.draw(R,F.TRIANGLES,te,Cn.disabled,q,_n.backCCW,Ze,ze,rt,"terrain",Be.vertexBuffer,Be.indexBuffer,Be.segments),A.coordsIndex.push(Ie.tileID.key)}R.bindFramebuffer.set(null),R.viewport.set([0,0,S.width,S.height])})(this,this.style.map.terrain))}renderLayer(t,o,d,x,S){d.isHidden(this.transform.zoom)||(d.type==="background"||d.type==="custom"||(x||[]).length)&&(this.id=d.id,s.cm(d)?(function(A,R,F,V,q,te){if(A.renderPass!=="translucent")return;const{isRenderingToTexture:ee}=te,ce=Cn.disabled,_e=A.colorModeForRenderPass();(F._unevaluatedLayout.hasValue("text-variable-anchor")||F._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(Ie,Be,ze,Ze,rt,qe,tt,lt,Ke){const dt=Be.transform,Rt=Be.style.map.terrain,Tt=rt==="map",kt=qe==="map";for(const Ct of Ie){const ur=Ze.getTile(Ct),hr=ur.getBucket(ze);if(!hr||!hr.text||!hr.text.segments.get().length)continue;const tr=s.ay(hr.textSizeData,dt.zoom),br=s.aN(ur,1,Be.transform.zoom),fn=jt(Tt,Be.transform,br),Yn=ze.layout.get("icon-text-fit")!=="none"&&hr.hasIconData();if(tr){const va=Math.pow(2,dt.zoom-ur.tileID.overscaledZ),da=Rt?(ka,aa)=>Rt.getElevation(Ct,ka,aa):null;xr(hr,Tt,kt,Ke,dt,fn,va,tr,Yn,s.aO(dt,ur,tt,lt),Ct.toUnwrapped(),da)}}})(V,A,F,R,F.layout.get("text-rotation-alignment"),F.layout.get("text-pitch-alignment"),F.paint.get("text-translate"),F.paint.get("text-translate-anchor"),q),F.paint.get("icon-opacity").constantOr(1)!==0&&nn(A,R,F,V,!1,F.paint.get("icon-translate"),F.paint.get("icon-translate-anchor"),F.layout.get("icon-rotation-alignment"),F.layout.get("icon-pitch-alignment"),F.layout.get("icon-keep-upright"),ce,_e,ee),F.paint.get("text-opacity").constantOr(1)!==0&&nn(A,R,F,V,!0,F.paint.get("text-translate"),F.paint.get("text-translate-anchor"),F.layout.get("text-rotation-alignment"),F.layout.get("text-pitch-alignment"),F.layout.get("text-keep-upright"),ce,_e,ee),R.map.showCollisionBoxes&&(Dr(A,R,F,V,!0),Dr(A,R,F,V,!1))})(t,o,d,x,this.style.placement.variableOffsets,S):s.cn(d)?(function(A,R,F,V,q){if(A.renderPass!=="translucent")return;const{isRenderingToTexture:te}=q,ee=F.paint.get("circle-opacity"),ce=F.paint.get("circle-stroke-width"),_e=F.paint.get("circle-stroke-opacity"),Ie=!F.layout.get("circle-sort-key").isConstant();if(ee.constantOr(1)===0&&(ce.constantOr(1)===0||_e.constantOr(1)===0))return;const Be=A.context,ze=Be.gl,Ze=A.transform,rt=A.getDepthModeForSublayer(0,cn.ReadOnly),qe=Cn.disabled,tt=A.colorModeForRenderPass(),lt=[],Ke=Ze.getCircleRadiusCorrection();for(let dt=0;dt<V.length;dt++){const Rt=V[dt],Tt=R.getTile(Rt),kt=Tt.getBucket(F);if(!kt)continue;const Ct=F.paint.get("circle-translate"),ur=F.paint.get("circle-translate-anchor"),hr=s.aO(Ze,Tt,Ct,ur),tr=kt.programConfigurations.get(F.id),br=A.useProgram("circle",tr),fn=kt.layoutVertexBuffer,Yn=kt.indexBuffer,va=A.style.map.terrain&&A.style.map.terrain.getTerrainData(Rt),da={programConfiguration:tr,program:br,layoutVertexBuffer:fn,indexBuffer:Yn,uniformValues:rc(A,Tt,F,hr,Ke),terrainData:va,projectionData:Ze.getProjectionData({overscaledTileID:Rt,applyGlobeMatrix:!te,applyTerrainMatrix:!0})};if(Ie){const ka=kt.segments.get();for(const aa of ka)lt.push({segments:new s.aX([aa]),sortKey:aa.sortKey,state:da})}else lt.push({segments:kt.segments,sortKey:0,state:da})}Ie&&lt.sort(((dt,Rt)=>dt.sortKey-Rt.sortKey));for(const dt of lt){const{programConfiguration:Rt,program:Tt,layoutVertexBuffer:kt,indexBuffer:Ct,uniformValues:ur,terrainData:hr,projectionData:tr}=dt.state;Tt.draw(Be,ze.TRIANGLES,rt,qe,tt,_n.backCCW,ur,hr,tr,F.id,kt,Ct,dt.segments,F.paint,A.transform.zoom,Rt)}})(t,o,d,x,S):s.co(d)?(function(A,R,F,V,q){if(F.paint.get("heatmap-opacity")===0)return;const te=A.context,{isRenderingToTexture:ee,isRenderingGlobe:ce}=q;if(A.style.map.terrain){for(const _e of V){const Ie=R.getTile(_e);R.hasRenderableParent(_e)||(A.renderPass==="offscreen"?un(A,Ie,F,_e,ce):A.renderPass==="translucent"&&Er(A,F,_e,ee,ce))}te.viewport.set([0,0,A.width,A.height])}else A.renderPass==="offscreen"?(function(_e,Ie,Be,ze){const Ze=_e.context,rt=Ze.gl,qe=_e.transform,tt=Cn.disabled,lt=new qn([rt.ONE,rt.ONE],s.bp.transparent,[!0,!0,!0,!0]);(function(Ke,dt,Rt){const Tt=Ke.gl;Ke.activeTexture.set(Tt.TEXTURE1),Ke.viewport.set([0,0,dt.width/4,dt.height/4]);let kt=Rt.heatmapFbos.get(s.cd);kt?(Tt.bindTexture(Tt.TEXTURE_2D,kt.colorAttachment.get()),Ke.bindFramebuffer.set(kt.framebuffer)):(kt=Br(Ke,dt.width/4,dt.height/4),Rt.heatmapFbos.set(s.cd,kt))})(Ze,_e,Be),Ze.clear({color:s.bp.transparent});for(let Ke=0;Ke<ze.length;Ke++){const dt=ze[Ke];if(Ie.hasRenderableParent(dt))continue;const Rt=Ie.getTile(dt),Tt=Rt.getBucket(Be);if(!Tt)continue;const kt=Tt.programConfigurations.get(Be.id),Ct=_e.useProgram("heatmap",kt),ur=qe.getProjectionData({overscaledTileID:dt,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),hr=qe.getCircleRadiusCorrection();Ct.draw(Ze,rt.TRIANGLES,cn.disabled,tt,lt,_n.backCCW,Ts(Rt,qe.zoom,Be.paint.get("heatmap-intensity"),hr),null,ur,Be.id,Tt.layoutVertexBuffer,Tt.indexBuffer,Tt.segments,Be.paint,qe.zoom,kt)}Ze.viewport.set([0,0,_e.width,_e.height])})(A,R,F,V):A.renderPass==="translucent"&&(function(_e,Ie){const Be=_e.context,ze=Be.gl;Be.setColorMode(_e.colorModeForRenderPass());const Ze=Ie.heatmapFbos.get(s.cd);Ze&&(Be.activeTexture.set(ze.TEXTURE0),ze.bindTexture(ze.TEXTURE_2D,Ze.colorAttachment.get()),Be.activeTexture.set(ze.TEXTURE1),Nr(Be,Ie).bind(ze.LINEAR,ze.CLAMP_TO_EDGE),_e.useProgram("heatmapTexture").draw(Be,ze.TRIANGLES,cn.disabled,Cn.disabled,_e.colorModeForRenderPass(),_n.disabled,mu(_e,Ie,0,1),null,null,Ie.id,_e.viewportBuffer,_e.quadTriangleIndexBuffer,_e.viewportSegments,Ie.paint,_e.transform.zoom))})(A,F)})(t,o,d,x,S):s.cp(d)?(function(A,R,F,V,q){if(A.renderPass!=="translucent")return;const{isRenderingToTexture:te}=q,ee=F.paint.get("line-opacity"),ce=F.paint.get("line-width");if(ee.constantOr(1)===0||ce.constantOr(1)===0)return;const _e=A.getDepthModeForSublayer(0,cn.ReadOnly),Ie=A.colorModeForRenderPass(),Be=F.paint.get("line-dasharray"),ze=Be.constantOr(1),Ze=F.paint.get("line-pattern"),rt=Ze.constantOr(1),qe=F.paint.get("line-gradient"),tt=F.getCrossfadeParameters();let lt;lt=rt?"linePattern":ze&&qe?"lineGradientSDF":ze?"lineSDF":qe?"lineGradient":"line";const Ke=A.context,dt=Ke.gl,Rt=A.transform;let Tt=!0;for(const kt of V){const Ct=R.getTile(kt);if(rt&&!Ct.patternsLoaded())continue;const ur=Ct.getBucket(F);if(!ur)continue;const hr=ur.programConfigurations.get(F.id),tr=A.context.program.get(),br=A.useProgram(lt,hr),fn=Tt||br.program!==tr,Yn=A.style.map.terrain&&A.style.map.terrain.getTerrainData(kt),va=Ze.constantOr(null),da=Be&&Be.constantOr(null);if(va&&Ct.imageAtlas){const Ni=Ct.imageAtlas,Xa=Ni.patternPositions[va.to.toString()],Ya=Ni.patternPositions[va.from.toString()];Xa&&Ya&&hr.setConstantPatternPositions(Xa,Ya)}else if(da){const Ni=F.layout.get("line-cap")==="round",Xa=A.lineAtlas.getDash(da.to,Ni),Ya=A.lineAtlas.getDash(da.from,Ni);hr.setConstantDashPositions(Xa,Ya)}const ka=Rt.getProjectionData({overscaledTileID:kt,applyGlobeMatrix:!te,applyTerrainMatrix:!0}),aa=Rt.getPixelScale();let Ga;rt?(Ga=wo(A,Ct,F,aa,tt),Gr(Ke,dt,Ct,hr,tt)):ze&&qe?(Ga=eo(A,Ct,F,aa,tt,ur.lineClipsArray.length),Za(A,R,Ke,dt,F,ur,kt,hr,tt)):ze?(Ga=Pa(A,Ct,F,aa,tt),gn(A,Ke,dt,hr,fn,tt)):qe?(Ga=ih(A,Ct,F,aa,ur.lineClipsArray.length),fa(A,R,Ke,dt,F,ur,kt)):Ga=Bs(A,Ct,F,aa);const Ca=A.stencilModeForClipping(kt);br.draw(Ke,dt.TRIANGLES,_e,Ca,Ie,_n.disabled,Ga,Yn,ka,F.id,ur.layoutVertexBuffer,ur.indexBuffer,ur.segments,F.paint,A.transform.zoom,hr,ur.layoutVertexBuffer2),Tt=!1}})(t,o,d,x,S):s.cq(d)?(function(A,R,F,V,q){const te=F.paint.get("fill-color"),ee=F.paint.get("fill-opacity");if(ee.constantOr(1)===0)return;const{isRenderingToTexture:ce}=q,_e=A.colorModeForRenderPass(),Ie=F.paint.get("fill-pattern"),Be=A.opaquePassEnabledForLayer()&&!Ie.constantOr(1)&&te.constantOr(s.bp.transparent).a===1&&ee.constantOr(0)===1?"opaque":"translucent";if(A.renderPass===Be){const ze=A.getDepthModeForSublayer(1,A.renderPass==="opaque"?cn.ReadWrite:cn.ReadOnly);fs(A,R,F,V,ze,_e,!1,ce)}if(A.renderPass==="translucent"&&F.paint.get("fill-antialias")){const ze=A.getDepthModeForSublayer(F.getPaintProperty("fill-outline-color")?2:0,cn.ReadOnly);fs(A,R,F,V,ze,_e,!0,ce)}})(t,o,d,x,S):s.cr(d)?(function(A,R,F,V,q){const te=F.paint.get("fill-extrusion-opacity");if(te===0)return;const{isRenderingToTexture:ee}=q;if(A.renderPass==="translucent"){const ce=new cn(A.context.gl.LEQUAL,cn.ReadWrite,A.depthRangeFor3D);if(te!==1||F.paint.get("fill-extrusion-pattern").constantOr(1))zi(A,R,F,V,ce,Cn.disabled,qn.disabled,ee),zi(A,R,F,V,ce,A.stencilModeFor3D(),A.colorModeForRenderPass(),ee);else{const _e=A.colorModeForRenderPass();zi(A,R,F,V,ce,Cn.disabled,_e,ee)}}})(t,o,d,x,S):s.cs(d)?(function(A,R,F,V,q){if(A.renderPass!=="offscreen"&&A.renderPass!=="translucent")return;const{isRenderingToTexture:te}=q,ee=A.context,ce=A.style.projection.useSubdivision,_e=A.getDepthModeForSublayer(0,cn.ReadOnly),Ie=A.colorModeForRenderPass();if(A.renderPass==="offscreen")(function(Be,ze,Ze,rt,qe,tt,lt){const Ke=Be.context,dt=Ke.gl;for(const Rt of Ze){const Tt=ze.getTile(Rt),kt=Tt.dem;if(!kt||!kt.data||!Tt.needsHillshadePrepare)continue;const Ct=kt.dim,ur=kt.stride,hr=kt.getPixels();if(Ke.activeTexture.set(dt.TEXTURE1),Ke.pixelStoreUnpackPremultiplyAlpha.set(!1),Tt.demTexture=Tt.demTexture||Be.getTileTexture(ur),Tt.demTexture){const br=Tt.demTexture;br.update(hr,{premultiply:!1}),br.bind(dt.NEAREST,dt.CLAMP_TO_EDGE)}else Tt.demTexture=new s.T(Ke,hr,dt.RGBA,{premultiply:!1}),Tt.demTexture.bind(dt.NEAREST,dt.CLAMP_TO_EDGE);Ke.activeTexture.set(dt.TEXTURE0);let tr=Tt.fbo;if(!tr){const br=new s.T(Ke,{width:Ct,height:Ct,data:null},dt.RGBA);br.bind(dt.LINEAR,dt.CLAMP_TO_EDGE),tr=Tt.fbo=Ke.createFramebuffer(Ct,Ct,!0,!1),tr.colorAttachment.set(br.texture)}Ke.bindFramebuffer.set(tr.framebuffer),Ke.viewport.set([0,0,Ct,Ct]),Be.useProgram("hillshadePrepare").draw(Ke,dt.TRIANGLES,qe,tt,lt,_n.disabled,bo(Tt.tileID,kt),null,null,rt.id,Be.rasterBoundsBuffer,Be.quadTriangleIndexBuffer,Be.rasterBoundsSegments),Tt.needsHillshadePrepare=!1}})(A,R,V,F,_e,Cn.disabled,Ie),ee.viewport.set([0,0,A.width,A.height]);else if(A.renderPass==="translucent")if(ce){const[Be,ze,Ze]=A.stencilConfigForOverlapTwoPass(V);Oi(A,R,F,Ze,Be,_e,Ie,!1,te),Oi(A,R,F,Ze,ze,_e,Ie,!0,te)}else{const[Be,ze]=A.getStencilConfigForOverlapAndUpdateStencilID(V);Oi(A,R,F,ze,Be,_e,Ie,!1,te)}})(t,o,d,x,S):s.ct(d)?(function(A,R,F,V,q){if(A.renderPass!=="translucent"||!V.length)return;const{isRenderingToTexture:te}=q,ee=A.style.projection.useSubdivision,ce=A.getDepthModeForSublayer(0,cn.ReadOnly),_e=A.colorModeForRenderPass();if(ee){const[Ie,Be,ze]=A.stencilConfigForOverlapTwoPass(V);ro(A,R,F,ze,Ie,ce,_e,!1,te),ro(A,R,F,ze,Be,ce,_e,!0,te)}else{const[Ie,Be]=A.getStencilConfigForOverlapAndUpdateStencilID(V);ro(A,R,F,Be,Ie,ce,_e,!1,te)}})(t,o,d,x,S):s.bU(d)?(function(A,R,F,V,q){if(A.renderPass!=="translucent"||F.paint.get("raster-opacity")===0||!V.length)return;const{isRenderingToTexture:te}=q,ee=R.getSource(),ce=A.style.projection.useSubdivision;if(ee instanceof ir)ds(A,R,F,V,null,!1,!1,ee.tileCoords,ee.flippedWindingOrder,te);else if(ce){const[_e,Ie,Be]=A.stencilConfigForOverlapTwoPass(V);ds(A,R,F,Be,_e,!1,!0,no,!1,te),ds(A,R,F,Be,Ie,!0,!0,no,!1,te)}else{const[_e,Ie]=A.getStencilConfigForOverlapAndUpdateStencilID(V);ds(A,R,F,Ie,_e,!1,!0,no,!1,te)}})(t,o,d,x,S):s.cu(d)?(function(A,R,F,V,q){const te=F.paint.get("background-color"),ee=F.paint.get("background-opacity");if(ee===0)return;const{isRenderingToTexture:ce}=q,_e=A.context,Ie=_e.gl,Be=A.style.projection,ze=A.transform,Ze=ze.tileSize,rt=F.paint.get("background-pattern");if(A.isPatternMissing(rt))return;const qe=!rt&&te.a===1&&ee===1&&A.opaquePassEnabledForLayer()?"opaque":"translucent";if(A.renderPass!==qe)return;const tt=Cn.disabled,lt=A.getDepthModeForSublayer(0,qe==="opaque"?cn.ReadWrite:cn.ReadOnly),Ke=A.colorModeForRenderPass(),dt=A.useProgram(rt?"backgroundPattern":"background"),Rt=V||tn(ze,{tileSize:Ze,terrain:A.style.map.terrain});rt&&(_e.activeTexture.set(Ie.TEXTURE0),A.imageManager.bind(A.context));const Tt=F.getCrossfadeParameters();for(const kt of Rt){const Ct=ze.getProjectionData({overscaledTileID:kt,applyGlobeMatrix:!ce,applyTerrainMatrix:!0}),ur=rt?Bc(ee,A,rt,{tileID:kt,tileSize:Ze},Tt):nc(ee,te),hr=A.style.map.terrain&&A.style.map.terrain.getTerrainData(kt),tr=Be.getMeshFromTileID(_e,kt.canonical,!1,!0,"raster");dt.draw(_e,Ie.TRIANGLES,lt,tt,Ke,_n.backCCW,ur,hr,Ct,F.id,tr.vertexBuffer,tr.indexBuffer,tr.segments)}})(t,0,d,x,S):s.cv(d)&&(function(A,R,F,V){const{isRenderingGlobe:q}=V,te=A.context,ee=F.implementation,ce=A.style.projection,_e=A.transform,Ie=_e.getProjectionDataForCustomLayer(q),Be={farZ:_e.farZ,nearZ:_e.nearZ,fov:_e.fov*Math.PI/180,modelViewProjectionMatrix:_e.modelViewProjectionMatrix,projectionMatrix:_e.projectionMatrix,shaderData:{variantName:ce.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${ce.shaderPreludeCode.vertexSource}`,define:ce.shaderDefine},defaultProjectionData:Ie},ze=ee.renderingMode?ee.renderingMode:"2d";if(A.renderPass==="offscreen"){const Ze=ee.prerender;Ze&&(A.setCustomLayerDefaults(),te.setColorMode(A.colorModeForRenderPass()),Ze.call(ee,te.gl,Be),te.setDirty(),A.setBaseState())}else if(A.renderPass==="translucent"){A.setCustomLayerDefaults(),te.setColorMode(A.colorModeForRenderPass()),te.setStencilMode(Cn.disabled);const Ze=ze==="3d"?A.getDepthModeFor3D():A.getDepthModeForSublayer(0,cn.ReadOnly);te.setDepthMode(Ze),ee.render(te.gl,Be),te.setDirty(),A.setBaseState(),te.bindFramebuffer.set(null)}})(t,0,d,S))}saveTileTexture(t){const o=this._tileTextures[t.size[0]];o?o.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const o=this._tileTextures[t];return o&&o.length>0?o.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const o=this.imageManager.getPattern(t.from.toString()),d=this.imageManager.getPattern(t.to.toString());return!o||!d}useProgram(t,o,d=!1,x=[]){this.cache=this.cache||{};const S=!!this.style.map.terrain,A=this.style.projection,R=d?Hn.projectionMercator:A.shaderPreludeCode,F=d?Da:A.shaderDefine,V=t+(o?o.cacheKey:"")+`/${d?Ri:A.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(S?"/terrain":"")+(x?`/${x.join("/")}`:"");return this.cache[V]||(this.cache[V]=new qh(this.context,Hn[t],o,lh[t],this._showOverdrawInspector,S,R,F,x)),this.cache[V]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){var t,o;if(this._tileTextures){for(const d in this._tileTextures){const x=this._tileTextures[d];if(x)for(const S of x)S.destroy()}this._tileTextures={}}if(this.tileExtentBuffer&&this.tileExtentBuffer.destroy(),this.debugBuffer&&this.debugBuffer.destroy(),this.rasterBoundsBuffer&&this.rasterBoundsBuffer.destroy(),this.rasterBoundsBufferPosOnly&&this.rasterBoundsBufferPosOnly.destroy(),this.viewportBuffer&&this.viewportBuffer.destroy(),this.tileBorderIndexBuffer&&this.tileBorderIndexBuffer.destroy(),this.quadTriangleIndexBuffer&&this.quadTriangleIndexBuffer.destroy(),this.tileExtentMesh&&((t=this.tileExtentMesh.vertexBuffer)===null||t===void 0||t.destroy()),this.tileExtentMesh&&((o=this.tileExtentMesh.indexBuffer)===null||o===void 0||o.destroy()),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.cache){for(const d in this.cache){const x=this.cache[d];x&&x.program&&this.context.gl.deleteProgram(x.program)}this.cache={}}this.context&&this.context.setDefault()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:o}=this.context.gl;return this.width!==t||this.height!==o}}function ph(w,t){let o,d=!1,x=null,S=null;const A=()=>{x=null,d&&(w.apply(S,o),x=setTimeout(A,t),d=!1)};return(...R)=>(d=!0,S=this,o=R,x||A(),x)}class Ua{constructor(t){this._getCurrentHash=()=>{const o=window.location.hash.replace("#","");if(this._hashName){let d;return o.split("&").map((x=>x.split("="))).forEach((x=>{x[0]===this._hashName&&(d=x)})),(d&&d[1]||"").split("/")}return o.split("/")},this._onHashChange=()=>{const o=this._getCurrentHash();if(!this._isValidHash(o))return!1;const d=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(o[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+o[2],+o[1]],zoom:+o[0],bearing:d,pitch:+(o[4]||0)}),!0},this._updateHashUnthrottled=()=>{const o=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,o)},this._removeHash=()=>{const o=this._getCurrentHash();if(o.length===0)return;const d=o.join("/");let x=d;x.split("&").length>0&&(x=x.split("&")[0]),this._hashName&&(x=`${this._hashName}=${d}`);let S=window.location.hash.replace(x,"");S.startsWith("#&")?S=S.slice(0,1)+S.slice(2):S==="#"&&(S="");let A=window.location.href.replace(/(#.+)?$/,S);A=A.replace("&&","&"),window.history.replaceState(window.history.state,null,A)},this._updateHash=ph(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(t){const o=this._map.getCenter(),d=Math.round(100*this._map.getZoom())/100,x=Math.ceil((d*Math.LN2+Math.log(512/360/.5))/Math.LN10),S=Math.pow(10,x),A=Math.round(o.lng*S)/S,R=Math.round(o.lat*S)/S,F=this._map.getBearing(),V=this._map.getPitch();let q="";if(q+=t?`/${A}/${R}/${d}`:`${d}/${R}/${A}`,(F||V)&&(q+="/"+Math.round(10*F)/10),V&&(q+=`/${Math.round(V)}`),this._hashName){const te=this._hashName;let ee=!1;const ce=window.location.hash.slice(1).split("&").map((_e=>{const Ie=_e.split("=")[0];return Ie===te?(ee=!0,`${Ie}=${q}`):_e})).filter((_e=>_e));return ee||ce.push(`${te}=${q}`),`#${ce.join("&")}`}return`#${q}`}_isValidHash(t){if(t.length<3||t.some(isNaN))return!1;try{new s.V(+t[2],+t[1])}catch{return!1}const o=+t[0],d=+(t[3]||0),x=+(t[4]||0);return o>=this._map.getMinZoom()&&o<=this._map.getMaxZoom()&&d>=-180&&d<=180&&x>=this._map.getMinPitch()&&x<=this._map.getMaxPitch()}}const Eo={linearity:.3,easing:s.cw(0,0,.3,1)},Pl=s.e({deceleration:2500,maxSpeed:1400},Eo),Ei=s.e({deceleration:20,maxSpeed:1400},Eo),Ms=s.e({deceleration:1e3,maxSpeed:360},Eo),oc=s.e({deceleration:1e3,maxSpeed:90},Eo),Ai=s.e({deceleration:1e3,maxSpeed:360},Eo);class Ff{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:O(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,o=O();for(;t.length>0&&o-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const o={zoom:0,bearing:0,pitch:0,roll:0,pan:new s.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:S}of this._inertiaBuffer)o.zoom+=S.zoomDelta||0,o.bearing+=S.bearingDelta||0,o.pitch+=S.pitchDelta||0,o.roll+=S.rollDelta||0,S.panDelta&&o.pan._add(S.panDelta),S.around&&(o.around=S.around),S.pinchAround&&(o.pinchAround=S.pinchAround);const d=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,x={};if(o.pan.mag()){const S=Su(o.pan.mag(),d,s.e({},Pl,t||{})),A=o.pan.mult(S.amount/o.pan.mag()),R=this._map.cameraHelper.handlePanInertia(A,this._map.transform);x.center=R.easingCenter,x.offset=R.easingOffset,lc(x,S)}if(o.zoom){const S=Su(o.zoom,d,Ei);x.zoom=this._map.transform.zoom+S.amount,lc(x,S)}if(o.bearing){const S=Su(o.bearing,d,Ms);x.bearing=this._map.transform.bearing+s.an(S.amount,-179,179),lc(x,S)}if(o.pitch){const S=Su(o.pitch,d,oc);x.pitch=this._map.transform.pitch+S.amount,lc(x,S)}if(o.roll){const S=Su(o.roll,d,Ai);x.roll=this._map.transform.roll+s.an(S.amount,-179,179),lc(x,S)}if(x.zoom||x.bearing){const S=o.pinchAround===void 0?o.around:o.pinchAround;x.around=S?this._map.unproject(S):this._map.getCenter()}return this.clear(),s.e(x,{noMoveStart:!0})}}function lc(w,t){(!w.duration||w.duration<t.duration)&&(w.duration=t.duration,w.easing=t.easing)}function Su(w,t,o){const{maxSpeed:d,linearity:x,deceleration:S}=o,A=s.an(w*x/(t/1e3),-d,d),R=Math.abs(A)/(S*x);return{easing:o.easing,duration:1e3*R,amount:A*(R/2)}}class li extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,o,d,x={}){d=d instanceof MouseEvent?d:new MouseEvent(t,d);const S=N.mousePos(o.getCanvas(),d),A=o.unproject(S);super(t,s.e({point:S,lngLat:A,originalEvent:d},x)),this._defaultPrevented=!1,this.target=o}}class sl extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,o,d){const x=t==="touchend"?d.changedTouches:d.touches,S=N.touchPos(o.getCanvasContainer(),x),A=S.map((F=>o.unproject(F))),R=S.reduce(((F,V,q,te)=>F.add(V.div(te.length))),new s.P(0,0));super(t,{points:S,point:R,lngLats:A,lngLat:o.unproject(R),originalEvent:d}),this._defaultPrevented=!1}}class Lf extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,o,d){super(t,{originalEvent:d}),this._defaultPrevented=!1}}class zf{constructor(t,o){this._map=t,this._clickTolerance=o.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new Lf(t.type,this._map,t))}mousedown(t,o){return this._mousedownPos=o,this._firePreventable(new li(t.type,this._map,t))}mouseup(t){this._map.fire(new li(t.type,this._map,t))}click(t,o){this._mousedownPos&&this._mousedownPos.dist(o)>=this._clickTolerance||this._map.fire(new li(t.type,this._map,t))}dblclick(t){return this._firePreventable(new li(t.type,this._map,t))}mouseover(t){this._map.fire(new li(t.type,this._map,t))}mouseout(t){this._map.fire(new li(t.type,this._map,t))}touchstart(t){return this._firePreventable(new sl(t.type,this._map,t))}touchmove(t){this._map.fire(new sl(t.type,this._map,t))}touchend(t){this._map.fire(new sl(t.type,this._map,t))}touchcancel(t){this._map.fire(new sl(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Fp{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new li(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new li("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new li(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ol{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.screenPointToLocation(s.P.convert(t),this._map.terrain)}}class Gc{constructor(t,o){this._map=t,this._tr=new ol(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=o.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,o){this.isEnabled()&&t.shiftKey&&t.button===0&&(N.disableDrag(),this._startPos=this._lastPos=o,this._active=!0)}mousemoveWindow(t,o){if(!this._active)return;const d=o;if(this._lastPos.equals(d)||!this._box&&d.dist(this._startPos)<this._clickTolerance)return;const x=this._startPos;this._lastPos=d,this._box||(this._box=N.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const S=Math.min(x.x,d.x),A=Math.max(x.x,d.x),R=Math.min(x.y,d.y),F=Math.max(x.y,d.y);N.setTransform(this._box,`translate(${S}px,${R}px)`),this._box.style.width=A-S+"px",this._box.style.height=F-R+"px"}mouseupWindow(t,o){if(!this._active||t.button!==0)return;const d=this._startPos,x=o;if(this.reset(),N.suppressClick(),d.x!==x.x||d.y!==x.y)return this._map.fire(new s.l("boxzoomend",{originalEvent:t})),{cameraAnimation:S=>S.fitScreenCoordinates(d,x,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(N.remove(this._box),this._box=null),N.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,o){return this._map.fire(new s.l(t,{originalEvent:o}))}}function Us(w,t){if(w.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${w.length}, points ${t.length}`);const o={};for(let d=0;d<w.length;d++)o[w[d].identifier]=t[d];return o}class Cr{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,o,d){(this.centroid||d.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),d.length===this.numTouches&&(this.centroid=(function(x){const S=new s.P(0,0);for(const A of x)S._add(A);return S.div(x.length)})(o),this.touches=Us(d,o)))}touchmove(t,o,d){if(this.aborted||!this.centroid)return;const x=Us(d,o);for(const S in this.touches){const A=x[S];(!A||A.dist(this.touches[S])>30)&&(this.aborted=!0)}}touchend(t,o,d){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),d.length===0){const x=!this.aborted&&this.centroid;if(this.reset(),x)return x}}}class Xh{constructor(t){this.singleTap=new Cr(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,o,d){this.singleTap.touchstart(t,o,d)}touchmove(t,o,d){this.singleTap.touchmove(t,o,d)}touchend(t,o,d){const x=this.singleTap.touchend(t,o,d);if(x){const S=t.timeStamp-this.lastTime<500,A=!this.lastTap||this.lastTap.dist(x)<30;if(S&&A||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=x,this.count===this.numTaps)return this.reset(),x}}}class Of{constructor(t){this._tr=new ol(t),this._zoomIn=new Xh({numTouches:1,numTaps:2}),this._zoomOut=new Xh({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,o,d){this._zoomIn.touchstart(t,o,d),this._zoomOut.touchstart(t,o,d)}touchmove(t,o,d){this._zoomIn.touchmove(t,o,d),this._zoomOut.touchmove(t,o,d)}touchend(t,o,d){const x=this._zoomIn.touchend(t,o,d),S=this._zoomOut.touchend(t,o,d),A=this._tr;return x?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:R=>R.easeTo({duration:300,zoom:A.zoom+1,around:A.unproject(x)},{originalEvent:t})}):S?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:R=>R.easeTo({duration:300,zoom:A.zoom-1,around:A.unproject(S)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ao{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const o=this._moveFunction(...t);if(o.bearingDelta||o.pitchDelta||o.rollDelta||o.around||o.panDelta)return this._active=!0,o}dragStart(t,o){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=Array.isArray(o)?o[0]:o,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,o){if(!this.isEnabled())return;const d=this._lastPoint;if(!d)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const x=Array.isArray(o)?o[0]:o;return!this._moved&&x.dist(d)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=x,this._move(d,x))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&N.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const ll=0,mh=2,Bf={[ll]:1,[mh]:2};class Fl{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const o=N.mouseButton(t);this._eventButton=o}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!(function(o,d){const x=Bf[d];return o.buttons===void 0||(o.buttons&x)!==x})(t,this._eventButton)}isValidEndEvent(t){return N.mouseButton(t)===this._eventButton}}class Eu{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return t.targetTouches.length===1}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}class Yh{constructor(t=new Fl({checkCorrectEvent:()=>!0}),o=new Eu){this.mouseMoveStateManager=t,this.oneFingerTouchMoveStateManager=o}_executeRelevantHandler(t,o,d){return t instanceof MouseEvent?o(t):typeof TouchEvent<"u"&&t instanceof TouchEvent?d(t):void 0}startMove(t){this._executeRelevantHandler(t,(o=>this.mouseMoveStateManager.startMove(o)),(o=>this.oneFingerTouchMoveStateManager.startMove(o)))}endMove(t){this._executeRelevantHandler(t,(o=>this.mouseMoveStateManager.endMove(o)),(o=>this.oneFingerTouchMoveStateManager.endMove(o)))}isValidStartEvent(t){return this._executeRelevantHandler(t,(o=>this.mouseMoveStateManager.isValidStartEvent(o)),(o=>this.oneFingerTouchMoveStateManager.isValidStartEvent(o)))}isValidMoveEvent(t){return this._executeRelevantHandler(t,(o=>this.mouseMoveStateManager.isValidMoveEvent(o)),(o=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(o)))}isValidEndEvent(t){return this._executeRelevantHandler(t,(o=>this.mouseMoveStateManager.isValidEndEvent(o)),(o=>this.oneFingerTouchMoveStateManager.isValidEndEvent(o)))}}const Ll=w=>{w.mousedown=w.dragStart,w.mousemoveWindow=w.dragMove,w.mouseup=w.dragEnd,w.contextmenu=t=>{t.preventDefault()}};class Nf{constructor(t,o){this._clickTolerance=t.clickTolerance||1,this._map=o,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new s.P(0,0)}_shouldBePrevented(t){return t<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(t,o,d){return this._calculateTransform(t,o,d)}touchmove(t,o,d){if(this._active){if(!this._shouldBePrevented(d.length))return t.preventDefault(),this._calculateTransform(t,o,d);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",t)}}touchend(t,o,d){this._calculateTransform(t,o,d),this._active&&this._shouldBePrevented(d.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,o,d){d.length>0&&(this._active=!0);const x=Us(d,o),S=new s.P(0,0),A=new s.P(0,0);let R=0;for(const V in x){const q=x[V],te=this._touches[V];te&&(S._add(q),A._add(q.sub(te)),R++,x[V]=q)}if(this._touches=x,this._shouldBePrevented(R)||!A.mag())return;const F=A.div(R);return this._sum._add(F),this._sum.mag()<this._clickTolerance?void 0:{around:S.div(R),panDelta:F}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Kh{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,o,d){this._firstTwoTouches||d.length<2||(this._firstTwoTouches=[d[0].identifier,d[1].identifier],this._start([o[0],o[1]]))}touchmove(t,o,d){if(!this._firstTwoTouches)return;t.preventDefault();const[x,S]=this._firstTwoTouches,A=zl(d,o,x),R=zl(d,o,S);if(!A||!R)return;const F=this._aroundCenter?null:A.add(R).div(2);return this._move([A,R],F,t)}touchend(t,o,d){if(!this._firstTwoTouches)return;const[x,S]=this._firstTwoTouches,A=zl(d,o,x),R=zl(d,o,S);A&&R||(this._active&&N.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function zl(w,t,o){for(let d=0;d<w.length;d++)if(w[d].identifier===o)return t[d]}function Ad(w,t){return Math.log(w/t)/Math.LN2}class Ol extends Kh{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,o){const d=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Ad(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ad(this._distance,d),pinchAround:o}}}function jf(w,t){return 180*w.angleWith(t)/Math.PI}class Jh extends Kh{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,o,d){const x=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:jf(this._vector,x),pinchAround:o}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const o=25/(Math.PI*this._minDiameter)*360,d=jf(t,this._startVector);return Math.abs(d)<o}}function Bl(w){return Math.abs(w.y)>Math.abs(w.x)}class cc extends Kh{constructor(t){super(),this._currentTouchCount=0,this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,o,d){super.touchstart(t,o,d),this._currentTouchCount=d.length}_start(t){this._lastPoints=t,Bl(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,o,d){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const x=t[0].sub(this._lastPoints[0]),S=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(x,S,d.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(x.y+S.y)/2*-.5}):void 0}gestureBeginsVertically(t,o,d){if(this._valid!==void 0)return this._valid;const x=t.mag()>=2,S=o.mag()>=2;if(!x&&!S)return;if(!x||!S)return this._firstMove===void 0&&(this._firstMove=d),d-this._firstMove<100&&void 0;const A=t.y>0==o.y>0;return Bl(t)&&Bl(o)&&A}}const ko={panStep:100,bearingStep:15,pitchStep:10};class Qn{constructor(t){this._tr=new ol(t);const o=ko;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let o=0,d=0,x=0,S=0,A=0;switch(t.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:t.shiftKey?d=-1:(t.preventDefault(),S=-1);break;case 39:t.shiftKey?d=1:(t.preventDefault(),S=1);break;case 38:t.shiftKey?x=1:(t.preventDefault(),A=-1);break;case 40:t.shiftKey?x=-1:(t.preventDefault(),A=1);break;default:return}return this._rotationDisabled&&(d=0,x=0),{cameraAnimation:R=>{const F=this._tr;R.easeTo({duration:300,easeId:"keyboardHandler",easing:kd,zoom:o?Math.round(F.zoom)+o*(t.shiftKey?2:1):F.zoom,bearing:F.bearing+d*this._bearingStep,pitch:F.pitch+x*this._pitchStep,offset:[-S*this._panStep,-A*this._panStep],center:F.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function kd(w){return w*(2-w)}const uc=4.000244140625,Hc=1/450;class Qh{constructor(t,o){this._onTimeout=d=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(d)},this._map=t,this._tr=new ol(t),this._triggerRenderFrame=o,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Hc}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(t){return!!this._map.cooperativeGestures.isEnabled()&&!(t.ctrlKey||this._map.cooperativeGestures.isBypassed(t))}wheel(t){if(!this.isEnabled())return;if(this._shouldBePrevented(t))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",t);let o=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const d=O(),x=d-(this._lastWheelEventTime||0);this._lastWheelEventTime=d,o!==0&&o%uc==0?this._type="wheel":o!==0&&Math.abs(o)<4?this._type="trackpad":x>400?(this._type=null,this._lastValue=o,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(x*o)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,o+=this._lastValue)),t.shiftKey&&o&&(o/=4),this._type&&(this._lastWheelEvent=t,this._delta-=o,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const o=N.mousePos(this._map.getCanvas(),t),d=this._tr;this._aroundPoint=this._aroundCenter?d.transform.locationToScreenPoint(s.V.convert(d.center)):o,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const R=t.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=R),typeof this._targetZoom=="number"&&(this._targetZoom+=R)}if(this._delta!==0){const R=this._type==="wheel"&&Math.abs(this._delta)>uc?this._wheelZoomRate:this._defaultZoomRate;let F=2/(1+Math.exp(-Math.abs(this._delta*R)));this._delta<0&&F!==0&&(F=1/F);const V=typeof this._targetZoom!="number"?t.scale:s.aq(this._targetZoom);this._targetZoom=t.applyConstrain(t.getCameraLngLat(),s.at(V*F)).zoom,this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const o=typeof this._targetZoom!="number"?t.zoom:this._targetZoom,d=this._startZoom,x=this._easing;let S,A=!1;if(this._type==="wheel"&&d&&x){const R=O()-this._lastWheelEventTime,F=Math.min((R+5)/200,1),V=x(F);S=s.G.number(d,o,V),F<1?this._frameId||(this._frameId=!0):A=!0}else S=o,A=!0;return this._active=!0,A&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout}),200)),this._lastExpectedZoom=S,{noInertia:!0,needsRenderFrame:!A,zoomDelta:S-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let o=s.cy;if(this._prevEase){const d=this._prevEase,x=(O()-d.start)/d.duration,S=d.easing(x+.01)-d.easing(x),A=.27/Math.sqrt(S*S+1e-4)*.01,R=Math.sqrt(.0729-A*A);o=s.cw(A,R,.25,1)}return this._prevEase={start:O(),duration:t,easing:o},o}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Uf{constructor(t,o){this._clickZoom=t,this._tapZoom=o}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Au{constructor(t){this._tr=new ol(t),this.reset()}reset(){this._active=!1}dblclick(t,o){return t.preventDefault(),{cameraAnimation:d=>{d.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(o)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ef{constructor(){this._tap=new Xh({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,o,d){if(!this._swipePoint)if(this._tapTime){const x=o[0],S=t.timeStamp-this._tapTime<500,A=this._tapPoint.dist(x)<30;S&&A?d.length>0&&(this._swipePoint=x,this._swipeTouch=d[0].identifier):this.reset()}else this._tap.touchstart(t,o,d)}touchmove(t,o,d){if(this._tapTime){if(this._swipePoint){if(d[0].identifier!==this._swipeTouch)return;const x=o[0],S=x.y-this._swipePoint.y;return this._swipePoint=x,t.preventDefault(),this._active=!0,{zoomDelta:S/128}}}else this._tap.touchmove(t,o,d)}touchend(t,o,d){if(this._tapTime)this._swipePoint&&d.length===0&&this.reset();else{const x=this._tap.touchend(t,o,d);x&&(this._tapTime=t.timeStamp,this._tapPoint=x)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Cd{constructor(t,o,d){this._el=t,this._mousePan=o,this._touchPan=d}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class ao{constructor(t,o,d,x){this._pitchWithRotate=t.pitchWithRotate,this._rollEnabled=t.rollEnabled,this._mouseRotate=o,this._mousePitch=d,this._mouseRoll=x}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class ku{constructor(t,o,d,x){this._el=t,this._touchZoom=o,this._touchRotate=d,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Rr{constructor(t,o){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=t,this._options=o,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const t=this._map.getCanvasContainer();t.classList.add("maplibregl-cooperative-gestures"),this._container=N.create("div","maplibregl-cooperative-gesture-screen",t);let o=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(o=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const d=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),x=document.createElement("div");x.className="maplibregl-desktop-message",x.textContent=o,this._container.appendChild(x);const S=document.createElement("div");S.className="maplibregl-mobile-message",S.textContent=d,this._container.appendChild(S),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(N.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(t){return t[this._bypassKey]}notifyGestureBlocked(t,o){this._enabled&&(this._map.fire(new s.l("cooperativegestureprevented",{gestureType:t,originalEvent:o})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const jr=w=>w.zoom||w.drag||w.roll||w.pitch||w.rotate;class Co extends s.l{}function gh(w){return w.panDelta&&w.panDelta.mag()||w.zoomDelta||w.bearingDelta||w.pitchDelta||w.rollDelta}class tf{constructor(t,o){this.handleWindowEvent=x=>{this.handleEvent(x,`${x.type}Window`)},this.handleEvent=(x,S)=>{if(x.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const A=x.type==="renderFrame"?void 0:x,R={needsRenderFrame:!1},F={},V={};for(const{handlerName:ee,handler:ce,allowed:_e}of this._handlers){if(!ce.isEnabled())continue;let Ie;if(this._blockedByActive(V,_e,ee))ce.reset();else if(ce[S||x.type]){if(s.cz(x,S||x.type)){const Be=N.mousePos(this._map.getCanvas(),x);Ie=ce[S||x.type](x,Be)}else if(s.cA(x,S||x.type)){const Be=this._getMapTouches(x.touches),ze=N.touchPos(this._map.getCanvas(),Be);Ie=ce[S||x.type](x,ze,Be)}else s.cB(S||x.type)||(Ie=ce[S||x.type](x));this.mergeHandlerResult(R,F,Ie,ee,A),Ie&&Ie.needsRenderFrame&&this._triggerRenderFrame()}(Ie||ce.isActive())&&(V[ee]=ce)}const q={};for(const ee in this._previousActiveHandlers)V[ee]||(q[ee]=A);this._previousActiveHandlers=V,(Object.keys(q).length||gh(R))&&(this._changes.push([R,F,q]),this._triggerRenderFrame()),(Object.keys(V).length||gh(R))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:te}=R;te&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],te(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ff(t),this._bearingSnap=o.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(o);const d=this._el;this._listeners=[[d,"touchstart",{passive:!0}],[d,"touchmove",{passive:!1}],[d,"touchend",void 0],[d,"touchcancel",void 0],[d,"mousedown",void 0],[d,"mousemove",void 0],[d,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[d,"mouseover",void 0],[d,"mouseout",void 0],[d,"dblclick",void 0],[d,"click",void 0],[d,"keydown",{capture:!1}],[d,"keyup",void 0],[d,"wheel",{passive:!1}],[d,"contextmenu",void 0],[window,"blur",void 0]];for(const[x,S,A]of this._listeners)N.addEventListener(x,S,x===document?this.handleWindowEvent:this.handleEvent,A)}destroy(){for(const[t,o,d]of this._listeners)N.removeEventListener(t,o,t===document?this.handleWindowEvent:this.handleEvent,d)}_addDefaultHandlers(t){const o=this._map,d=o.getCanvasContainer();this._add("mapEvent",new zf(o,t));const x=o.boxZoom=new Gc(o,t);this._add("boxZoom",x),t.interactive&&t.boxZoom&&x.enable();const S=o.cooperativeGestures=new Rr(o,t.cooperativeGestures);this._add("cooperativeGestures",S),t.cooperativeGestures&&S.enable();const A=new Of(o),R=new Au(o);o.doubleClickZoom=new Uf(R,A),this._add("tapZoom",A),this._add("clickZoom",R),t.interactive&&t.doubleClickZoom&&o.doubleClickZoom.enable();const F=new ef;this._add("tapDragZoom",F);const V=o.touchPitch=new cc(o);this._add("touchPitch",V),t.interactive&&t.touchPitch&&o.touchPitch.enable(t.touchPitch);const q=()=>o.project(o.getCenter()),te=(function({enable:qe,clickTolerance:tt,aroundCenter:lt=!0,minPixelCenterThreshold:Ke=100,rotateDegreesPerPixelMoved:dt=.8},Rt){const Tt=new Fl({checkCorrectEvent:kt=>N.mouseButton(kt)===0&&kt.ctrlKey||N.mouseButton(kt)===2&&!kt.ctrlKey});return new Ao({clickTolerance:tt,move:(kt,Ct)=>{const ur=Rt();if(lt&&Math.abs(ur.y-kt.y)>Ke)return{bearingDelta:s.cx(new s.P(kt.x,Ct.y),Ct,ur)};let hr=(Ct.x-kt.x)*dt;return lt&&Ct.y<ur.y&&(hr=-hr),{bearingDelta:hr}},moveStateManager:Tt,enable:qe,assignEvents:Ll})})(t,q),ee=(function({enable:qe,clickTolerance:tt,pitchDegreesPerPixelMoved:lt=-.5}){const Ke=new Fl({checkCorrectEvent:dt=>N.mouseButton(dt)===0&&dt.ctrlKey||N.mouseButton(dt)===2});return new Ao({clickTolerance:tt,move:(dt,Rt)=>({pitchDelta:(Rt.y-dt.y)*lt}),moveStateManager:Ke,enable:qe,assignEvents:Ll})})(t),ce=(function({enable:qe,clickTolerance:tt,rollDegreesPerPixelMoved:lt=.3},Ke){const dt=new Fl({checkCorrectEvent:Rt=>N.mouseButton(Rt)===2&&Rt.ctrlKey});return new Ao({clickTolerance:tt,move:(Rt,Tt)=>{const kt=Ke();let Ct=(Tt.x-Rt.x)*lt;return Tt.y<kt.y&&(Ct=-Ct),{rollDelta:Ct}},moveStateManager:dt,enable:qe,assignEvents:Ll})})(t,q);o.dragRotate=new ao(t,te,ee,ce),this._add("mouseRotate",te,["mousePitch"]),this._add("mousePitch",ee,["mouseRotate","mouseRoll"]),this._add("mouseRoll",ce,["mousePitch"]),t.interactive&&t.dragRotate&&o.dragRotate.enable();const _e=(function({enable:qe,clickTolerance:tt}){const lt=new Fl({checkCorrectEvent:Ke=>N.mouseButton(Ke)===0&&!Ke.ctrlKey});return new Ao({clickTolerance:tt,move:(Ke,dt)=>({around:dt,panDelta:dt.sub(Ke)}),activateOnStart:!0,moveStateManager:lt,enable:qe,assignEvents:Ll})})(t),Ie=new Nf(t,o);o.dragPan=new Cd(d,_e,Ie),this._add("mousePan",_e),this._add("touchPan",Ie,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&o.dragPan.enable(t.dragPan);const Be=new Jh,ze=new Ol;o.touchZoomRotate=new ku(d,ze,Be,F),this._add("touchRotate",Be,["touchPan","touchZoom"]),this._add("touchZoom",ze,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&o.touchZoomRotate.enable(t.touchZoomRotate),this._add("blockableMapEvent",new Fp(o));const Ze=o.scrollZoom=new Qh(o,(()=>this._triggerRenderFrame()));this._add("scrollZoom",Ze,["mousePan"]),t.interactive&&t.scrollZoom&&o.scrollZoom.enable(t.scrollZoom);const rt=o.keyboard=new Qn(o);this._add("keyboard",rt),t.interactive&&t.keyboard&&o.keyboard.enable()}_add(t,o,d){this._handlers.push({handlerName:t,handler:o,allowed:d}),this._handlersById[t]=o}stop(t){if(!this._updatingCamera){for(const{handler:o}of this._handlers)o.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!jr(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,o,d){for(const x in t)if(x!==d&&(!o||o.indexOf(x)<0))return!0;return!1}_getMapTouches(t){const o=[];for(const d of t)this._el.contains(d.target)&&o.push(d);return o}mergeHandlerResult(t,o,d,x,S){if(!d)return;s.e(t,d);const A={handlerName:x,originalEvent:d.originalEvent||S};d.zoomDelta!==void 0&&(o.zoom=A),d.panDelta!==void 0&&(o.drag=A),d.rollDelta!==void 0&&(o.roll=A),d.pitchDelta!==void 0&&(o.pitch=A),d.bearingDelta!==void 0&&(o.rotate=A)}_applyChanges(){const t={},o={},d={};for(const[x,S,A]of this._changes)x.panDelta&&(t.panDelta=(t.panDelta||new s.P(0,0))._add(x.panDelta)),x.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+x.zoomDelta),x.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+x.bearingDelta),x.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+x.pitchDelta),x.rollDelta&&(t.rollDelta=(t.rollDelta||0)+x.rollDelta),x.around!==void 0&&(t.around=x.around),x.pinchAround!==void 0&&(t.pinchAround=x.pinchAround),x.noInertia&&(t.noInertia=x.noInertia),s.e(o,S),s.e(d,A);this._updateMapTransform(t,o,d),this._changes=[]}_updateMapTransform(t,o,d){const x=this._map,S=x._getTransformForUpdate(),A=x.terrain;if(!(gh(t)||A&&this._terrainMovement))return this._fireEvents(o,d,!0);x._stop(!0);let{panDelta:R,zoomDelta:F,bearingDelta:V,pitchDelta:q,rollDelta:te,around:ee,pinchAround:ce}=t;ce!==void 0&&(ee=ce),ee=ee||x.transform.centerPoint,A&&!S.isPointOnMapSurface(ee)&&(ee=S.centerPoint);const _e={panDelta:R,zoomDelta:F,rollDelta:te,pitchDelta:q,bearingDelta:V,around:ee};this._map.cameraHelper.useGlobeControls&&!S.isPointOnMapSurface(ee)&&(ee=S.centerPoint);const Ie=ee.distSqr(S.centerPoint)<.01?S.center:S.screenPointToLocation(R?ee.sub(R):ee);this._handleMapControls({terrain:A,tr:S,deltasForHelper:_e,preZoomAroundLoc:Ie,combinedEventsInProgress:o,panDelta:R}),x._applyUpdatedTransform(S),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(o,d,!0)}_handleMapControls({terrain:t,tr:o,deltasForHelper:d,preZoomAroundLoc:x,combinedEventsInProgress:S,panDelta:A}){const R=this._map.cameraHelper;if(R.handleMapControlsRollPitchBearingZoom(d,o),t)return R.useGlobeControls?(this._terrainMovement||!S.drag&&!S.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void R.handleMapControlsPan(d,o,x)):this._terrainMovement||!S.drag&&!S.zoom?void(S.drag&&this._terrainMovement&&A?o.setCenter(o.screenPointToLocation(o.centerPoint.sub(A))):R.handleMapControlsPan(d,o,x)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void R.handleMapControlsPan(d,o,x));R.handleMapControlsPan(d,o,x)}_fireEvents(t,o,d){const x=jr(this._eventsInProgress),S=jr(t),A={};for(const te in t){const{originalEvent:ee}=t[te];this._eventsInProgress[te]||(A[`${te}start`]=ee),this._eventsInProgress[te]=t[te]}!x&&S&&this._fireEvent("movestart",S.originalEvent);for(const te in A)this._fireEvent(te,A[te]);S&&this._fireEvent("move",S.originalEvent);for(const te in t){const{originalEvent:ee}=t[te];this._fireEvent(te,ee)}const R={};let F;for(const te in this._eventsInProgress){const{handlerName:ee,originalEvent:ce}=this._eventsInProgress[te];this._handlersById[ee].isActive()||(delete this._eventsInProgress[te],F=o[ee]||ce,R[`${te}end`]=F)}for(const te in R)this._fireEvent(te,R[te]);const V=jr(this._eventsInProgress),q=(x||S)&&!V;if(q&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const te=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&te.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(te)}if(d&&q){this._updatingCamera=!0;const te=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ee=ce=>ce!==0&&-this._bearingSnap<ce&&ce<this._bearingSnap;!te||!te.essential&&j.prefersReducedMotion?(this._map.fire(new s.l("moveend",{originalEvent:F})),ee(this._map.getBearing())&&this._map.resetNorth()):(ee(te.bearing||this._map.getBearing())&&(te.bearing=0),te.freezeElevation=!0,this._map.easeTo(te,{originalEvent:F})),this._updatingCamera=!1}}_fireEvent(t,o){this._map.fire(new s.l(t,o?{originalEvent:o}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((t=>{delete this._frameId,this.handleEvent(new Co("renderFrame",{timeStamp:t})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class ni extends s.E{constructor(t,o,d){super(),this._renderFrameCallback=()=>{const x=Math.min((O()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(x)),x<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=d.bearingSnap,this.cameraHelper=o,this.on("moveend",(()=>{delete this._requestedCameraState}))}migrateProjection(t,o){t.apply(this.transform),this.transform=t,this.cameraHelper=o}getCenter(){return new s.V(this.transform.center.lng,this.transform.center.lat)}setCenter(t,o){return this.jumpTo({center:t},o)}getCenterElevation(){return this.transform.elevation}setCenterElevation(t,o){return this.jumpTo({elevation:t},o),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(t){this._centerClampedToGround=t}panBy(t,o,d){return t=s.P.convert(t).mult(-1),this.panTo(this.transform.center,s.e({offset:t},o),d)}panTo(t,o,d){return this.easeTo(s.e({center:t},o),d)}getZoom(){return this.transform.zoom}setZoom(t,o){return this.jumpTo({zoom:t},o),this}zoomTo(t,o,d){return this.easeTo(s.e({zoom:t},o),d)}zoomIn(t,o){return this.zoomTo(this.getZoom()+1,t,o),this}zoomOut(t,o){return this.zoomTo(this.getZoom()-1,t,o),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(t,o){return t!=this.transform.fov&&(this.transform.setFov(t),this.fire(new s.l("movestart",o)).fire(new s.l("move",o)).fire(new s.l("moveend",o))),this}getBearing(){return this.transform.bearing}setBearing(t,o){return this.jumpTo({bearing:t},o),this}getPadding(){return this.transform.padding}setPadding(t,o){return this.jumpTo({padding:t},o),this}rotateTo(t,o,d){return this.easeTo(s.e({bearing:t},o),d)}resetNorth(t,o){return this.rotateTo(0,s.e({duration:1e3},t),o),this}resetNorthPitch(t,o){return this.easeTo(s.e({bearing:0,pitch:0,roll:0,duration:1e3},t),o),this}snapToNorth(t,o){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,o):this}getPitch(){return this.transform.pitch}setPitch(t,o){return this.jumpTo({pitch:t},o),this}getRoll(){return this.transform.roll}setRoll(t,o){return this.jumpTo({roll:t},o),this}cameraForBounds(t,o){t=Ee.convert(t).adjustAntiMeridian();const d=o&&o.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),d,o)}_cameraForBoxAndBearing(t,o,d,x){const S={top:0,bottom:0,right:0,left:0};if(typeof(x=s.e({padding:S,offset:[0,0],maxZoom:this.transform.maxZoom},x)).padding=="number"){const V=x.padding;x.padding={top:V,bottom:V,right:V,left:V}}const A=s.e(S,x.padding);x.padding=A;const R=this.transform,F=new Ee(t,o);return this.cameraHelper.cameraForBoxAndBearing(x,A,F,d,R)}fitBounds(t,o,d){return this._fitInternal(this.cameraForBounds(t,o),o,d)}fitScreenCoordinates(t,o,d,x,S){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(s.P.convert(t)),this.transform.screenPointToLocation(s.P.convert(o)),d,x),x,S)}_fitInternal(t,o,d){return t?(delete(o=s.e(t,o)).padding,o.linear?this.easeTo(o,d):this.flyTo(o,d)):this}jumpTo(t,o){this.stop();const d=this._getTransformForUpdate();let x=!1,S=!1,A=!1;const R=d.zoom;this.cameraHelper.handleJumpToCenterZoom(d,t);const F=d.zoom!==R;return"elevation"in t&&d.elevation!==+t.elevation&&d.setElevation(+t.elevation),"bearing"in t&&d.bearing!==+t.bearing&&(x=!0,d.setBearing(+t.bearing)),"pitch"in t&&d.pitch!==+t.pitch&&(S=!0,d.setPitch(+t.pitch)),"roll"in t&&d.roll!==+t.roll&&(A=!0,d.setRoll(+t.roll)),t.padding==null||d.isPaddingEqual(t.padding)||d.setPadding(t.padding),this._applyUpdatedTransform(d),this.fire(new s.l("movestart",o)).fire(new s.l("move",o)),F&&this.fire(new s.l("zoomstart",o)).fire(new s.l("zoom",o)).fire(new s.l("zoomend",o)),x&&this.fire(new s.l("rotatestart",o)).fire(new s.l("rotate",o)).fire(new s.l("rotateend",o)),S&&this.fire(new s.l("pitchstart",o)).fire(new s.l("pitch",o)).fire(new s.l("pitchend",o)),A&&this.fire(new s.l("rollstart",o)).fire(new s.l("roll",o)).fire(new s.l("rollend",o)),this.fire(new s.l("moveend",o))}calculateCameraOptionsFromTo(t,o,d,x=0){const S=s.a9.fromLngLat(t,o),A=s.a9.fromLngLat(d,x),R=A.x-S.x,F=A.y-S.y,V=A.z-S.z,q=Math.hypot(R,F,V);if(q===0)throw new Error("Can't calculate camera options with same From and To");const te=Math.hypot(R,F),ee=s.at(this.transform.cameraToCenterDistance/q/this.transform.tileSize),ce=180*Math.atan2(R,-F)/Math.PI;let _e=180*Math.acos(te/q)/Math.PI;return _e=V<0?90-_e:90+_e,{center:A.toLngLat(),elevation:x,zoom:ee,pitch:_e,bearing:ce}}calculateCameraOptionsFromCameraLngLatAltRotation(t,o,d,x,S){const A=this.transform.calculateCenterFromCameraLngLatAlt(t,o,d,x);return{center:A.center,elevation:A.elevation,zoom:A.zoom,bearing:d,pitch:x,roll:S}}easeTo(t,o){this._stop(!1,t.easeId),((t=s.e({offset:[0,0],duration:500,easing:s.cy},t)).animate===!1||!t.essential&&j.prefersReducedMotion)&&(t.duration=0);const d=this._getTransformForUpdate(),x=this.getBearing(),S=d.pitch,A=d.roll,R="bearing"in t?this._normalizeBearing(t.bearing,x):x,F="pitch"in t?+t.pitch:S,V="roll"in t?this._normalizeBearing(t.roll,A):A,q="padding"in t?t.padding:d.padding,te=s.P.convert(t.offset);let ee,ce;t.around&&(ee=s.V.convert(t.around),ce=d.locationToScreenPoint(ee));const _e={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},Ie=this.cameraHelper.handleEaseTo(d,{bearing:R,pitch:F,roll:V,padding:q,around:ee,aroundPoint:ce,offsetAsPoint:te,offset:t.offset,zoom:t.zoom,center:t.center});return this._rotating=this._rotating||x!==R,this._pitching=this._pitching||F!==S,this._rolling=this._rolling||V!==A,this._padding=!d.isPaddingEqual(q),this._zooming=this._zooming||Ie.isZooming,this._easeId=t.easeId,this._prepareEase(o,t.noMoveStart,_e),this.terrain&&this._prepareElevation(Ie.elevationCenter),this._ease((Be=>{Ie.easeFunc(Be),this.terrain&&!t.freezeElevation&&this._updateElevation(Be),this._applyUpdatedTransform(d),this._fireMoveEvents(o)}),(Be=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(o,Be)}),t),this}_prepareEase(t,o,d={}){this._moving=!0,o||d.moving||this.fire(new s.l("movestart",t)),this._zooming&&!d.zooming&&this.fire(new s.l("zoomstart",t)),this._rotating&&!d.rotating&&this.fire(new s.l("rotatestart",t)),this._pitching&&!d.pitching&&this.fire(new s.l("pitchstart",t)),this._rolling&&!d.rolling&&this.fire(new s.l("rollstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const o=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&o!==this._elevationTarget){const d=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(d-(o-(d*t+this._elevationStart))/(1-t)),this._elevationTarget=o}this.transform.setElevation(s.G.number(this._elevationStart,this._elevationTarget,t))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(t){if(!this.terrain&&t.elevation>=0&&t.pitch<=90)return{};const o=t.getCameraLngLat(),d=t.getCameraAltitude(),x=this.terrain?this.terrain.getElevationForLngLatZoom(o,t.zoom):0;if(d<x){const S=this.calculateCameraOptionsFromTo(o,x,t.center,t.elevation);return{pitch:S.pitch,zoom:S.zoom}}return{}}_applyUpdatedTransform(t){const o=[];if(o.push((x=>this._elevateCameraIfInsideTerrain(x))),this.transformCameraUpdate&&o.push((x=>this.transformCameraUpdate(x))),!o.length)return;const d=t.clone();for(const x of o){const S=d.clone(),{center:A,zoom:R,roll:F,pitch:V,bearing:q,elevation:te}=x(S);A&&S.setCenter(A),te!==void 0&&S.setElevation(te),R!==void 0&&S.setZoom(R),F!==void 0&&S.setRoll(F),V!==void 0&&S.setPitch(V),q!==void 0&&S.setBearing(q),d.apply(S)}this.transform.apply(d)}_fireMoveEvents(t){this.fire(new s.l("move",t)),this._zooming&&this.fire(new s.l("zoom",t)),this._rotating&&this.fire(new s.l("rotate",t)),this._pitching&&this.fire(new s.l("pitch",t)),this._rolling&&this.fire(new s.l("roll",t))}_afterEase(t,o){if(this._easeId&&o&&this._easeId===o)return;delete this._easeId;const d=this._zooming,x=this._rotating,S=this._pitching,A=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,d&&this.fire(new s.l("zoomend",t)),x&&this.fire(new s.l("rotateend",t)),S&&this.fire(new s.l("pitchend",t)),A&&this.fire(new s.l("rollend",t)),this.fire(new s.l("moveend",t))}flyTo(t,o){if(!t.essential&&j.prefersReducedMotion){const Ct=s.U(t,["center","zoom","bearing","pitch","roll","elevation","padding"]);return this.jumpTo(Ct,o)}this.stop(),t=s.e({offset:[0,0],speed:1.2,curve:1.42,easing:s.cy},t);const d=this._getTransformForUpdate(),x=d.bearing,S=d.pitch,A=d.roll,R=d.padding,F="bearing"in t?this._normalizeBearing(t.bearing,x):x,V="pitch"in t?+t.pitch:S,q="roll"in t?this._normalizeBearing(t.roll,A):A,te="padding"in t?t.padding:d.padding,ee=s.P.convert(t.offset);let ce=d.centerPoint.add(ee);const _e=d.screenPointToLocation(ce),Ie=this.cameraHelper.handleFlyTo(d,{bearing:F,pitch:V,roll:q,padding:te,locationAtOffset:_e,offsetAsPoint:ee,center:t.center,minZoom:t.minZoom,zoom:t.zoom});let Be=t.curve;const ze=Math.max(d.width,d.height),Ze=ze/Ie.scaleOfZoom,rt=Ie.pixelPathLength;typeof Ie.scaleOfMinZoom=="number"&&(Be=Math.sqrt(ze/Ie.scaleOfMinZoom/rt*2));const qe=Be*Be;function tt(Ct){const ur=(Ze*Ze-ze*ze+(Ct?-1:1)*qe*qe*rt*rt)/(2*(Ct?Ze:ze)*qe*rt);return Math.log(Math.sqrt(ur*ur+1)-ur)}function lt(Ct){return(Math.exp(Ct)-Math.exp(-Ct))/2}function Ke(Ct){return(Math.exp(Ct)+Math.exp(-Ct))/2}const dt=tt(!1);let Rt=function(Ct){return Ke(dt)/Ke(dt+Be*Ct)},Tt=function(Ct){return ze*((Ke(dt)*(lt(ur=dt+Be*Ct)/Ke(ur))-lt(dt))/qe)/rt;var ur},kt=(tt(!0)-dt)/Be;if(Math.abs(rt)<2e-6||!isFinite(kt)){if(Math.abs(ze-Ze)<1e-6)return this.easeTo(t,o);const Ct=Ze<ze?-1:1;kt=Math.abs(Math.log(Ze/ze))/Be,Tt=()=>0,Rt=ur=>Math.exp(Ct*Be*ur)}return t.duration="duration"in t?+t.duration:1e3*kt/("screenSpeed"in t?+t.screenSpeed/Be:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=x!==F,this._pitching=V!==S,this._rolling=q!==A,this._padding=!d.isPaddingEqual(te),this._prepareEase(o,!1),this.terrain&&this._prepareElevation(Ie.targetCenter),this._ease((Ct=>{const ur=Ct*kt,hr=1/Rt(ur),tr=Tt(ur);this._rotating&&d.setBearing(s.G.number(x,F,Ct)),this._pitching&&d.setPitch(s.G.number(S,V,Ct)),this._rolling&&d.setRoll(s.G.number(A,q,Ct)),this._padding&&(d.interpolatePadding(R,te,Ct),ce=d.centerPoint.add(ee)),Ie.easeFunc(Ct,hr,tr,ce),this.terrain&&!t.freezeElevation&&this._updateElevation(Ct),this._applyUpdatedTransform(d),this._fireMoveEvents(o)}),(()=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(o)}),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,o){var d;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const x=this._onEaseEnd;delete this._onEaseEnd,x.call(this,o)}return t||(d=this.handlers)===null||d===void 0||d.stop(!1),this}_ease(t,o,d){d.animate===!1||d.duration===0?(t(1),o()):(this._easeStart=O(),this._easeOptions=d,this._onEaseFrame=t,this._onEaseEnd=o,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,o){t=s.W(t,-180,180);const d=Math.abs(t-o);return Math.abs(t-360-o)<d&&(t-=360),Math.abs(t+360-o)<d&&(t+=360),t}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLat(s.V.convert(t),this.transform):null}}const Va={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class $a{constructor(t=Va){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=o=>{!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"&&o.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options.compact,this._container=N.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=N.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=N.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){N.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,o){const d=this._map._getUIString(`AttributionControl.${o}`);t.title=d,t.setAttribute("aria-label",d)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map((x=>typeof x!="string"?"":x))):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const x=this._map.style.stylesheet;this.styleOwner=x.owner,this.styleId=x.id}const o=this._map.style.tileManagers;for(const x in o){const S=o[x];if(S.used||S.usedForTerrain){const A=S.getSource();A.attribution&&t.indexOf(A.attribution)<0&&t.push(A.attribution)}}t=t.filter((x=>String(x).trim())),t.sort(((x,S)=>x.length-S.length)),t=t.filter(((x,S)=>{for(let A=S+1;A<t.length;A++)if(t[A].indexOf(x)>=0)return!1;return!0}));const d=t.join(" | ");d!==this._attribHTML&&(this._attribHTML=d,t.length?(this._innerContainer.innerHTML=N.sanitize(d),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class rf{constructor(t={}){this._updateCompact=()=>{const o=this._container.children;if(o.length){const d=o[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&d.classList.add("maplibregl-compact"):d.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=N.create("div","maplibregl-ctrl");const o=N.create("a","maplibregl-ctrl-logo");return o.target="_blank",o.rel="noopener nofollow",o.href="https://maplibre.org/",o.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),o.setAttribute("rel","noopener nofollow"),this._container.appendChild(o),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){N.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class hc{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const o=++this._id;return this._queue.push({callback:t,id:o,cancelled:!1}),o}remove(t){const o=this._currentlyRunning,d=o?this._queue.concat(o):this._queue;for(const x of d)if(x.id===t)return void(x.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const o=this._currentlyRunning=this._queue;this._queue=[];for(const d of o)if(!d.cancelled&&(d.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Sn=s.aU([{name:"a_pos3d",type:"Int16",components:3}]);class Xn extends s.E{constructor(t){super(),this._lastTilesetChange=O(),this.tileManager=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=t._source.tileSize*2**this.deltaZoom,t.usedForTerrain=!0,t.tileSize=this.tileSize}destruct(){this.tileManager.usedForTerrain=!1,this.tileManager.tileSize=null}getSource(){return this.tileManager._source}update(t,o){this.tileManager.update(t,o),this._renderableTilesKeys=[];const d={};for(const x of tn(t,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:o,calculateTileZoom:this.tileManager._source.calculateTileZoom}))d[x.key]=!0,this._renderableTilesKeys.push(x.key),this._tiles[x.key]||(x.terrainRttPosMatrix32f=new Float64Array(16),s.c7(x.terrainRttPosMatrix32f,0,s.a5,s.a5,0,0,1),this._tiles[x.key]=new zt(x,this.tileSize),this._lastTilesetChange=O());for(const x in this._tiles)d[x]||delete this._tiles[x]}freeRtt(t){for(const o in this._tiles){const d=this._tiles[o];(!t||d.tileID.equals(t)||d.tileID.isChildOf(t)||t.isChildOf(d.tileID))&&(d.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((t=>this.getTileByID(t)))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t,o){return o?this._getTerrainCoordsForTileRanges(t,o):this._getTerrainCoordsForRegularTile(t)}_getTerrainCoordsForRegularTile(t){const o={};for(const d of this._renderableTilesKeys){const x=this._tiles[d].tileID,S=t.clone(),A=s.bk();if(x.canonical.equals(t.canonical))s.c7(A,0,s.a5,s.a5,0,0,1);else if(x.canonical.isChildOf(t.canonical)){const R=x.canonical.z-t.canonical.z,F=x.canonical.x-(x.canonical.x>>R<<R),V=x.canonical.y-(x.canonical.y>>R<<R),q=s.a5>>R;s.c7(A,0,q,q,0,0,1),s.O(A,A,[-F*q,-V*q,0])}else{if(!t.canonical.isChildOf(x.canonical))continue;{const R=t.canonical.z-x.canonical.z,F=t.canonical.x-(t.canonical.x>>R<<R),V=t.canonical.y-(t.canonical.y>>R<<R),q=s.a5>>R;s.c7(A,0,s.a5,s.a5,0,0,1),s.O(A,A,[F*q,V*q,0]),s.Q(A,A,[1/2**R,1/2**R,0])}}S.terrainRttPosMatrix32f=new Float32Array(A),o[d]=S}return o}_getTerrainCoordsForTileRanges(t,o){const d={};for(const x of this._renderableTilesKeys){const S=this._tiles[x].tileID;if(!this._isWithinTileRanges(S,o))continue;const A=t.clone(),R=s.bk();if(S.canonical.z===t.canonical.z){const F=t.canonical.x-S.canonical.x,V=t.canonical.y-S.canonical.y;s.c7(R,0,s.a5,s.a5,0,0,1),s.O(R,R,[F*s.a5,V*s.a5,0])}else if(S.canonical.z>t.canonical.z){const F=S.canonical.z-t.canonical.z,V=S.canonical.x-(S.canonical.x>>F<<F),q=S.canonical.y-(S.canonical.y>>F<<F),te=t.canonical.x-(S.canonical.x>>F),ee=t.canonical.y-(S.canonical.y>>F),ce=s.a5>>F;s.c7(R,0,ce,ce,0,0,1),s.O(R,R,[-V*ce+te*s.a5,-q*ce+ee*s.a5,0])}else{const F=t.canonical.z-S.canonical.z,V=t.canonical.x-(t.canonical.x>>F<<F),q=t.canonical.y-(t.canonical.y>>F<<F),te=(t.canonical.x>>F)-S.canonical.x,ee=(t.canonical.y>>F)-S.canonical.y,ce=s.a5<<F;s.c7(R,0,ce,ce,0,0,1),s.O(R,R,[V*s.a5+te*ce,q*s.a5+ee*ce,0])}A.terrainRttPosMatrix32f=new Float32Array(R),d[x]=A}return d}getSourceTile(t,o){const d=this.tileManager._source;let x=t.overscaledZ-this.deltaZoom;if(x>d.maxzoom&&(x=d.maxzoom),x<d.minzoom)return;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(x).key);let S=this.findTileInCaches(this._sourceTileCache[t.key]);if(!S?.dem&&o)for(;x>=d.minzoom&&!S?.dem;)S=this.findTileInCaches(t.scaledTo(x--).key);return S}findTileInCaches(t){let o=this.tileManager.getTileByID(t);return o||(o=this.tileManager._outOfViewCache.getByKey(t),o)}anyTilesAfterTime(t=Date.now()){return this._lastTilesetChange>=t}_isWithinTileRanges(t,o){return o[t.canonical.z]&&t.canonical.x>=o[t.canonical.z].minTileX&&t.canonical.x<=o[t.canonical.z].maxTileX&&t.canonical.y>=o[t.canonical.z].minTileY&&t.canonical.y<=o[t.canonical.z].maxTileY}}class wn{constructor(t,o,d){this._meshCache={},this.painter=t,this.tileManager=new Xn(o),this.options=d,this.exaggeration=typeof d.exaggeration=="number"?d.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,o,d,x=s.a5){var S;if(!(o>=0&&o<x&&d>=0&&d<x))return 0;const A=this.getTerrainData(t),R=(S=A.tile)===null||S===void 0?void 0:S.dem;if(!R)return 0;const F=s.cC([],[o/x*s.a5,d/x*s.a5],A.u_terrain_matrix),V=[F[0]*R.dim,F[1]*R.dim],q=Math.floor(V[0]),te=Math.floor(V[1]),ee=V[0]-q,ce=V[1]-te;return R.get(q,te)*(1-ee)*(1-ce)+R.get(q+1,te)*ee*(1-ce)+R.get(q,te+1)*(1-ee)*ce+R.get(q+1,te+1)*ee*ce}getElevationForLngLatZoom(t,o){if(!s.cD(o,t.wrap()))return 0;const{tileID:d,mercatorX:x,mercatorY:S}=this._getOverscaledTileIDFromLngLatZoom(t,o);return this.getElevation(d,x%s.a5,S%s.a5,s.a5)}getElevationForLngLat(t,o){const d=tn(o,{maxzoom:this.tileManager.maxzoom,minzoom:this.tileManager.minzoom,tileSize:512,terrain:this});let x=0;for(const S of d)S.canonical.z>x&&(x=Math.min(S.canonical.z,this.tileManager.maxzoom));return this.getElevationForLngLatZoom(t,x)}getElevation(t,o,d,x=s.a5){return this.getDEMElevation(t,o,d,x)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const x=this.painter.context,S=new s.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new s.T(x,S,x.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new s.T(x,new s.R({width:1,height:1}),x.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(x.gl.NEAREST,x.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=s.ar([])}const o=this.tileManager.getSourceTile(t,!0);if(o&&o.dem&&(!o.demTexture||o.needsTerrainPrepare)){const x=this.painter.context;o.demTexture=this.painter.getTileTexture(o.dem.stride),o.demTexture?o.demTexture.update(o.dem.getPixels(),{premultiply:!1}):o.demTexture=new s.T(x,o.dem.getPixels(),x.gl.RGBA,{premultiply:!1}),o.demTexture.bind(x.gl.NEAREST,x.gl.CLAMP_TO_EDGE),o.needsTerrainPrepare=!1}const d=o&&o.toString()+o.tileID.key+t.key;if(d&&!this._demMatrixCache[d]){const x=this.tileManager.getSource().maxzoom;let S=t.canonical.z-o.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=x?S=t.canonical.z-x:s.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const A=t.canonical.x-(t.canonical.x>>S<<S),R=t.canonical.y-(t.canonical.y>>S<<S),F=s.cE(new Float64Array(16),[1/(s.a5<<S),1/(s.a5<<S),0]);s.O(F,F,[A*s.a5,R*s.a5,0]),this._demMatrixCache[t.key]={matrix:F,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:o&&o.dem&&o.dem.dim||1,u_terrain_matrix:d?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:o&&o.dem&&o.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(o&&o.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:o}}getFramebuffer(t){const o=this.painter,d=o.width/devicePixelRatio,x=o.height/devicePixelRatio;return!this._fbo||this._fbo.width===d&&this._fbo.height===x||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new s.T(o.context,{width:d,height:x,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new s.T(o.context,{width:d,height:x,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=o.context.createFramebuffer(d,x,!0,!1),this._fbo.depthAttachment.set(o.context.createRenderbuffer(o.context.gl.DEPTH_COMPONENT16,d,x))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const o=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let S=0,A=0;S<this._coordsTextureSize;S++)for(let R=0;R<this._coordsTextureSize;R++,A+=4)o[A+0]=255&R,o[A+1]=255&S,o[A+2]=R>>8<<4|S>>8,o[A+3]=0;const d=new s.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(o.buffer)),x=new s.T(t,d,t.gl.RGBA,{premultiply:!1});return x.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=x,x}pointCoordinate(t){this.painter.maybeDrawDepthAndCoords(!0);const o=new Uint8Array(4),d=this.painter.context,x=d.gl,S=Math.round(t.x*this.painter.pixelRatio/devicePixelRatio),A=Math.round(t.y*this.painter.pixelRatio/devicePixelRatio),R=Math.round(this.painter.height/devicePixelRatio);d.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),x.readPixels(S,R-A-1,1,1,x.RGBA,x.UNSIGNED_BYTE,o),d.bindFramebuffer.set(null);const F=o[0]+(o[2]>>4<<8),V=o[1]+((15&o[2])<<8),q=this.coordsIndex[255-o[3]],te=q&&this.tileManager.getTileByID(q);if(!te)return null;const ee=this._coordsTextureSize,ce=(1<<te.tileID.canonical.z)*ee;return new s.a9((te.tileID.canonical.x*ee+F)/ce+te.tileID.wrap,(te.tileID.canonical.y*ee+V)/ce,this.getElevation(te.tileID,F,V,ee))}depthAtPoint(t){const o=new Uint8Array(4),d=this.painter.context,x=d.gl;return d.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),x.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,x.RGBA,x.UNSIGNED_BYTE,o),d.bindFramebuffer.set(null),(o[0]/16777216+o[1]/65536+o[2]/256+o[3])/256}getTerrainMesh(t){var o;const d=((o=this.painter.style.projection)===null||o===void 0?void 0:o.transitionState)>0,x=d&&t.canonical.y===0,S=d&&t.canonical.y===(1<<t.canonical.z)-1,A=`m_${x?"n":""}_${S?"s":""}`;if(this._meshCache[A])return this._meshCache[A];const R=this.painter.context,F=new s.cF,V=new s.aY,q=this.meshSize,te=s.a5/q,ee=q*q;for(let Ke=0;Ke<=q;Ke++)for(let dt=0;dt<=q;dt++)F.emplaceBack(dt*te,Ke*te,0);for(let Ke=0;Ke<ee;Ke+=q+1)for(let dt=0;dt<q;dt++)V.emplaceBack(dt+Ke,q+dt+Ke+1,q+dt+Ke+2),V.emplaceBack(dt+Ke,q+dt+Ke+2,dt+Ke+1);const ce=F.length,_e=ce+(q+1),Ie=(q+1)*q,Be=x?s.br:0,ze=x?0:1,Ze=S?s.bs:s.a5,rt=S?0:1;for(let Ke=0;Ke<=q;Ke++)F.emplaceBack(Ke*te,Be,ze);for(let Ke=0;Ke<=q;Ke++)F.emplaceBack(Ke*te,Ze,rt);for(let Ke=0;Ke<q;Ke++)V.emplaceBack(Ie+Ke,_e+Ke,_e+Ke+1),V.emplaceBack(Ie+Ke,_e+Ke+1,Ie+Ke+1),V.emplaceBack(0+Ke,ce+Ke+1,ce+Ke),V.emplaceBack(0+Ke,0+Ke+1,ce+Ke+1);const qe=F.length,tt=qe+2*(q+1);for(const Ke of[0,1])for(let dt=0;dt<=q;dt++)for(const Rt of[0,1])F.emplaceBack(Ke*s.a5,dt*te,Rt);for(let Ke=0;Ke<2*q;Ke+=2)V.emplaceBack(qe+Ke,qe+Ke+1,qe+Ke+3),V.emplaceBack(qe+Ke,qe+Ke+3,qe+Ke+2),V.emplaceBack(tt+Ke,tt+Ke+3,tt+Ke+1),V.emplaceBack(tt+Ke,tt+Ke+2,tt+Ke+3);const lt=new Jn(R.createVertexBuffer(F,Sn.members),R.createIndexBuffer(V),s.aX.simpleSegment(0,0,F.length,V.length));return this._meshCache[A]=lt,lt}getMeshFrameDelta(t){return 2*Math.PI*s.bE/Math.pow(2,Math.max(t,0))/5}getMinTileElevationForLngLatZoom(t,o){var d;if(!s.cD(o,t.wrap()))return 0;const{tileID:x}=this._getOverscaledTileIDFromLngLatZoom(t,o);return(d=this.getMinMaxElevation(x).minElevation)!==null&&d!==void 0?d:0}getMinMaxElevation(t){const o=this.getTerrainData(t).tile,d={minElevation:null,maxElevation:null};return o&&o.dem&&(d.minElevation=o.dem.min*this.exaggeration,d.maxElevation=o.dem.max*this.exaggeration),d}_getOverscaledTileIDFromLngLatZoom(t,o){const d=s.a9.fromLngLat(t.wrap()),x=(1<<o)*s.a5,S=d.x*x,A=d.y*x,R=Math.floor(S/s.a5),F=Math.floor(A/s.a5);return{tileID:new s.a2(o,0,o,R,F),mercatorX:S,mercatorY:A}}}class Fa{constructor(t,o,d){this._context=t,this._size=o,this._tileSize=d,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const o=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),d=new s.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return d.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),o.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),o.colorAttachment.set(d.texture),{id:t,fbo:o,texture:d,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((o=>t.id!==o)),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const o of this._recentlyUsed)if(!this._objects[o].inUse)return this._objects[o];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((t=>!t.inUse))===!1}}const Mo={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class cl{constructor(t,o){this.painter=t,this.terrain=o,this.pool=new Fa(t.context,30,o.tileManager.tileSize*o.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,o){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.tileManager.getRenderableTiles(),this._renderableLayerIds=t._order.filter((d=>!t._layers[d].isHidden(o))),this._coordsAscending={};for(const d in t.tileManagers){this._coordsAscending[d]={};const x=t.tileManagers[d].getVisibleCoordinates(),S=t.tileManagers[d].getSource(),A=S instanceof ir?S.terrainTileRanges:null;for(const R of x){const F=this.terrain.tileManager.getTerrainCoords(R,A);for(const V in F)this._coordsAscending[d][V]||(this._coordsAscending[d][V]=[]),this._coordsAscending[d][V].push(F[V])}}this._coordsAscendingStr={};for(const d of t._order){const x=t._layers[d],S=x.source;if(Mo[x.type]&&!this._coordsAscendingStr[S]){this._coordsAscendingStr[S]={};for(const A in this._coordsAscending[S])this._coordsAscendingStr[S][A]=this._coordsAscending[S][A].map((R=>R.key)).sort().join()}}for(const d of this._renderableTiles)for(const x in this._coordsAscendingStr){const S=this._coordsAscendingStr[x][d.tileID.key];S&&S!==d.rttCoords[x]&&(d.rtt=[])}}renderLayer(t,o){if(t.isHidden(this.painter.transform.zoom))return!1;const d=Object.assign(Object.assign({},o),{isRenderingToTexture:!0}),x=t.type,S=this.painter,A=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(Mo[x]&&(this._prevType&&Mo[this._prevType]||this._stacks.push([]),this._prevType=x,this._stacks[this._stacks.length-1].push(t.id),!A))return!0;if(Mo[this._prevType]||Mo[x]&&A){this._prevType=x;const R=this._stacks.length-1,F=this._stacks[R]||[];for(const V of this._renderableTiles){if(this.pool.isFull()&&(dh(this.painter,this.terrain,this._rttTiles,d),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(V),V.rtt[R]){const te=this.pool.getObjectForId(V.rtt[R].id);if(te.stamp===V.rtt[R].stamp){this.pool.useObject(te);continue}}const q=this.pool.getOrCreateFreeObject();this.pool.useObject(q),this.pool.stampObject(q),V.rtt[R]={id:q.id,stamp:q.stamp},S.context.bindFramebuffer.set(q.fbo.framebuffer),S.context.clear({color:s.bp.transparent,stencil:0}),S.currentStencilSource=void 0;for(let te=0;te<F.length;te++){const ee=S.style._layers[F[te]],ce=ee.source?this._coordsAscending[ee.source][V.tileID.key]:[V.tileID];S.context.viewport.set([0,0,q.fbo.width,q.fbo.height]),S._renderTileClippingMasks(ee,ce,!0),S.renderLayer(S,S.style.tileManagers[ee.source],ee,ce,d),ee.source&&(V.rttCoords[ee.source]=this._coordsAscendingStr[ee.source][V.tileID.key])}}return dh(this.painter,this.terrain,this._rttTiles,d),this._rttTiles=[],this.pool.freeAllObjects(),Mo[x]}return!1}}const Cu={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Mu=C,fc={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Va,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:s.c.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,transformConstrain:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,reduceMotion:void 0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0,experimentalZoomLevelsToOverscale:void 0},Md={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Aa{constructor(t,o,d=!1){this.mousedown=S=>{this.startMove(S,N.mousePos(this.element,S)),N.addEventListener(window,"mousemove",this.mousemove),N.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=S=>{this.move(S,N.mousePos(this.element,S))},this.mouseup=S=>{this._rotatePitchHandler.dragEnd(S),this.offTemp()},this.touchstart=S=>{S.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=N.touchPos(this.element,S.targetTouches)[0],this.startMove(S,this._startPos),N.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),N.addEventListener(window,"touchend",this.touchend))},this.touchmove=S=>{S.targetTouches.length!==1?this.reset():(this._lastPos=N.touchPos(this.element,S.targetTouches)[0],this.move(S,this._lastPos))},this.touchend=S=>{S.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=o;const x=new Yh;this._rotatePitchHandler=new Ao({clickTolerance:3,move:(S,A)=>{const R=o.getBoundingClientRect(),F=new s.P((R.bottom-R.top)/2,(R.right-R.left)/2);return{bearingDelta:s.cx(new s.P(S.x,A.y),A,F),pitchDelta:d?-.5*(A.y-S.y):void 0}},moveStateManager:x,enable:!0,assignEvents:()=>{}}),this.map=t,N.addEventListener(o,"mousedown",this.mousedown),N.addEventListener(o,"touchstart",this.touchstart,{passive:!1}),N.addEventListener(o,"touchcancel",this.reset)}startMove(t,o){this._rotatePitchHandler.dragStart(t,o),N.disableDrag()}move(t,o){const d=this.map,{bearingDelta:x,pitchDelta:S}=this._rotatePitchHandler.dragMove(t,o)||{};x&&d.setBearing(d.getBearing()+x),S&&d.setPitch(d.getPitch()+S)}off(){const t=this.element;N.removeEventListener(t,"mousedown",this.mousedown),N.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),N.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),N.removeEventListener(window,"touchend",this.touchend),N.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){N.enableDrag(),N.removeEventListener(window,"mousemove",this.mousemove),N.removeEventListener(window,"mouseup",this.mouseup),N.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),N.removeEventListener(window,"touchend",this.touchend)}}let ul;function _h(w,t,o,d=!1){if(d||!o.getCoveringTilesDetailsProvider().allowWorldCopies())return w?.wrap();const x=new s.V(w.lng,w.lat);if(w=new s.V(w.lng,w.lat),t){const S=new s.V(w.lng-360,w.lat),A=new s.V(w.lng+360,w.lat),R=o.locationToScreenPoint(w).distSqr(t);o.locationToScreenPoint(S).distSqr(t)<R?w=S:o.locationToScreenPoint(A).distSqr(t)<R&&(w=A)}for(;Math.abs(w.lng-o.center.lng)>180;){const S=o.locationToScreenPoint(w);if(S.x>=0&&S.y>=0&&S.x<=o.width&&S.y<=o.height)break;w.lng>o.center.lng?w.lng-=360:w.lng+=360}return w.lng!==x.lng&&o.isPointOnMapSurface(o.locationToScreenPoint(w))?w:x}const xh={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function nf(w,t,o){const d=w.classList;for(const x in xh)d.remove(`maplibregl-${o}-anchor-${x}`);d.add(`maplibregl-${o}-anchor-${t}`)}class af extends s.E{constructor(t){if(super(),this._onKeyPress=o=>{const d=o.code,x=o.charCode||o.keyCode;d!=="Space"&&d!=="Enter"&&x!==32&&x!==13||this.togglePopup()},this._onMapClick=o=>{const d=o.originalEvent.target,x=this._element;this._popup&&(d===x||x.contains(d))&&this.togglePopup()},this._update=o=>{if(!this._map)return;const d=this._map.loaded()&&!this._map.isMoving();(o?.type==="terrain"||o?.type==="render"&&!d)&&this._map.once("render",this._update),this._lngLat=_h(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let x="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?x=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(x=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let S="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?S="rotateX(0deg)":this._pitchAlignment==="map"&&(S=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||o&&o.type!=="moveend"||(this._pos=this._pos.round()),N.setTransform(this._element,`${xh[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${S} ${x}`),j.frameAsync(new AbortController).then((()=>{this._updateOpacity(o&&o.type==="moveend")})).catch((()=>{}))},this._onMove=o=>{if(!this._isDragging){const d=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=d}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.l("dragstart"))),this.fire(new s.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new s.l("dragend")),this._state="inactive"},this._addDragHandler=o=>{this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._subpixelPositioning=t&&t.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,this.setOpacity(t?.opacity,t?.opacityWhenCovered),t&&t.element)this._element=t.element,this._offset=s.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=N.create("div");const o=N.createNS("http://www.w3.org/2000/svg","svg"),d=41,x=27;o.setAttributeNS(null,"display","block"),o.setAttributeNS(null,"height",`${d}px`),o.setAttributeNS(null,"width",`${x}px`),o.setAttributeNS(null,"viewBox",`0 0 ${x} ${d}`);const S=N.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"stroke","none"),S.setAttributeNS(null,"stroke-width","1"),S.setAttributeNS(null,"fill","none"),S.setAttributeNS(null,"fill-rule","evenodd");const A=N.createNS("http://www.w3.org/2000/svg","g");A.setAttributeNS(null,"fill-rule","nonzero");const R=N.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"transform","translate(3.0, 29.0)"),R.setAttributeNS(null,"fill","#000000");const F=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ze of F){const Ze=N.createNS("http://www.w3.org/2000/svg","ellipse");Ze.setAttributeNS(null,"opacity","0.04"),Ze.setAttributeNS(null,"cx","10.5"),Ze.setAttributeNS(null,"cy","5.80029008"),Ze.setAttributeNS(null,"rx",ze.rx),Ze.setAttributeNS(null,"ry",ze.ry),R.appendChild(Ze)}const V=N.createNS("http://www.w3.org/2000/svg","g");V.setAttributeNS(null,"fill",this._color);const q=N.createNS("http://www.w3.org/2000/svg","path");q.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),V.appendChild(q);const te=N.createNS("http://www.w3.org/2000/svg","g");te.setAttributeNS(null,"opacity","0.25"),te.setAttributeNS(null,"fill","#000000");const ee=N.createNS("http://www.w3.org/2000/svg","path");ee.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),te.appendChild(ee);const ce=N.createNS("http://www.w3.org/2000/svg","g");ce.setAttributeNS(null,"transform","translate(6.0, 7.0)"),ce.setAttributeNS(null,"fill","#FFFFFF");const _e=N.createNS("http://www.w3.org/2000/svg","g");_e.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Ie=N.createNS("http://www.w3.org/2000/svg","circle");Ie.setAttributeNS(null,"fill","#000000"),Ie.setAttributeNS(null,"opacity","0.25"),Ie.setAttributeNS(null,"cx","5.5"),Ie.setAttributeNS(null,"cy","5.5"),Ie.setAttributeNS(null,"r","5.4999962");const Be=N.createNS("http://www.w3.org/2000/svg","circle");Be.setAttributeNS(null,"fill","#FFFFFF"),Be.setAttributeNS(null,"cx","5.5"),Be.setAttributeNS(null,"cy","5.5"),Be.setAttributeNS(null,"r","5.4999962"),_e.appendChild(Ie),_e.appendChild(Be),A.appendChild(R),A.appendChild(V),A.appendChild(te),A.appendChild(ce),A.appendChild(_e),o.appendChild(A),o.setAttributeNS(null,"height",d*this._scale+"px"),o.setAttributeNS(null,"width",x*this._scale+"px"),this._element.appendChild(o),this._offset=s.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(o=>{o.preventDefault()})),this._element.addEventListener("mousedown",(o=>{o.preventDefault()})),nf(this._element,this._anchor,"marker"),t&&t.className)for(const o of t.className.split(" "))this._element.classList.add(o);this._popup=null}addTo(t){return this.remove(),this._map=t,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",t._getUIString("Marker.Title")),this._element.hasAttribute("role")||this._element.setAttribute("role","button"),t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),t.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),N.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=s.V.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const x=Math.abs(13.5)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[x,-1*(38.1-13.5+x)],"bottom-right":[-x,-1*(38.1-13.5+x)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(t){return this._subpixelPositioning=t,this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:t?(t.isOpen()?t.remove():(t.setLngLat(this._lngLat),t.addTo(this._map)),this):this}_updateOpacity(t=!1){var o,d;const x=(o=this._map)===null||o===void 0?void 0:o.terrain,S=this._map.transform.isLocationOccluded(this._lngLat);if(!x||S){const ce=S?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==ce&&(this._element.style.opacity=ce))}if(t)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const A=this._map,R=A.terrain.depthAtPoint(this._pos),F=A.terrain.getElevationForLngLat(this._lngLat,A.transform);if(A.transform.lngLatToCameraDepth(this._lngLat,F)-R<.006)return void(this._element.style.opacity=this._opacity);const V=-this._offset.y/A.transform.pixelsPerMeter,q=Math.sin(A.getPitch()*Math.PI/180)*V,te=A.terrain.depthAtPoint(new s.P(this._pos.x,this._pos.y-this._offset.y)),ee=A.transform.lngLatToCameraDepth(this._lngLat,F+q)-te>.006;!((d=this._popup)===null||d===void 0)&&d.isOpen()&&ee&&this._popup.remove(),this._element.style.opacity=ee?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(t){return this._offset=s.P.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(t,o){return(this._opacity===void 0||t===void 0&&o===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),t!==void 0&&(this._opacity=t),o!==void 0&&(this._opacityWhenCovered=o),this._map&&this._updateOpacity(!0),this}}const sf={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let qc=0,dc=!1;const rs={maxWidth:100,unit:"metric"};function La(w,t,o){const d=o&&o.maxWidth||100,x=w._container.clientHeight/2,S=w._container.clientWidth/2,A=w.unproject([S-d/2,x]),R=w.unproject([S+d/2,x]),F=Math.round(w.project(R).x-w.project(A).x),V=Math.min(d,F,w._container.clientWidth),q=A.distanceTo(R);if(o&&o.unit==="imperial"){const te=3.2808*q;te>5280?Nl(t,V,te/5280,w._getUIString("ScaleControl.Miles")):Nl(t,V,te,w._getUIString("ScaleControl.Feet"))}else o&&o.unit==="nautical"?Nl(t,V,q/1852,w._getUIString("ScaleControl.NauticalMiles")):q>=1e3?Nl(t,V,q/1e3,w._getUIString("ScaleControl.Kilometers")):Nl(t,V,q,w._getUIString("ScaleControl.Meters"))}function Nl(w,t,o,d){const x=(function(S){const A=Math.pow(10,`${Math.floor(S)}`.length-1);let R=S/A;return R=R>=10?10:R>=5?5:R>=3?3:R>=2?2:R>=1?1:(function(F){const V=Math.pow(10,Math.ceil(-Math.log(F)/Math.LN10));return Math.round(F*V)/V})(R),A*R})(o);w.style.width=t*(x/o)+"px",w.innerHTML=`${x}&nbsp;${d}`}const Du={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Ru=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function yh(w){if(w){if(typeof w=="number"){const t=Math.round(Math.abs(w)/Math.SQRT2);return{center:new s.P(0,0),top:new s.P(0,w),"top-left":new s.P(t,t),"top-right":new s.P(-t,t),bottom:new s.P(0,-w),"bottom-left":new s.P(t,-t),"bottom-right":new s.P(-t,-t),left:new s.P(w,0),right:new s.P(-w,0)}}if(w instanceof s.P||Array.isArray(w)){const t=s.P.convert(w);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:s.P.convert(w.center||[0,0]),top:s.P.convert(w.top||[0,0]),"top-left":s.P.convert(w["top-left"]||[0,0]),"top-right":s.P.convert(w["top-right"]||[0,0]),bottom:s.P.convert(w.bottom||[0,0]),"bottom-left":s.P.convert(w["bottom-left"]||[0,0]),"bottom-right":s.P.convert(w["bottom-right"]||[0,0]),left:s.P.convert(w.left||[0,0]),right:s.P.convert(w.right||[0,0])}}return yh(new s.P(0,0))}const hl=C;_.AJAXError=s.cI,_.Event=s.l,_.Evented=s.E,_.LngLat=s.V,_.MercatorCoordinate=s.a9,_.Point=s.P,_.addProtocol=s.cJ,_.config=s.c,_.removeProtocol=s.cK,_.AttributionControl=$a,_.BoxZoomHandler=Gc,_.CanvasSource=fe,_.CooperativeGesturesHandler=Rr,_.DoubleClickZoomHandler=Uf,_.DragPanHandler=Cd,_.DragRotateHandler=ao,_.EdgeInsets=ei,_.FullscreenControl=class extends s.E{constructor(w={}){super(),this._onFullscreenChange=()=>{var t;let o=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((t=o?.shadowRoot)===null||t===void 0)&&t.fullscreenElement;)o=o.shadowRoot.fullscreenElement;o===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,w&&w.container&&(w.container instanceof HTMLElement?this._container=w.container:s.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(w){return this._map=w,this._container||(this._container=this._map.getContainer()),this._controlContainer=N.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){N.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const w=this._fullscreenButton=N.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);N.create("span","maplibregl-ctrl-icon",w).setAttribute("aria-hidden","true"),w.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const w=this._getTitle();this._fullscreenButton.setAttribute("aria-label",w),this._fullscreenButton.title=w}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new s.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new s.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},_.GeoJSONSource=pr,_.GeolocateControl=class extends s.E{constructor(w){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new s.l("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new s.l("geolocate",t)),this._finish()}},this._updateCamera=t=>{const o=new s.V(t.coords.longitude,t.coords.latitude),d=t.coords.accuracy,x=this._map.getBearing(),S=s.e({bearing:x},this.options.fitBoundsOptions),A=Ee.fromLngLat(o,d);this._map.fitBounds(A,S,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const o=new s.V(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=t.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=t=>{if(this._map){if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&dc)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new s.l("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this._geolocateButton=N.create("button","maplibregl-ctrl-geolocate",this._container),N.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=t=>{if(this._map){if(t===!1){s.w("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=N.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new af({element:this._dotElement}),this._circleElement=N.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new af({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(o=>{const d=o?.[0]instanceof ResizeObserverEntry;o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||d||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new s.l("trackuserlocationend")),this.fire(new s.l("userlocationlostfocus")))}))}},this.options=s.e({},sf,w)}onAdd(w){return this._map=w,this._container=N.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return s._(this,arguments,void 0,(function*(t=!1){if(ul!==void 0&&!t)return ul;if(window.navigator.permissions===void 0)return ul=!!window.navigator.geolocation,ul;try{ul=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{ul=!!window.navigator.geolocation}return ul}))})().then((t=>this._finishSetupUI(t))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),N.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,qc=0,dc=!1}_isOutOfMapMaxBounds(w){const t=this._map.getMaxBounds(),o=w.coords;return t&&(o.longitude<t.getWest()||o.longitude>t.getEast()||o.latitude<t.getSouth()||o.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":case"BACKGROUND_ERROR":case"OFF":case void 0:break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const w=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&w))return;const t=this._map.project(w),o=this._map.unproject([t.x+100,t.y]),d=w.distanceTo(o)/100,x=2*this._accuracy/d;this._circleElement.style.width=`${x.toFixed(2)}px`,this._circleElement.style.height=`${x.toFixed(2)}px`}trigger(){if(!this._setup)return s.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":qc--,dc=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new s.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.l("trackuserlocationstart")),this.fire(new s.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let w;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),qc++,qc>1?(w={maximumAge:6e5,timeout:0},dc=!0):(w=this.options.positionOptions,dc=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,w)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},_.GlobeControl=class{constructor(){this._toggleProjection=()=>{var w;const t=(w=this._map.getProjection())===null||w===void 0?void 0:w.type;this._map.setProjection(t!=="mercator"&&t?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var w;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((w=this._map.getProjection())===null||w===void 0?void 0:w.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(w){return this._map=w,this._container=N.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=N.create("button","maplibregl-ctrl-globe",this._container),N.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){N.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},_.Hash=Ua,_.ImageSource=ir,_.KeyboardHandler=Qn,_.LngLatBounds=Ee,_.LogoControl=rf,_.Map=class extends ni{constructor(w){var t,o;s.cG.mark(s.cH.create);const d=Object.assign(Object.assign(Object.assign({},fc),w),{canvasContextAttributes:Object.assign(Object.assign({},fc.canvasContextAttributes),w.canvasContextAttributes)});if(d.minZoom!=null&&d.maxZoom!=null&&d.minZoom>d.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(d.minPitch!=null&&d.maxPitch!=null&&d.minPitch>d.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(d.minPitch!=null&&d.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(d.maxPitch!=null&&d.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const x=new Ra,S=new xo;if(d.minZoom!==void 0&&x.setMinZoom(d.minZoom),d.maxZoom!==void 0&&x.setMaxZoom(d.maxZoom),d.minPitch!==void 0&&x.setMinPitch(d.minPitch),d.maxPitch!==void 0&&x.setMaxPitch(d.maxPitch),d.renderWorldCopies!==void 0&&x.setRenderWorldCopies(d.renderWorldCopies),d.transformConstrain!==null&&x.setConstrainOverride(d.transformConstrain),super(x,S,{bearingSnap:d.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new hc,this._controls=[],this._mapId=s.af(),this._lostContextStyle={style:null,images:null},this._contextLost=R=>{R.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.painter.destroy();for(const F of Object.values(this.style._layers))if(F.type==="custom"&&console.warn(`Custom layer with id '${F.id}' cannot be restored after WebGL context loss. You will need to re-add it manually after context restoration.`),F._listeners)for(const[V]of Object.entries(F._listeners))console.warn(`Custom layer with id '${F.id}' had event listeners for event '${V}' which cannot be restored after WebGL context loss. You will need to re-add them manually after context restoration.`);this._lostContextStyle=this._getStyleAndImages(),this.style.destroy(),this.style=null,this.fire(new s.l("webglcontextlost",{originalEvent:R}))},this._contextRestored=R=>{this._lostContextStyle.style&&this.setStyle(this._lostContextStyle.style,{diff:!1}),this._lostContextStyle.images&&(this.style.imageManager.images=this._lostContextStyle.images),this._setupPainter(),this.resize(),this._update(),this.fire(new s.l("webglcontextrestored",{originalEvent:R}))},this._onMapScroll=R=>{if(R.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=d.interactive,this._maxTileCacheSize=d.maxTileCacheSize,this._maxTileCacheZoomLevels=d.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},d.canvasContextAttributes),this._trackResize=d.trackResize===!0,this._bearingSnap=d.bearingSnap,this._centerClampedToGround=d.centerClampedToGround,this._refreshExpiredTiles=d.refreshExpiredTiles===!0,this._fadeDuration=d.fadeDuration,this._crossSourceCollisions=d.crossSourceCollisions===!0,this._collectResourceTiming=d.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Cu),d.locale),this._clickTolerance=d.clickTolerance,this._overridePixelRatio=d.pixelRatio,this._maxCanvasSize=d.maxCanvasSize,this._zoomLevelsToOverscale=d.experimentalZoomLevelsToOverscale,this.transformCameraUpdate=d.transformCameraUpdate,this.transformConstrain=d.transformConstrain,this.cancelPendingTileRequestsWhileZooming=d.cancelPendingTileRequestsWhileZooming===!0,d.reduceMotion!==void 0&&(j.prefersReducedMotion=d.reduceMotion),this._imageQueueHandle=re.addThrottleControl((()=>this.isMoving())),this._requestManager=new Ce(d.transformRequest),typeof d.container=="string"){if(this._container=document.getElementById(d.container),!this._container)throw new Error(`Container '${d.container}' not found.`)}else{if(!(d.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=d.container}if(d.maxBounds&&this.setMaxBounds(d.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let R=!1;const F=ph((V=>{this._trackResize&&!this._removed&&(this.resize(V),this.redraw())}),50);this._resizeObserver=new ResizeObserver((V=>{R?F(V):R=!0})),this._resizeObserver.observe(this._container)}this.handlers=new tf(this,d),this._hash=d.hash&&new Ua(typeof d.hash=="string"&&d.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:d.center,elevation:d.elevation,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch,roll:d.roll}),d.bounds&&(this.resize(),this.fitBounds(d.bounds,s.e({},d.fitBoundsOptions,{duration:0}))));const A=typeof d.style=="string"||((o=(t=d.style)===null||t===void 0?void 0:t.projection)===null||o===void 0?void 0:o.type)!=="globe";this.resize(null,A),this._localIdeographFontFamily=d.localIdeographFontFamily,this._validateStyle=d.validateStyle,d.style&&this.setStyle(d.style,{localIdeographFontFamily:d.localIdeographFontFamily}),d.attributionControl&&this.addControl(new $a(typeof d.attributionControl=="boolean"?void 0:d.attributionControl)),d.maplibreLogo&&this.addControl(new rf,d.logoPosition),this.on("style.load",(()=>{if(A||this._resizeTransform(),this.transform.unmodified){const R=s.U(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(R)}})),this.on("data",(R=>{this._update(R.dataType==="style"),this.fire(new s.l(`${R.dataType}data`,R))})),this.on("dataloading",(R=>{this.fire(new s.l(`${R.dataType}dataloading`,R))})),this.on("dataabort",(R=>{this.fire(new s.l("sourcedataabort",R))}))}_getMapId(){return this._mapId}setGlobalStateProperty(w,t){return this.style.setGlobalStateProperty(w,t),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(w,t){if(t===void 0&&(t=w.getDefaultPosition?w.getDefaultPosition():"top-right"),!w||!w.onAdd)return this.fire(new s.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const o=w.onAdd(this);this._controls.push(w);const d=this._controlPositions[t];return t.indexOf("bottom")!==-1?d.insertBefore(o,d.firstChild):d.appendChild(o),this}removeControl(w){if(!w||!w.onRemove)return this.fire(new s.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(w);return t>-1&&this._controls.splice(t,1),w.onRemove(this),this}hasControl(w){return this._controls.indexOf(w)>-1}coveringTiles(w){return tn(this.transform,w)}calculateCameraOptionsFromTo(w,t,o,d){return d==null&&this.terrain&&(d=this.terrain.getElevationForLngLat(o,this.transform)),super.calculateCameraOptionsFromTo(w,t,o,d)}resize(w,t=!0){const[o,d]=this._containerDimensions(),x=this._getClampedPixelRatio(o,d);if(this._resizeCanvas(o,d,x),this.painter.resize(o,d,x),this.painter.overLimit()){const A=this.painter.context.gl;this._maxCanvasSize=[A.drawingBufferWidth,A.drawingBufferHeight];const R=this._getClampedPixelRatio(o,d);this._resizeCanvas(o,d,R),this.painter.resize(o,d,R)}this._resizeTransform(t);const S=!this._moving;return S&&(this.stop(),this.fire(new s.l("movestart",w)).fire(new s.l("move",w))),this.fire(new s.l("resize",w)),S&&this.fire(new s.l("moveend",w)),this}_resizeTransform(w=!0){var t;const[o,d]=this._containerDimensions();this.transform.resize(o,d,w),(t=this._requestedCameraState)===null||t===void 0||t.resize(o,d,w)}_getClampedPixelRatio(w,t){const{0:o,1:d}=this._maxCanvasSize,x=this.getPixelRatio(),S=w*x,A=t*x;return Math.min(S>o?o/S:1,A>d?d/A:1)*x}getPixelRatio(){var w;return(w=this._overridePixelRatio)!==null&&w!==void 0?w:devicePixelRatio}setPixelRatio(w){this._overridePixelRatio=w,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(w){return this.transform.setMaxBounds(Ee.convert(w)),this._update()}setMinZoom(w){if((w=w??-2)>=-2&&w<=this.transform.maxZoom){const t=this._getTransformForUpdate();return t.setMinZoom(w),this._applyUpdatedTransform(t),this._update(),this}throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(w){if((w=w??22)>=this.transform.minZoom){const t=this._getTransformForUpdate();return t.setMaxZoom(w),this._applyUpdatedTransform(t),this._update(),this}throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(w){if((w=w??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(w>=0&&w<=this.transform.maxPitch)return this.transform.setMinPitch(w),this._update(),this.getPitch()<w&&this.setPitch(w),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(w){if((w=w??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(w>=this.transform.minPitch)return this.transform.setMaxPitch(w),this._update(),this.getPitch()>w&&this.setPitch(w),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(w){return this.transform.setRenderWorldCopies(w),this._update()}setTransformConstrain(w){return this.transform.setConstrainOverride(w),this._update()}project(w){return this.transform.locationToScreenPoint(s.V.convert(w),this.style&&this.terrain)}unproject(w){return this.transform.screenPointToLocation(s.P.convert(w),this.terrain)}isMoving(){var w;return this._moving||((w=this.handlers)===null||w===void 0?void 0:w.isMoving())}isZooming(){var w;return this._zooming||((w=this.handlers)===null||w===void 0?void 0:w.isZooming())}isRotating(){var w;return this._rotating||((w=this.handlers)===null||w===void 0?void 0:w.isRotating())}_createDelegatedListener(w,t,o){if(w==="mouseenter"||w==="mouseover"){let d=!1;return{layers:t,listener:o,delegates:{mousemove:S=>{const A=t.filter((F=>this.getLayer(F))),R=A.length!==0?this.queryRenderedFeatures(S.point,{layers:A}):[];R.length?d||(d=!0,o.call(this,new li(w,this,S.originalEvent,{features:R}))):d=!1},mouseout:()=>{d=!1}}}}if(w==="mouseleave"||w==="mouseout"){let d=!1;return{layers:t,listener:o,delegates:{mousemove:A=>{const R=t.filter((F=>this.getLayer(F)));(R.length!==0?this.queryRenderedFeatures(A.point,{layers:R}):[]).length?d=!0:d&&(d=!1,o.call(this,new li(w,this,A.originalEvent)))},mouseout:A=>{d&&(d=!1,o.call(this,new li(w,this,A.originalEvent)))}}}}{const d=x=>{const S=t.filter((R=>this.getLayer(R))),A=S.length!==0?this.queryRenderedFeatures(x.point,{layers:S}):[];A.length&&(x.features=A,o.call(this,x),delete x.features)};return{layers:t,listener:o,delegates:{[w]:d}}}}_saveDelegatedListener(w,t){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[w]=this._delegatedListeners[w]||[],this._delegatedListeners[w].push(t)}_removeDelegatedListener(w,t,o){if(!this._delegatedListeners||!this._delegatedListeners[w])return;const d=this._delegatedListeners[w];for(let x=0;x<d.length;x++){const S=d[x];if(S.listener===o&&S.layers.length===t.length&&S.layers.every((A=>t.includes(A)))){for(const A in S.delegates)this.off(A,S.delegates[A]);return void d.splice(x,1)}}}on(w,t,o){if(o===void 0)return super.on(w,t);const d=typeof t=="string"?[t]:t,x=this._createDelegatedListener(w,d,o);this._saveDelegatedListener(w,x);for(const S in x.delegates)this.on(S,x.delegates[S]);return{unsubscribe:()=>{this._removeDelegatedListener(w,d,o)}}}once(w,t,o){if(o===void 0)return super.once(w,t);const d=typeof t=="string"?[t]:t,x=this._createDelegatedListener(w,d,o);for(const S in x.delegates){const A=x.delegates[S];x.delegates[S]=(...R)=>{this._removeDelegatedListener(w,d,o),A(...R)}}this._saveDelegatedListener(w,x);for(const S in x.delegates)this.once(S,x.delegates[S]);return this}off(w,t,o){return o===void 0?super.off(w,t):(this._removeDelegatedListener(w,typeof t=="string"?[t]:t,o),this)}queryRenderedFeatures(w,t){if(!this.style)return[];let o;const d=w instanceof s.P||Array.isArray(w),x=d?w:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(d?{}:w)||{},x instanceof s.P||typeof x[0]=="number")o=[s.P.convert(x)];else{const S=s.P.convert(x[0]),A=s.P.convert(x[1]);o=[S,new s.P(A.x,S.y),A,new s.P(S.x,A.y),S]}return this.style.queryRenderedFeatures(o,t,this.transform)}querySourceFeatures(w,t){return this.style.querySourceFeatures(w,t)}setStyle(w,t){return(t=s.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&w?(this._diffStyle(w,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(w,t))}setTransformRequest(w){return this._requestManager.setTransformRequest(w),this}_getUIString(w){const t=this._locale[w];if(t==null)throw new Error(`Missing UI string '${w}'`);return t}_updateStyle(w,t){var o,d;if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(w,t)));const x=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!w)),w?(this.style=new tl(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof w=="string"?this.style.loadURL(w,t,x):this.style.loadJSON(w,t,x),this):((d=(o=this.style)===null||o===void 0?void 0:o.projection)===null||d===void 0||d.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new tl(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(w,t){if(typeof w=="string"){const o=this._requestManager.transformRequest(w,"Style");s.j(o,new AbortController).then((d=>{this._updateDiff(d.data,t)})).catch((d=>{d&&this.fire(new s.k(d))}))}else typeof w=="object"&&this._updateDiff(w,t)}_updateDiff(w,t){try{this.style.setState(w,t)&&this._update(!0)}catch(o){s.w(`Unable to perform style diff: ${o.message||o.error||o}.  Rebuilding the style from scratch.`),this._updateStyle(w,t)}}getStyle(){if(this.style)return this.style.serialize()}_getStyleAndImages(){return this.style?{style:this.style.serialize(),images:this.style.imageManager.cloneImages()}:{style:null,images:{}}}isStyleLoaded(){return this.style?this.style.loaded():s.w("There is no style added to the map.")}addSource(w,t){return this._lazyInitEmptyStyle(),this.style.addSource(w,t),this._update(!0)}isSourceLoaded(w){const t=this.style&&this.style.tileManagers[w];if(t!==void 0)return t.loaded();this.fire(new s.k(new Error(`There is no tile manager with ID '${w}'`)))}setTerrain(w){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),w){const t=this.style.tileManagers[w.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${w.source}`);this.terrain===null&&t.reload();for(const o in this.style._layers){const d=this.style._layers[o];d.type==="hillshade"&&d.source===w.source&&s.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),d.type==="color-relief"&&d.source===w.source&&s.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new wn(this.painter,t,w),this.painter.renderToTexture=new cl(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=o=>{var d;o.dataType==="style"?this.terrain.tileManager.freeRtt():o.dataType==="source"&&o.tile&&(o.sourceId!==w.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((d=o.source)===null||d===void 0?void 0:d.type)==="image"?this.terrain.tileManager.freeRtt():this.terrain.tileManager.freeRtt(o.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.tileManager.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new s.l("terrain",{terrain:w})),this}getTerrain(){var w,t;return(t=(w=this.terrain)===null||w===void 0?void 0:w.options)!==null&&t!==void 0?t:null}areTilesLoaded(){const w=this.style&&this.style.tileManagers;for(const t of Object.values(w))if(!t.areTilesLoaded())return!1;return!0}removeSource(w){return this.style.removeSource(w),this._update(!0)}getSource(w){return this.style.getSource(w)}setSourceTileLodParams(w,t,o){if(o){const d=this.getSource(o);if(!d)throw new Error(`There is no source with ID "${o}", cannot set LOD parameters`);d.calculateTileZoom=Ln(Math.max(1,w),Math.max(1,t))}else for(const d in this.style.tileManagers)this.style.tileManagers[d].getSource().calculateTileZoom=Ln(Math.max(1,w),Math.max(1,t));return this._update(!0),this}refreshTiles(w,t){const o=this.style.tileManagers[w];if(!o)throw new Error(`There is no tile manager with ID "${w}", cannot refresh tile`);t===void 0?o.reload(!0):o.refreshTiles(t.map((d=>new s.ac(d.z,d.x,d.y))))}addImage(w,t,o={}){const{pixelRatio:d=1,sdf:x=!1,stretchX:S,stretchY:A,content:R,textFitWidth:F,textFitHeight:V}=o;if(this._lazyInitEmptyStyle(),!(t instanceof HTMLImageElement||s.b(t))){if(t.width===void 0||t.height===void 0)return this.fire(new s.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:q,height:te,data:ee}=t,ce=t;return this.style.addImage(w,{data:new s.R({width:q,height:te},new Uint8Array(ee)),pixelRatio:d,stretchX:S,stretchY:A,content:R,textFitWidth:F,textFitHeight:V,sdf:x,version:0,userImage:ce}),ce.onAdd&&ce.onAdd(this,w),this}}{const{width:q,height:te,data:ee}=j.getImageData(t);this.style.addImage(w,{data:new s.R({width:q,height:te},ee),pixelRatio:d,stretchX:S,stretchY:A,content:R,textFitWidth:F,textFitHeight:V,sdf:x,version:0})}}updateImage(w,t){const o=this.style.getImage(w);if(!o)return this.fire(new s.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const d=t instanceof HTMLImageElement||s.b(t)?j.getImageData(t):t,{width:x,height:S,data:A}=d;if(x===void 0||S===void 0)return this.fire(new s.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(x!==o.data.width||S!==o.data.height)return this.fire(new s.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const R=!(t instanceof HTMLImageElement||s.b(t));return o.data.replace(A,R),this.style.updateImage(w,o),this}getImage(w){return this.style.getImage(w)}hasImage(w){return w?!!this.style.getImage(w):(this.fire(new s.k(new Error("Missing required image id"))),!1)}removeImage(w){this.style.removeImage(w)}loadImage(w){return re.getImage(this._requestManager.transformRequest(w,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(w,t){return this._lazyInitEmptyStyle(),this.style.addLayer(w,t),this._update(!0)}moveLayer(w,t){return this.style.moveLayer(w,t),this._update(!0)}removeLayer(w){return this.style.removeLayer(w),this._update(!0)}getLayer(w){return this.style.getLayer(w)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(w,t,o){return this.style.setLayerZoomRange(w,t,o),this._update(!0)}setFilter(w,t,o={}){return this.style.setFilter(w,t,o),this._update(!0)}getFilter(w){return this.style.getFilter(w)}setPaintProperty(w,t,o,d={}){return this.style.setPaintProperty(w,t,o,d),this._update(!0)}getPaintProperty(w,t){return this.style.getPaintProperty(w,t)}setLayoutProperty(w,t,o,d={}){return this.style.setLayoutProperty(w,t,o,d),this._update(!0)}getLayoutProperty(w,t){return this.style.getLayoutProperty(w,t)}setGlyphs(w,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(w,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(w,t,o={}){return this._lazyInitEmptyStyle(),this.style.addSprite(w,t,o,(d=>{d||this._update(!0)})),this}removeSprite(w){return this._lazyInitEmptyStyle(),this.style.removeSprite(w),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(w,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(w,t,(o=>{o||this._update(!0)})),this}setLight(w,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(w,t),this._update(!0)}getLight(){return this.style.getLight()}setSky(w,t={}){return this._lazyInitEmptyStyle(),this.style.setSky(w,t),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(w,t){return this.style.setFeatureState(w,t),this._update()}removeFeatureState(w,t){return this.style.removeFeatureState(w,t),this._update()}getFeatureState(w){return this.style.getFeatureState(w)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let w=0,t=0;return this._container&&(w=this._container.clientWidth||400,t=this._container.clientHeight||300),[w,t]}_setupContainer(){const w=this._container;w.classList.add("maplibregl-map");const t=this._canvasContainer=N.create("div","maplibregl-canvas-container",w);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=N.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const o=this._containerDimensions(),d=this._getClampedPixelRatio(o[0],o[1]);this._resizeCanvas(o[0],o[1],d);const x=this._controlContainer=N.create("div","maplibregl-control-container",w),S=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((A=>{S[A]=N.create("div",`maplibregl-ctrl-${A} `,x)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(w,t,o){this._canvas.width=Math.floor(o*w),this._canvas.height=Math.floor(o*t),this._canvas.style.width=`${w}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const w=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let t=null;this._canvas.addEventListener("webglcontextcreationerror",(d=>{t={requestedAttributes:w},d&&(t.statusMessage=d.statusMessage,t.type=d.type)}),{once:!0});let o=null;if(o=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,w):this._canvas.getContext("webgl2",w)||this._canvas.getContext("webgl",w),!o){const d="Failed to initialize WebGL";throw t?(t.message=d,new Error(JSON.stringify(t))):new Error(d)}this.painter=new Tu(o,this.transform),Z.testSupport(o)}migrateProjection(w,t){super.migrateProjection(w,t),this.painter.transform=w,this.fire(new s.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(w){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||w,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(w){return this._update(),this._renderTaskQueue.add(w)}_cancelRenderFrame(w){this._renderTaskQueue.remove(w)}_render(w){var t,o,d,x,S;const A=this._idleTriggered?this._fadeDuration:0,R=((t=this.style.projection)===null||t===void 0?void 0:t.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(w),this._removed)return;let F=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const te=this.transform.zoom,ee=O();this.style.zoomHistory.update(te,ee);const ce=new s.H(te,{now:ee,fadeDuration:A,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),_e=ce.crossFadingFactor();_e===1&&_e===this._crossFadingFactor||(F=!0,this._crossFadingFactor=_e),this.style.update(ce)}const V=((o=this.style.projection)===null||o===void 0?void 0:o.transitionState)>0!==R;(d=this.style.projection)===null||d===void 0||d.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((x=this.style.projection)===null||x===void 0?void 0:x.transitionState,(S=this.style.projection)===null||S===void 0?void 0:S.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||V)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.tileManager.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,A,this._crossSourceCollisions,V),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:A,showPadding:this.showPadding}),this.fire(new s.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,s.cG.mark(s.cH.load),this.fire(new s.l("load"))),this.style&&(this.style.hasTransitions()||F)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const q=this._sourcesDirty||this._styleDirty||this._placementDirty;return q||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new s.l("idle")),!this._loaded||this._fullyLoaded||q||(this._fullyLoaded=!0,s.cG.mark(s.cH.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var w;this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),re.removeThrottleControl(this._imageQueueHandle),(w=this._resizeObserver)===null||w===void 0||w.disconnect();const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t?.loseContext&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),N.remove(this._canvasContainer),N.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),s.cG.clearMetrics(),this._removed=!0,this.fire(new s.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,j.frame(this._frameRequest,(w=>{s.cG.frame(w),this._frameRequest=null;try{this._render(w)}catch(t){if(!s.Z(t)&&!(function(o){return o.message===Pr})(t))throw t}}),(()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(w){this._showTileBoundaries!==w&&(this._showTileBoundaries=w,this._update())}get showPadding(){return!!this._showPadding}set showPadding(w){this._showPadding!==w&&(this._showPadding=w,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(w){this._showCollisionBoxes!==w&&(this._showCollisionBoxes=w,w?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(w){this._showOverdrawInspector!==w&&(this._showOverdrawInspector=w,this._update())}get repaint(){return!!this._repaint}set repaint(w){this._repaint!==w&&(this._repaint=w,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(w){this._vertices=w,this._update()}get version(){return Mu}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(w){return this._lazyInitEmptyStyle(),this.style.setProjection(w),this._update(!0)}},_.MapMouseEvent=li,_.MapTouchEvent=sl,_.MapWheelEvent=Lf,_.Marker=af,_.NavigationControl=class{constructor(w){this._updateZoomButtons=()=>{const t=this._map.getZoom(),o=t===this._map.getMaxZoom(),d=t===this._map.getMinZoom();this._zoomInButton.disabled=o,this._zoomOutButton.disabled=d,this._zoomInButton.setAttribute("aria-disabled",o.toString()),this._zoomOutButton.setAttribute("aria-disabled",d.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(t,o)=>{const d=this._map._getUIString(`NavigationControl.${o}`);t.title=d,t.setAttribute("aria-label",d)},this.options=s.e({},Md,w),this._container=N.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(t=>this._map.zoomIn({},{originalEvent:t}))),N.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(t=>this._map.zoomOut({},{originalEvent:t}))),N.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})})),this._compassIcon=N.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(w){return this._map=w,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Aa(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){N.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(w,t){const o=N.create("button",w,this._container);return o.type="button",o.addEventListener("click",t),o}},_.Popup=class extends s.E{constructor(w){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&N.remove(this._content),this._container&&(N.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new s.l("close"))),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=N.create("div","maplibregl-popup",this._map.getContainer()),this._tip=N.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const A of this.options.className.split(" "))this._container.classList.add(A);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=_h(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!t)return;const o=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationToScreenPoint(this._lngLat));let d=this.options.anchor;const x=yh(this.options.offset);if(!d){const A=this._container.offsetWidth,R=this._container.offsetHeight;let F;F=o.y+x.bottom.y<R?["top"]:o.y>this._map.transform.height-R?["bottom"]:[],o.x<A/2?F.push("left"):o.x>this._map.transform.width-A/2&&F.push("right"),d=F.length===0?"bottom":F.join("-")}let S=o.add(x[d]);this.options.subpixelPositioning||(S=S.round()),N.setTransform(this._container,`${xh[d]} translate(${S.x}px,${S.y}px)`),nf(this._container,d,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=s.e(Object.create(Du),w)}addTo(w){return this._map&&this.remove(),this._map=w,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new s.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(w){return this._lngLat=s.V.convert(w),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(w){return this.setDOMContent(document.createTextNode(w))}setHTML(w){const t=document.createDocumentFragment(),o=document.createElement("body");let d;for(o.innerHTML=w;d=o.firstChild,d;)t.appendChild(d);return this.setDOMContent(t)}getMaxWidth(){var w;return(w=this._container)===null||w===void 0?void 0:w.style.maxWidth}setMaxWidth(w){return this.options.maxWidth=w,this._update(),this}setDOMContent(w){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=N.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(w),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(w){return this._container&&this._container.classList.add(w),this}removeClassName(w){return this._container&&this._container.classList.remove(w),this}setOffset(w){return this.options.offset=w,this._update(),this}toggleClassName(w){if(this._container)return this._container.classList.toggle(w)}setSubpixelPositioning(w){this.options.subpixelPositioning=w}_createCloseButton(){this.options.closeButton&&(this._closeButton=N.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const w=this._container.querySelector(Ru);w&&w.focus()}},_.RasterDEMTileSource=Kt,_.RasterTileSource=Jt,_.ScaleControl=class{constructor(w){this._onMove=()=>{La(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,La(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},rs),w)}getDefaultPosition(){return"bottom-left"}onAdd(w){return this._map=w,this._container=N.create("div","maplibregl-ctrl maplibregl-ctrl-scale",w.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){N.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},_.ScrollZoomHandler=Qh,_.Style=tl,_.TerrainControl=class{constructor(w){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=w}onAdd(w){return this._map=w,this._container=N.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=N.create("button","maplibregl-ctrl-terrain",this._container),N.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){N.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},_.TwoFingersTouchPitchHandler=cc,_.TwoFingersTouchRotateHandler=Jh,_.TwoFingersTouchZoomHandler=Ol,_.TwoFingersTouchZoomRotateHandler=ku,_.VectorTileSource=pt,_.VideoSource=st,_.addSourceType=(w,t)=>s._(void 0,void 0,void 0,(function*(){if(we(w))throw new Error(`A source type called "${w}" already exists.`);((o,d)=>{he[o]=d})(w,t)})),_.clearPrewarmedResources=function(){const w=Gt;w&&(w.isPreloaded()&&w.numActive()===1?(w.release(Fe),Gt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},_.createTileMesh=Ic,_.getMaxParallelImageRequests=function(){return s.c.MAX_PARALLEL_IMAGE_REQUESTS},_.getRTLTextPluginStatus=function(){return ot().getRTLTextPluginStatus()},_.getVersion=function(){return hl},_.getWorkerCount=function(){return Re.workerCount},_.getWorkerUrl=function(){return s.c.WORKER_URL},_.importScriptInWorkers=function(w){return Or().broadcast("IS",w)},_.isTimeFrozen=function(){return H.isFrozen()},_.now=O,_.prewarm=function(){Bt().acquire(Fe)},_.restoreNow=function(){H.restoreNow()},_.setMaxParallelImageRequests=function(w){s.c.MAX_PARALLEL_IMAGE_REQUESTS=w},_.setNow=function(w){H.setNow(w)},_.setRTLTextPlugin=function(w,t){return ot().setRTLTextPlugin(w,t)},_.setWorkerCount=function(w){Re.workerCount=w},_.setWorkerUrl=function(w){s.c.WORKER_URL=w}}));var b=l;return b}))})(gx)),gx.exports}var ZD=qD();const q0=Fx(ZD);function fb(r){return(r||"scenario").trim().replace(/[\\/:*?"<>|]+/g,"-").replace(/\s+/g,"_").slice(0,80)||"scenario"}function WD(r){const u={...r,vizConfig:[{key:"speedScore",label:"",desc:" ",color:"#3B82F6"},{key:"economyScore",label:"",desc:"  ",color:"#F59E0B"},{key:"scenicScore",label:"",desc:"  ",color:"#22C55E"},{key:"commScore",label:"",desc:"  ",color:"#A855F7"}],colors:{routePalette:{A:"#3B82F6",B:"#F59E0B",C:"#A855F7"},routeSelected:"#1E4ED8",routeRegular:"#8CCBFF",traffic:"#FF0022",toll:"#FFE100",comm:{fill:"rgba(170,60,255,0.28)",outline:"rgba(170,60,255,0.65)"},parks:{fill:"#00FF66",outline:"transparent",opacity:.95}}},l=JSON.stringify(u);return`<!doctype html>
<html lang="he" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>${String(r.scenarioName).replace(/</g,"&lt;")}</title>
<style>
  /* GLOBAL FONT RESET - STRICT ARIAL */
  * { box-sizing: border-box; user-select: none; font-family: Arial, sans-serif !important; }
  html, body { height: 100%; margin: 0; background: #0b0f17; color: #e8eefc; overflow: hidden; font-size: 14px; }

  .root { height: 100%; display: flex; flex-direction: column; gap: 8px; padding: 8px; }
  
  /* Shared Panel Style */
  .panel { 
      border: 1px solid rgba(255,255,255,0.12); 
      background: rgba(11,15,23,0.95); 
      box-shadow: 0 4px 12px rgba(0,0,0,0.4); 
      border-radius: 8px; 
  }

  .top { flex: 1; min-height: 0; display: flex; gap: 8px; direction: ltr; }

  /* Map Panel */
  .mapPanel { flex: 1; min-width: 0; position: relative; overflow: hidden; background: #000; }
  #mapStage { position: absolute; left: 0; top: 0; transform-origin: 0 0; touch-action: none; will-change: transform; }
  #baseImg { display: block; pointer-events: none; }
  #overlaySvg { position: absolute; left: 0; top: 0; width: 100%; height: 100%; pointer-events: auto; }

  .ctrlCol { position: absolute; left: 10px; top: 10px; display: flex; flex-direction: column; gap: 6px; z-index: 10; }
  
  .ctrlBtn, .filterBtn { 
      width: 40px; height: 40px; 
      border-radius: 8px; 
      border: 1px solid rgba(255,255,255,0.2); 
      background: rgba(15,23,42,0.9); 
      color: white; cursor: pointer; 
      display: flex; align-items: center; justify-content: center; 
      transition: all 0.1s; 
  }
  .ctrlBtn:hover, .filterBtn:hover { background: rgba(255,255,255,0.1); }
  .ctrlBtn svg, .filterBtn svg { width: 20px; height: 20px; fill: none; stroke: currentColor; stroke-width: 2; }

  .filterBtn { position: absolute; left: 10px; bottom: 10px; z-index: 20; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
  .filterBtn.has-active::after { 
      content: ""; position: absolute; top: 6px; right: 6px; 
      width: 8px; height: 8px; background: #F59E0B; 
      border-radius: 50%; border: 1px solid #1e293b;
  }

  .mapLegend { position: absolute; right: 10px; bottom: 10px; padding: 10px; width: 140px; direction: rtl; text-align: right; pointer-events: none; z-index: 15; font-size: 14px; }
  .legRow { display: flex; align-items: center; gap: 8px; margin-bottom: 5px; }
  .legLine { width: 24px; height: 3px; border-radius: 1px; }

  /* Task Panel */
  .taskPanel {font-family: Arial, sans-serif; width: 430px; max-width: 40%; display: flex; flex-direction: column; gap: 12px; padding: 16px; direction: rtl; text-align: right; overflow-y: auto; }
  .h { font-weight: 700; font-size: 24px; color: #fff; margin-bottom: 4px; }
  .muted { font-size: 20px; opacity: 0.8; line-height: 1.5; white-space: pre-wrap; }
  .sep { height: 1px; background: rgba(255,255,255,0.1); margin: 4px 0; }
  
  .recBox { 
      background: rgba(59,130,246,0.15); 
      border: 1px solid rgba(59,130,246,0.4); 
      padding: 12px 16px; 
      border-radius: 8px; 
      display: flex; 
      justify-content: space-between; 
      align-items: center;
      font-family: Arial, sans-serif !important;
  }
  .recLabel { font-size: 20px !important; font-weight: normal; color: #e8eefc; }
  .recVal { font-family: Arial, sans-serif !important; font-size: 20px !important; font-weight: 800; color: #60A5FA; }

  .btnPrimary { width: 100%; padding: 14px; background: #2563EB; color: white; border: none; border-radius: 8px; font-size: 20px; font-weight: 700; cursor: pointer; margin-top: auto; }
  .btnPrimary:hover { background: #1D4ED8; }

  /* Bottom Panel Layout - RTL */
  .bottom { height: 260px; display: flex; gap: 8px; direction: rtl; }
  
  /* 1. GANTT PANEL (Rightmost) */
  .ganttPanel { 
      width: 38%; 
      min-width: 320px; 
      padding: 12px; 
      direction: rtl; 
      display: flex; 
      flex-direction: column; 
  }

  /* 2. VIZ PANEL (Center) */
  .vizPanel { 
      flex: 1; 
      padding: 12px; 
      direction: rtl; 
      overflow: hidden; 
      display: flex; 
      flex-direction: column; 
  }

  /* 3. LEGEND PANEL (Leftmost) */
  .legendPanel { 
      width: 190px; 
      padding: 12px; 
      display: flex; 
      flex-direction: column; 
      justify-content: flex-start; 
      direction: rtl; 
      overflow-y: auto; 
  }
  .legItem { margin-bottom: 12px; display: flex; align-items: flex-start; gap: 8px; }
  .legColorBox { width: 14px; height: 14px; margin-top: 3px; border-radius: 3px; flex-shrink: 0; }
  .legContent { display: flex; flex-direction: column; font-family: Arial !important;}
  .legTitle { font-weight: 800; font-size: 14px; font-family: Arial !important;}
  .legDesc { font-size: 12px; opacity: 0.7; margin-top: 2px; font-family: Arial !important;}

  /* Viz Container inside Panel */
  #viz-container {
    width: 100%;
    height: 100%;
    overflow: hidden;
    box-sizing: border-box;
    border: 2px solid #3B82F6; 
    background: rgba(255, 255, 255, 0.02);
    border-radius: 8px; 
    padding: 10px;
    display: flex;
    flex-direction: column;
    position: relative;
  }
  
  .viz-headers-row {
      display: flex; width: 100%; margin-bottom: 8px; padding-bottom: 6px;
      border-bottom: 1px solid rgba(255,255,255,0.1);
  }
  .viz-header-item {
      flex: 1; text-align: center; font-weight: bold; font-size: 13px; color: #cbd5e1;
      display: flex; align-items: center; justify-content: center; gap: 6px;
  }

  /* Heatmap - Fixed Column Width Logic */
  .heatmap-table { width: 100%; height: 100%; border-collapse: collapse; table-layout: fixed; }
  
  /* Force fixed width on first column, let others flex */
  .heatmap-table th:first-child, 
  .heatmap-table td:first-child { 
      width: 90px; /* Fixed narrow width */
      max-width: 90px;
      padding-left: 4px; 
      text-align: right !important; 
      white-space: nowrap;
  }
  
  .heatmap-table th { padding-bottom: 6px; text-align: center; vertical-align: bottom; }
  .heatmap-table td { border-bottom: 1px solid rgba(255,255,255,0.1); }
  
  .heatmap-cell { 
      text-align: center; vertical-align: middle; 
      color: #fff; font-weight: 900; font-size: 15px;
      text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000, 0 0 5px rgba(0,0,0,0.8);
      margin: 2px; border-radius: 4px; height: 100%;
  }
  .heatmap-table td > div { height: 85%; width: 92%; margin: 0 auto; display:flex; align-items:center; justify-content:center; border-radius:4px; }
  .segment-badge {
      display: inline-block; width: 20px; height: 20px; line-height: 20px;
      border-radius: 50%; background-color: #1E4ED8; color: white; text-align: center; font-weight: bold; font-size: 11px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.3);
  }

  /* Stacked Bars */
  .stacked-wrapper { display: flex; width: 100%; height: 100%; align-items: flex-end; }
  .stacked-col-container { flex: 1; height: 100%; display: flex; flex-direction: column; justify-content: flex-end; align-items: center; padding: 0 10px; }
  .stacked-bar { width: 60%; display: flex; flex-direction: column-reverse; border-radius: 4px 4px 0 0; overflow: hidden; background: rgba(255,255,255,0.05); }
  .stack-segment { width: 100%; position: relative; border-top: 1px solid rgba(255,255,255,0.2); overflow: visible !important; box-sizing: border-box; }
  .stack-label { position: absolute; top: 50%; left: 0; right: 0; transform: translateY(-50%); text-align: center; color: white; font-weight: bold; font-size: 11px; text-shadow: 0 1px 3px rgba(0,0,0,0.9), 0 0 2px black; white-space: nowrap; pointer-events: none; display: flex; align-items: center; justify-content: center; gap: 4px; }

  /* Radar */
  .radar-wrapper { display: flex; width: 100%; height: 100%; align-items: center; justify-content: space-around; direction: rtl; }
  .radar-chart { 
      position: relative; flex: 1; height: 100%; 
      display: flex; flex-direction: column; align-items: center; justify-content: center; 
  }
  .radar-badge-corner { position: absolute; top: 5px; right: 10px; z-index: 10; display:flex; align-items:center; gap:6px; font-weight:bold; font-size:12px; color:#ddd; }

  /* Gantt Styles */
  .ganttScroll { 
      flex: 1; 
      overflow-y: auto; 
      overflow-x: hidden; 
      padding-left: 0; 
      padding-right: 4px;
      direction: rtl; 
  }
  
  .ganttRow { 
      display: flex; align-items: center; height: 42px; margin-bottom: 10px; 
      cursor: pointer; transition: 0.1s; 
      border-radius: 6px; border: 1px solid transparent; 
      position: relative; 
      margin-left: 4px; 
  }
  .ganttRow:hover { background: rgba(255,255,255,0.05); }
  
  .ganttRow.active { 
      background: rgba(59,130,246,0.2); 
      border: 2px solid #3B82F6; 
      box-shadow: inset 0 0 10px rgba(59,130,246,0.3);
  }

  .gLabel { width: 60px; font-weight: 700; font-size: 14px; }
  .gTrackContainer { flex: 1; height: 28px; position: relative; background: rgba(255,255,255,0.1); border-radius: 4px; overflow: hidden; }
  .gBar { height: 100%; position: absolute; right: 0; top: 0; bottom: 0; border-radius: 4px; overflow: hidden; direction: rtl; display: flex; }
  .gSeg { height: 100%; flex-shrink: 0; display: flex; align-items: center; justify-content: center; font-size: 13px; font-weight: 900; color: #000; background: #8CCBFF; border-left: 3px solid #000; box-sizing: border-box; }
  .gSeg:last-child { border-left: none; }
  .gAxis { position: relative; height: 20px; margin-top: 4px; border-top: 1px solid rgba(255,255,255,0.1); margin-right: 60px; direction: ltr; }

  /* Modals */
  .backdrop { position: fixed; inset: 0; background: rgba(0,0,0,0.6); display: none; align-items: center; justify-content: center; z-index: 9999; backdrop-filter: blur(2px); }
  .backdrop.show { display: flex; }
  .modal { background: #1b1b1c; border: 1px solid #334155; width: 400px; max-width: 90%; padding: 20px; border-radius: 12px; text-align: center; direction: rtl; box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.5); }
  .modalBtns { display: flex; gap: 10px; margin-top: 20px; justify-content: center; }
  .mBtn { padding: 10px 20px; border-radius: 6px; cursor: pointer; border: none; font-weight: 700; flex:1; }
  .mBtn.yes { background: #2563EB; color: white; }
  .mBtn.no { background: rgba(255,255,255,0.1); color: white; }
  .filterRow { display: flex; justify-content: space-between; align-items: center; padding: 10px; border-bottom: 1px solid rgba(255,255,255,0.1); }
  .eyeBtn { background: none; border: none; color: white; cursor: pointer; opacity: 0.7; display:flex; align-items:center; gap:4px; }
  .eyeBtn.on { opacity: 1; color: #60A5FA; }
  /* ---     (/) --- */
            /* ---      --- */
            
            /* 1.     -   */
            div.maplibregl-ctrl-group {
                background: #ffffff !important;
                border: 1px solid #ccc !important;
                box-shadow: 0 1px 2px rgba(0,0,0,0.1) !important;
                opacity: 1 !important;
            }

            /* 2.   -   */
            div.maplibregl-ctrl-group button {
                background: #ffffff !important; /*  -background  */
                opacity: 1 !important;
                border: 0 !important;
                border-bottom: 1px solid #ddd !important;
                transition: none !important; /*    */
                cursor: pointer !important;
            }
            
            /*      */
            div.maplibregl-ctrl-group button:last-child {
                border-bottom: 0 !important;
            }

            /* 3.  HOVER -     */
            div.maplibregl-ctrl-group button:hover {
                background: #cccccc !important;
                opacity: 1 !important;
            }

            /* 4.  (/) -   */
            .maplibregl-ctrl-icon, 
            div.maplibregl-ctrl-group button span {
                filter: grayscale(100%) brightness(0) !important; /*    */
                opacity: 1 !important;
                background-color: transparent !important; /*      */
            }
</style>
</head>
<body>

<div class="root">
  <div class="top">
    <div class="mapPanel panel">
      <div id="mapStage">
        <img id="baseImg" draggable="false" />
        <svg id="overlaySvg"></svg>
      </div>

      <div class="ctrlCol">
        <button class="ctrlBtn" id="zoomIn" title=" "><svg viewBox="0 0 24 24"><path d="M12 5v14M5 12h14"/></svg></button>
        <button class="ctrlBtn" id="fitView" title=" "><svg viewBox="0 0 24 24"><path d="M4 4h16v16H4zM8 8h8v8H8z"/></svg></button>
        <button class="ctrlBtn" id="zoomOut" title=" "><svg viewBox="0 0 24 24"><path d="M5 12h14"/></svg></button>
      </div>

      <button class="filterBtn" id="openFilter" title="">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="12 2 2 7 12 12 22 7 12 2"></polygon><polyline points="2 17 12 22 22 17"></polyline><polyline points="2 12 12 17 22 12"></polyline></svg>
      </button>

      <div class="mapLegend panel">
        <div style="font-weight:700; margin-bottom:8px; opacity:0.9"> </div>
        <div class="legRow"><div class="legLine" style="background:#8CCBFF"></div><span></span></div>
        <div class="legRow"><div class="legLine" style="background:#1E4ED8"></div><span> </span></div>
        <div class="legRow"><div class="legLine" style="border-top:3px dashed #FF0022; height:0"></div><span></span></div>
       <div class="legRow">
           <div style="width:24px; position:relative; height:12px; display:flex; align-items:center; justify-content:center">
           
             <div style="position:absolute; top:0; width:100%; height:2px; background:#FFE100"></div>
             <div style="position:absolute; bottom:0; width:100%; height:2px; background:#FFE100"></div>
             
             <div style="width:14px; height:14px; background:#FFE100; border:1px solid rgba(0,0,0,0.7); border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:10px; font-weight:700; color:#000; position:absolute; z-index:5; font-family:Arial, sans-serif;"></div>
           </div>
           <span></span>
        </div>
        <div class="legRow"><div style="width:12px; height:12px; background:rgba(170,60,255,0.4); border:1px solid #A855F7; border-radius:50%"></div><span></span></div>
        <div class="legRow"><div style="width:16px; height:10px; background:#00FF66; opacity:0.7"></div><span></span></div>
      </div>
    </div>

    <div class="taskPanel panel">
      <div class="h"></div>
      <div class="muted" id="taskText"></div>
      <div class="muted" id="requirementsText" style="font-weight:900; margin-top:8px; display:none; font-size:24px; font-family: Arial !important, sans-serif !important"></div>
      <div class="sep"></div>
      <div class="recBox">
        <div class="recLabel"> </div>
        <div class="recVal" id="recRoute" style= "font-size:20px; font-family: Arial !important"></div>
      </div>
      <div style="font-size:12px; margin-top:4px; opacity:0.8; margin-right:20px">       (   //).</div>
      
      <div class="sep"></div>
      <div style="display:flex; justify-content:space-between; align-items:center; font-weight:700">
        <span style="font-size:20px; margin-right:20px"> :</span>
        <span id="pickedDisplay" style="font-size:20px; color:#60A5FA; margin-left:18px"></span>
      </div>
      <button class="btnPrimary" id="submitBtn"> </button>
    </div>
  </div>

  <div class="bottom">
    <div class="ganttPanel panel">
         <div class="h" style="font-size:14px; margin-bottom:10px">  ()</div>
         <div id="ganttContainer" class="ganttScroll"></div>
         <div id="ganttAxis" class="gAxis"></div>
    </div>

    <div class="vizPanel panel">
         <div id="viz-container"></div>
    </div>

    <div class="legendPanel panel">
      <div class="h" style="font-size:14px; margin-bottom:12px"> </div>
      <div id="vizLegendContent"></div>
    </div>
  </div>
</div>

<div class="backdrop" id="filterModal">
  <div class="modal" style="width:320px">
    <div class="h"> </div>
    <div style="margin:15px 0; display:flex; gap:10px; justify-content:center">
        <button id="showAll" class="eyeBtn on" style="font-size:12px; border:1px solid #555; padding:6px 12px; border-radius:4px"> </button>
        <button id="hideAll" class="eyeBtn" style="font-size:12px; border:1px solid #555; padding:6px 12px; border-radius:4px"> </button>
    </div>
    <div id="filterList" style="text-align:right"></div>
    <div style="margin-top:20px">
        <button class="mBtn no" id="closeFilter"></button>
    </div>
  </div>
</div>

<div class="backdrop" id="confirmModal">
  <div class="modal">
    <div class="h" style="font-size:18px; margin-bottom:10px"> </div>
    <p id="confirmText" style="margin-bottom:20px; font-size:16px"></p>
    <div id="confirmWarning" style="background:rgba(245,158,11,0.2); color:#FCD34D; padding:10px; border-radius:6px; margin-bottom:20px; display:none; font-size:14px; border:1px solid rgba(245,158,11,0.4)">
         :     .
    </div>
    <div class="modalBtns">
      <button class="mBtn yes" id="doConfirm">,  </button>
      <button class="mBtn no" id="cancelConfirm"></button>
    </div>
  </div>
</div>

<script>
const DATA = ${l};
let scale = 1, pan = {x: 0, y: 0}, picked = DATA.recommendedRoute || 'A';
let filters = { routes: true, traffic: true, toll: true, comm: true, parks: true };

const els = {
    mapPanel: document.querySelector('.mapPanel'), 
    mapStage: document.getElementById('mapStage'),
    baseImg: document.getElementById('baseImg'),
    svg: document.getElementById('overlaySvg'),
    taskText: document.getElementById('taskText'),
    requirementsText: document.getElementById('requirementsText'),
    recRoute: document.getElementById('recRoute'),
    pickedDisplay: document.getElementById('pickedDisplay'),
    vizContainer: document.getElementById('viz-container'),
    vizLegend: document.getElementById('vizLegendContent'),
    gantt: document.getElementById('ganttContainer'),
    gAxis: document.getElementById('ganttAxis'),
    filterBtn: document.getElementById('openFilter'),
    filterList: document.getElementById('filterList'),
    confirmText: document.getElementById('confirmText'),
    confirmWarn: document.getElementById('confirmWarning')
};

// Init Legend
DATA.vizConfig.forEach(c => {
    const row = document.createElement('div');
    row.className = 'legItem';
    row.innerHTML = '<div class="legColorBox" style="background:'+c.color+'"></div>' + 
                    '<div class="legContent"><div class="legTitle">'+c.label+'</div><div class="legDesc">'+c.desc+'</div></div>';
    els.vizLegend.appendChild(row);
});

// Init Map Image
els.baseImg.src = DATA.baseMapDataUrl;
els.baseImg.onload = () => {
    const w = els.baseImg.naturalWidth || DATA.mapView.width;
    const h = els.baseImg.naturalHeight || DATA.mapView.height;
    els.mapStage.style.width = w + 'px';
    els.mapStage.style.height = h + 'px';
    els.svg.setAttribute('viewBox', \`0 0 \${w} \${h}\`);
    updateTransform();
};
if (els.baseImg.complete && els.baseImg.naturalWidth > 0) els.baseImg.onload();

els.taskText.textContent = DATA.taskText;
if (els.requirementsText) {
  const t = String(DATA.requirementsText || '').trim();
  if (t) { els.requirementsText.style.display = 'block'; els.requirementsText.textContent = t; }
}

els.recRoute.textContent = ' ' + heb(DATA.recommendedRoute);

// Projection Helpers
function project(ll) {
    const merc = (lon, lat) => {
        const x = (lon + 180) / 360;
        const sin = Math.sin(lat * Math.PI / 180);
        const y = (0.5 - Math.log((1 + sin) / (1 - sin)) / (4 * Math.PI));
        return { x, y };
    };
    const c = merc(DATA.mapView.center[0], DATA.mapView.center[1]);
    const p = merc(ll[0], ll[1]);
    const worldSize = Math.pow(2, DATA.mapView.zoom) * 512;
    return {
        x: DATA.mapView.width / 2 + (p.x - c.x) * worldSize,
        y: DATA.mapView.height / 2 + (p.y - c.y) * worldSize
    };
}
function heb(id) { return id === 'A' ? '' : id === 'B' ? '' : ''; }

function getTickLine(p1, p2, p3, len) {
    let vx1 = p2.x - p1.x, vy1 = p2.y - p1.y;
    let vx2 = p3.x - p2.x, vy2 = p3.y - p2.y;
    const l1 = Math.hypot(vx1, vy1) || 1;
    const l2 = Math.hypot(vx2, vy2) || 1;
    vx1/=l1; vy1/=l1; vx2/=l2; vy2/=l2;
    let bx = vx1 + vx2, by = vy1 + vy2;
    const bl = Math.hypot(bx, by);
    if(bl < 1e-5) { bx = -vy1; by = vx1; } else { bx/=bl; by/=bl; }
    const nx = -by, ny = bx;
    return [{x: p2.x - nx*len, y: p2.y - ny*len}, {x: p2.x + nx*len, y: p2.y + ny*len}];
}

function getOffsetPath(coords, offsetPx) {
    if(coords.length < 2) return '';
    let d = '';
    for(let i=0; i<coords.length; i++) {
        const curr = project(coords[i]);
        const next = coords[i+1] ? project(coords[i+1]) : null;
        let dx, dy;
        if (next) { dx = next.x - curr.x; dy = next.y - curr.y; } 
        else { dx = curr.x - project(coords[i-1]).x; dy = curr.y - project(coords[i-1]).y; }
        const len = Math.hypot(dx, dy) || 1;
        const nx = -dy/len, ny = dx/len;
        d += (i===0 ? 'M' : 'L') + (curr.x + nx * offsetPx).toFixed(1) + ',' + (curr.y + ny * offsetPx).toFixed(1) + ' ';
    }
    return d;
}

// Drawing Map
// Drawing Map
function drawMap() {
    els.svg.innerHTML = '';
    
    //   (Groups)  
    const gParks = g('gp');       //  ( )
    const gComm = g('gc');        //  ( ,  )
    const gToll = g('gt');        //  ( )
    const gRoutesHalo = g('grh'); //   
    const gRoutes = g('gr');      //  
    const gTraffic = g('gtr');    //  ( )
    const gTollIco = g('gti');    //   
    const gSegs = g('gs');        //   (1, 2, 3)
    const gOver = g('go');        //   (, /)

    //      -Z (   -  )
    //  : gComm      -gRoutes
    els.svg.append(gParks, gComm, gToll, gRoutesHalo, gRoutes, gTraffic, gTollIco, gSegs, gOver);

    //   (Purple Zones)
    if(filters.comm) DATA.catCommZones.forEach(z => gComm.appendChild(mkPoly(z.ring, DATA.colors.comm.fill, DATA.colors.comm.outline)));
    
    
    //  
    if(filters.parks) DATA.manualParks.forEach(p => gParks.appendChild(mkPoly(p.ring, DATA.colors.parks.fill, DATA.colors.parks.outline)));
    
    //   (   )
    if(filters.toll) DATA.catTollSegs.forEach(seg => {
         const shadow = mkPath(seg.coords, 'rgba(0,0,0,0.35)', 10);
         gToll.appendChild(shadow);

         const p1 = document.createElementNS('http://www.w3.org/2000/svg','path');
         p1.setAttribute('d', getOffsetPath(seg.coords, 3)); 
         p1.setAttribute('stroke', DATA.colors.toll); 
         p1.setAttribute('stroke-width', 2); 
         p1.setAttribute('fill', 'none');
         
         const p2 = document.createElementNS('http://www.w3.org/2000/svg','path');
         p2.setAttribute('d', getOffsetPath(seg.coords, -3)); 
         p2.setAttribute('stroke', DATA.colors.toll); 
         p2.setAttribute('stroke-width', 2); 
         p2.setAttribute('fill', 'none');
         
         gToll.append(p1, p2);
    });

    //  
    if(filters.routes) {
        const routeKeys = ['A', 'B', 'C'].sort((a,b) => a === picked ? 1 : -1);
        
        routeKeys.forEach(rid => {
            const pts = DATA.routes[rid];
            if(!pts) return;
            const isSel = rid === picked;
            const color = isSel ? DATA.colors.routeSelected : DATA.colors.routeRegular;
            
            // Halo (   )
            gRoutesHalo.appendChild(mkPath(pts, 'rgba(0,0,0,0.3)', isSel ? 10 : 8));
            
            //  
            const line = mkPath(pts, color, isSel ? 6 : 5);
            line.style.cursor = 'pointer'; 
            line.onclick = (e) => { e.stopPropagation(); selectRoute(rid); };
            gRoutes.appendChild(line);
            
            //     
            const hit = mkPath(pts, 'transparent', 20);
            hit.style.cursor = 'pointer'; 
            hit.onclick = (e) => { e.stopPropagation(); selectRoute(rid); };
            gRoutes.appendChild(hit);

            //     
            if(isSel) {
                const proj = pts.map(project);
                const total = getPathLen(proj);
                [0.33, 0.66].forEach(f => {
                    const {p, idx} = getPointAtFrac(proj, total, f);
                    if(p && idx>0 && idx<proj.length-1) {
                         const lg = getTickLine(proj[idx-1], p, proj[idx+1], 10);
                         const l = document.createElementNS('http://www.w3.org/2000/svg','line');
                         l.setAttribute('x1', lg[0].x); l.setAttribute('y1', lg[0].y);
                         l.setAttribute('x2', lg[1].x); l.setAttribute('y2', lg[1].y);
                         l.setAttribute('stroke', '#000'); l.setAttribute('stroke-width', 2);
                         gSegs.appendChild(l);
                    }
                });
                [0.16, 0.5, 0.83].forEach((f,i) => {
                    const {p} = getPointAtFrac(proj, total, f);
                    if(p) {
                         const g = document.createElementNS('http://www.w3.org/2000/svg','g');
                         g.append(circle(p.x, p.y, 9, color, '#fff'), text(p.x, p.y+4, String(i+1), 11, '#fff'));
                         gSegs.appendChild(g);
                    }
                });
            }
        });
        
        // ' ()
        if(DATA.badges) DATA.badges.forEach(b => {
             const isSel = b.id === picked;
             const p = project(b.coord);
             const col = isSel ? DATA.colors.routeSelected : DATA.colors.routeRegular;
             const g = document.createElementNS('http://www.w3.org/2000/svg','g');
             g.style.cursor = 'pointer'; g.onclick = (e) => { e.stopPropagation(); selectRoute(b.id); };
             const rect = document.createElementNS('http://www.w3.org/2000/svg','rect');
             rect.setAttribute('x', p.x-40); rect.setAttribute('y', p.y-13); rect.setAttribute('width', 80); rect.setAttribute('height', 26);
             rect.setAttribute('rx', 7); rect.setAttribute('fill', col); rect.setAttribute('stroke', 'rgba(0,0,0,0.3)');
             const label = (b.label ? String(b.label) : (' ' + heb(b.id)));
             const t = text(p.x, p.y+6, label, 13, isSel ? '#fff' : '#000'); t.setAttribute('font-weight','900');
             g.append(rect, t);
             gOver.appendChild(g);
        });
    }

    //   (      )
    if(filters.traffic) DATA.catTrafficSegs.forEach(s => {
        const p = mkPath(s.coords, DATA.colors.traffic, 5); p.setAttribute('stroke-dasharray', '5,5'); gTraffic.appendChild(p);
    });

    //   
    if(filters.toll) DATA.catTollLabels.forEach(l => {
        const p = project(l.coord);
        const g = document.createElementNS('http://www.w3.org/2000/svg','g');
        g.append(circle(p.x, p.y, 7, DATA.colors.toll, '#000'), text(p.x, p.y+3, '', 10, '#000'));
        gTollIco.appendChild(g);
    });

    //  
    if(DATA.start) { const p = project(DATA.start); gOver.append(circle(p.x, p.y, 7, '#fff', '#000'), drawLabel(p.x, p.y-20, '')); }
    if(DATA.end) { 
        const p = project(DATA.end); 
        const g = document.createElementNS('http://www.w3.org/2000/svg','g');
        g.innerHTML = '<path transform="translate('+(p.x-10)+','+(p.y-22)+') scale(0.85)" d="M12 0c-6.6 0-12 5.4-12 12 0 8 12 24 12 24s12-16 12-24c0-6.6-5.4-12-12-12zm0 16c-2.2 0-4-1.8-4-4s1.8-4 4-4 4 1.8 4 4-1.8 4-4 4z" fill="#d11111" stroke="#000" stroke-width="1"/>';
        gOver.append(g, drawLabel(p.x, p.y-30, ''));
    }
}

// Map SVG Helpers
function g(id){ const e = document.createElementNS('http://www.w3.org/2000/svg','g'); e.id=id; return e; }
function mkPath(c,col,w){
    const d=c.map((pt,i)=>(i==0?'M':'L')+project(pt).x+','+project(pt).y).join(' ');
    const p=document.createElementNS('http://www.w3.org/2000/svg','path');
    p.setAttribute('d',d); p.setAttribute('stroke',col); p.setAttribute('stroke-width',w); p.setAttribute('fill','none'); p.setAttribute('stroke-linecap','round'); p.setAttribute('stroke-linejoin','round');
    return p;
}
function mkPoly(r,f,s){
    const pts=r.map(pt=>project(pt).x+','+project(pt).y).join(' ');
    const p=document.createElementNS('http://www.w3.org/2000/svg','polygon');
    p.setAttribute('points',pts); p.setAttribute('fill',f); p.setAttribute('stroke',s); p.setAttribute('stroke-width',2);
    return p;
}
function circle(x,y,r,f,s){
    const c=document.createElementNS('http://www.w3.org/2000/svg','circle');
    c.setAttribute('cx',x); c.setAttribute('cy',y); c.setAttribute('r',r); c.setAttribute('fill',f); c.setAttribute('stroke',s);
    return c;
}
function text(x,y,t,sz,f){
    const el=document.createElementNS('http://www.w3.org/2000/svg','text');
    el.setAttribute('x',x); el.setAttribute('y',y); el.setAttribute('text-anchor','middle'); el.setAttribute('font-size',sz); el.setAttribute('fill',f); el.setAttribute('font-family','Arial'); el.textContent=t;
    return el;
}
function drawLabel(x,y,txt){
    const g=document.createElementNS('http://www.w3.org/2000/svg','g');
    const w=txt.length*7+10, h=18;
    const r=document.createElementNS('http://www.w3.org/2000/svg','rect');
    r.setAttribute('x',x-w/2); r.setAttribute('y',y-h/2); r.setAttribute('width',w); r.setAttribute('height',h); r.setAttribute('rx',4); r.setAttribute('fill','rgba(0,0,0,0.8)');
    const t=text(x,y+4,txt,11,'#fff'); t.setAttribute('font-weight','bold');
    g.append(r,t); return g;
}
function getPathLen(pts){ let l=0; for(let i=1;i<pts.length;i++) l+=Math.hypot(pts[i].x-pts[i-1].x, pts[i].y-pts[i-1].y); return l; }
function getPointAtFrac(pts,total,frac){
    const tg=total*frac; let d=0;
    for(let i=1;i<pts.length;i++){
        const dist=Math.hypot(pts[i].x-pts[i-1].x, pts[i].y-pts[i-1].y);
        if(d+dist>=tg){ const t=(tg-d)/dist; return {p:{x:pts[i-1].x+(pts[i].x-pts[i-1].x)*t, y:pts[i-1].y+(pts[i].y-pts[i-1].y)*t}, idx:i}; }
        d+=dist;
    }
    return {p:pts[pts.length-1], idx:pts.length-1};
}

// --- VISUALIZATION LOGIC ---
function renderVizContainer() {
    const container = els.vizContainer;
    container.innerHTML = '';
    
    const vizType = DATA.vizType; 
    const segments = (DATA.routeScores || []).filter(s => s.route === picked).sort((a,b) => a.segment - b.segment);
    const cats = DATA.vizConfig; 

    if (!segments.length) {
        container.innerHTML = '<div style="text-align:center; opacity:0.6; margin-top:20px"> </div>';
        return;
    }

    if (vizType === 'HEATMAP') {
        const table = document.createElement('table'); table.className = 'heatmap-table';
        const thead = document.createElement('thead');
        const hRow = document.createElement('tr');
        hRow.appendChild(document.createElement('th')); 
        segments.forEach(seg => {
            const th = document.createElement('th');
            th.innerHTML = '<span style="font-size:12px; color:#cbd5e1; margin-left:4px"></span><span class="segment-badge">' + seg.segment + '</span>';
            hRow.appendChild(th);
        });
        thead.appendChild(hRow); table.appendChild(thead);
        const tbody = document.createElement('tbody');
        
        cats.forEach(c => {
            const tr = document.createElement('tr');
            const tdName = document.createElement('td');
            // Left aligned as requested
            tdName.style.textAlign = 'left'; 
            tdName.style.padding = '4px'; 
            tdName.style.color='#ddd';
            tdName.innerHTML = '<span style="display:inline-block;width:10px;height:10px;border-radius:50%;margin-left:6px;background:' + c.color + '"></span>' + c.label;
            tr.appendChild(tdName);
            
            segments.forEach(seg => {
                const td = document.createElement('td');
                //     
                //const val = seg[c.key] || 0;
                //const lightness = 15 + (val * 0.65); 
                //const bg = 'hsl(220, 25%, ' + lightness + '%)';
                //td.innerHTML = '<div style="background:'+bg+'" class="heatmap-cell">'+Math.round(val)+'</div>';
                //      
                const val = seg[c.key] || 0;
                //  : 0 =  (Hue 0), 100 =  (Hue 120)
                const hue = Math.round(val * 1.2); 
                const bg = 'hsl(' + hue + ', 75%, 35%)'; //       
                td.innerHTML = '<div style="background:'+bg+'; color:white;" class="heatmap-cell">'+Math.round(val)+'</div>';
                tr.appendChild(td);
            });
            tbody.appendChild(tr);
        });
        table.appendChild(tbody);
        container.appendChild(table);

    } else if (vizType === 'STACKED') {
        const headerRow = document.createElement('div'); headerRow.className = 'viz-headers-row';
        segments.forEach(seg => {
            const el = document.createElement('div'); el.className = 'viz-header-item';
            el.innerHTML = ' <span class="segment-badge">' + seg.segment + '</span>';
            headerRow.appendChild(el);
        });
        container.appendChild(headerRow);

        const maxPossible = cats.length * 100; 
        const wrapper = document.createElement('div'); wrapper.className = 'stacked-wrapper';
        segments.forEach(seg => {
            const colCont = document.createElement('div'); colCont.className = 'stacked-col-container';
            const bar = document.createElement('div'); bar.className = 'stacked-bar';
            
            let currentTotal = 0;
            cats.forEach(c => currentTotal += (seg[c.key] || 0));
            const barHeightPct = Math.min(100, (currentTotal / maxPossible) * 100);
            bar.style.height = barHeightPct + '%';
            
            cats.forEach(c => {
                const val = seg[c.key] || 0;
                if(val > 0) {
                   const item = document.createElement('div');
                   item.className = 'stack-segment';
                   item.style.backgroundColor = c.color;
                   const segH = (val / currentTotal) * 100;
                   item.style.height = segH + '%';
                   
                   // :    ( -10%),    -Z   
                   if (segH < 10) item.style.zIndex = '10';
                   else item.style.zIndex = '1';

                   //     
                   const lbl = document.createElement('div');
                   lbl.className = 'stack-label';
                   lbl.innerHTML = '<span>' + c.label + '</span><span>' + Math.round(val) + '</span>';
                   
                   item.appendChild(lbl);
                   bar.appendChild(item);
                }
            });
            colCont.appendChild(bar);
            wrapper.appendChild(colCont);
        });
        container.appendChild(wrapper);

} else if (vizType === 'RADAR') {
        const wrapper = document.createElement('div'); wrapper.className = 'radar-wrapper';
        
        segments.forEach((seg, idx) => {
             const chartDiv = document.createElement('div'); chartDiv.className = 'radar-chart';
             
             //  
             if (idx > 0) {
                 chartDiv.style.borderRight = '1px solid rgba(255,255,255,0.15)';
             }

             const badge = document.createElement('div');
             badge.className = 'radar-badge-corner';
             badge.innerHTML = ' <span class="segment-badge">' + seg.segment + '</span>';
             chartDiv.appendChild(badge);

             const size = 260; 
             // 1.  -Padding      
             const padding = 180; 
             const totalSize = size + padding * 2;
             
             const cx = totalSize/2, cy = totalSize/2, r = size * 0.9;
             const labelR = r + 25; 
             
             const svgNS = "http://www.w3.org/2000/svg";
             const svg = document.createElementNS(svgNS, "svg");
             svg.setAttribute("width", "100%"); svg.setAttribute("height", "100%");
             svg.setAttribute("viewBox", "0 0 "+totalSize+" "+totalSize);
             svg.style.overflow = "visible"; 
             
             //  
             [0.25, 0.5, 0.75, 1].forEach(k => {
                 const c = document.createElementNS(svgNS, "circle");
                 c.setAttribute("cx", cx); c.setAttribute("cy", cy); c.setAttribute("r", r*k);
                 c.setAttribute("fill", "none"); 
                 c.setAttribute("stroke", "rgba(255,255,255,0.40)");
                 c.setAttribute("stroke-width", k===1 ? "2" : "1");
                 svg.appendChild(c);
             });
             
             let pts = [];
             const angleStep = (Math.PI * 2) / cats.length;
             
             cats.forEach((c, i) => {
                 const val = (seg[c.key] || 0) / 100;
                 const ang = i * angleStep - Math.PI/2;
                 
                 const x = cx + Math.cos(ang) * (r * val);
                 const y = cy + Math.sin(ang) * (r * val);
                 pts.push(x + ',' + y);
                 
                 const lx = cx + Math.cos(ang) * r;
                 const ly = cy + Math.sin(ang) * r;
                 const line = document.createElementNS(svgNS, "line");
                 line.setAttribute("x1", cx); line.setAttribute("y1", cy);
                 line.setAttribute("x2", lx); line.setAttribute("y2", ly);
                 line.setAttribute("stroke", "rgba(255,255,255,0.4)");
                 svg.appendChild(line);

                 // ---    ---
                 
                 const isSide = Math.abs(Math.cos(ang)) > 0.1; 
                 const isRight = Math.cos(ang) > 0; // 
                 const isLeft = Math.cos(ang) < 0;  // 

                 //  
                 let lblX = cx + Math.cos(ang) * labelR;
                 let lblY = cy + Math.sin(ang) * labelR;

                 // 2.    (85px)     
                 if (isSide) {
                     lblX += isRight ? 85 : -85;
                 } else {
                     lblY += Math.sin(ang) * 15;
                 }

                 const gLbl = document.createElementNS(svgNS, "g");
                 
                 // 3.   -150  ( 110)
                 const rectW = 200; 
                 const rectH = 50; //    
                 const rect = document.createElementNS(svgNS, "rect");
                 
                 //     
                 rect.setAttribute("x", lblX - rectW/2);
                 rect.setAttribute("y", lblY - rectH/2);
                 rect.setAttribute("width", rectW); rect.setAttribute("height", rectH);
                 rect.setAttribute("rx", rectH/2); 
                 rect.setAttribute("fill", c.color);
                 rect.setAttribute("filter", "drop-shadow(0px 2px 2px rgba(0,0,0,0.25))");
                 
                 // 
                 const textEl = document.createElementNS(svgNS, "text");
                 textEl.setAttribute("x", lblX); 
                 textEl.setAttribute("y", lblY + 1); //    
                 textEl.setAttribute("text-anchor", "middle");
                 textEl.setAttribute("dominant-baseline", "middle"); 
                 textEl.setAttribute("fill", "#fff");
                 
                 //  
                 textEl.setAttribute("style", "font-family: Arial, sans-serif; font-weight: 900; font-size: 40px !important; paint-order: stroke fill; stroke: rgba(0,0,0,0.8); stroke-width: 3px; stroke-linecap: round; stroke-linejoin: round;");
                 
                 textEl.textContent = c.label + " " + Math.round(seg[c.key]||0);

                 gLbl.appendChild(rect);
                 gLbl.appendChild(textEl);
                 svg.appendChild(gLbl);
             });
             
             const poly = document.createElementNS(svgNS, "polygon");
             poly.setAttribute("points", pts.join(' '));
             poly.setAttribute("fill", DATA.colors.routeSelected);
             poly.setAttribute("fill-opacity", "0.4");
             poly.setAttribute("stroke", DATA.colors.routeSelected);
             poly.setAttribute("stroke-width", "3");
             svg.appendChild(poly);
             
             chartDiv.appendChild(svg);
             wrapper.appendChild(chartDiv);
        });
        
        container.appendChild(wrapper);
    }
}

// Gantt Logic
function renderGantt() {
    const c = els.gantt, ax = els.gAxis;
    c.innerHTML = ''; ax.innerHTML = '';
    const scores = DATA.routeScores || [];
    let maxT = 0;
    ['A','B','C'].forEach(rid => {
        const segs = scores.filter(x => x.route === rid);
        const t = segs.reduce((a,b) => a + (b.timeS || 0), 0);
        if(t > maxT) maxT = t;
    });
    if (maxT === 0) maxT = 1;

    const mins = Math.ceil(maxT/60);
    for(let i=0; i<=mins; i++){
        const pos = (i*60/maxT)*100; if(pos > 100) break;
        const tk = document.createElement('div');
        tk.style.position='absolute'; tk.style.right=pos+'%'; tk.style.transform='translateX(50%)'; tk.textContent=i;
        const ln = document.createElement('div');
        ln.style.position='absolute'; ln.style.right=pos+'%'; ln.style.height='4px'; ln.style.width='1px'; ln.style.background='#555'; ln.style.top='-4px';
        ax.append(ln, tk);
    }

    ['A','B','C'].forEach(rid => {
        const segs = scores.filter(s => s.route === rid).sort((a,b) => a.segment - b.segment);
        const total = segs.reduce((a,b) => a + (b.timeS || 0), 0) || 1;
        const row = document.createElement('div');
        row.className = 'ganttRow' + (rid === picked ? ' active' : '');
        row.onclick = () => { picked=rid; selectRoute(rid); };
        const lbl = document.createElement('div'); lbl.className = 'gLabel'; lbl.textContent = ' ' + heb(rid);
        const trk = document.createElement('div'); trk.className = 'gTrackContainer';
        const bar = document.createElement('div'); bar.className = 'gBar'; bar.style.width = (total / maxT * 100) + '%';
        segs.forEach(s => {
            const el = document.createElement('div'); el.className = 'gSeg';
            const pct = ((s.timeS || 0) / total * 100); el.style.width = pct + '%';
            el.textContent = s.segment;
            bar.appendChild(el);
        });
        trk.appendChild(bar); row.append(lbl, trk); c.appendChild(row);
    });
}

function selectRoute(id) {
    picked = id;
    els.pickedDisplay.textContent = ' ' + heb(id);
    renderVizContainer();
    renderGantt(); 
    drawMap();
}

// FIXED DRIFT-FREE ZOOM LOGIC
els.mapStage.addEventListener('wheel', e => {
    e.preventDefault();
    const rect = els.mapPanel.getBoundingClientRect();
    const mx = e.clientX - rect.left;
    const my = e.clientY - rect.top;
    
    const factor = e.deltaY < 0 ? 1.1 : 0.9;
    const newScale = Math.max(1, Math.min(5, scale * factor));
    
    pan.x = mx - (mx - pan.x) * (newScale / scale);
    pan.y = my - (my - pan.y) * (newScale / scale);
    
    scale = newScale;
    updateTransform();
}, {passive:false});

els.mapStage.onmousedown = e => {
    e.preventDefault();
    const s = {x: e.clientX-pan.x, y: e.clientY-pan.y};
    const mv = m => { pan.x = m.clientX-s.x; pan.y = m.clientY-s.y; updateTransform(); };
    const up = () => { window.removeEventListener('mousemove',mv); window.removeEventListener('mouseup',up); };
    window.addEventListener('mousemove',mv); window.addEventListener('mouseup',up);
};

// Center Zoom logic
function zoomCenter(f) {
    const w = els.mapPanel.offsetWidth, h = els.mapPanel.offsetHeight;
    const cx = w/2, cy = h/2;
    const newScale = Math.max(1, Math.min(5, scale * f));
    pan.x = cx - (cx - pan.x) * (newScale / scale);
    pan.y = cy - (cy - pan.y) * (newScale / scale);
    scale = newScale;
    updateTransform();
}

document.getElementById('zoomIn').onclick = () => zoomCenter(1.2);
document.getElementById('zoomOut').onclick = () => zoomCenter(1/1.2);
document.getElementById('fitView').onclick = () => { scale=1; pan={x:0,y:0}; updateTransform(); };

function updateTransform(){
    const w = els.mapPanel.offsetWidth, h = els.mapPanel.offsetHeight;
    const sw = w*scale, sh = h*scale;
    if(pan.x > 0) pan.x = 0; if(pan.x < w - sw) pan.x = w - sw;
    if(pan.y > 0) pan.y = 0; if(pan.y < h - sh) pan.y = h - sh;
    els.mapStage.style.transform = \`translate(\${pan.x}px, \${pan.y}px) scale(\${scale})\`;
}

document.getElementById('submitBtn').onclick = () => {
    els.confirmText.textContent = '  '+heb(picked)+'.   ?';
    document.getElementById('confirmModal').classList.add('show');
};
document.getElementById('cancelConfirm').onclick = () => document.getElementById('confirmModal').classList.remove('show');
document.getElementById('doConfirm').onclick = () => { alert(' !'); document.getElementById('confirmModal').classList.remove('show'); };

// Filters
els.filterBtn.onclick = () => {
    els.filterList.innerHTML = '';
    const hasActive = Object.values(filters).some(x=>!x);
    els.filterBtn.classList.toggle('has-active', hasActive);
    
    [{k:'routes',l:''},{k:'traffic',l:''},{k:'toll',l:''},{k:'comm',l:''}/*,{k:'parks',l:''}*/].forEach(it=>{
        const div = document.createElement('div'); div.className='filterRow';
        div.innerHTML = \`<span>\${it.l}</span><button class="eyeBtn\${filters[it.k]?' on':''}" onclick="filters['\${it.k}']=!filters['\${it.k}']; drawMap(); this.classList.toggle('on'); document.getElementById('openFilter').classList.toggle('has-active', Object.values(filters).some(x=>!x))"><svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M1 12s4-7 11-7 11 7-4 7-11 7S1 12 1 12z"/><circle cx="12" cy="12" r="3"/></svg></button>\`;
        els.filterList.appendChild(div);
    });
    document.getElementById('filterModal').classList.add('show');
};
document.getElementById('closeFilter').onclick = () => document.getElementById('filterModal').classList.remove('show');
document.getElementById('showAll').onclick = () => { for(let k in filters)filters[k]=true; drawMap(); els.filterBtn.click(); };
document.getElementById('hideAll').onclick = () => { for(let k in filters)filters[k]=false; drawMap(); els.filterBtn.click(); };

// Initial Render
selectRoute(picked);
try { drawMap(); } catch(e){}

<\/script>
</body>
</html>`}const Aw="3IYmgQ2XRtJQCLYAdMs6",$D=`https://api.maptiler.com/maps/streets-v2/style.json?key=${Aw}`,XD=`https://api.maptiler.com/tiles/satellite-v2/{z}/{x}/{y}.jpg?key=${Aw}`,J0="#8CCBFF",Ux=.42,kw=.22,Nh="#1E4ED8",C1=.92,db=9,YD=.35,M1="#00FF66",D1=.95,Rx="rgba(0,90,50,0.9)";function Cw(r){const u=String(r?.id??"").toLowerCase(),l=String(r?.type??""),f=String(r?.["source-layer"]??"").toLowerCase();return(u.includes("park")||u.includes("leisure")||u.includes("garden")||u.includes("wood")||u.includes("forest")||f.includes("park")||f.includes("landcover"))&&(l==="fill"||l==="line")}function pb(r){const u=r.getStyle()?.layers??[];for(const l of u)if(l?.id&&typeof l.id=="string"&&Cw(l))try{if(l.type==="fill"){r.setPaintProperty(l.id,"fill-color",M1),r.setPaintProperty(l.id,"fill-opacity",D1);try{r.setPaintProperty(l.id,"fill-outline-color",Rx)}catch{}}else l.type==="line"&&(r.setPaintProperty(l.id,"line-color",Rx),r.setPaintProperty(l.id,"line-width",1.6),r.setPaintProperty(l.id,"line-opacity",.9))}catch{}}const qy="#FF0022",X0="#FFE100",KD="",Mw="rgba(170,60,255,0.28)",Dw="rgba(170,60,255,0.65)",xg=200,yg=60,Ix=2,JD=xg/Ix,QD=yg/Ix;function Q0(r,u){const f=j=>j*Math.PI/180,[p,b]=r,[_,s]=u,C=f(s-b),M=f(_-p),D=Math.sin(C/2),B=Math.sin(M/2),U=D*D+Math.cos(f(b))*Math.cos(f(s))*B*B;return 2*6371e3*Math.asin(Math.min(1,Math.sqrt(U)))}function _d(r){let u=0;for(let l=1;l<r.length;l++)u+=Q0(r[l-1],r[l]);return u}function ox(r){return Number.isFinite(r)?r<1e3?`${Math.round(r)} m`:`${(r/1e3).toFixed(2)} km`:""}function eR(){const r=window;if(r.__rtlPluginSet)return;const u=q0.getRTLTextPluginStatus,l=q0.setRTLTextPlugin;if(typeof u!="function"||typeof l!="function")return;const f=u();if(f==="loaded"||f==="loading"){r.__rtlPluginSet=!0;return}try{l("https://unpkg.com/@mapbox/mapbox-gl-rtl-text@0.2.3/mapbox-gl-rtl-text.js",()=>{},!0),r.__rtlPluginSet=!0}catch{r.__rtlPluginSet=!0}}async function vg(r){if(r.length<2)return null;const l=`https://router.project-osrm.org/route/v1/driving/${r.map(([f,p])=>`${f},${p}`).join(";")}?overview=full&geometries=geojson`;try{const f=await fetch(l);if(!f.ok)return null;const b=(await f.json())?.routes?.[0]?.geometry?.coordinates;return!Array.isArray(b)||b.length<2?null:b}catch{return null}}function In(r,u){return{type:"FeatureCollection",features:r.map((l,f)=>({type:"Feature",properties:u?.[f]??{},geometry:{type:"Point",coordinates:l}}))}}function _a(r){return r.length<2?{type:"FeatureCollection",features:[]}:{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:r}}]}}function di(r){return{type:"FeatureCollection",features:r.filter(u=>u.coords.length>=2).map(u=>({type:"Feature",properties:u.props??{},geometry:{type:"LineString",coordinates:u.coords}}))}}function B0(r){return{type:"FeatureCollection",features:r.map(u=>({type:"Feature",geometry:{type:"Polygon",coordinates:[u.coords]},properties:u.props??{}}))}}function cr(r,u,l){const f=r.getSource(u);f&&f.setData(l)}function tR(r){const f=(r.getStyle()?.layers??[]).find(p=>p.type==="symbol"&&p?.layout?.["text-font"])?.layout?.["text-font"]??["Noto Sans Regular","Roboto Regular"];return Array.isArray(f)&&f.length?f.map(b=>b.includes("Italic")?b.replace("Italic","Regular"):b):f}function rR(r){if(r.hasImage("end-pin"))return;const u=48,l=document.createElement("canvas");l.width=u,l.height=u;const f=l.getContext("2d");if(!f)return;f.clearRect(0,0,u,u),f.save(),f.translate(u/2,u/2),f.beginPath(),f.ellipse(0,16,10,4,0,0,Math.PI*2),f.fillStyle="rgba(0,0,0,0.22)",f.fill(),f.beginPath(),f.moveTo(0,18),f.bezierCurveTo(10,10,14,3,14,-4),f.arc(0,-4,14,0,Math.PI,!0),f.bezierCurveTo(-14,3,-10,10,0,18),f.closePath(),f.fillStyle="#e11d48",f.fill(),f.beginPath(),f.arc(0,-4,5.2,0,Math.PI*2),f.fillStyle="#ffffff",f.fill(),f.restore();const p=f.getImageData(0,0,u,u);r.addImage("end-pin",{width:u,height:u,data:p.data},{pixelRatio:2})}function nR(r){if(r.hasImage("label-bg"))return;const u=140,l=44,f=document.createElement("canvas");f.width=u,f.height=l;const p=f.getContext("2d");if(!p)return;p.clearRect(0,0,u,l),p.fillStyle="rgba(255,255,255,0.80)",p.strokeStyle="rgba(0,0,0,0.18)",p.lineWidth=2;const b=12;p.beginPath(),p.moveTo(b,0),p.lineTo(u-b,0),p.quadraticCurveTo(u,0,u,b),p.lineTo(u,l-b),p.quadraticCurveTo(u,l,u-b,l),p.lineTo(b,l),p.quadraticCurveTo(0,l,0,l-b),p.lineTo(0,b),p.quadraticCurveTo(0,0,b,0),p.closePath(),p.fill(),p.stroke();const _=p.getImageData(0,0,u,l);r.addImage("label-bg",{width:u,height:l,data:_.data},{pixelRatio:2})}function Px(r){const u=r.replace("#","").trim();if(u.length!==6)return null;const l=parseInt(u.slice(0,2),16),f=parseInt(u.slice(2,4),16),p=parseInt(u.slice(4,6),16);return[l,f,p].every(b=>Number.isFinite(b))?{r:l,g:f,b:p}:null}function aR(r){const u=(p,b,_,s)=>{const C=document.createElement("canvas");C.width=_,C.height=s;const M=C.getContext("2d");if(!M)return null;const D=14,B=8,U=B,j=B,H=_-B*2,O=s-B*2;return M.clearRect(0,0,_,s),M.beginPath(),M.moveTo(U+D,j),M.lineTo(U+H-D,j),M.quadraticCurveTo(U+H,j,U+H,j+D),M.lineTo(U+H,j+O-D),M.quadraticCurveTo(U+H,j+O,U+H-D,j+O),M.lineTo(U+D,j+O),M.quadraticCurveTo(U,j+O,U,j+O-D),M.lineTo(U,j+D),M.quadraticCurveTo(U,j,U+D,j),M.closePath(),M.fillStyle=p,M.fill(),M.lineWidth=2,M.strokeStyle=b,M.stroke(),M.getImageData(0,0,_,s)},l=Px(J0)??{r:140,g:203,b:255},f=Px(Nh)??{r:30,g:78,b:216};if(!r.hasImage("route-badge")){const p=u(`rgba(${l.r},${l.g},${l.b},${Ux})`,"rgba(0,0,0,0.18)",xg,yg);p&&r.addImage("route-badge",{width:xg,height:yg,data:p.data},{pixelRatio:Ix})}if(!r.hasImage("route-badge-selected")){const p=u(`rgba(${f.r},${f.g},${f.b},${C1})`,"rgba(0,0,0,0.18)",xg,yg);p&&r.addImage("route-badge-selected",{width:xg,height:yg,data:p.data},{pixelRatio:Ix})}}function pd(r,u,l){const f=r.getStyle();if(f?.layers){for(const p of f.layers)if(p?.id&&u(p))try{r.setLayoutProperty(p.id,"visibility",l?"visible":"none")}catch{}}}function Xg(r){return r.startsWith("measure-")||r.startsWith("single-")||r.startsWith("start-")||r.startsWith("end-")||r.startsWith("triple-")||r.startsWith("edit-")}function mb(r){const u=r.type,l=String(r.id||"").toLowerCase();return u==="symbol"&&!Xg(String(r.id||""))&&(l.includes("label")||l.includes("place")||l.includes("poi")||l.includes("name"))}function lx(r){const u=String(r.id||"").toLowerCase();return!Xg(String(r.id||""))&&(u.includes("poi")||u.includes("pois"))}function Zy(r){const u=String(r.id||"").toLowerCase(),l=r.type,f=String(r["source-layer"]||"").toLowerCase(),p=u.includes("road")||u.includes("street")||u.includes("highway")||u.includes("transport")||f.includes("transport")||f.includes("road");return!Xg(String(r.id||""))&&l==="line"&&p}function iR(r,u){const l=r.getStyle(),p=(Array.isArray(l?.layers)?l.layers:[]).filter(H=>Zy(H)).map(H=>String(H.id||"")).filter(H=>H.length>0);if(!p.length)return[];const b=r.project([u.west,u.north]),_=r.project([u.east,u.south]),s=Math.min(b.x,_.x),C=Math.max(b.x,_.x),M=Math.min(b.y,_.y),D=Math.max(b.y,_.y);let B=[];try{B=r.queryRenderedFeatures([[s,M],[C,D]],{layers:p.slice(0,30)})}catch{B=[]}const U=[],j=new Set;for(const H of B){const O=H?.geometry;if(!O)continue;const N=O.type,Z=J=>{if(!Array.isArray(J)||J.length<2)return;const X=J,pe=X[0],ge=X[X.length-1],ve=`${pe[0].toFixed(5)},${pe[1].toFixed(5)}-${ge[0].toFixed(5)},${ge[1].toFixed(5)}`;j.has(ve)||_d(X)<80||(j.add(ve),U.push(X))};if(N==="LineString")Z(O.coordinates);else if(N==="MultiLineString"){const J=O.coordinates;if(Array.isArray(J))for(const X of J)Z(X)}if(U.length>=80)break}return U}function gb(r){const u=String(r.id||"").toLowerCase();return!Xg(String(r.id||""))&&(u.includes("transit")||u.includes("rail")||u.includes("subway")||u.includes("train"))}function _b(r,u,l){const f=r.getStyle();if(f?.layers)for(const p of f.layers){if(p.type!=="symbol")continue;const b=String(p.id||"");if(Xg(b))continue;const _=r.getLayoutProperty(b,"text-field");l.current[b]===void 0&&(l.current[b]=_);let s;u==="he"?s=["coalesce",["get","name:he"],["get","name"],["get","name:en"]]:u==="en"?s=["coalesce",["get","name:en"],["get","name"],["get","name:he"]]:s=["coalesce",["get","name"],["get","name:en"],["get","name:he"]];try{r.setLayoutProperty(b,"text-field",s)}catch{}}}function im(){return 111132.92}function sm(r){return 111412.84*Math.cos(r*Math.PI/180)}function N0(r,u,l){const f=r[1],p=l/im(),b=u/(sm(f)||1);return[r[0]+b,r[1]+p]}function yp(){return Math.random()}function Tc(r,u){return r+(u-r)*yp()}function xb(r,u){return Math.floor(Tc(r,u+1))}function sR(r){const u=r.flat();if(!u.length)return null;let l=u[0][0],f=u[0][0],p=u[0][1],b=u[0][1];for(const _ of u)l=Math.min(l,_[0]),f=Math.max(f,_[0]),p=Math.min(p,_[1]),b=Math.max(b,_[1]);return{west:l,south:p,east:f,north:b}}function oR(r,u=.1){const l=r.east-r.west,f=r.north-r.south;return{west:r.west-l*u,east:r.east+l*u,south:r.south-f*u,north:r.north+f*u}}function lR(r){return[Tc(r.west,r.east),Tc(r.south,r.north)]}function cx(r,u,l){if(r.length<2)return r.slice();const f=au(r),p=f[f.length-1]||1,b=Math.max(0,Math.min(p,Math.min(u,l))),_=Math.max(0,Math.min(p,Math.max(u,l))),s=[];s.push(ql(r,f,b));for(let C=0;C<f.length;C++)f[C]>b&&f[C]<_&&s.push(r[C]);return s.push(ql(r,f,_)),s}function _x(r,u){if(r.length<2)return[];const l=au(r),f=l[l.length-1]||0;if(f<=0)return[];const p=[];for(let b=0;b<=f;b+=u)p.push(ql(r,l,b));return p}function Ey(r,u,l=64){const f=r[1],p=sm(f),b=im(),_=[];for(let s=0;s<=l;s++){const C=s/l*Math.PI*2,M=Math.cos(C)*u,D=Math.sin(C)*u;_.push([r[0]+M/(p||1),r[1]+D/b])}return _}function au(r){const u=[0];for(let l=1;l<r.length;l++)u[l]=u[l-1]+Q0(r[l-1],r[l]);return u}function Rw(r){const u=r.length,l=new Array(u).fill(0);for(let f=1;f<u-1;f++){const p=r[f-1],b=r[f],_=r[f+1],s=sm(b[1]),C=im(),M=(b[0]-p[0])*s,D=(b[1]-p[1])*C,B=(_[0]-b[0])*s,U=(_[1]-b[1])*C,j=Math.hypot(M,D)||1,H=Math.hypot(B,U)||1,O=M/j*(B/H)+D/j*(U/H),N=Math.max(-1,Math.min(1,O)),J=Math.acos(N)*180/Math.PI;l[f]=J}return l}function xx(r){const u=r.length;if(u<4){const re=Math.max(1,Math.floor(u/3)),Ce=Math.max(re+1,Math.floor(2*u/3));return{i1:re,i2:Math.min(u-2,Ce)}}const l=au(r),f=l[l.length-1]||1,p=f/3,b=2*f/3,_=Rw(r),s=.18,C=.48,M=f*s,D=f*C,B=[];for(let re=1;re<u-1;re++)B.push(re);const U=[...B].filter(re=>_[re]>=12).sort((re,Ce)=>_[Ce]-_[re]).slice(0,24),j=re=>{let Ce=1,xe=1/0;for(let Ge=1;Ge<u-1;Ge++){const $e=Math.abs(l[Ge]-re);$e<xe&&(xe=$e,Ce=Ge)}return Ce},H=j(p),O=j(b),N=Array.from(new Set([...U,H,O])).filter(re=>re>=1&&re<=u-2).slice(0,30);let Z=null;const J=(re,Ce)=>{const xe=l[re]-l[0],Ge=l[Ce]-l[re],$e=f-l[Ce];if(xe<M||Ge<M||$e<M||xe>D||Ge>D||$e>D)return-1/0;const de=(_[re]||0)+(_[Ce]||0),nt=1-Math.abs(l[re]-p)/f+(1-Math.abs(l[Ce]-b)/f),le=1-(Math.max(xe,Ge,$e)-Math.min(xe,Ge,$e))/f;return de*1+nt*60+le*80};for(let re=0;re<N.length;re++)for(let Ce=re+1;Ce<N.length;Ce++){const xe=N[re],Ge=N[Ce];if(Ge<=xe)continue;const $e=J(xe,Ge);Number.isFinite($e)&&(!Z||$e>Z.score)&&(Z={i1:xe,i2:Ge,score:$e})}if(Z)return{i1:Z.i1,i2:Z.i2};let X=H,pe=O;pe<=X&&(pe=Math.min(u-2,X+1));const ge=(re,Ce)=>{for(;re<u-2&&l[re]<Ce;)re++;return Math.min(u-2,re)},ve=(re,Ce)=>{for(;re>1&&l[re]>Ce;)re--;return Math.max(1,re)};return l[X]<M&&(X=ge(X,M)),l[pe]-l[X]<M&&(pe=ge(pe,l[X]+M)),f-l[pe]<M&&(pe=ve(pe,f-M)),pe<=X&&(pe=Math.min(u-2,X+1)),{i1:X,i2:pe}}function ql(r,u,l){const f=r.length;if(f===0)return[0,0];if(l<=0)return r[0];const p=u[u.length-1]||1;if(l>=p)return r[f-1];let b=1;for(;b<f&&u[b]<l;)b++;const _=Math.max(0,b-1),s=Math.min(f-1,b),C=u[_],M=u[s],D=M===C?0:(l-C)/(M-C),B=r[_],U=r[s];return[B[0]+(U[0]-B[0])*D,B[1]+(U[1]-B[1])*D]}function Ay(r,u){const l=sm((r[1]+u[1])/2),f=im(),p=(u[0]-r[0])*l,b=(u[1]-r[1])*f,_=Math.hypot(p,b)||1;return{ux:p/_,uy:b/_}}function cR(r,u,l){try{const f=r.project(u),p=r.project(l),b=p.x-f.x,_=p.y-f.y;if(b===0&&_===0)return u;const s=JD/2,C=QD/2,M=b!==0?s/Math.abs(b):1/0,D=_!==0?C/Math.abs(_):1/0,B=Math.min(M,D),U=f.x+b*B,j=f.y+_*B,H=r.unproject([U,j]);return[H.lng,H.lat]}catch{return u}}function bf(r){const u=s=>{r.getSource(s)||r.addSource(s,{type:"geojson",data:{type:"FeatureCollection",features:[]}})};u("measure-points"),u("measure-line"),u("manual-parks"),u("manual-park-draft-line"),u("manual-park-draft-points"),u("manual-park-preview-line"),u("single-points"),u("single-line"),u("start-end"),u("triple-a"),u("triple-b"),u("triple-c"),u("triple-badge-points"),u("triple-badge-lines"),u("triple-seg-points"),u("triple-seg-ticks"),u("edit-junctions"),u("cat-traffic"),u("cat-toll"),u("cat-toll-labels"),u("cat-comm");const l=tR(r);try{rR(r),nR(r),aR(r)}catch{}r.getLayer("measure-line")||r.addLayer({id:"measure-line",type:"line",source:"measure-line",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#0b1220","line-width":4,"line-opacity":.85}}),r.getLayer("measure-points")||r.addLayer({id:"measure-points",type:"circle",source:"measure-points",paint:{"circle-radius":5,"circle-color":"#0b1220","circle-stroke-width":2,"circle-stroke-color":"#fff"}}),r.getLayer("manual-parks-fill")||r.addLayer({id:"manual-parks-fill",type:"fill",source:"manual-parks",paint:{"fill-color":M1,"fill-opacity":D1,"fill-outline-color":Rx}}),r.getLayer("manual-park-draft-line-layer")||r.addLayer({id:"manual-park-draft-line-layer",type:"line",source:"manual-park-draft-line",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#2ecc71","line-width":2.5,"line-opacity":0}}),r.getLayer("manual-park-preview-line-layer")||r.addLayer({id:"manual-park-preview-line-layer",type:"line",source:"manual-park-preview-line",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#2ecc71","line-width":2,"line-opacity":0,"line-dasharray":[1.5,1.5]}}),r.getLayer("manual-park-draft-points-layer")||r.addLayer({id:"manual-park-draft-points-layer",type:"circle",source:"manual-park-draft-points",paint:{"circle-radius":4.5,"circle-color":"#2ecc71","circle-stroke-width":2,"circle-stroke-color":"#0b1220"}});const f=(s,C,M)=>{const D=`${C}-outline`;r.getLayer(D)||r.addLayer({id:D,type:"line",source:s,layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#0b1220","line-width":M+2,"line-opacity":kw}}),r.getLayer(C)||r.addLayer({id:C,type:"line",source:s,layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":J0,"line-width":M,"line-opacity":Ux}})};f("single-line","single-line",6),r.getLayer("single-points")||r.addLayer({id:"single-points",type:"circle",source:"single-points",paint:{"circle-radius":5,"circle-color":J0,"circle-stroke-width":2,"circle-stroke-color":"#fff","circle-opacity":.95}}),f("triple-a","triple-a",7),f("triple-b","triple-b",7),f("triple-c","triple-c",7),r.getLayer("cat-comm-fill")||r.addLayer({id:"cat-comm-fill",type:"fill",source:"cat-comm",paint:{"fill-color":Mw,"fill-opacity":.5}},"triple-a-outline"),r.getLayer("cat-comm-outline")||r.addLayer({id:"cat-comm-outline",type:"line",source:"cat-comm",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":Dw,"line-width":1,"line-opacity":.8}},"triple-a-outline"),r.getLayer("cat-traffic-glow")||r.addLayer({id:"cat-traffic-glow",type:"line",source:"cat-traffic",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":qy,"line-width":7,"line-opacity":.28,"line-blur":1.2}}),r.getLayer("cat-traffic")||r.addLayer({id:"cat-traffic",type:"line",source:"cat-traffic",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":qy,"line-width":3,"line-opacity":.95,"line-dasharray":[2,2]}}),r.getLayer("cat-toll-shadow")||r.addLayer({id:"cat-toll-shadow",type:"line",source:"cat-toll",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#000000","line-width":12,"line-opacity":.35,"line-blur":4}}),r.getLayer("cat-toll-left")||r.addLayer({id:"cat-toll-left",type:"line",source:"cat-toll",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":X0,"line-width":4,"line-opacity":.95,"line-offset":7}}),r.getLayer("cat-toll-right")||r.addLayer({id:"cat-toll-right",type:"line",source:"cat-toll",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":X0,"line-width":4,"line-opacity":.95,"line-offset":-7}}),r.getLayer("cat-toll-label-bg")||r.addLayer({id:"cat-toll-label-bg",type:"circle",source:"cat-toll-labels",paint:{"circle-radius":7,"circle-color":X0,"circle-opacity":.95,"circle-stroke-color":"#000000","circle-stroke-opacity":.85,"circle-stroke-width":1}}),r.getLayer("cat-toll-label-text")||r.addLayer({id:"cat-toll-label-text",type:"symbol",source:"cat-toll-labels",layout:{"text-field":KD,"text-font":l,"text-size":14,"text-allow-overlap":!0,"text-ignore-placement":!0,"text-offset":["case",["==",["get","side"],"left"],["literal",[-1.1,0]],["literal",[1.1,0]]]},paint:{"text-color":"#0b1220","text-halo-color":"#ffffff","text-halo-width":.8}}),r.getLayer("start-circle")||r.addLayer({id:"start-circle",type:"circle",source:"start-end",filter:["==",["get","kind"],"start"],paint:{"circle-radius":11,"circle-color":"#ffffff","circle-stroke-width":4,"circle-stroke-color":"#0b1220","circle-opacity":1}}),r.getLayer("end-pin")||r.addLayer({id:"end-pin",type:"symbol",source:"start-end",filter:["==",["get","kind"],"end"],layout:{"icon-image":"end-pin","icon-size":1.55,"icon-anchor":"bottom","icon-allow-overlap":!0,"icon-ignore-placement":!0}});const p=(s,C,M)=>{r.getLayer(s)||r.addLayer({id:s,type:"symbol",source:"start-end",filter:C,layout:{"icon-image":"label-bg","icon-size":1,"icon-anchor":"center","icon-offset":M,"icon-allow-overlap":!0,"icon-ignore-placement":!0}})};p("start-label-bg",["==",["get","kind"],"start"],[0,-36]),p("end-label-bg",["==",["get","kind"],"end"],[0,-44]);const b=(s,C,M)=>{r.getLayer(s)||r.addLayer({id:s,type:"symbol",source:"start-end",filter:C,layout:{"symbol-placement":"point","text-field":["to-string",["get","label"]],"text-font":l,"text-size":16,"text-anchor":"center","text-offset":M,"text-allow-overlap":!0,"text-ignore-placement":!0,"text-optional":!0},paint:{"text-color":"#0b1220","text-halo-color":"#ffffff","text-halo-width":1.5,"text-opacity":1}})};b("start-label",["==",["get","kind"],"start"],[0,-2.1]),b("end-label",["==",["get","kind"],"end"],[0,-2.6]),r.getLayer("triple-badge-lines")||r.addLayer({id:"triple-badge-lines",type:"line",source:"triple-badge-lines",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#0b1220","line-width":2,"line-opacity":.35}}),r.getLayer("triple-badges")||r.addLayer({id:"triple-badges",type:"symbol",source:"triple-badge-points",layout:{"icon-image":"route-badge","icon-size":1,"icon-anchor":"center","icon-allow-overlap":!0,"icon-ignore-placement":!0}}),r.getLayer("triple-badge-text")||r.addLayer({id:"triple-badge-text",type:"symbol",source:"triple-badge-points",layout:{"text-field":["to-string",["get","label"]],"text-font":["Arial"],"text-size":14,"text-anchor":"center","text-max-width":999,"text-justify":"center","text-allow-overlap":!0,"text-ignore-placement":!0,"text-optional":!0,"text-offset":[0,-.05]},paint:{"text-color":"#0b1220","text-halo-color":"#ffffff","text-halo-width":1.2,"text-opacity":1}}),r.getLayer("triple-seg-ticks")||r.addLayer({id:"triple-seg-ticks",type:"line",source:"triple-seg-ticks",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#0b1220","line-width":6,"line-opacity":.7}}),r.getLayer("triple-seg-circles")||r.addLayer({id:"triple-seg-circles",type:"circle",source:"triple-seg-points",paint:{"circle-radius":10,"circle-color":Nh,"circle-opacity":.95,"circle-stroke-width":2,"circle-stroke-color":"#ffffff"}}),r.getLayer("triple-seg-text")||r.addLayer({id:"triple-seg-text",type:"symbol",source:"triple-seg-points",layout:{"text-field":["to-string",["get","label"]],"text-font":l,"text-size":14,"text-anchor":"center","text-allow-overlap":!0,"text-ignore-placement":!0,"text-optional":!0},paint:{"text-color":"#ffffff","text-halo-color":"rgba(0,0,0,0.25)","text-halo-width":1,"text-opacity":1}}),r.getLayer("edit-junction-circles")||r.addLayer({id:"edit-junction-circles",type:"circle",source:"edit-junctions",paint:{"circle-radius":8,"circle-color":["case",["==",["get","disabled"],!0],"rgba(255,255,255,0.25)","rgba(32,99,244,0.95)"],"circle-stroke-width":2,"circle-stroke-color":"#ffffff","circle-opacity":.95}}),r.getLayer("edit-junction-text")||r.addLayer({id:"edit-junction-text",type:"symbol",source:"edit-junctions",layout:{"text-field":["to-string",["get","label"]],"text-font":l,"text-size":11,"text-anchor":"center","text-allow-overlap":!0,"text-ignore-placement":!0,"text-optional":!0},paint:{"text-color":"#0b1220","text-halo-color":"#ffffff","text-halo-width":1,"text-opacity":1}});const _=s=>{try{r.moveLayer(s)}catch{}};_("triple-badge-lines"),_("triple-badges"),_("triple-badge-text"),_("triple-seg-ticks"),_("triple-seg-circles"),_("triple-seg-text"),_("edit-junction-circles"),_("edit-junction-text"),_("start-label-bg"),_("end-label-bg"),_("start-label"),_("end-label"),_("start-circle"),_("end-pin")}function ux(r){return r.length?r[Math.floor(r.length/2)]??r[0]:[0,0]}function fg(r,u,l=.06){const f=u.getWest(),p=u.getEast(),b=u.getSouth(),_=u.getNorth(),s=(p-f)*l,C=(_-b)*l,M=Math.min(p-s,Math.max(f+s,r[0])),D=Math.min(_-C,Math.max(b+C,r[1]));return[M,D]}function ky(r,u){const l=r[0]-u[0],f=r[1]-u[1];return Math.sqrt(l*l+f*f)}const uR=["A","B","C"];function hR(r){return r==="A"?" ":r==="B"?" ":" "}function yb(r){return In(r.map(u=>u.coord),r.map(u=>({id:u.id,label:u.label?u.label:hR(u.id)})))}function Cy(r,u,l){const f=new Map(l.map(p=>[p.id,p.coord]));return di(u.map(p=>{const b=f.get(p.id),_=cR(r,b,p.coord);return{coords:[p.coord,_],props:{id:p.id}}}))}function fR(r){if(!r||r.length<3)return[];const u=au(r),l=u[u.length-1]||1,f=Rw(r),p=20,_=l*.1,s=[];for(let D=1;D<r.length-1;D++){const B=f[D]||0;B>=p&&s.push({i:D,a:B})}s.sort((D,B)=>B.a-D.a);const C=[];for(const D of s){if(C.length>=14)break;const B=u[D.i];C.some(j=>Math.abs(u[j]-B)<_)||C.push(D.i)}const M=D=>{const B=l*D;let U=1,j=1/0;for(let H=1;H<r.length-1;H++){const O=Math.abs(u[H]-B);O<j&&(j=O,U=H)}C.includes(U)||C.push(U)};return C.length<5&&(M(.25),M(.5),M(.75)),C.sort((D,B)=>u[D]-u[B]),C.map((D,B)=>({id:`J${B+1}_${D}`,coord:r[D],idx:B+1,dist:u[D],angle:f[D]||0}))}function dR(r,u){const l=new Set,f=[];for(const p of r){const b=u(p);l.has(b)||(l.add(b),f.push(p))}return f}function pR(r,u=10){if(r.length<=u)return r;const l=_d(r);if(!Number.isFinite(l)||l<=0)return[r[0],r[r.length-1]];const f=200,p=au(r),b=[r[0]];let _=f;for(let s=1;s<r.length-1&&(p[s]>=_&&(b.push(r[s]),_+=f),!(b.length>=u-1));s++);return b.push(r[r.length-1]),dR(b,s=>`${s[0].toFixed(6)},${s[1].toFixed(6)}`)}function My(r,u,l){const f=u.map(b=>b.coord),p=u.map(b=>({jid:b.id,label:b.idx,disabled:l.has(b.id)}));cr(r,"edit-junctions",In(f,p))}async function mR(r,u,l){if(!r||r.length<2)return r;const f=u.filter(C=>!l.has(C.id)),p=[r[0],...f.map(C=>C.coord),r[r.length-1]],b=pR(p,10),_=await vg(b);return _&&_.length>=2?_:b}function j0(r,u){const l=["A","B","C"],f=p=>p==="A"?"triple-a":p==="B"?"triple-b":"triple-c";for(const p of l){const b=f(p),_=`${b}-outline`,s=p===u;try{r.setPaintProperty(b,"line-color",s?Nh:J0),r.setPaintProperty(b,"line-opacity",s?C1:Ux),r.setPaintProperty(b,"line-width",s?db:7)}catch{}try{r.setPaintProperty(_,"line-opacity",s?YD:kw),r.setPaintProperty(_,"line-width",s?db+2:9)}catch{}}}function dg(r,u){const l=r.getLayer("cat-traffic")?"cat-traffic":r.getLayer("triple-badge-lines")?"triple-badge-lines":void 0,f=b=>b==="A"?"triple-a":b==="B"?"triple-b":"triple-c",p=["A","B","C"].filter(b=>b!==u).concat([u]);for(const b of p){const _=f(b),s=`${_}-outline`;try{l?r.moveLayer(s,l):r.moveLayer(s)}catch{}try{l?r.moveLayer(_,l):r.moveLayer(_)}catch{}}}function hx(r,u){try{r.setLayoutProperty("triple-badges","icon-image",["case",["==",["get","id"],u],"route-badge-selected","route-badge"])}catch{}try{r.setPaintProperty("triple-badge-text","text-color",["case",["==",["get","id"],u],"#ffffff","#0b1220"])}catch{}}function Qu(r){return Math.max(0,Math.min(1,r))}function gR(r,u,l){const f=(r[1]+u[1]+l[1])/3,p=sm(f),b=im(),_=0,s=0,C=(l[0]-u[0])*p,M=(l[1]-u[1])*b,D=(r[0]-u[0])*p,B=(r[1]-u[1])*b,U=C*C+M*M;if(U<=1e-9)return Math.hypot(D-_,B-s);const j=Math.max(0,Math.min(1,(D*C+B*M)/U)),H=j*C,O=j*M;return Math.hypot(D-H,B-O)}function Iw(r,u){if(u.length<2)return 1/0;let l=1/0;for(let f=0;f<u.length-1;f++){const p=gR(r,u[f],u[f+1]);if(p<l&&(l=p),l<=.5)return l}return l}function _R(r,u){let l=!1;const f=r[0],p=r[1];for(let b=0,_=u.length-1;b<u.length;_=b++){const s=u[b][0],C=u[b][1],M=u[_][0],D=u[_][1];C>p!=D>p&&f<(M-s)*(p-C)/(D-C+1e-12)+s&&(l=!l)}return l}function xR(r){return r.length<2||r[0][0]===r[r.length-1][0]&&r[0][1]===r[r.length-1][1]?r:[...r,r[0]]}function yR(r,u,l){for(const f of u){const p=f.ring;if(p.length<3)continue;if(_R(r,p))return!0;const b=xR(p);if(Iw(r,b)<=l)return!0}return!1}function bd(r,u){return{x:r[0]*sm(u),y:r[1]*im()}}function Pw(r,u,l,f){const p=(D,B,U)=>(B.x-D.x)*(U.y-D.y)-(B.y-D.y)*(U.x-D.x),b=(D,B,U)=>Math.min(D.x,U.x)-1e-9<=B.x&&B.x<=Math.max(D.x,U.x)+1e-9&&Math.min(D.y,U.y)-1e-9<=B.y&&B.y<=Math.max(D.y,U.y)+1e-9,_=p(r,u,l),s=p(r,u,f),C=p(l,f,r),M=p(l,f,u);return _===0&&b(r,l,u)||s===0&&b(r,f,u)||C===0&&b(l,r,f)||M===0&&b(l,u,f)?!0:_>0!=s>0&&C>0!=M>0}function vR(r,u){if(r.length<2)return!1;const l=(r[0][1]+u[1])/2,f=bd(r[r.length-1],l),p=bd(u,l);for(let b=0;b<r.length-2;b++){const _=bd(r[b],l),s=bd(r[b+1],l);if(Pw(f,p,_,s))return!0}return!1}function bR(r){if(r.length<3)return!0;const u=r.reduce((p,b)=>p+b[1],0)/r.length,l=bd(r[r.length-1],u),f=bd(r[0],u);for(let p=1;p<r.length-2;p++){const b=bd(r[p],u),_=bd(r[p+1],u);if(Pw(l,f,b,_))return!0}return!1}function wR(r){if(!r.length)return[0,0];let u=0,l=0;for(const f of r)u+=f[0],l+=f[1];return[u/r.length,l/r.length]}function vb(r,u,l){for(const f of u)if(Iw(r,f)<=l)return!0;return!1}function TR(r){if(!r.length)return[0,0];let u=0,l=0;for(const f of r)u+=f[0],l+=f[1];return[u/r.length,l/r.length]}function SR(r,u){for(const l of u){const f=TR(l.ring);if(Q0(r,f)<=l.radiusM)return!0}return!1}function bb(r){return(r.getStyle()?.layers??[]).filter(l=>l?.type==="fill"&&Cw(l)).map(l=>l.id)}function ER(r){const{i1:u,i2:l}=xx(r),f=r.slice(0,u+1),p=r.slice(u,l+1),b=r.slice(l);return[f,p,b]}function U0(r,u,l,f,p,b){const _=["A","B","C"],s=l.map(re=>re.coords),C=f.map(re=>re.coords),M=30,D=10,B=M*1e3/3600,U=D*1e3/3600,j=60;function H(re,Ce,xe){let Ge=_x(xe,j);if(Ge.length<2){const Vt=xe[0],Bt=xe[xe.length-1];Ge=Vt&&Bt?[Vt,Bt]:[]}let $e=0,de=0,nt=0,le=0,ct=0;for(let Vt=0;Vt<Ge.length-1;Vt++){const Bt=Ge[Vt],Yt=Ge[Vt+1],Or=[(Bt[0]+Yt[0])/2,(Bt[1]+Yt[1])/2],Ye=Q0(Bt,Yt);$e+=Ye;const pn=vb(Or,s,12),se=vb(Or,C,12),Mt=SR(Or,p),yt=yR(Or,b,20);pn&&(de+=Ye),se&&(nt+=Ye),Mt&&(le+=Ye),yt&&(ct+=Ye)}const et=$e>0?$e:_d(xe),He=$e>0?Qu(de/$e):0,$t=$e>0?Qu(nt/$e):0,Oe=$e>0?Qu(le/$e):0,It=$e>0?Qu(ct/$e):0,me=et*He,ne=Math.max(0,et-me),Ue=me/U+ne/B,Fe=100-70*He,Re=100*(1-$t),bt=100*It,Gt=30+70*Oe;return{route:re,segment:Ce,lengthM:et,timeS:Ue,speedScore:Fe,economyScore:Re,scenicScore:bt,commScore:Gt,fracTraffic:He,fracToll:$t,fracScenic:It,fracComm:Oe}}const O=_.map(re=>{const Ce=u[re]??[];if(Ce.length<2)return{route:re,segments:[],totalLengthM:0,totalTimeS:0};const[xe,Ge,$e]=ER(Ce),de=[H(re,1,xe),H(re,2,Ge),H(re,3,$e)],nt=de.reduce((ct,et)=>ct+et.lengthM,0),le=de.reduce((ct,et)=>ct+et.timeS,0);return{route:re,segments:de,totalLengthM:nt,totalTimeS:le}}),N=85,Z=40,J=re=>re.segments.length?re.segments.reduce((Ce,xe)=>Ce+xe.scenicScore,0)/re.segments.length:0,X=Math.max(...O.map(re=>J(re)));if(X>0&&X<Z){const re=N/X;O.forEach(Ce=>{Ce.segments.forEach(xe=>{xe.scenicScore=Math.min(100,xe.scenicScore*re)})})}const pe=95,ge=70;O.forEach(re=>{re.segments.forEach(Ce=>{Ce.fracComm&&Ce.fracComm>.9&&(Ce.commScore=100)})});let ve=0;if(O.forEach(re=>{re.segments.forEach(Ce=>{Ce.commScore>ve&&(ve=Ce.commScore)})}),ve>0&&ve<ge){const re=pe/ve;O.forEach(Ce=>{Ce.segments.forEach(xe=>{xe.commScore&&(xe.commScore=Math.min(100,xe.commScore*re))})})}return O}function Fw(r){return r==="A"?"":r==="B"?"":""}function Wy(r){const u=Math.max(0,Math.round(r)),l=Math.floor(u/60),f=u%60;return`${l}:${String(f).padStart(2,"0")}`}const md=[{key:"speedScore",label:"",color:"#3B82F6"},{key:"economyScore",label:"",color:"#F59E0B"},{key:"scenicScore",label:"",color:"#A855F7"},{key:"commScore",label:"",color:"#22C55E"}];function wb(r){const u=Px(r);return u&&(.2126*u.r+.7152*u.g+.0722*u.b)/255<.55?"white":"#0b0f17"}function AR(r,u,l){const f=Qu(l),p=Math.round(r.r+(u.r-r.r)*f),b=Math.round(r.g+(u.g-r.g)*f),_=Math.round(r.b+(u.b-r.b)*f);return`rgb(${p},${b},${_})`}function $y({n:r}){return Y.jsx("span",{style:{width:22,height:22,borderRadius:999,background:Nh,color:"white",display:"inline-flex",alignItems:"center",justifyContent:"center",fontWeight:950,fontSize:12,boxShadow:"0 1px 6px rgba(0,0,0,0.25)",border:"1px solid rgba(255,255,255,0.25)"},children:r})}function kR({n:r}){return Y.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:7,justifyContent:"center"},children:[Y.jsx("span",{style:{fontWeight:900,opacity:.9},children:""}),Y.jsx($y,{n:r})]})}function Dy(r){const{routeScores:u,selectedRoute:l,onSelectRoute:f,title:p}=r,b=ke.useMemo(()=>{const _=new Map;for(const s of u)_.set(s.route,s);return _},[u]);return Y.jsxs("div",{style:{border:"1px solid rgba(255,255,255,0.10)",borderRadius:14,padding:12,background:"rgba(255,255,255,0.04)",height:"fit-content"},children:[Y.jsx("div",{style:{fontWeight:950,marginBottom:10,opacity:.9},children:p??" "}),Y.jsx("div",{style:{display:"flex",flexDirection:"column",gap:10},children:["A","B","C"].map(_=>{const s=b.get(_),C=_===l;return Y.jsxs("div",{onClick:()=>f(_),style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:10,cursor:"pointer",padding:"8px 10px",borderRadius:14,border:C?`3px solid ${Nh}`:"1px solid rgba(255,255,255,0.12)",background:C?"rgba(30,78,216,0.12)":"rgba(0,0,0,0.0)"},title:"   ",children:[Y.jsxs("div",{style:{fontWeight:950},children:[" ",Fw(_)]}),Y.jsx("div",{style:{opacity:.85,fontWeight:900,fontSize:12},children:s?Wy(s.totalTimeS):"--:--"})]},_)})})]})}function CR(r){const{open:u,onClose:l,routeScores:f,selectedRoute:p,onSelectRoute:b}=r,[_,s]=ke.useState("times"),C=ke.useMemo(()=>{const Z=new Map;for(const J of f)Z.set(J.route,J);return Z},[f]),M=C.get(p)??f[0];if(ke.useEffect(()=>{u||s("times")},[u]),!u)return null;const D=Z=>Y.jsxs("div",{style:{border:"1px solid rgba(255,255,255,0.10)",borderRadius:16,padding:14,background:"rgba(255,255,255,0.04)"},children:[Y.jsx("div",{style:{fontWeight:950,fontSize:15,textAlign:"right"},children:Z.title}),Z.subtitle?Y.jsx("div",{style:{marginTop:6,fontSize:12,opacity:.82,textAlign:"right"},children:Z.subtitle}):null,Y.jsx("div",{style:{marginTop:12},children:Z.children})]}),B=Z=>Y.jsx("button",{onClick:Z.onClick,title:Z.title,style:{border:Z.active?`2px solid ${Nh}`:"1px solid rgba(255,255,255,0.12)",borderRadius:999,padding:"8px 12px",background:Z.active?"rgba(140,203,255,0.18)":"rgba(255,255,255,0.06)",color:"#e8eefc",cursor:"pointer",fontWeight:900,fontSize:13,lineHeight:1},children:Z.children}),U=()=>Y.jsx("div",{style:{padding:12,opacity:.85,lineHeight:1.5},children:"   .    ."}),j=()=>{if(!f.length)return Y.jsx(U,{});const Z=Math.max(1,...f.map(ve=>ve.totalTimeS||0)),J=Math.max(1,Math.ceil(Z/60)),pe=[1,2,3,5,10,15,20,30,60].find(ve=>Math.ceil(J/ve)<=6)??1,ge=Array.from({length:Math.floor(J/pe)+1},(ve,re)=>re*pe);return ge[ge.length-1]!==J&&ge.push(J),Y.jsxs(D,{title:" ",subtitle:"    .      .",children:[Y.jsx("div",{style:{display:"flex",flexDirection:"column",gap:10},children:["A","B","C"].map(ve=>{const re=C.get(ve);if(!re)return null;const Ce=ve===p,xe=20;let Ge=0;return Y.jsxs("div",{onClick:()=>b(ve),style:{display:"grid",gridTemplateColumns:"84px 1fr 72px",gap:10,alignItems:"center",cursor:"pointer",padding:"8px 10px",borderRadius:14,border:Ce?`3px solid ${Nh}`:"1px solid rgba(255,255,255,0.10)",background:Ce?"rgba(30,78,216,0.10)":"transparent"},title:"   ",children:[Y.jsxs("div",{style:{fontWeight:950,fontSize:14,textAlign:"right"},children:[" ",Fw(ve)]}),Y.jsx("div",{style:{position:"relative",height:xe,borderRadius:10,overflow:"hidden",border:"1px solid rgba(255,255,255,0.14)",background:"rgba(0,0,0,0.10)"},children:re.segments.map($e=>{const de=Qu($e.timeS/Z)*100,nt=Qu(Ge/Z)*100;Ge+=$e.timeS;const le=de>=4;return Y.jsx("div",{style:{position:"absolute",right:`${nt}%`,width:`${de}%`,top:0,bottom:0,background:Ce?Nh:J0,opacity:Ce?C1:Math.min(.75,Ux+.18),display:"flex",alignItems:"center",justifyContent:"center",fontWeight:950,color:"white",fontSize:13,textShadow:"0 1px 2px rgba(0,0,0,0.40)",borderLeft:"3px solid rgba(255,255,255,0.70)",boxSizing:"border-box"},title:` ${$e.segment}: ${Wy($e.timeS)}`,children:le?String($e.segment):""},$e.segment)})}),Y.jsx("div",{style:{textAlign:"left",fontWeight:900,fontSize:13},children:Wy(re.totalTimeS)})]},ve)})}),Y.jsx("div",{style:{marginTop:12},children:Y.jsxs("div",{style:{display:"grid",gridTemplateColumns:"84px 1fr 72px",gap:10,alignItems:"center"},children:[Y.jsx("div",{}),Y.jsxs("div",{style:{position:"relative",height:26},children:[Y.jsx("div",{style:{position:"absolute",insetInlineStart:0,insetInlineEnd:0,top:12,height:2,background:"rgba(255,255,255,0.20)"}}),ge.map(ve=>{const re=ve*60,Ce=Qu(re/Z)*100;return Y.jsxs("div",{style:{position:"absolute",right:`${Ce}%`,top:0,transform:"translateX(50%)",textAlign:"center",whiteSpace:"nowrap"},children:[Y.jsx("div",{style:{width:2,height:10,background:"rgba(255,255,255,0.28)",margin:"0 auto"}}),Y.jsx("div",{style:{fontSize:11,opacity:.88,marginTop:4},children:ve})]},ve)})]}),Y.jsx("div",{})]})})]})},H=()=>{const Z=M?.segments??[];if(!Z.length)return Y.jsx(U,{});const J=240,X=md.length*100;return Y.jsx(D,{title:" ",subtitle:"   ( ,   100%).",children:Y.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 220px",gap:14,alignItems:"start"},children:[Y.jsx("div",{style:{overflowX:"auto"},children:Y.jsx("div",{style:{display:"flex",gap:14,alignItems:"flex-end",paddingBottom:6},children:Z.map(pe=>{let ge=0;return Y.jsxs("div",{style:{width:180,textAlign:"center"},children:[Y.jsx("div",{style:{height:J,position:"relative",border:"1px solid rgba(255,255,255,0.12)",borderRadius:0,overflow:"hidden",background:"rgba(0,0,0,0.10)"},children:md.map(ve=>{const re=Math.max(0,Math.min(100,Number(pe[ve.key]??0))),Ce=re/X*J,xe=ge;ge+=Ce;const Ge=Ce<24;return Y.jsx("div",{style:{position:"absolute",left:0,right:0,bottom:xe,height:Ce,background:ve.color,opacity:.95,borderTop:"1px solid rgba(255,255,255,0.2)",zIndex:Ge?10:1,overflow:"visible",boxSizing:"border-box"},title:`${ve.label}: ${Math.round(re)}`,children:Y.jsxs("div",{style:{position:"absolute",top:"50%",left:0,right:0,transform:"translateY(-50%)",display:"flex",alignItems:"center",justifyContent:"center",gap:6,whiteSpace:"nowrap",pointerEvents:"none",color:"#ffffff",textShadow:"0 1px 3px rgba(0,0,0,0.9), 0 0 2px rgba(0,0,0,0.8)",fontWeight:950,fontSize:12,padding:"0 4px"},children:[Y.jsx("span",{style:{opacity:1},children:ve.label}),Y.jsx("span",{children:Math.round(re)})]})},ve.key)})}),Y.jsx("div",{style:{marginTop:10,fontWeight:950},children:Y.jsx(kR,{n:pe.segment})})]},pe.segment)})})}),Y.jsx(Dy,{routeScores:f,selectedRoute:p,onSelectRoute:b})]})})},O=()=>{const J=(M?.segments??[]).slice(0,3);if(!J.length)return Y.jsx(U,{});const X=240,pe=X/2,ge=X/2,ve=86,re=(xe,Ge)=>{const $e=-Math.PI/2+xe*2*Math.PI/md.length;return{x:pe+Math.cos($e)*ve*Ge,y:ge+Math.sin($e)*ve*Ge}},Ce=xe=>md.map((Ge,$e)=>{const de=Qu(Number(xe[Ge.key]??0)/100),nt=re($e,de);return`${nt.x},${nt.y}`}).join(" ");return Y.jsx(D,{title:" ",subtitle:"3  ( 13).     .",children:Y.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 220px",gap:14,alignItems:"start"},children:[Y.jsx("div",{style:{display:"flex",gap:16,flexWrap:"wrap",justifyContent:"space-evenly"},children:J.map(xe=>Y.jsxs("div",{style:{width:300,border:"1px solid rgba(255,255,255,0.10)",borderRadius:16,padding:12,background:"rgba(0,0,0,0.06)"},children:[Y.jsx("div",{style:{fontWeight:950,marginBottom:8,textAlign:"right"},children:Y.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:8},children:[Y.jsx("span",{style:{fontWeight:950},children:""}),Y.jsx($y,{n:xe.segment})]})}),Y.jsxs("svg",{width:X,height:X,style:{display:"block",margin:"0 auto"},children:[[.25,.5,.75,1].map(Ge=>Y.jsx("circle",{cx:pe,cy:ge,r:ve*Ge,fill:"none",stroke:Ge===1?"rgba(255,255,255,0.30)":"rgba(255,255,255,0.14)",strokeWidth:Ge===1?1.6:1},Ge)),md.map((Ge,$e)=>{const de=re($e,1);return Y.jsx("line",{x1:pe,y1:ge,x2:de.x,y2:de.y,stroke:"rgba(255,255,255,0.20)"},Ge.key)}),Y.jsx("polygon",{points:Ce(xe),fill:Nh,fillOpacity:.2,stroke:Nh,strokeWidth:2}),md.map((Ge,$e)=>{const de=re($e,1.18),nt=Math.round(Number(xe[Ge.key]??0)),le=Ge.color,ct=wb(le);return Y.jsx("foreignObject",{x:de.x-55,y:de.y-13,width:110,height:26,children:Y.jsxs("div",{style:{width:"110px",height:"26px",display:"flex",alignItems:"center",justifyContent:"center",gap:6,background:le,color:ct,borderRadius:999,fontSize:11,fontWeight:950,boxShadow:"0 1px 6px rgba(0,0,0,0.25)",border:"1px solid rgba(255,255,255,0.20)",whiteSpace:"nowrap",paddingInline:8,boxSizing:"border-box"},children:[Y.jsx("span",{children:Ge.label}),Y.jsx("span",{style:{opacity:.95},children:nt})]})},Ge.key)})]})]},xe.segment))}),Y.jsx(Dy,{routeScores:f,selectedRoute:p,onSelectRoute:b})]})})},N=()=>{const Z=M?.segments??[];if(!Z.length)return Y.jsx(U,{});const J=Px(J0)??{r:140,g:203,b:255},X={r:255,g:255,b:255},pe=ve=>{const Ce=.12+.42*Qu((ve??0)/100);return AR(X,J,Ce)},ge=96;return Y.jsx(D,{title:" ",subtitle:"    .    (   ).",children:Y.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 220px",gap:14,alignItems:"start"},children:[Y.jsx("div",{style:{overflowX:"auto"},children:Y.jsxs("table",{style:{width:"max-content",borderCollapse:"separate",borderSpacing:6,direction:"rtl"},children:[Y.jsx("thead",{children:Y.jsxs("tr",{children:[Y.jsx("th",{style:{textAlign:"right",fontSize:12,opacity:.9,padding:2,width:78},children:""}),md.map(ve=>Y.jsx("th",{style:{textAlign:"center",fontSize:12,padding:2,width:ge},children:Y.jsx("div",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",gap:6,background:ve.color,color:wb(ve.color),borderRadius:999,padding:"4px 10px",fontWeight:950,border:"1px solid rgba(255,255,255,0.20)",boxShadow:"0 1px 6px rgba(0,0,0,0.18)",whiteSpace:"nowrap"},children:ve.label})},ve.key))]})}),Y.jsx("tbody",{children:Z.map(ve=>Y.jsxs("tr",{children:[Y.jsx("td",{style:{padding:2,textAlign:"right",width:78},children:Y.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8},children:[Y.jsx("span",{style:{fontWeight:900,opacity:.9},children:""}),Y.jsx($y,{n:ve.segment})]})}),md.map(re=>{const Ce=Math.round(Number(ve[re.key]??0));return Y.jsx("td",{style:{padding:2,width:ge},children:Y.jsx("div",{style:{background:pe(Ce),borderRadius:10,padding:"8px 6px",textAlign:"center",fontWeight:950,color:"rgba(8,10,14,0.92)",border:"1px solid rgba(0,0,0,0.10)"},title:`${re.label}: ${Ce}`,children:Ce})},re.key)})]},ve.segment))})]})}),Y.jsx(Dy,{routeScores:f,selectedRoute:p,onSelectRoute:b})]})})};return Y.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.60)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",padding:16},onClick:l,children:Y.jsxs("div",{style:{width:"min(1080px, 96vw)",maxHeight:"92vh",overflow:"auto",borderRadius:18,background:"#0b0f17",color:"#e8eefc",border:"1px solid rgba(255,255,255,0.10)",boxShadow:"0 24px 60px rgba(0,0,0,0.45)"},onClick:Z=>Z.stopPropagation(),children:[Y.jsxs("div",{style:{padding:14,display:"flex",justifyContent:"space-between",alignItems:"center",gap:10},children:[Y.jsx("div",{style:{fontWeight:950,fontSize:16},children:""}),Y.jsx("button",{onClick:l,style:{padding:"8px 12px",borderRadius:10,border:"1px solid rgba(255,255,255,0.14)",background:"rgba(255,255,255,0.06)",color:"white",cursor:"pointer",fontWeight:900},children:""})]}),Y.jsxs("div",{style:{padding:"10px 14px",borderBottom:"1px solid rgba(255,255,255,0.10)",display:"flex",gap:10,flexWrap:"wrap"},children:[Y.jsx(B,{active:_==="times",onClick:()=>s("times"),children:" "}),Y.jsx(B,{active:_==="bars",onClick:()=>s("bars"),children:" "}),Y.jsx(B,{active:_==="radar",onClick:()=>s("radar"),children:" "}),Y.jsx(B,{active:_==="heatmap",onClick:()=>s("heatmap"),children:" "})]}),Y.jsxs("div",{style:{padding:14,overflow:"auto",display:"flex",flexDirection:"column",gap:14},children:[_==="times"&&Y.jsx(j,{}),_==="bars"&&Y.jsx(H,{}),_==="radar"&&Y.jsx(O,{}),_==="heatmap"&&Y.jsx(N,{})]})]})})}function Tb(r){return r*r}function Ry(r,u){return Tb(r[0]-u[0])+Tb(r[1]-u[1])}function MR(r,u,l){const f=Ry(u,l);if(f===0)return Ry(r,u);let p=((r[0]-u[0])*(l[0]-u[0])+(r[1]-u[1])*(l[1]-u[1]))/f;return p=Math.max(0,Math.min(1,p)),Ry(r,[u[0]+p*(l[0]-u[0]),u[1]+p*(l[1]-u[1])])}function DR(r,u,l){return Math.sqrt(MR(r,u,l))}function RR(r,u){let l=Number.MAX_VALUE;for(let f=0;f<u.length-1;f++){const p=DR(r,u[f],u[f+1]);p<l&&(l=p)}return l}function IR(){const r=ke.useRef(null),u=ke.useRef(null),[l,f]=ke.useState(null),[p,b]=ke.useState({STACKED:!0,RADAR:!0,HEATMAP:!0}),[_,s]=ke.useState(0),[C,M]=ke.useState(.5),[D,B]=ke.useState(2),[U,j]=ke.useState(!0),[H,O]=ke.useState("he"),N=ke.useRef({}),[Z,J]=ke.useState(!0),[X,pe]=ke.useState(!0),[ge,ve]=ke.useState(!0),[re,Ce]=ke.useState(!0),[xe,Ge]=ke.useState("vector"),[$e,de]=ke.useState("TRIPLE"),nt=ke.useRef("TRIPLE");ke.useEffect(()=>{nt.current=$e},[$e]);const[le,ct]=ke.useState(!1),et=ke.useRef(!1);ke.useEffect(()=>{et.current=le},[le]),ke.useEffect(()=>{$e!=="TRIPLE"&&ct(!1)},[$e]);const[He,$t]=ke.useState(!1),[Oe,It]=ke.useState(!0),[me,ne]=ke.useState(!0),[Ue,Fe]=ke.useState(!0),[Re,bt]=ke.useState(.35),[Gt,Vt]=ke.useState(3),[Bt,Yt]=ke.useState(50),[Or,Ye]=ke.useState(600),[pn,se]=ke.useState(.35),[Mt,yt]=ke.useState(2),[Ee,Ne]=ke.useState(80),[pt,Jt]=ke.useState(700),[Kt,Et]=ke.useState(.35),[lr,pr]=ke.useState(2),[ir,st]=ke.useState(200),[fe,he]=ke.useState(600),[we,Ve]=ke.useState(.35),[Xe,xt]=ke.useState([]),[ot,it]=ke.useState([]),[vt,zt]=ke.useState([]),Wt=ke.useCallback(Q=>{const Qe=[];for(const ft of Q)_x(ft.coords,250).forEach((Nt,gr)=>Qe.push({coord:Nt,side:gr%2===0?"left":"right"}));return Qe},[]);ke.useEffect(()=>{const Q=u.current;if(!Q||!Q.isStyleLoaded())return;if(Q.getSource("satellite-source")||Q.addSource("satellite-source",{type:"raster",tiles:[XD],tileSize:512}),!Q.getLayer("satellite-layer")){const Ht=Q.getStyle().layers||[];let Nt;for(const gr of Ht)if(gr.type!=="background"){Nt=gr.id;break}Q.addLayer({id:"satellite-layer",type:"raster",source:"satellite-source",paint:{"raster-opacity":0}},Nt)}const Qe=xe==="satellite";Q.setPaintProperty("satellite-layer","raster-opacity",Qe?1:0);const ft=Q.getStyle();ft&&ft.layers&&ft.layers.forEach(Ht=>{if(Ht.id==="satellite-layer"||Ht.id.startsWith("triple-")||Ht.id.startsWith("single-")||Ht.id.startsWith("measure-")||Ht.id.startsWith("manual-")||Ht.id.startsWith("cat-")||Ht.id.startsWith("start-")||Ht.id.startsWith("end-")||Ht.id.startsWith("edit-"))return;if((Ht.type==="background"||Ht.type==="fill"||Ht.type==="fill-extrusion"||Ht.type==="landcover")&&!Ht.id.includes("road")&&!Ht.id.includes("transit")){const gr=Qe?"none":"visible";Q.getLayoutProperty(Ht.id,"visibility")!==gr&&Q.setLayoutProperty(Ht.id,"visibility",gr)}})},[xe]),ke.useEffect(()=>{zt(Wt(ot))},[ot]);const[mr,kr]=ke.useState([]),Kr=ke.useRef(Xe),yn=ke.useRef(ot),hn=ke.useRef(mr);ke.useEffect(()=>{Kr.current=Xe},[Xe]),ke.useEffect(()=>{yn.current=ot},[ot]),ke.useEffect(()=>{hn.current=mr},[mr]),ke.useEffect(()=>{const Q=u.current;Q&&cr(Q,"cat-traffic",di(Xe.map(Qe=>({coords:Qe.coords,props:{id:Qe.id}}))))},[Xe]),ke.useEffect(()=>{const Q=u.current;Q&&cr(Q,"cat-toll",di(ot.map(Qe=>({coords:Qe.coords,props:{id:Qe.id}}))))},[ot]),ke.useEffect(()=>{const Q=u.current;Q&&cr(Q,"cat-toll-labels",In(vt.map(Qe=>Qe.coord),vt.map(Qe=>({label:"",side:Qe.side}))))},[vt]),ke.useEffect(()=>{const Q=u.current;Q&&cr(Q,"cat-comm",B0(mr.map(Qe=>({coords:Qe.ring,props:{id:Qe.id,radiusM:Qe.radiusM}}))))},[mr]);const[ht,En]=ke.useState([]),[Kn,Qr]=ke.useState(!1),[Ln,Ba]=ke.useState(null),zn=ke.useRef(null),tn=ke.useCallback(Q=>{Ba(Q),zn.current&&window.clearTimeout(zn.current),zn.current=window.setTimeout(()=>Ba(null),2200)},[]),Bn=["","","",""],ba=[" "," 1"," 2"," 3"],El=["High","Medium","Low"],Zo=["Elimination","Weighted","Lexicographic"],[Qt,ye]=ke.useState(""),[je,Le]=ke.useState(" "),[Me,Te]=ke.useState("None"),[Pe,gt]=ke.useState(!1),[jt,Dt]=ke.useState(""),[At,_t]=ke.useState(3),[or,yr]=ke.useState("Medium"),[vr,fr]=ke.useState("Elimination"),[_r,Ur]=ke.useState(3),[Tn,vn]=ke.useState(2),[Zr,Mi]=ke.useState(1),Fs=ke.useCallback(()=>{if(!ht||ht.length===0){alert("  . /   ' '   .");return}const Q=";",Qe=xr=>{const Sr=xr==null?"":String(xr),nn=Sr.includes('"')||Sr.includes(`
`)||Sr.includes("\r")||Sr.includes(Q),qr=Sr.replace(/"/g,'""');return nn?`"${qr}"`:qr},ft=(xr,Sr=2)=>{const nn=typeof xr=="number"&&Number.isFinite(xr)?xr:NaN;return Number.isFinite(nn)?Sr===0?String(Math.round(nn)):nn.toFixed(Sr):""},Ht=xr=>{const Sr=xr.reduce((qr,un)=>qr+(Number.isFinite(un.w)?un.w:0),0);return Sr<=0?0:xr.reduce((qr,un)=>qr+(Number.isFinite(un.w)?un.w:0)*(Number.isFinite(un.v)?un.v:0),0)/Sr},Nt=["","","_","_","_","_0_100","_0_100","_0_100","_0_100","_0_100","","_share","_share","_share","_share"],gr={A:1,B:2,C:3},Jr=[...ht].sort((xr,Sr)=>(gr[xr.route]??99)-(gr[Sr.route]??99)),mn={1:{min:1/0,max:-1/0},2:{min:1/0,max:-1/0},3:{min:1/0,max:-1/0}};Jr.forEach(xr=>{xr.segments.forEach(Sr=>{const nn=Sr.segment,qr=Number(Sr.timeS??0);Number.isFinite(qr)&&(mn[nn].min=Math.min(mn[nn].min,qr),mn[nn].max=Math.max(mn[nn].max,qr))})});const Vr=(xr,Sr)=>{const nn=mn[xr].min,qr=mn[xr].max;if(!Number.isFinite(nn)||!Number.isFinite(qr)||qr<=nn+1e-6)return 100;const un=(qr-Sr)/(qr-nn);return Math.max(0,Math.min(100,un*100))},Hr=(xr,Sr)=>{switch(Sr){case"":return Number(xr.speedScore??0);case"":return Number(xr.economyScore??0);case"":return Number(xr.scenicScore??0);case"":return Number(xr.commScore??0);default:return 0}},Pr=vr==="Weighted"?`${Qt}${_r}${Me!=="None"?` + ${Me}${Tn}`:""} + ${Zr}`:"",Wr=xr=>{const Sr=Vr(xr.segment,Number(xr.timeS??0));if(vr!=="Weighted"){const Wn=Number(xr.speedScore??0),Gr=Number(xr.economyScore??0),gn=Number(xr.scenicScore??0),fa=Number(xr.commScore??0);return Math.round((Wn+Gr+gn+fa)/4)}const nn=Hr(xr,Qt),qr=Me==="None"?0:Hr(xr,Me),un=Number(_r??0),Er=Me==="None"?0:Number(Tn??0),Br=Number(Zr??0),Nr=Math.max(1e-6,un+Er+Br);return Math.round((un*nn+Er*qr+Br*Sr)/Nr)},dr=[];dr.push(Nt.map(Qe).join(Q)),Jr.forEach(xr=>{const Sr=xr.segments;Sr.forEach(Gr=>{const gn=` ${Gr.segment}`;dr.push([xr.route,gn,ft(Gr.lengthM,0),ft(Gr.timeS,0),ft(Gr.timeS/60,2),ft(Gr.speedScore,2),ft(Gr.economyScore,2),ft(Gr.scenicScore,2),ft(Gr.commScore,2),ft(Wr(Gr),0),Pr,ft(Gr.fracTraffic,3),ft(Gr.fracToll,3),ft(Gr.fracScenic,3),ft(Gr.fracComm,3)].map(Qe).join(Q))});const nn=Sr.reduce((Gr,gn)=>Gr+(typeof gn.lengthM=="number"?gn.lengthM:0),0),qr=Sr.reduce((Gr,gn)=>Gr+(typeof gn.timeS=="number"?gn.timeS:0),0),un=Ht(Sr.map(Gr=>({w:Number(Gr.lengthM)||0,v:Number(Gr.speedScore)||0}))),Er=Ht(Sr.map(Gr=>({w:Number(Gr.lengthM)||0,v:Number(Gr.economyScore)||0}))),Br=Ht(Sr.map(Gr=>({w:Number(Gr.lengthM)||0,v:Number(Gr.scenicScore)||0}))),Nr=Ht(Sr.map(Gr=>({w:Number(Gr.lengthM)||0,v:Number(Gr.commScore)||0}))),Wn=Ht(Sr.map(Gr=>({w:Number(Gr.lengthM)||0,v:Number(Wr(Gr))||0})));dr.push([xr.route,'"',ft(nn,0),ft(qr,0),ft(qr/60,2),ft(un,2),ft(Er,2),ft(Br,2),ft(Nr,2),ft(Wn,0),Pr,"","","",""].map(Qe).join(Q))});const Tr="\uFEFF"+dr.join(`
`),Dr=new Blob([Tr],{type:"text/csv;charset=utf-8;"}),zr=URL.createObjectURL(Dr),Fr=document.createElement("a");Fr.href=zr;const sn=new Date().toISOString().slice(0,19).replace(/[:T]/g,"-");Fr.download=`geovis_results_${sn}.csv`,document.body.appendChild(Fr),Fr.click(),Fr.remove(),URL.revokeObjectURL(zr)},[ht]),[pi,bi]=ke.useState(.8),[oi,Di]=ke.useState(""),[wi,bs]=ke.useState("Auto"),[bn,lu]=ke.useState(null),[kc,Wo]=ke.useState("");ke.useRef("");const cu="GeoVisLab_DebugLog.json",[uu,Cc]=ke.useState(!1),[Na,Mc]=ke.useState(()=>`Scenario_${new Date().toISOString().slice(0,10)}_${Date.now()}`),[Wl,hu]=ke.useState("     .         ."),[mo,Df]=ke.useState(""),[$o,go]=ke.useState("A"),[Rf,Xo]=ke.useState("downloads"),[fu,Yo]=ke.useState(null),[Al,Ko]=ke.useState("Downloads"),[ln,_o]=ke.useState(""),[nh,Dc]=ke.useState(!1),[Ma,qa]=ke.useState(!0),[Hn,en]=ke.useState(!0),[Jn,os]=ke.useState(!1),[Da,Ri]=ke.useState(!1),[$n,ei]=ke.useState([]),mi=ke.useRef([]);ke.useEffect(()=>{mi.current=$n},[$n]);const kn=ke.useRef({}),kl=ke.useRef(1),[Ea,Ii]=ke.useState(!1),[ja,Ra]=ke.useState(!1),Pi=ke.useRef(!1);ke.useEffect(()=>{Pi.current=ja},[ja]);const[Rc,Ki]=ke.useState(null),xo=ke.useRef(null);ke.useEffect(()=>{xo.current=Rc},[Rc]);const[qn,Ji]=ke.useState([]),_n=ke.useRef([]);ke.useEffect(()=>{_n.current=qn},[qn]);const[cn,ls]=ke.useState(null),Cn=ke.useRef(null);ke.useEffect(()=>{Cn.current=cn},[cn]);const[Cl,Ti]=ke.useState(null),Jo=ke.useRef(null);ke.useEffect(()=>{Jo.current=Cl},[Cl]);const cs=ke.useRef(!1);ke.useEffect(()=>{cs.current=Ea},[Ea]);const[Ic,Ls]=ke.useState([]),du=ke.useRef([]);ke.useEffect(()=>{du.current=Ic},[Ic]);const Qo=ke.useRef(null);ke.useEffect(()=>{if(Dl(),!u.current)return;const Qe=new Set($n.map(ft=>ft.id));for(const ft of Object.keys(kn.current))if(!Qe.has(ft)){try{kn.current[ft].remove()}catch{}delete kn.current[ft]}for(const ft of $n)kn.current[ft.id]||nl(ft);Es()},[$n,Dl,nl,Es]),ke.useEffect(()=>{To()},[Ic,To]),ke.useEffect(()=>{const Q=u.current;if(!Q)return;const Qe=Hn?"visible":"none";for(const ft of["manual-parks-fill","manual-parks-outline","manual-park-draft-line-layer","manual-park-draft-points-layer","manual-park-preview-line-layer"])if(Q.getLayer(ft))try{Q.setLayoutProperty(ft,"visibility",Qe)}catch{}Es()},[Hn,Es]),ke.useEffect(()=>{const Q=u.current;if(!Q)return;const Qe=Ma?"visible":"none";for(const ft of $l.current)if(Q.getLayer(ft))try{Q.setLayoutProperty(ft,"visibility",Qe)}catch{}},[Ma]),ke.useEffect(()=>{const Q=Qe=>{const ft=cs.current,Ht=xo.current;if(!(!ft&&!Ht)){if(Qe.key==="Escape"){Qe.preventDefault(),ft&&(Ls([]),Qo.current=null,Ii(!1)),Ht&&(Ji([]),ls(null),Ki(null)),Ti(null);return}(Qe.key==="Delete"||Qe.key==="Backspace")&&(Qe.preventDefault(),ft&&Ls(Nt=>Nt.slice(0,Math.max(0,Nt.length-1))),Ht&&(Ht==="comm"?ls(null):Ji(Nt=>Nt.slice(0,Math.max(0,Nt.length-1)))))}};return window.addEventListener("keydown",Q),()=>window.removeEventListener("keydown",Q)},[]),ke.useEffect(()=>{const Q=u.current;if(!Q)return;const Qe=ft=>{if(Ea)Q.getCanvas().style.cursor="crosshair";else if(ja)if(ft&&ft.point){const Ht=Q.queryRenderedFeatures(ft.point,{layers:$l.current});Q.getCanvas().style.cursor=Ht.length>0?"copy":"default"}else Q.getCanvas().style.cursor="default";else Q.getCanvas().style.cursor=""};return ja?Q.on("mousemove",Qe):(Qe(),Q.off("mousemove",Qe)),()=>{Q.off("mousemove",Qe)}},[Ea,ja]);const $l=ke.useRef([]),[ti,zs]=ke.useState([]),ya=ke.useMemo(()=>_d(ti),[ti]),[Fi,Xl]=ke.useState([]),[Yl,ua]=ke.useState([]),[If,Pc]=ke.useState(!1),Hh=ke.useMemo(()=>_d(Yl.length?Yl:Fi),[Yl,Fi]),[na,el]=ke.useState(null),[Zn,yo]=ke.useState(null),[Kl,Jl]=ke.useState(.35),[Js,Ml]=ke.useState(!1),[wa,Ql]=ke.useState(0),[ec,vo]=ke.useState([]),[tl,Fc]=ke.useState([]),rl=ke.useRef([]),ah=ke.useRef([]);ke.useEffect(()=>{rl.current=ec},[ec]),ke.useEffect(()=>{ah.current=tl},[tl]);const us=ke.useMemo(()=>!!na&&!!Zn,[na,Zn]),pu=ke.useMemo(()=>!(Z&&X&&ge&&re&&Ma&&Hn&&Oe&&me&&Ue),[Z,X,ge,re,Ma,Hn,Oe,me,Ue]),qh=ke.useRef(null),Zh=ke.useRef(null);ke.useEffect(()=>{qh.current=na,Zh.current=Zn},[na,Zn]);const[Ia,Qs]=ke.useState("A"),ha=ke.useRef({A:[],B:[],C:[]}),[Qi,tc]=ke.useState(!1),rc=ke.useRef(!1);ke.useEffect(()=>{rc.current=Qi},[Qi]);const Os=ke.useRef("A");ke.useEffect(()=>{Os.current=Ia},[Ia]);const ws=ke.useRef({A:[],B:[],C:[]}),[Lc,Ts]=ke.useState([]),mu=ke.useRef([]);ke.useEffect(()=>{mu.current=Lc},[Lc]);const[zc,bo]=ke.useState(new Set),Pf=ke.useRef(new Set);ke.useEffect(()=>{Pf.current=zc},[zc]);const[Oc,Bs]=ke.useState([]),ih=ke.useRef([]);ke.useEffect(()=>{ih.current=Oc},[Oc]);const[wo,Pa]=ke.useState(-1),eo=ke.useRef(-1);ke.useEffect(()=>{eo.current=wo},[wo]);const Ss=ke.useRef(()=>{}),gu=ke.useRef(()=>{}),sh=ke.useRef(()=>{}),oh=ke.useRef(()=>{}),_u=ke.useCallback(Q=>{const Qe=u.current;if(!Qe||!Qe.isStyleLoaded())return;try{bf(Qe)}catch{}const ft=ha.current.A,Ht=ha.current.B,Nt=ha.current.C,gr=sR([ft,Ht,Nt]);if(!gr)return;const Jr=oR(gr,.12),mn=iR(Qe,Jr),Vr=mn.length>0,Hr=Math.max(0,Math.min(1,Q??Re)),Pr=(Er,Br,Nr)=>Math.max(Br,Math.min(Nr,Math.round(Er))),Wr=(Er,Br,Nr)=>{const Wn=Math.max(0,Math.min(1,Br*Hr)),Gr=(yp()*2-1)*Er*Wn;return Pr(Er+Gr,0,Nr)},dr=()=>{const Er=xb(0,2);return Er===0?ft:Er===1?Ht:Nt},Tr=Vr?Math.max(0,Math.min(.92,.35+.5*Hr)):0,Dr=()=>Vr&&yp()<Tr?mn[xb(0,mn.length-1)]:dr(),zr=Wr(Gt,pn,8),Fr=[];for(let Er=0;Er<zr;Er++){const Br=Dr();if(Br.length<2)continue;const Nr=au(Br),Wn=Nr[Nr.length-1]||0;if(Wn<60)continue;const Gr=Math.max(0,Math.min(1,pn*Hr)),gn=Tc(Bt,Or),fa=Math.max(50,Math.min(2e3,gn*(1+(yp()*2-1)*.6*Gr))),Za=Tc(0,Math.max(0,Wn-fa)),js=cx(Br,Za,Za+fa);Fr.push({id:`traffic_${Er}_${Date.now()}`,coords:js})}const sn=Wr(Mt,Kt,6),xr=[],Sr=[];for(let Er=0;Er<sn;Er++){const Br=Dr();if(Br.length<2)continue;const Nr=au(Br),Wn=Nr[Nr.length-1]||0;if(Wn<60)continue;const Gr=Math.max(0,Math.min(1,Kt*Hr)),gn=Tc(Ee,pt),fa=Math.max(50,Math.min(2e3,gn*(1+(yp()*2-1)*.6*Gr))),Za=Tc(0,Math.max(0,Wn-fa)),js=cx(Br,Za,Za+fa);xr.push({id:`toll_${Er}_${Date.now()}`,coords:js});const fs=_x(js,250);for(const zi of fs)Sr.push({coord:zi,side:yp()<.5?"left":"right"})}const nn=Wr(lr,we,3),qr=[];for(let Er=0;Er<nn;Er++){const Br=Math.max(0,Math.min(1,we*Hr)),Nr=Tc(ir,fe),Gr=Math.max(100,Math.min(1e3,Nr*(1+(yp()*2-1)*.7*Br)))/2,gn=lR(Jr),fa=Ey(gn,Gr);qr.push({id:`comm_${Er}_${Date.now()}`,ring:fa,radiusM:Gr})}cr(Qe,"cat-traffic",di(Fr.map(Er=>({coords:Er.coords,props:{id:Er.id}})))),cr(Qe,"cat-toll",di(xr.map(Er=>({coords:Er.coords,props:{id:Er.id}})))),cr(Qe,"cat-toll-labels",In(Sr.map(Er=>Er.coord),Sr.map(Er=>({side:Er.side})))),cr(Qe,"cat-comm",B0(qr.map(Er=>({coords:Er.ring,props:{id:Er.id}}))));try{bf(Qe)}catch{}xt(Fr),it(xr),zt(Sr),kr(qr);const un=u.current;if(un){const Er=U0(un,ha.current,Fr,xr,qr,mi.current);En(Er),Qr(!1)}},[Re,Gt,Bt,Or,pn,Mt,Ee,pt,Kt,lr,ir,fe,we]),xu=Q=>{switch(Q){case" 1":return[0];case" 2":return[1];case" 3":return[2];default:return[0,1,2]}},es=(Q,Qe)=>{switch(Qe){case"":return Q.speedScore;case"":return Q.economyScore;case"":return Q.scenicScore;case"":return Math.round(100*Qu(Q.fracComm));default:return 0}},nc=Q=>Q.length?Q.reduce((Qe,ft)=>Qe+ft,0)/Q.length:0,Bc=ke.useCallback(()=>{const Q=u.current,Qe=ha.current;if(!Q||!Qe.A.length||!Qe.B.length||!Qe.C.length)return;const ft=U0(Q,Qe,[],[],[],mi.current),Ht=[...ft].sort((dr,Tr)=>dr.totalTimeS-Tr.totalTimeS),Nt=Ht[1]?.route||Ht[0]?.route||"A",gr=wi==="Auto"?Nt:wi,Jr=uR.filter(dr=>dr!==gr),mn=[...Jr].sort((dr,Tr)=>{const Dr=ft.find(Fr=>Fr.route===dr)?.totalTimeS??0,zr=ft.find(Fr=>Fr.route===Tr)?.totalTimeS??0;return Dr-zr});mn[0]||Jr[0],mn[1]||Jr[1];const Vr=U0(Q,Qe,Kr.current,yn.current,hn.current,mi.current),Hr=Vr.map(dr=>{const Dr=xu(je).map(Fr=>es(dr.segments[Fr],Qt)),zr=nc(Dr);return{rid:dr.route,totalTimeS:dr.totalTimeS,primaryScore:zr,rawStats:dr}});let Pr=gr,Wr="";if(vr==="Elimination"){const dr=pi*100,Tr=Hr.filter(Dr=>Dr.primaryScore>=dr);if(Tr.length>0){Tr.sort((zr,Fr)=>zr.totalTimeS-Fr.totalTimeS),Pr=Tr[0].rid;const Dr=Hr.length-Tr.length;Wr=` ${Math.round(dr)}: ${Dr} .  ${Pr} (  : ${(Tr[0].totalTimeS/60).toFixed(1)} ').`}else Hr.sort((Dr,zr)=>zr.primaryScore-Dr.primaryScore),Pr=Hr[0].rid,Wr=`:       ${Math.round(dr)}.  ${Pr}     (${Math.round(Hr[0].primaryScore)}).`}else{const dr=Vr.map(xr=>xr.totalTimeS),Tr=Math.min(...dr),Dr=Math.max(...dr),zr=xr=>Dr<=Tr+1e-6?100:(Dr-xr)/(Dr-Tr)*100,Fr=xu(je),sn=[];for(const xr of Vr){const Sr=xr.route,nn=Fr.map(gn=>es(xr.segments[gn],Qt)),qr=Fr.map(gn=>es(xr.segments[gn],Me)),un=nc(nn),Er=nc(qr),Br=zr(xr.totalTimeS),Nr=Pe?es(xr.segments[At-1],jt):0;let Wn=0,Gr="";vr==="Lexicographic"?(Wn=(Pe?Nr*1e4:0)+un*100+Er*10+Br*1,Gr="Lex"):(Wn=_r*un+Tn*Er+Zr*Br+(Pe?_r*Nr:0),Gr="W"),sn.push({rid:Sr,score:Wn,note:Gr})}sn.sort((xr,Sr)=>Sr.score-xr.score),Pr=sn[0].rid,Wr=`: ${gr}  : ${vr}  : ${Pr}`}lu(Pr),Wo(Wr),Qs(Pr),Qs(Pr)},[u,ha,Qt,je,Me,Pe,jt,At,or,vr,_r,Tn,Zr,pi,wi,xt,it,zt,kr,ei,En,Qr,lu,Wo,Qs]);ke.useEffect(()=>{if(eR(),!r.current||u.current)return;const Q=new q0.Map({container:r.current,style:$D,center:[34.7818,32.0853],zoom:13.8,preserveDrawingBuffer:!0});return Q.on("styleimagemissing",Qe=>{const ft=(Qe?.id??"").toString(),Ht=new Uint8Array([0,0,0,0]);try{if(ft.trim()===""){Q.hasImage(" ")||Q.addImage(" ",{width:1,height:1,data:Ht});return}Q.hasImage(ft)||Q.addImage(ft,{width:1,height:1,data:Ht})}catch{}}),Q.addControl(new q0.NavigationControl,"top-left"),Q.addControl(new q0.ScaleControl({unit:"metric"}),"bottom-left"),Q.on("load",()=>{bf(Q),cr(Q,"measure-points",In([])),cr(Q,"measure-line",_a([])),cr(Q,"single-points",In([])),cr(Q,"single-line",_a([])),cr(Q,"start-end",In([])),cr(Q,"triple-a",_a([])),cr(Q,"triple-b",_a([])),cr(Q,"triple-c",_a([])),cr(Q,"triple-badge-points",In([])),cr(Q,"triple-badge-lines",di([])),cr(Q,"triple-seg-points",In([])),cr(Q,"triple-seg-ticks",di([])),cr(Q,"edit-junctions",In([])),cr(Q,"cat-traffic",di([])),cr(Q,"cat-toll",di([])),cr(Q,"cat-toll-labels",In([])),cr(Q,"cat-comm",B0([]));try{bf(Q)}catch{}xt([]),it([]),zt([]),kr([]),$t(!1),cr(Q,"cat-traffic",di([])),cr(Q,"cat-toll",di([])),cr(Q,"cat-toll-labels",In([])),cr(Q,"cat-comm",B0([]));try{bf(Q)}catch{}if(_b(Q,H,N),pd(Q,Zy,Z),pd(Q,gb,X),pd(Q,Qe=>mb(Qe)&&!lx(Qe),ge),pd(Q,lx,re),j0(Q,Ia),hx(Q,Ia),dg(Q,Ia),pb(Q),$l.current=bb(Q),s(Qe=>Qe+1),!Q.__badgeDragAttached){Q.__badgeDragAttached=!0;let Qe=null;const ft=gr=>{const Jr=Q.getCanvas();Jr.style.cursor=gr},Ht=gr=>{const Jr=ah.current;cr(Q,"triple-badge-points",yb(gr)),Jr.length&&cr(Q,"triple-badge-lines",Cy(Q,Jr,gr))};Q.on("mousemove",gr=>{const Jr=Q.queryRenderedFeatures(gr.point,{layers:["triple-badges","triple-badge-text"]});if(Qe){ft("grabbing");return}ft(Jr.length?"grab":"")}),Q.on("mousedown",gr=>{if(cs.current)return;const Vr=Q.queryRenderedFeatures(gr.point,{layers:["triple-badges","triple-badge-text"]})?.[0]?.properties?.id??null;if(Vr){Qs(Vr),Os.current=Vr;try{j0(Q,Vr)}catch{}try{hx(Q,Vr)}catch{}try{dg(Q,Vr)}catch{}Qe=Vr;try{Q.dragPan.disable()}catch{}ft("grabbing"),gr.preventDefault()}}),Q.on("mousemove",gr=>{if(!Qe)return;const Jr=Q.getBounds(),mn=[gr.lngLat.lng,gr.lngLat.lat],Vr=fg(mn,Jr,.08),Pr=rl.current.map(Wr=>Wr.id===Qe?{...Wr,coord:Vr}:Wr);rl.current=Pr,vo(Pr),Ht(Pr)});const Nt=()=>{if(Qe){Qe=null;try{Q.dragPan.enable()}catch{}ft("")}};Q.on("mouseup",Nt),Q.on("mouseleave",Nt),Q.on("touchend",Nt)}}),Q.on("style.load",()=>{try{bf(Q)}catch{}try{pb(Q)}catch{}$l.current=bb(Q),s(Qe=>Qe+1)}),Q.on("click",Qe=>{const ft=[Qe.lngLat.lng,Qe.lngLat.lat];if(Pi.current){const Vr=Q.queryRenderedFeatures(Qe.point,{layers:$l.current});if(Vr.length>0){const Hr=Vr[0];let Pr=[];if(Hr.geometry.type==="Polygon"?Pr=Hr.geometry.coordinates[0]:Hr.geometry.type==="MultiPolygon"&&(Pr=Hr.geometry.coordinates[0][0]),Pr&&Pr.length>3){const Wr=Pr.map(zr=>[zr[0],zr[1]]),dr=Wr[0],Tr=Wr[Wr.length-1];Math.abs(dr[0]-Tr[0])<1e-6&&Math.abs(dr[1]-Tr[1])<1e-6&&Wr.pop();const Dr={id:`mp_picked_${Date.now()}`,ring:Wr};ei(zr=>[...zr,Dr]),nl(Dr),tn("    !")}else tn("     .")}else tn("    .");return}if(cs.current){yu(ft);return}const Ht=Jo.current;if(Ht){const Vr=u.current;if(!Vr)return;const Hr=Qe.point,Pr=[[Hr.x-6,Hr.y-6],[Hr.x+6,Hr.y+6]],Wr=Ht==="traffic"?["cat-traffic"]:Ht==="toll"?["cat-toll-left","cat-toll-right"]:Ht==="comm"?["cat-comm-fill"]:Ht==="park"?["manual-parks-fill"]:[],dr=Wr.length?Vr.queryRenderedFeatures(Pr,{layers:Wr}):[],Tr=dr&&dr[0]&&dr[0].properties?.id||"";if(!Tr){tn("   .     .");return}Ht==="traffic"?(xt(Dr=>Dr.filter(zr=>zr.id!==Tr)),tn("  .")):Ht==="toll"?(it(Dr=>Dr.filter(zr=>zr.id!==Tr)),tn("  .")):Ht==="comm"?(kr(Dr=>Dr.filter(zr=>zr.id!==Tr)),tn("  .")):Ht==="park"&&(ei(Dr=>Dr.filter(zr=>zr.id!==Tr)),tn(" ."));return}const Nt=xo.current;if(Nt){const Vr=u.current;if(!Vr)return;if(Nt==="comm"){if(!Cn.current)ls(ft),tn(" .     .");else{const Wr=Cn.current,dr=Q0(Wr,ft);if(dr<20){tn("  .     .");return}const Tr=Ey(Wr,dr),Dr=`comm_manual_${Date.now()}`;kr(zr=>[...zr,{id:Dr,ring:Tr,radiusM:dr}]),ls(null),Ki(null),tn("  .")}return}const Pr=(()=>{const Wr=Qe.point,dr=25,Tr=[[Wr.x-dr,Wr.y-dr],[Wr.x+dr,Wr.y+dr]],Dr=Vr.queryRenderedFeatures(Tr,{});let zr=null,Fr=1/0;for(const sn of Dr){const xr=sn.geometry;if(!xr)continue;const Sr=xr.type;if(Sr!=="LineString"&&Sr!=="MultiLineString")continue;const nn=Sr==="LineString"?xr.coordinates:(xr.coordinates||[]).flat(1);for(const qr of nn){if(!Array.isArray(qr)||qr.length<2)continue;const un=Vr.project({lng:qr[0],lat:qr[1]}),Er=un.x-Wr.x,Br=un.y-Wr.y,Nr=Er*Er+Br*Br;Nr<Fr&&(Fr=Nr,zr=[qr[0],qr[1]])}}return Fr<=dr*dr?zr:null})();if(!Pr){tn("      .    .");return}Ji(Wr=>[...Wr,Pr]);return}const gr=nt.current;if(gr==="TRIPLE"&&rc.current){const Vr=Q.queryRenderedFeatures(Qe.point,{layers:["edit-junction-circles","edit-junction-text"]}),Hr=Vr&&Vr[0],Pr=Hr&&Hr.properties?.jid;if(Pr){Ss.current(Pr);return}}if(gr==="MEASURE"){zs(Vr=>[...Vr,ft]);return}if(gr==="SINGLE"){Xl(Vr=>[...Vr,ft]);return}if(!et.current)return;const Jr=qh.current,mn=Zh.current;if(!Jr){el(ft),yo(null);return}if(!mn){yo(ft),ct(!1);return}el(ft),yo(null)}),Q.on("mousemove",Qe=>{cs.current&&(Qo.current=[Qe.lngLat.lng,Qe.lngLat.lat],To())}),Q.on("dblclick",Qe=>{const ft=xo.current;if(ft==="traffic"||ft==="toll"){Qe.preventDefault();const Ht=_n.current;if(!Ht||Ht.length<2){tn("  2    .");return}const Nt=`${ft}_manual_${Date.now()}`;ft==="traffic"?(xt(gr=>[...gr,{id:Nt,coords:Ht}]),tn("  .")):(it(gr=>[...gr,{id:Nt,coords:Ht}]),tn("  .")),Ji([]),Ki(null);return}if(cs.current){Qe.preventDefault();try{ch(),To()}catch{}}}),u.current=Q,()=>{Q.remove(),u.current=null}},[]),ke.useEffect(()=>{const Q=u.current;!Q||!Q.isStyleLoaded()||_b(Q,H,N)},[H]),ke.useEffect(()=>{const Q=u.current;!Q||!Q.isStyleLoaded()||(pd(Q,Zy,Z),pd(Q,gb,X),pd(Q,Qe=>mb(Qe)&&!lx(Qe),ge),pd(Q,lx,re))},[Z,X,ge,re]),ke.useEffect(()=>{const Q=u.current;if(!Q||!Q.isStyleLoaded())return;try{bf(Q)}catch{}const Qe=(Nt,gr)=>{if(Q.getLayer(Nt))try{Q.setLayoutProperty(Nt,"visibility",gr?"visible":"none")}catch{}};Qe("cat-traffic",Oe),Qe("cat-traffic-glow",Oe);const ft=me;Qe("cat-toll-shadow",ft),Qe("cat-toll-left",ft),Qe("cat-toll-right",ft),Qe("cat-toll-label-bg",ft),Qe("cat-toll-label-text",ft);const Ht=Ue;Qe("cat-comm-fill",Ht),Qe("cat-comm-outline",Ht)},[Oe,me,Ue]),ke.useEffect(()=>{const Q=u.current;Q&&Q.getSource("measure-points")&&(cr(Q,"measure-points",In(ti)),cr(Q,"measure-line",_a(ti)))},[ti]),ke.useEffect(()=>{const Q=u.current;Q&&Q.getSource("single-points")&&cr(Q,"single-points",In(Fi))},[Fi]),ke.useEffect(()=>{const Q=u.current;if(!Q||!Q.getSource("single-line"))return;if(Fi.length<2){ua([]),cr(Q,"single-line",_a([]));return}let Qe=!1;return(async()=>{Pc(!0);const ft=await vg(Fi);Qe||(ft&&ft.length>=2?(ua(ft),cr(Q,"single-line",_a(ft))):(ua([]),cr(Q,"single-line",_a(Fi))),Pc(!1))})(),()=>{Qe=!0,Pc(!1)}},[Fi]),ke.useEffect(()=>{const Q=u.current;if(!Q||!Q.getSource("start-end"))return;const Qe=[],ft=[];na&&(Qe.push(na),ft.push({kind:"start",label:""})),Zn&&(Qe.push(Zn),ft.push({kind:"end",label:""})),cr(Q,"start-end",In(Qe,ft))},[na,Zn]),ke.useEffect(()=>{const Q=u.current;if(Q&&Q.isStyleLoaded()&&Q.getSource("triple-a")){if(ha.current={A:[],B:[],C:[]},ws.current={A:[],B:[],C:[]},tc(!1),Ts([]),bo(new Set),Bs([]),Pa(-1),!na||!Zn){cr(Q,"triple-a",_a([])),cr(Q,"triple-b",_a([])),cr(Q,"triple-c",_a([])),cr(Q,"triple-badge-points",In([])),cr(Q,"triple-badge-lines",di([])),cr(Q,"triple-seg-points",In([])),cr(Q,"triple-seg-ticks",di([])),cr(Q,"edit-junctions",In([])),vo([]),Fc([]);return}cr(Q,"triple-a",_a([])),cr(Q,"triple-b",_a([])),cr(Q,"triple-c",_a([])),cr(Q,"triple-badge-points",In([])),cr(Q,"triple-badge-lines",di([])),cr(Q,"triple-seg-points",In([])),cr(Q,"triple-seg-ticks",di([])),cr(Q,"edit-junctions",In([])),vo([]),Fc([])}},[na,Zn]),ke.useEffect(()=>{const Q=u.current;if(!Q||!na||!Zn||!Q.getSource("triple-a")||wa<=0)return;Qs("A");let Qe=!1;return(async()=>{Ml(!0);const ft=Q.getBounds(),Ht=Math.abs(ft.getEast()-ft.getWest()),Nt=Math.abs(ft.getNorth()-ft.getSouth()),gr=(.06+Kl*.1)*Math.min(Ht,Nt),Jr=Zn[0]-na[0],mn=Zn[1]-na[1],Vr=-mn,Hr=Jr,Pr=Math.sqrt(Vr*Vr+Hr*Hr)||1,Wr=Vr/Pr,dr=Hr/Pr,Tr=Math.sqrt(Jr*Jr+mn*mn)||1,Dr=Jr/Tr,zr=mn/Tr,Fr=[(na[0]+Zn[0])/2,(na[1]+Zn[1])/2],sn=[Fr[0]+Wr*gr,Fr[1]+dr*gr],xr=[Fr[0]-Wr*gr,Fr[1]-dr*gr],Sr=await vg([na,Zn]),nn=await vg([na,sn,Zn]),qr=await vg([na,xr,Zn]);if(Qe)return;const un=Sr??[na,Zn],Er=nn??[na,sn,Zn],Br=qr??[na,xr,Zn];ha.current={A:un,B:Er,C:Br},ws.current={A:un,B:Er,C:Br},tc(!1),Ts([]),bo(new Set),Bs([]),Pa(-1),cr(Q,"edit-junctions",In([])),ws.current={A:un,B:Er,C:Br},tc(!1),Ts([]),bo(new Set),Bs([]),Pa(-1),cr(Q,"edit-junctions",In([])),cr(Q,"triple-a",_a(un)),cr(Q,"triple-b",_a(Er)),cr(Q,"triple-c",_a(Br));const Nr=ux(un),Wn=ux(Er),Gr=ux(Br),gn=[{id:"A",coord:Nr},{id:"B",coord:Wn},{id:"C",coord:Gr}];Fc(gn);const fa=gr*.17,Za=gr*.17,js=(Bi,Si,ks)=>{let Il=[Bi[0]+Wr*fa*Si+Dr*Za*ks,Bi[1]+dr*fa*Si+zr*Za*ks];return Il=fg(Il,ft,.07),Il};let fs=js(Nr,1,.8),zi=js(Wn,-1,.8),Oi=js(Gr,1,-.8);const ro=gr*.45,no=(Bi,Si)=>[Bi[0]+Wr*fa*.45*Si,Bi[1]+dr*fa*.45*Si];ky(fs,zi)<ro&&(zi=fg(no(zi,-1),ft,.07)),ky(fs,Oi)<ro&&(Oi=fg(no(Oi,1),ft,.07)),ky(zi,Oi)<ro&&(Oi=fg(no(Oi,1.4),ft,.07));const ds=[{id:"A",label:" ",coord:fs},{id:"B",label:" ",coord:zi},{id:"C",label:" ",coord:Oi}];vo(ds),cr(Q,"triple-badge-points",yb(ds)),cr(Q,"triple-badge-lines",Cy(Q,gn,ds)),Qs("A"),j0(Q,"A");const ri=un;if(!ri||ri.length<2)cr(Q,"triple-seg-points",In([])),cr(Q,"triple-seg-ticks",di([])),cr(Q,"edit-junctions",In([]));else{const{i1:Bi,i2:Si}=xx(ri),ks=au(ri),Il=ks[ks.length-1]||1,Cs=0,sc=ks[Bi],So=ks[Si],Wa=Il,wu=ql(ri,ks,(Cs+sc)/2),dh=ql(ri,ks,(sc+So)/2),$h=ql(ri,ks,(So+Wa)/2),Tu=50,ph=Pl=>{const Ei=ri[Pl],Ms=ri[Math.max(0,Pl-1)],oc=ri[Math.min(ri.length-1,Pl+1)],Ai=Ay(Ms,oc),Ff=-Ai.uy,lc=Ai.ux,Su=N0(Ei,Ff*(Tu/2),lc*(Tu/2)),li=N0(Ei,-Ff*(Tu/2),-lc*(Tu/2));return[Su,li]},Ua=ph(Bi),Eo=ph(Si);cr(Q,"triple-seg-points",In([wu,dh,$h],[{label:"1"},{label:"2"},{label:"3"}])),cr(Q,"triple-seg-ticks",di([{coords:Ua},{coords:Eo}]))}Ml(!1),$t(!0),_u()})(),()=>{Qe=!0,Ml(!1)}},[wa]),ke.useEffect(()=>{const Q=u.current;if(!Q||!Q.isStyleLoaded())return;j0(Q,Ia),hx(Q,Ia),dg(Q,Ia);const Qe=ha.current,ft=Ia==="A"?Qe.A:Ia==="B"?Qe.B:Qe.C;if(!ft||ft.length<2){cr(Q,"triple-seg-points",In([])),cr(Q,"triple-seg-ticks",di([])),cr(Q,"edit-junctions",In([]));return}const{i1:Ht,i2:Nt}=xx(ft),gr=au(ft),Jr=gr[gr.length-1]||1,mn=0,Vr=gr[Ht],Hr=gr[Nt],Pr=Jr,Wr=ql(ft,gr,(mn+Vr)/2),dr=ql(ft,gr,(Vr+Hr)/2),Tr=ql(ft,gr,(Hr+Pr)/2),Dr=50,zr=xr=>{const Sr=ft[xr],nn=ft[Math.max(0,xr-1)],qr=ft[Math.min(ft.length-1,xr+1)],un=Ay(nn,qr),Er=-un.uy,Br=un.ux,Nr=N0(Sr,Er*(Dr/2),Br*(Dr/2)),Wn=N0(Sr,-Er*(Dr/2),-Br*(Dr/2));return[Nr,Wn]},Fr=zr(Ht),sn=zr(Nt);cr(Q,"triple-seg-points",In([Wr,dr,Tr],[{label:"1"},{label:"2"},{label:"3"}])),cr(Q,"triple-seg-ticks",di([{coords:Fr},{coords:sn}]))},[Ia,wa]);const Nc=()=>zs([]),lh=()=>{Xl([]),ua([])};function Dl(){const Q=u.current;if(!Q)return;const Qe=mi.current.filter(ft=>ft.ring.length>=3).map(ft=>({type:"Feature",properties:{id:ft.id},geometry:{type:"Polygon",coordinates:[[...ft.ring,ft.ring[0]]]}}));cr(Q,"manual-parks",{type:"FeatureCollection",features:Qe})}function To(){const Q=u.current;if(!Q)return;const Qe=du.current;cr(Q,"manual-park-draft-points",In(Qe)),Qe.length>=2?cr(Q,"manual-park-draft-line",_a(Qe)):cr(Q,"manual-park-draft-line",_a([])),cs.current&&Qe.length>=1&&Qo.current?cr(Q,"manual-park-preview-line",_a([Qe[Qe.length-1],Qo.current])):cr(Q,"manual-park-preview-line",_a([]))}const Wh=ke.useCallback(Q=>{ei(ft=>ft.filter(Ht=>Ht.id!==Q));const Qe=kn.current[Q];if(Qe){try{Qe.remove()}catch{}delete kn.current[Q]}},[]),Fn=ke.useCallback(()=>{ei([]);for(const Qe of Object.keys(kn.current))try{kn.current[Qe].remove()}catch{}kn.current={},Ii(!1),Ls([]),Qo.current=null;const Q=u.current;Q&&(cr(Q,"manual-parks",B0([])),cr(Q,"manual-park-draft-line",_a([])),cr(Q,"manual-park-draft-points",In([])),cr(Q,"manual-park-preview-line",_a([])))},[]);function Es(){const Q=Hn;for(const Qe of Object.keys(kn.current)){const ft=kn.current[Qe]?.getElement();ft&&(ft.style.display=Q?"block":"none")}}function nl(Q){const Qe=u.current;if(!Qe)return;const ft=kn.current[Q.id];if(ft){try{ft.remove()}catch{}delete kn.current[Q.id]}const Ht=wR(Q.ring),Nt=document.createElement("button");Nt.type="button",Nt.textContent="",Nt.title=" ",Nt.style.width="22px",Nt.style.height="22px",Nt.style.borderRadius="999px",Nt.style.border="1px solid rgba(255,255,255,0.65)",Nt.style.background="rgba(10,14,22,0.95)",Nt.style.color="white",Nt.style.fontSize="16px",Nt.style.lineHeight="18px",Nt.style.cursor="pointer",Nt.style.boxShadow="0 2px 10px rgba(0,0,0,0.35)",Nt.style.display=Hn?"block":"none",Nt.addEventListener("click",Jr=>{Jr.preventDefault(),Jr.stopPropagation(),Wh(Q.id)});const gr=new q0.Marker({element:Nt,anchor:"center"}).setLngLat(Ht).addTo(Qe);kn.current[Q.id]=gr}const yu=ke.useCallback(Q=>{Ls(Qe=>Qe.length>0&&Q0(Qe[Qe.length-1],Q)<2||vR(Qe,Q)?Qe:[...Qe,Q])},[]),ch=ke.useCallback(()=>{const Q=du.current;if(Q.length<3||bR(Q))return;const ft={id:`mp-${Date.now()}-${kl.current++}`,ring:Q};ei(Ht=>[...Ht,ft]),nl(ft),Ls([]),Qo.current=null,Ii(!1)},[nl]),ac=()=>{Fn(),el(null),yo(null),vo([]),Fc([]),ha.current={A:[],B:[],C:[]},ws.current={A:[],B:[],C:[]},tc(!1),Ts([]),bo(new Set),Bs([]),Pa(-1);const Q=u.current;if(Q){cr(Q,"triple-a",_a([])),cr(Q,"triple-b",_a([])),cr(Q,"triple-c",_a([])),cr(Q,"triple-badge-points",In([])),cr(Q,"triple-badge-lines",di([])),cr(Q,"triple-seg-points",In([])),cr(Q,"triple-seg-ticks",di([])),cr(Q,"edit-junctions",In([])),cr(Q,"cat-traffic",di([])),cr(Q,"cat-toll",di([])),cr(Q,"cat-toll-labels",In([])),cr(Q,"cat-comm",B0([]));try{bf(Q)}catch{}xt([]),it([]),zt([]),kr([]),$t(!1),ct(!1)}},vu=()=>{try{lh()}catch{}try{Nc()}catch{}try{ac()}catch{}},jc=Q=>Q==="A"?"triple-a":Q==="B"?"triple-b":"triple-c",gi=ke.useCallback((Q,Qe)=>{if(!Qe||Qe.length<2){cr(Q,"triple-seg-points",In([])),cr(Q,"triple-seg-ticks",di([])),cr(Q,"edit-junctions",In([]));return}const{i1:ft,i2:Ht}=xx(Qe),Nt=au(Qe),gr=Nt[Nt.length-1]||1,Jr=0,mn=Nt[ft],Vr=Nt[Ht],Hr=gr,Pr=ql(Qe,Nt,(Jr+mn)/2),Wr=ql(Qe,Nt,(mn+Vr)/2),dr=ql(Qe,Nt,(Vr+Hr)/2),Tr=50,Dr=sn=>{const xr=Qe[sn],Sr=Qe[Math.max(0,sn-1)],nn=Qe[Math.min(Qe.length-1,sn+1)],qr=Ay(Sr,nn),un=-qr.uy,Er=qr.ux,Br=N0(xr,un*(Tr/2),Er*(Tr/2)),Nr=N0(xr,-un*(Tr/2),-Er*(Tr/2));return[Br,Nr]},zr=Dr(ft),Fr=Dr(Ht);cr(Q,"triple-seg-points",In([Pr,Wr,dr],[{label:"1"},{label:"2"},{label:"3"}])),cr(Q,"triple-seg-ticks",di([{coords:zr},{coords:Fr}]))},[]),uh=ke.useCallback(Q=>{Qs(Q),Os.current=Q;const Qe=u.current;if(!Qe||!Qe.isStyleLoaded())return;try{j0(Qe,Q)}catch{}try{hx(Qe,Q)}catch{}try{dg(Qe,Q)}catch{}const ft=ha.current,Ht=Q==="A"?ft.A:Q==="B"?ft.B:ft.C;try{gi(Qe,Ht??[])}catch{}},[gi]),ic=ke.useCallback((Q,Qe,ft)=>{cr(Q,jc(Qe),_a(ft));const Ht=ux(ft),Nt=ah.current.map(Jr=>Jr.id===Qe?{...Jr,coord:Ht}:Jr);Fc(Nt);const gr=rl.current;Nt.length&&gr.length&&cr(Q,"triple-badge-lines",Cy(Q,Nt,gr)),dg(Q,Qe)},[]),hs=ke.useCallback(Q=>{const Qe=eo.current,ft=Qe+1;Bs(Ht=>[...Ht.slice(0,Qe+1),new Set(Q)]),Pa(ft)},[]),ts=ke.useCallback(async Q=>{const Qe=u.current;if(!Qe||!Qe.isStyleLoaded())return;const ft=Os.current,Ht=ws.current[ft],Nt=mu.current;My(Qe,Nt,Q);const gr=await mR(Ht,Nt,Q);ha.current[ft]=gr,ic(Qe,ft,gr),gi(Qe,gr)},[gi,ic]),Li=ke.useCallback(Q=>{if(!rc.current)return;const Qe=Pf.current,ft=new Set(Qe);ft.has(Q)?ft.delete(Q):ft.add(Q),bo(ft),hs(ft),ts(ft)},[ts,hs]),to=ke.useCallback(()=>{const Q=eo.current;if(Q<=0)return;const Qe=Q-1,ft=ih.current[Qe]??new Set;Pa(Qe),bo(new Set(ft)),ts(new Set(ft))},[ts]),al=ke.useCallback(()=>{const Q=eo.current,Qe=ih.current;if(Q<0||Q>=Qe.length-1)return;const ft=Q+1,Ht=Qe[ft]??new Set;Pa(ft),bo(new Set(Ht)),ts(new Set(Ht))},[ts]),il=ke.useCallback(()=>{const Q=u.current;if(!Q||!Q.isStyleLoaded())return;const Qe=Os.current,ft=ws.current[Qe];if(!ft||ft.length<2)return;ha.current[Qe]=ft,ic(Q,Qe,ft);const Ht=new Set;bo(Ht),Bs([Ht]),Pa(0),My(Q,mu.current,Ht),gi(Q,ft)},[gi,ic]);ke.useEffect(()=>{Ss.current=Li,gu.current=to,sh.current=al,oh.current=il},[Li,to,al,il]),ke.useEffect(()=>{const Q=u.current;if(!Q)return;let Qe=!1;const ft=()=>{if(Qe)return;try{bf(Q)}catch{}if(!Qi){cr(Q,"edit-junctions",In([]));return}const Ht=Ia,Nt=ws.current[Ht];if(!Nt||Nt.length<2){Ts([]),cr(Q,"edit-junctions",In([]));return}const gr=fR(Nt);Ts(gr);const Jr=new Set;bo(Jr),Bs([Jr]),Pa(0),My(Q,gr,Jr)};if(!Q.isStyleLoaded()){const Ht=()=>ft();try{Q.once("idle",Ht)}catch{}try{Q.once("load",Ht)}catch{}return()=>{Qe=!0;try{Q.off("idle",Ht)}catch{}try{Q.off("load",Ht)}catch{}}}return ft(),()=>{Qe=!0}},[Qi,Ia,wa,_]);const bu=ke.useCallback(async()=>{const Q=window.showDirectoryPicker;if(!Q){alert("      .     (Downloads)."),Xo("downloads"),Yo(null),Ko("Downloads");return}try{const Qe=await Q({mode:"readwrite"});Qe&&(Yo(Qe),Xo("directory"),Ko(String(Qe.name||"Selected folder")))}catch{}},[]),Rl=ke.useCallback(()=>{Xo("downloads"),Yo(null),Ko("Downloads")},[]),Ns=ke.useCallback((Q,Qe)=>{const ft=new Blob([Q],{type:"text/html;charset=utf-8"}),Ht=URL.createObjectURL(ft),Nt=document.createElement("a");Nt.href=Ht,Nt.download=Qe,document.body.appendChild(Nt),Nt.click(),Nt.remove(),URL.revokeObjectURL(Ht)},[]),Uc=ke.useCallback((Q,Qe)=>{const ft=URL.createObjectURL(Qe),Ht=document.createElement("a");Ht.href=ft,Ht.download=Q,document.body.appendChild(Ht),Ht.click(),Ht.remove(),URL.revokeObjectURL(ft)},[]),Vc=ke.useCallback(()=>{const Q=u.current,Qe=Q?.getCenter?Q.getCenter():null,ft=Q?.getCanvas?Q.getCanvas():null,Ht={version:"GeoVisLab DebugLog v1",createdAt:new Date().toISOString(),scenarioName:Na,taskText:Wl,recommendedRoute:$o,vizType:"STACKED",mapView:Q?{center:Qe?[Qe.lng,Qe.lat]:null,zoom:Q.getZoom?Q.getZoom():null,bearing:Q.getBearing?Q.getBearing():null,pitch:Q.getPitch?Q.getPitch():null,width:ft?.width??null,height:ft?.height??null}:null,start:na,end:Zn,selectedRoute:Ia,routes:ha.current,routeScores:ht,spatial:{traffic:Xe,toll:{segments:ot,labels:vt},comm:mr,parks:$n},taskParams:{taskPrimaryCat:Qt,taskPrimaryScope:je,taskSecondaryCat:Me,taskLocalEnabled:Pe,taskLocalCat:jt,taskLocalSegment:At,taskDifficulty:or,taskMode:vr,taskWPrimary:_r,taskWSecondary:Tn,taskWTime:Zr,taskGateMinFrac:pi,taskTieBreaker:oi,taskFavorRoute:wi,taskWinnerRoute:bn,taskWinnerNote:kc},generation:{catGlobalDiversity:Re,catTrafficCount:Gt,catTrafficLenMin:Bt,catTrafficLenMax:Or,catTrafficDiv:pn,catTollCount:Mt,catTollLenMin:Ee,catTollLenMax:pt,catTollDiv:Kt,catCommCount:lr,catCommDiaMin:ir,catCommDiaMax:fe,catCommDiv:we}},Nt=new Blob([JSON.stringify(Ht,null,2)],{type:"application/json;charset=utf-8;"});Uc(cu,Nt),tn(` : ${cu}`)},[cu,Uc,Na,Wl,mo,$o,"STACKED",na,Zn,Ia,ht,Xe,ot,vt,mr,$n,Qt,je,Me,Pe,jt,At,or,vr,_r,Tn,Zr,pi,oi,wi,bn,kc,Re,Gt,Bt,Or,pn,Mt,Ee,pt,Kt,lr,ir,fe,we,tn]);ke.useRef(null);const dn=ke.useCallback(()=>{const Q=u.current;if(!Q)return;const Qe=Q.getCenter(),ft={center:{lng:Qe.lng,lat:Qe.lat},zoom:Q.getZoom(),pitch:Q.getPitch(),bearing:Q.getBearing()},Ht={version:1,meta:{name:Na||"Untitled Scenario",createdAt:new Date().toISOString()},mapState:ft,routes:{start:na,end:Zn,tripleLines:ha.current,routeScores:ht,selectedRoute:Ia},entities:{traffic:Kr.current,toll:yn.current,comm:hn.current,parks:mi.current},task:{primaryCat:Qt,primaryScope:je,secondaryCat:Me,localEnabled:Pe,localCat:jt,localSegment:At,difficulty:or,mode:vr,wPrimary:_r,wSecondary:Tn,wTime:Zr,gateMinFrac:pi,tieBreaker:oi,favorRoute:wi,winnerRoute:bn,winnerNote:kc},config:{diversity:Kl,scatterDensity:C,targetTimeGap:D,keepManualEntities:U,lang:H}},Nt=new Blob([JSON.stringify(Ht,null,2)],{type:"application/json"}),gr=`Scenario_${fb(Na)}_${new Date().toISOString().slice(0,10)}.json`;Uc(gr,Nt),tn("  !")},[Na,na,Zn,ht,Ia,Qt,je,Me,Pe,jt,At,or,vr,_r,Tn,Zr,pi,oi,wi,bn,kc,Kl,C,D,U,H,Uc,tn]),hh=ke.useCallback(Q=>{const Qe=Q.target.files?.[0];if(!Qe)return;const ft=new FileReader;ft.onload=async Ht=>{try{const Nt=JSON.parse(Ht.target?.result);if(!Nt.version||!Nt.mapState){alert("     .");return}zs([]),Xl([]),ua([]),de("TRIPLE"),Bs([]),Pa(-1),tc(!1);const gr=u.current;gr&&(gr.jumpTo({center:[Nt.mapState.center.lng,Nt.mapState.center.lat],zoom:Nt.mapState.zoom,pitch:Nt.mapState.pitch,bearing:Nt.mapState.bearing}),cr(gr,"measure-points",In([])),cr(gr,"measure-line",_a([])),cr(gr,"single-points",In([])),cr(gr,"single-line",_a([]))),Mc(Nt.meta.name),Jl(Nt.config.diversity),M(Nt.config.scatterDensity),B(Nt.config.targetTimeGap),j(Nt.config.keepManualEntities),O(Nt.config.lang),ye(Nt.task.primaryCat),Le(Nt.task.primaryScope),Te(Nt.task.secondaryCat),gt(Nt.task.localEnabled),Dt(Nt.task.localCat),_t(Nt.task.localSegment),yr(Nt.task.difficulty),fr(Nt.task.mode),Ur(Nt.task.wPrimary),vn(Nt.task.wSecondary),Mi(Nt.task.wTime),bi(Nt.task.gateMinFrac),Di(Nt.task.tieBreaker),bs(Nt.task.favorRoute),lu(Nt.task.winnerRoute),Wo(Nt.task.winnerNote),xt(Nt.entities.traffic||[]),it(Nt.entities.toll||[]);const Jr=[];(Nt.entities.toll||[]).forEach(mn=>{_x(mn.coords,250).forEach((Hr,Pr)=>Jr.push({coord:Hr,side:Pr%2===0?"left":"right"}))}),zt(Jr),kr(Nt.entities.comm||[]),ei(Nt.entities.parks||[]),ha.current=Nt.routes.tripleLines,ws.current=Nt.routes.tripleLines,el(Nt.routes.start),yo(Nt.routes.end),En(Nt.routes.routeScores||[]),Qs(Nt.routes.selectedRoute||"A"),$t(!0),ct(!1),setTimeout(()=>{gr&&(cr(gr,"triple-a",_a(Nt.routes.tripleLines.A)),cr(gr,"triple-b",_a(Nt.routes.tripleLines.B)),cr(gr,"triple-c",_a(Nt.routes.tripleLines.C)),j0(gr,Nt.routes.selectedRoute||"A"),Ql(mn=>mn+.001),tn(` : ${Nt.meta.name}`))},150)}catch(Nt){console.error(Nt),alert("  .    JSON   .")}},ft.readAsText(Qe),Q.target.value=""},[u,na,Zn,Ia,tn]),As=async()=>{const Q=u.current;if(!Q){alert("   .");return}f("   ..."),Q.loaded()||await new Promise(Sr=>Q.once("idle",Sr)),Q.triggerRepaint(),await new Promise(Sr=>Q.once("render",Sr));const Qe=Q.getCanvas();let ft="";try{ft=Qe.toDataURL("image/png")}catch(Sr){console.error("Export failed",Sr),alert("  (CORS):      .    .");return}const Ht=Qe.width,Nt=Qe.height,gr=Q.getCenter(),Jr=Q.getZoom(),mn=ha.current,Vr=rl.current,Hr=mi.current,Pr=Kr.current,Wr=yn.current,dr=hn.current,Dr=U0(Q,mn,Pr,Wr,dr,Hr).flatMap(Sr=>Sr.segments.map(nn=>({...nn,route:Sr.route}))),zr=[];if(p.STACKED&&zr.push({type:"STACKED",suffix:"S"}),p.RADAR&&zr.push({type:"RADAR",suffix:"R"}),p.HEATMAP&&zr.push({type:"HEATMAP",suffix:"H"}),zr.length===0){alert("      .");return}f(" ...");const Fr=fb(Na||"Scenario"),sn={center:[gr.lng,gr.lat],zoom:Jr,bearing:0,pitch:0,width:Ht,height:Nt};let xr=null;Rf==="directory"&&window.showDirectoryPicker&&fu&&(xr=fu);for(let Sr=0;Sr<zr.length;Sr++){const nn=zr[Sr];f(`  ${Sr+1}  ${zr.length} (${nn.suffix})...`);const qr=`${Fr}_${nn.suffix}.html`,un=WD({scenarioName:Na,taskText:Wl,requirementsText:mo,recommendedRoute:$o,vizType:nn.type,baseMapDataUrl:ft,mapView:sn,start:na,end:Zn,routes:mn,routeScores:Dr,badges:Vr,manualParks:Hr,catTrafficSegs:Pr,catTollSegs:Wr,catTollLabels:vt,catCommZones:dr});try{if(xr){const Br=await(await xr.getFileHandle(qr,{create:!0})).createWritable();await Br.write(un),await Br.close()}else Ns(un,qr),Sr<zr.length-1&&await new Promise(Er=>setTimeout(Er,800))}catch(Er){console.error(`Failed to save ${qr}`,Er)}}f(null),Cc(!1),tn(` ! (${zr.length} )`)},fh=ke.useCallback(()=>{if(!u.current)return;const Qe=ha.current;if(!Qe.A.length||!Qe.B.length||!Qe.C.length){alert("   ( 1)   .");return}const ft=U?Kr.current.filter(Fr=>Fr.id.includes("manual")):[],Ht=U?yn.current.filter(Fr=>Fr.id.includes("manual")):[],Nt=U?hn.current.filter(Fr=>Fr.id.includes("manual")):[],gr=[...ft],Jr=[...Ht],mn=[...Nt],Vr=["A","B","C"],Hr=Vr.map(Fr=>({id:Fr,len:_d(Qe[Fr]),line:Qe[Fr]}));Hr.sort((Fr,sn)=>Fr.len-sn.len);const Pr=Hr[0],Wr=Hr.slice(1);if(C>.1){const xr=Pr.len;let Sr=-1;const nn=Qt===""?"toll":"traffic";for(let qr=0;qr<xr;qr+=50){const un=au(Pr.line),Er=ql(Pr.line,un,qr);let Br=!0;for(const Nr of Wr)if(RR(Er,Nr.line)<8e-4){Br=!1;break}if(Br)Sr===-1&&(Sr=qr);else if(Sr!==-1){if(qr-Sr>250){const Gr={coords:cx(Pr.line,Sr,qr),id:`auto_smart_${nn}_${Pr.id}_${qr}`};nn==="traffic"?gr.push(Gr):Jr.push(Gr)}Sr=-1}}}const dr=Math.max(0,Math.round(C*4)),Tr=800,Dr=2500,zr=Fr=>{const sn=Qe[Fr],xr=_d(sn);if(xr<Tr+500)return null;const Sr=Tc(Tr,Math.min(xr*.4,Dr)),nn=Tc(xr*.1,xr*.9-Sr);return cx(sn,nn,nn+Sr)};if(C>.1)for(let Fr=0;Fr<dr;Fr++){const sn=Vr[Math.floor(Math.random()*3)],xr=Qe[sn],Sr=_d(xr),nn=ql(xr,au(xr),Tc(Sr*.1,Sr*.9));mn.push({id:`auto_comm_${sn}_${Fr}`,ring:Ey(nn,Tc(400,800)),radiusM:Tc(400,800)});const qr=Vr[Math.floor(Math.random()*3)],un=zr(qr);un&&(Math.random()>.5?gr.push({coords:un,id:`auto_filler_traffic_${qr}_${Fr}`}):Jr.push({coords:un,id:`auto_filler_toll_${qr}_${Fr}`}))}xt(gr),it(Jr),zt(Wt(Jr)),kr(mn),Qr(!1),En([]),tn(":    ( +  + ).")},[u,ha,Qt,C,U,Wt,tn]);return ke.useEffect(()=>{Kn&&(Qr(!1),En([]))},[Xe,ot,mr,$n,Qt,vr,_r,na,Zn]),Y.jsxs("div",{style:{display:"flex",width:"100vw",height:"100%",overflow:"hidden",fontFamily:"Arial, sans-serif !important"},children:[Y.jsx("style",{children:`
                * {
                    font-family: "Arial", sans-serif !important;
                }
            `}),Y.jsxs("div",{style:{flex:1,position:"relative"},children:[Y.jsx("div",{ref:r,style:{width:"100%",height:"100%"}}),Y.jsxs("div",{style:{position:"absolute",right:10,bottom:40,background:"rgba(11,15,23,0.78)",border:"1px solid rgba(255,255,255,0.12)",borderRadius:12,padding:"10px 12px",color:"#e8eefc",fontFamily:"Arial, sans-serif",fontSize:12,lineHeight:1.25,backdropFilter:"blur(6px)",minWidth:165,pointerEvents:"none",direction:"rtl",textAlign:"right"},children:[Y.jsx("div",{style:{fontWeight:900,marginBottom:8,opacity:.95},children:""}),Y.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:7},children:[Y.jsx("div",{style:{width:34,height:0,borderTop:`4px dashed ${qy}`,filter:"drop-shadow(0 0 2px rgba(255,0,34,0.55))"}}),Y.jsx("div",{style:{fontWeight:700},children:" "})]}),Y.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:7},children:[Y.jsxs("div",{style:{width:34,height:10,position:"relative"},children:[Y.jsx("div",{style:{position:"absolute",left:0,right:0,top:1,borderTop:`3px solid ${X0}`}}),Y.jsx("div",{style:{position:"absolute",left:0,right:0,bottom:1,borderTop:`3px solid ${X0}`}})]}),Y.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[Y.jsx("span",{style:{fontWeight:700},children:" "}),Y.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:18,height:18,borderRadius:999,background:X0,border:"1px solid rgba(11,18,32,0.9)",color:"#0b1220",fontWeight:900},children:""})]})]}),Y.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:7},children:[Y.jsx("div",{style:{width:18,height:18,borderRadius:999,background:Mw,border:`2px solid ${Dw}`}}),Y.jsx("div",{style:{fontWeight:700},children:" "})]}),Y.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[Y.jsx("div",{style:{width:18,height:12,borderRadius:4,background:M1,border:`2px solid ${Rx}`,opacity:D1}}),Y.jsx("div",{style:{fontWeight:700},children:" ()"})]})]}),Kn&&Y.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.58)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center",padding:16,direction:"rtl"},onMouseDown:()=>Qr(!1),children:Y.jsxs("div",{style:{width:1100,maxWidth:"96vw",background:"rgba(10, 14, 22, 0.98)",border:"1px solid rgba(255,255,255,0.15)",borderRadius:14,boxShadow:"0 18px 46px rgba(0,0,0,0.55)",overflow:"hidden",color:"white"},onMouseDown:Q=>Q.stopPropagation(),children:[Y.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px 12px",borderBottom:"1px solid rgba(255,255,255,0.12)",background:"rgba(10, 14, 22, 0.98)"},children:[Y.jsx("div",{style:{fontWeight:900,fontSize:16},children:""}),Y.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[Y.jsx("button",{onClick:Fs,disabled:!ht||ht.length===0,title:!ht||ht.length===0?"  ":"    CSV",style:{padding:"8px 12px",borderRadius:10,border:"1px solid rgba(255,255,255,0.18)",background:!ht||ht.length===0?"rgba(255,255,255,0.03)":"rgba(255,255,255,0.10)",color:"white",cursor:!ht||ht.length===0?"not-allowed":"pointer",opacity:!ht||ht.length===0?.55:1,fontWeight:900},children:" CSV"}),Y.jsx("button",{onClick:()=>Qr(!1),style:{padding:"8px 12px",borderRadius:10,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(255,255,255,0.06)",color:"white",cursor:"pointer",fontWeight:900},children:""})]})]}),Y.jsx("div",{style:{padding:12,maxHeight:"82vh",overflow:"auto"},children:(()=>{const Q=dr=>(dr/1e3).toFixed(2),Qe=dr=>(dr/60).toFixed(1),ft=dr=>Math.round(dr),Ht=(dr,Tr)=>{switch(Tr){case"":return Number(dr?.speedScore??0);case"":return Number(dr?.economyScore??0);case"":return Number(dr?.scenicScore??0);case"":return Number(dr?.commScore??0);default:return 0}},Nt={1:{min:1/0,max:-1/0},2:{min:1/0,max:-1/0},3:{min:1/0,max:-1/0}};(ht||[]).forEach(dr=>{(dr.segments||[]).forEach(Tr=>{const Dr=Number(Tr.segment);if(Dr===1||Dr===2||Dr===3){const zr=Number(Tr.timeS??0);Number.isFinite(zr)&&(Nt[Dr].min=Math.min(Nt[Dr].min,zr),Nt[Dr].max=Math.max(Nt[Dr].max,zr))}})});const gr=(dr,Tr)=>{const Dr=Nt[dr].min,zr=Nt[dr].max;if(!Number.isFinite(Dr)||!Number.isFinite(zr)||zr<=Dr+1e-6)return 100;const Fr=(zr-Tr)/(zr-Dr);return Math.max(0,Math.min(100,Fr*100))},Jr=vr==="Weighted"?`${Qt}${_r}${Me!=="None"?` + ${Me}${Tn}`:""} + ${Zr}`:"",mn=dr=>{const Tr=Number(dr.segment),Dr=gr(Tr,Number(dr.timeS??0));if(vr!=="Weighted"){const un=Number(dr.speedScore??0),Er=Number(dr.economyScore??0),Br=Number(dr.scenicScore??0),Nr=Number(dr.commScore??0);return Math.round((un+Er+Br+Nr)/4)}const zr=Ht(dr,Qt),Fr=Me==="None"?0:Ht(dr,Me),sn=Number(_r??0),xr=Me==="None"?0:Number(Tn??0),Sr=Number(Zr??0),nn=Math.max(1e-6,sn+xr+Sr),qr=(sn*zr+xr*Fr+Sr*Dr)/nn;return Math.round(qr)},Vr=dr=>{const Tr=Array.isArray(dr.segments)?dr.segments:[];if(!Tr.length)return 0;const Dr=Tr.reduce((Fr,sn)=>Fr+Number(sn.lengthM??0),0)||Tr.length,zr=Tr.reduce((Fr,sn)=>Fr+(Number(sn.lengthM??0)||1)*mn(sn),0);return Math.round(zr/Dr)},Hr={textAlign:"right",padding:"8px 8px",borderBottom:"1px solid rgba(255,255,255,0.15)",fontWeight:900,whiteSpace:"nowrap"},Pr={padding:"8px 8px",borderBottom:"1px solid rgba(255,255,255,0.08)",textAlign:"right"},Wr={borderLeft:"2px solid rgba(255,255,255,0.22)"};return Y.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12,tableLayout:"fixed"},children:[Y.jsxs("colgroup",{children:[Y.jsx("col",{style:{width:90}}),Y.jsx("col",{style:{width:95}}),Y.jsx("col",{style:{width:90}}),Y.jsx("col",{style:{width:90}}),Y.jsx("col",{style:{width:90}}),Y.jsx("col",{style:{width:90}}),Y.jsx("col",{style:{width:90}}),Y.jsx("col",{style:{width:160}}),Y.jsx("col",{style:{width:95}})]}),Y.jsx("thead",{children:Y.jsxs("tr",{style:{background:"rgba(255,255,255,0.04)"},children:[Y.jsx("th",{style:Hr,children:""}),Y.jsx("th",{style:Hr,children:" ()"}),Y.jsx("th",{style:Hr,children:" ()"}),Y.jsx("th",{style:{...Hr,...Wr,background:"rgba(59,130,246,0.10)"},children:""}),Y.jsx("th",{style:{...Hr,background:"rgba(245,158,11,0.10)"},children:""}),Y.jsx("th",{style:{...Hr,background:"rgba(34,197,94,0.10)"},children:""}),Y.jsx("th",{style:{...Hr,background:"rgba(170,60,255,0.10)"},children:""}),Y.jsx("th",{style:{...Hr,...Wr},children:""}),Y.jsx("th",{style:Hr,children:""})]})}),Y.jsx("tbody",{children:(ht||[]).map(dr=>Y.jsxs(ke.Fragment,{children:[Y.jsx("tr",{children:Y.jsxs("td",{colSpan:9,style:{padding:"10px 8px",fontWeight:900,borderBottom:"1px solid rgba(255,255,255,0.10)",background:"rgba(255,255,255,0.03)"},children:[" ",dr.route]})}),(dr.segments||[]).map(Tr=>Y.jsxs("tr",{children:[Y.jsxs("td",{style:Pr,children:[" ",Tr.segment]}),Y.jsx("td",{style:Pr,children:Q(Number(Tr.lengthM??0))}),Y.jsx("td",{style:Pr,children:Qe(Number(Tr.timeS??0))}),Y.jsx("td",{style:{...Pr,...Wr},children:ft(Number(Tr.speedScore??0))}),Y.jsx("td",{style:Pr,children:ft(Number(Tr.economyScore??0))}),Y.jsx("td",{style:Pr,children:ft(Number(Tr.scenicScore??0))}),Y.jsx("td",{style:Pr,children:ft(Number(Tr.commScore??0))}),Y.jsx("td",{style:{...Pr,...Wr,fontSize:11,opacity:.95},children:Jr}),Y.jsx("td",{style:{...Pr,fontWeight:900},children:mn(Tr)})]},`${dr.route}-${Tr.segment}`)),Y.jsxs("tr",{style:{background:"rgba(255,255,255,0.05)"},children:[Y.jsx("td",{style:{...Pr,fontWeight:900},children:""}),Y.jsx("td",{style:{...Pr,fontWeight:900},children:Q(Number(dr.totalLengthM??0))}),Y.jsx("td",{style:{...Pr,fontWeight:900},children:Qe(Number(dr.totalTimeS??0))}),Y.jsx("td",{style:{...Pr,...Wr,fontWeight:900},children:""}),Y.jsx("td",{style:{...Pr,fontWeight:900},children:""}),Y.jsx("td",{style:{...Pr,fontWeight:900},children:""}),Y.jsx("td",{style:{...Pr,fontWeight:900},children:""}),Y.jsx("td",{style:{...Pr,...Wr,fontWeight:900},children:""}),Y.jsx("td",{style:{...Pr,fontWeight:900},children:Vr(dr)})]})]},dr.route))})]})})()})]})})]}),Y.jsxs("div",{style:{width:420,background:"#0b0f17",color:"#e8eefc",padding:16,borderLeft:"1px solid rgba(255,255,255,0.08)",fontFamily:"Arial, sans-serif",direction:"rtl",overflowY:"auto"},children:[Y.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:Y.jsxs("div",{style:{display:"flex",gap:10,marginBottom:10,alignItems:"center"},children:[Y.jsx("div",{style:{fontWeight:900,fontSize:22,marginRight:10,fontFamily:"Arial, sans-serif"},children:" "}),Y.jsx("button",{onClick:()=>Vc(),title:"    (JSON)",style:{background:"rgba(140, 203, 255, 0.15)",border:"1px solid rgba(140, 203, 255, 0.3)",borderRadius:6,color:"#8ccbff",cursor:"pointer",padding:"0 8px",fontSize:11,fontWeight:"bold",height:32,whiteSpace:"nowrap",display:"flex",alignItems:"center",justifyContent:"center"},children:"JSON "}),Y.jsxs("label",{style:{flex:1,background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.2)",borderRadius:6,color:"white",cursor:"pointer",padding:"0 12px",fontSize:13,display:"flex",alignItems:"center",justifyContent:"center",height:32,textAlign:"center",fontWeight:600},children:[Y.jsx("span",{style:{marginLeft:6},children:""})," ",Y.jsx("input",{type:"file",accept:".json",onChange:Q=>{Q.target.files?.[0]&&(hh(Q),Q.target.value="")},style:{display:"none"}})]})]})}),Y.jsxs("div",{style:{background:"rgba(255,255,255,0.06)",borderRadius:12,padding:12,marginBottom:12},children:[Y.jsx("div",{style:{fontWeight:900,marginBottom:10},children:" "}),Y.jsxs("div",{style:{marginBottom:10},children:[Y.jsx("div",{style:{fontWeight:800,marginBottom:6},children:" "}),Y.jsxs("div",{style:{display:"flex",background:"rgba(0,0,0,0.3)",borderRadius:8,padding:4},children:[Y.jsx("button",{onClick:()=>Ge("vector"),style:{flex:1,padding:"6px",borderRadius:6,border:"none",cursor:"pointer",background:xe==="vector"?"rgba(255,255,255,0.2)":"transparent",color:xe==="vector"?"white":"rgba(255,255,255,0.5)",fontWeight:900},children:""}),Y.jsx("button",{onClick:()=>Ge("satellite"),style:{flex:1,padding:"6px",borderRadius:6,border:"none",cursor:"pointer",background:xe==="satellite"?"rgba(34, 197, 94, 0.25)":"transparent",color:xe==="satellite"?"#4ade80":"rgba(255,255,255,0.5)",fontWeight:900},children:""})]})]}),Y.jsxs("div",{style:{display:"flex",gap:10,alignItems:"flex-end"},children:[Y.jsxs("div",{style:{flex:1,minWidth:0},children:[Y.jsx("div",{style:{fontWeight:800,marginBottom:6},children:" "}),Y.jsxs("select",{value:H,onChange:Q=>O(Q.target.value),style:{width:"100%",padding:"10px 12px",borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:"rgba(255,255,255,0.06)",color:"#e8eefc",fontWeight:800,outline:"none",direction:"rtl"},children:[Y.jsx("option",{value:"he",children:""}),Y.jsx("option",{value:"en",children:"English"})]})]}),Y.jsxs("button",{onClick:()=>os(!0),style:{padding:"10px 12px",borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:"rgba(255,255,255,0.06)",color:"#e8eefc",cursor:"pointer",fontWeight:900,whiteSpace:"nowrap",display:"flex",alignItems:"center",gap:8},title:pu?" / ":"  ",children:[" ",pu&&Y.jsx("span",{style:{width:10,height:10,borderRadius:999,background:"#F59E0B",display:"inline-block"}})]})]}),Y.jsx("div",{style:{fontSize:12,opacity:.75,marginTop:8,lineHeight:1.35},children:":        ."})]}),Jn&&Y.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.55)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",padding:16,fontFamily:"Arial, sans-serif",direction:"rtl"},onMouseDown:()=>os(!1),children:Y.jsxs("div",{style:{width:520,maxWidth:"100%",maxHeight:"90vh",overflow:"auto",background:"#0b0f17",border:"1px solid rgba(255,255,255,0.15)",borderRadius:14,boxShadow:"0 16px 40px rgba(0,0,0,0.45)",padding:14},onMouseDown:Q=>Q.stopPropagation(),children:[Y.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:10,marginBottom:10},children:[Y.jsx("div",{style:{fontWeight:900,fontSize:16},children:" "}),Y.jsx("button",{onClick:()=>os(!1),style:{border:"1px solid rgba(255,255,255,0.15)",background:"rgba(255,255,255,0.06)",color:"#e8eefc",borderRadius:10,padding:"8px 10px",cursor:"pointer",fontWeight:900},title:"",children:""})]}),Y.jsx("div",{style:{fontWeight:900,marginBottom:8},children:" "}),Y.jsx("div",{style:{display:"grid",gap:8},children:[{key:"roads",label:"",v:Z,set:J},{key:"transit",label:"",v:X,set:pe},{key:"labels",label:"",v:ge,set:ve},{key:"poi",label:" ",v:re,set:Ce}].map(Q=>Y.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,cursor:"pointer"},children:[Y.jsx("input",{type:"checkbox",checked:Q.v,onChange:Qe=>Q.set(Qe.target.checked)}),Y.jsx("span",{style:{fontWeight:800},children:Q.label})]},Q.key))}),Y.jsxs("div",{style:{marginTop:12,paddingTop:12,borderTop:"1px solid rgba(255,255,255,0.12)"},children:[Y.jsx("div",{style:{fontWeight:900,marginBottom:8},children:" "}),Y.jsx("div",{style:{fontSize:12,opacity:.8,marginBottom:10},children:"/    (   3 )."}),Y.jsx("div",{style:{display:"grid",gap:8},children:[{key:"traffic",label:" ",v:Oe,set:It,disabled:!He},{key:"toll",label:" ",v:me,set:ne,disabled:!He},{key:"comm",label:" ",v:Ue,set:Fe,disabled:!He},{key:"baseParks",label:" ",v:Ma,set:qa,disabled:!1},{key:"manualParks",label:" ",v:Hn,set:en,disabled:!1}].map(Q=>Y.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,cursor:Q.disabled?"not-allowed":"pointer",opacity:Q.disabled?.6:1},children:[Y.jsx("input",{type:"checkbox",checked:Q.v,disabled:Q.disabled,onChange:Qe=>Q.set(Qe.target.checked)}),Y.jsx("span",{style:{fontWeight:800},children:Q.label})]},Q.key))})]})]})}),Y.jsxs("div",{style:{background:"rgba(255,255,255,0.06)",borderRadius:12,padding:12,marginBottom:12},children:[Y.jsx("div",{style:{fontWeight:900,marginBottom:10},children:"  "}),Y.jsx("div",{style:{display:"flex",background:"rgba(0,0,0,0.25)",borderRadius:10,padding:4,gap:4,margin:"0 auto 12px auto"},children:[{id:"TRIPLE",label:"3 "},{id:"SINGLE",label:" "},{id:"MEASURE",label:""}].map(Q=>{const Qe=Q.id==="TRIPLE"?$e==="TRIPLE":$e===Q.id,ft=Q.id==="TRIPLE"&&le;return Y.jsx("button",{onClick:()=>{Q.id==="TRIPLE"?$e!=="TRIPLE"?(de("TRIPLE"),ct(!0)):ct(Ht=>!Ht):(de(Q.id),ct(!1))},style:{flex:1,padding:"8px 0",borderRadius:8,border:"none",background:Qe?ft?"rgba(59, 130, 246, 0.9)":"rgba(255,255,255,0.15)":"transparent",color:Qe?"#fff":"rgba(255,255,255,0.6)",cursor:"pointer",fontWeight:Qe?800:600,fontSize:13},children:Q.label},Q.id)})}),Y.jsxs("div",{style:{paddingTop:10,borderTop:"1px solid rgba(255,255,255,0.1)"},children:[$e==="TRIPLE"&&Y.jsxs("div",{style:{fontSize:13,opacity:.9},children:[" : ",Y.jsx("b",{children:le?"":""})," ( =, =).",na&&Zn&&Y.jsx("div",{style:{color:"#4ade80",fontWeight:700,marginTop:4},children:"  ."})]}),$e==="SINGLE"&&Y.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:13},children:[Y.jsxs("span",{children:[": ",Y.jsx("b",{children:Fi.length}),", : ",Y.jsx("b",{children:ox(Hh)})]}),Y.jsx("button",{onClick:lh,style:{padding:"2px 8px",borderRadius:4,background:"rgba(255,255,255,0.1)",color:"white",border:"none",cursor:"pointer"},children:" "})]}),$e==="MEASURE"&&Y.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:13},children:[Y.jsxs("span",{children:[" : ",Y.jsx("b",{children:ox(ya)})]}),Y.jsx("button",{onClick:Nc,style:{padding:"2px 8px",borderRadius:4,background:"rgba(255,255,255,0.1)",color:"white",border:"none",cursor:"pointer"},children:" "})]})]})]}),$e==="TRIPLE"&&Y.jsxs(Y.Fragment,{children:[Y.jsxs("div",{style:{background:"rgba(255,255,255,0.06)",borderRadius:12,padding:12,marginBottom:12},children:[Y.jsx("div",{style:{fontWeight:900,marginBottom:6},children:" 1:  "}),Y.jsx("div",{style:{fontWeight:800,marginBottom:8},children:""}),Y.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[Y.jsx("input",{type:"range",min:0,max:1,step:.01,value:Kl,onChange:Q=>Jl(parseFloat(Q.target.value)),style:{flex:1}}),Y.jsx("input",{type:"number",min:0,max:100,value:Math.round(Kl*100),onChange:Q=>{const Qe=Math.max(0,Math.min(100,Number(Q.target.value||0)));Jl(Qe/100)},style:{width:80,padding:"8px 10px",borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:"rgba(255,255,255,0.06)",color:"#e8eefc",fontWeight:900,direction:"ltr"},title:" "})]}),Y.jsxs("div",{style:{display:"flex",gap:10,marginTop:12},children:[Y.jsx("button",{onClick:()=>Ql(Q=>Q+1),disabled:!us||Js,style:{flex:1,padding:"10px 12px",borderRadius:12,border:"1px solid rgba(255,255,255,0.15)",background:us?"rgba(140,203,255,0.22)":"rgba(255,255,255,0.06)",color:"#e8eefc",cursor:us?"pointer":"not-allowed",fontWeight:900,opacity:Js?.75:1},title:us?" ":"     ",children:Js?"":""}),Y.jsx("button",{onClick:vu,style:{flex:1,padding:"10px 12px",borderRadius:12,border:"1px solid rgba(255,255,255,0.15)",background:"transparent",color:"#e8eefc",cursor:"pointer",fontWeight:900},title:"   /",children:" "})]}),Y.jsxs("div",{style:{fontSize:12,opacity:.75,marginTop:10,lineHeight:1.35},children:["   ",Y.jsx("b",{children:""}),"  (A/B/C)  ."]})]}),Y.jsxs("div",{style:{background:"rgba(255,255,255,0.06)",borderRadius:12,padding:12,marginBottom:12},children:[Y.jsx("div",{style:{fontWeight:900,marginBottom:6},children:" 2:  "}),Y.jsx("div",{style:{fontSize:12,opacity:.8,marginBottom:10},children:"  (1/2/3 + )    ."}),Y.jsx("div",{style:{fontWeight:800,marginBottom:8},children:" "}),Y.jsx("div",{style:{display:"flex",gap:10,marginBottom:4},children:[{id:"A",label:" "},{id:"B",label:" "},{id:"C",label:" "}].map(Q=>Y.jsx("button",{onClick:()=>uh(Q.id),style:{flex:1,padding:"10px 12px",borderRadius:12,border:"1px solid rgba(255,255,255,0.15)",background:Ia===Q.id?"rgba(30,78,216,0.22)":"transparent",color:"#e8eefc",cursor:"pointer",fontWeight:900},title:"       ",children:Q.label},Q.id))})]}),Y.jsxs("div",{style:{background:"rgba(255,255,255,0.06)",borderRadius:12,padding:12,marginBottom:12},children:[Y.jsx("div",{style:{fontWeight:900,marginBottom:6},children:" 3:  "}),Y.jsxs("div",{style:{display:"flex",gap:10,marginBottom:12},children:[Y.jsx("button",{onClick:()=>{ws.current.A.length>=2&&ws.current.B.length>=2&&ws.current.C.length>=2&&tc(Qe=>!Qe)},disabled:Js,style:{flex:1,padding:"10px 12px",borderRadius:12,border:"1px solid rgba(255,255,255,0.15)",background:Qi?"rgba(255,255,255,0.12)":"transparent",color:"#e8eefc",cursor:Js?"not-allowed":"pointer",fontWeight:900,opacity:Js?.7:1},title:" :      / ",children:Qi?" ":" "}),Y.jsx("button",{onClick:il,disabled:!Qi,style:{flex:1,padding:"10px 12px",borderRadius:12,border:"1px solid rgba(255,255,255,0.15)",background:"transparent",color:"#e8eefc",cursor:Qi?"pointer":"not-allowed",fontWeight:900,opacity:Qi?1:.6},title:"     ",children:"  "})]}),Qi&&Y.jsxs(Y.Fragment,{children:[Y.jsx("div",{style:{fontSize:12,opacity:.8,marginBottom:10,lineHeight:1.4},children:" :     .    / ,        ."}),Y.jsxs("div",{style:{display:"flex",gap:10,marginBottom:2},children:[Y.jsx("button",{onClick:to,disabled:wo<=0,style:{flex:1,padding:"10px 12px",borderRadius:12,border:"1px solid rgba(255,255,255,0.15)",background:"transparent",color:"#e8eefc",cursor:wo<=0?"not-allowed":"pointer",fontWeight:900,opacity:wo<=0?.55:1},title:"  ",children:""}),Y.jsx("button",{onClick:al,disabled:wo>=Oc.length-1,style:{flex:1,padding:"10px 12px",borderRadius:12,border:"1px solid rgba(255,255,255,0.15)",background:"transparent",color:"#e8eefc",cursor:wo>=Oc.length-1?"not-allowed":"pointer",fontWeight:900,opacity:wo>=Oc.length-1?.55:1},title:" ( )",children:""})]})]})]}),Y.jsxs("div",{style:{background:"rgba(255,255,255,0.06)",borderRadius:12,padding:12,marginBottom:12},children:[Y.jsx("div",{style:{fontWeight:900,marginBottom:4},children:" 4:    "}),Y.jsxs("div",{style:{fontSize:13,opacity:.85,marginBottom:12,lineHeight:1.4},children:["     .",Y.jsx("br",{}),": ",Y.jsx("b",{children:Xe.length})," , ",Y.jsx("b",{children:ot.length})," , ",Y.jsx("b",{children:mr.length})," , ",Y.jsx("b",{children:$n.length})," ."]}),Y.jsx("div",{style:{display:"flex",flexDirection:"column",gap:0},children:[{key:"traffic",title:" "},{key:"toll",title:" "},{key:"comm",title:""},{key:"park",title:""}].map((Q,Qe,ft)=>Y.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px 0",borderBottom:Qe<ft.length-1?"1px solid rgba(255,255,255,0.1)":"none"},children:[Y.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[Y.jsxs("div",{style:{width:24,display:"flex",justifyContent:"center",alignItems:"center"},children:[Q.key==="traffic"&&Y.jsx("svg",{width:"24",height:"6",viewBox:"0 0 24 6",children:Y.jsx("line",{x1:"0",y1:"3",x2:"24",y2:"3",stroke:"#ef4444",strokeWidth:"3",strokeDasharray:"4 2"})}),Q.key==="toll"&&Y.jsxs("div",{style:{position:"relative",width:24,height:16,display:"flex",alignItems:"center",justifyContent:"center"},children:[Y.jsx("div",{style:{position:"absolute",top:2,width:"100%",height:2,background:"#fbbf24"}}),Y.jsx("div",{style:{position:"absolute",bottom:2,width:"100%",height:2,background:"#fbbf24"}}),Y.jsx("div",{style:{zIndex:1,width:14,height:14,borderRadius:"50%",background:"#fbbf24",border:"1px solid rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",color:"black",fontSize:9,fontWeight:"bold",lineHeight:1,fontFamily:"Arial, sans-serif"},children:""})]}),Q.key==="comm"&&Y.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 18 18",children:[Y.jsx("circle",{cx:"9",cy:"9",r:"6",stroke:"#a855f7",strokeWidth:"2",fill:"none"}),Y.jsx("circle",{cx:"9",cy:"9",r:"2",fill:"#a855f7"})]}),Q.key==="park"&&Y.jsx("svg",{width:"18",height:"18",viewBox:"0 0 18 18",children:Y.jsx("rect",{x:"2",y:"2",width:"14",height:"14",rx:"2",fill:"#c7e6c5",stroke:"#2e7d32",strokeWidth:"2"})})]}),Y.jsx("div",{style:{fontWeight:800,fontSize:14},children:Q.title})]}),Y.jsxs("div",{style:{display:"flex",gap:8},children:[Y.jsx("button",{onClick:()=>{if(Ti(null),Ji([]),ls(null),Q.key!=="park"&&Ra(!1),Q.key==="park"){Ki(null),Ra(!1);const Ht=!Ea;Ii(Ht),Ht&&(Ls([]),Qo.current=null,tn("  :   , - ."));return}Ii(!1),Ki(Q.key),tn(Q.key==="comm"?" :   .":" :    .")},style:{padding:"6px 10px",borderRadius:8,border:"1px solid rgba(255,255,255,0.15)",background:Q.key==="park"&&Ea?"rgba(46,204,113,0.25)":"rgba(17, 134, 255, 0.2)",color:"white",fontSize:13,fontWeight:700,cursor:"pointer"},children:Q.key==="park"&&Ea?"":""}),Q.key==="park"&&Y.jsx("button",{onClick:()=>{const Ht=!ja;Ra(Ht),Ii(!1),Ti(null),Ki(null),Ht&&tn("       .")},style:{padding:"6px 10px",borderRadius:8,border:"1px solid rgba(255,255,255,0.15)",background:ja?"rgba(245, 158, 11, 0.4)":"rgba(255,255,255,0.05)",color:"white",fontSize:13,fontWeight:700,cursor:"pointer"},title:"      ",children:ja?"":""}),Y.jsx("button",{onClick:()=>{Ki(null),Ji([]),ls(null),Ii(!1),Ra(!1),Ti(Ht=>Ht===Q.key?null:Q.key),tn(" :    .")},style:{padding:"6px 10px",borderRadius:8,border:"1px solid rgba(255,255,255,0.15)",background:Cl===Q.key?"rgba(255, 80, 80, 0.4)":"rgba(255,255,255,0.05)",color:"white",fontSize:13,fontWeight:700,cursor:"pointer"},children:Cl===Q.key?"":""})]})]},Q.key))}),Y.jsxs("div",{style:{marginTop:12,paddingTop:12,borderTop:"1px solid rgba(255,255,255,0.15)",display:"flex",gap:10},children:[Y.jsx("button",{onClick:()=>{window.confirm("     ?")&&(xt([]),it([]),kr([]),ei([]),Ki(null),Ti(null),Ji([]),ls(null),Ii(!1),tn("  ."))},style:{flex:1,padding:"8px",borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:"rgba(255, 80, 80, 0.15)",color:"#ffcccc",fontSize:13,fontWeight:700,cursor:"pointer"},children:" "}),Y.jsx("button",{onClick:()=>{Ki(null),Ti(null),Ji([]),ls(null),Ii(!1),tn("  .")},style:{flex:1,padding:"8px",borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:"rgba(255,255,255,0.05)",color:"white",fontSize:13,fontWeight:700,cursor:"pointer"},children:" "})]})]}),Y.jsxs("div",{children:[Y.jsxs("div",{style:{background:"rgba(255,255,255,0.06)",borderRadius:12,padding:12,marginBottom:12},children:[Y.jsx("div",{style:{fontWeight:900,marginBottom:8},children:" 5:     "}),Y.jsxs("div",{style:{fontSize:13,opacity:.92,lineHeight:1.45},children:["      (/).",Y.jsx("b",{children:"      "}),'       5.      6 ("").']}),Y.jsxs("div",{style:{display:"grid",gridTemplateColumns:"minmax(0,1fr) minmax(0,1fr)",gap:10,marginTop:10},children:[Y.jsxs("div",{children:[Y.jsx("div",{style:{fontSize:12,opacity:.85,marginBottom:4},children:" "}),Y.jsx("select",{value:Qt,onChange:Q=>ye(Q.target.value),style:{width:"100%",padding:8,borderRadius:10,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(0,0,0,0.25)",color:"white"},children:Bn.map(Q=>Y.jsx("option",{value:Q,children:Q},Q))})]}),Y.jsxs("div",{children:[Y.jsx("div",{style:{fontSize:12,opacity:.85,marginBottom:4},children:"  "}),Y.jsx("select",{value:je,onChange:Q=>Le(Q.target.value),style:{width:"100%",padding:8,borderRadius:10,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(0,0,0,0.25)",color:"white"},children:ba.map(Q=>Y.jsx("option",{value:Q,children:Q},Q))})]}),Y.jsxs("div",{children:[Y.jsx("div",{style:{fontSize:12,opacity:.85,marginBottom:4},children:"  ()"}),Y.jsxs("select",{value:Me,onChange:Q=>Te(Q.target.value),style:{width:"100%",padding:8,borderRadius:10,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(0,0,0,0.25)",color:"white"},children:[Y.jsx("option",{value:"None",children:"None"}),Bn.map(Q=>Y.jsx("option",{value:Q,children:Q},Q))]})]}),Y.jsxs("div",{children:[Y.jsx("div",{style:{fontSize:12,opacity:.85,marginBottom:4},children:" "}),Y.jsxs("select",{value:oi,onChange:Q=>Di(Q.target.value),style:{width:"100%",padding:8,borderRadius:10,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(0,0,0,0.25)",color:"white"},children:[Y.jsx("option",{value:"",children:"  "}),Y.jsx("option",{value:"",children:" ()"})]})]})]}),Y.jsxs("div",{style:{display:"grid",gridTemplateColumns:"minmax(0,1fr) minmax(0,1fr)",gap:10,marginTop:10},children:[Y.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[Y.jsx("input",{type:"checkbox",checked:Pe,onChange:Q=>gt(Q.target.checked)}),Y.jsx("div",{style:{fontSize:13,whiteSpace:"nowrap"},children:"   ( )"})]}),Y.jsx("div",{}),Y.jsxs("div",{style:{opacity:Pe?1:.5},children:[Y.jsx("div",{style:{fontSize:12,opacity:.85,marginBottom:4},children:" "}),Y.jsx("select",{disabled:!Pe,value:jt,onChange:Q=>Dt(Q.target.value),style:{width:"100%",padding:8,borderRadius:10,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(0,0,0,0.25)",color:"white"},children:Bn.map(Q=>Y.jsx("option",{value:Q,children:Q},Q))})]}),Y.jsxs("div",{style:{opacity:Pe?1:.5},children:[Y.jsx("div",{style:{fontSize:12,opacity:.85,marginBottom:4},children:" "}),Y.jsxs("select",{disabled:!Pe,value:At,onChange:Q=>_t(parseInt(Q.target.value,10)),style:{width:"100%",padding:8,borderRadius:10,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(0,0,0,0.25)",color:"white"},children:[Y.jsx("option",{value:1,children:" 1"}),Y.jsx("option",{value:2,children:" 2"}),Y.jsx("option",{value:3,children:" 3"})]})]})]}),Y.jsxs("div",{style:{display:"grid",gridTemplateColumns:"minmax(0,1fr) minmax(0,1fr)",gap:10,marginTop:10},children:[Y.jsxs("div",{children:[Y.jsx("div",{style:{fontSize:12,opacity:.85,marginBottom:4},children:"Desired discriminability"}),Y.jsx("select",{value:or,onChange:Q=>yr(Q.target.value),style:{width:"100%",padding:8,borderRadius:10,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(0,0,0,0.25)",color:"white"},children:El.map(Q=>Y.jsx("option",{value:Q,children:Q},Q))})]}),Y.jsxs("div",{children:[Y.jsx("div",{style:{fontSize:12,opacity:.85,marginBottom:4},children:"Scoring mode"}),Y.jsx("select",{value:vr,onChange:Q=>fr(Q.target.value),style:{width:"100%",padding:8,borderRadius:10,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(0,0,0,0.25)",color:"white"},children:Zo.map(Q=>Y.jsx("option",{value:Q,children:Q},Q))})]})]}),Y.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:10,marginTop:10,alignItems:"end"},children:[Y.jsxs("div",{children:[Y.jsx("div",{style:{fontSize:12,opacity:.85,marginBottom:4},children:" "}),Y.jsx("input",{type:"number",value:_r,onChange:Q=>Ur(parseFloat(Q.target.value||"0")),style:{width:"80%",padding:8,borderRadius:10,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(0,0,0,0.25)",color:"white"}})]}),Y.jsxs("div",{children:[Y.jsx("div",{style:{fontSize:12,opacity:.85,marginBottom:4},children:" "}),Y.jsx("input",{type:"number",value:Tn,onChange:Q=>vn(parseFloat(Q.target.value||"0")),style:{width:"80%",padding:8,borderRadius:10,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(0,0,0,0.25)",color:"white"}})]}),Y.jsxs("div",{children:[Y.jsx("div",{style:{fontSize:12,opacity:.85,marginBottom:4},children:" "}),Y.jsx("input",{type:"number",value:Zr,onChange:Q=>Mi(parseFloat(Q.target.value||"0")),style:{width:"80%",padding:8,borderRadius:10,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(0,0,0,0.25)",color:"white"}})]})]}),Y.jsxs("div",{style:{display:"grid",gridTemplateColumns:"minmax(0,1fr) minmax(0,1fr)",gap:10,marginTop:10},children:[Y.jsxs("div",{children:[Y.jsx("div",{style:{fontSize:12,opacity:.85,marginBottom:4},children:"Gate threshold (0..1)"}),Y.jsx("input",{type:"number",step:.1,min:0,max:1,value:pi,onChange:Q=>bi(parseFloat(Q.target.value||"0")),style:{width:"80%",padding:8,borderRadius:10,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(0,0,0,0.25)",color:"white"}})]}),Y.jsxs("div",{children:[Y.jsx("div",{style:{fontSize:12,opacity:.85,marginBottom:4},children:"  ()"}),Y.jsxs("select",{value:wi,onChange:Q=>bs(Q.target.value),style:{width:"80%",padding:8,borderRadius:10,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(0,0,0,0.25)",color:"white"},children:[Y.jsx("option",{value:"Auto",children:"Auto"}),Y.jsx("option",{value:"A",children:"A"}),Y.jsx("option",{value:"B",children:"B"}),Y.jsx("option",{value:"C",children:"C"})]})]})]})]}),Y.jsxs("div",{style:{marginTop:10,marginBottom:10,padding:"12px 10px",background:"rgba(255,255,255,0.03)",borderRadius:10,border:"1px rgba(255,255,255,0.15)",width:"100%",boxSizing:"border-box"},children:[Y.jsx("div",{style:{fontWeight:800,fontSize:13,marginBottom:12,color:"#cbd5e1"},children:"  "}),Y.jsxs("div",{style:{marginBottom:10},children:[Y.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:12,marginBottom:4},children:[Y.jsx("span",{style:{opacity:.8},children:"  ()"}),Y.jsx("span",{style:{fontWeight:700},children:C})]}),Y.jsx("input",{type:"range",min:0,max:1,step:.1,value:C,onChange:Q=>M(parseFloat(Q.target.value)),style:{width:"100%",cursor:"pointer",height:6}})]}),Y.jsxs("div",{style:{marginBottom:12},children:[Y.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:12,marginBottom:4},children:[Y.jsx("span",{style:{opacity:.8},children:"    "}),Y.jsx("input",{type:"number",value:D,onChange:Q=>B(Number(Q.target.value)),style:{width:40,background:"rgba(0,0,0,0.3)",border:"1px solid #555",color:"white",borderRadius:4,textAlign:"center",fontSize:12}})]}),Y.jsx("div",{style:{fontSize:10,opacity:.5},children:". ( =   ,   )"})]}),Y.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:12},children:[Y.jsx("input",{type:"checkbox",id:"chkKeepManual",checked:U,onChange:Q=>j(Q.target.checked),style:{cursor:"pointer"}}),Y.jsx("label",{htmlFor:"chkKeepManual",style:{fontSize:12,cursor:"pointer",opacity:.8},children:"  "})]}),Y.jsx("button",{onClick:fh,disabled:!He,style:{width:"100%",padding:"10px",borderRadius:8,border:"1px solid rgba(147, 51, 234, 0.4)",background:He?"rgba(147, 51, 234, 0.15)":"rgba(255,255,255,0.05)",color:"#e8eefc",cursor:He?"pointer":"not-allowed",fontWeight:800,fontSize:14,transition:"all 0.2s"},children:"    "})]}),Y.jsxs("div",{style:{background:"rgba(255,255,255,0.06)",borderRadius:12,padding:12,marginBottom:20},children:[Y.jsx("div",{style:{fontWeight:900,marginBottom:6},children:" 6:  "}),Y.jsx("div",{style:{fontSize:13,opacity:.85,marginBottom:12},children:"  .      ."}),Y.jsxs("div",{style:{display:"flex",gap:10,marginBottom:12},children:[Y.jsx("button",{onClick:()=>{const Q=u.current;if(Q){const Qe=U0(Q,ha.current,Xe,ot,mr,mi.current);En(Qe),setTimeout(()=>Bc(),50)}Qr(!Kn)},disabled:!He,style:{flex:1,padding:"10px",borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:Kn?"rgba(34, 197, 94, 0.2)":"rgba(255,255,255,0.06)",color:Kn?"#4ade80":"#e8eefc",cursor:He?"pointer":"not-allowed",fontWeight:900,fontSize:14,transition:"all 0.2s"},children:Kn?" ":" "}),Y.jsx("button",{onClick:()=>{if(ht.length===0){const Q=u.current;if(Q){const Qe=U0(Q,ha.current,Xe,ot,mr,mi.current);En(Qe),setTimeout(()=>Bc(),50)}}Dc(!0)},disabled:!He,style:{flex:.4,padding:"10px",borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:"rgba(255,255,255,0.04)",color:"#e8eefc",cursor:He?"pointer":"not-allowed",fontWeight:900,fontSize:14,opacity:He?1:.5},children:" "})]}),bn&&Y.jsxs("div",{style:{padding:"10px",borderRadius:8,background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",marginBottom:12,animation:"fadeIn 0.5s ease-out"},children:[Y.jsxs("div",{style:{fontWeight:900,color:"#4ade80",fontSize:14,marginBottom:2},children:[" :  ",bn==="A"?"":bn==="B"?"":""]}),Y.jsx("div",{style:{fontSize:11,opacity:.8},children:kc})]}),Kn&&ht.length>0&&Y.jsxs("div",{style:{marginTop:0,paddingTop:12,borderTop:"1px solid rgba(255,255,255,0.1)",animation:"fadeIn 0.3s ease-in-out"},children:[Y.jsx("div",{style:{overflowX:"auto"},children:Y.jsxs("table",{style:{width:"100%",fontSize:11,borderCollapse:"collapse",textAlign:"right"},children:[Y.jsx("thead",{children:Y.jsxs("tr",{style:{color:"#94a3b8"},children:[Y.jsx("th",{style:{padding:4},children:""}),Y.jsx("th",{style:{padding:4},children:'"'}),Y.jsx("th",{style:{padding:4},children:""}),Y.jsx("th",{style:{padding:4},children:""})]})}),Y.jsx("tbody",{children:ht.map(Q=>Y.jsxs("tr",{style:{borderTop:"1px solid rgba(255,255,255,0.05)"},children:[Y.jsx("td",{style:{padding:"6px 4px",fontWeight:800},children:Q.route==="A"?"":Q.route==="B"?"":""}),Y.jsx("td",{style:{padding:4},children:(Q.totalLengthM/1e3).toFixed(1)}),Y.jsx("td",{style:{padding:4,color:"#fbbf24",fontWeight:700},children:(Q.totalTimeS/60).toFixed(0)}),Y.jsx("td",{style:{padding:4},children:Math.round((Q.segments.reduce((Qe,ft)=>Qe+ft.speedScore,0)/3+Q.segments.reduce((Qe,ft)=>Qe+ft.economyScore,0)/3)/2)})]},Q.route))})]})}),Y.jsx("div",{style:{marginTop:8,fontSize:11,opacity:.5,textAlign:"center"},children:' ,   " CSV" .'})]})]})]}),Da&&Y.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.55)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center",padding:16,fontFamily:"Arial, sans-serif",direction:"rtl"},onMouseDown:()=>Ri(!1),children:Y.jsxs("div",{style:{width:720,maxWidth:"100%",maxHeight:"90vh",overflow:"auto",background:"#0b0f17",border:"1px solid rgba(255,255,255,0.15)",borderRadius:14,boxShadow:"0 16px 40px rgba(0,0,0,0.45)",padding:14},onMouseDown:Q=>Q.stopPropagation(),children:[Y.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:10,marginBottom:10},children:[Y.jsx("div",{style:{fontWeight:900,fontSize:16},children:"   "}),Y.jsx("button",{onClick:()=>Ri(!1),style:{border:"1px solid rgba(255,255,255,0.15)",background:"rgba(255,255,255,0.06)",color:"#e8eefc",borderRadius:10,padding:"8px 10px",cursor:"pointer",fontWeight:900},title:"",children:""})]}),Y.jsxs("div",{style:{fontSize:12,opacity:.8,marginBottom:10},children:["  ,     ",Y.jsx("b",{children:" "}),".     . : ",Y.jsx("b",{children:Xe.length})," , ",Y.jsx("b",{children:ot.length})," , ",Y.jsx("b",{children:mr.length}),"  , ",Y.jsx("b",{children:$n.length})," ."]}),Y.jsxs("div",{style:{marginTop:12,paddingTop:10,borderTop:"1px solid rgba(255,255,255,0.12)"},children:[Y.jsx("div",{style:{fontWeight:800,marginBottom:8,textAlign:"right"},children:" "}),Y.jsx("button",{onClick:()=>{const Q=!Ea;Ii(Q),Q?(Ls([]),Qo.current=null):(Ls([]),Qo.current=null)},disabled:!He,style:{width:"100%",padding:"10px 12px",marginTop:6,borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:Ea?"rgba(46,204,113,0.25)":"rgba(255,255,255,0.06)",color:"#e8eefc",cursor:He?"pointer":"not-allowed",textAlign:"right",fontWeight:900},title:He?Ea?"   (  , ESC )":"   ":"      ",children:Ea?" ":" "}),Y.jsx("button",{onClick:()=>Fn(),disabled:$n.length===0&&Ic.length===0,style:{width:"100%",padding:"10px 12px",marginTop:8,borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:"rgba(255,255,255,0.06)",color:"#e8eefc",cursor:$n.length===0&&Ic.length===0?"not-allowed":"pointer",textAlign:"right",fontWeight:900},children:"  "}),Ea&&Y.jsx("div",{style:{marginTop:8,fontSize:12,opacity:.85,textAlign:"right",lineHeight:1.5},children:":    :    Delete:    ESC: "})]})]})})]}),$e==="SINGLE"&&Y.jsxs("div",{style:{background:"rgba(255,255,255,0.06)",borderRadius:12,padding:12,marginBottom:12},children:[Y.jsx("div",{style:{fontWeight:900,marginBottom:6},children:" "}),Y.jsx("div",{style:{fontSize:13,opacity:.85,marginBottom:10},children:"   waypoint.    OSRM.      (fallback)."}),If&&Y.jsx("div",{style:{marginTop:10,fontSize:13,fontWeight:900},children:" "}),Y.jsxs("div",{style:{marginTop:10,fontSize:13},children:["Waypoints: ",Y.jsx("b",{children:Fi.length})]}),Y.jsxs("div",{style:{marginTop:6,fontSize:13},children:[" : ",Y.jsx("b",{children:ox(Hh)})]}),Y.jsx("button",{onClick:lh,style:{marginTop:10,width:"100%",padding:"10px 12px",borderRadius:12,border:"1px solid rgba(255,255,255,0.15)",background:"transparent",color:"#e8eefc",cursor:"pointer",fontWeight:900},children:"  "})]}),$e==="MEASURE"&&Y.jsxs("div",{style:{background:"rgba(255,255,255,0.06)",borderRadius:12,padding:12,marginBottom:12},children:[Y.jsx("div",{style:{fontWeight:900,marginBottom:6},children:""}),Y.jsx("div",{style:{fontSize:13,opacity:.85,marginBottom:10},children:"    ( )."}),Y.jsxs("div",{style:{fontSize:13},children:[": ",Y.jsx("b",{children:ti.length})]}),Y.jsxs("div",{style:{marginTop:6,fontSize:13},children:[": ",Y.jsx("b",{children:ox(ya)})]}),Y.jsx("button",{onClick:Nc,style:{marginTop:10,width:"100%",padding:"10px 12px",borderRadius:12,border:"1px solid rgba(255,255,255,0.15)",background:"transparent",color:"#e8eefc",cursor:"pointer",fontWeight:900},children:" "})]}),Y.jsxs("div",{style:{background:"rgba(255,255,255,0.06)",borderRadius:12,padding:12,marginBottom:12},children:[Y.jsx("div",{style:{fontWeight:900,marginBottom:6},children:" "}),Y.jsxs("div",{style:{fontSize:13,opacity:.85,marginBottom:10,lineHeight:1.45},children:["  ",Y.jsx("b",{children:"HTML"}),"     ( +   +  )."]}),Y.jsx("button",{onClick:()=>{go(bn||"A"),Cc(!0)},style:{width:"100%",padding:"10px 12px",borderRadius:12,border:"1px solid rgba(255,255,255,0.15)",background:"rgba(140,203,255,0.18)",color:"#e8eefc",cursor:"pointer",fontWeight:900,textAlign:"center",fontFamily:"Arial, sans-serif "},children:"  "}),ln&&Y.jsxs("div",{style:{marginTop:10,fontSize:12,opacity:.8,lineHeight:1.4},children:[" : ",Y.jsx("b",{children:ln})]})]}),uu&&Y.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,fontFamily:"Arial, sans-serif"},onMouseDown:()=>Cc(!1),children:Y.jsxs("div",{style:{width:720,maxWidth:"92vw",maxHeight:"92vh",overflowY:"auto",overflowX:"hidden",background:"#0b0f17",border:"1px solid rgba(255,255,255,0.14)",borderRadius:16,padding:14,direction:"rtl"},onMouseDown:Q=>Q.stopPropagation(),children:[Y.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12,marginBottom:12},children:[Y.jsx("div",{style:{fontWeight:900,fontSize:16},children:"  "}),Y.jsx("button",{onClick:()=>Cc(!1),style:{padding:"8px 10px",borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:"rgba(255,255,255,0.06)",color:"#e8eefc",cursor:"pointer",fontWeight:900},children:""})]}),Y.jsxs("div",{style:{display:"grid",gap:12},children:[Y.jsxs("div",{children:[Y.jsx("div",{style:{fontWeight:800,marginBottom:6},children:" "}),Y.jsx("input",{maxLength:120,value:Na,onChange:Q=>Mc(Q.target.value),style:{width:"96%",padding:"10px 12px",borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:"rgba(0,0,0,0.25)",color:"#e8eefc",outline:"none",fontFamily:"Arial, sans-serif",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}})]}),Y.jsxs("div",{children:[Y.jsx("div",{style:{fontWeight:800,marginBottom:6},children:" "}),Y.jsx("textarea",{maxLength:1200,value:Wl,onChange:Q=>hu(Q.target.value),rows:4,style:{width:"96%",padding:"10px 12px",borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:"rgba(0,0,0,0.25)",color:"#e8eefc",outline:"none",resize:"vertical",fontFamily:"Arial, sans-serif",lineHeight:1.4}})]}),Y.jsxs("div",{children:[Y.jsx("div",{style:{fontWeight:800,marginBottom:6},children:" ( )"}),Y.jsx("textarea",{maxLength:1200,value:mo,onChange:Q=>Df(Q.target.value),rows:3,placeholder:"  /        ()",style:{width:"96%",padding:"10px 12px",borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:"rgba(0,0,0,0.25)",color:"#e8eefc",outline:"none",resize:"vertical",fontFamily:"Arial, sans-serif",lineHeight:1.4}})]}),Y.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[Y.jsxs("div",{style:{marginBottom:16},children:[Y.jsx("label",{style:{display:"block",marginBottom:8,fontSize:14,fontWeight:600},children:"  :"}),Y.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8,background:"rgba(0,0,0,0.2)",padding:10,borderRadius:8},children:[Y.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer",fontWeight:"bold",paddingBottom:6,borderBottom:"1px solid rgba(255,255,255,0.1)"},children:[Y.jsx("input",{type:"checkbox",checked:p.STACKED&&p.RADAR&&p.HEATMAP,onChange:Q=>{const Qe=Q.target.checked;b({STACKED:Qe,RADAR:Qe,HEATMAP:Qe})},style:{marginLeft:8}}),"  (All)"]}),Y.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[Y.jsx("input",{type:"checkbox",checked:p.STACKED,onChange:Q=>b(Qe=>({...Qe,STACKED:Q.target.checked})),style:{marginLeft:8}}),"  (Stacked) -  S"]}),Y.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[Y.jsx("input",{type:"checkbox",checked:p.RADAR,onChange:Q=>b(Qe=>({...Qe,RADAR:Q.target.checked})),style:{marginLeft:8}}),"  (Radar) -  R"]}),Y.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[Y.jsx("input",{type:"checkbox",checked:p.HEATMAP,onChange:Q=>b(Qe=>({...Qe,HEATMAP:Q.target.checked})),style:{marginLeft:8}})," (Table) -  H"]})]})]}),Y.jsxs("div",{style:{flex:1,minWidth:220},children:[Y.jsx("div",{style:{fontWeight:800,marginBottom:6},children:" "}),Y.jsxs("select",{value:$o,onChange:Q=>go(Q.target.value),style:{width:"100%",padding:"10px 12px",borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:"rgba(0,0,0,0.25)",color:"#e8eefc",outline:"none",fontFamily:"Arial, sans-serif"},children:[Y.jsx("option",{value:"A",style:{background:"#1e293b",color:"#e8eefc"},children:" "}),Y.jsx("option",{value:"B",style:{background:"#1e293b",color:"#e8eefc"},children:" "}),Y.jsx("option",{value:"C",style:{background:"#1e293b",color:"#e8eefc"},children:" "})]})]})]}),Y.jsxs("div",{children:[Y.jsx("div",{style:{fontWeight:800,marginBottom:6},children:" "}),Y.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:10,alignItems:"center",padding:"10px 12px",borderRadius:10,border:"1px solid rgba(255,255,255,0.12)",background:"rgba(255,255,255,0.04)"},children:[Y.jsx("div",{style:{minWidth:0},children:Y.jsx("input",{value:Al,onChange:Q=>Ko(Q.target.value),style:{width:"90%",padding:"10px 12px",borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:"rgba(0,0,0,0.25)",color:"#e8eefc",outline:"none",fontFamily:"Arial, sans-serif"},placeholder:"C\\\\Users\\\\...\\\\Downloads"})}),Y.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap"},children:[Y.jsx("button",{onClick:bu,style:{padding:"8px 10px",borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:"rgba(255,255,255,0.06)",color:"#e8eefc",cursor:"pointer",fontWeight:900,fontFamily:"Arial, sans-serif"},children:" "}),Y.jsx("button",{onClick:Rl,style:{padding:"8px 10px",borderRadius:10,border:"1px solid rgba(255,255,255,0.15)",background:"transparent",color:"#e8eefc",cursor:"pointer",fontWeight:900,fontFamily:"Arial, sans-serif"},children:" "})]})]}),Y.jsx("div",{style:{marginTop:8,fontSize:12,opacity:.75,lineHeight:1.4},children:":           .   /   ,     ( )   Downloads."})]}),Y.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",marginTop:2},children:[Y.jsx("button",{onClick:()=>{As()},style:{flex:1,minWidth:180,padding:"10px 12px",borderRadius:12,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(140,203,255,0.18)",color:"#e8eefc",cursor:"pointer",fontWeight:900,fontFamily:"Arial, sans-serif"},children:"   (HTML)"}),Y.jsxs("button",{onClick:dn,disabled:!He,style:{flex:1,minWidth:180,padding:"10px 12px",borderRadius:12,border:"1px solid rgba(255,255,255,0.18)",background:He?"rgba(34, 197, 94, 0.2)":"rgba(255,255,255,0.05)",color:He?"#4ade80":"rgba(255,255,255,0.4)",cursor:He?"pointer":"not-allowed",fontWeight:900,fontFamily:"Arial, sans-serif",display:"flex",alignItems:"center",justifyContent:"center",gap:6},title:"     ",children:[Y.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[Y.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),Y.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),Y.jsx("polyline",{points:"7 3 7 8 15 8"})]}),"   (JSON)"]}),Y.jsx("button",{onClick:()=>Cc(!1),style:{flex:.5,minWidth:100,padding:"10px 12px",borderRadius:12,border:"1px solid rgba(255,255,255,0.18)",background:"transparent",color:"#e8eefc",cursor:"pointer",fontWeight:900,fontFamily:"Arial, sans-serif"},children:""})]}),ln&&Y.jsxs("div",{style:{marginTop:2,fontSize:12,opacity:.85},children:[" : ",Y.jsx("b",{children:ln})]})]})]})}),nh&&ht.length>0&&Y.jsx(CR,{open:nh,onClose:()=>Dc(!1),routeScores:ht,selectedRoute:Ia,onSelectRoute:uh}),Ln&&Y.jsx("div",{style:{position:"fixed",left:"50%",bottom:18,transform:"translateX(-50%)",background:"rgba(0,0,0,0.8)",color:"white",padding:"10px 14px",borderRadius:14,border:"1px solid rgba(255,255,255,0.18)",zIndex:2e4,maxWidth:"92vw",fontFamily:"Arial, sans-serif",direction:"rtl",textAlign:"center"},children:Ln}),Y.jsx("div",{style:{fontSize:12,opacity:.65},children:":   //       ."})]})]})}const PR=()=>{const[r,u]=ke.useState([]),[l,f]=ke.useState(!1),[p,b]=ke.useState([]),_=M=>b(D=>[`${new Date().toLocaleTimeString()}: ${M}`,...D]),s=M=>{if(M.target.files){const D=Array.from(M.target.files).filter(B=>B.name.toLowerCase().endsWith(".json"));u(D),_(` ${D.length}  JSON.`)}},C=async()=>{if(r.length===0){alert("     JSON ");return}f(!0);const M=new Tw;let D=1;try{const B=await fetch("/template.html");if(!B.ok)throw new Error("   template.html  public");const U=await B.text();if(!U.includes("/* DATA_INJECTION_POINT */"))throw new Error("   /* DATA_INJECTION_POINT */ .    template.html");const j=r.sort((O,N)=>O.name.localeCompare(N.name));for(const O of j){const N=await O.text();let Z;try{Z=JSON.parse(N)}catch{_(`  JSON  ${O.name}`);continue}const J=`SCN_${String(D).padStart(3,"0")}`,X=[{type:"T",label:"Technical"},{type:"R",label:"Realism"},{type:"S",label:"Schematic"}];for(const pe of X){const ge={scenarioName:J,originalFileName:O.name,vizType:pe.type,mapState:Z.mapState,routes:Z.routes,entities:Z.entities,task:Z.task,meta:Z.meta},re=`const DATA = ${JSON.stringify(ge,null,2)};`;let Ce=U.replace("/* DATA_INJECTION_POINT */",re);Ce=Ce.replace(/<title>.*?<\/title>/,`<title>${J}</title>`),M.file(`${J}_${pe.type}.html`,Ce)}_(`: ${J} (${O.name})`),D++}const H=await M.generateAsync({type:"blob"});Sw.saveAs(H,"Batch_Scenarios_Output.zip"),_("  !  .")}catch(B){console.error(B),_(`: ${B.message}`)}finally{f(!1)}};return Y.jsxs("div",{style:{padding:"20px",direction:"rtl",color:"#e2e8f0",maxWidth:"800px",margin:"0 auto"},children:[Y.jsx("h2",{style:{borderBottom:"2px solid #2563EB",paddingBottom:"10px"},children:"  "}),Y.jsxs("div",{style:{marginTop:"20px",background:"#1e293b",padding:"20px",borderRadius:"8px"},children:[Y.jsxs("div",{style:{background:"#334155",padding:"10px",borderRadius:"4px",marginBottom:"15px",fontSize:"14px",borderRight:"4px solid #F59E0B"},children:[Y.jsx("b",{children:" :"}),"   ",Y.jsx("code",{children:"template.html"}),"   ",Y.jsx("code",{children:"public"})," ."]}),Y.jsxs("div",{style:{marginBottom:"20px"},children:[Y.jsx("label",{style:{display:"block",marginBottom:"8px"},children:"    JSON:"}),Y.jsx("input",{type:"file",webkitdirectory:"true",multiple:!0,onChange:s,style:{width:"100%",padding:"10px",background:"#0f172a",border:"1px solid #334155",borderRadius:"4px",color:"white"}})]}),Y.jsx("button",{onClick:C,disabled:l||r.length===0,style:{width:"100%",padding:"15px",background:l?"#475569":"#2563EB",color:"white",fontWeight:"bold",border:"none",borderRadius:"8px",cursor:l?"not-allowed":"pointer"},children:l?"...":"   ZIP"}),Y.jsx("div",{style:{marginTop:"20px",background:"#0f172a",padding:"10px",borderRadius:"4px",height:"200px",overflowY:"auto",fontFamily:"monospace",fontSize:"12px",border:"1px solid #334155"},children:p.map((M,D)=>Y.jsx("div",{children:M},D))})]})]})};function FR(){const[r,u]=ke.useState(!1),l=()=>u(!r),f=()=>u(!1);return Y.jsxs("div",{style:{height:"100vh",display:"flex",flexDirection:"column",background:"#0b0f17",color:"#e2e8f0",fontFamily:"Arial, sans-serif"},children:[Y.jsxs("header",{style:{height:"40px",display:"flex",alignItems:"center",padding:"0 15px",background:"#1e293b",borderBottom:"1px solid #334155",flexShrink:0,position:"relative",zIndex:1e3,direction:"rtl"},children:[Y.jsx("button",{onClick:l,style:{background:"transparent",border:"none",color:"#fff",fontSize:"24px",cursor:"pointer",padding:"0",lineHeight:"1",marginLeft:"15px"},title:" ",children:""}),Y.jsx("h1",{style:{margin:0,fontSize:"18px",fontWeight:"bold",letterSpacing:"1px"},children:"GeoVisLab"}),r&&Y.jsxs(Y.Fragment,{children:[Y.jsx("div",{onClick:f,style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:1001}}),Y.jsxs("nav",{style:{position:"absolute",top:"45px",right:"10px",width:"270px",background:"#334155",border:"1px solid #475569",borderRadius:"8px",boxShadow:"0 10px 25px rgba(0,0,0,0.5)",display:"flex",flexDirection:"column",zIndex:1002,overflow:"hidden",direction:"rtl"},children:[Y.jsx(G0,{to:"/",onClick:f,style:{padding:"15px",color:"white",textDecoration:"none",borderBottom:"1px solid #475569",transition:"background 0.2s",textAlign:"right"},onMouseOver:p=>p.currentTarget.style.background="#475569",onMouseOut:p=>p.currentTarget.style.background="transparent",children:"  "}),Y.jsx(G0,{to:"/manage-exports",onClick:f,style:{padding:"15px",color:"white",textDecoration:"none",borderBottom:"1px solid #475569",textAlign:"right"},onMouseOver:p=>p.currentTarget.style.background="#475569",onMouseOut:p=>p.currentTarget.style.background="transparent",children:"   "}),Y.jsx(G0,{to:"/batch-generator",onClick:f,style:{padding:"15px",color:"white",textDecoration:"none",borderBottom:"1px solid #475569",textAlign:"right"},onMouseOver:p=>p.currentTarget.style.background="#475569",onMouseOut:p=>p.currentTarget.style.background="transparent",children:"   (JSON to HTML)"}),Y.jsx(G0,{to:"/https://www.youtube.com/results?search_query=rick+roll+1000+hours",onClick:f,style:{padding:"15px",color:"white",textDecoration:"none"},onMouseOver:p=>p.currentTarget.style.background="#475569",onMouseOut:p=>p.currentTarget.style.background="transparent",children:" "})]})]})]}),Y.jsx("main",{style:{flex:1,overflow:"hidden",position:"relative"},children:Y.jsxs(aS,{children:[Y.jsx(fx,{path:"/",element:Y.jsx(IR,{})}),Y.jsx(fx,{path:"/manage-exports",element:Y.jsx(GD,{})}),Y.jsx(fx,{path:"/batch-generator",element:Y.jsx(PR,{})})]})})]})}sT.createRoot(document.getElementById("root")).render(Y.jsx(Jw.StrictMode,{children:Y.jsx(CS,{children:Y.jsx(FR,{})})}));
